import{s as Ee,r as Te,a as I,g as F,i as L,w as Xe,f as g,U as xe,t as V,d as W,e as v,c as w,q as N,y as Ae,n as ae,p as ie,l as Be,b as O,v as De,h as p,j as fe,u as Oe,m as Re,o as Ve,H as we,V as se,K as We,W as Ye}from"./scheduler.DGwhun8C.js";import{S as He,i as Me,e as Ge,c as G,a as P,m as q,t as E,b as A,d as J,g as he,f as ge}from"./index.B2vZYn3d.js";import{e as ke}from"./each.osbS1YKp.js";import{b as ue}from"./paths.CP8QAufb.js";import{d as Pe}from"./index.CxkXYq4D.js";import{S as qe,A as Je}from"./ServiceHeader.BllCXQ-K.js";import{F as Ne}from"./FileInput.CBSWsRkC.js";import"./index.By4cBdn0.js";import{S as ce}from"./SecondaryButton.zQkvdoBX.js";import{W as Ue}from"./WarningButton.B3j9Frnm.js";import{a as je}from"./index.m47NXzH2.js";import{F as Ke}from"./FormElement.Cd26lsYY.js";import{W as ze}from"./WarningText.wRiJ9IQ1.js";import{L as Qe}from"./Loading.CxDWVM5j.js";import{M as Ze}from"./Modal.DoazTwrH.js";import{g as ye}from"./entry.Mxea2nUt.js";function et(n){let e;return{c(){e=V("Import from XLSX file")},l(t){e=W(t,"Import from XLSX file")},m(t,l){L(t,e,l)},d(t){t&&g(e)}}}function tt(n){let e,t,l;return{c(){e=v("input"),this.h()},l(a){e=w(a,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){N(e,"class","govuk-file-upload"),N(e,"id","import-xlsx"),N(e,"type","file")},m(a,o){L(a,e,o),n[6](e),t||(l=Ae(e,"change",n[3]),t=!0)},p:ae,d(a){a&&g(e),n[6](null),t=!1,l()}}}function lt(n){let e,t=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,l,a,o=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=v("p"),e.innerHTML=t,l=I(),a=v("ul"),a.innerHTML=o},l(i){e=w(i,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1ykh4hv"&&(e.innerHTML=t),l=F(i),a=w(i,"UL",{"data-svelte-h":!0}),ie(a)!=="svelte-1tt4pqo"&&(a.innerHTML=o)},m(i,s){L(i,e,s),L(i,l,s),L(i,a,s)},p:ae,d(i){i&&(g(e),g(l),g(a))}}}function nt(n){let e;return{c(){e=V("Close")},l(t){e=W(t,"Close")},m(t,l){L(t,e,l)},d(t){t&&g(e)}}}function rt(n){let e,t,l,a,o,i;return e=new Ke({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[tt]},$$scope:{ctx:n}}}),l=new ze({props:{$$slots:{default:[lt]},$$scope:{ctx:n}}}),o=new ce({props:{$$slots:{default:[nt]},$$scope:{ctx:n}}}),o.$on("click",n[7]),{c(){G(e.$$.fragment),t=I(),G(l.$$.fragment),a=I(),G(o.$$.fragment)},l(s){P(e.$$.fragment,s),t=F(s),P(l.$$.fragment,s),a=F(s),P(o.$$.fragment,s)},m(s,m){q(e,s,m),L(s,t,m),q(l,s,m),L(s,a,m),q(o,s,m),i=!0},p(s,m){const b={};m&1028&&(b.$$scope={dirty:m,ctx:s}),e.$set(b);const u={};m&1024&&(u.$$scope={dirty:m,ctx:s}),l.$set(u);const r={};m&1024&&(r.$$scope={dirty:m,ctx:s}),o.$set(r)},i(s){i||(E(e.$$.fragment,s),E(l.$$.fragment,s),E(o.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),A(l.$$.fragment,s),A(o.$$.fragment,s),i=!1},d(s){s&&(g(t),g(a)),J(e,s),J(l,s),J(o,s)}}}function ot(n){let e,t,l,a,o,i,s;e=new ce({props:{$$slots:{default:[et]},$$scope:{ctx:n}}}),e.$on("click",n[5]),l=new Qe({props:{loading:n[0]}});function m(u){n[8](u)}let b={title:"Import from XLSX file",$$slots:{default:[rt]},$$scope:{ctx:n}};return n[1]!==void 0&&(b.open=n[1]),o=new Ze({props:b}),Te.push(()=>Ge(o,"open",m)),{c(){G(e.$$.fragment),t=I(),G(l.$$.fragment),a=I(),G(o.$$.fragment)},l(u){P(e.$$.fragment,u),t=F(u),P(l.$$.fragment,u),a=F(u),P(o.$$.fragment,u)},m(u,r){q(e,u,r),L(u,t,r),q(l,u,r),L(u,a,r),q(o,u,r),s=!0},p(u,[r]){const h={};r&1024&&(h.$$scope={dirty:r,ctx:u}),e.$set(h);const f={};r&1&&(f.loading=u[0]),l.$set(f);const $={};r&1030&&($.$$scope={dirty:r,ctx:u}),!i&&r&2&&(i=!0,$.open=u[1],Xe(()=>i=!1)),o.$set($)},i(u){s||(E(e.$$.fragment,u),E(l.$$.fragment,u),E(o.$$.fragment,u),s=!0)},o(u){A(e.$$.fragment,u),A(l.$$.fragment,u),A(o.$$.fragment,u),s=!1},d(u){u&&(g(t),g(a)),J(e,u),J(l,u),J(o,u)}}}function st(n,e,t){let l=xe(),{xlsxImporter:a}=e,o="",i=!1,s;async function m(f){let $=s.files[0].name;try{t(0,o=`Loading ${$}`);let _=await s.files[0].arrayBuffer(),D=await a(_);t(0,o=""),l("imported",{filename:je($,".xlsx"),data:D})}catch(_){window.alert(`Couldn't import ${$}: ${_}`),t(0,o="")}}const b=()=>t(1,i=!0);function u(f){Te[f?"unshift":"push"](()=>{s=f,t(2,s)})}const r=()=>t(1,i=!1);function h(f){i=f,t(1,i)}return n.$$set=f=>{"xlsxImporter"in f&&t(4,a=f.xlsxImporter)},[o,i,s,m,a,b,u,r,h]}class at extends He{constructor(e){super(),Me(this,e,st,ot,Ee,{xlsxImporter:4})}}function Ie(n,e,t){const l=n.slice();return l[20]=e[t],l}const it=n=>({}),Fe=n=>({});function Ce(n){let e,t,l="You are editing:",a,o,i,s;return{c(){e=v("p"),t=v("b"),t.textContent=l,a=I(),o=v("a"),i=V(n[7]),this.h()},l(m){e=w(m,"P",{});var b=O(e);t=w(b,"B",{"data-svelte-h":!0}),ie(t)!=="svelte-1kt2tqj"&&(t.textContent=l),a=F(b),o=w(b,"A",{href:!0});var u=O(o);i=W(u,n[7]),u.forEach(g),b.forEach(g),this.h()},h(){N(o,"href",s=`${ue}/${n[0].prefix}overview`)},m(m,b){L(m,e,b),p(e,t),p(e,a),p(e,o),p(o,i)},p(m,b){b&128&&fe(i,m[7]),b&1&&s!==(s=`${ue}/${m[0].prefix}overview`)&&N(o,"href",s)},d(m){m&&g(e)}}}function ft(n){let e,t="No saved files";return{c(){e=v("p"),e.textContent=t},l(l){e=w(l,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-yojds1"&&(e.textContent=t)},m(l,a){L(l,e,a)},p:ae,i:ae,o:ae,d(l){l&&g(e)}}}function ut(n){let e,t="Manage existing files",l,a,o,i="<tr><th>File name</th> <th>Scheme name</th> <th>Action</th></tr>",s,m,b,u=ke(n[6]),r=[];for(let f=0;f<u.length;f+=1)r[f]=Le(Ie(n,u,f));const h=f=>A(r[f],1,1,()=>{r[f]=null});return{c(){e=v("h2"),e.textContent=t,l=I(),a=v("table"),o=v("thead"),o.innerHTML=i,s=I(),m=v("tbody");for(let f=0;f<r.length;f+=1)r[f].c()},l(f){e=w(f,"H2",{"data-svelte-h":!0}),ie(e)!=="svelte-1d50rjn"&&(e.textContent=t),l=F(f),a=w(f,"TABLE",{});var $=O(a);o=w($,"THEAD",{"data-svelte-h":!0}),ie(o)!=="svelte-gvkk9f"&&(o.innerHTML=i),s=F($),m=w($,"TBODY",{});var _=O(m);for(let D=0;D<r.length;D+=1)r[D].l(_);_.forEach(g),$.forEach(g)},m(f,$){L(f,e,$),L(f,l,$),L(f,a,$),p(a,o),p(a,s),p(a,m);for(let _=0;_<r.length;_+=1)r[_]&&r[_].m(m,null);b=!0},p(f,$){if($&9025){u=ke(f[6]);let _;for(_=0;_<u.length;_+=1){const D=Ie(f,u,_);r[_]?(r[_].p(D,$),E(r[_],1)):(r[_]=Le(D),r[_].c(),E(r[_],1),r[_].m(m,null))}for(he(),_=u.length;_<r.length;_+=1)h(_);ge()}},i(f){if(!b){for(let $=0;$<u.length;$+=1)E(r[$]);b=!0}},o(f){r=r.filter(Boolean);for(let $=0;$<r.length;$+=1)A(r[$]);b=!1},d(f){f&&(g(e),g(l),g(a)),We(r,f)}}}function ct(n){let e;return{c(){e=V("Rename")},l(t){e=W(t,"Rename")},m(t,l){L(t,e,l)},d(t){t&&g(e)}}}function mt(n){let e;return{c(){e=V("Delete")},l(t){e=W(t,"Delete")},m(t,l){L(t,e,l)},d(t){t&&g(e)}}}function Le(n){let e,t,l,a=n[20]+"",o,i,s,m=n[0].describeFile(n[20])+"",b,u,r,h,f,$,_,D,j,H,X;function ne(){return n[15](n[20])}function M(){return n[16](n[20])}f=new ce({props:{$$slots:{default:[ct]},$$scope:{ctx:n}}}),f.$on("click",M);function U(){return n[17](n[20])}return _=new Ue({props:{$$slots:{default:[mt]},$$scope:{ctx:n}}}),_.$on("click",U),{c(){e=v("tr"),t=v("td"),l=v("a"),o=V(a),i=I(),s=v("td"),b=V(m),u=I(),r=v("td"),h=v("div"),G(f.$$.fragment),$=I(),G(_.$$.fragment),D=I(),this.h()},l(S){e=w(S,"TR",{});var C=O(e);t=w(C,"TD",{});var K=O(t);l=w(K,"A",{href:!0});var x=O(l);o=W(x,a),x.forEach(g),K.forEach(g),i=F(C),s=w(C,"TD",{});var c=O(s);b=W(c,m),c.forEach(g),u=F(C),r=w(C,"TD",{});var k=O(r);h=w(k,"DIV",{class:!0,style:!0});var B=O(h);P(f.$$.fragment,B),$=F(B),P(_.$$.fragment,B),B.forEach(g),k.forEach(g),D=F(C),C.forEach(g),this.h()},h(){N(l,"href","#"),N(h,"class","govuk-button-group"),De(h,"flex-wrap","nowrap")},m(S,C){L(S,e,C),p(e,t),p(t,l),p(l,o),p(e,i),p(e,s),p(s,b),p(e,u),p(e,r),p(r,h),q(f,h,null),p(h,$),q(_,h,null),p(e,D),j=!0,H||(X=Ae(l,"click",Ye(ne)),H=!0)},p(S,C){n=S,(!j||C&64)&&a!==(a=n[20]+"")&&fe(o,a),(!j||C&65)&&m!==(m=n[0].describeFile(n[20])+"")&&fe(b,m);const K={};C&262144&&(K.$$scope={dirty:C,ctx:n}),f.$set(K);const x={};C&262144&&(x.$$scope={dirty:C,ctx:n}),_.$set(x)},i(S){j||(E(f.$$.fragment,S),E(_.$$.fragment,S),j=!0)},o(S){A(f.$$.fragment,S),A(_.$$.fragment,S),j=!1},d(S){S&&g(e),J(f),J(_),H=!1,X()}}}function dt(n){let e;return{c(){e=V("Create new file")},l(t){e=W(t,"Create new file")},m(t,l){L(t,e,l)},d(t){t&&g(e)}}}function Se(n){let e,t,l,a;return l=new at({props:{xlsxImporter:n[5]}}),l.$on("imported",n[12]),{c(){e=v("hr"),t=I(),G(l.$$.fragment)},l(o){e=w(o,"HR",{}),t=F(o),P(l.$$.fragment,o)},m(o,i){L(o,e,i),L(o,t,i),q(l,o,i),a=!0},p(o,i){const s={};i&32&&(s.xlsxImporter=o[5]),l.$set(s)},i(o){a||(E(l.$$.fragment,o),a=!0)},o(o){A(l.$$.fragment,o),a=!1},d(o){o&&(g(e),g(t)),J(l,o)}}}function _t(n){let e,t,l,a,o,i,s,m,b,u,r,h,f,$,_=`On this page you can manage your assessment files. All files are
        auto-saved in your browser's local storage. You can close your browser
        and conitnue later.`,D,j,H,X,ne,M,U,S,C,K,x,c,k,B,z,me,re,de,ee;e=new qe({props:{service:n[3]}}),a=new Je({});const _e=n[14].description,Y=Be(_e,n,n[18],Fe);let R=n[7]&&Ce(n);const be=[ut,ft],te=[];function ve(d,y){return d[6].length>0?0:1}H=ve(n),X=te[H]=be[H](n),x=new ce({props:{$$slots:{default:[dt]},$$scope:{ctx:n}}}),x.$on("click",n[10]),re=new Ne({props:{label:"Select a .json file",onLoad:n[11]}});let T=n[5]!=null&&Se(n);return{c(){G(e.$$.fragment),t=I(),l=v("div"),G(a.$$.fragment),o=I(),i=v("h1"),s=V("Manage my "),m=V(n[4]),b=V("s"),u=I(),r=v("div"),h=v("div"),Y&&Y.c(),f=I(),$=v("p"),$.textContent=_,D=I(),R&&R.c(),j=I(),X.c(),ne=I(),M=v("div"),U=v("h2"),S=V("Create a new "),C=V(n[4]),K=I(),G(x.$$.fragment),c=I(),k=v("h2"),B=V("Import a saved "),z=V(n[4]),me=I(),G(re.$$.fragment),de=I(),T&&T.c(),this.h()},l(d){P(e.$$.fragment,d),t=F(d),l=w(d,"DIV",{class:!0});var y=O(l);P(a.$$.fragment,y),o=F(y),i=w(y,"H1",{style:!0});var oe=O(i);s=W(oe,"Manage my "),m=W(oe,n[4]),b=W(oe,"s"),oe.forEach(g),u=F(y),r=w(y,"DIV",{class:!0});var le=O(r);h=w(le,"DIV",{class:!0});var Q=O(h);Y&&Y.l(Q),f=F(Q),$=w(Q,"P",{"data-svelte-h":!0}),ie($)!=="svelte-d0do6x"&&($.textContent=_),D=F(Q),R&&R.l(Q),j=F(Q),X.l(Q),Q.forEach(g),ne=F(le),M=w(le,"DIV",{class:!0});var Z=O(M);U=w(Z,"H2",{class:!0});var pe=O(U);S=W(pe,"Create a new "),C=W(pe,n[4]),pe.forEach(g),K=F(Z),P(x.$$.fragment,Z),c=F(Z),k=w(Z,"H2",{});var $e=O(k);B=W($e,"Import a saved "),z=W($e,n[4]),$e.forEach(g),me=F(Z),P(re.$$.fragment,Z),de=F(Z),T&&T.l(Z),Z.forEach(g),le.forEach(g),y.forEach(g),this.h()},h(){De(i,"margin-top","30px"),N(h,"class","govuk-grid-column-two-thirds"),N(U,"class","green-bar svelte-1z050ke"),N(M,"class","govuk-grid-column-one-third"),N(r,"class","govuk-grid-row"),N(l,"class","govuk-width-container")},m(d,y){q(e,d,y),L(d,t,y),L(d,l,y),q(a,l,null),p(l,o),p(l,i),p(i,s),p(i,m),p(i,b),p(l,u),p(l,r),p(r,h),Y&&Y.m(h,null),p(h,f),p(h,$),p(h,D),R&&R.m(h,null),p(h,j),te[H].m(h,null),p(r,ne),p(r,M),p(M,U),p(U,S),p(U,C),p(M,K),q(x,M,null),p(M,c),p(M,k),p(k,B),p(k,z),p(M,me),q(re,M,null),p(M,de),T&&T.m(M,null),ee=!0},p(d,[y]){const oe={};y&8&&(oe.service=d[3]),e.$set(oe),(!ee||y&16)&&fe(m,d[4]),Y&&Y.p&&(!ee||y&262144)&&Oe(Y,_e,d,d[18],ee?Ve(_e,d[18],y,it):Re(d[18]),Fe),d[7]?R?R.p(d,y):(R=Ce(d),R.c(),R.m(h,j)):R&&(R.d(1),R=null);let le=H;H=ve(d),H===le?te[H].p(d,y):(he(),A(te[le],1,1,()=>{te[le]=null}),ge(),X=te[H],X?X.p(d,y):(X=te[H]=be[H](d),X.c()),E(X,1),X.m(h,null)),(!ee||y&16)&&fe(C,d[4]);const Q={};y&262144&&(Q.$$scope={dirty:y,ctx:d}),x.$set(Q),(!ee||y&16)&&fe(z,d[4]),d[5]!=null?T?(T.p(d,y),y&32&&E(T,1)):(T=Se(d),T.c(),E(T,1),T.m(M,null)):T&&(he(),A(T,1,1,()=>{T=null}),ge())},i(d){ee||(E(e.$$.fragment,d),E(a.$$.fragment,d),E(Y,d),E(X),E(x.$$.fragment,d),E(re.$$.fragment,d),E(T),ee=!0)},o(d){A(e.$$.fragment,d),A(a.$$.fragment,d),A(Y,d),A(X),A(x.$$.fragment,d),A(re.$$.fragment,d),A(T),ee=!1},d(d){d&&(g(t),g(l)),J(e,d),J(a),Y&&Y.d(d),R&&R.d(),te[H].d(),J(x),J(re),T&&T.d()}}}function pt(n,e,t){let l,a=ae,o=()=>(a(),a=we(f,c=>t(19,l=c)),f),i,s=ae,m=()=>(s(),s=we(h,c=>t(7,i=c)),h);n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>s());let{$$slots:b={},$$scope:u}=e,{files:r}=e,{currentFile:h}=e;m();let{state:f}=e;o();let{service:$}=e,{fileObjectType:_}=e,{xlsxImporter:D=null}=e,j=r.getFileList();function H(c){let k=window.prompt(`Rename file ${c} to what?`,c);if(k){let B=r.key(c),z=window.localStorage.getItem(B);window.localStorage.setItem(r.key(k),z),window.localStorage.removeItem(B),t(6,j=r.getFileList()),i==c&&se(h,i=k,i)}}function X(c){if(!window.confirm(`Really delete file ${c}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let k=r.key(c);Pe(`${c}.json`,window.localStorage.getItem(k)),window.localStorage.removeItem(k),i==c&&(se(h,i="",i),se(f,l=r.emptyState(),l),window.localStorage.setItem(r.key("last-opened-file"),"")),t(6,j=r.getFileList())}function ne(){let c=window.prompt("What do you want to name your new file?");c&&(se(h,i=c,i),se(f,l=r.emptyState(),l),t(6,j=r.saveAndGetFileList(i,l)),ye(`${ue}/${r.prefix}overview`))}function M(c,k){let B=je(c,".json");try{let z=JSON.parse(k);r.validate(z),t(6,j=r.saveAndGetFileList(B,z)),S(B)}catch(z){window.alert(`Couldn't load ${B}: ${z}`)}}function U(c){let{filename:k,data:B}=c.detail;t(6,j=r.saveAndGetFileList(k,B)),S(k)}function S(c){try{let k=r.loadFile(c);se(h,i=c,i),se(f,l=k,l),ye(`${ue}/${r.prefix}overview`)}catch(k){window.alert(`Couldn't load ${c}: ${k}`)}return!1}const C=c=>S(c),K=c=>H(c),x=c=>X(c);return n.$$set=c=>{"files"in c&&t(0,r=c.files),"currentFile"in c&&m(t(1,h=c.currentFile)),"state"in c&&o(t(2,f=c.state)),"service"in c&&t(3,$=c.service),"fileObjectType"in c&&t(4,_=c.fileObjectType),"xlsxImporter"in c&&t(5,D=c.xlsxImporter),"$$scope"in c&&t(18,u=c.$$scope)},[r,h,f,$,_,D,j,i,H,X,ne,M,U,S,b,C,K,x,u]}class Dt extends He{constructor(e){super(),Me(this,e,pt,_t,Ee,{files:0,currentFile:1,state:2,service:3,fileObjectType:4,xlsxImporter:5})}}export{Dt as F};
