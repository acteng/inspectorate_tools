import{s as je,r as Oe,a as F,g as S,i as H,w as Re,f as p,U as We,t as M,d as X,e as y,c as I,q as ee,y as Me,n as ce,p as me,l as Ye,b as J,v as Xe,h as u,j as ae,u as xe,m as Ve,o as qe,H as Ie,V as ue,K as Ge,W as Pe}from"./scheduler.DGwhun8C.js";import{S as Be,i as Je,e as ze,c as P,a as z,m as U,t as j,b as B,d as K,g as ve,f as we}from"./index.B2vZYn3d.js";import{e as Ee}from"./each.osbS1YKp.js";import{g as Fe}from"./entry.BgLXAosq.js";import{b as pe}from"./paths.B54Lbr1g.js";import{a as Ne,d as Se,c as Ce}from"./index.CrDSpe9p.js";import{S as Ue,A as Ke}from"./ServiceHeader.2SLe6qs_.js";import{F as Qe}from"./FileInput.C4VdJQ3x.js";import"./SelectWithCustom.svelte_svelte_type_style_lang.DcJK36-l.js";import{S as _e}from"./SecondaryButton.zQkvdoBX.js";import{W as Ze}from"./WarningButton.B3j9Frnm.js";import{F as et}from"./FormElement.Cd26lsYY.js";import{W as tt}from"./WarningText.wRiJ9IQ1.js";import{L as lt}from"./Loading.CaEuGRRd.js";import{M as nt}from"./Modal.C-TvsLi9.js";function ot(n){let e;return{c(){e=M("Import from XLSX file")},l(t){e=X(t,"Import from XLSX file")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function rt(n){let e,t,l;return{c(){e=y("input"),this.h()},l(a){e=I(a,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){ee(e,"class","govuk-file-upload"),ee(e,"id","import-xlsx"),ee(e,"type","file")},m(a,o){H(a,e,o),n[6](e),t||(l=Me(e,"change",n[3]),t=!0)},p:ce,d(a){a&&p(e),n[6](null),t=!1,l()}}}function st(n){let e,t=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,l,a,o=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=y("p"),e.innerHTML=t,l=F(),a=y("ul"),a.innerHTML=o},l(r){e=I(r,"P",{"data-svelte-h":!0}),me(e)!=="svelte-1ykh4hv"&&(e.innerHTML=t),l=S(r),a=I(r,"UL",{"data-svelte-h":!0}),me(a)!=="svelte-1tt4pqo"&&(a.innerHTML=o)},m(r,s){H(r,e,s),H(r,l,s),H(r,a,s)},p:ce,d(r){r&&(p(e),p(l),p(a))}}}function at(n){let e;return{c(){e=M("Close")},l(t){e=X(t,"Close")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function it(n){let e,t,l,a,o,r;return e=new et({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[rt]},$$scope:{ctx:n}}}),l=new tt({props:{$$slots:{default:[st]},$$scope:{ctx:n}}}),o=new _e({props:{$$slots:{default:[at]},$$scope:{ctx:n}}}),o.$on("click",n[7]),{c(){P(e.$$.fragment),t=F(),P(l.$$.fragment),a=F(),P(o.$$.fragment)},l(s){z(e.$$.fragment,s),t=S(s),z(l.$$.fragment,s),a=S(s),z(o.$$.fragment,s)},m(s,m){U(e,s,m),H(s,t,m),U(l,s,m),H(s,a,m),U(o,s,m),r=!0},p(s,m){const w={};m&1028&&(w.$$scope={dirty:m,ctx:s}),e.$set(w);const c={};m&1024&&(c.$$scope={dirty:m,ctx:s}),l.$set(c);const f={};m&1024&&(f.$$scope={dirty:m,ctx:s}),o.$set(f)},i(s){r||(j(e.$$.fragment,s),j(l.$$.fragment,s),j(o.$$.fragment,s),r=!0)},o(s){B(e.$$.fragment,s),B(l.$$.fragment,s),B(o.$$.fragment,s),r=!1},d(s){s&&(p(t),p(a)),K(e,s),K(l,s),K(o,s)}}}function ft(n){let e,t,l,a,o,r,s;e=new _e({props:{$$slots:{default:[ot]},$$scope:{ctx:n}}}),e.$on("click",n[5]),l=new lt({props:{loading:n[0]}});function m(c){n[8](c)}let w={title:"Import from XLSX file",$$slots:{default:[it]},$$scope:{ctx:n}};return n[1]!==void 0&&(w.open=n[1]),o=new nt({props:w}),Oe.push(()=>ze(o,"open",m)),{c(){P(e.$$.fragment),t=F(),P(l.$$.fragment),a=F(),P(o.$$.fragment)},l(c){z(e.$$.fragment,c),t=S(c),z(l.$$.fragment,c),a=S(c),z(o.$$.fragment,c)},m(c,f){U(e,c,f),H(c,t,f),U(l,c,f),H(c,a,f),U(o,c,f),s=!0},p(c,[f]){const _={};f&1024&&(_.$$scope={dirty:f,ctx:c}),e.$set(_);const v={};f&1&&(v.loading=c[0]),l.$set(v);const C={};f&1030&&(C.$$scope={dirty:f,ctx:c}),!r&&f&2&&(r=!0,C.open=c[1],Re(()=>r=!1)),o.$set(C)},i(c){s||(j(e.$$.fragment,c),j(l.$$.fragment,c),j(o.$$.fragment,c),s=!0)},o(c){B(e.$$.fragment,c),B(l.$$.fragment,c),B(o.$$.fragment,c),s=!1},d(c){c&&(p(t),p(a)),K(e,c),K(l,c),K(o,c)}}}function ut(n,e,t){let l=We(),{xlsxImporter:a}=e,o="",r=!1,s;async function m(v){let C=s.files[0].name;try{t(0,o=`Loading ${C}`);let D=await s.files[0].arrayBuffer(),x=await a(D);t(0,o=""),l("imported",{filename:Ne(C,".xlsx"),data:x})}catch(D){window.alert(`Couldn't import ${C}: ${D}`),t(0,o="")}}const w=()=>t(1,r=!0);function c(v){Oe[v?"unshift":"push"](()=>{s=v,t(2,s)})}const f=()=>t(1,r=!1);function _(v){r=v,t(1,r)}return n.$$set=v=>{"xlsxImporter"in v&&t(4,a=v.xlsxImporter)},[o,r,s,m,a,w,c,f,_]}class ct extends Be{constructor(e){super(),Je(this,e,ut,ft,je,{xlsxImporter:4})}}function Le(n,e,t){const l=n.slice();return l[23]=e[t],l}const mt=n=>({}),Te=n=>({});function Ae(n){let e,t,l="You are editing:",a,o,r,s;return{c(){e=y("p"),t=y("b"),t.textContent=l,a=F(),o=y("a"),r=M(n[7]),this.h()},l(m){e=I(m,"P",{});var w=J(e);t=I(w,"B",{"data-svelte-h":!0}),me(t)!=="svelte-1kt2tqj"&&(t.textContent=l),a=S(w),o=I(w,"A",{href:!0});var c=J(o);r=X(c,n[7]),c.forEach(p),w.forEach(p),this.h()},h(){ee(o,"href",s=`${pe}/${n[0].prefix}overview`)},m(m,w){H(m,e,w),u(e,t),u(e,a),u(e,o),u(o,r)},p(m,w){w&128&&ae(r,m[7]),w&1&&s!==(s=`${pe}/${m[0].prefix}overview`)&&ee(o,"href",s)},d(m){m&&p(e)}}}function _t(n){let e,t="No saved files";return{c(){e=y("p"),e.textContent=t},l(l){e=I(l,"P",{"data-svelte-h":!0}),me(e)!=="svelte-yojds1"&&(e.textContent=t)},m(l,a){H(l,e,a)},p:ce,i:ce,o:ce,d(l){l&&p(e)}}}function dt(n){let e,t="Manage existing files",l,a,o,r,s,m,w,c="File name",f,_,v=Ce(n[4])+"",C,D,x,L,Q="Action",W,T,O;a=new _e({props:{$$slots:{default:[pt]},$$scope:{ctx:n}}}),a.$on("click",n[16]);let G=Ee(n[6]),h=[];for(let g=0;g<G.length;g+=1)h[g]=He(Le(n,G,g));const V=g=>B(h[g],1,1,()=>{h[g]=null});return{c(){e=y("h2"),e.textContent=t,l=F(),P(a.$$.fragment),o=F(),r=y("table"),s=y("thead"),m=y("tr"),w=y("th"),w.textContent=c,f=F(),_=y("th"),C=M(v),D=M(" name"),x=F(),L=y("th"),L.textContent=Q,W=F(),T=y("tbody");for(let g=0;g<h.length;g+=1)h[g].c()},l(g){e=I(g,"H2",{"data-svelte-h":!0}),me(e)!=="svelte-1d50rjn"&&(e.textContent=t),l=S(g),z(a.$$.fragment,g),o=S(g),r=I(g,"TABLE",{});var d=J(r);s=I(d,"THEAD",{});var k=J(s);m=I(k,"TR",{});var b=J(m);w=I(b,"TH",{"data-svelte-h":!0}),me(w)!=="svelte-1nlq0n5"&&(w.textContent=c),f=S(b),_=I(b,"TH",{});var Y=J(_);C=X(Y,v),D=X(Y," name"),Y.forEach(p),x=S(b),L=I(b,"TH",{"data-svelte-h":!0}),me(L)!=="svelte-izszto"&&(L.textContent=Q),b.forEach(p),k.forEach(p),W=S(d),T=I(d,"TBODY",{});var i=J(T);for(let E=0;E<h.length;E+=1)h[E].l(i);i.forEach(p),d.forEach(p)},m(g,d){H(g,e,d),H(g,l,d),U(a,g,d),H(g,o,d),H(g,r,d),u(r,s),u(s,m),u(m,w),u(m,f),u(m,_),u(_,C),u(_,D),u(m,x),u(m,L),u(r,W),u(r,T);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(T,null);O=!0},p(g,d){const k={};if(d&2097152&&(k.$$scope={dirty:d,ctx:g}),a.$set(k),(!O||d&16)&&v!==(v=Ce(g[4])+"")&&ae(C,v),d&18241){G=Ee(g[6]);let b;for(b=0;b<G.length;b+=1){const Y=Le(g,G,b);h[b]?(h[b].p(Y,d),j(h[b],1)):(h[b]=He(Y),h[b].c(),j(h[b],1),h[b].m(T,null))}for(ve(),b=G.length;b<h.length;b+=1)V(b);we()}},i(g){if(!O){j(a.$$.fragment,g);for(let d=0;d<G.length;d+=1)j(h[d]);O=!0}},o(g){B(a.$$.fragment,g),h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)B(h[d]);O=!1},d(g){g&&(p(e),p(l),p(o),p(r)),K(a,g),Ge(h,g)}}}function pt(n){let e;return{c(){e=M("Export all files for backup")},l(t){e=X(t,"Export all files for backup")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function $t(n){let e;return{c(){e=M("Export JSON")},l(t){e=X(t,"Export JSON")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function ht(n){let e;return{c(){e=M("Rename")},l(t){e=X(t,"Rename")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function gt(n){let e;return{c(){e=M("Delete")},l(t){e=X(t,"Delete")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function He(n){let e,t,l,a=n[23]+"",o,r,s,m=n[0].describeFile(n[23])+"",w,c,f,_,v,C,D,x,L,Q,W,T,O;function G(){return n[17](n[23])}function h(){return n[18](n[23])}v=new _e({props:{$$slots:{default:[$t]},$$scope:{ctx:n}}}),v.$on("click",h);function V(){return n[19](n[23])}D=new _e({props:{$$slots:{default:[ht]},$$scope:{ctx:n}}}),D.$on("click",V);function g(){return n[20](n[23])}return L=new Ze({props:{$$slots:{default:[gt]},$$scope:{ctx:n}}}),L.$on("click",g),{c(){e=y("tr"),t=y("td"),l=y("a"),o=M(a),r=F(),s=y("td"),w=M(m),c=F(),f=y("td"),_=y("div"),P(v.$$.fragment),C=F(),P(D.$$.fragment),x=F(),P(L.$$.fragment),Q=F(),this.h()},l(d){e=I(d,"TR",{});var k=J(e);t=I(k,"TD",{});var b=J(t);l=I(b,"A",{href:!0});var Y=J(l);o=X(Y,a),Y.forEach(p),b.forEach(p),r=S(k),s=I(k,"TD",{});var i=J(s);w=X(i,m),i.forEach(p),c=S(k),f=I(k,"TD",{});var E=J(f);_=I(E,"DIV",{class:!0,style:!0});var N=J(_);z(v.$$.fragment,N),C=S(N),z(D.$$.fragment,N),x=S(N),z(L.$$.fragment,N),N.forEach(p),E.forEach(p),Q=S(k),k.forEach(p),this.h()},h(){ee(l,"href","#"),ee(_,"class","govuk-button-group"),Xe(_,"flex-wrap","nowrap")},m(d,k){H(d,e,k),u(e,t),u(t,l),u(l,o),u(e,r),u(e,s),u(s,w),u(e,c),u(e,f),u(f,_),U(v,_,null),u(_,C),U(D,_,null),u(_,x),U(L,_,null),u(e,Q),W=!0,T||(O=Me(l,"click",Pe(G)),T=!0)},p(d,k){n=d,(!W||k&64)&&a!==(a=n[23]+"")&&ae(o,a),(!W||k&65)&&m!==(m=n[0].describeFile(n[23])+"")&&ae(w,m);const b={};k&2097152&&(b.$$scope={dirty:k,ctx:n}),v.$set(b);const Y={};k&2097152&&(Y.$$scope={dirty:k,ctx:n}),D.$set(Y);const i={};k&2097152&&(i.$$scope={dirty:k,ctx:n}),L.$set(i)},i(d){W||(j(v.$$.fragment,d),j(D.$$.fragment,d),j(L.$$.fragment,d),W=!0)},o(d){B(v.$$.fragment,d),B(D.$$.fragment,d),B(L.$$.fragment,d),W=!1},d(d){d&&p(e),K(v),K(D),K(L),T=!1,O()}}}function bt(n){let e;return{c(){e=M("Create new file")},l(t){e=X(t,"Create new file")},m(t,l){H(t,e,l)},d(t){t&&p(e)}}}function De(n){let e,t,l,a;return l=new ct({props:{xlsxImporter:n[5]}}),l.$on("imported",n[13]),{c(){e=y("hr"),t=F(),P(l.$$.fragment)},l(o){e=I(o,"HR",{}),t=S(o),z(l.$$.fragment,o)},m(o,r){H(o,e,r),H(o,t,r),U(l,o,r),a=!0},p(o,r){const s={};r&32&&(s.xlsxImporter=o[5]),l.$set(s)},i(o){a||(j(l.$$.fragment,o),a=!0)},o(o){B(l.$$.fragment,o),a=!1},d(o){o&&(p(e),p(t)),K(l,o)}}}function vt(n){let e,t,l,a,o,r,s,m,w,c,f,_,v,C,D,x,L,Q,W,T,O,G,h,V,g,d,k,b,Y,i,E,N,le,ie,$e,ne;e=new Ue({props:{service:n[3]}}),a=new Ke({});const he=n[15].description,Z=Ye(he,n,n[21],Te);let q=n[7]&&Ae(n);const ke=[dt,_t],re=[];function ye($,A){return $[6].length>0?0:1}T=ye(n),O=re[T]=ke[T](n),b=new _e({props:{$$slots:{default:[bt]},$$scope:{ctx:n}}}),b.$on("click",n[11]),ie=new Qe({props:{label:"Select a .json file",onLoad:n[12]}});let R=n[5]!=null&&De(n);return{c(){P(e.$$.fragment),t=F(),l=y("div"),P(a.$$.fragment),o=F(),r=y("h1"),s=M("Manage my "),m=M(n[4]),w=M("s"),c=F(),f=y("div"),_=y("div"),Z&&Z.c(),v=F(),C=y("p"),D=M("On this page you can manage your "),x=M(n[4]),L=M(` files. All files are auto-saved
        in your browser's local storage. You can close your browser and continue
        later.`),Q=F(),q&&q.c(),W=F(),O.c(),G=F(),h=y("div"),V=y("h2"),g=M("Create a new "),d=M(n[4]),k=F(),P(b.$$.fragment),Y=F(),i=y("h2"),E=M("Import a saved "),N=M(n[4]),le=F(),P(ie.$$.fragment),$e=F(),R&&R.c(),this.h()},l($){z(e.$$.fragment,$),t=S($),l=I($,"DIV",{class:!0});var A=J(l);z(a.$$.fragment,A),o=S(A),r=I(A,"H1",{style:!0});var fe=J(r);s=X(fe,"Manage my "),m=X(fe,n[4]),w=X(fe,"s"),fe.forEach(p),c=S(A),f=I(A,"DIV",{class:!0});var se=J(f);_=I(se,"DIV",{class:!0});var te=J(_);Z&&Z.l(te),v=S(te),C=I(te,"P",{});var de=J(C);D=X(de,"On this page you can manage your "),x=X(de,n[4]),L=X(de,` files. All files are auto-saved
        in your browser's local storage. You can close your browser and continue
        later.`),de.forEach(p),Q=S(te),q&&q.l(te),W=S(te),O.l(te),te.forEach(p),G=S(se),h=I(se,"DIV",{class:!0});var oe=J(h);V=I(oe,"H2",{class:!0});var ge=J(V);g=X(ge,"Create a new "),d=X(ge,n[4]),ge.forEach(p),k=S(oe),z(b.$$.fragment,oe),Y=S(oe),i=I(oe,"H2",{});var be=J(i);E=X(be,"Import a saved "),N=X(be,n[4]),be.forEach(p),le=S(oe),z(ie.$$.fragment,oe),$e=S(oe),R&&R.l(oe),oe.forEach(p),se.forEach(p),A.forEach(p),this.h()},h(){Xe(r,"margin-top","30px"),ee(_,"class","govuk-grid-column-two-thirds"),ee(V,"class","green-bar svelte-1z050ke"),ee(h,"class","govuk-grid-column-one-third"),ee(f,"class","govuk-grid-row"),ee(l,"class","govuk-width-container")},m($,A){U(e,$,A),H($,t,A),H($,l,A),U(a,l,null),u(l,o),u(l,r),u(r,s),u(r,m),u(r,w),u(l,c),u(l,f),u(f,_),Z&&Z.m(_,null),u(_,v),u(_,C),u(C,D),u(C,x),u(C,L),u(_,Q),q&&q.m(_,null),u(_,W),re[T].m(_,null),u(f,G),u(f,h),u(h,V),u(V,g),u(V,d),u(h,k),U(b,h,null),u(h,Y),u(h,i),u(i,E),u(i,N),u(h,le),U(ie,h,null),u(h,$e),R&&R.m(h,null),ne=!0},p($,[A]){const fe={};A&8&&(fe.service=$[3]),e.$set(fe),(!ne||A&16)&&ae(m,$[4]),Z&&Z.p&&(!ne||A&2097152)&&xe(Z,he,$,$[21],ne?qe(he,$[21],A,mt):Ve($[21]),Te),(!ne||A&16)&&ae(x,$[4]),$[7]?q?q.p($,A):(q=Ae($),q.c(),q.m(_,W)):q&&(q.d(1),q=null);let se=T;T=ye($),T===se?re[T].p($,A):(ve(),B(re[se],1,1,()=>{re[se]=null}),we(),O=re[T],O?O.p($,A):(O=re[T]=ke[T]($),O.c()),j(O,1),O.m(_,null)),(!ne||A&16)&&ae(d,$[4]);const te={};A&2097152&&(te.$$scope={dirty:A,ctx:$}),b.$set(te),(!ne||A&16)&&ae(N,$[4]),$[5]!=null?R?(R.p($,A),A&32&&j(R,1)):(R=De($),R.c(),j(R,1),R.m(h,null)):R&&(ve(),B(R,1,1,()=>{R=null}),we())},i($){ne||(j(e.$$.fragment,$),j(a.$$.fragment,$),j(Z,$),j(O),j(b.$$.fragment,$),j(ie.$$.fragment,$),j(R),ne=!0)},o($){B(e.$$.fragment,$),B(a.$$.fragment,$),B(Z,$),B(O),B(b.$$.fragment,$),B(ie.$$.fragment,$),B(R),ne=!1},d($){$&&(p(t),p(l)),K(e,$),K(a),Z&&Z.d($),q&&q.d(),re[T].d(),K(b),K(ie),R&&R.d()}}}function wt(n,e,t){let l,a=ce,o=()=>(a(),a=Ie(v,i=>t(22,l=i)),v),r,s=ce,m=()=>(s(),s=Ie(_,i=>t(7,r=i)),_);n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>s());let{$$slots:w={},$$scope:c}=e,{files:f}=e,{currentFile:_}=e;m();let{state:v}=e;o();let{service:C}=e,{fileObjectType:D}=e,{xlsxImporter:x=null}=e,L=f.getFileList();function Q(i){let E=window.prompt(`Rename file ${i} to what?`,i);if(E){let N=f.key(i),le=window.localStorage.getItem(N);window.localStorage.setItem(f.key(E),le),window.localStorage.removeItem(N),t(6,L=f.getFileList()),r==i&&ue(_,r=E,r)}}function W(i){let E=f.key(i);Se(`${i}.json`,window.localStorage.getItem(E))}function T(i){if(!window.confirm(`Really delete file ${i}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let E=f.key(i);Se(`${i}.json`,window.localStorage.getItem(E)),window.localStorage.removeItem(E),r==i&&(ue(_,r="",r),ue(v,l=f.emptyState(),l),window.localStorage.setItem(f.key("last-opened-file"),"")),t(6,L=f.getFileList())}function O(){let i=window.prompt("What do you want to name your new file?");i&&(ue(_,r=i,r),ue(v,l=f.emptyState(),l),t(6,L=f.saveAndGetFileList(r,l)),Fe(`${pe}/${f.prefix}overview`))}function G(i,E){let N=Ne(i,".json");try{let le=JSON.parse(E);f.validate(le),t(6,L=f.saveAndGetFileList(N,le)),V(N)}catch(le){window.alert(`Couldn't load ${N}: ${le}`)}}function h(i){let{filename:E,data:N}=i.detail;t(6,L=f.saveAndGetFileList(E,N)),V(E)}function V(i){try{let E=f.loadFile(i);ue(_,r=i,r),ue(v,l=E,l),Fe(`${pe}/${f.prefix}overview`)}catch(E){window.alert(`Couldn't load ${i}: ${E}`)}return!1}const g=()=>f.exportAll(),d=i=>V(i),k=i=>W(i),b=i=>Q(i),Y=i=>T(i);return n.$$set=i=>{"files"in i&&t(0,f=i.files),"currentFile"in i&&m(t(1,_=i.currentFile)),"state"in i&&o(t(2,v=i.state)),"service"in i&&t(3,C=i.service),"fileObjectType"in i&&t(4,D=i.fileObjectType),"xlsxImporter"in i&&t(5,x=i.xlsxImporter),"$$scope"in i&&t(21,c=i.$$scope)},[f,_,v,C,D,x,L,r,Q,W,T,O,G,h,V,w,g,d,k,b,Y,c]}class Xt extends Be{constructor(e){super(),Je(this,e,wt,vt,je,{files:0,currentFile:1,state:2,service:3,fileObjectType:4,xlsxImporter:5})}}export{Xt as F};
