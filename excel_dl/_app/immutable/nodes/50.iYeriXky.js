import{s as C,e as j,a as x,c as T,m as E,g as b,i as p,f as u,k as L,t as U,d as B}from"../chunks/scheduler.BJ06nkRu.js";import{S as O,i as R,c as _,a as w,m as k,t as g,b as v,d as y}from"../chunks/index.Dmc4uC9p.js";import{e as D}from"../chunks/da_log.CToQkUT-.js";import{s as F}from"../chunks/data.DZpt5meT.js";import{D as J}from"../chunks/DefaultButton.CRXvyloG.js";/* empty css                                                               */import{T as h}from"../chunks/TextArea.dqrL6eGj.js";import{E as V}from"../chunks/exceljs.min.BuyXGIGS.js";const W=""+new URL("../assets/blank_route_check.CfWjwSGn.xlsx",import.meta.url).href;async function G(s){console.log("Loading blank route check xlsx");let o=await(await fetch(W)).arrayBuffer(),n=new V.Workbook;await n.xlsx.load(o),n.eachSheet((f,i)=>{f.conditionalFormattings=[]}),console.log("Writing route check xlsx");let t=await n.xlsx.writeBuffer();N(t,"out.xlsx")}function N(s,a){let o=new Blob([s],{type:"application/octet-stream"}),n=URL.createObjectURL(o),t=document.createElement("a");t.href=n,t.download=a,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(n)}function P(s){let a;return{c(){a=U("Convert to .xlsx (takes a few seconds)")},l(o){a=B(o,"Convert to .xlsx (takes a few seconds)")},m(o,n){p(o,a,n)},d(o){o&&u(a)}}}function q(s){let a,o=`This page is for internal use only. The values below are TSV (tab-separated
  values), copyable into Excel.`,n,t,f,i,c,l,$,m,d;return t=new h({props:{label:"TSV output, just the one row of values",value:s[3]}}),i=new h({props:{label:"TSV output with header",value:`${s[2]}
${s[3]}
`}}),l=new h({props:{label:"JSON mapping",value:JSON.stringify(Object.fromEntries(s[1]),null,"  ")}}),m=new J({props:{$$slots:{default:[P]},$$scope:{ctx:s}}}),m.$on("click",s[4]),{c(){a=j("p"),a.textContent=o,n=x(),_(t.$$.fragment),f=x(),_(i.$$.fragment),c=x(),_(l.$$.fragment),$=x(),_(m.$$.fragment)},l(e){a=T(e,"P",{"data-svelte-h":!0}),E(a)!=="svelte-5ssfe3"&&(a.textContent=o),n=b(e),w(t.$$.fragment,e),f=b(e),w(i.$$.fragment,e),c=b(e),w(l.$$.fragment,e),$=b(e),w(m.$$.fragment,e)},m(e,r){p(e,a,r),p(e,n,r),k(t,e,r),p(e,f,r),k(i,e,r),p(e,c,r),k(l,e,r),p(e,$,r),k(m,e,r),d=!0},p(e,[r]){const S={};r&32&&(S.$$scope={dirty:r,ctx:e}),m.$set(S)},i(e){d||(g(t.$$.fragment,e),g(i.$$.fragment,e),g(l.$$.fragment,e),g(m.$$.fragment,e),d=!0)},o(e){v(t.$$.fragment,e),v(i.$$.fragment,e),v(l.$$.fragment,e),v(m.$$.fragment,e),d=!1},d(e){e&&(u(a),u(n),u(f),u(c),u($)),y(t,e),y(i,e),y(l,e),y(m,e)}}}function A(s,a,o){let n;L(s,F,l=>o(0,n=l));let t=D(n),f=t.map(l=>l[0]).join("	"),i=t.map(l=>`"${l[1]}"`).join("	");return[n,t,f,i,()=>G()]}class Z extends O{constructor(a){super(),R(this,a,A,q,C,{})}}export{Z as component};
