import{s as Ue,p as F,e as T,a as h,t as le,c as E,x as ae,g as d,b as ue,d as me,f as N,q as oe,i as re,h as l,r as K,k as Qe,O as it,w as Ve,A as ot,j as ut}from"../chunks/scheduler.C0ulHN8K.js";import{S as Xe,i as et,e as x,c as k,a as C,m as S,t as c,g as lt,b as y,f as mt,d as L}from"../chunks/index.D0begEaS.js";import{p as we}from"../chunks/index.BkhiDiyt.js";import{S as ke}from"../chunks/Select.BD67FBW0.js";import{T as Me}from"../chunks/TextArea.rFpIclU-.js";import{T as Je}from"../chunks/TextInput.DYQX_wRu.js";import{s as P}from"../chunks/data.Bw80kV4V.js";import{a as ft,t as pt,r as gt,f as $t,d as ht}from"../chunks/lists.Ci0sBo6t.js";import"../chunks/paths.DzSNGWMn.js";import{E as dt}from"../chunks/ErrorMessage.MCHYhRZR.js";import{F as _t}from"../chunks/FileInput.CSr50loT.js";import{W as ct,S as vt}from"../chunks/WarningButton.1L7-E1vj.js";import{E as yt}from"../chunks/ExternalLink.zCV_yNpK.js";/* empty css                                                    */import{M as bt,b as wt,C as kt}from"../chunks/index.CcQZss1o.js";import{t as Ct}from"../chunks/index.BKhVOauk.js";import{D as We}from"../chunks/DecimalInput.C261lj8P.js";function Ye(t){let e,i,s,n;return e=new ct({props:{$$slots:{default:[St]},$$scope:{ctx:t}}}),e.$on("click",t[3]),s=new vt({props:{$$slots:{default:[Lt]},$$scope:{ctx:t}}}),s.$on("click",t[6]),{c(){k(e.$$.fragment),i=h(),k(s.$$.fragment)},l(r){C(e.$$.fragment,r),i=d(r),C(s.$$.fragment,r)},m(r,$){S(e,r,$),re(r,i,$),S(s,r,$),n=!0},p(r,$){const b={};$&256&&(b.$$scope={dirty:$,ctx:r}),e.$set(b);const m={};$&256&&(m.$$scope={dirty:$,ctx:r}),s.$set(m)},i(r){n||(c(e.$$.fragment,r),c(s.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),y(s.$$.fragment,r),n=!1},d(r){r&&N(i),L(e,r),L(s,r)}}}function St(t){let e;return{c(){e=le("Clear map")},l(i){e=me(i,"Clear map")},m(i,s){re(i,e,s)},d(i){i&&N(e)}}}function Lt(t){let e;return{c(){e=le("Zoom to fit")},l(i){e=me(i,"Zoom to fit")},m(i,s){re(i,e,s)},d(i){i&&N(e)}}}function Mt(t){let e;return{c(){e=le("Scheme Sketcher")},l(i){e=me(i,"Scheme Sketcher")},m(i,s){re(i,e,s)},d(i){i&&N(e)}}}function Rt(t){let e,i;return e=new kt({props:{gj:t[2].summary.networkMap,show:!0}}),{c(){k(e.$$.fragment)},l(s){C(e.$$.fragment,s)},m(s,n){S(e,s,n),i=!0},p(s,n){const r={};n&4&&(r.gj=s[2].summary.networkMap),e.$set(r)},i(s){i||(c(e.$$.fragment,s),i=!0)},o(s){y(e.$$.fragment,s),i=!1},d(s){L(e,s)}}}function It(t){let e,i="Network Map",s,n,r,$,b=`Please add a map showing the section of route being scored in this file.
      If the route is part of a longer route of multiple sections (covered in
      other files), please show this on the map for context too.`,m,I,J,g,j,A,_,se="You can use the external Scheme Sketcher tool to draw this map:",te,p,o,W,w,fe,pe,q,ve="Choose the area best covering this scheme",ge,D,ye=`Use the <i>New route</i>
        tool to sketch the route. It can contain segments snapped to existing roads
        or free-hand segments.`,$e,Y,z=`Optionally, use the <i>Split route</i>
        tool to denote just the sections assessed in this file.`,he,U,B=`You can set <i>Name</i>
        and
        <i>Description</i>
        to whatever is useful for display on the map`,de,Q,G=`Save the map by clicking <i>Manage files</i>
        , then
        <i>Save</i>`,_e,X,ee="Load the saved file above",ie,ne,V,be,ce;I=new _t({props:{label:"Import from GeoJSON file",onLoad:t[4]}}),g=new dt({props:{errorMessage:t[1]}});let v=t[2].summary.networkMap.features.length>0&&Ye(t);w=new yt({props:{href:"https://acteng.github.io/atip",$$slots:{default:[Mt]},$$scope:{ctx:t}}});function Ce(f){t[7](f)}let Se={$$slots:{default:[Rt]},$$scope:{ctx:t}};return t[0]!==void 0&&(Se.map=t[0]),V=new bt({props:Se}),F.push(()=>x(V,"map",Ce)),{c(){e=T("h2"),e.textContent=i,s=h(),n=T("div"),r=T("div"),$=T("p"),$.textContent=b,m=h(),k(I.$$.fragment),J=h(),k(g.$$.fragment),j=h(),v&&v.c(),A=h(),_=T("p"),_.textContent=se,te=h(),p=T("ol"),o=T("li"),W=le("Go to the "),k(w.$$.fragment),fe=le(" tool"),pe=h(),q=T("li"),q.textContent=ve,ge=h(),D=T("li"),D.innerHTML=ye,$e=h(),Y=T("li"),Y.innerHTML=z,he=h(),U=T("li"),U.innerHTML=B,de=h(),Q=T("li"),Q.innerHTML=G,_e=h(),X=T("li"),X.textContent=ee,ie=h(),ne=T("div"),k(V.$$.fragment),this.h()},l(f){e=E(f,"H2",{"data-svelte-h":!0}),ae(e)!=="svelte-1fkh1ci"&&(e.textContent=i),s=d(f),n=E(f,"DIV",{style:!0});var M=ue(n);r=E(M,"DIV",{style:!0});var O=ue(r);$=E(O,"P",{"data-svelte-h":!0}),ae($)!=="svelte-1r7hkzo"&&($.textContent=b),m=d(O),C(I.$$.fragment,O),J=d(O),C(g.$$.fragment,O),j=d(O),v&&v.l(O),A=d(O),_=E(O,"P",{"data-svelte-h":!0}),ae(_)!=="svelte-1els6f1"&&(_.textContent=se),te=d(O),p=E(O,"OL",{});var R=ue(p);o=E(R,"LI",{});var Z=ue(o);W=me(Z,"Go to the "),C(w.$$.fragment,Z),fe=me(Z," tool"),Z.forEach(N),pe=d(R),q=E(R,"LI",{"data-svelte-h":!0}),ae(q)!=="svelte-aj705b"&&(q.textContent=ve),ge=d(R),D=E(R,"LI",{"data-svelte-h":!0}),ae(D)!=="svelte-1vb2muj"&&(D.innerHTML=ye),$e=d(R),Y=E(R,"LI",{"data-svelte-h":!0}),ae(Y)!=="svelte-3xdyru"&&(Y.innerHTML=z),he=d(R),U=E(R,"LI",{"data-svelte-h":!0}),ae(U)!=="svelte-1r1ljcj"&&(U.innerHTML=B),de=d(R),Q=E(R,"LI",{"data-svelte-h":!0}),ae(Q)!=="svelte-sz4wlr"&&(Q.innerHTML=G),_e=d(R),X=E(R,"LI",{"data-svelte-h":!0}),ae(X)!=="svelte-x3zkxb"&&(X.textContent=ee),R.forEach(N),O.forEach(N),ie=d(M),ne=E(M,"DIV",{style:!0});var Le=ue(ne);C(V.$$.fragment,Le),Le.forEach(N),M.forEach(N),this.h()},h(){oe(r,"width","30%"),oe(r,"overflow-y","scroll"),oe(r,"padding","10px"),oe(r,"border","1px solid black"),oe(ne,"position","relative"),oe(ne,"width","70%"),oe(n,"display","flex"),oe(n,"height","80vh")},m(f,M){re(f,e,M),re(f,s,M),re(f,n,M),l(n,r),l(r,$),l(r,m),S(I,r,null),l(r,J),S(g,r,null),l(r,j),v&&v.m(r,null),l(r,A),l(r,_),l(r,te),l(r,p),l(p,o),l(o,W),S(w,o,null),l(o,fe),l(p,pe),l(p,q),l(p,ge),l(p,D),l(p,$e),l(p,Y),l(p,he),l(p,U),l(p,de),l(p,Q),l(p,_e),l(p,X),l(n,ie),l(n,ne),S(V,ne,null),ce=!0},p(f,[M]){const O={};M&2&&(O.errorMessage=f[1]),g.$set(O),f[2].summary.networkMap.features.length>0?v?(v.p(f,M),M&4&&c(v,1)):(v=Ye(f),v.c(),c(v,1),v.m(r,A)):v&&(lt(),y(v,1,1,()=>{v=null}),mt());const R={};M&256&&(R.$$scope={dirty:M,ctx:f}),w.$set(R);const Z={};M&260&&(Z.$$scope={dirty:M,ctx:f}),!be&&M&1&&(be=!0,Z.map=f[0],K(()=>be=!1)),V.$set(Z)},i(f){ce||(c(I.$$.fragment,f),c(g.$$.fragment,f),c(v),c(w.$$.fragment,f),c(V.$$.fragment,f),ce=!0)},o(f){y(I.$$.fragment,f),y(g.$$.fragment,f),y(v),y(w.$$.fragment,f),y(V.$$.fragment,f),ce=!1},d(f){f&&(N(e),N(s),N(n)),L(I),L(g),v&&v.d(),L(w),L(V)}}}function Ot(t,e,i){let s;Qe(t,P,g=>i(2,s=g));let n,r="";it(()=>{m(!1)});function $(){window.confirm("Do you really want to erase the map data?")&&Ve(P,s.summary.networkMap={type:"FeatureCollection",features:[]},s)}function b(g,j){var A;i(1,r="");try{let _=JSON.parse(j);if(_.type!="FeatureCollection")throw new Error("This doesn't look like a GeoJSON file");if(!((A=_.origin)!=null&&A.startsWith("atip-")))throw new Error("This file wasn't produced with the Scheme Sketcher");if(_.crs)throw new Error("This file has a Coordinate Reference System set; it's not suitable for a web map");Ve(P,s.summary.networkMap=_,s),m(!0)}catch(_){i(1,r=`Error importing ${g}: ${_}`)}}function m(g){let j={type:"FeatureCollection",features:s.summary.networkMap.features};j.features.length>0&&n.fitBounds(wt(j),{padding:20,animate:g})}const I=()=>m(!0);function J(g){n=g,i(0,n)}return[n,r,s,$,b,m,I,J]}class Tt extends Xe{constructor(e){super(),et(this,e,Ot,It,Ue,{})}}function Ze(t){let e,i,s,n=t[1].toFixed(2)+"",r,$;return{c(){e=T("p"),i=le("LineStrings in the Network Map cover a total of "),s=T("b"),r=le(n),$=le(`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`)},l(b){e=E(b,"P",{});var m=ue(e);i=me(m,"LineStrings in the Network Map cover a total of "),s=E(m,"B",{});var I=ue(s);r=me(I,n),I.forEach(N),$=me(m,`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`),m.forEach(N)},m(b,m){re(b,e,m),l(e,i),l(e,s),l(s,r),l(e,$)},p(b,m){m&2&&n!==(n=b[1].toFixed(2)+"")&&ut(r,n)},d(b){b&&N(e)}}}function Et(t){let e,i,s,n,r,$,b,m,I,J,g,j,A,_,se,te,p,o,W,w,fe,pe,q,ve,ge,D,ye,$e,Y,z,he,U,B,de,Q,G,_e,X,ee,ie;function ne(a){t[2](a)}let V={label:"Scheme reference"};t[0].summary.schemeReference!==void 0&&(V.value=t[0].summary.schemeReference),i=new Je({props:V}),F.push(()=>x(i,"value",ne));function be(a){t[3](a)}let ce={label:"Scheme name"};t[0].summary.schemeName!==void 0&&(ce.value=t[0].summary.schemeName),r=new Je({props:ce}),F.push(()=>x(r,"value",be));function v(a){t[4](a)}let Ce={label:"Scheme summary"};t[0].summary.schemeSummary!==void 0&&(Ce.value=t[0].summary.schemeSummary),m=new Me({props:Ce}),F.push(()=>x(m,"value",v));function Se(a){t[5](a)}let f={label:"Authority",emptyOption:!0,choices:we(ft)};t[0].summary.authority!==void 0&&(f.value=t[0].summary.authority),g=new ke({props:f}),F.push(()=>x(g,"value",Se));function M(a){t[6](a)}let O={label:"Transport / Combined Authority",emptyOption:!0,choices:we(pt)};t[0].summary.transportOrCombinedAuthority!==void 0&&(O.value=t[0].summary.transportOrCombinedAuthority),_=new ke({props:O}),F.push(()=>x(_,"value",M));function R(a){t[7](a)}let Z={label:"Region",emptyOption:!0,choices:we(gt)};t[0].summary.region!==void 0&&(Z.value=t[0].summary.region),p=new ke({props:Z}),F.push(()=>x(p,"value",R));function Le(a){t[8](a)}let Re={label:"Funding programme",emptyOption:!0,choices:we($t)};t[0].summary.fundingProgramme!==void 0&&(Re.value=t[0].summary.fundingProgramme),w=new ke({props:Re}),F.push(()=>x(w,"value",Le));function tt(a){t[9](a)}let Ie={label:"Design stage",emptyOption:!0,choices:we(ht)};t[0].summary.designStage!==void 0&&(Ie.value=t[0].summary.designStage),q=new ke({props:Ie}),F.push(()=>x(q,"value",tt));function nt(a){t[10](a)}let Oe={label:"Funding conditions"};t[0].summary.fundingConditions!==void 0&&(Oe.value=t[0].summary.fundingConditions),D=new Me({props:Oe}),F.push(()=>x(D,"value",nt));let H=t[1]&&Ze(t);function at(a){t[11](a)}let Te={label:"Route length assessed here (km)",width:6,min:0};t[0].summary.assessedRouteLengthKm!==void 0&&(Te.value=t[0].summary.assessedRouteLengthKm),z=new We({props:Te}),F.push(()=>x(z,"value",at));function rt(a){t[12](a)}let Ee={label:"Total route length (km)",width:6,min:0};t[0].summary.totalRouteLengthKm!==void 0&&(Ee.value=t[0].summary.totalRouteLengthKm),B=new We({props:Ee}),F.push(()=>x(B,"value",rt));function st(a){t[13](a)}let Ne={label:"Notes"};return t[0].summary.notes!==void 0&&(Ne.value=t[0].summary.notes),G=new Me({props:Ne}),F.push(()=>x(G,"value",st)),ee=new Tt({}),{c(){e=T("div"),k(i.$$.fragment),n=h(),k(r.$$.fragment),b=h(),k(m.$$.fragment),J=h(),k(g.$$.fragment),A=h(),k(_.$$.fragment),te=h(),k(p.$$.fragment),W=h(),k(w.$$.fragment),pe=h(),k(q.$$.fragment),ge=h(),k(D.$$.fragment),$e=h(),H&&H.c(),Y=h(),k(z.$$.fragment),U=h(),k(B.$$.fragment),Q=h(),k(G.$$.fragment),X=h(),k(ee.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var u=ue(e);C(i.$$.fragment,u),n=d(u),C(r.$$.fragment,u),b=d(u),C(m.$$.fragment,u),J=d(u),C(g.$$.fragment,u),A=d(u),C(_.$$.fragment,u),te=d(u),C(p.$$.fragment,u),W=d(u),C(w.$$.fragment,u),pe=d(u),C(q.$$.fragment,u),ge=d(u),C(D.$$.fragment,u),$e=d(u),H&&H.l(u),Y=d(u),C(z.$$.fragment,u),U=d(u),C(B.$$.fragment,u),Q=d(u),C(G.$$.fragment,u),X=d(u),C(ee.$$.fragment,u),u.forEach(N),this.h()},h(){ot(e,"class","govuk-width-container")},m(a,u){re(a,e,u),S(i,e,null),l(e,n),S(r,e,null),l(e,b),S(m,e,null),l(e,J),S(g,e,null),l(e,A),S(_,e,null),l(e,te),S(p,e,null),l(e,W),S(w,e,null),l(e,pe),S(q,e,null),l(e,ge),S(D,e,null),l(e,$e),H&&H.m(e,null),l(e,Y),S(z,e,null),l(e,U),S(B,e,null),l(e,Q),S(G,e,null),l(e,X),S(ee,e,null),ie=!0},p(a,[u]){const qe={};!s&&u&1&&(s=!0,qe.value=a[0].summary.schemeReference,K(()=>s=!1)),i.$set(qe);const De={};!$&&u&1&&($=!0,De.value=a[0].summary.schemeName,K(()=>$=!1)),r.$set(De);const He={};!I&&u&1&&(I=!0,He.value=a[0].summary.schemeSummary,K(()=>I=!1)),m.$set(He);const Pe={};!j&&u&1&&(j=!0,Pe.value=a[0].summary.authority,K(()=>j=!1)),g.$set(Pe);const je={};!se&&u&1&&(se=!0,je.value=a[0].summary.transportOrCombinedAuthority,K(()=>se=!1)),_.$set(je);const Ae={};!o&&u&1&&(o=!0,Ae.value=a[0].summary.region,K(()=>o=!1)),p.$set(Ae);const Fe={};!fe&&u&1&&(fe=!0,Fe.value=a[0].summary.fundingProgramme,K(()=>fe=!1)),w.$set(Fe);const Ke={};!ve&&u&1&&(ve=!0,Ke.value=a[0].summary.designStage,K(()=>ve=!1)),q.$set(Ke);const xe={};!ye&&u&1&&(ye=!0,xe.value=a[0].summary.fundingConditions,K(()=>ye=!1)),D.$set(xe),a[1]?H?H.p(a,u):(H=Ze(a),H.c(),H.m(e,Y)):H&&(H.d(1),H=null);const ze={};!he&&u&1&&(he=!0,ze.value=a[0].summary.assessedRouteLengthKm,K(()=>he=!1)),z.$set(ze);const Be={};!de&&u&1&&(de=!0,Be.value=a[0].summary.totalRouteLengthKm,K(()=>de=!1)),B.$set(Be);const Ge={};!_e&&u&1&&(_e=!0,Ge.value=a[0].summary.notes,K(()=>_e=!1)),G.$set(Ge)},i(a){ie||(c(i.$$.fragment,a),c(r.$$.fragment,a),c(m.$$.fragment,a),c(g.$$.fragment,a),c(_.$$.fragment,a),c(p.$$.fragment,a),c(w.$$.fragment,a),c(q.$$.fragment,a),c(D.$$.fragment,a),c(z.$$.fragment,a),c(B.$$.fragment,a),c(G.$$.fragment,a),c(ee.$$.fragment,a),ie=!0)},o(a){y(i.$$.fragment,a),y(r.$$.fragment,a),y(m.$$.fragment,a),y(g.$$.fragment,a),y(_.$$.fragment,a),y(p.$$.fragment,a),y(w.$$.fragment,a),y(q.$$.fragment,a),y(D.$$.fragment,a),y(z.$$.fragment,a),y(B.$$.fragment,a),y(G.$$.fragment,a),y(ee.$$.fragment,a),ie=!1},d(a){a&&N(e),L(i),L(r),L(m),L(g),L(_),L(p),L(w),L(q),L(D),H&&H.d(),L(z),L(B),L(G),L(ee)}}}function Nt(t,e,i){let s,n;Qe(t,P,o=>i(0,n=o));function r(o){let W=0;for(let w of o.features)w.geometry.type=="LineString"&&(W+=Ct(w,{units:"kilometers"}));return W>0?W:null}function $(o){t.$$.not_equal(n.summary.schemeReference,o)&&(n.summary.schemeReference=o,P.set(n))}function b(o){t.$$.not_equal(n.summary.schemeName,o)&&(n.summary.schemeName=o,P.set(n))}function m(o){t.$$.not_equal(n.summary.schemeSummary,o)&&(n.summary.schemeSummary=o,P.set(n))}function I(o){t.$$.not_equal(n.summary.authority,o)&&(n.summary.authority=o,P.set(n))}function J(o){t.$$.not_equal(n.summary.transportOrCombinedAuthority,o)&&(n.summary.transportOrCombinedAuthority=o,P.set(n))}function g(o){t.$$.not_equal(n.summary.region,o)&&(n.summary.region=o,P.set(n))}function j(o){t.$$.not_equal(n.summary.fundingProgramme,o)&&(n.summary.fundingProgramme=o,P.set(n))}function A(o){t.$$.not_equal(n.summary.designStage,o)&&(n.summary.designStage=o,P.set(n))}function _(o){t.$$.not_equal(n.summary.fundingConditions,o)&&(n.summary.fundingConditions=o,P.set(n))}function se(o){t.$$.not_equal(n.summary.assessedRouteLengthKm,o)&&(n.summary.assessedRouteLengthKm=o,P.set(n))}function te(o){t.$$.not_equal(n.summary.totalRouteLengthKm,o)&&(n.summary.totalRouteLengthKm=o,P.set(n))}function p(o){t.$$.not_equal(n.summary.notes,o)&&(n.summary.notes=o,P.set(n))}return t.$$.update=()=>{t.$$.dirty&1&&i(1,s=r(n.summary.networkMap))},[n,s,$,b,m,I,J,g,j,A,_,se,te,p]}class Ut extends Xe{constructor(e){super(),et(this,e,Nt,Et,Ue,{})}}export{Ut as component};
