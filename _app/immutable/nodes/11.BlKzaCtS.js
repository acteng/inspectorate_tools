import{s as H,e as $,t as x,a as E,c as d,b,d as k,f as l,g as L,m as M,i as u,h as y,F as U,k as q,o as I,n as J}from"../chunks/scheduler.D1qsIhff.js";import{S as K,i as O,c as S,a as F,m as T,t as W,b as P,d as A}from"../chunks/index.DMPy99Kf.js";import{e as R}from"../chunks/each.SoOTu3V6.js";import{b as j}from"../chunks/paths.CK5WMdWq.js";/* empty css                                                    */import{S as z}from"../chunks/SecondaryButton.C6yksGGa.js";/* empty css                                                               */import{E as D}from"../chunks/ExternalLink.aCJP2rrR.js";import{g as G}from"../chunks/index.DogaJcBz.js";import{s as N}from"../chunks/data.CkkogQGi.js";import{E as Q}from"../chunks/exceljs.min.BuyXGIGS.js";import{d as V}from"../chunks/index.D8w3pjHT.js";const X=""+new URL("../assets/blank_area_check.Bd5ntWwK.xlsx",import.meta.url).href;async function Y(s){console.log("Loading blank area check xlsx");let a=await(await fetch(X)).arrayBuffer(),o=new Q.Workbook;await o.xlsx.load(a),console.log("Writing area check xlsx");let r=await o.xlsx.writeBuffer();V(r,"out.xlsx")}function Z(s,t,a){const o=s.slice();return o[3]=t[a][0],o[4]=t[a][1],o}function ee(s){let t;return{c(){t=x(`scheme review tool
  `)},l(a){t=k(a,`scheme review tool
  `)},m(a,o){u(a,t,o)},d(a){a&&l(t)}}}function te(s){let t,a,o;return{c(){t=$("li"),a=$("a"),o=x(s[4]),this.h()},l(r){t=d(r,"LI",{});var i=b(t);a=d(i,"A",{href:!0});var f=b(a);o=k(f,s[4]),f.forEach(l),i.forEach(l),this.h()},h(){I(a,"href",""+(j+s[3]))},m(r,i){u(r,t,i),y(t,a),y(a,o)},p:J,d(r){r&&l(t)}}}function ae(s){let t;return{c(){t=x("Convert to .xlsx (takes a few seconds)")},l(a){t=k(a,"Convert to .xlsx (takes a few seconds)")},m(a,o){u(a,t,o)},d(a){a&&l(t)}}}function oe(s){let t,a,o,r,i,f,w,m,g,h,B=`<i>When you open the file, you need to force Excel to recalculate all formulas
    with Ctrl + Alt + F9</i>`,v;o=new D({props:{href:"https://www.gov.uk/government/publications/active-travel-england-scheme-review-tools",$$slots:{default:[ee]},$$scope:{ctx:s}}});let C=R(G("/area_check")),p=[];for(let e=0;e<C.length;e+=1)p[e]=te(Z(s,C,e));return m=new z({props:{$$slots:{default:[ae]},$$scope:{ctx:s}}}),m.$on("click",s[1]),{c(){t=$("p"),a=x("This is an experimental version of a "),S(o.$$.fragment),r=x("."),i=E(),f=$("ol");for(let e=0;e<p.length;e+=1)p[e].c();w=E(),S(m.$$.fragment),g=E(),h=$("p"),h.innerHTML=B},l(e){t=d(e,"P",{});var n=b(t);a=k(n,"This is an experimental version of a "),F(o.$$.fragment,n),r=k(n,"."),n.forEach(l),i=L(e),f=d(e,"OL",{});var c=b(f);for(let _=0;_<p.length;_+=1)p[_].l(c);c.forEach(l),w=L(e),F(m.$$.fragment,e),g=L(e),h=d(e,"P",{"data-svelte-h":!0}),M(h)!=="svelte-6hhtkc"&&(h.innerHTML=B)},m(e,n){u(e,t,n),y(t,a),T(o,t,null),y(t,r),u(e,i,n),u(e,f,n);for(let c=0;c<p.length;c+=1)p[c]&&p[c].m(f,null);u(e,w,n),T(m,e,n),u(e,g,n),u(e,h,n),v=!0},p(e,[n]){const c={};n&128&&(c.$$scope={dirty:n,ctx:e}),o.$set(c);const _={};n&128&&(_.$$scope={dirty:n,ctx:e}),m.$set(_)},i(e){v||(W(o.$$.fragment,e),W(m.$$.fragment,e),v=!0)},o(e){P(o.$$.fragment,e),P(m.$$.fragment,e),v=!1},d(e){e&&(l(t),l(i),l(f),l(w),l(g),l(h)),A(o),U(p,e),A(m,e)}}}function ne(s,t,a){let o;return q(s,N,i=>a(0,o=i)),[o,()=>Y()]}class de extends K{constructor(t){super(),O(this,t,ne,oe,H,{})}}export{de as component};
