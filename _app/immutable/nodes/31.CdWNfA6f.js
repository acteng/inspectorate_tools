import{s as Le,E as Ee,i as I,f as $,a8 as Yt,a7 as er,k as pe,U as vt,a9 as kt,N as Et,e as V,c as x,b as W,l as Pt,u as $t,m as Ct,o as Lt,v as ne,r as q,R as nt,S as ot,h as N,n as Pe,a as D,g as R,w as re,x as le,q as Mt,t as Me,d as Oe,j as Ot}from"../chunks/scheduler.BV_JqZpr.js";import{S as Ae,i as Fe,t as w,g as ye,b as k,f as _e,c as A,a as F,m as S,d as T,e as ue}from"../chunks/index.DDJL-Wug.js";import{e as $e}from"../chunks/each.DPttds9k.js";import{d as tr,m as se,i as rr,e as At,M as nr,G as or,h as it}from"../chunks/MapLibreMap.D4TVTeLt.js";import{p as at}from"../chunks/index.CHGyWvXl.js";import{c as oe}from"../chunks/colors.CYEpEtTL.js";import{S as ir,W as ar}from"../chunks/WarningButton.Ck9VEuu1.js";import{S as st}from"../chunks/Select.CsgDAO5u.js";import{T as sr}from"../chunks/TextInput.XULGbN7s.js";import{B as lr,G as ur,a as fr,c as cr,M as lt}from"../chunks/GeoreferenceLayer.aO7-9gSU.js";import{L as ut}from"../chunks/LineLayer.BGupV7fa.js";import{s as Z}from"../chunks/data.BUqxnV5Q.js";const mr=t=>({features:t[0]&16,data:t[0]&16,map:t[0]&4,close:t[0]&1}),ft=t=>{var e;return{features:t[4],data:(e=t[4])==null?void 0:e[0],map:t[2],close:t[31]}};function ct(t){let e,r,n=(t[4]||t[3]instanceof se.Marker)&&mt(t);return{c(){e=V("div"),n&&n.c()},l(o){e=x(o,"DIV",{});var i=W(e);n&&n.l(i),i.forEach($)},m(o,i){I(o,e,i),n&&n.m(e,null),t[32](e),r=!0},p(o,i){o[4]||o[3]instanceof se.Marker?n?(n.p(o,i),i[0]&24&&w(n,1)):(n=mt(o),n.c(),w(n,1),n.m(e,null)):n&&(ye(),k(n,1,1,()=>{n=null}),_e())},i(o){r||(w(n),r=!0)},o(o){k(n),r=!1},d(o){o&&$(e),n&&n.d(),t[32](null)}}}function mt(t){let e;const r=t[30].default,n=Pt(r,t,t[29],ft);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,i){n&&n.m(o,i),e=!0},p(o,i){n&&n.p&&(!e||i[0]&536870933)&&$t(n,r,o,o[29],e?Lt(r,o[29],i,mr):Ct(o[29]),ft)},i(o){e||(w(n,o),e=!0)},o(o){k(n,o),e=!1},d(o){n&&n.d(o)}}}function pr(t){let e,r,n=t[9].default&&ct(t);return{c(){n&&n.c(),e=Ee()},l(o){n&&n.l(o),e=Ee()},m(o,i){n&&n.m(o,i),I(o,e,i),r=!0},p(o,i){o[9].default?n?(n.p(o,i),i[0]&512&&w(n,1)):(n=ct(o),n.c(),w(n,1),n.m(e.parentNode,e)):n&&(ye(),k(n,1,1,()=>{n=null}),_e())},i(o){r||(w(n),r=!0)},o(o){k(n),r=!1},d(o){o&&$(e),n&&n.d(o)}}}function gr(t,e,r){let n,o,i,a,s,c,{$$slots:u={},$$scope:g}=e;const m=Yt(u);let{closeButton:_=void 0}=e,{closeOnClickOutside:b=!0}=e,{closeOnClickInside:O=!1}=e,{closeOnMove:B=!1}=e,{openOn:h="click"}=e,{openIfTopMost:H=!0}=e,{focusAfterOpen:J=!0}=e,{anchor:d=void 0}=e,{offset:f=void 0}=e,{popupClass:p=void 0}=e,{maxWidth:y=void 0}=e,{lngLat:M=void 0}=e,{html:C=void 0}=e,{open:L=!1}=e;const ie=er(),{map:Ke,popupTarget:Ze,layerEvent:be,layer:Qe,eventTopMost:xt}=tr();pe(t,Ke,l=>r(2,i=l)),pe(t,Ze,l=>r(3,s=l)),pe(t,be,l=>r(28,a=l)),pe(t,Qe,l=>r(35,c=l));const Kt=["click","dblclick","contextmenu"];let v,we=!1,K;function Zt(){if(!v)return;let l=v.getElement();!l||l===K||(K=l,h==="hover"&&(K.style.pointerEvents="none"),K.addEventListener("mouseenter",()=>{r(24,we=!0)},{passive:!0}),K.addEventListener("mouseleave",()=>{r(24,we=!1)},{passive:!0}),K.addEventListener("click",()=>{O&&r(0,L=!1)},{passive:!0}))}vt(()=>{if(i)return i.on("click",ve),i.on("contextmenu",ve),typeof s=="string"&&(i.on("click",s,te),i.on("dblclick",s,te),i.on("contextmenu",s,te),i.on("mousemove",s,rt),i.on("mouseleave",s,tt),i.on("touchstart",s,Ye),i.on("touchend",s,et)),()=>{i!=null&&i.loaded()&&(v==null||v.remove(),i.off("click",ve),i.off("contextmenu",ve),s instanceof se.Marker?s.getPopup()===v&&s.setPopup(void 0):typeof s=="string"&&(i.off("click",s,te),i.off("dblclick",s,te),i.off("contextmenu",s,te),i.off("mousemove",s,rt),i.off("mouseleave",s,tt),i.off("touchstart",s,Ye),i.off("touchend",s,et)))}});function Xe(l){return H?!("marker"in l)&&!rr(l)&&xt(l)!==c:!1}let z=null,U="normal";function te(l){l.type===h&&(Xe(l)||("layerType"in l?l.layerType==="deckgl"?(r(10,M=l.coordinate),r(4,z=l.object?[l.object]:null)):(r(10,M=l.lngLat),r(4,z=l.features??[])):(r(10,M=l.lngLat),r(4,z=l.features??[])),setTimeout(()=>r(0,L=!0))))}let ae=null;function Ye(l){ae=l.point}function et(l){if(!ae||h!=="hover")return;let qe=ae.dist(l.point);ae=null,qe<3&&(r(10,M=l.lngLat),r(4,z=l.features??[]),v.isOpen()?r(25,U="justOpened"):(r(25,U="opening"),r(0,L=!0)))}function tt(l){h!=="hover"||ae||U!=="normal"||(r(0,L=!1),r(4,z=null))}function rt(l){if(!(h!=="hover"||ae||U!=="normal")){if(Xe(l)){r(0,L=!1),r(4,z=null);return}r(0,L=!0),r(4,z=l.features??[]),r(10,M=l.lngLat)}}function ve(l){if(U==="justOpened"){r(25,U="normal");return}if(!b)return;let qe=[K,s instanceof se.Marker?s==null?void 0:s.getElement():null];L&&v.isOpen()&&!qe.some(je=>je==null?void 0:je.contains(l.originalEvent.target))&&(l.type==="contextmenu"&&h==="contextmenu"||l.type!=="contextmenu")&&r(0,L=!1)}kt(()=>{i&&(v!=null&&v.isOpen())&&v.remove()});let me;const Qt=()=>r(0,L=!1);function Xt(l){ne[l?"unshift":"push"](()=>{me=l,r(1,me)})}return t.$$set=l=>{"closeButton"in l&&r(11,_=l.closeButton),"closeOnClickOutside"in l&&r(12,b=l.closeOnClickOutside),"closeOnClickInside"in l&&r(13,O=l.closeOnClickInside),"closeOnMove"in l&&r(14,B=l.closeOnMove),"openOn"in l&&r(15,h=l.openOn),"openIfTopMost"in l&&r(16,H=l.openIfTopMost),"focusAfterOpen"in l&&r(17,J=l.focusAfterOpen),"anchor"in l&&r(18,d=l.anchor),"offset"in l&&r(19,f=l.offset),"popupClass"in l&&r(20,p=l.popupClass),"maxWidth"in l&&r(21,y=l.maxWidth),"lngLat"in l&&r(10,M=l.lngLat),"html"in l&&r(22,C=l.html),"open"in l&&r(0,L=l.open),"$$scope"in l&&r(29,g=l.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&14336&&r(27,n=_??(!b&&!O)),t.$$.dirty[0]&146685952&&(v||(r(23,v=new se.Popup({closeButton:n,closeOnClick:!1,closeOnMove:B,focusAfterOpen:J,maxWidth:y,className:p,anchor:d,offset:f})),K=v.getElement(),v.on("open",()=>{r(0,L=!0),Zt(),ie("open",v)}),v.on("close",()=>{r(0,L=!1),ie("close",v)}),v.on("hover",()=>{ie("hover",v)}))),t.$$.dirty[0]&8421384&&v&&s instanceof se.Marker&&(h==="click"?s.setPopup(v):s.getPopup()===v&&s.setPopup(void 0)),t.$$.dirty[0]&268468224&&Kt.includes(h)&&(a==null?void 0:a.type)===h&&(te(a),Et(be,a=null,a)),t.$$.dirty[0]&268468224&&r(26,o=h==="hover"&&((a==null?void 0:a.type)==="mousemove"||(a==null?void 0:a.type)==="mouseenter")),t.$$.dirty[0]&352354304&&h==="hover"&&be&&(o&&a&&(a.layerType==="deckgl"?(r(10,M=a.coordinate),r(4,z=a.object?[a.object]:null)):(r(10,M=a.lngLat),r(4,z=a.features??[]))),r(0,L=(o||we)??!1)),t.$$.dirty[0]&12582914&&(me?v.setDOMContent(me):C&&v.setHTML(C)),t.$$.dirty[0]&8389632&&M&&v.setLngLat(M),t.$$.dirty[0]&41943045&&i){let l=v.isOpen();L&&!l?(v.addTo(i),U==="opening"&&r(25,U="justOpened")):!L&&l&&v.remove()}},[L,me,i,s,z,Ke,Ze,be,Qe,m,M,_,b,O,B,h,H,J,d,f,p,y,C,v,we,U,o,n,a,g,u,Qt,Xt]}class hr extends Ae{constructor(e){super(),Fe(this,e,gr,pr,Le,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}const dr=t=>({props:t&8}),pt=t=>({props:br(t[3])});function yr(t){let e,r;const n=t[1].default,o=Pt(n,t,t[2],pt);return{c(){e=V("div"),o&&o.c(),this.h()},l(i){e=x(i,"DIV",{class:!0});var a=W(e);o&&o.l(a),a.forEach($),this.h()},h(){q(e,"class","govuk-prose")},m(i,a){I(i,e,a),o&&o.m(e,null),r=!0},p(i,a){o&&o.p&&(!r||a&12)&&$t(o,n,i,i[2],r?Lt(n,i[2],a,dr):Ct(i[2]),pt)},i(i){r||(w(o,i),r=!0)},o(i){k(o,i),r=!1},d(i){i&&$(e),o&&o.d(i)}}}function _r(t){let e,r;return e=new hr({props:{openOn:t[0],$$slots:{default:[yr,({features:n})=>({3:n}),({features:n})=>n?8:0]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,o){S(e,n,o),r=!0},p(n,[o]){const i={};o&1&&(i.openOn=n[0]),o&12&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){r||(w(e.$$.fragment,n),r=!0)},o(n){k(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function br(t){return t?t[0].properties??{}:{}}function wr(t,e,r){let{$$slots:n={},$$scope:o}=e,{openOn:i="hover"}=e;return t.$$set=a=>{"openOn"in a&&r(0,i=a.openOn),"$$scope"in a&&r(2,o=a.$$scope)},[i,n,o]}class Ft extends Ae{constructor(e){super(),Fe(this,e,wr,_r,Le,{openOn:0})}}var vr=Object.defineProperty,E=(t,e)=>vr(t,"name",{value:e,configurable:!0}),kr=class{constructor(e){this.direction=!1,this.compareProperties=!0;var r,n,o;this.precision=10**-((r=e==null?void 0:e.precision)!=null?r:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,r){if(e.type!==r.type||!ge(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(e,r);case"GeometryCollection":return this.compareGeometryCollection(e,r);case"Feature":return this.compareFeature(e,r);case"FeatureCollection":return this.compareFeatureCollection(e,r);default:if(e.type.startsWith("Multi")){const n=Ge(e),o=Ge(r);return n.every(i=>o.some(a=>this.compare(i,a)))}}return!1}compareCoord(e,r){return e.length===r.length&&e.every((n,o)=>Math.abs(n-r[o])<this.precision)}compareLine(e,r,n=0,o=!1){if(!ge(e,r))return!1;const i=e;let a=r;if(o&&!this.compareCoord(i[0],a[0])){const c=this.fixStartIndex(a,i);if(c)a=c;else return!1}const s=this.compareCoord(i[n],a[n]);return this.direction||s?this.comparePath(i,a):this.compareCoord(i[n],a[a.length-(1+n)])?this.comparePath(i.slice().reverse(),a):!1}fixStartIndex(e,r){let n,o=-1;for(let i=0;i<e.length;i++)if(this.compareCoord(e[i],r[0])){o=i;break}return o>=0&&(n=[].concat(e.slice(o,e.length),e.slice(1,o+1))),n}comparePath(e,r){return e.every((n,o)=>this.compareCoord(n,r[o]))}comparePolygon(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),o=r.coordinates.slice(1,r.coordinates.length);return n.every(i=>o.some(a=>this.compareLine(i,a,1,!0)))}return!1}compareGeometryCollection(e,r){return ge(e.geometries,r.geometries)&&this.compareBBox(e,r)&&e.geometries.every((n,o)=>this.compare(n,r.geometries[o]))}compareFeature(e,r){return e.id===r.id&&(this.compareProperties?At(e.properties,r.properties):!0)&&this.compareBBox(e,r)&&this.compare(e.geometry,r.geometry)}compareFeatureCollection(e,r){return ge(e.features,r.features)&&this.compareBBox(e,r)&&e.features.every((n,o)=>this.compare(n,r.features[o]))}compareBBox(e,r){return!e.bbox&&!r.bbox||(e.bbox&&r.bbox?this.compareCoord(e.bbox,r.bbox):!1)}};E(kr,"GeojsonEquality");function ge(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}E(ge,"sameLength");function Ge(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}E(Ge,"explode");var j=63710088e-1,St={centimeters:j*100,centimetres:j*100,degrees:360/(2*Math.PI),feet:j*3.28084,inches:j*39.37,kilometers:j/1e3,kilometres:j/1e3,meters:j,metres:j,miles:j/1609.344,millimeters:j*1e3,millimetres:j*1e3,nauticalmiles:j/1852,radians:1,yards:j*1.0936},gt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Q(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}E(Q,"feature");function Er(t,e,r={}){switch(t){case"Point":return Se(e).geometry;case"LineString":return We(e).geometry;case"Polygon":return Re(e).geometry;case"MultiPoint":return It(e).geometry;case"MultiLineString":return Tt(e).geometry;case"MultiPolygon":return Bt(e).geometry;default:throw new Error(t+" is invalid")}}E(Er,"geometry");function Se(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!fe(t[0])||!fe(t[1]))throw new Error("coordinates must contain numbers");return Q({type:"Point",coordinates:t},e,r)}E(Se,"point");function Pr(t,e,r={}){return Te(t.map(n=>Se(n,e)),r)}E(Pr,"points");function Re(t,e,r={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<o[o.length-1].length;i++)if(o[o.length-1][i]!==o[0][i])throw new Error("First and last Position are not equivalent.")}return Q({type:"Polygon",coordinates:t},e,r)}E(Re,"polygon");function $r(t,e,r={}){return Te(t.map(n=>Re(n,e)),r)}E($r,"polygons");function We(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Q({type:"LineString",coordinates:t},e,r)}E(We,"lineString");function Cr(t,e,r={}){return Te(t.map(n=>We(n,e)),r)}E(Cr,"lineStrings");function Te(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}E(Te,"featureCollection");function Tt(t,e,r={}){return Q({type:"MultiLineString",coordinates:t},e,r)}E(Tt,"multiLineString");function It(t,e,r={}){return Q({type:"MultiPoint",coordinates:t},e,r)}E(It,"multiPoint");function Bt(t,e,r={}){return Q({type:"MultiPolygon",coordinates:t},e,r)}E(Bt,"multiPolygon");function Lr(t,e,r={}){return Q({type:"GeometryCollection",geometries:t},e,r)}E(Lr,"geometryCollection");function Mr(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,e||0);return Math.round(t*r)/r}E(Mr,"round");function qt(t,e="kilometers"){const r=St[e];if(!r)throw new Error(e+" units is invalid");return t*r}E(qt,"radiansToLength");function Ie(t,e="kilometers"){const r=St[e];if(!r)throw new Error(e+" units is invalid");return t/r}E(Ie,"lengthToRadians");function Or(t,e){return Ce(Ie(t,e))}E(Or,"lengthToDegrees");function Ar(t){let e=t%360;return e<0&&(e+=360),e}E(Ar,"bearingToAzimuth");function Ce(t){return t%(2*Math.PI)*180/Math.PI}E(Ce,"radiansToDegrees");function ke(t){return t%360*Math.PI/180}E(ke,"degreesToRadians");function Fr(t,e="kilometers",r="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return qt(Ie(t,e),r)}E(Fr,"convertLength");function Sr(t,e="meters",r="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const n=gt[e];if(!n)throw new Error("invalid original units");const o=gt[r];if(!o)throw new Error("invalid final units");return t/n*o}E(Sr,"convertArea");function fe(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}E(fe,"isNumber");function Tr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}E(Tr,"isObject");function Ir(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!fe(e))throw new Error("bbox must only contain numbers")})}E(Ir,"validateBBox");function Br(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}E(Br,"validateId");var qr=Object.defineProperty,X=(t,e)=>qr(t,"name",{value:e,configurable:!0});function jt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}X(jt,"getCoord");function jr(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}X(jr,"getCoords");function Gt(t){if(t.length>1&&fe(t[0])&&fe(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return Gt(t[0]);throw new Error("coordinates must only contain numbers")}X(Gt,"containsNumber");function Gr(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)}X(Gr,"geojsonType");function Nr(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}X(Nr,"featureOf");function Dr(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of t.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+n.geometry.type)}}X(Dr,"collectionOf");function Rr(t){return t.type==="Feature"?t.geometry:t}X(Rr,"getGeom");function Wr(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}X(Wr,"getType");var Hr=Object.defineProperty,zr=(t,e)=>Hr(t,"name",{value:e,configurable:!0});function Nt(t,e,r,n={}){const o=jt(t),i=ke(o[0]),a=ke(o[1]),s=ke(r),c=Ie(e,n.units),u=Math.asin(Math.sin(a)*Math.cos(c)+Math.cos(a)*Math.sin(c)*Math.cos(s)),g=i+Math.atan2(Math.sin(s)*Math.sin(c)*Math.cos(a),Math.cos(c)-Math.sin(a)*Math.sin(u)),m=Ce(g),_=Ce(u);return Se([m,_],n.properties)}zr(Nt,"destination");var Jr=Nt,Ur=Object.defineProperty,P=(t,e)=>Ur(t,"name",{value:e,configurable:!0}),Vr=class{constructor(e){this.direction=!1,this.compareProperties=!0;var r,n,o;this.precision=10**-((r=e==null?void 0:e.precision)!=null?r:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,r){if(e.type!==r.type||!he(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(e,r);case"GeometryCollection":return this.compareGeometryCollection(e,r);case"Feature":return this.compareFeature(e,r);case"FeatureCollection":return this.compareFeatureCollection(e,r);default:if(e.type.startsWith("Multi")){const n=Ne(e),o=Ne(r);return n.every(i=>o.some(a=>this.compare(i,a)))}}return!1}compareCoord(e,r){return e.length===r.length&&e.every((n,o)=>Math.abs(n-r[o])<this.precision)}compareLine(e,r,n=0,o=!1){if(!he(e,r))return!1;const i=e;let a=r;if(o&&!this.compareCoord(i[0],a[0])){const c=this.fixStartIndex(a,i);if(c)a=c;else return!1}const s=this.compareCoord(i[n],a[n]);return this.direction||s?this.comparePath(i,a):this.compareCoord(i[n],a[a.length-(1+n)])?this.comparePath(i.slice().reverse(),a):!1}fixStartIndex(e,r){let n,o=-1;for(let i=0;i<e.length;i++)if(this.compareCoord(e[i],r[0])){o=i;break}return o>=0&&(n=[].concat(e.slice(o,e.length),e.slice(1,o+1))),n}comparePath(e,r){return e.every((n,o)=>this.compareCoord(n,r[o]))}comparePolygon(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),o=r.coordinates.slice(1,r.coordinates.length);return n.every(i=>o.some(a=>this.compareLine(i,a,1,!0)))}return!1}compareGeometryCollection(e,r){return he(e.geometries,r.geometries)&&this.compareBBox(e,r)&&e.geometries.every((n,o)=>this.compare(n,r.geometries[o]))}compareFeature(e,r){return e.id===r.id&&(this.compareProperties?At(e.properties,r.properties):!0)&&this.compareBBox(e,r)&&this.compare(e.geometry,r.geometry)}compareFeatureCollection(e,r){return he(e.features,r.features)&&this.compareBBox(e,r)&&e.features.every((n,o)=>this.compare(n,r.features[o]))}compareBBox(e,r){return!e.bbox&&!r.bbox||(e.bbox&&r.bbox?this.compareCoord(e.bbox,r.bbox):!1)}};P(Vr,"GeojsonEquality");function he(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}P(he,"sameLength");function Ne(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}P(Ne,"explode");var G=63710088e-1,Dt={centimeters:G*100,centimetres:G*100,degrees:360/(2*Math.PI),feet:G*3.28084,inches:G*39.37,kilometers:G/1e3,kilometres:G/1e3,meters:G,metres:G,miles:G/1609.344,millimeters:G*1e3,millimetres:G*1e3,nauticalmiles:G/1852,radians:1,yards:G*1.0936},ht={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Y(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}P(Y,"feature");function xr(t,e,r={}){switch(t){case"Point":return He(e).geometry;case"LineString":return Je(e).geometry;case"Polygon":return ze(e).geometry;case"MultiPoint":return Wt(e).geometry;case"MultiLineString":return Rt(e).geometry;case"MultiPolygon":return Ht(e).geometry;default:throw new Error(t+" is invalid")}}P(xr,"geometry");function He(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ce(t[0])||!ce(t[1]))throw new Error("coordinates must contain numbers");return Y({type:"Point",coordinates:t},e,r)}P(He,"point");function Kr(t,e,r={}){return Be(t.map(n=>He(n,e)),r)}P(Kr,"points");function ze(t,e,r={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<o[o.length-1].length;i++)if(o[o.length-1][i]!==o[0][i])throw new Error("First and last Position are not equivalent.")}return Y({type:"Polygon",coordinates:t},e,r)}P(ze,"polygon");function Zr(t,e,r={}){return Be(t.map(n=>ze(n,e)),r)}P(Zr,"polygons");function Je(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Y({type:"LineString",coordinates:t},e,r)}P(Je,"lineString");function Qr(t,e,r={}){return Be(t.map(n=>Je(n,e)),r)}P(Qr,"lineStrings");function Be(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}P(Be,"featureCollection");function Rt(t,e,r={}){return Y({type:"MultiLineString",coordinates:t},e,r)}P(Rt,"multiLineString");function Wt(t,e,r={}){return Y({type:"MultiPoint",coordinates:t},e,r)}P(Wt,"multiPoint");function Ht(t,e,r={}){return Y({type:"MultiPolygon",coordinates:t},e,r)}P(Ht,"multiPolygon");function Xr(t,e,r={}){return Y({type:"GeometryCollection",geometries:t},e,r)}P(Xr,"geometryCollection");function Yr(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,e||0);return Math.round(t*r)/r}P(Yr,"round");function zt(t,e="kilometers"){const r=Dt[e];if(!r)throw new Error(e+" units is invalid");return t*r}P(zt,"radiansToLength");function Ue(t,e="kilometers"){const r=Dt[e];if(!r)throw new Error(e+" units is invalid");return t/r}P(Ue,"lengthToRadians");function en(t,e){return Ve(Ue(t,e))}P(en,"lengthToDegrees");function tn(t){let e=t%360;return e<0&&(e+=360),e}P(tn,"bearingToAzimuth");function Ve(t){return t%(2*Math.PI)*180/Math.PI}P(Ve,"radiansToDegrees");function de(t){return t%360*Math.PI/180}P(de,"degreesToRadians");function rn(t,e="kilometers",r="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return zt(Ue(t,e),r)}P(rn,"convertLength");function nn(t,e="meters",r="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const n=ht[e];if(!n)throw new Error("invalid original units");const o=ht[r];if(!o)throw new Error("invalid final units");return t/n*o}P(nn,"convertArea");function ce(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}P(ce,"isNumber");function on(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}P(on,"isObject");function an(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!ce(e))throw new Error("bbox must only contain numbers")})}P(an,"validateBBox");function sn(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}P(sn,"validateId");var ln=Object.defineProperty,ee=(t,e)=>ln(t,"name",{value:e,configurable:!0});function De(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}ee(De,"getCoord");function un(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}ee(un,"getCoords");function Jt(t){if(t.length>1&&ce(t[0])&&ce(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return Jt(t[0]);throw new Error("coordinates must only contain numbers")}ee(Jt,"containsNumber");function fn(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)}ee(fn,"geojsonType");function cn(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}ee(cn,"featureOf");function mn(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of t.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+n.geometry.type)}}ee(mn,"collectionOf");function pn(t){return t.type==="Feature"?t.geometry:t}ee(pn,"getGeom");function gn(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}ee(gn,"getType");var hn=Object.defineProperty,Ut=(t,e)=>hn(t,"name",{value:e,configurable:!0});function xe(t,e,r={}){if(r.final===!0)return Vt(t,e);const n=De(t),o=De(e),i=de(n[0]),a=de(o[0]),s=de(n[1]),c=de(o[1]),u=Math.sin(a-i)*Math.cos(c),g=Math.cos(s)*Math.sin(c)-Math.sin(s)*Math.cos(c)*Math.cos(a-i);return Ve(Math.atan2(u,g))}Ut(xe,"bearing");function Vt(t,e){let r=xe(e,t);return r=(r+180)%360,r}Ut(Vt,"calculateFinalBearing");var dt=xe;function dn(t){let e,r,n;return{c(){e=nt("svg"),r=nt("polygon"),this.h()},l(o){e=ot(o,"svg",{width:!0,height:!0,xmlns:!0});var i=W(e);r=ot(i,"polygon",{points:!0,fill:!0,transform:!0,class:!0}),W(r).forEach($),i.forEach($),this.h()},h(){q(r,"points","15,0 0,30 30,30"),q(r,"fill",t[0]),q(r,"transform",n="rotate("+t[1]+", 15, 15)"),q(r,"class","svelte-vih5bq"),q(e,"width","30"),q(e,"height","30"),q(e,"xmlns","http://www.w3.org/2000/svg")},m(o,i){I(o,e,i),N(e,r)},p(o,[i]){i&1&&q(r,"fill",o[0]),i&2&&n!==(n="rotate("+o[1]+", 15, 15)")&&q(r,"transform",n)},i:Pe,o:Pe,d(o){o&&$(e)}}}function yn(t,e,r){let{color:n}=e,{angle:o}=e;return t.$$set=i=>{"color"in i&&r(0,n=i.color),"angle"in i&&r(1,o=i.angle)},[n,o]}class _n extends Ae{constructor(e){super(),Fe(this,e,yn,dn,Le,{color:0,angle:1})}}function yt(t,e,r){const n=t.slice();return n[17]=e[r],n[18]=e,n[19]=r,n}function _t(t,e,r){const n=t.slice();return n[17]=e[r],n[20]=e,n[21]=r,n}function bn(t){let e;return{c(){e=Me("Zoom to fit")},l(r){e=Oe(r,"Zoom to fit")},m(r,n){I(r,e,n)},d(r){r&&$(e)}}}function wn(t){let e;return{c(){e=Me("Delete")},l(r){e=Oe(r,"Delete")},m(r,n){I(r,e,n)},d(r){r&&$(e)}}}function bt(t){let e,r,n,o,i,a,s,c,u,g,m,_,b;function O(p){t[8](p,t[17])}let B={label:"Name"};t[17].name!==void 0&&(B.value=t[17].name),r=new sr({props:B}),ne.push(()=>ue(r,"value",O));function h(p){t[9](p,t[17])}let H={label:"Kind",choices:t[2]};t[17].kind!==void 0&&(H.value=t[17].kind),i=new st({props:H}),ne.push(()=>ue(i,"value",h));function J(p){t[10](p,t[17])}let d={label:"Color",choices:t[3]};t[17].color!==void 0&&(d.value=t[17].color),c=new st({props:d}),ne.push(()=>ue(c,"value",J));function f(){return t[11](t[21])}return m=new ar({props:{$$slots:{default:[wn]},$$scope:{ctx:t}}}),m.$on("click",f),{c(){e=V("li"),A(r.$$.fragment),o=D(),A(i.$$.fragment),s=D(),A(c.$$.fragment),g=D(),A(m.$$.fragment),_=D()},l(p){e=x(p,"LI",{});var y=W(e);F(r.$$.fragment,y),o=R(y),F(i.$$.fragment,y),s=R(y),F(c.$$.fragment,y),g=R(y),F(m.$$.fragment,y),_=R(y),y.forEach($)},m(p,y){I(p,e,y),S(r,e,null),N(e,o),S(i,e,null),N(e,s),S(c,e,null),N(e,g),S(m,e,null),N(e,_),b=!0},p(p,y){t=p;const M={};!n&&y&2&&(n=!0,M.value=t[17].name,le(()=>n=!1)),r.$set(M);const C={};!a&&y&2&&(a=!0,C.value=t[17].kind,le(()=>a=!1)),i.$set(C);const L={};!u&&y&2&&(u=!0,L.value=t[17].color,le(()=>u=!1)),c.$set(L);const ie={};y&4194304&&(ie.$$scope={dirty:y,ctx:t}),m.$set(ie)},i(p){b||(w(r.$$.fragment,p),w(i.$$.fragment,p),w(c.$$.fragment,p),w(m.$$.fragment,p),b=!0)},o(p){k(r.$$.fragment,p),k(i.$$.fragment,p),k(c.$$.fragment,p),k(m.$$.fragment,p),b=!1},d(p){p&&$(e),T(r),T(i),T(c),T(m)}}}function vn(t){let e,r;return{c(){e=V("span"),this.h()},l(n){e=x(n,"SPAN",{class:!0,style:!0}),W(e).forEach($),this.h()},h(){q(e,"class","dot svelte-1kvjd2"),q(e,"style",r=`background-color: ${oe[t[17].color].background}`)},m(n,o){I(n,e,o)},p(n,o){o&2&&r!==(r=`background-color: ${oe[n[17].color].background}`)&&q(e,"style",r)},d(n){n&&$(e)}}}function kn(t){let e,r;return e=new _n({props:{color:oe[t[17].color].background,angle:dt(t[17].point1,t[17].point2)}}),{c(){A(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,o){S(e,n,o),r=!0},p(n,o){const i={};o&2&&(i.color=oe[n[17].color].background),o&2&&(i.angle=dt(n[17].point1,n[17].point2)),e.$set(i)},i(n){r||(w(e.$$.fragment,n),r=!0)},o(n){k(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function En(t){let e,r;return{c(){e=V("span"),this.h()},l(n){e=x(n,"SPAN",{class:!0,style:!0}),W(e).forEach($),this.h()},h(){q(e,"class","dot svelte-1kvjd2"),q(e,"style",r=`background-color: ${oe[t[17].color].background}`)},m(n,o){I(n,e,o)},p(n,o){o&2&&r!==(r=`background-color: ${oe[n[17].color].background}`)&&q(e,"style",r)},i:Pe,o:Pe,d(n){n&&$(e)}}}function Pn(t){let e,r,n,o;const i=[En,kn],a=[];function s(c,u){return c[17].kind=="pedestrian"?0:1}return e=s(t),r=a[e]=i[e](t),{c(){r.c(),n=Ee()},l(c){r.l(c),n=Ee()},m(c,u){a[e].m(c,u),I(c,n,u),o=!0},p(c,u){let g=e;e=s(c),e===g?a[e].p(c,u):(ye(),k(a[g],1,1,()=>{a[g]=null}),_e(),r=a[e],r?r.p(c,u):(r=a[e]=i[e](c),r.c()),w(r,1),r.m(n.parentNode,n))},i(c){o||(w(r),o=!0)},o(c){k(r),o=!1},d(c){c&&$(n),a[e].d(c)}}}function wt(t){let e,r,n,o,i,a;function s(m){t[12](m,t[17])}let c={draggable:!0,$$slots:{default:[vn]},$$scope:{ctx:t}};t[17].point1!==void 0&&(c.lngLat=t[17].point1),e=new lt({props:c}),ne.push(()=>ue(e,"lngLat",s));function u(m){t[13](m,t[17])}let g={draggable:!0,$$slots:{default:[Pn]},$$scope:{ctx:t}};return t[17].point2!==void 0&&(g.lngLat=t[17].point2),o=new lt({props:g}),ne.push(()=>ue(o,"lngLat",u)),{c(){A(e.$$.fragment),n=D(),A(o.$$.fragment)},l(m){F(e.$$.fragment,m),n=R(m),F(o.$$.fragment,m)},m(m,_){S(e,m,_),I(m,n,_),S(o,m,_),a=!0},p(m,_){t=m;const b={};_&4194306&&(b.$$scope={dirty:_,ctx:t}),!r&&_&2&&(r=!0,b.lngLat=t[17].point1,le(()=>r=!1)),e.$set(b);const O={};_&4194306&&(O.$$scope={dirty:_,ctx:t}),!i&&_&2&&(i=!0,O.lngLat=t[17].point2,le(()=>i=!1)),o.$set(O)},i(m){a||(w(e.$$.fragment,m),w(o.$$.fragment,m),a=!0)},o(m){k(e.$$.fragment,m),k(o.$$.fragment,m),a=!1},d(m){m&&$(n),T(e,m),T(o,m)}}}function $n(t){let e=(t[16].name||"Untitled movement")+"",r;return{c(){r=Me(e)},l(n){r=Oe(n,e)},m(n,o){I(n,r,o)},p(n,o){o&65536&&e!==(e=(n[16].name||"Untitled movement")+"")&&Ot(r,e)},d(n){n&&$(r)}}}function Cn(t){let e,r;return e=new Ft({props:{$$slots:{default:[$n,({props:n})=>({16:n}),({props:n})=>n?65536:0]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,o){S(e,n,o),r=!0},p(n,o){const i={};o&4259840&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){r||(w(e.$$.fragment,n),r=!0)},o(n){k(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Ln(t){let e=(t[16].name||"Untitled movement")+"",r;return{c(){r=Me(e)},l(n){r=Oe(n,e)},m(n,o){I(n,r,o)},p(n,o){o&65536&&e!==(e=(n[16].name||"Untitled movement")+"")&&Ot(r,e)},d(n){n&&$(r)}}}function Mn(t){let e,r;return e=new Ft({props:{$$slots:{default:[Ln,({props:n})=>({16:n}),({props:n})=>n?65536:0]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,o){S(e,n,o),r=!0},p(n,o){const i={};o&4259840&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){r||(w(e.$$.fragment,n),r=!0)},o(n){k(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function On(t){let e,r,n,o;return e=new ut({props:{manageHoverState:!0,paint:{"line-width":it(6,10),"line-color":["get","color"]},filter:["!=",["get","kind"],"pedestrian"],$$slots:{default:[Cn]},$$scope:{ctx:t}}}),n=new ut({props:{manageHoverState:!0,paint:{"line-width":it(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"pedestrian"],$$slots:{default:[Mn]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment),r=D(),A(n.$$.fragment)},l(i){F(e.$$.fragment,i),r=R(i),F(n.$$.fragment,i)},m(i,a){S(e,i,a),I(i,r,a),S(n,i,a),o=!0},p(i,a){const s={};a&4194304&&(s.$$scope={dirty:a,ctx:i}),e.$set(s);const c={};a&4194304&&(c.$$scope={dirty:a,ctx:i}),n.$set(c)},i(i){o||(w(e.$$.fragment,i),w(n.$$.fragment,i),o=!0)},o(i){k(e.$$.fragment,i),k(n.$$.fragment,i),o=!1},d(i){i&&$(r),T(e,i),T(n,i)}}}function An(t){let e,r,n,o,i,a=$e(t[1].jat.movements),s=[];for(let u=0;u<a.length;u+=1)s[u]=wt(yt(t,a,u));const c=u=>k(s[u],1,1,()=>{s[u]=null});return r=new or({props:{data:t[4](t[1].jat.movements),$$slots:{default:[On]},$$scope:{ctx:t}}}),o=new cr({props:{map:t[0]}}),{c(){for(let u=0;u<s.length;u+=1)s[u].c();e=D(),A(r.$$.fragment),n=D(),A(o.$$.fragment)},l(u){for(let g=0;g<s.length;g+=1)s[g].l(u);e=R(u),F(r.$$.fragment,u),n=R(u),F(o.$$.fragment,u)},m(u,g){for(let m=0;m<s.length;m+=1)s[m]&&s[m].m(u,g);I(u,e,g),S(r,u,g),I(u,n,g),S(o,u,g),i=!0},p(u,g){if(g&2){a=$e(u[1].jat.movements);let b;for(b=0;b<a.length;b+=1){const O=yt(u,a,b);s[b]?(s[b].p(O,g),w(s[b],1)):(s[b]=wt(O),s[b].c(),w(s[b],1),s[b].m(e.parentNode,e))}for(ye(),b=a.length;b<s.length;b+=1)c(b);_e()}const m={};g&2&&(m.data=u[4](u[1].jat.movements)),g&4194304&&(m.$$scope={dirty:g,ctx:u}),r.$set(m);const _={};g&1&&(_.map=u[0]),o.$set(_)},i(u){if(!i){for(let g=0;g<a.length;g+=1)w(s[g]);w(r.$$.fragment,u),w(o.$$.fragment,u),i=!0}},o(u){s=s.filter(Boolean);for(let g=0;g<s.length;g+=1)k(s[g]);k(r.$$.fragment,u),k(o.$$.fragment,u),i=!1},d(u){u&&($(e),$(n)),Mt(s,u),T(r,u),T(o,u)}}}function Fn(t){let e,r,n,o,i,a,s,c,u,g,m,_,b,O;n=new ir({props:{$$slots:{default:[bn]},$$scope:{ctx:t}}}),n.$on("click",t[7]),i=new lr({}),s=new ur({});let B=$e(t[1].jat.movements),h=[];for(let f=0;f<B.length;f+=1)h[f]=bt(_t(t,B,f));const H=f=>k(h[f],1,1,()=>{h[f]=null});function J(f){t[14](f)}let d={$$slots:{default:[An]},$$scope:{ctx:t}};return t[0]!==void 0&&(d.map=t[0]),_=new nr({props:d}),ne.push(()=>ue(_,"map",J)),{c(){e=V("div"),r=V("div"),A(n.$$.fragment),o=D(),A(i.$$.fragment),a=D(),A(s.$$.fragment),c=D(),u=V("ol");for(let f=0;f<h.length;f+=1)h[f].c();g=D(),m=V("div"),A(_.$$.fragment),this.h()},l(f){e=x(f,"DIV",{style:!0});var p=W(e);r=x(p,"DIV",{style:!0});var y=W(r);F(n.$$.fragment,y),o=R(y),F(i.$$.fragment,y),a=R(y),F(s.$$.fragment,y),c=R(y),u=x(y,"OL",{});var M=W(u);for(let L=0;L<h.length;L+=1)h[L].l(M);M.forEach($),y.forEach($),g=R(p),m=x(p,"DIV",{style:!0});var C=W(m);F(_.$$.fragment,C),C.forEach($),p.forEach($),this.h()},h(){re(r,"width","30%"),re(r,"overflow-y","scroll"),re(r,"padding","10px"),re(m,"position","relative"),re(m,"width","100%"),re(e,"display","flex"),re(e,"height","600px")},m(f,p){I(f,e,p),N(e,r),S(n,r,null),N(r,o),S(i,r,null),N(r,a),S(s,r,null),N(r,c),N(r,u);for(let y=0;y<h.length;y+=1)h[y]&&h[y].m(u,null);N(e,g),N(e,m),S(_,m,null),O=!0},p(f,[p]){const y={};if(p&4194304&&(y.$$scope={dirty:p,ctx:f}),n.$set(y),p&46){B=$e(f[1].jat.movements);let C;for(C=0;C<B.length;C+=1){const L=_t(f,B,C);h[C]?(h[C].p(L,p),w(h[C],1)):(h[C]=bt(L),h[C].c(),w(h[C],1),h[C].m(u,null))}for(ye(),C=B.length;C<h.length;C+=1)H(C);_e()}const M={};p&4194307&&(M.$$scope={dirty:p,ctx:f}),!b&&p&1&&(b=!0,M.map=f[0],le(()=>b=!1)),_.$set(M)},i(f){if(!O){w(n.$$.fragment,f),w(i.$$.fragment,f),w(s.$$.fragment,f);for(let p=0;p<B.length;p+=1)w(h[p]);w(_.$$.fragment,f),O=!0}},o(f){k(n.$$.fragment,f),k(i.$$.fragment,f),k(s.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)k(h[p]);k(_.$$.fragment,f),O=!1},d(f){f&&$(e),T(n),T(i),T(s),Mt(h,f),T(_)}}}function Sn(t,e,r){let n;pe(t,Z,d=>r(1,n=d));let o,i=at(["cycling-straight","cycling-turn","pedestrian"]),a=at(["green","amber","red","critical"]);function s(d){Et(Z,n.jat.movements=[...n.jat.movements,{point1:d.lngLat.toArray(),point2:Jr(d.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling-straight",color:"green",name:"",notes:""}],n)}vt(()=>{o.on("click",s),g(!1)}),kt(()=>{o.off("click",s)});function c(d){return{type:"FeatureCollection",features:d.map((f,p)=>({type:"Feature",id:p,properties:{name:f.name,kind:f.kind,color:oe[f.color].background},geometry:{type:"LineString",coordinates:[f.point1,f.point2]}}))}}function u(d){n.jat.movements.splice(d,1),Z.set(n)}function g(d){n.jat.movements.length>0&&o.fitBounds(fr(c(n.jat.movements)),{padding:20,animate:d})}const m=()=>g(!0);function _(d,f){t.$$.not_equal(f.name,d)&&(f.name=d,Z.set(n))}function b(d,f){t.$$.not_equal(f.kind,d)&&(f.kind=d,Z.set(n))}function O(d,f){t.$$.not_equal(f.color,d)&&(f.color=d,Z.set(n))}const B=d=>u(d);function h(d,f){t.$$.not_equal(f.point1,d)&&(f.point1=d,Z.set(n))}function H(d,f){t.$$.not_equal(f.point2,d)&&(f.point2=d,Z.set(n))}function J(d){o=d,r(0,o)}return[o,n,i,a,c,u,g,m,_,b,O,B,h,H,J]}class Vn extends Ae{constructor(e){super(),Fe(this,e,Sn,Fn,Le,{})}}export{Vn as component};
