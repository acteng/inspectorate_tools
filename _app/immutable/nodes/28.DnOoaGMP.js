import{s as Qe,p as F,e as T,a as $,t as me,c as E,x as ae,g as c,b as ue,d as le,f as N,q as oe,i as se,h as m,r as K,k as Xe,O as ot,w as Ve,A as ut,j as mt}from"../chunks/scheduler.C0ulHN8K.js";import{S as et,i as tt,e as x,c as k,a as C,m as S,t as _,g as lt,b as y,f as ft,d as L}from"../chunks/index.D0begEaS.js";import{p as we}from"../chunks/index.YLlc_VAO.js";import{S as We}from"../chunks/Select.BD67FBW0.js";import{T as Le}from"../chunks/TextArea.rFpIclU-.js";import{T as Je}from"../chunks/TextInput.DYQX_wRu.js";import{s as P}from"../chunks/data.vZUyh69C.js";import{S as Me,a as pt,t as gt,r as ht,f as $t,d as ct}from"../chunks/lists.Ck-fV-N5.js";import"../chunks/paths.ArZyOjwu.js";import{E as dt}from"../chunks/ErrorMessage.MCHYhRZR.js";import{F as _t}from"../chunks/FileInput.CSr50loT.js";import{W as vt,S as yt}from"../chunks/WarningButton.1L7-E1vj.js";import{E as bt}from"../chunks/ExternalLink.zCV_yNpK.js";/* empty css                                                               */import{M as wt,b as kt,C as Ct}from"../chunks/index.DyQLronI.js";import{t as St}from"../chunks/index.BMHtvqQA.js";import{D as Ye}from"../chunks/DecimalInput.C261lj8P.js";function Ze(t){let e,i,r,n;return e=new vt({props:{$$slots:{default:[Lt]},$$scope:{ctx:t}}}),e.$on("click",t[3]),r=new yt({props:{$$slots:{default:[Mt]},$$scope:{ctx:t}}}),r.$on("click",t[6]),{c(){k(e.$$.fragment),i=$(),k(r.$$.fragment)},l(s){C(e.$$.fragment,s),i=c(s),C(r.$$.fragment,s)},m(s,h){S(e,s,h),se(s,i,h),S(r,s,h),n=!0},p(s,h){const b={};h&256&&(b.$$scope={dirty:h,ctx:s}),e.$set(b);const l={};h&256&&(l.$$scope={dirty:h,ctx:s}),r.$set(l)},i(s){n||(_(e.$$.fragment,s),_(r.$$.fragment,s),n=!0)},o(s){y(e.$$.fragment,s),y(r.$$.fragment,s),n=!1},d(s){s&&N(i),L(e,s),L(r,s)}}}function Lt(t){let e;return{c(){e=me("Clear map")},l(i){e=le(i,"Clear map")},m(i,r){se(i,e,r)},d(i){i&&N(e)}}}function Mt(t){let e;return{c(){e=me("Zoom to fit")},l(i){e=le(i,"Zoom to fit")},m(i,r){se(i,e,r)},d(i){i&&N(e)}}}function Rt(t){let e;return{c(){e=me("Scheme Sketcher")},l(i){e=le(i,"Scheme Sketcher")},m(i,r){se(i,e,r)},d(i){i&&N(e)}}}function It(t){let e,i;return e=new Ct({props:{gj:t[2].summary.networkMap,show:!0}}),{c(){k(e.$$.fragment)},l(r){C(e.$$.fragment,r)},m(r,n){S(e,r,n),i=!0},p(r,n){const s={};n&4&&(s.gj=r[2].summary.networkMap),e.$set(s)},i(r){i||(_(e.$$.fragment,r),i=!0)},o(r){y(e.$$.fragment,r),i=!1},d(r){L(e,r)}}}function Ot(t){let e,i="Network Map",r,n,s,h,b=`Please add a map showing the section of route being scored in this file.
      If the route is part of a longer route of multiple sections (covered in
      other files), please show this on the map for context too.`,l,I,W,g,j,A,d,re="You can use the external Scheme Sketcher tool to draw this map:",te,p,o,J,w,fe,pe,q,ve="Choose the area best covering this scheme",ge,D,ye=`Use the <i>New route</i>
        tool to sketch the route. It can contain segments snapped to existing roads
        or free-hand segments.`,he,Y,z=`Optionally, use the <i>Split route</i>
        tool to denote just the sections assessed in this file.`,$e,U,B=`You can set <i>Name</i>
        and
        <i>Description</i>
        to whatever is useful for display on the map`,ce,Q,G=`Save the map by clicking <i>Manage files</i>
        , then
        <i>Save</i>`,de,X,ee="Load the saved file above",ie,ne,V,be,_e;I=new _t({props:{label:"Import from GeoJSON file",onLoad:t[4]}}),g=new dt({props:{errorMessage:t[1]}});let v=t[2].summary.networkMap.features.length>0&&Ze(t);w=new bt({props:{href:"https://acteng.github.io/atip",$$slots:{default:[Rt]},$$scope:{ctx:t}}});function ke(f){t[7](f)}let Ce={$$slots:{default:[It]},$$scope:{ctx:t}};return t[0]!==void 0&&(Ce.map=t[0]),V=new wt({props:Ce}),F.push(()=>x(V,"map",ke)),{c(){e=T("h2"),e.textContent=i,r=$(),n=T("div"),s=T("div"),h=T("p"),h.textContent=b,l=$(),k(I.$$.fragment),W=$(),k(g.$$.fragment),j=$(),v&&v.c(),A=$(),d=T("p"),d.textContent=re,te=$(),p=T("ol"),o=T("li"),J=me("Go to the "),k(w.$$.fragment),fe=me(" tool"),pe=$(),q=T("li"),q.textContent=ve,ge=$(),D=T("li"),D.innerHTML=ye,he=$(),Y=T("li"),Y.innerHTML=z,$e=$(),U=T("li"),U.innerHTML=B,ce=$(),Q=T("li"),Q.innerHTML=G,de=$(),X=T("li"),X.textContent=ee,ie=$(),ne=T("div"),k(V.$$.fragment),this.h()},l(f){e=E(f,"H2",{"data-svelte-h":!0}),ae(e)!=="svelte-1fkh1ci"&&(e.textContent=i),r=c(f),n=E(f,"DIV",{style:!0});var M=ue(n);s=E(M,"DIV",{style:!0});var O=ue(s);h=E(O,"P",{"data-svelte-h":!0}),ae(h)!=="svelte-1r7hkzo"&&(h.textContent=b),l=c(O),C(I.$$.fragment,O),W=c(O),C(g.$$.fragment,O),j=c(O),v&&v.l(O),A=c(O),d=E(O,"P",{"data-svelte-h":!0}),ae(d)!=="svelte-1els6f1"&&(d.textContent=re),te=c(O),p=E(O,"OL",{});var R=ue(p);o=E(R,"LI",{});var Z=ue(o);J=le(Z,"Go to the "),C(w.$$.fragment,Z),fe=le(Z," tool"),Z.forEach(N),pe=c(R),q=E(R,"LI",{"data-svelte-h":!0}),ae(q)!=="svelte-aj705b"&&(q.textContent=ve),ge=c(R),D=E(R,"LI",{"data-svelte-h":!0}),ae(D)!=="svelte-1vb2muj"&&(D.innerHTML=ye),he=c(R),Y=E(R,"LI",{"data-svelte-h":!0}),ae(Y)!=="svelte-3xdyru"&&(Y.innerHTML=z),$e=c(R),U=E(R,"LI",{"data-svelte-h":!0}),ae(U)!=="svelte-1r1ljcj"&&(U.innerHTML=B),ce=c(R),Q=E(R,"LI",{"data-svelte-h":!0}),ae(Q)!=="svelte-sz4wlr"&&(Q.innerHTML=G),de=c(R),X=E(R,"LI",{"data-svelte-h":!0}),ae(X)!=="svelte-x3zkxb"&&(X.textContent=ee),R.forEach(N),O.forEach(N),ie=c(M),ne=E(M,"DIV",{style:!0});var Se=ue(ne);C(V.$$.fragment,Se),Se.forEach(N),M.forEach(N),this.h()},h(){oe(s,"width","30%"),oe(s,"overflow-y","scroll"),oe(s,"padding","10px"),oe(s,"border","1px solid black"),oe(ne,"position","relative"),oe(ne,"width","70%"),oe(n,"display","flex"),oe(n,"height","80vh")},m(f,M){se(f,e,M),se(f,r,M),se(f,n,M),m(n,s),m(s,h),m(s,l),S(I,s,null),m(s,W),S(g,s,null),m(s,j),v&&v.m(s,null),m(s,A),m(s,d),m(s,te),m(s,p),m(p,o),m(o,J),S(w,o,null),m(o,fe),m(p,pe),m(p,q),m(p,ge),m(p,D),m(p,he),m(p,Y),m(p,$e),m(p,U),m(p,ce),m(p,Q),m(p,de),m(p,X),m(n,ie),m(n,ne),S(V,ne,null),_e=!0},p(f,[M]){const O={};M&2&&(O.errorMessage=f[1]),g.$set(O),f[2].summary.networkMap.features.length>0?v?(v.p(f,M),M&4&&_(v,1)):(v=Ze(f),v.c(),_(v,1),v.m(s,A)):v&&(lt(),y(v,1,1,()=>{v=null}),ft());const R={};M&256&&(R.$$scope={dirty:M,ctx:f}),w.$set(R);const Z={};M&260&&(Z.$$scope={dirty:M,ctx:f}),!be&&M&1&&(be=!0,Z.map=f[0],K(()=>be=!1)),V.$set(Z)},i(f){_e||(_(I.$$.fragment,f),_(g.$$.fragment,f),_(v),_(w.$$.fragment,f),_(V.$$.fragment,f),_e=!0)},o(f){y(I.$$.fragment,f),y(g.$$.fragment,f),y(v),y(w.$$.fragment,f),y(V.$$.fragment,f),_e=!1},d(f){f&&(N(e),N(r),N(n)),L(I),L(g),v&&v.d(),L(w),L(V)}}}function Tt(t,e,i){let r;Xe(t,P,g=>i(2,r=g));let n,s="";ot(()=>{l(!1)});function h(){window.confirm("Do you really want to erase the map data?")&&Ve(P,r.summary.networkMap={type:"FeatureCollection",features:[]},r)}function b(g,j){var A;i(1,s="");try{let d=JSON.parse(j);if(d.type!="FeatureCollection")throw new Error("This doesn't look like a GeoJSON file");if(!((A=d.origin)!=null&&A.startsWith("atip-")))throw new Error("This file wasn't produced with the Scheme Sketcher");if(d.crs)throw new Error("This file has a Coordinate Reference System set; it's not suitable for a web map");Ve(P,r.summary.networkMap=d,r),l(!0)}catch(d){i(1,s=`Error importing ${g}: ${d}`)}}function l(g){let j={type:"FeatureCollection",features:r.summary.networkMap.features};j.features.length>0&&n.fitBounds(kt(j),{padding:20,animate:g})}const I=()=>l(!0);function W(g){n=g,i(0,n)}return[n,s,r,h,b,l,I,W]}class Et extends et{constructor(e){super(),tt(this,e,Tt,Ot,Qe,{})}}function Ue(t){let e,i,r,n=t[1].toFixed(2)+"",s,h;return{c(){e=T("p"),i=me("LineStrings in the Network Map cover a total of "),r=T("b"),s=me(n),h=me(`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`)},l(b){e=E(b,"P",{});var l=ue(e);i=le(l,"LineStrings in the Network Map cover a total of "),r=E(l,"B",{});var I=ue(r);s=le(I,n),I.forEach(N),h=le(l,`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`),l.forEach(N)},m(b,l){se(b,e,l),m(e,i),m(e,r),m(r,s),m(e,h)},p(b,l){l&2&&n!==(n=b[1].toFixed(2)+"")&&mt(s,n)},d(b){b&&N(e)}}}function Nt(t){let e,i,r,n,s,h,b,l,I,W,g,j,A,d,re,te,p,o,J,w,fe,pe,q,ve,ge,D,ye,he,Y,z,$e,U,B,ce,Q,G,de,X,ee,ie;function ne(a){t[2](a)}let V={label:"Scheme reference"};t[0].summary.schemeReference!==void 0&&(V.value=t[0].summary.schemeReference),i=new Je({props:V}),F.push(()=>x(i,"value",ne));function be(a){t[3](a)}let _e={label:"Scheme name"};t[0].summary.schemeName!==void 0&&(_e.value=t[0].summary.schemeName),s=new Je({props:_e}),F.push(()=>x(s,"value",be));function v(a){t[4](a)}let ke={label:"Scheme summary"};t[0].summary.schemeSummary!==void 0&&(ke.value=t[0].summary.schemeSummary),l=new Le({props:ke}),F.push(()=>x(l,"value",v));function Ce(a){t[5](a)}let f={label:"Authority",emptyOption:!0,choices:we(pt)};t[0].summary.authority!==void 0&&(f.value=t[0].summary.authority),g=new We({props:f}),F.push(()=>x(g,"value",Ce));function M(a){t[6](a)}let O={label:"Transport / Combined Authority",emptyOption:!0,choices:we(gt)};t[0].summary.transportOrCombinedAuthority!==void 0&&(O.value=t[0].summary.transportOrCombinedAuthority),d=new We({props:O}),F.push(()=>x(d,"value",M));function R(a){t[7](a)}let Z={label:"Region",emptyOption:!0,choices:we(ht)};t[0].summary.region!==void 0&&(Z.value=t[0].summary.region),p=new Me({props:Z}),F.push(()=>x(p,"value",R));function Se(a){t[8](a)}let Re={label:"Funding programme",emptyOption:!0,choices:we($t)};t[0].summary.fundingProgramme!==void 0&&(Re.value=t[0].summary.fundingProgramme),w=new Me({props:Re}),F.push(()=>x(w,"value",Se));function nt(a){t[9](a)}let Ie={label:"Design stage",emptyOption:!0,choices:we(ct)};t[0].summary.designStage!==void 0&&(Ie.value=t[0].summary.designStage),q=new Me({props:Ie}),F.push(()=>x(q,"value",nt));function at(a){t[10](a)}let Oe={label:"Funding conditions"};t[0].summary.fundingConditions!==void 0&&(Oe.value=t[0].summary.fundingConditions),D=new Le({props:Oe}),F.push(()=>x(D,"value",at));let H=t[1]&&Ue(t);function st(a){t[11](a)}let Te={label:"Route length assessed here (km)",width:6,min:0};t[0].summary.assessedRouteLengthKm!==void 0&&(Te.value=t[0].summary.assessedRouteLengthKm),z=new Ye({props:Te}),F.push(()=>x(z,"value",st));function rt(a){t[12](a)}let Ee={label:"Total route length (km)",width:6,min:0};t[0].summary.totalRouteLengthKm!==void 0&&(Ee.value=t[0].summary.totalRouteLengthKm),B=new Ye({props:Ee}),F.push(()=>x(B,"value",rt));function it(a){t[13](a)}let Ne={label:"Notes"};return t[0].summary.notes!==void 0&&(Ne.value=t[0].summary.notes),G=new Le({props:Ne}),F.push(()=>x(G,"value",it)),ee=new Et({}),{c(){e=T("div"),k(i.$$.fragment),n=$(),k(s.$$.fragment),b=$(),k(l.$$.fragment),W=$(),k(g.$$.fragment),A=$(),k(d.$$.fragment),te=$(),k(p.$$.fragment),J=$(),k(w.$$.fragment),pe=$(),k(q.$$.fragment),ge=$(),k(D.$$.fragment),he=$(),H&&H.c(),Y=$(),k(z.$$.fragment),U=$(),k(B.$$.fragment),Q=$(),k(G.$$.fragment),X=$(),k(ee.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var u=ue(e);C(i.$$.fragment,u),n=c(u),C(s.$$.fragment,u),b=c(u),C(l.$$.fragment,u),W=c(u),C(g.$$.fragment,u),A=c(u),C(d.$$.fragment,u),te=c(u),C(p.$$.fragment,u),J=c(u),C(w.$$.fragment,u),pe=c(u),C(q.$$.fragment,u),ge=c(u),C(D.$$.fragment,u),he=c(u),H&&H.l(u),Y=c(u),C(z.$$.fragment,u),U=c(u),C(B.$$.fragment,u),Q=c(u),C(G.$$.fragment,u),X=c(u),C(ee.$$.fragment,u),u.forEach(N),this.h()},h(){ut(e,"class","govuk-width-container")},m(a,u){se(a,e,u),S(i,e,null),m(e,n),S(s,e,null),m(e,b),S(l,e,null),m(e,W),S(g,e,null),m(e,A),S(d,e,null),m(e,te),S(p,e,null),m(e,J),S(w,e,null),m(e,pe),S(q,e,null),m(e,ge),S(D,e,null),m(e,he),H&&H.m(e,null),m(e,Y),S(z,e,null),m(e,U),S(B,e,null),m(e,Q),S(G,e,null),m(e,X),S(ee,e,null),ie=!0},p(a,[u]){const qe={};!r&&u&1&&(r=!0,qe.value=a[0].summary.schemeReference,K(()=>r=!1)),i.$set(qe);const De={};!h&&u&1&&(h=!0,De.value=a[0].summary.schemeName,K(()=>h=!1)),s.$set(De);const He={};!I&&u&1&&(I=!0,He.value=a[0].summary.schemeSummary,K(()=>I=!1)),l.$set(He);const Pe={};!j&&u&1&&(j=!0,Pe.value=a[0].summary.authority,K(()=>j=!1)),g.$set(Pe);const je={};!re&&u&1&&(re=!0,je.value=a[0].summary.transportOrCombinedAuthority,K(()=>re=!1)),d.$set(je);const Ae={};!o&&u&1&&(o=!0,Ae.value=a[0].summary.region,K(()=>o=!1)),p.$set(Ae);const Fe={};!fe&&u&1&&(fe=!0,Fe.value=a[0].summary.fundingProgramme,K(()=>fe=!1)),w.$set(Fe);const Ke={};!ve&&u&1&&(ve=!0,Ke.value=a[0].summary.designStage,K(()=>ve=!1)),q.$set(Ke);const xe={};!ye&&u&1&&(ye=!0,xe.value=a[0].summary.fundingConditions,K(()=>ye=!1)),D.$set(xe),a[1]?H?H.p(a,u):(H=Ue(a),H.c(),H.m(e,Y)):H&&(H.d(1),H=null);const ze={};!$e&&u&1&&($e=!0,ze.value=a[0].summary.assessedRouteLengthKm,K(()=>$e=!1)),z.$set(ze);const Be={};!ce&&u&1&&(ce=!0,Be.value=a[0].summary.totalRouteLengthKm,K(()=>ce=!1)),B.$set(Be);const Ge={};!de&&u&1&&(de=!0,Ge.value=a[0].summary.notes,K(()=>de=!1)),G.$set(Ge)},i(a){ie||(_(i.$$.fragment,a),_(s.$$.fragment,a),_(l.$$.fragment,a),_(g.$$.fragment,a),_(d.$$.fragment,a),_(p.$$.fragment,a),_(w.$$.fragment,a),_(q.$$.fragment,a),_(D.$$.fragment,a),_(z.$$.fragment,a),_(B.$$.fragment,a),_(G.$$.fragment,a),_(ee.$$.fragment,a),ie=!0)},o(a){y(i.$$.fragment,a),y(s.$$.fragment,a),y(l.$$.fragment,a),y(g.$$.fragment,a),y(d.$$.fragment,a),y(p.$$.fragment,a),y(w.$$.fragment,a),y(q.$$.fragment,a),y(D.$$.fragment,a),y(z.$$.fragment,a),y(B.$$.fragment,a),y(G.$$.fragment,a),y(ee.$$.fragment,a),ie=!1},d(a){a&&N(e),L(i),L(s),L(l),L(g),L(d),L(p),L(w),L(q),L(D),H&&H.d(),L(z),L(B),L(G),L(ee)}}}function qt(t,e,i){let r,n;Xe(t,P,o=>i(0,n=o));function s(o){let J=0;for(let w of o.features)w.geometry.type=="LineString"&&(J+=St(w,{units:"kilometers"}));return J>0?J:null}function h(o){t.$$.not_equal(n.summary.schemeReference,o)&&(n.summary.schemeReference=o,P.set(n))}function b(o){t.$$.not_equal(n.summary.schemeName,o)&&(n.summary.schemeName=o,P.set(n))}function l(o){t.$$.not_equal(n.summary.schemeSummary,o)&&(n.summary.schemeSummary=o,P.set(n))}function I(o){t.$$.not_equal(n.summary.authority,o)&&(n.summary.authority=o,P.set(n))}function W(o){t.$$.not_equal(n.summary.transportOrCombinedAuthority,o)&&(n.summary.transportOrCombinedAuthority=o,P.set(n))}function g(o){t.$$.not_equal(n.summary.region,o)&&(n.summary.region=o,P.set(n))}function j(o){t.$$.not_equal(n.summary.fundingProgramme,o)&&(n.summary.fundingProgramme=o,P.set(n))}function A(o){t.$$.not_equal(n.summary.designStage,o)&&(n.summary.designStage=o,P.set(n))}function d(o){t.$$.not_equal(n.summary.fundingConditions,o)&&(n.summary.fundingConditions=o,P.set(n))}function re(o){t.$$.not_equal(n.summary.assessedRouteLengthKm,o)&&(n.summary.assessedRouteLengthKm=o,P.set(n))}function te(o){t.$$.not_equal(n.summary.totalRouteLengthKm,o)&&(n.summary.totalRouteLengthKm=o,P.set(n))}function p(o){t.$$.not_equal(n.summary.notes,o)&&(n.summary.notes=o,P.set(n))}return t.$$.update=()=>{t.$$.dirty&1&&i(1,r=s(n.summary.networkMap))},[n,r,h,b,l,I,W,g,j,A,d,re,te,p]}class Qt extends et{constructor(e){super(),tt(this,e,qt,Nt,Qe,{})}}export{Qt as component};
