import{s as ye,r as Q,e as H,t as J,a as q,c as K,b as Y,d as X,f as d,g as B,o as O,v as z,i as L,h as T,w as x,k as Ie,z as He,U as Ke,Y as ve,S as Ne,E as me,m as be,G as $e,j as fe,n as Ye,K as ke,L as we}from"../chunks/scheduler.DNnUYlgZ.js";import{S as Le,i as Se,e as ee,c as G,a as M,m as V,t as I,b as N,d as R,f as ue,g as ce}from"../chunks/index.tVBxdTp3.js";import{s as ge,d as de,M as Ze,f as We,b as Je,C as Xe,G as Qe,h as xe}from"../chunks/index.CGKOjZ2U.js";import{e as oe}from"../chunks/each.BkSaxPTE.js";import{c as et,p as tt}from"../chunks/colors.CYEpEtTL.js";import{p as Ve}from"../chunks/index.jWXzrl53.js";import{S as he}from"../chunks/Select.J5KI9BoG.js";/* empty css                                                               */import{T as Re}from"../chunks/TextArea.NwvsZ3J4.js";import{T as Fe}from"../chunks/TextInput.BIr_xOOQ.js";import{s as W}from"../chunks/data.CVMYvAkq.js";import{c as lt,p as nt}from"../chunks/lists.djxH55N_.js";import{Y as Oe}from"../chunks/YesNo.D_MPn8J2.js";import{B as it,G as ot,S as st,C as rt,a as at,M as Ue}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.D4aUOt7-.js";import{C as ft}from"../chunks/CollapsibleCard.JZZ-_N1r.js";import{D as ut}from"../chunks/DefaultButton.B_sEEUsJ.js";import{R as ct}from"../chunks/Radio.DQ8GJLiV.js";import{S as pt}from"../chunks/SecondaryButton.CsCq7jjb.js";import{W as _t}from"../chunks/WarningButton.BcgE3MAp.js";import{G as mt}from"../chunks/GeoreferenceLayer.C-dFJx0e.js";import{C as ze}from"../chunks/ClickableCard.C-b1L8ER.js";/* empty css                                                    */import"../chunks/paths.CxHhWrsf.js";function $t(t){let e,n,l,o,u,a,c,_,g,r,C,f,$,j,v,E,i,p,y,P,S,b,F,D;function se(s){t[2](s)}let m={label:"Critical Issue",emptyOption:!0,choices:lt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(m.value=t[1].criticalIssues[t[0]].criticalIssue),r=new he({props:m}),Q.push(()=>ee(r,"value",se));function k(s){t[3](s)}let U={label:"Stage",emptyOption:!0,choices:Ve(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(U.value=t[1].criticalIssues[t[0]].stage),$=new he({props:U}),Q.push(()=>ee($,"value",k));function ie(s){t[4](s)}let A={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(A.value=t[1].criticalIssues[t[0]].locationName),E=new Fe({props:A}),Q.push(()=>ee(E,"value",ie));function le(s){t[5](s)}let re={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(re.value=t[1].criticalIssues[t[0]].resolved),y=new Oe({props:re}),Q.push(()=>ee(y,"value",le));function pe(s){t[6](s)}let ae={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(ae.value=t[1].criticalIssues[t[0]].notes),b=new Re({props:ae}),Q.push(()=>ee(b,"value",pe)),{c(){e=H("div"),n=H("a"),l=J("Google StreetView"),u=q(),a=H("a"),c=J("Bing Streetside"),g=q(),G(r.$$.fragment),f=q(),G($.$$.fragment),v=q(),G(E.$$.fragment),p=q(),G(y.$$.fragment),S=q(),G(b.$$.fragment),this.h()},l(s){e=K(s,"DIV",{style:!0});var w=Y(e);n=K(w,"A",{href:!0,target:!0});var te=Y(n);l=X(te,"Google StreetView"),te.forEach(d),u=B(w),a=K(w,"A",{href:!0,target:!0});var h=Y(a);c=X(h,"Bing Streetside"),h.forEach(d),w.forEach(d),g=B(s),M(r.$$.fragment,s),f=B(s),M($.$$.fragment,s),v=B(s),M(E.$$.fragment,s),p=B(s),M(y.$$.fragment,s),S=B(s),M(b.$$.fragment,s),this.h()},h(){O(n,"href",o=ge(t[1].criticalIssues[t[0]].point)),O(n,"target","_blank"),O(a,"href",_=de(t[1].criticalIssues[t[0]].point)),O(a,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(s,w){L(s,e,w),T(e,n),T(n,l),T(e,u),T(e,a),T(a,c),L(s,g,w),V(r,s,w),L(s,f,w),V($,s,w),L(s,v,w),V(E,s,w),L(s,p,w),V(y,s,w),L(s,S,w),V(b,s,w),D=!0},p(s,[w]){(!D||w&3&&o!==(o=ge(s[1].criticalIssues[s[0]].point)))&&O(n,"href",o),(!D||w&3&&_!==(_=de(s[1].criticalIssues[s[0]].point)))&&O(a,"href",_);const te={};!C&&w&3&&(C=!0,te.value=s[1].criticalIssues[s[0]].criticalIssue,x(()=>C=!1)),r.$set(te);const h={};!j&&w&3&&(j=!0,h.value=s[1].criticalIssues[s[0]].stage,x(()=>j=!1)),$.$set(h);const Z={};!i&&w&3&&(i=!0,Z.value=s[1].criticalIssues[s[0]].locationName,x(()=>i=!1)),E.$set(Z);const ne={};!P&&w&3&&(P=!0,ne.value=s[1].criticalIssues[s[0]].resolved,x(()=>P=!1)),y.$set(ne);const _e={};!F&&w&3&&(F=!0,_e.value=s[1].criticalIssues[s[0]].notes,x(()=>F=!1)),b.$set(_e)},i(s){D||(I(r.$$.fragment,s),I($.$$.fragment,s),I(E.$$.fragment,s),I(y.$$.fragment,s),I(b.$$.fragment,s),D=!0)},o(s){N(r.$$.fragment,s),N($.$$.fragment,s),N(E.$$.fragment,s),N(y.$$.fragment,s),N(b.$$.fragment,s),D=!1},d(s){s&&(d(e),d(g),d(f),d(v),d(p),d(S)),R(r,s),R($,s),R(E,s),R(y,s),R(b,s)}}}function gt(t,e,n){let l;Ie(t,W,r=>n(1,l=r));let{idx:o}=e;function u(r){t.$$.not_equal(l.criticalIssues[o].criticalIssue,r)&&(l.criticalIssues[o].criticalIssue=r,W.set(l))}function a(r){t.$$.not_equal(l.criticalIssues[o].stage,r)&&(l.criticalIssues[o].stage=r,W.set(l))}function c(r){t.$$.not_equal(l.criticalIssues[o].locationName,r)&&(l.criticalIssues[o].locationName=r,W.set(l))}function _(r){t.$$.not_equal(l.criticalIssues[o].resolved,r)&&(l.criticalIssues[o].resolved=r,W.set(l))}function g(r){t.$$.not_equal(l.criticalIssues[o].notes,r)&&(l.criticalIssues[o].notes=r,W.set(l))}return t.$$set=r=>{"idx"in r&&n(0,o=r.idx)},[o,l,u,a,c,_,g]}class dt extends Le{constructor(e){super(),Se(this,e,gt,$t,ye,{idx:0})}}function ht(t){let e,n,l,o,u,a,c,_,g,r,C,f,$,j,v,E,i,p,y,P,S,b,F,D;function se(s){t[2](s)}let m={label:"Policy Conflict",emptyOption:!0,choices:nt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(m.value=t[1].policyConflictLog[t[0]].conflict),r=new he({props:m}),Q.push(()=>ee(r,"value",se));function k(s){t[3](s)}let U={label:"Stage",emptyOption:!0,choices:Ve(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(U.value=t[1].policyConflictLog[t[0]].stage),$=new he({props:U}),Q.push(()=>ee($,"value",k));function ie(s){t[4](s)}let A={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(A.value=t[1].policyConflictLog[t[0]].locationName),E=new Fe({props:A}),Q.push(()=>ee(E,"value",ie));function le(s){t[5](s)}let re={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(re.value=t[1].policyConflictLog[t[0]].resolved),y=new Oe({props:re}),Q.push(()=>ee(y,"value",le));function pe(s){t[6](s)}let ae={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(ae.value=t[1].policyConflictLog[t[0]].notes),b=new Re({props:ae}),Q.push(()=>ee(b,"value",pe)),{c(){e=H("div"),n=H("a"),l=J("Google StreetView"),u=q(),a=H("a"),c=J("Bing Streetside"),g=q(),G(r.$$.fragment),f=q(),G($.$$.fragment),v=q(),G(E.$$.fragment),p=q(),G(y.$$.fragment),S=q(),G(b.$$.fragment),this.h()},l(s){e=K(s,"DIV",{style:!0});var w=Y(e);n=K(w,"A",{href:!0,target:!0});var te=Y(n);l=X(te,"Google StreetView"),te.forEach(d),u=B(w),a=K(w,"A",{href:!0,target:!0});var h=Y(a);c=X(h,"Bing Streetside"),h.forEach(d),w.forEach(d),g=B(s),M(r.$$.fragment,s),f=B(s),M($.$$.fragment,s),v=B(s),M(E.$$.fragment,s),p=B(s),M(y.$$.fragment,s),S=B(s),M(b.$$.fragment,s),this.h()},h(){O(n,"href",o=ge(t[1].policyConflictLog[t[0]].point)),O(n,"target","_blank"),O(a,"href",_=de(t[1].policyConflictLog[t[0]].point)),O(a,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(s,w){L(s,e,w),T(e,n),T(n,l),T(e,u),T(e,a),T(a,c),L(s,g,w),V(r,s,w),L(s,f,w),V($,s,w),L(s,v,w),V(E,s,w),L(s,p,w),V(y,s,w),L(s,S,w),V(b,s,w),D=!0},p(s,[w]){(!D||w&3&&o!==(o=ge(s[1].policyConflictLog[s[0]].point)))&&O(n,"href",o),(!D||w&3&&_!==(_=de(s[1].policyConflictLog[s[0]].point)))&&O(a,"href",_);const te={};!C&&w&3&&(C=!0,te.value=s[1].policyConflictLog[s[0]].conflict,x(()=>C=!1)),r.$set(te);const h={};!j&&w&3&&(j=!0,h.value=s[1].policyConflictLog[s[0]].stage,x(()=>j=!1)),$.$set(h);const Z={};!i&&w&3&&(i=!0,Z.value=s[1].policyConflictLog[s[0]].locationName,x(()=>i=!1)),E.$set(Z);const ne={};!P&&w&3&&(P=!0,ne.value=s[1].policyConflictLog[s[0]].resolved,x(()=>P=!1)),y.$set(ne);const _e={};!F&&w&3&&(F=!0,_e.value=s[1].policyConflictLog[s[0]].notes,x(()=>F=!1)),b.$set(_e)},i(s){D||(I(r.$$.fragment,s),I($.$$.fragment,s),I(E.$$.fragment,s),I(y.$$.fragment,s),I(b.$$.fragment,s),D=!0)},o(s){N(r.$$.fragment,s),N($.$$.fragment,s),N(E.$$.fragment,s),N(y.$$.fragment,s),N(b.$$.fragment,s),D=!1},d(s){s&&(d(e),d(g),d(f),d(v),d(p),d(S)),R(r,s),R($,s),R(E,s),R(y,s),R(b,s)}}}function vt(t,e,n){let l;Ie(t,W,r=>n(1,l=r));let{idx:o}=e;function u(r){t.$$.not_equal(l.policyConflictLog[o].conflict,r)&&(l.policyConflictLog[o].conflict=r,W.set(l))}function a(r){t.$$.not_equal(l.policyConflictLog[o].stage,r)&&(l.policyConflictLog[o].stage=r,W.set(l))}function c(r){t.$$.not_equal(l.policyConflictLog[o].locationName,r)&&(l.policyConflictLog[o].locationName=r,W.set(l))}function _(r){t.$$.not_equal(l.policyConflictLog[o].resolved,r)&&(l.policyConflictLog[o].resolved=r,W.set(l))}function g(r){t.$$.not_equal(l.policyConflictLog[o].notes,r)&&(l.policyConflictLog[o].notes=r,W.set(l))}return t.$$set=r=>{"idx"in r&&n(0,o=r.idx)},[o,l,u,a,c,_,g]}class bt extends Le{constructor(e){super(),Se(this,e,vt,ht,ye,{idx:0})}}const{window:kt}=We;function Ee(t,e,n){const l=t.slice();return l[35]=e[n],l[36]=e,l[37]=n,l}function De(t,e,n){const l=t.slice();return l[38]=e[n],l[39]=e,l[37]=n,l}function je(t,e,n){const l=t.slice();return l[35]=e[n],l[37]=n,l}function Ae(t,e,n){const l=t.slice();return l[38]=e[n],l[37]=n,l}function wt(t){let e,n,l,o,u,a,c,_;e=new ut({props:{$$slots:{default:[yt]},$$scope:{ctx:t}}}),e.$on("click",t[11]),l=new _t({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),l.$on("click",t[13]);const g=[St,Lt],r=[];function C(f,$){return f[0].kind=="critical"?0:1}return u=C(t),a=r[u]=g[u](t),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q(),a.c(),c=me()},l(f){M(e.$$.fragment,f),n=B(f),M(l.$$.fragment,f),o=B(f),a.l(f),c=me()},m(f,$){V(e,f,$),L(f,n,$),V(l,f,$),L(f,o,$),r[u].m(f,$),L(f,c,$),_=!0},p(f,$){const j={};$[1]&2048&&(j.$$scope={dirty:$,ctx:f}),e.$set(j);const v={};$[1]&2048&&(v.$$scope={dirty:$,ctx:f}),l.$set(v);let E=u;u=C(f),u===E?r[u].p(f,$):(ce(),N(r[E],1,1,()=>{r[E]=null}),ue(),a=r[u],a?a.p(f,$):(a=r[u]=g[u](f),a.c()),I(a,1),a.m(c.parentNode,c))},i(f){_||(I(e.$$.fragment,f),I(l.$$.fragment,f),I(a),_=!0)},o(f){N(e.$$.fragment,f),N(l.$$.fragment,f),N(a),_=!1},d(f){f&&(d(n),d(o),d(c)),R(e,f),R(l,f),r[u].d(f)}}}function Ct(t){let e,n,l,o,u,a,c="Click the map to add a problem, or select a problem to fill out data",_,g,r="Critical Issues",C,f,$,j="Policy Conflicts",v,E,i;e=new ft({props:{label:"Tools",$$slots:{default:[Dt]},$$scope:{ctx:t}}});function p(m){t[19](m)}let y={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[5]!==void 0&&(y.value=t[5]),l=new ct({props:y}),Q.push(()=>ee(l,"value",p));let P=oe(t[2].criticalIssues),S=[];for(let m=0;m<P.length;m+=1)S[m]=qe(Ae(t,P,m));const b=m=>N(S[m],1,1,()=>{S[m]=null});let F=oe(t[2].policyConflictLog),D=[];for(let m=0;m<F.length;m+=1)D[m]=Be(je(t,F,m));const se=m=>N(D[m],1,1,()=>{D[m]=null});return{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),u=q(),a=H("p"),a.textContent=c,_=q(),g=H("h3"),g.textContent=r,C=q();for(let m=0;m<S.length;m+=1)S[m].c();f=q(),$=H("h3"),$.textContent=j,v=q();for(let m=0;m<D.length;m+=1)D[m].c();E=me()},l(m){M(e.$$.fragment,m),n=B(m),M(l.$$.fragment,m),u=B(m),a=K(m,"P",{"data-svelte-h":!0}),be(a)!=="svelte-12ba5j2"&&(a.textContent=c),_=B(m),g=K(m,"H3",{"data-svelte-h":!0}),be(g)!=="svelte-1qhh5xr"&&(g.textContent=r),C=B(m);for(let k=0;k<S.length;k+=1)S[k].l(m);f=B(m),$=K(m,"H3",{"data-svelte-h":!0}),be($)!=="svelte-eyxzjx"&&($.textContent=j),v=B(m);for(let k=0;k<D.length;k+=1)D[k].l(m);E=me()},m(m,k){V(e,m,k),L(m,n,k),V(l,m,k),L(m,u,k),L(m,a,k),L(m,_,k),L(m,g,k),L(m,C,k);for(let U=0;U<S.length;U+=1)S[U]&&S[U].m(m,k);L(m,f,k),L(m,$,k),L(m,v,k);for(let U=0;U<D.length;U+=1)D[U]&&D[U].m(m,k);L(m,E,k),i=!0},p(m,k){const U={};k[0]&200|k[1]&2048&&(U.$$scope={dirty:k,ctx:m}),e.$set(U);const ie={};if(!o&&k[0]&32&&(o=!0,ie.value=m[5],x(()=>o=!1)),l.$set(ie),k[0]&1030){P=oe(m[2].criticalIssues);let A;for(A=0;A<P.length;A+=1){const le=Ae(m,P,A);S[A]?(S[A].p(le,k),I(S[A],1)):(S[A]=qe(le),S[A].c(),I(S[A],1),S[A].m(f.parentNode,f))}for(ce(),A=P.length;A<S.length;A+=1)b(A);ue()}if(k[0]&1030){F=oe(m[2].policyConflictLog);let A;for(A=0;A<F.length;A+=1){const le=je(m,F,A);D[A]?(D[A].p(le,k),I(D[A],1)):(D[A]=Be(le),D[A].c(),I(D[A],1),D[A].m(E.parentNode,E))}for(ce(),A=F.length;A<D.length;A+=1)se(A);ue()}},i(m){if(!i){I(e.$$.fragment,m),I(l.$$.fragment,m);for(let k=0;k<P.length;k+=1)I(S[k]);for(let k=0;k<F.length;k+=1)I(D[k]);i=!0}},o(m){N(e.$$.fragment,m),N(l.$$.fragment,m),S=S.filter(Boolean);for(let k=0;k<S.length;k+=1)N(S[k]);D=D.filter(Boolean);for(let k=0;k<D.length;k+=1)N(D[k]);i=!1},d(m){m&&(d(n),d(u),d(a),d(_),d(g),d(C),d(f),d($),d(v),d(E)),R(e,m),R(l,m),$e(S,m),$e(D,m)}}}function yt(t){let e;return{c(){e=J("Save")},l(n){e=X(n,"Save")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function It(t){let e;return{c(){e=J("Delete")},l(n){e=X(n,"Delete")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Lt(t){let e,n;return e=new bt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p(l,o){const u={};o[0]&1&&(u.idx=l[0].idx),e.$set(u)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function St(t){let e,n;return e=new dt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p(l,o){const u={};o[0]&1&&(u.idx=l[0].idx),e.$set(u)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function Nt(t){let e;return{c(){e=J("Zoom to fit")},l(n){e=X(n,"Zoom to fit")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Et(t){let e;return{c(){e=J("Show scheme context")},l(n){e=X(n,"Show scheme context")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Dt(t){let e,n,l,o,u,a,c,_,g,r,C,f;e=new pt({props:{$$slots:{default:[Nt]},$$scope:{ctx:t}}}),e.$on("click",t[16]),l=new it({}),u=new ot({});function $(i){t[17](i)}let j={map:t[3]};t[6]!==void 0&&(j.enabled=t[6]),c=new st({props:j}),Q.push(()=>ee(c,"enabled",$));function v(i){t[18](i)}let E={$$slots:{default:[Et]},$$scope:{ctx:t}};return t[7]!==void 0&&(E.checked=t[7]),r=new rt({props:E}),Q.push(()=>ee(r,"checked",v)),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q(),G(u.$$.fragment),a=q(),G(c.$$.fragment),g=q(),G(r.$$.fragment)},l(i){M(e.$$.fragment,i),n=B(i),M(l.$$.fragment,i),o=B(i),M(u.$$.fragment,i),a=B(i),M(c.$$.fragment,i),g=B(i),M(r.$$.fragment,i)},m(i,p){V(e,i,p),L(i,n,p),V(l,i,p),L(i,o,p),V(u,i,p),L(i,a,p),V(c,i,p),L(i,g,p),V(r,i,p),f=!0},p(i,p){const y={};p[1]&2048&&(y.$$scope={dirty:p,ctx:i}),e.$set(y);const P={};p[0]&8&&(P.map=i[3]),!_&&p[0]&64&&(_=!0,P.enabled=i[6],x(()=>_=!1)),c.$set(P);const S={};p[1]&2048&&(S.$$scope={dirty:p,ctx:i}),!C&&p[0]&128&&(C=!0,S.checked=i[7],x(()=>C=!1)),r.$set(S)},i(i){f||(I(e.$$.fragment,i),I(l.$$.fragment,i),I(u.$$.fragment,i),I(c.$$.fragment,i),I(r.$$.fragment,i),f=!0)},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),N(u.$$.fragment,i),N(c.$$.fragment,i),N(r.$$.fragment,i),f=!1},d(i){i&&(d(n),d(o),d(a),d(g)),R(e,i),R(l,i),R(u,i),R(c,i),R(r,i)}}}function jt(t){let e,n,l,o=t[38].stage+"",u,a,c,_,g=t[38].resolved+"",r;return{c(){e=H("div"),n=H("span"),l=J("Stage: "),u=J(o),a=q(),c=H("span"),_=J("Resolved: "),r=J(g),this.h()},l(C){e=K(C,"DIV",{style:!0});var f=Y(e);n=K(f,"SPAN",{});var $=Y(n);l=X($,"Stage: "),u=X($,o),$.forEach(d),a=B(f),c=K(f,"SPAN",{});var j=Y(c);_=X(j,"Resolved: "),r=X(j,g),j.forEach(d),f.forEach(d),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(C,f){L(C,e,f),T(e,n),T(n,l),T(n,u),T(e,a),T(e,c),T(c,_),T(c,r)},p(C,f){f[0]&4&&o!==(o=C[38].stage+"")&&fe(u,o),f[0]&4&&g!==(g=C[38].resolved+"")&&fe(r,g)},d(C){C&&d(e)}}}function qe(t){let e,n,l;function o(){return t[20](t[37])}function u(){return t[21](t[37])}return n=new ze({props:{name:Ge(t[38]),$$slots:{default:[jt]},$$scope:{ctx:t}}}),n.$on("click",o),n.$on("mouseenter",u),n.$on("mouseleave",t[22]),{c(){e=H("li"),G(n.$$.fragment)},l(a){e=K(a,"LI",{});var c=Y(e);M(n.$$.fragment,c),c.forEach(d)},m(a,c){L(a,e,c),V(n,e,null),l=!0},p(a,c){t=a;const _={};c[0]&4&&(_.name=Ge(t[38])),c[0]&4|c[1]&2048&&(_.$$scope={dirty:c,ctx:t}),n.$set(_)},i(a){l||(I(n.$$.fragment,a),l=!0)},o(a){N(n.$$.fragment,a),l=!1},d(a){a&&d(e),R(n)}}}function At(t){let e,n,l,o=t[35].stage+"",u,a,c,_,g=t[35].resolved+"",r,C;return{c(){e=H("div"),n=H("span"),l=J("Stage: "),u=J(o),a=q(),c=H("span"),_=J("Resolved: "),r=J(g),C=q(),this.h()},l(f){e=K(f,"DIV",{style:!0});var $=Y(e);n=K($,"SPAN",{});var j=Y(n);l=X(j,"Stage: "),u=X(j,o),j.forEach(d),a=B($),c=K($,"SPAN",{});var v=Y(c);_=X(v,"Resolved: "),r=X(v,g),v.forEach(d),$.forEach(d),C=B(f),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(f,$){L(f,e,$),T(e,n),T(n,l),T(n,u),T(e,a),T(e,c),T(c,_),T(c,r),L(f,C,$)},p(f,$){$[0]&4&&o!==(o=f[35].stage+"")&&fe(u,o),$[0]&4&&g!==(g=f[35].resolved+"")&&fe(r,g)},d(f){f&&(d(e),d(C))}}}function Be(t){let e,n;function l(){return t[23](t[37])}function o(){return t[24](t[37])}return e=new ze({props:{name:Me(t[35]),$$slots:{default:[At]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",o),e.$on("mouseleave",t[25]),{c(){G(e.$$.fragment)},l(u){M(e.$$.fragment,u)},m(u,a){V(e,u,a),n=!0},p(u,a){t=u;const c={};a[0]&4&&(c.name=Me(t[35])),a[0]&4|a[1]&2048&&(c.$$scope={dirty:a,ctx:t}),e.$set(c)},i(u){n||(I(e.$$.fragment,u),n=!0)},o(u){N(e.$$.fragment,u),n=!1},d(u){R(e,u)}}}function qt(t){let e,n,l,o=t[38].criticalIssue+"",u;return{c(){e=ke("svg"),n=ke("polygon"),l=ke("text"),u=J(o),this.h()},l(a){e=we(a,"svg",{width:!0,height:!0,xmlns:!0});var c=Y(e);n=we(c,"polygon",{points:!0,fill:!0,class:!0}),Y(n).forEach(d),l=we(c,"text",{x:!0,y:!0});var _=Y(l);u=X(_,o),_.forEach(d),c.forEach(d),this.h()},h(){O(n,"points","20,0 0,40 40,40"),O(n,"fill",et.critical.background),O(n,"class","svelte-ktyu3j"),O(l,"x","13"),O(l,"y","30"),z(l,"fill","white"),O(e,"width","40"),O(e,"height","40"),O(e,"xmlns","http://www.w3.org/2000/svg")},m(a,c){L(a,e,c),T(e,n),T(e,l),T(l,u)},p(a,c){c[0]&4&&o!==(o=a[38].criticalIssue+"")&&fe(u,o)},d(a){a&&d(e)}}}function Pe(t){let e,n,l;function o(_){t[27](_,t[38])}function u(){return t[28](t[37])}function a(){return t[29](t[37])}let c={draggable:!0,$$slots:{default:[qt]},$$scope:{ctx:t}};return t[38].point!==void 0&&(c.lngLat=t[38].point),e=new Ue({props:c}),Q.push(()=>ee(e,"lngLat",o)),e.$on("click",u),e.$on("dragend",a),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,g){V(e,_,g),l=!0},p(_,g){t=_;const r={};g[0]&4|g[1]&2048&&(r.$$scope={dirty:g,ctx:t}),!n&&g[0]&4&&(n=!0,r.lngLat=t[38].point,x(()=>n=!1)),e.$set(r)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function Bt(t){let e,n=t[35].conflict+"",l;return{c(){e=H("span"),l=J(n),this.h()},l(o){e=K(o,"SPAN",{class:!0});var u=Y(e);l=X(u,n),u.forEach(d),this.h()},h(){O(e,"class","dot svelte-ktyu3j"),z(e,"background",tt)},m(o,u){L(o,e,u),T(e,l)},p(o,u){u[0]&4&&n!==(n=o[35].conflict+"")&&fe(l,n)},d(o){o&&d(e)}}}function Te(t){let e,n,l;function o(_){t[30](_,t[35])}function u(){return t[31](t[37])}function a(){return t[32](t[37])}let c={draggable:!0,$$slots:{default:[Bt]},$$scope:{ctx:t}};return t[35].point!==void 0&&(c.lngLat=t[35].point),e=new Ue({props:c}),Q.push(()=>ee(e,"lngLat",o)),e.$on("click",u),e.$on("dragend",a),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,g){V(e,_,g),l=!0},p(_,g){t=_;const r={};g[0]&4|g[1]&2048&&(r.$$scope={dirty:g,ctx:t}),!n&&g[0]&4&&(n=!0,r.lngLat=t[35].point,x(()=>n=!1)),e.$set(r)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function Pt(t){let e,n;return e=new xe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p:Ye,i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function Tt(t){let e,n,l,o,u,a,c,_,g,r;e=new at({}),e.$on("click",t[12]),l=new Xe({props:{gj:t[2].summary.networkMap,show:t[7]}});let C=oe(t[2].criticalIssues),f=[];for(let i=0;i<C.length;i+=1)f[i]=Pe(De(t,C,i));const $=i=>N(f[i],1,1,()=>{f[i]=null});let j=oe(t[2].policyConflictLog),v=[];for(let i=0;i<j.length;i+=1)v[i]=Te(Ee(t,j,i));const E=i=>N(v[i],1,1,()=>{v[i]=null});return c=new Qe({props:{data:t[8],$$slots:{default:[Pt]},$$scope:{ctx:t}}}),g=new mt({props:{map:t[3]}}),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q();for(let i=0;i<f.length;i+=1)f[i].c();u=q();for(let i=0;i<v.length;i+=1)v[i].c();a=q(),G(c.$$.fragment),_=q(),G(g.$$.fragment)},l(i){M(e.$$.fragment,i),n=B(i),M(l.$$.fragment,i),o=B(i);for(let p=0;p<f.length;p+=1)f[p].l(i);u=B(i);for(let p=0;p<v.length;p+=1)v[p].l(i);a=B(i),M(c.$$.fragment,i),_=B(i),M(g.$$.fragment,i)},m(i,p){V(e,i,p),L(i,n,p),V(l,i,p),L(i,o,p);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(i,p);L(i,u,p);for(let y=0;y<v.length;y+=1)v[y]&&v[y].m(i,p);L(i,a,p),V(c,i,p),L(i,_,p),V(g,i,p),r=!0},p(i,p){const y={};if(p[0]&4&&(y.gj=i[2].summary.networkMap),p[0]&128&&(y.show=i[7]),l.$set(y),p[0]&516){C=oe(i[2].criticalIssues);let b;for(b=0;b<C.length;b+=1){const F=De(i,C,b);f[b]?(f[b].p(F,p),I(f[b],1)):(f[b]=Pe(F),f[b].c(),I(f[b],1),f[b].m(u.parentNode,u))}for(ce(),b=C.length;b<f.length;b+=1)$(b);ue()}if(p[0]&516){j=oe(i[2].policyConflictLog);let b;for(b=0;b<j.length;b+=1){const F=Ee(i,j,b);v[b]?(v[b].p(F,p),I(v[b],1)):(v[b]=Te(F),v[b].c(),I(v[b],1),v[b].m(a.parentNode,a))}for(ce(),b=j.length;b<v.length;b+=1)E(b);ue()}const P={};p[0]&256&&(P.data=i[8]),p[1]&2048&&(P.$$scope={dirty:p,ctx:i}),c.$set(P);const S={};p[0]&8&&(S.map=i[3]),g.$set(S)},i(i){if(!r){I(e.$$.fragment,i),I(l.$$.fragment,i);for(let p=0;p<C.length;p+=1)I(f[p]);for(let p=0;p<j.length;p+=1)I(v[p]);I(c.$$.fragment,i),I(g.$$.fragment,i),r=!0}},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)N(f[p]);v=v.filter(Boolean);for(let p=0;p<v.length;p+=1)N(v[p]);N(c.$$.fragment,i),N(g.$$.fragment,i),r=!1},d(i){i&&(d(n),d(o),d(u),d(a),d(_)),R(e,i),R(l,i),$e(f,i),$e(v,i),R(c,i),R(g,i)}}}function Gt(t){let e,n,l,o,u,a,c,_,g,r,C;const f=[Ct,wt],$=[];function j(i,p){return i[0]==null?0:1}l=j(t),o=$[l]=f[l](t);function v(i){t[33](i)}let E={$$slots:{default:[Tt]},$$scope:{ctx:t}};return t[3]!==void 0&&(E.map=t[3]),c=new Ze({props:E}),Q.push(()=>ee(c,"map",v)),{c(){e=H("div"),n=H("div"),o.c(),u=q(),a=H("div"),G(c.$$.fragment),this.h()},l(i){e=K(i,"DIV",{style:!0});var p=Y(e);n=K(p,"DIV",{style:!0});var y=Y(n);o.l(y),y.forEach(d),u=B(p),a=K(p,"DIV",{style:!0});var P=Y(a);M(c.$$.fragment,P),P.forEach(d),p.forEach(d),this.h()},h(){z(n,"width","30%"),z(n,"overflow-y","scroll"),z(n,"padding","10px"),z(n,"border","1px solid black"),z(a,"position","relative"),z(a,"width","70%"),z(e,"display","flex"),z(e,"height","80vh")},m(i,p){L(i,e,p),T(e,n),$[l].m(n,null),t[26](n),T(e,u),T(e,a),V(c,a,null),g=!0,r||(C=He(kt,"keydown",t[15]),r=!0)},p(i,p){let y=l;l=j(i),l===y?$[l].p(i,p):(ce(),N($[y],1,1,()=>{$[y]=null}),ue(),o=$[l],o?o.p(i,p):(o=$[l]=f[l](i),o.c()),I(o,1),o.m(n,null));const P={};p[0]&396|p[1]&2048&&(P.$$scope={dirty:p,ctx:i}),!_&&p[0]&8&&(_=!0,P.map=i[3],x(()=>_=!1)),c.$set(P)},i(i){g||(I(o),I(c.$$.fragment,i),g=!0)},o(i){N(o),N(c.$$.fragment,i),g=!1},d(i){i&&d(e),$[l].d(),t[26](null),R(c),r=!1,C()}}}function Mt(t,e,n){let l={type:"FeatureCollection",features:[]},o=e??n;if(o!=null){let u=o.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(Ce(u[o.idx].point))}return l}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Ge(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Me(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function Vt(t,e,n){let l,o;Ie(t,W,h=>n(2,o=h));let u,a,c="critical",_=null,g=null,r=null,C=!1,f=!0;async function $(h){g=a.scrollTop,n(0,_=h),n(1,r=null),await ve(),n(4,a.scrollTop=0,a)}async function j(h){g=a.scrollTop,n(0,_=h),n(1,r=null),await ve(),n(4,a.scrollTop=0,a);let Z=h.kind=="critical"?o.criticalIssues:o.policyConflictLog;u.flyTo({center:Z[h.idx].point,duration:500})}async function v(){n(0,_=null),g!=null&&(await ve(),n(4,a.scrollTop=g,a),g=null)}function E(h){if(!C){if(_!=null){v();return}c=="critical"?(Ne(W,o.criticalIssues=[...o.criticalIssues,{criticalIssue:"",stage:"",point:h.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],o),$({kind:"critical",idx:o.criticalIssues.length-1})):(Ne(W,o.policyConflictLog=[...o.policyConflictLog,{conflict:"",stage:"",point:h.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],o),$({kind:"conflict",idx:o.policyConflictLog.length-1}))}}Ke(()=>{p(!1)});function i(){window.confirm("Delete this entry?")&&(_.kind=="critical"?(o.criticalIssues.splice(_.idx,1),W.set(o)):(o.policyConflictLog.splice(_.idx,1),W.set(o)),v())}function p(h){let Z={type:"FeatureCollection",features:[...o.criticalIssues.map(ne=>Ce(ne.point)),...o.policyConflictLog.map(ne=>Ce(ne.point)),...o.summary.networkMap.features]};Z.features.length>0&&u.fitBounds(Je(Z),{padding:20,animate:h})}function y(h){if(_!=null&&h.key=="Escape")h.stopPropagation(),v();else if(_!=null&&h.key=="Delete"){let Z=h.target.tagName;if(Z=="INPUT"||Z=="TEXTAREA")return;h.stopPropagation(),i()}}const P=()=>p(!0);function S(h){C=h,n(6,C)}function b(h){f=h,n(7,f)}function F(h){c=h,n(5,c)}const D=h=>j({kind:"critical",idx:h}),se=h=>n(1,r={kind:"critical",idx:h}),m=()=>n(1,r=null),k=h=>j({kind:"conflict",idx:h}),U=h=>n(1,r={kind:"conflict",idx:h}),ie=()=>n(1,r=null);function A(h){Q[h?"unshift":"push"](()=>{a=h,n(4,a)})}function le(h,Z){t.$$.not_equal(Z.point,h)&&(Z.point=h,W.set(o))}const re=h=>$({kind:"critical",idx:h}),pe=h=>$({kind:"critical",idx:h});function ae(h,Z){t.$$.not_equal(Z.point,h)&&(Z.point=h,W.set(o))}const s=h=>$({kind:"conflict",idx:h}),w=h=>$({kind:"conflict",idx:h});function te(h){u=h,n(3,u)}return t.$$.update=()=>{t.$$.dirty[0]&7&&n(8,l=Mt(o,_,r))},[_,r,o,u,a,c,C,f,l,$,j,v,E,i,p,y,P,S,b,F,D,se,m,k,U,ie,A,le,re,pe,ae,s,w,te]}class fl extends Le{constructor(e){super(),Se(this,e,Vt,Gt,ye,{},null,[-1,-1])}}export{fl as component};
