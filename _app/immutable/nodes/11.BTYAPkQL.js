import{s as A,e as p,t as d,a as b,c as v,b as x,d as _,f as n,g as S,m as F,i as h,h as w,F as R,k as T,o as P,n as O}from"../chunks/scheduler.D1qsIhff.js";import{S as H,i as I,c as L,a as M,m as q,t as B,b as Q,d as j}from"../chunks/index.DMPy99Kf.js";import{e as K}from"../chunks/each.SoOTu3V6.js";import{b as N}from"../chunks/paths.CDqnbKAE.js";/* empty css                                                    */import{S as U}from"../chunks/SecondaryButton.C6yksGGa.js";/* empty css                                                               */import{E as z}from"../chunks/ExternalLink.aCJP2rrR.js";import{g as D}from"../chunks/index.DbJxBtdN.js";import{s as J}from"../chunks/data.DL6vCFy4.js";import{E as G}from"../chunks/exceljs.min.BuyXGIGS.js";import{d as V}from"../chunks/index.BXr4v5l0.js";const X=""+new URL("../assets/blank_area_check.Bd5ntWwK.xlsx",import.meta.url).href;async function Y(l){console.log("Loading blank area check xlsx");let e=await(await fetch(X)).arrayBuffer(),t=new G.Workbook;await t.xlsx.load(e),Z(l,t),ee(l,t),te(l,t),t.getWorksheet("Results & Commentary").getCell("F17").value=l.resultsNotes,console.log("Writing area check xlsx");let s=await t.xlsx.writeBuffer();V(s,"out.xlsx")}function Z(l,a){let e=a.getWorksheet("Summary of Scheme");e.getCell("C6").value=l.summary.dateDesignReview,e.getCell("C7").value=l.summary.schemeReference,e.getCell("C8").value=l.summary.schemeName,e.getCell("C9").value=l.summary.schemeSummary,e.getCell("C10").value=l.summary.schemeInfoReviewed,e.getCell("C11").value=l.summary.authority,e.getCell("C12").value=l.summary.transportOrCombinedAuthority,e.getCell("C13").value=l.summary.region,e.getCell("C14").value=l.summary.fundingProgramme,e.getCell("C15").value=l.summary.designStage,e.getCell("C16").value=l.summary.fundingConditions,e.getCell("C17").value=l.summary.inspectorEmail,e.getCell("C18").value=l.summary.schemeAreaSizeKm2,e.getCell("C19").value=l.summary.notes}function ee(l,a){let e=a.getWorksheet("Traffic Mitigation Check"),t=l.trafficMitigationCheck;e.getCell("C6").value=t.q1,e.getCell("C11").value=t.q2,e.getCell("C16").value=t.q3,t.q3=="Major routes (e.g. scheme eliminates a rat run)"?(e.getCell("C21").value=t.majorQ1,e.getCell("C26").value=t.majorQ2,e.getCell("C31").value=t.majorQ3,e.getCell("C36").value=t.majorQ4):t.q3=="Minor streets (e.g. residential)"&&(e.getCell("C21").value=t.minorQ1,e.getCell("C26").value=t.minorQ2),e.getCell("E11").value=t.notes}function te(l,a){a.getWorksheet("Area Scorecard")}function le(l,a,e){const t=l.slice();return t[3]=a[e][0],t[4]=a[e][1],t}function ae(l){let a;return{c(){a=d(`scheme review tool
  `)},l(e){a=_(e,`scheme review tool
  `)},m(e,t){h(e,a,t)},d(e){e&&n(a)}}}function re(l){let a,e,t;return{c(){a=p("li"),e=p("a"),t=d(l[4]),this.h()},l(s){a=v(s,"LI",{});var i=x(a);e=v(i,"A",{href:!0});var c=x(e);t=_(c,l[4]),c.forEach(n),i.forEach(n),this.h()},h(){P(e,"href",""+(N+l[3]))},m(s,i){h(s,a,i),w(a,e),w(e,t)},p:O,d(s){s&&n(a)}}}function oe(l){let a;return{c(){a=d("Convert to .xlsx (takes a few seconds)")},l(e){a=_(e,"Convert to .xlsx (takes a few seconds)")},m(e,t){h(e,a,t)},d(e){e&&n(a)}}}function ne(l){let a,e,t,s,i,c,$,u,k,g,E=`<i>When you open the file, you need to force Excel to recalculate all formulas
    with Ctrl + Alt + F9</i>`,y;t=new z({props:{href:"https://www.gov.uk/government/publications/active-travel-england-scheme-review-tools",$$slots:{default:[ae]},$$scope:{ctx:l}}});let W=K(D("/area_check")),f=[];for(let r=0;r<W.length;r+=1)f[r]=re(le(l,W,r));return u=new U({props:{$$slots:{default:[oe]},$$scope:{ctx:l}}}),u.$on("click",l[1]),{c(){a=p("p"),e=d("This is an experimental version of a "),L(t.$$.fragment),s=d("."),i=b(),c=p("ol");for(let r=0;r<f.length;r+=1)f[r].c();$=b(),L(u.$$.fragment),k=b(),g=p("p"),g.innerHTML=E},l(r){a=v(r,"P",{});var o=x(a);e=_(o,"This is an experimental version of a "),M(t.$$.fragment,o),s=_(o,"."),o.forEach(n),i=S(r),c=v(r,"OL",{});var m=x(c);for(let C=0;C<f.length;C+=1)f[C].l(m);m.forEach(n),$=S(r),M(u.$$.fragment,r),k=S(r),g=v(r,"P",{"data-svelte-h":!0}),F(g)!=="svelte-6hhtkc"&&(g.innerHTML=E)},m(r,o){h(r,a,o),w(a,e),q(t,a,null),w(a,s),h(r,i,o),h(r,c,o);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(c,null);h(r,$,o),q(u,r,o),h(r,k,o),h(r,g,o),y=!0},p(r,[o]){const m={};o&128&&(m.$$scope={dirty:o,ctx:r}),t.$set(m);const C={};o&128&&(C.$$scope={dirty:o,ctx:r}),u.$set(C)},i(r){y||(B(t.$$.fragment,r),B(u.$$.fragment,r),y=!0)},o(r){Q(t.$$.fragment,r),Q(u.$$.fragment,r),y=!1},d(r){r&&(n(a),n(i),n(c),n($),n(k),n(g)),j(t),R(f,r),j(u,r)}}}function se(l,a,e){let t;return T(l,J,i=>e(0,t=i)),[t,()=>Y(t)]}class $e extends H{constructor(a){super(),I(this,a,se,ne,A,{})}}export{$e as component};
