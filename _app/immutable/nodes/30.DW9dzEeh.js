import{s as he,v as Y,x as ne,l as Ue,u as Je,m as Ke,o as We,H as de,E as _e,i as E,f as v,a9 as vn,a8 as wn,k as ye,U as Jt,a7 as Kt,N as qe,e as x,c as ee,b as oe,r as Ne,a as H,g as R,q as Be,n as Ve,t as W,d as V,w as Q,h as ce,j as ve,z as kn,p as yt}from"../chunks/scheduler.Bsni_e59.js";import{S as we,i as ke,e as re,c as N,a as z,m as G,t as w,b as $,d as D,g as se,f as ue}from"../chunks/index.CCfAUppz.js";import{e as pe}from"../chunks/each.ChCadThl.js";import{B as jn}from"../chunks/ButtonGroup.hr9f_7ak.js";import{W as Wt,S as be}from"../chunks/WarningButton.D9QeV9gM.js";import{T as lt}from"../chunks/TextInput.CLSFolLv.js";import{s as X}from"../chunks/data.Cv7vuCoC.js";import{L as Vt,a as Xt,e as $n,m as Pe,i as Ln,f as Zt,M as Cn,G as vt,h as wt,g as En}from"../chunks/MapLibreMap.DPm12GCu.js";import{c as Ge}from"../chunks/colors.CYEpEtTL.js";import{a as Mn,c as Pn,M as De,C as In,R as Qt,B as On,G as An,S as Tn}from"../chunks/GeoreferenceLayer.BY6lQldP.js";import{C as Sn}from"../chunks/CollapsibleCard.DoOZ0Bze.js";import{D as Fn}from"../chunks/DefaultButton.DyQsHGbh.js";import{T as Yt}from"../chunks/TextArea.B6Unmhyb.js";import{p as xt}from"../chunks/index.BT0LUzVn.js";import{S as qn}from"../chunks/Select.CYYT6Sg-.js";function Bn(t){let e;const n=t[15].default,r=Ue(n,t,t[23],null);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l&8388608)&&Je(r,n,o,o[23],e?We(n,o[23],l,null):Ke(o[23]),null)},i(o){e||(w(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function Nn(t){let e,n,r;function o(i){t[16](i)}let l={id:t[1],type:"line",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],minzoom:t[9],maxzoom:t[10],hoverCursor:t[11],manageHoverState:t[12],eventsIfTopMost:t[13],interactive:t[14],$$slots:{default:[Bn]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Vt({props:l}),Y.push(()=>re(e,"hovered",o)),e.$on("click",t[17]),e.$on("dblclick",t[18]),e.$on("contextmenu",t[19]),e.$on("mouseenter",t[20]),e.$on("mousemove",t[21]),e.$on("mouseleave",t[22]),{c(){N(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,a){G(e,i,a),r=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&16384&&(s.interactive=i[14]),a&8388608&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],ne(()=>n=!1)),e.$set(s)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){D(e,i)}}}function zn(t,e,n){let{$$slots:r={},$$scope:o}=e,{id:l=Xt("line")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:f}=e,{layout:d=void 0}=e,{filter:u=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:A=void 0}=e,{hoverCursor:g=void 0}=e,{manageHoverState:b=!1}=e,{hovered:F=null}=e,{eventsIfTopMost:T=!1}=e,{interactive:M=!0}=e;function L(O){F=O,n(0,F)}function h(O){de.call(this,t,O)}function c(O){de.call(this,t,O)}function I(O){de.call(this,t,O)}function q(O){de.call(this,t,O)}function B(O){de.call(this,t,O)}function S(O){de.call(this,t,O)}return t.$$set=O=>{"id"in O&&n(1,l=O.id),"source"in O&&n(2,i=O.source),"sourceLayer"in O&&n(3,a=O.sourceLayer),"beforeId"in O&&n(4,s=O.beforeId),"beforeLayerType"in O&&n(5,m=O.beforeLayerType),"paint"in O&&n(6,f=O.paint),"layout"in O&&n(7,d=O.layout),"filter"in O&&n(8,u=O.filter),"minzoom"in O&&n(9,p=O.minzoom),"maxzoom"in O&&n(10,A=O.maxzoom),"hoverCursor"in O&&n(11,g=O.hoverCursor),"manageHoverState"in O&&n(12,b=O.manageHoverState),"hovered"in O&&n(0,F=O.hovered),"eventsIfTopMost"in O&&n(13,T=O.eventsIfTopMost),"interactive"in O&&n(14,M=O.interactive),"$$scope"in O&&n(23,o=O.$$scope)},[F,l,i,a,s,m,f,d,u,p,A,g,b,T,M,r,L,h,c,I,q,B,S,o]}class nt extends we{constructor(e){super(),ke(this,e,zn,Nn,he,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}const Gn=t=>({features:t[0]&16,data:t[0]&16,map:t[0]&4,close:t[0]&1}),kt=t=>{var e;return{features:t[4],data:(e=t[4])==null?void 0:e[0],map:t[2],close:t[31]}};function jt(t){let e,n,r=(t[4]||t[3]instanceof Pe.Marker)&&$t(t);return{c(){e=x("div"),r&&r.c()},l(o){e=ee(o,"DIV",{});var l=oe(e);r&&r.l(l),l.forEach(v)},m(o,l){E(o,e,l),r&&r.m(e,null),t[32](e),n=!0},p(o,l){o[4]||o[3]instanceof Pe.Marker?r?(r.p(o,l),l[0]&24&&w(r,1)):(r=$t(o),r.c(),w(r,1),r.m(e,null)):r&&(se(),$(r,1,1,()=>{r=null}),ue())},i(o){n||(w(r),n=!0)},o(o){$(r),n=!1},d(o){o&&v(e),r&&r.d(),t[32](null)}}}function $t(t){let e;const n=t[30].default,r=Ue(n,t,t[29],kt);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l[0]&536870933)&&Je(r,n,o,o[29],e?We(n,o[29],l,Gn):Ke(o[29]),kt)},i(o){e||(w(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function Dn(t){let e,n,r=t[9].default&&jt(t);return{c(){r&&r.c(),e=_e()},l(o){r&&r.l(o),e=_e()},m(o,l){r&&r.m(o,l),E(o,e,l),n=!0},p(o,l){o[9].default?r?(r.p(o,l),l[0]&512&&w(r,1)):(r=jt(o),r.c(),w(r,1),r.m(e.parentNode,e)):r&&(se(),$(r,1,1,()=>{r=null}),ue())},i(o){n||(w(r),n=!0)},o(o){$(r),n=!1},d(o){o&&v(e),r&&r.d(o)}}}function Hn(t,e,n){let r,o,l,i,a,s,{$$slots:m={},$$scope:f}=e;const d=vn(m);let{closeButton:u=void 0}=e,{closeOnClickOutside:p=!0}=e,{closeOnClickInside:A=!1}=e,{closeOnMove:g=!1}=e,{openOn:b="click"}=e,{openIfTopMost:F=!0}=e,{focusAfterOpen:T=!0}=e,{anchor:M=void 0}=e,{offset:L=void 0}=e,{popupClass:h=void 0}=e,{maxWidth:c=void 0}=e,{lngLat:I=void 0}=e,{html:q=void 0}=e,{open:B=!1}=e;const S=wn(),{map:O,popupTarget:C,layerEvent:_,layer:y,eventTopMost:Z}=$n();ye(t,O,j=>n(2,l=j)),ye(t,C,j=>n(3,a=j)),ye(t,_,j=>n(28,i=j)),ye(t,y,j=>n(35,s=j));const le=["click","dblclick","contextmenu"];let P,ge=!1,k;function U(){if(!P)return;let j=P.getElement();!j||j===k||(k=j,b==="hover"&&(k.style.pointerEvents="none"),k.addEventListener("mouseenter",()=>{n(24,ge=!0)},{passive:!0}),k.addEventListener("mouseleave",()=>{n(24,ge=!1)},{passive:!0}),k.addEventListener("click",()=>{A&&n(0,B=!1)},{passive:!0}))}Jt(()=>{if(l)return l.on("click",ze),l.on("contextmenu",ze),typeof a=="string"&&(l.on("click",a,Ee),l.on("dblclick",a,Ee),l.on("contextmenu",a,Ee),l.on("mousemove",a,bt),l.on("mouseleave",a,ht),l.on("touchstart",a,_t),l.on("touchend",a,pt)),()=>{l!=null&&l.loaded()&&(P==null||P.remove(),l.off("click",ze),l.off("contextmenu",ze),a instanceof Pe.Marker?a.getPopup()===P&&a.setPopup(void 0):typeof a=="string"&&(l.off("click",a,Ee),l.off("dblclick",a,Ee),l.off("contextmenu",a,Ee),l.off("mousemove",a,bt),l.off("mouseleave",a,ht),l.off("touchstart",a,_t),l.off("touchend",a,pt)))}});function ae(j){return F?!("marker"in j)&&!Ln(j)&&Z(j)!==s:!1}let te=null,ie="normal";function Ee(j){j.type===b&&(ae(j)||("layerType"in j?j.layerType==="deckgl"?(n(10,I=j.coordinate),n(4,te=j.object?[j.object]:null)):(n(10,I=j.lngLat),n(4,te=j.features??[])):(n(10,I=j.lngLat),n(4,te=j.features??[])),setTimeout(()=>n(0,B=!0))))}let Me=null;function _t(j){Me=j.point}function pt(j){if(!Me||b!=="hover")return;let xe=Me.dist(j.point);Me=null,xe<3&&(n(10,I=j.lngLat),n(4,te=j.features??[]),P.isOpen()?n(25,ie="justOpened"):(n(25,ie="opening"),n(0,B=!0)))}function ht(j){b!=="hover"||Me||ie!=="normal"||(n(0,B=!1),n(4,te=null))}function bt(j){if(!(b!=="hover"||Me||ie!=="normal")){if(ae(j)){n(0,B=!1),n(4,te=null);return}n(0,B=!0),n(4,te=j.features??[]),n(10,I=j.lngLat)}}function ze(j){if(ie==="justOpened"){n(25,ie="normal");return}if(!p)return;let xe=[k,a instanceof Pe.Marker?a==null?void 0:a.getElement():null];B&&P.isOpen()&&!xe.some(et=>et==null?void 0:et.contains(j.originalEvent.target))&&(j.type==="contextmenu"&&b==="contextmenu"||j.type!=="contextmenu")&&n(0,B=!1)}Kt(()=>{l&&(P!=null&&P.isOpen())&&P.remove()});let Ae;const bn=()=>n(0,B=!1);function yn(j){Y[j?"unshift":"push"](()=>{Ae=j,n(1,Ae)})}return t.$$set=j=>{"closeButton"in j&&n(11,u=j.closeButton),"closeOnClickOutside"in j&&n(12,p=j.closeOnClickOutside),"closeOnClickInside"in j&&n(13,A=j.closeOnClickInside),"closeOnMove"in j&&n(14,g=j.closeOnMove),"openOn"in j&&n(15,b=j.openOn),"openIfTopMost"in j&&n(16,F=j.openIfTopMost),"focusAfterOpen"in j&&n(17,T=j.focusAfterOpen),"anchor"in j&&n(18,M=j.anchor),"offset"in j&&n(19,L=j.offset),"popupClass"in j&&n(20,h=j.popupClass),"maxWidth"in j&&n(21,c=j.maxWidth),"lngLat"in j&&n(10,I=j.lngLat),"html"in j&&n(22,q=j.html),"open"in j&&n(0,B=j.open),"$$scope"in j&&n(29,f=j.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&14336&&n(27,r=u??(!p&&!A)),t.$$.dirty[0]&146685952&&(P||(n(23,P=new Pe.Popup({closeButton:r,closeOnClick:!1,closeOnMove:g,focusAfterOpen:T,maxWidth:c,className:h,anchor:M,offset:L})),k=P.getElement(),P.on("open",()=>{n(0,B=!0),U(),S("open",P)}),P.on("close",()=>{n(0,B=!1),S("close",P)}),P.on("hover",()=>{S("hover",P)}))),t.$$.dirty[0]&8421384&&P&&a instanceof Pe.Marker&&(b==="click"?a.setPopup(P):a.getPopup()===P&&a.setPopup(void 0)),t.$$.dirty[0]&268468224&&le.includes(b)&&(i==null?void 0:i.type)===b&&(Ee(i),qe(_,i=null,i)),t.$$.dirty[0]&268468224&&n(26,o=b==="hover"&&((i==null?void 0:i.type)==="mousemove"||(i==null?void 0:i.type)==="mouseenter")),t.$$.dirty[0]&352354304&&b==="hover"&&_&&(o&&i&&(i.layerType==="deckgl"?(n(10,I=i.coordinate),n(4,te=i.object?[i.object]:null)):(n(10,I=i.lngLat),n(4,te=i.features??[]))),n(0,B=(o||ge)??!1)),t.$$.dirty[0]&12582914&&(Ae?P.setDOMContent(Ae):q&&P.setHTML(q)),t.$$.dirty[0]&8389632&&I&&P.setLngLat(I),t.$$.dirty[0]&41943045&&l){let j=P.isOpen();B&&!j?(P.addTo(l),ie==="opening"&&n(25,ie="justOpened")):!B&&j&&P.remove()}},[B,Ae,l,a,te,O,C,_,y,d,I,u,p,A,g,b,F,T,M,L,h,c,q,P,ge,ie,o,r,i,f,m,bn,yn]}class Rn extends we{constructor(e){super(),ke(this,e,Hn,Dn,he,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function Un(t){let e;const n=t[16].default,r=Ue(n,t,t[24],null);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l&16777216)&&Je(r,n,o,o[24],e?We(n,o[24],l,null):Ke(o[24]),null)},i(o){e||(w(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function Jn(t){let e,n,r;function o(i){t[17](i)}let l={id:t[1],type:"symbol",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[Un]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Vt({props:l}),Y.push(()=>re(e,"hovered",o)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){N(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,a){G(e,i,a),r=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],ne(()=>n=!1)),e.$set(s)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){D(e,i)}}}function Kn(t,e,n){let{$$slots:r={},$$scope:o}=e,{id:l=Xt("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:f=void 0}=e,{layout:d=void 0}=e,{filter:u=void 0}=e,{applyToClusters:p=void 0}=e,{minzoom:A=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:b=void 0}=e,{manageHoverState:F=!1}=e,{hovered:T=null}=e,{eventsIfTopMost:M=!1}=e,{interactive:L=!0}=e;function h(C){T=C,n(0,T)}function c(C){de.call(this,t,C)}function I(C){de.call(this,t,C)}function q(C){de.call(this,t,C)}function B(C){de.call(this,t,C)}function S(C){de.call(this,t,C)}function O(C){de.call(this,t,C)}return t.$$set=C=>{"id"in C&&n(1,l=C.id),"source"in C&&n(2,i=C.source),"sourceLayer"in C&&n(3,a=C.sourceLayer),"beforeId"in C&&n(4,s=C.beforeId),"beforeLayerType"in C&&n(5,m=C.beforeLayerType),"paint"in C&&n(6,f=C.paint),"layout"in C&&n(7,d=C.layout),"filter"in C&&n(8,u=C.filter),"applyToClusters"in C&&n(9,p=C.applyToClusters),"minzoom"in C&&n(10,A=C.minzoom),"maxzoom"in C&&n(11,g=C.maxzoom),"hoverCursor"in C&&n(12,b=C.hoverCursor),"manageHoverState"in C&&n(13,F=C.manageHoverState),"hovered"in C&&n(0,T=C.hovered),"eventsIfTopMost"in C&&n(14,M=C.eventsIfTopMost),"interactive"in C&&n(15,L=C.interactive),"$$scope"in C&&n(24,o=C.$$scope)},[T,l,i,a,s,m,f,d,u,p,A,g,b,F,M,L,r,h,c,I,q,B,S,O,o]}class Wn extends we{constructor(e){super(),ke(this,e,Kn,Jn,he,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const Vn=t=>({props:t&8}),Lt=t=>({props:Qn(t[3])});function Xn(t){let e,n;const r=t[1].default,o=Ue(r,t,t[2],Lt);return{c(){e=x("div"),o&&o.c(),this.h()},l(l){e=ee(l,"DIV",{class:!0});var i=oe(e);o&&o.l(i),i.forEach(v),this.h()},h(){Ne(e,"class","govuk-prose")},m(l,i){E(l,e,i),o&&o.m(e,null),n=!0},p(l,i){o&&o.p&&(!n||i&12)&&Je(o,r,l,l[2],n?We(r,l[2],i,Vn):Ke(l[2]),Lt)},i(l){n||(w(o,l),n=!0)},o(l){$(o,l),n=!1},d(l){l&&v(e),o&&o.d(l)}}}function Zn(t){let e,n;return e=new Rn({props:{openOn:t[0],$$slots:{default:[Xn,({features:r})=>({3:r}),({features:r})=>r?8:0]},$$scope:{ctx:t}}}),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,[o]){const l={};o&1&&(l.openOn=r[0]),o&12&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function Qn(t){return t?t[0].properties??{}:{}}function Yn(t,e,n){let{$$slots:r={},$$scope:o}=e,{openOn:l="hover"}=e;return t.$$set=i=>{"openOn"in i&&n(0,l=i.openOn),"$$scope"in i&&n(2,o=i.$$scope)},[l,r,o]}class en extends we{constructor(e){super(),ke(this,e,Yn,Zn,he,{openOn:0})}}var xn=Object.defineProperty,J=(t,e)=>xn(t,"name",{value:e,configurable:!0}),er=class{constructor(e){this.direction=!1,this.compareProperties=!0;var n,r,o;this.precision=10**-((n=e==null?void 0:e.precision)!=null?n:17),this.direction=(r=e==null?void 0:e.direction)!=null?r:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,n){if(e.type!==n.type||!Te(e,n))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,n.coordinates);case"LineString":return this.compareLine(e.coordinates,n.coordinates);case"Polygon":return this.comparePolygon(e,n);case"GeometryCollection":return this.compareGeometryCollection(e,n);case"Feature":return this.compareFeature(e,n);case"FeatureCollection":return this.compareFeatureCollection(e,n);default:if(e.type.startsWith("Multi")){const r=rt(e),o=rt(n);return r.every(l=>o.some(i=>this.compare(l,i)))}}return!1}compareCoord(e,n){return e.length===n.length&&e.every((r,o)=>Math.abs(r-n[o])<this.precision)}compareLine(e,n,r=0,o=!1){if(!Te(e,n))return!1;const l=e;let i=n;if(o&&!this.compareCoord(l[0],i[0])){const s=this.fixStartIndex(i,l);if(s)i=s;else return!1}const a=this.compareCoord(l[r],i[r]);return this.direction||a?this.comparePath(l,i):this.compareCoord(l[r],i[i.length-(1+r)])?this.comparePath(l.slice().reverse(),i):!1}fixStartIndex(e,n){let r,o=-1;for(let l=0;l<e.length;l++)if(this.compareCoord(e[l],n[0])){o=l;break}return o>=0&&(r=[].concat(e.slice(o,e.length),e.slice(1,o+1))),r}comparePath(e,n){return e.every((r,o)=>this.compareCoord(r,n[o]))}comparePolygon(e,n){if(this.compareLine(e.coordinates[0],n.coordinates[0],1,!0)){const r=e.coordinates.slice(1,e.coordinates.length),o=n.coordinates.slice(1,n.coordinates.length);return r.every(l=>o.some(i=>this.compareLine(l,i,1,!0)))}return!1}compareGeometryCollection(e,n){return Te(e.geometries,n.geometries)&&this.compareBBox(e,n)&&e.geometries.every((r,o)=>this.compare(r,n.geometries[o]))}compareFeature(e,n){return e.id===n.id&&(this.compareProperties?Zt(e.properties,n.properties):!0)&&this.compareBBox(e,n)&&this.compare(e.geometry,n.geometry)}compareFeatureCollection(e,n){return Te(e.features,n.features)&&this.compareBBox(e,n)&&e.features.every((r,o)=>this.compare(r,n.features[o]))}compareBBox(e,n){return!e.bbox&&!n.bbox||(e.bbox&&n.bbox?this.compareCoord(e.bbox,n.bbox):!1)}};J(er,"GeojsonEquality");function Te(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}J(Te,"sameLength");function rt(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}J(rt,"explode");var fe=63710088e-1,tn={centimeters:fe*100,centimetres:fe*100,degrees:360/(2*Math.PI),feet:fe*3.28084,inches:fe*39.37,kilometers:fe/1e3,kilometres:fe/1e3,meters:fe,metres:fe,miles:fe/1609.344,millimeters:fe*1e3,millimetres:fe*1e3,nauticalmiles:fe/1852,radians:1,yards:fe*1.0936},Ct={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function je(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}J(je,"feature");function tr(t,e,n={}){switch(t){case"Point":return Xe(e).geometry;case"LineString":return st(e).geometry;case"Polygon":return at(e).geometry;case"MultiPoint":return rn(e).geometry;case"MultiLineString":return nn(e).geometry;case"MultiPolygon":return on(e).geometry;default:throw new Error(t+" is invalid")}}J(tr,"geometry");function Xe(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ie(t[0])||!Ie(t[1]))throw new Error("coordinates must contain numbers");return je({type:"Point",coordinates:t},e,n)}J(Xe,"point");function nr(t,e,n={}){return Ze(t.map(r=>Xe(r,e)),n)}J(nr,"points");function at(t,e,n={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}return je({type:"Polygon",coordinates:t},e,n)}J(at,"polygon");function rr(t,e,n={}){return Ze(t.map(r=>at(r,e)),n)}J(rr,"polygons");function st(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return je({type:"LineString",coordinates:t},e,n)}J(st,"lineString");function or(t,e,n={}){return Ze(t.map(r=>st(r,e)),n)}J(or,"lineStrings");function Ze(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}J(Ze,"featureCollection");function nn(t,e,n={}){return je({type:"MultiLineString",coordinates:t},e,n)}J(nn,"multiLineString");function rn(t,e,n={}){return je({type:"MultiPoint",coordinates:t},e,n)}J(rn,"multiPoint");function on(t,e,n={}){return je({type:"MultiPolygon",coordinates:t},e,n)}J(on,"multiPolygon");function ir(t,e,n={}){return je({type:"GeometryCollection",geometries:t},e,n)}J(ir,"geometryCollection");function lr(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n}J(lr,"round");function ln(t,e="kilometers"){const n=tn[e];if(!n)throw new Error(e+" units is invalid");return t*n}J(ln,"radiansToLength");function Qe(t,e="kilometers"){const n=tn[e];if(!n)throw new Error(e+" units is invalid");return t/n}J(Qe,"lengthToRadians");function ar(t,e){return Re(Qe(t,e))}J(ar,"lengthToDegrees");function sr(t){let e=t%360;return e<0&&(e+=360),e}J(sr,"bearingToAzimuth");function Re(t){return t%(2*Math.PI)*180/Math.PI}J(Re,"radiansToDegrees");function He(t){return t%360*Math.PI/180}J(He,"degreesToRadians");function ur(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return ln(Qe(t,e),n)}J(ur,"convertLength");function fr(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const r=Ct[e];if(!r)throw new Error("invalid original units");const o=Ct[n];if(!o)throw new Error("invalid final units");return t/r*o}J(fr,"convertArea");function Ie(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}J(Ie,"isNumber");function mr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}J(mr,"isObject");function cr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!Ie(e))throw new Error("bbox must only contain numbers")})}J(cr,"validateBBox");function gr(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}J(gr,"validateId");var dr=Object.defineProperty,$e=(t,e)=>dr(t,"name",{value:e,configurable:!0});function an(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}$e(an,"getCoord");function _r(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}$e(_r,"getCoords");function sn(t){if(t.length>1&&Ie(t[0])&&Ie(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return sn(t[0]);throw new Error("coordinates must only contain numbers")}$e(sn,"containsNumber");function pr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}$e(pr,"geojsonType");function hr(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}$e(hr,"featureOf");function br(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const r of t.features){if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}$e(br,"collectionOf");function yr(t){return t.type==="Feature"?t.geometry:t}$e(yr,"getGeom");function vr(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}$e(vr,"getType");var wr=Object.defineProperty,kr=(t,e)=>wr(t,"name",{value:e,configurable:!0});function un(t,e,n,r={}){const o=an(t),l=He(o[0]),i=He(o[1]),a=He(n),s=Qe(e,r.units),m=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),f=l+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(m)),d=Re(f),u=Re(m);return Xe([d,u],r.properties)}kr(un,"destination");var Et=un,jr=Object.defineProperty,K=(t,e)=>jr(t,"name",{value:e,configurable:!0}),$r=class{constructor(e){this.direction=!1,this.compareProperties=!0;var n,r,o;this.precision=10**-((n=e==null?void 0:e.precision)!=null?n:17),this.direction=(r=e==null?void 0:e.direction)!=null?r:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,n){if(e.type!==n.type||!Se(e,n))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,n.coordinates);case"LineString":return this.compareLine(e.coordinates,n.coordinates);case"Polygon":return this.comparePolygon(e,n);case"GeometryCollection":return this.compareGeometryCollection(e,n);case"Feature":return this.compareFeature(e,n);case"FeatureCollection":return this.compareFeatureCollection(e,n);default:if(e.type.startsWith("Multi")){const r=ot(e),o=ot(n);return r.every(l=>o.some(i=>this.compare(l,i)))}}return!1}compareCoord(e,n){return e.length===n.length&&e.every((r,o)=>Math.abs(r-n[o])<this.precision)}compareLine(e,n,r=0,o=!1){if(!Se(e,n))return!1;const l=e;let i=n;if(o&&!this.compareCoord(l[0],i[0])){const s=this.fixStartIndex(i,l);if(s)i=s;else return!1}const a=this.compareCoord(l[r],i[r]);return this.direction||a?this.comparePath(l,i):this.compareCoord(l[r],i[i.length-(1+r)])?this.comparePath(l.slice().reverse(),i):!1}fixStartIndex(e,n){let r,o=-1;for(let l=0;l<e.length;l++)if(this.compareCoord(e[l],n[0])){o=l;break}return o>=0&&(r=[].concat(e.slice(o,e.length),e.slice(1,o+1))),r}comparePath(e,n){return e.every((r,o)=>this.compareCoord(r,n[o]))}comparePolygon(e,n){if(this.compareLine(e.coordinates[0],n.coordinates[0],1,!0)){const r=e.coordinates.slice(1,e.coordinates.length),o=n.coordinates.slice(1,n.coordinates.length);return r.every(l=>o.some(i=>this.compareLine(l,i,1,!0)))}return!1}compareGeometryCollection(e,n){return Se(e.geometries,n.geometries)&&this.compareBBox(e,n)&&e.geometries.every((r,o)=>this.compare(r,n.geometries[o]))}compareFeature(e,n){return e.id===n.id&&(this.compareProperties?Zt(e.properties,n.properties):!0)&&this.compareBBox(e,n)&&this.compare(e.geometry,n.geometry)}compareFeatureCollection(e,n){return Se(e.features,n.features)&&this.compareBBox(e,n)&&e.features.every((r,o)=>this.compare(r,n.features[o]))}compareBBox(e,n){return!e.bbox&&!n.bbox||(e.bbox&&n.bbox?this.compareCoord(e.bbox,n.bbox):!1)}};K($r,"GeojsonEquality");function Se(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}K(Se,"sameLength");function ot(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}K(ot,"explode");var me=63710088e-1,fn={centimeters:me*100,centimetres:me*100,degrees:360/(2*Math.PI),feet:me*3.28084,inches:me*39.37,kilometers:me/1e3,kilometres:me/1e3,meters:me,metres:me,miles:me/1609.344,millimeters:me*1e3,millimetres:me*1e3,nauticalmiles:me/1852,radians:1,yards:me*1.0936},Mt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Le(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}K(Le,"feature");function Lr(t,e,n={}){switch(t){case"Point":return ut(e).geometry;case"LineString":return mt(e).geometry;case"Polygon":return ft(e).geometry;case"MultiPoint":return cn(e).geometry;case"MultiLineString":return mn(e).geometry;case"MultiPolygon":return gn(e).geometry;default:throw new Error(t+" is invalid")}}K(Lr,"geometry");function ut(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Oe(t[0])||!Oe(t[1]))throw new Error("coordinates must contain numbers");return Le({type:"Point",coordinates:t},e,n)}K(ut,"point");function Cr(t,e,n={}){return Ye(t.map(r=>ut(r,e)),n)}K(Cr,"points");function ft(t,e,n={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}return Le({type:"Polygon",coordinates:t},e,n)}K(ft,"polygon");function Er(t,e,n={}){return Ye(t.map(r=>ft(r,e)),n)}K(Er,"polygons");function mt(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Le({type:"LineString",coordinates:t},e,n)}K(mt,"lineString");function Mr(t,e,n={}){return Ye(t.map(r=>mt(r,e)),n)}K(Mr,"lineStrings");function Ye(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}K(Ye,"featureCollection");function mn(t,e,n={}){return Le({type:"MultiLineString",coordinates:t},e,n)}K(mn,"multiLineString");function cn(t,e,n={}){return Le({type:"MultiPoint",coordinates:t},e,n)}K(cn,"multiPoint");function gn(t,e,n={}){return Le({type:"MultiPolygon",coordinates:t},e,n)}K(gn,"multiPolygon");function Pr(t,e,n={}){return Le({type:"GeometryCollection",geometries:t},e,n)}K(Pr,"geometryCollection");function Ir(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n}K(Ir,"round");function dn(t,e="kilometers"){const n=fn[e];if(!n)throw new Error(e+" units is invalid");return t*n}K(dn,"radiansToLength");function ct(t,e="kilometers"){const n=fn[e];if(!n)throw new Error(e+" units is invalid");return t/n}K(ct,"lengthToRadians");function Or(t,e){return gt(ct(t,e))}K(Or,"lengthToDegrees");function Ar(t){let e=t%360;return e<0&&(e+=360),e}K(Ar,"bearingToAzimuth");function gt(t){return t%(2*Math.PI)*180/Math.PI}K(gt,"radiansToDegrees");function Fe(t){return t%360*Math.PI/180}K(Fe,"degreesToRadians");function Tr(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return dn(ct(t,e),n)}K(Tr,"convertLength");function Sr(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const r=Mt[e];if(!r)throw new Error("invalid original units");const o=Mt[n];if(!o)throw new Error("invalid final units");return t/r*o}K(Sr,"convertArea");function Oe(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}K(Oe,"isNumber");function Fr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}K(Fr,"isObject");function qr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!Oe(e))throw new Error("bbox must only contain numbers")})}K(qr,"validateBBox");function Br(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}K(Br,"validateId");var Nr=Object.defineProperty,Ce=(t,e)=>Nr(t,"name",{value:e,configurable:!0});function it(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}Ce(it,"getCoord");function zr(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}Ce(zr,"getCoords");function _n(t){if(t.length>1&&Oe(t[0])&&Oe(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return _n(t[0]);throw new Error("coordinates must only contain numbers")}Ce(_n,"containsNumber");function Gr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}Ce(Gr,"geojsonType");function Dr(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}Ce(Dr,"featureOf");function Hr(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const r of t.features){if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}Ce(Hr,"collectionOf");function Rr(t){return t.type==="Feature"?t.geometry:t}Ce(Rr,"getGeom");function Ur(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}Ce(Ur,"getType");var Jr=Object.defineProperty,pn=(t,e)=>Jr(t,"name",{value:e,configurable:!0});function dt(t,e,n={}){if(n.final===!0)return hn(t,e);const r=it(t),o=it(e),l=Fe(r[0]),i=Fe(o[0]),a=Fe(r[1]),s=Fe(o[1]),m=Math.sin(i-l)*Math.cos(s),f=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-l);return gt(Math.atan2(m,f))}pn(dt,"bearing");function hn(t,e){let n=dt(e,t);return n=(n+180)%360,n}pn(hn,"calculateFinalBearing");var Kr=dt;function Pt(t,e,n){const r=t.slice();return r[33]=e[n],r[34]=e,r[35]=n,r}function It(t,e,n){const r=t.slice();return r[36]=e[n],r[37]=e,r[35]=n,r}function Wr(t){let e,n=io(t[35])+"",r;return{c(){e=x("span"),r=W(n),this.h()},l(o){e=ee(o,"SPAN",{class:!0});var l=oe(e);r=V(l,n),l.forEach(v),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"color","#4472c4"),Q(e,"background-color","white")},m(o,l){E(o,e,l),ce(e,r)},p:Ve,d(o){o&&v(e)}}}function Ot(t){let e,n,r;function o(s){t[15](s,t[36])}function l(){return t[16](t[35])}function i(){return t[17](t[35])}let a={draggable:!0,$$slots:{default:[Wr]},$$scope:{ctx:t}};return t[36].point!==void 0&&(a.lngLat=t[36].point),e=new De({props:a}),Y.push(()=>re(e,"lngLat",o)),e.$on("dragend",l),e.$on("click",i),{c(){N(e.$$.fragment)},l(s){z(e.$$.fragment,s)},m(s,m){G(e,s,m),r=!0},p(s,m){t=s;const f={};m[1]&128&&(f.$$scope={dirty:m,ctx:t}),!n&&m[0]&7&&(n=!0,f.lngLat=t[36].point,ne(()=>n=!1)),e.$set(f)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),r=!1},d(s){D(e,s)}}}function Vr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(v),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score]),Q(e,"opacity",t[33].kind=="walking & wheeling"?"0%":"100%")},m(n,r){E(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score]),r[0]&7&&Q(e,"opacity",n[33].kind=="walking & wheeling"?"0%":"100%")},d(n){n&&v(e)}}}function Xr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(v),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score])},m(n,r){E(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score])},d(n){n&&v(e)}}}function Zr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(v),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score]),Q(e,"opacity","0%")},m(n,r){E(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score])},d(n){n&&v(e)}}}function At(t){let e,n,r,o,l,i,a,s,m;function f(c){t[18](c,t[33])}function d(){return t[19](t[35])}function u(){return t[20](t[35])}let p={draggable:!0,$$slots:{default:[Vr]},$$scope:{ctx:t}};t[33].point1!==void 0&&(p.lngLat=t[33].point1),e=new De({props:p}),Y.push(()=>re(e,"lngLat",f)),e.$on("dragend",d),e.$on("click",u);function A(c){t[21](c,t[33])}function g(){return t[22](t[35])}function b(){return t[23](t[35])}let F={draggable:!0,$$slots:{default:[Xr]},$$scope:{ctx:t}};t[33].point2!==void 0&&(F.lngLat=t[33].point2),o=new De({props:F}),Y.push(()=>re(o,"lngLat",A)),o.$on("dragend",g),o.$on("click",b);function T(c){t[24](c,t[33])}function M(){return t[25](t[35])}function L(){return t[26](t[35])}let h={draggable:!0,$$slots:{default:[Zr]},$$scope:{ctx:t}};return t[33].point3!==void 0&&(h.lngLat=t[33].point3),a=new De({props:h}),Y.push(()=>re(a,"lngLat",T)),a.$on("dragend",M),a.$on("click",L),{c(){N(e.$$.fragment),r=H(),N(o.$$.fragment),i=H(),N(a.$$.fragment)},l(c){z(e.$$.fragment,c),r=R(c),z(o.$$.fragment,c),i=R(c),z(a.$$.fragment,c)},m(c,I){G(e,c,I),E(c,r,I),G(o,c,I),E(c,i,I),G(a,c,I),m=!0},p(c,I){t=c;const q={};I[0]&7|I[1]&128&&(q.$$scope={dirty:I,ctx:t}),!n&&I[0]&7&&(n=!0,q.lngLat=t[33].point1,ne(()=>n=!1)),e.$set(q);const B={};I[0]&7|I[1]&128&&(B.$$scope={dirty:I,ctx:t}),!l&&I[0]&7&&(l=!0,B.lngLat=t[33].point2,ne(()=>l=!1)),o.$set(B);const S={};I[0]&7|I[1]&128&&(S.$$scope={dirty:I,ctx:t}),!s&&I[0]&7&&(s=!0,S.lngLat=t[33].point3,ne(()=>s=!1)),a.$set(S)},i(c){m||(w(e.$$.fragment,c),w(o.$$.fragment,c),w(a.$$.fragment,c),m=!0)},o(c){$(e.$$.fragment,c),$(o.$$.fragment,c),$(a.$$.fragment,c),m=!1},d(c){c&&(v(r),v(i)),D(e,c),D(o,c),D(a,c)}}}function Qr(t){let e=(t[32].name||"Untitled movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){E(r,n,o)},p(r,o){o[1]&2&&e!==(e=(r[32].name||"Untitled movement")+"")&&ve(n,e)},d(r){r&&v(n)}}}function Yr(t){let e,n;return e=new en({props:{$$slots:{default:[Qr,({props:r})=>({32:r}),({props:r})=>[0,r?2:0]]},$$scope:{ctx:t}}}),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o[1]&130&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function xr(t){let e=(t[32].name||"Untitled movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){E(r,n,o)},p(r,o){o[1]&2&&e!==(e=(r[32].name||"Untitled movement")+"")&&ve(n,e)},d(r){r&&v(n)}}}function eo(t){let e,n;return e=new en({props:{$$slots:{default:[xr,({props:r})=>({32:r}),({props:r})=>[0,r?2:0]]},$$scope:{ctx:t}}}),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o[1]&130&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function to(t){let e,n,r,o,l,i;return e=new nt({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":wt(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[Yr]},$$scope:{ctx:t}}}),e.$on("click",t[7]),r=new nt({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":wt(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[eo]},$$scope:{ctx:t}}}),r.$on("click",t[7]),l=new Wn({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"â¬†","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){N(e.$$.fragment),n=H(),N(r.$$.fragment),o=H(),N(l.$$.fragment)},l(a){z(e.$$.fragment,a),n=R(a),z(r.$$.fragment,a),o=R(a),z(l.$$.fragment,a)},m(a,s){G(e,a,s),E(a,n,s),G(r,a,s),E(a,o,s),G(l,a,s),i=!0},p(a,s){const m={};s[1]&128&&(m.$$scope={dirty:s,ctx:a}),e.$set(m);const f={};s[1]&128&&(f.$$scope={dirty:s,ctx:a}),r.$set(f)},i(a){i||(w(e.$$.fragment,a),w(r.$$.fragment,a),w(l.$$.fragment,a),i=!0)},o(a){$(e.$$.fragment,a),$(r.$$.fragment,a),$(l.$$.fragment,a),i=!1},d(a){a&&(v(n),v(o)),D(e,a),D(r,a),D(l,a)}}}function no(t){let e,n,r,o;return e=new nt({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),r=new In({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){N(e.$$.fragment),n=H(),N(r.$$.fragment)},l(l){z(e.$$.fragment,l),n=R(l),z(r.$$.fragment,l)},m(l,i){G(e,l,i),E(l,n,i),G(r,l,i),o=!0},p:Ve,i(l){o||(w(e.$$.fragment,l),w(r.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),o=!1},d(l){l&&v(n),D(e,l),D(r,l)}}}function ro(t){let e,n,r,o,l,i,a,s,m=pe(t[2].jat[t[0]][t[1]].arms),f=[];for(let g=0;g<m.length;g+=1)f[g]=Ot(It(t,m,g));const d=g=>$(f[g],1,1,()=>{f[g]=null});let u=pe(t[2].jat[t[0]][t[1]].movements),p=[];for(let g=0;g<u.length;g+=1)p[g]=At(Pt(t,u,g));const A=g=>$(p[g],1,1,()=>{p[g]=null});return r=new vt({props:{data:t[8](t[2]),$$slots:{default:[to]},$$scope:{ctx:t}}}),l=new vt({props:{data:t[4],$$slots:{default:[no]},$$scope:{ctx:t}}}),a=new Pn({props:{map:t[3]}}),{c(){for(let g=0;g<f.length;g+=1)f[g].c();e=H();for(let g=0;g<p.length;g+=1)p[g].c();n=H(),N(r.$$.fragment),o=H(),N(l.$$.fragment),i=H(),N(a.$$.fragment)},l(g){for(let b=0;b<f.length;b+=1)f[b].l(g);e=R(g);for(let b=0;b<p.length;b+=1)p[b].l(g);n=R(g),z(r.$$.fragment,g),o=R(g),z(l.$$.fragment,g),i=R(g),z(a.$$.fragment,g)},m(g,b){for(let F=0;F<f.length;F+=1)f[F]&&f[F].m(g,b);E(g,e,b);for(let F=0;F<p.length;F+=1)p[F]&&p[F].m(g,b);E(g,n,b),G(r,g,b),E(g,o,b),G(l,g,b),E(g,i,b),G(a,g,b),s=!0},p(g,b){if(b[0]&71){m=pe(g[2].jat[g[0]][g[1]].arms);let L;for(L=0;L<m.length;L+=1){const h=It(g,m,L);f[L]?(f[L].p(h,b),w(f[L],1)):(f[L]=Ot(h),f[L].c(),w(f[L],1),f[L].m(e.parentNode,e))}for(se(),L=m.length;L<f.length;L+=1)d(L);ue()}if(b[0]&103){u=pe(g[2].jat[g[0]][g[1]].movements);let L;for(L=0;L<u.length;L+=1){const h=Pt(g,u,L);p[L]?(p[L].p(h,b),w(p[L],1)):(p[L]=At(h),p[L].c(),w(p[L],1),p[L].m(n.parentNode,n))}for(se(),L=u.length;L<p.length;L+=1)A(L);ue()}const F={};b[0]&4&&(F.data=g[8](g[2])),b[1]&128&&(F.$$scope={dirty:b,ctx:g}),r.$set(F);const T={};b[0]&16&&(T.data=g[4]),b[1]&128&&(T.$$scope={dirty:b,ctx:g}),l.$set(T);const M={};b[0]&8&&(M.map=g[3]),a.$set(M)},i(g){if(!s){for(let b=0;b<m.length;b+=1)w(f[b]);for(let b=0;b<u.length;b+=1)w(p[b]);w(r.$$.fragment,g),w(l.$$.fragment,g),w(a.$$.fragment,g),s=!0}},o(g){f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)$(f[b]);p=p.filter(Boolean);for(let b=0;b<p.length;b+=1)$(p[b]);$(r.$$.fragment,g),$(l.$$.fragment,g),$(a.$$.fragment,g),s=!1},d(g){g&&(v(e),v(n),v(o),v(i)),Be(f,g),Be(p,g),D(r,g),D(l,g),D(a,g)}}}function oo(t){let e,n,r;function o(i){t[27](i)}let l={$$slots:{default:[ro]},$$scope:{ctx:t}};return t[3]!==void 0&&(l.map=t[3]),e=new Cn({props:l}),Y.push(()=>re(e,"map",o)),{c(){N(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,a){G(e,i,a),r=!0},p(i,a){const s={};a[0]&31|a[1]&128&&(s.$$scope={dirty:a,ctx:i}),!n&&a[0]&8&&(n=!0,s.map=i[3],ne(()=>n=!1)),e.$set(s)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){D(e,i)}}}function Tt(t,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:t.point}}}function io(t){return String.fromCharCode(t+65)}function lo(t,e,n){let r,o;ye(t,X,k=>n(2,o=k));let{junctionIdx:l}=e,{stage:i}=e,{newKind:a}=e,{editing:s}=e,{hoveringSidebar:m}=e,{streetviewOn:f}=e,d,u={0:Ge.red.background,1:Ge.amber.background,2:Ge.green.background,X:Ge.critical.background};function p(k,U,ae){let te={type:"FeatureCollection",features:[]},ie=U??ae;return ie!=null&&(ie.kind=="arm"?te.features.push(Tt(k.jat[l][i].arms[ie.idx],ie.idx)):te.features.push(T(k.jat[l][i].movements[ie.idx],ie.idx))),te}function A(k){n(9,s=k),n(10,m=null)}function g(k){if(!f){for(let U of d.queryRenderedFeatures(k.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s!=null){n(9,s=null);return}a=="arm"?(qe(X,o.jat[l][i].arms=[...o.jat[l][i].arms,{point:k.lngLat.toArray(),name:""}],o),n(9,s={kind:"arm",idx:o.jat[l][i].arms.length-1})):(qe(X,o.jat[l][i].movements=[...o.jat[l][i].movements,{point1:k.lngLat.toArray(),point2:Et(k.lngLat.toArray(),.005,0).geometry.coordinates,point3:Et(k.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),n(9,s={kind:"movement",idx:o.jat[l][i].movements.length-1})),n(10,m=null)}}function b(k){A({kind:"movement",idx:k.detail.features[0].id})}Jt(()=>{d.on("click",g),L(!1)}),Kt(()=>{d.off("click",g)});function F(k){let U={type:"FeatureCollection",features:k.jat[l][i].movements.map((ae,te)=>T(ae,te))};for(let ae of k.jat[l][i].movements)if(U.features.push(M(ae,U.features.length)),ae.kind=="walking & wheeling"){let te={...ae,point1:ae.point3,point3:ae.point1};U.features.push(M(te,U.features.length))}for(let ae of k.jat[l][i].arms)U.features.push(Tt(ae,U.features.length));return U}function T(k,U){return{type:"Feature",id:U,properties:{name:k.name,kind:k.kind,color:u[k.score]},geometry:{type:"LineString",coordinates:[k.point1,k.point2,k.point3]}}}function M(k,U){return{type:"Feature",id:U,properties:{kind:k.kind,color:u[k.score],angle:Kr(k.point2,k.point3)},geometry:{type:"Point",coordinates:k.point3}}}function L(k){let U=F(o);U.features.length>0&&d.fitBounds(Mn(U),{padding:20,animate:k})}function h(){return d}function c(k,U){t.$$.not_equal(U.point,k)&&(U.point=k,X.set(o))}const I=k=>A({kind:"arm",idx:k}),q=k=>A({kind:"arm",idx:k});function B(k,U){t.$$.not_equal(U.point1,k)&&(U.point1=k,X.set(o))}const S=k=>A({kind:"movement",idx:k}),O=k=>A({kind:"movement",idx:k});function C(k,U){t.$$.not_equal(U.point2,k)&&(U.point2=k,X.set(o))}const _=k=>A({kind:"movement",idx:k}),y=k=>A({kind:"movement",idx:k});function Z(k,U){t.$$.not_equal(U.point3,k)&&(U.point3=k,X.set(o))}const le=k=>A({kind:"movement",idx:k}),P=k=>A({kind:"movement",idx:k});function ge(k){d=k,n(3,d)}return t.$$set=k=>{"junctionIdx"in k&&n(0,l=k.junctionIdx),"stage"in k&&n(1,i=k.stage),"newKind"in k&&n(11,a=k.newKind),"editing"in k&&n(9,s=k.editing),"hoveringSidebar"in k&&n(10,m=k.hoveringSidebar),"streetviewOn"in k&&n(12,f=k.streetviewOn)},t.$$.update=()=>{t.$$.dirty[0]&1540&&n(4,r=p(o,s,m))},[l,i,o,d,r,u,A,b,F,s,m,a,f,L,h,c,I,q,B,S,O,C,_,y,Z,le,P,ge]}class ao extends we{constructor(e){super(),ke(this,e,lo,oo,he,{junctionIdx:0,stage:1,newKind:11,editing:9,hoveringSidebar:10,streetviewOn:12,zoom:13,getMap:14},null,[-1,-1])}get zoom(){return this.$$.ctx[13]}get getMap(){return this.$$.ctx[14]}}function so(t){let e,n,r,o,l,i,a,s,m,f,d,u;function p(h){t[5](h)}let A={label:"Name"};t[3].jat[t[0]][t[1]].movements[t[2]].name!==void 0&&(A.value=t[3].jat[t[0]][t[1]].movements[t[2]].name),e=new lt({props:A}),Y.push(()=>re(e,"value",p));function g(h){t[6](h)}let b={legend:"Movement",choices:xt(["cycling","walking & wheeling"]),inlineSmall:!0};t[3].jat[t[0]][t[1]].movements[t[2]].kind!==void 0&&(b.value=t[3].jat[t[0]][t[1]].movements[t[2]].kind),o=new Qt({props:b}),Y.push(()=>re(o,"value",g));function F(h){t[7](h)}let T={label:"Score",choices:t[4]};t[3].jat[t[0]][t[1]].movements[t[2]].score!==void 0&&(T.value=t[3].jat[t[0]][t[1]].movements[t[2]].score),a=new qn({props:T}),Y.push(()=>re(a,"value",F));function M(h){t[8](h)}let L={label:"Comments"};return t[3].jat[t[0]][t[1]].movements[t[2]].notes!==void 0&&(L.value=t[3].jat[t[0]][t[1]].movements[t[2]].notes),f=new Yt({props:L}),Y.push(()=>re(f,"value",M)),{c(){N(e.$$.fragment),r=H(),N(o.$$.fragment),i=H(),N(a.$$.fragment),m=H(),N(f.$$.fragment)},l(h){z(e.$$.fragment,h),r=R(h),z(o.$$.fragment,h),i=R(h),z(a.$$.fragment,h),m=R(h),z(f.$$.fragment,h)},m(h,c){G(e,h,c),E(h,r,c),G(o,h,c),E(h,i,c),G(a,h,c),E(h,m,c),G(f,h,c),u=!0},p(h,[c]){const I={};!n&&c&15&&(n=!0,I.value=h[3].jat[h[0]][h[1]].movements[h[2]].name,ne(()=>n=!1)),e.$set(I);const q={};!l&&c&15&&(l=!0,q.value=h[3].jat[h[0]][h[1]].movements[h[2]].kind,ne(()=>l=!1)),o.$set(q);const B={};!s&&c&15&&(s=!0,B.value=h[3].jat[h[0]][h[1]].movements[h[2]].score,ne(()=>s=!1)),a.$set(B);const S={};!d&&c&15&&(d=!0,S.value=h[3].jat[h[0]][h[1]].movements[h[2]].notes,ne(()=>d=!1)),f.$set(S)},i(h){u||(w(e.$$.fragment,h),w(o.$$.fragment,h),w(a.$$.fragment,h),w(f.$$.fragment,h),u=!0)},o(h){$(e.$$.fragment,h),$(o.$$.fragment,h),$(a.$$.fragment,h),$(f.$$.fragment,h),u=!1},d(h){h&&(v(r),v(i),v(m)),D(e,h),D(o,h),D(a,h),D(f,h)}}}function uo(t,e,n){let r;ye(t,X,u=>n(3,r=u));let{junctionIdx:o}=e,{stage:l}=e,{idx:i}=e;xt(["cycling","walking & wheeling"]);let a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(u){t.$$.not_equal(r.jat[o][l].movements[i].name,u)&&(r.jat[o][l].movements[i].name=u,X.set(r))}function m(u){t.$$.not_equal(r.jat[o][l].movements[i].kind,u)&&(r.jat[o][l].movements[i].kind=u,X.set(r))}function f(u){t.$$.not_equal(r.jat[o][l].movements[i].score,u)&&(r.jat[o][l].movements[i].score=u,X.set(r))}function d(u){t.$$.not_equal(r.jat[o][l].movements[i].notes,u)&&(r.jat[o][l].movements[i].notes=u,X.set(r))}return t.$$set=u=>{"junctionIdx"in u&&n(0,o=u.junctionIdx),"stage"in u&&n(1,l=u.stage),"idx"in u&&n(2,i=u.idx)},[o,l,i,r,a,s,m,f,d]}class fo extends we{constructor(e){super(),ke(this,e,uo,so,he,{junctionIdx:0,stage:1,idx:2})}}const{window:mo}=En;function St(t,e,n){const r=t.slice();return r[27]=e[n],r[29]=n,r}function Ft(t,e,n){const r=t.slice();return r[30]=e[n],r[29]=n,r}function co(t){let e,n,r,o,l,i,a,s;e=new Fn({props:{$$slots:{default:[_o]},$$scope:{ctx:t}}}),e.$on("click",t[23]),r=new Wt({props:{$$slots:{default:[po]},$$scope:{ctx:t}}}),r.$on("click",t[10]);const m=[bo,ho],f=[];function d(u,p){return u[3].kind=="movement"?0:1}return l=d(t),i=f[l]=m[l](t),{c(){N(e.$$.fragment),n=H(),N(r.$$.fragment),o=H(),i.c(),a=_e()},l(u){z(e.$$.fragment,u),n=R(u),z(r.$$.fragment,u),o=R(u),i.l(u),a=_e()},m(u,p){G(e,u,p),E(u,n,p),G(r,u,p),E(u,o,p),f[l].m(u,p),E(u,a,p),s=!0},p(u,p){const A={};p[1]&2&&(A.$$scope={dirty:p,ctx:u}),e.$set(A);const g={};p[1]&2&&(g.$$scope={dirty:p,ctx:u}),r.$set(g);let b=l;l=d(u),l===b?f[l].p(u,p):(se(),$(f[b],1,1,()=>{f[b]=null}),ue(),i=f[l],i?i.p(u,p):(i=f[l]=m[l](u),i.c()),w(i,1),i.m(a.parentNode,a))},i(u){s||(w(e.$$.fragment,u),w(r.$$.fragment,u),w(i),s=!0)},o(u){$(e.$$.fragment,u),$(r.$$.fragment,u),$(i),s=!1},d(u){u&&(v(n),v(o),v(a)),D(e,u),D(r,u),f[l].d(u)}}}function go(t){let e,n,r,o,l,i,a="Arms",s,m,f,d,u,p="Movements",A,g,b,F,T;e=new Sn({props:{label:"Tools",$$slots:{default:[vo]},$$scope:{ctx:t}}});function M(_){t[16](_)}let L={legend:"Add to map",choices:[["arm","Arm"],["movement","Movement"]],inlineSmall:!0};t[2]!==void 0&&(L.value=t[2]),r=new Qt({props:L}),Y.push(()=>re(r,"value",M));let h=pe(t[7].jat[t[0]][t[1]].arms),c=[];for(let _=0;_<h.length;_+=1)c[_]=Bt(Ft(t,h,_));const I=_=>$(c[_],1,1,()=>{c[_]=null});let q=t[7].jat[t[0]][t[8]].arms.length>0&&Nt(t),B=pe(t[7].jat[t[0]][t[1]].movements),S=[];for(let _=0;_<B.length;_+=1)S[_]=zt(St(t,B,_));const O=_=>$(S[_],1,1,()=>{S[_]=null});let C=t[7].jat[t[0]][t[1]].movements.length>0&&Gt(t);return{c(){N(e.$$.fragment),n=H(),N(r.$$.fragment),l=H(),i=x("h3"),i.textContent=a,s=H(),m=x("ul");for(let _=0;_<c.length;_+=1)c[_].c();f=H(),q&&q.c(),d=H(),u=x("h3"),u.textContent=p,A=H(),g=x("ol");for(let _=0;_<S.length;_+=1)S[_].c();b=H(),C&&C.c(),F=_e()},l(_){z(e.$$.fragment,_),n=R(_),z(r.$$.fragment,_),l=R(_),i=ee(_,"H3",{"data-svelte-h":!0}),yt(i)!=="svelte-ld74qb"&&(i.textContent=a),s=R(_),m=ee(_,"UL",{});var y=oe(m);for(let le=0;le<c.length;le+=1)c[le].l(y);y.forEach(v),f=R(_),q&&q.l(_),d=R(_),u=ee(_,"H3",{"data-svelte-h":!0}),yt(u)!=="svelte-1dc52s8"&&(u.textContent=p),A=R(_),g=ee(_,"OL",{});var Z=oe(g);for(let le=0;le<S.length;le+=1)S[le].l(Z);Z.forEach(v),b=R(_),C&&C.l(_),F=_e()},m(_,y){G(e,_,y),E(_,n,y),G(r,_,y),E(_,l,y),E(_,i,y),E(_,s,y),E(_,m,y);for(let Z=0;Z<c.length;Z+=1)c[Z]&&c[Z].m(m,null);E(_,f,y),q&&q.m(_,y),E(_,d,y),E(_,u,y),E(_,A,y),E(_,g,y);for(let Z=0;Z<S.length;Z+=1)S[Z]&&S[Z].m(g,null);E(_,b,y),C&&C.m(_,y),E(_,F,y),T=!0},p(_,y){const Z={};y[0]&96|y[1]&2&&(Z.$$scope={dirty:y,ctx:_}),e.$set(Z);const le={};if(!o&&y[0]&4&&(o=!0,le.value=_[2],ne(()=>o=!1)),r.$set(le),y[0]&659){h=pe(_[7].jat[_[0]][_[1]].arms);let P;for(P=0;P<h.length;P+=1){const ge=Ft(_,h,P);c[P]?(c[P].p(ge,y),w(c[P],1)):(c[P]=Bt(ge),c[P].c(),w(c[P],1),c[P].m(m,null))}for(se(),P=h.length;P<c.length;P+=1)I(P);ue()}if(_[7].jat[_[0]][_[8]].arms.length>0?q?(q.p(_,y),y[0]&129&&w(q,1)):(q=Nt(_),q.c(),w(q,1),q.m(d.parentNode,d)):q&&(se(),$(q,1,1,()=>{q=null}),ue()),y[0]&659){B=pe(_[7].jat[_[0]][_[1]].movements);let P;for(P=0;P<B.length;P+=1){const ge=St(_,B,P);S[P]?(S[P].p(ge,y),w(S[P],1)):(S[P]=zt(ge),S[P].c(),w(S[P],1),S[P].m(g,null))}for(se(),P=B.length;P<S.length;P+=1)O(P);ue()}_[7].jat[_[0]][_[1]].movements.length>0?C?C.p(_,y):(C=Gt(_),C.c(),C.m(F.parentNode,F)):C&&(C.d(1),C=null)},i(_){if(!T){w(e.$$.fragment,_),w(r.$$.fragment,_);for(let y=0;y<h.length;y+=1)w(c[y]);w(q);for(let y=0;y<B.length;y+=1)w(S[y]);T=!0}},o(_){$(e.$$.fragment,_),$(r.$$.fragment,_),c=c.filter(Boolean);for(let y=0;y<c.length;y+=1)$(c[y]);$(q),S=S.filter(Boolean);for(let y=0;y<S.length;y+=1)$(S[y]);T=!1},d(_){_&&(v(n),v(l),v(i),v(s),v(m),v(f),v(d),v(u),v(A),v(g),v(b),v(F)),D(e,_),D(r,_),Be(c,_),q&&q.d(_),Be(S,_),C&&C.d(_)}}}function _o(t){let e;return{c(){e=W("Save")},l(n){e=V(n,"Save")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function po(t){let e;return{c(){e=W("Delete")},l(n){e=V(n,"Delete")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function ho(t){let e,n,r;function o(i){t[24](i)}let l={label:"Arm Name"};return t[7].jat[t[0]][t[1]].arms[t[3].idx].name!==void 0&&(l.value=t[7].jat[t[0]][t[1]].arms[t[3].idx].name),e=new lt({props:l}),Y.push(()=>re(e,"value",o)),{c(){N(e.$$.fragment)},l(i){z(e.$$.fragment,i)},m(i,a){G(e,i,a),r=!0},p(i,a){const s={};!n&&a[0]&139&&(n=!0,s.value=i[7].jat[i[0]][i[1]].arms[i[3].idx].name,ne(()=>n=!1)),e.$set(s)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){D(e,i)}}}function bo(t){let e,n;return e=new fo({props:{junctionIdx:t[0],stage:t[1],idx:t[3].idx}}),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o[0]&1&&(l.junctionIdx=r[0]),o[0]&2&&(l.stage=r[1]),o[0]&8&&(l.idx=r[3].idx),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function yo(t){let e;return{c(){e=W("Zoom to fit")},l(n){e=V(n,"Zoom to fit")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function qt(t){var i;let e,n,r;function o(a){t[15](a)}let l={map:(i=t[6])==null?void 0:i.getMap()};return t[5]!==void 0&&(l.enabled=t[5]),e=new Tn({props:l}),Y.push(()=>re(e,"enabled",o)),{c(){N(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,s){G(e,a,s),r=!0},p(a,s){var f;const m={};s[0]&64&&(m.map=(f=a[6])==null?void 0:f.getMap()),!n&&s[0]&32&&(n=!0,m.enabled=a[5],ne(()=>n=!1)),e.$set(m)},i(a){r||(w(e.$$.fragment,a),r=!0)},o(a){$(e.$$.fragment,a),r=!1},d(a){D(e,a)}}}function vo(t){var d;let e,n,r,o,l,i,a=(d=t[6])==null?void 0:d.getMap(),s,m;e=new be({props:{$$slots:{default:[yo]},$$scope:{ctx:t}}}),e.$on("click",t[14]),r=new On({}),l=new An({});let f=a&&qt(t);return{c(){N(e.$$.fragment),n=H(),N(r.$$.fragment),o=H(),N(l.$$.fragment),i=H(),f&&f.c(),s=_e()},l(u){z(e.$$.fragment,u),n=R(u),z(r.$$.fragment,u),o=R(u),z(l.$$.fragment,u),i=R(u),f&&f.l(u),s=_e()},m(u,p){G(e,u,p),E(u,n,p),G(r,u,p),E(u,o,p),G(l,u,p),E(u,i,p),f&&f.m(u,p),E(u,s,p),m=!0},p(u,p){var g;const A={};p[1]&2&&(A.$$scope={dirty:p,ctx:u}),e.$set(A),p[0]&64&&(a=(g=u[6])==null?void 0:g.getMap()),a?f?(f.p(u,p),p[0]&64&&w(f,1)):(f=qt(u),f.c(),w(f,1),f.m(s.parentNode,s)):f&&(se(),$(f,1,1,()=>{f=null}),ue())},i(u){m||(w(e.$$.fragment,u),w(r.$$.fragment,u),w(l.$$.fragment,u),w(f),m=!0)},o(u){$(e.$$.fragment,u),$(r.$$.fragment,u),$(l.$$.fragment,u),$(f),m=!1},d(u){u&&(v(n),v(o),v(i),v(s)),D(e,u),D(r,u),D(l,u),f&&f.d(u)}}}function wo(t){let e=Lo(t[29])+"",n,r,o=(t[30].name||"Unnamed arm")+"",l;return{c(){n=W(e),r=W(" - "),l=W(o)},l(i){n=V(i,e),r=V(i," - "),l=V(i,o)},m(i,a){E(i,n,a),E(i,r,a),E(i,l,a)},p(i,a){a[0]&131&&o!==(o=(i[30].name||"Unnamed arm")+"")&&ve(l,o)},d(i){i&&(v(n),v(r),v(l))}}}function Bt(t){let e,n,r,o;function l(){return t[17](t[29])}function i(){return t[18](t[29])}return n=new be({props:{$$slots:{default:[wo]},$$scope:{ctx:t}}}),n.$on("click",l),n.$on("mouseenter",i),n.$on("mouseleave",t[19]),{c(){e=x("li"),N(n.$$.fragment),r=H()},l(a){e=ee(a,"LI",{});var s=oe(e);z(n.$$.fragment,s),r=R(s),s.forEach(v)},m(a,s){E(a,e,s),G(n,e,null),ce(e,r),o=!0},p(a,s){t=a;const m={};s[0]&131|s[1]&2&&(m.$$scope={dirty:s,ctx:t}),n.$set(m)},i(a){o||(w(n.$$.fragment,a),o=!0)},o(a){$(n.$$.fragment,a),o=!1},d(a){a&&v(e),D(n)}}}function Nt(t){let e,n;return e=new be({props:{$$slots:{default:[ko]},$$scope:{ctx:t}}}),e.$on("click",t[12]),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o[1]&2&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function ko(t){let e,n;return{c(){e=W("Copy arms from "),n=W(t[8])},l(r){e=V(r,"Copy arms from "),n=V(r,t[8])},m(r,o){E(r,e,o),E(r,n,o)},p:Ve,d(r){r&&(v(e),v(n))}}}function jo(t){let e=(t[27].name||"Unnamed movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){E(r,n,o)},p(r,o){o[0]&131&&e!==(e=(r[27].name||"Unnamed movement")+"")&&ve(n,e)},d(r){r&&v(n)}}}function zt(t){let e,n,r,o;function l(){return t[20](t[29])}function i(){return t[21](t[29])}return n=new be({props:{$$slots:{default:[jo]},$$scope:{ctx:t}}}),n.$on("click",l),n.$on("mouseenter",i),n.$on("mouseleave",t[22]),{c(){e=x("li"),N(n.$$.fragment),r=H()},l(a){e=ee(a,"LI",{});var s=oe(e);z(n.$$.fragment,s),r=R(s),s.forEach(v)},m(a,s){E(a,e,s),G(n,e,null),ce(e,r),o=!0},p(a,s){t=a;const m={};s[0]&131|s[1]&2&&(m.$$scope={dirty:s,ctx:t}),n.$set(m)},i(a){o||(w(n.$$.fragment,a),o=!0)},o(a){$(n.$$.fragment,a),o=!1},d(a){a&&v(e),D(n)}}}function Gt(t){let e,n,r=Dt(t[7].jat[t[0]][t[1]])+"",o,l;return{c(){e=x("p"),n=W("Total JAT score: "),o=W(r),l=W("%")},l(i){e=ee(i,"P",{});var a=oe(e);n=V(a,"Total JAT score: "),o=V(a,r),l=V(a,"%"),a.forEach(v)},m(i,a){E(i,e,a),ce(e,n),ce(e,o),ce(e,l)},p(i,a){a[0]&131&&r!==(r=Dt(i[7].jat[i[0]][i[1]])+"")&&ve(o,r)},d(i){i&&v(e)}}}function $o(t){let e,n,r,o,l,i,a,s,m,f,d,u,p,A;function g(c){t[13](c)}let b={label:"Commentary / Notes"};t[7].jat[t[0]][t[1]].notes!==void 0&&(b.value=t[7].jat[t[0]][t[1]].notes),e=new Yt({props:b}),Y.push(()=>re(e,"value",g));const F=[go,co],T=[];function M(c,I){return c[3]==null?0:1}i=M(t),a=T[i]=F[i](t);function L(c){t[26](c)}let h={junctionIdx:t[0],stage:t[1],newKind:t[2],hoveringSidebar:t[4],streetviewOn:t[5]};return t[3]!==void 0&&(h.editing=t[3]),f=new ao({props:h}),t[25](f),Y.push(()=>re(f,"editing",L)),{c(){N(e.$$.fragment),r=H(),o=x("div"),l=x("div"),a.c(),s=H(),m=x("div"),N(f.$$.fragment),this.h()},l(c){z(e.$$.fragment,c),r=R(c),o=ee(c,"DIV",{style:!0});var I=oe(o);l=ee(I,"DIV",{style:!0});var q=oe(l);a.l(q),q.forEach(v),s=R(I),m=ee(I,"DIV",{style:!0});var B=oe(m);z(f.$$.fragment,B),B.forEach(v),I.forEach(v),this.h()},h(){Q(l,"width","30%"),Q(l,"overflow-y","scroll"),Q(l,"padding","10px"),Q(l,"border","1px solid black"),Q(m,"position","relative"),Q(m,"width","100%"),Q(o,"display","flex"),Q(o,"height","80vh")},m(c,I){G(e,c,I),E(c,r,I),E(c,o,I),ce(o,l),T[i].m(l,null),ce(o,s),ce(o,m),G(f,m,null),u=!0,p||(A=kn(mo,"keydown",t[11]),p=!0)},p(c,I){const q={};!n&&I[0]&131&&(n=!0,q.value=c[7].jat[c[0]][c[1]].notes,ne(()=>n=!1)),e.$set(q);let B=i;i=M(c),i===B?T[i].p(c,I):(se(),$(T[B],1,1,()=>{T[B]=null}),ue(),a=T[i],a?a.p(c,I):(a=T[i]=F[i](c),a.c()),w(a,1),a.m(l,null));const S={};I[0]&1&&(S.junctionIdx=c[0]),I[0]&2&&(S.stage=c[1]),I[0]&4&&(S.newKind=c[2]),I[0]&16&&(S.hoveringSidebar=c[4]),I[0]&32&&(S.streetviewOn=c[5]),!d&&I[0]&8&&(d=!0,S.editing=c[3],ne(()=>d=!1)),f.$set(S)},i(c){u||(w(e.$$.fragment,c),w(a),w(f.$$.fragment,c),u=!0)},o(c){$(e.$$.fragment,c),$(a),$(f.$$.fragment,c),u=!1},d(c){c&&(v(r),v(o)),D(e,c),T[i].d(),t[25](null),D(f),p=!1,A()}}}function Lo(t){return String.fromCharCode(t+65)}function Dt(t){let e=0,n=0;for(let r of t.movements)e+={0:0,1:1,2:2,X:0}[r.score],n+=2;return e/n*100}function Co(t,e,n){let r;ye(t,X,y=>n(7,r=y));let{junctionIdx:o}=e,{stage:l}=e,i=l=="existing"?"proposed":"existing",a="arm",s=null,m=null,f=!1,d=null;function u(y){n(3,s=y),n(4,m=null)}function p(){window.confirm(`Delete this ${s.kind}?`)&&(s.kind=="movement"?(r.jat[o][l].movements.splice(s.idx,1),X.set(r)):(r.jat[o][l].arms.splice(s.idx,1),X.set(r)),n(3,s=null))}function A(y){s!=null&&y.key=="Escape"?(y.stopPropagation(),n(3,s=null)):s!=null&&y.key=="Delete"&&p()}function g(){r.jat[o][l].arms.length>0&&!window.confirm("Overwrite arms?")||(qe(X,r.jat[o][l].arms=JSON.parse(JSON.stringify(r.jat[o][i].arms)),r),X.set(r))}function b(y){t.$$.not_equal(r.jat[o][l].notes,y)&&(r.jat[o][l].notes=y,X.set(r))}const F=()=>d==null?void 0:d.zoom(!0);function T(y){f=y,n(5,f)}function M(y){a=y,n(2,a)}const L=y=>u({kind:"arm",idx:y}),h=y=>n(4,m={kind:"arm",idx:y}),c=()=>n(4,m=null),I=y=>u({kind:"movement",idx:y}),q=y=>n(4,m={kind:"movement",idx:y}),B=()=>n(4,m=null),S=()=>n(3,s=null);function O(y){t.$$.not_equal(r.jat[o][l].arms[s.idx].name,y)&&(r.jat[o][l].arms[s.idx].name=y,X.set(r))}function C(y){Y[y?"unshift":"push"](()=>{d=y,n(6,d)})}function _(y){s=y,n(3,s)}return t.$$set=y=>{"junctionIdx"in y&&n(0,o=y.junctionIdx),"stage"in y&&n(1,l=y.stage)},[o,l,a,s,m,f,d,r,i,u,p,A,g,b,F,T,M,L,h,c,I,q,B,S,O,C,_]}class Eo extends we{constructor(e){super(),ke(this,e,Co,$o,he,{junctionIdx:0,stage:1},null,[-1,-1])}}function Ht(t,e,n){const r=t.slice();return r[10]=e[n],r[12]=n,r}function Mo(t){let e,n=(t[1].jat[t[0].idx].name||"Untitled junction")+"",r,o,l=t[0].stage+"",i,a,s,m,f,d,u,p=t[0].stage,A,g;s=new jn({props:{$$slots:{default:[qo]},$$scope:{ctx:t}}});function b(M){t[9](M)}let F={label:"Junction Name"};t[1].jat[t[0].idx].name!==void 0&&(F.value=t[1].jat[t[0].idx].name),f=new lt({props:F}),Y.push(()=>re(f,"value",b));let T=Rt(t);return{c(){e=x("h2"),r=W(n),o=W(" - "),i=W(l),a=H(),N(s.$$.fragment),m=H(),N(f.$$.fragment),u=H(),T.c(),A=_e()},l(M){e=ee(M,"H2",{});var L=oe(e);r=V(L,n),o=V(L," - "),i=V(L,l),L.forEach(v),a=R(M),z(s.$$.fragment,M),m=R(M),z(f.$$.fragment,M),u=R(M),T.l(M),A=_e()},m(M,L){E(M,e,L),ce(e,r),ce(e,o),ce(e,i),E(M,a,L),G(s,M,L),E(M,m,L),G(f,M,L),E(M,u,L),T.m(M,L),E(M,A,L),g=!0},p(M,L){(!g||L&3)&&n!==(n=(M[1].jat[M[0].idx].name||"Untitled junction")+"")&&ve(r,n),(!g||L&1)&&l!==(l=M[0].stage+"")&&ve(i,l);const h={};L&8193&&(h.$$scope={dirty:L,ctx:M}),s.$set(h);const c={};!d&&L&3&&(d=!0,c.value=M[1].jat[M[0].idx].name,ne(()=>d=!1)),f.$set(c),L&1&&he(p,p=M[0].stage)?(se(),$(T,1,1,Ve),ue(),T=Rt(M),T.c(),w(T,1),T.m(A.parentNode,A)):T.p(M,L)},i(M){g||(w(s.$$.fragment,M),w(f.$$.fragment,M),w(T),g=!0)},o(M){$(s.$$.fragment,M),$(f.$$.fragment,M),$(T),g=!1},d(M){M&&(v(e),v(a),v(m),v(u),v(A)),D(s,M),D(f,M),T.d(M)}}}function Po(t){let e,n,r,o;e=new be({props:{$$slots:{default:[Bo]},$$scope:{ctx:t}}}),e.$on("click",t[2]);let l=pe(t[1].jat),i=[];for(let s=0;s<l.length;s+=1)i[s]=Ut(Ht(t,l,s));const a=s=>$(i[s],1,1,()=>{i[s]=null});return{c(){N(e.$$.fragment),n=H(),r=x("ol");for(let s=0;s<i.length;s+=1)i[s].c()},l(s){z(e.$$.fragment,s),n=R(s),r=ee(s,"OL",{});var m=oe(r);for(let f=0;f<i.length;f+=1)i[f].l(m);m.forEach(v)},m(s,m){G(e,s,m),E(s,n,m),E(s,r,m);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(r,null);o=!0},p(s,m){const f={};if(m&8192&&(f.$$scope={dirty:m,ctx:s}),e.$set(f),m&3){l=pe(s[1].jat);let d;for(d=0;d<l.length;d+=1){const u=Ht(s,l,d);i[d]?(i[d].p(u,m),w(i[d],1)):(i[d]=Ut(u),i[d].c(),w(i[d],1),i[d].m(r,null))}for(se(),d=l.length;d<i.length;d+=1)a(d);ue()}},i(s){if(!o){w(e.$$.fragment,s);for(let m=0;m<l.length;m+=1)w(i[m]);o=!0}},o(s){$(e.$$.fragment,s),i=i.filter(Boolean);for(let m=0;m<i.length;m+=1)$(i[m]);o=!1},d(s){s&&(v(n),v(r)),D(e,s),Be(i,s)}}}function Io(t){let e;return{c(){e=W("Back to all junctions")},l(n){e=V(n,"Back to all junctions")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function Oo(t){let e,n;return e=new be({props:{$$slots:{default:[To]},$$scope:{ctx:t}}}),e.$on("click",t[7]),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o&8192&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function Ao(t){let e,n;return e=new be({props:{$$slots:{default:[So]},$$scope:{ctx:t}}}),e.$on("click",t[6]),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o&8192&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function To(t){let e;return{c(){e=W("Edit Proposed")},l(n){e=V(n,"Edit Proposed")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function So(t){let e;return{c(){e=W("Edit Existing")},l(n){e=V(n,"Edit Existing")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function Fo(t){let e;return{c(){e=W("Delete")},l(n){e=V(n,"Delete")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function qo(t){let e,n,r,o,l,i,a;e=new be({props:{$$slots:{default:[Io]},$$scope:{ctx:t}}}),e.$on("click",t[5]);const s=[Ao,Oo],m=[];function f(d,u){return d[0].stage=="proposed"?0:1}return r=f(t),o=m[r]=s[r](t),i=new Wt({props:{$$slots:{default:[Fo]},$$scope:{ctx:t}}}),i.$on("click",t[8]),{c(){N(e.$$.fragment),n=H(),o.c(),l=H(),N(i.$$.fragment)},l(d){z(e.$$.fragment,d),n=R(d),o.l(d),l=R(d),z(i.$$.fragment,d)},m(d,u){G(e,d,u),E(d,n,u),m[r].m(d,u),E(d,l,u),G(i,d,u),a=!0},p(d,u){const p={};u&8192&&(p.$$scope={dirty:u,ctx:d}),e.$set(p);let A=r;r=f(d),r===A?m[r].p(d,u):(se(),$(m[A],1,1,()=>{m[A]=null}),ue(),o=m[r],o?o.p(d,u):(o=m[r]=s[r](d),o.c()),w(o,1),o.m(l.parentNode,l));const g={};u&8192&&(g.$$scope={dirty:u,ctx:d}),i.$set(g)},i(d){a||(w(e.$$.fragment,d),w(o),w(i.$$.fragment,d),a=!0)},o(d){$(e.$$.fragment,d),$(o),$(i.$$.fragment,d),a=!1},d(d){d&&(v(n),v(l)),D(e,d),m[r].d(d),D(i,d)}}}function Rt(t){let e,n;return e=new Eo({props:{junctionIdx:t[0].idx,stage:t[0].stage}}),{c(){N(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,o){G(e,r,o),n=!0},p(r,o){const l={};o&1&&(l.junctionIdx=r[0].idx),o&1&&(l.stage=r[0].stage),e.$set(l)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){D(e,r)}}}function Bo(t){let e;return{c(){e=W("Add new junction")},l(n){e=V(n,"Add new junction")},m(n,r){E(n,e,r)},d(n){n&&v(e)}}}function No(t){let e=(t[10].name||"Untitled junction")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){E(r,n,o)},p(r,o){o&2&&e!==(e=(r[10].name||"Untitled junction")+"")&&ve(n,e)},d(r){r&&v(n)}}}function Ut(t){let e,n,r,o;function l(){return t[4](t[12])}return n=new be({props:{$$slots:{default:[No]},$$scope:{ctx:t}}}),n.$on("click",l),{c(){e=x("li"),N(n.$$.fragment),r=H()},l(i){e=ee(i,"LI",{});var a=oe(e);z(n.$$.fragment,a),r=R(a),a.forEach(v)},m(i,a){E(i,e,a),G(n,e,null),ce(e,r),o=!0},p(i,a){t=i;const s={};a&8194&&(s.$$scope={dirty:a,ctx:t}),n.$set(s)},i(i){o||(w(n.$$.fragment,i),o=!0)},o(i){$(n.$$.fragment,i),o=!1},d(i){i&&v(e),D(n)}}}function zo(t){let e,n,r,o;const l=[Po,Mo],i=[];function a(s,m){return s[0].kind=="list"?0:s[0].kind=="edit"?1:-1}return~(e=a(t))&&(n=i[e]=l[e](t)),{c(){n&&n.c(),r=_e()},l(s){n&&n.l(s),r=_e()},m(s,m){~e&&i[e].m(s,m),E(s,r,m),o=!0},p(s,[m]){let f=e;e=a(s),e===f?~e&&i[e].p(s,m):(n&&(se(),$(i[f],1,1,()=>{i[f]=null}),ue()),~e?(n=i[e],n?n.p(s,m):(n=i[e]=l[e](s),n.c()),w(n,1),n.m(r.parentNode,r)):n=null)},i(s){o||(w(n),o=!0)},o(s){$(n),o=!1},d(s){s&&v(r),~e&&i[e].d(s)}}}function tt(t){if(t.kind=="list")throw new Error("Unreachable case");return t.idx}function Go(t,e,n){let r;ye(t,X,p=>n(1,r=p));let o={kind:"list"};function l(){qe(X,r.jat=[...r.jat,{name:"",existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}],r),n(0,o={kind:"edit",idx:r.jat.length-1,stage:"existing"})}function i(p){window.confirm("Delete this junction?")&&(r.jat.splice(p,1),X.set(r),n(0,o={kind:"list"}))}const a=p=>n(0,o={kind:"edit",idx:p,stage:"existing"}),s=()=>n(0,o={kind:"list"}),m=()=>n(0,o={kind:"edit",idx:tt(o),stage:"existing"}),f=()=>n(0,o={kind:"edit",idx:tt(o),stage:"proposed"}),d=()=>i(tt(o));function u(p){t.$$.not_equal(r.jat[o.idx].name,p)&&(r.jat[o.idx].name=p,X.set(r))}return[o,r,l,i,a,s,m,f,d,u]}class oi extends we{constructor(e){super(),ke(this,e,Go,zo,he,{})}}export{oi as component};
