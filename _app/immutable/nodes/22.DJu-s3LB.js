var yn=Object.defineProperty;var pn=(r,e,t)=>e in r?yn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var te=(r,e,t)=>(pn(r,typeof e!="symbol"?e+"":e,t),t);import{s as Me,v as Q,x,l as Je,u as Ue,m as Ze,o as Ke,H as Z,ad as bn,ae as _n,E as ye,i as I,f as R,a8 as wn,k as ve,a7 as ht,N as Ne,n as qe,W as Mn,D as Sn,a as J,g as U,e as Ye,c as Ge,b as Tt,w as nt,p as Lt,h as it,t as _e,d as we,j as Fr}from"../chunks/scheduler.Bsni_e59.js";import{S as Fe,i as Te,e as j,c as q,a as D,m as X,t as T,b as A,d as N,g as Ve,f as We}from"../chunks/index.CCfAUppz.js";import{p as je}from"../chunks/index.BBYUQ9qV.js";import{S as $e}from"../chunks/Select.bLRJACqI.js";import{T as mt}from"../chunks/TextArea.DbePhW6L.js";import{T as et}from"../chunks/TextInput.CHbK327s.js";import{s as re}from"../chunks/data.BGRE_gMn.js";import{D as Ln}from"../chunks/DefaultButton.DyQsHGbh.js";import{S as wt,W as Pn}from"../chunks/WarningButton.D9QeV9gM.js";import{L as kn,g as En,f as Cn,j as Fn,k as At,l as Tn,n as An,c as Pt,M as zn,G as Bn}from"../chunks/MapLibreMap.BlSaQg4C.js";import{w as ot}from"../chunks/entry.WjX4lsjC.js";import{a as Rn,t as In,r as On,f as qn,d as Dn}from"../chunks/lists.Ci0sBo6t.js";function Xn(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function Nn(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[Xn]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new kn({props:o}),Q.push(()=>j(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){q(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,l){X(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],x(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){A(e.$$.fragment,a),n=!1},d(a){N(e,a)}}}function Yn(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=En("fill")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:g}=e,{layout:v=void 0}=e,{filter:P=void 0}=e,{minzoom:b=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:k=!1}=e,{hovered:F=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){F=f,t(0,F)}function p(f){Z.call(this,r,f)}function M(f){Z.call(this,r,f)}function S(f){Z.call(this,r,f)}function L(f){Z.call(this,r,f)}function E(f){Z.call(this,r,f)}function B(f){Z.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,h=f.beforeLayerType),"paint"in f&&t(6,g=f.paint),"layout"in f&&t(7,v=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,b=f.minzoom),"maxzoom"in f&&t(10,y=f.maxzoom),"hoverCursor"in f&&t(11,C=f.hoverCursor),"manageHoverState"in f&&t(12,k=f.manageHoverState),"hovered"in f&&t(0,F=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[F,o,a,l,s,h,g,v,P,b,y,C,k,u,c,n,d,p,M,S,L,E,B,i]}let Gn=class extends Fe{constructor(e){super(),Te(this,e,Yn,Nn,Me,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}};var Hn=Object.defineProperty,G=(r,e)=>Hn(r,"name",{value:e,configurable:!0}),Jn=class{constructor(e){this.direction=!1,this.compareProperties=!0;var t,n,i;this.precision=10**-((t=e==null?void 0:e.precision)!=null?t:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(i=e==null?void 0:e.compareProperties)!=null?i:!0}compare(e,t){if(e.type!==t.type||!rt(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates);case"Polygon":return this.comparePolygon(e,t);case"GeometryCollection":return this.compareGeometryCollection(e,t);case"Feature":return this.compareFeature(e,t);case"FeatureCollection":return this.compareFeatureCollection(e,t);default:if(e.type.startsWith("Multi")){const n=kt(e),i=kt(t);return n.every(o=>i.some(a=>this.compare(o,a)))}}return!1}compareCoord(e,t){return e.length===t.length&&e.every((n,i)=>Math.abs(n-t[i])<this.precision)}compareLine(e,t,n=0,i=!1){if(!rt(e,t))return!1;const o=e;let a=t;if(i&&!this.compareCoord(o[0],a[0])){const s=this.fixStartIndex(a,o);if(s)a=s;else return!1}const l=this.compareCoord(o[n],a[n]);return this.direction||l?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}fixStartIndex(e,t){let n,i=-1;for(let o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){i=o;break}return i>=0&&(n=[].concat(e.slice(i,e.length),e.slice(1,i+1))),n}comparePath(e,t){return e.every((n,i)=>this.compareCoord(n,t[i]))}comparePolygon(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),i=t.coordinates.slice(1,t.coordinates.length);return n.every(o=>i.some(a=>this.compareLine(o,a,1,!0)))}return!1}compareGeometryCollection(e,t){return rt(e.geometries,t.geometries)&&this.compareBBox(e,t)&&e.geometries.every((n,i)=>this.compare(n,t.geometries[i]))}compareFeature(e,t){return e.id===t.id&&(this.compareProperties?Cn(e.properties,t.properties):!0)&&this.compareBBox(e,t)&&this.compare(e.geometry,t.geometry)}compareFeatureCollection(e,t){return rt(e.features,t.features)&&this.compareBBox(e,t)&&e.features.every((n,i)=>this.compare(n,t.features[i]))}compareBBox(e,t){return!e.bbox&&!t.bbox||(e.bbox&&t.bbox?this.compareCoord(e.bbox,t.bbox):!1)}};G(Jn,"GeojsonEquality");function rt(r,e){return r.coordinates?r.coordinates.length===e.coordinates.length:r.length===e.length}G(rt,"sameLength");function kt(r){return r.coordinates.map(e=>({type:r.type.replace("Multi",""),coordinates:e}))}G(kt,"explode");var le=63710088e-1,Tr={centimeters:le*100,centimetres:le*100,degrees:360/(2*Math.PI),feet:le*3.28084,inches:le*39.37,kilometers:le/1e3,kilometres:le/1e3,meters:le,metres:le,miles:le/1609.344,millimeters:le*1e3,millimetres:le*1e3,nauticalmiles:le/1852,radians:1,yards:le*1.0936},dr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Pe(r,e,t={}){const n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}G(Pe,"feature");function Un(r,e,t={}){switch(r){case"Point":return Ee(e).geometry;case"LineString":return Ce(e).geometry;case"Polygon":return zt(e).geometry;case"MultiPoint":return zr(e).geometry;case"MultiLineString":return Ar(e).geometry;case"MultiPolygon":return Br(e).geometry;default:throw new Error(r+" is invalid")}}G(Un,"geometry");function Ee(r,e,t={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!vt(r[0])||!vt(r[1]))throw new Error("coordinates must contain numbers");return Pe({type:"Point",coordinates:r},e,t)}G(Ee,"point");function Zn(r,e,t={}){return yt(r.map(n=>Ee(n,e)),t)}G(Zn,"points");function zt(r,e,t={}){for(const i of r){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return Pe({type:"Polygon",coordinates:r},e,t)}G(zt,"polygon");function Kn(r,e,t={}){return yt(r.map(n=>zt(n,e)),t)}G(Kn,"polygons");function Ce(r,e,t={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return Pe({type:"LineString",coordinates:r},e,t)}G(Ce,"lineString");function Vn(r,e,t={}){return yt(r.map(n=>Ce(n,e)),t)}G(Vn,"lineStrings");function yt(r,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}G(yt,"featureCollection");function Ar(r,e,t={}){return Pe({type:"MultiLineString",coordinates:r},e,t)}G(Ar,"multiLineString");function zr(r,e,t={}){return Pe({type:"MultiPoint",coordinates:r},e,t)}G(zr,"multiPoint");function Br(r,e,t={}){return Pe({type:"MultiPolygon",coordinates:r},e,t)}G(Br,"multiPolygon");function Wn(r,e,t={}){return Pe({type:"GeometryCollection",geometries:r},e,t)}G(Wn,"geometryCollection");function Qn(r,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const t=Math.pow(10,e||0);return Math.round(r*t)/t}G(Qn,"round");function Rr(r,e="kilometers"){const t=Tr[e];if(!t)throw new Error(e+" units is invalid");return r*t}G(Rr,"radiansToLength");function Bt(r,e="kilometers"){const t=Tr[e];if(!t)throw new Error(e+" units is invalid");return r/t}G(Bt,"lengthToRadians");function xn(r,e){return Ir(Bt(r,e))}G(xn,"lengthToDegrees");function jn(r){let e=r%360;return e<0&&(e+=360),e}G(jn,"bearingToAzimuth");function Ir(r){return r%(2*Math.PI)*180/Math.PI}G(Ir,"radiansToDegrees");function $n(r){return r%360*Math.PI/180}G($n,"degreesToRadians");function ei(r,e="kilometers",t="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return Rr(Bt(r,e),t)}G(ei,"convertLength");function ti(r,e="meters",t="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const n=dr[e];if(!n)throw new Error("invalid original units");const i=dr[t];if(!i)throw new Error("invalid final units");return r/n*i}G(ti,"convertArea");function vt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}G(vt,"isNumber");function Rt(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}G(Rt,"isObject");function ri(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(e=>{if(!vt(e))throw new Error("bbox must only contain numbers")})}G(ri,"validateBBox");function ni(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}G(ni,"validateId");var ii=Object.defineProperty,ie=(r,e)=>ii(r,"name",{value:e,configurable:!0});function st(r,e,t){if(r!==null)for(var n,i,o,a,l,s,h,g=0,v=0,P,b=r.type,y=b==="FeatureCollection",C=b==="Feature",k=y?r.features.length:1,F=0;F<k;F++){h=y?r.features[F].geometry:C?r.geometry:r,P=h?h.type==="GeometryCollection":!1,l=P?h.geometries.length:1;for(var u=0;u<l;u++){var c=0,d=0;if(a=P?h.geometries[u]:h,a!==null){s=a.coordinates;var p=a.type;switch(g=t&&(p==="Polygon"||p==="MultiPolygon")?1:0,p){case null:break;case"Point":if(e(s,v,F,c,d)===!1)return!1;v++,c++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(e(s[n],v,F,c,d)===!1)return!1;v++,p==="MultiPoint"&&c++}p==="LineString"&&c++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-g;i++){if(e(s[n][i],v,F,c,d)===!1)return!1;v++}p==="MultiLineString"&&c++,p==="Polygon"&&d++}p==="Polygon"&&c++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(d=0,i=0;i<s[n].length;i++){for(o=0;o<s[n][i].length-g;o++){if(e(s[n][i][o],v,F,c,d)===!1)return!1;v++}d++}c++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(st(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}ie(st,"coordEach");function oi(r,e,t,n){var i=t;return st(r,function(o,a,l,s,h){a===0&&t===void 0?i=o:i=e(i,o,a,l,s,h)},n),i}ie(oi,"coordReduce");function Or(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}ie(Or,"propEach");function ai(r,e,t){var n=t;return Or(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}ie(ai,"propReduce");function qr(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}ie(qr,"featureEach");function li(r,e,t){var n=t;return qr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}ie(li,"featureReduce");function si(r){var e=[];return st(r,function(t){e.push(t)}),e}ie(si,"coordAll");function It(r,e){var t,n,i,o,a,l,s,h,g,v,P=0,b=r.type==="FeatureCollection",y=r.type==="Feature",C=b?r.features.length:1;for(t=0;t<C;t++){for(l=b?r.features[t].geometry:y?r.geometry:r,h=b?r.features[t].properties:y?r.properties:{},g=b?r.features[t].bbox:y?r.bbox:void 0,v=b?r.features[t].id:y?r.id:void 0,s=l?l.type==="GeometryCollection":!1,a=s?l.geometries.length:1,i=0;i<a;i++){if(o=s?l.geometries[i]:l,o===null){if(e(null,P,h,g,v)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,P,h,g,v)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],P,h,g,v)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}ie(It,"geomEach");function Dr(r,e,t){var n=t;return It(r,function(i,o,a,l,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,l,s)}),n}ie(Dr,"geomReduce");function pt(r,e){It(r,function(t,n,i,o,a){var l=t===null?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(Pe(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var s;switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var h=0;h<t.coordinates.length;h++){var g=t.coordinates[h],v={type:s,coordinates:g};if(e(Pe(v,i),n,h)===!1)return!1}})}ie(pt,"flattenEach");function ui(r,e,t){var n=t;return pt(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}ie(ui,"flattenReduce");function Xr(r,e){pt(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var l,s=0,h=0,g=0;if(st(t,function(v,P,b,y,C){if(l===void 0||n>s||y>h||C>g){l=v,s=n,h=y,g=C,o=0;return}var k=Ce([l,v],t.properties);if(e(k,n,i,C,o)===!1)return!1;o++,l=v})===!1)return!1}}})}ie(Xr,"segmentEach");function fi(r,e,t){var n=t,i=!1;return Xr(r,function(o,a,l,s,h){i===!1&&t===void 0?n=o:n=e(n,o,a,l,s,h),i=!0}),n}ie(fi,"segmentReduce");function Nr(r,e){if(!r)throw new Error("geojson is required");pt(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(e(Ce(a[l],t.properties),n,i,l)===!1)return!1;break}}})}ie(Nr,"lineEach");function ci(r,e,t){var n=t;return Nr(r,function(i,o,a,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,l)}),n}ie(ci,"lineReduce");function mi(r,e){if(e=e||{},!Rt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=s.length+o-1),Ce([s[o],s[o+1]],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o-1),Ce([s[i][o],s[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o-1),Ce([s[n][o],s[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o-1),Ce([s[n][i][o],s[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}ie(mi,"findSegment");function hi(r,e){if(e=e||{},!Rt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":return Ee(s,a,e);case"MultiPoint":return n<0&&(n=s.length+n),Ee(s[n],a,e);case"LineString":return o<0&&(o=s.length+o),Ee(s[o],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o),Ee(s[i][o],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o),Ee(s[n][o],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o),Ee(s[n][i][o],a,e)}throw new Error("geojson is invalid")}ie(hi,"findPoint");var vi=Object.defineProperty,bt=(r,e)=>vi(r,"name",{value:e,configurable:!0});function Yr(r){return Dr(r,(e,t)=>e+Gr(t),0)}bt(Yr,"area");function Gr(r){let e=0,t;switch(r.type){case"Polygon":return Et(r.coordinates);case"MultiPolygon":for(t=0;t<r.coordinates.length;t++)e+=Et(r.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}bt(Gr,"calculateArea");function Et(r){let e=0;if(r&&r.length>0){e+=Math.abs(Ct(r[0]));for(let t=1;t<r.length;t++)e-=Math.abs(Ct(r[t]))}return e}bt(Et,"polygonArea");var di=le*le/2,Mt=Math.PI/180;function Ct(r){const e=r.length;if(e<=2)return 0;let t=0,n=0;for(;n<e;){const i=r[n],o=r[n+1===e?0:n+1],a=r[n+2>=e?(n+2)%e:n+2],l=i[0]*Mt,s=o[1]*Mt,h=a[0]*Mt;t+=(h-l)*Math.sin(s),n++}return t*di}bt(Ct,"ringArea");var gr=Yr,oe=63710088e-1,Ot={centimeters:oe*100,centimetres:oe*100,degrees:oe/111325,feet:oe*3.28084,inches:oe*39.37,kilometers:oe/1e3,kilometres:oe/1e3,meters:oe,metres:oe,miles:oe/1609.344,millimeters:oe*1e3,millimetres:oe*1e3,nauticalmiles:oe/1852,radians:1,yards:oe*1.0936},gi={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/oe,yards:1.0936133},Ft={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function pe(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function yi(r,e,t){switch(r){case"Point":return ue(e).geometry;case"LineString":return de(e).geometry;case"Polygon":return qt(e).geometry;case"MultiPoint":return Jr(e).geometry;case"MultiLineString":return Hr(e).geometry;case"MultiPolygon":return Ur(e).geometry;default:throw new Error(r+" is invalid")}}function ue(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!dt(r[0])||!dt(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return pe(n,e,t)}function pi(r,e,t){return t===void 0&&(t={}),De(r.map(function(n){return ue(n,e)}),t)}function qt(r,e,t){t===void 0&&(t={});for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:r};return pe(l,e,t)}function bi(r,e,t){return t===void 0&&(t={}),De(r.map(function(n){return qt(n,e)}),t)}function de(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return pe(n,e,t)}function _i(r,e,t){return t===void 0&&(t={}),De(r.map(function(n){return de(n,e)}),t)}function De(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function Hr(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return pe(n,e,t)}function Jr(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return pe(n,e,t)}function Ur(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return pe(n,e,t)}function wi(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return pe(n,e,t)}function Mi(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function Dt(r,e){e===void 0&&(e="kilometers");var t=Ot[e];if(!t)throw new Error(e+" units is invalid");return r*t}function _t(r,e){e===void 0&&(e="kilometers");var t=Ot[e];if(!t)throw new Error(e+" units is invalid");return r/t}function Si(r,e){return at(_t(r,e))}function Li(r){var e=r%360;return e<0&&(e+=360),e}function at(r){var e=r%(2*Math.PI);return e*180/Math.PI}function ge(r){var e=r%360;return e*Math.PI/180}function Pi(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return Dt(_t(r,e),t)}function ki(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=Ft[e];if(!n)throw new Error("invalid original units");var i=Ft[t];if(!i)throw new Error("invalid final units");return r/n*i}function dt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function Xt(r){return!!r&&r.constructor===Object}function Ei(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!dt(e))throw new Error("bbox must only contain numbers")})}function Ci(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const Fi=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Ft,bearingToAzimuth:Li,convertArea:ki,convertLength:Pi,degreesToRadians:ge,earthRadius:oe,factors:Ot,feature:pe,featureCollection:De,geometry:yi,geometryCollection:wi,isNumber:dt,isObject:Xt,lengthToDegrees:Si,lengthToRadians:_t,lineString:de,lineStrings:_i,multiLineString:Hr,multiPoint:Jr,multiPolygon:Ur,point:ue,points:pi,polygon:qt,polygons:bi,radiansToDegrees:at,radiansToLength:Dt,round:Mi,unitsFactors:gi,validateBBox:Ei,validateId:Ci},Symbol.toStringTag,{value:"Module"}));function lt(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Zr(r,e,t){if(t===void 0&&(t={}),t.final===!0)return Ti(r,e);var n=lt(r),i=lt(e),o=ge(n[0]),a=ge(i[0]),l=ge(n[1]),s=ge(i[1]),h=Math.sin(a-o)*Math.cos(s),g=Math.cos(l)*Math.sin(s)-Math.sin(l)*Math.cos(s)*Math.cos(a-o);return at(Math.atan2(h,g))}function Ti(r,e){var t=Zr(e,r);return t=(t+180)%360,t}function tt(r,e,t){t===void 0&&(t={});var n=lt(r),i=lt(e),o=ge(i[1]-n[1]),a=ge(i[0]-n[0]),l=ge(n[1]),s=ge(i[1]),h=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(s);return Dt(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),t.units)}function yr(r,e,t,n){n===void 0&&(n={});var i=lt(r),o=ge(i[0]),a=ge(i[1]),l=ge(t),s=_t(e,n.units),h=Math.asin(Math.sin(a)*Math.cos(s)+Math.cos(a)*Math.sin(s)*Math.cos(l)),g=o+Math.atan2(Math.sin(l)*Math.sin(s)*Math.cos(a),Math.cos(s)-Math.sin(a)*Math.sin(h)),v=at(g),P=at(h);return ue([v,P],n.properties)}function ut(r,e,t){if(r!==null)for(var n,i,o,a,l,s,h,g=0,v=0,P,b=r.type,y=b==="FeatureCollection",C=b==="Feature",k=y?r.features.length:1,F=0;F<k;F++){h=y?r.features[F].geometry:C?r.geometry:r,P=h?h.type==="GeometryCollection":!1,l=P?h.geometries.length:1;for(var u=0;u<l;u++){var c=0,d=0;if(a=P?h.geometries[u]:h,a!==null){s=a.coordinates;var p=a.type;switch(g=t&&(p==="Polygon"||p==="MultiPolygon")?1:0,p){case null:break;case"Point":if(e(s,v,F,c,d)===!1)return!1;v++,c++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(e(s[n],v,F,c,d)===!1)return!1;v++,p==="MultiPoint"&&c++}p==="LineString"&&c++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-g;i++){if(e(s[n][i],v,F,c,d)===!1)return!1;v++}p==="MultiLineString"&&c++,p==="Polygon"&&d++}p==="Polygon"&&c++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(d=0,i=0;i<s[n].length;i++){for(o=0;o<s[n][i].length-g;o++){if(e(s[n][i][o],v,F,c,d)===!1)return!1;v++}d++}c++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(ut(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ai(r,e,t,n){var i=t;return ut(r,function(o,a,l,s,h){a===0&&t===void 0?i=o:i=e(i,o,a,l,s,h)},n),i}function Kr(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function zi(r,e,t){var n=t;return Kr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function gt(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Bi(r,e,t){var n=t;return gt(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Ri(r){var e=[];return ut(r,function(t){e.push(t)}),e}function Nt(r,e){var t,n,i,o,a,l,s,h,g,v,P=0,b=r.type==="FeatureCollection",y=r.type==="Feature",C=b?r.features.length:1;for(t=0;t<C;t++){for(l=b?r.features[t].geometry:y?r.geometry:r,h=b?r.features[t].properties:y?r.properties:{},g=b?r.features[t].bbox:y?r.bbox:void 0,v=b?r.features[t].id:y?r.id:void 0,s=l?l.type==="GeometryCollection":!1,a=s?l.geometries.length:1,i=0;i<a;i++){if(o=s?l.geometries[i]:l,o===null){if(e(null,P,h,g,v)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,P,h,g,v)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],P,h,g,v)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function Ii(r,e,t){var n=t;return Nt(r,function(i,o,a,l,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,l,s)}),n}function Qe(r,e){Nt(r,function(t,n,i,o,a){var l=t===null?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(pe(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var s;switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var h=0;h<t.coordinates.length;h++){var g=t.coordinates[h],v={type:s,coordinates:g};if(e(pe(v,i),n,h)===!1)return!1}})}function Oi(r,e,t){var n=t;return Qe(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}function Vr(r,e){Qe(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var l,s=0,h=0,g=0;if(ut(t,function(v,P,b,y,C){if(l===void 0||n>s||y>h||C>g){l=v,s=n,h=y,g=C,o=0;return}var k=de([l,v],t.properties);if(e(k,n,i,C,o)===!1)return!1;o++,l=v})===!1)return!1}}})}function qi(r,e,t){var n=t,i=!1;return Vr(r,function(o,a,l,s,h){i===!1&&t===void 0?n=o:n=e(n,o,a,l,s,h),i=!0}),n}function Wr(r,e){if(!r)throw new Error("geojson is required");Qe(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(e(de(a[l],t.properties),n,i,l)===!1)return!1;break}}})}function Di(r,e,t){var n=t;return Wr(r,function(i,o,a,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,l)}),n}function Xi(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=s.length+o-1),de([s[o],s[o+1]],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o-1),de([s[i][o],s[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o-1),de([s[n][o],s[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o-1),de([s[n][i][o],s[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}function Ni(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":return ue(s,a,e);case"MultiPoint":return n<0&&(n=s.length+n),ue(s[n],a,e);case"LineString":return o<0&&(o=s.length+o),ue(s[o],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o),ue(s[i][o],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o),ue(s[n][o],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o),ue(s[n][i][o],a,e)}throw new Error("geojson is invalid")}const Yi=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Ri,coordEach:ut,coordReduce:Ai,featureEach:gt,featureReduce:Bi,findPoint:Ni,findSegment:Xi,flattenEach:Qe,flattenReduce:Oi,geomEach:Nt,geomReduce:Ii,lineEach:Wr,lineReduce:Di,propEach:Kr,propReduce:zi,segmentEach:Vr,segmentReduce:qi},Symbol.toStringTag,{value:"Module"}));function pr(r){if(!r)throw new Error("geojson is required");var e=[];return Qe(r,function(t){Gi(t,e)}),De(e)}function Gi(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=He(n);break;case"LineString":t=[He(n)]}t.forEach(function(i){var o=Hi(i,r.properties);o.forEach(function(a){a.id=e.length,e.push(a)})})}}function Hi(r,e){var t=[];return r.reduce(function(n,i){var o=de([n,i],e);return o.bbox=Ji(n,i),t.push(o),i}),t}function Ji(r,e){var t=r[0],n=r[1],i=e[0],o=e[1],a=t<i?t:i,l=n<o?n:o,s=t>i?t:i,h=n>o?n:o;return[a,l,s,h]}var Yt={exports:{}},Qr={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Fn,function(){function t(u,c,d,p,M){(function S(L,E,B,f,_){for(;f>B;){if(f-B>600){var O=f-B+1,Y=E-B+1,K=Math.log(O),$=.5*Math.exp(2*K/3),ne=.5*Math.sqrt(K*$*(O-$)/O)*(Y-O/2<0?-1:1),V=Math.max(B,Math.floor(E-Y*$/O+ne)),Ae=Math.min(f,Math.floor(E+(O-Y)*$/O+ne));S(L,E,V,Ae,_)}var ce=L[E],W=B,ee=f;for(n(L,B,E),_(L[f],ce)>0&&n(L,B,f);W<ee;){for(n(L,W,ee),W++,ee--;_(L[W],ce)<0;)W++;for(;_(L[ee],ce)>0;)ee--}_(L[B],ce)===0?n(L,B,ee):n(L,++ee,f),ee<=E&&(B=ee+1),E<=ee&&(f=ee-1)}})(u,c,d||0,p||u.length-1,M||i)}function n(u,c,d){var p=u[c];u[c]=u[d],u[d]=p}function i(u,c){return u<c?-1:u>c?1:0}var o=function(u){u===void 0&&(u=9),this._maxEntries=Math.max(4,u),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(u,c,d){if(!d)return c.indexOf(u);for(var p=0;p<c.length;p++)if(d(u,c[p]))return p;return-1}function l(u,c){s(u,0,u.children.length,c,u)}function s(u,c,d,p,M){M||(M=k(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var S=c;S<d;S++){var L=u.children[S];h(M,u.leaf?p(L):L)}return M}function h(u,c){return u.minX=Math.min(u.minX,c.minX),u.minY=Math.min(u.minY,c.minY),u.maxX=Math.max(u.maxX,c.maxX),u.maxY=Math.max(u.maxY,c.maxY),u}function g(u,c){return u.minX-c.minX}function v(u,c){return u.minY-c.minY}function P(u){return(u.maxX-u.minX)*(u.maxY-u.minY)}function b(u){return u.maxX-u.minX+(u.maxY-u.minY)}function y(u,c){return u.minX<=c.minX&&u.minY<=c.minY&&c.maxX<=u.maxX&&c.maxY<=u.maxY}function C(u,c){return c.minX<=u.maxX&&c.minY<=u.maxY&&c.maxX>=u.minX&&c.maxY>=u.minY}function k(u){return{children:u,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function F(u,c,d,p,M){for(var S=[c,d];S.length;)if(!((d=S.pop())-(c=S.pop())<=p)){var L=c+Math.ceil((d-c)/p/2)*p;t(u,L,c,d,M),S.push(c,L,L,d)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(u){var c=this.data,d=[];if(!C(u,c))return d;for(var p=this.toBBox,M=[];c;){for(var S=0;S<c.children.length;S++){var L=c.children[S],E=c.leaf?p(L):L;C(u,E)&&(c.leaf?d.push(L):y(u,E)?this._all(L,d):M.push(L))}c=M.pop()}return d},o.prototype.collides=function(u){var c=this.data;if(!C(u,c))return!1;for(var d=[];c;){for(var p=0;p<c.children.length;p++){var M=c.children[p],S=c.leaf?this.toBBox(M):M;if(C(u,S)){if(c.leaf||y(u,S))return!0;d.push(M)}}c=d.pop()}return!1},o.prototype.load=function(u){if(!u||!u.length)return this;if(u.length<this._minEntries){for(var c=0;c<u.length;c++)this.insert(u[c]);return this}var d=this._build(u.slice(),0,u.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var p=this.data;this.data=d,d=p}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},o.prototype.insert=function(u){return u&&this._insert(u,this.data.height-1),this},o.prototype.clear=function(){return this.data=k([]),this},o.prototype.remove=function(u,c){if(!u)return this;for(var d,p,M,S=this.data,L=this.toBBox(u),E=[],B=[];S||E.length;){if(S||(S=E.pop(),p=E[E.length-1],d=B.pop(),M=!0),S.leaf){var f=a(u,S.children,c);if(f!==-1)return S.children.splice(f,1),E.push(S),this._condense(E),this}M||S.leaf||!y(S,L)?p?(d++,S=p.children[d],M=!1):S=null:(E.push(S),B.push(d),d=0,p=S,S=S.children[0])}return this},o.prototype.toBBox=function(u){return u},o.prototype.compareMinX=function(u,c){return u.minX-c.minX},o.prototype.compareMinY=function(u,c){return u.minY-c.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(u){return this.data=u,this},o.prototype._all=function(u,c){for(var d=[];u;)u.leaf?c.push.apply(c,u.children):d.push.apply(d,u.children),u=d.pop();return c},o.prototype._build=function(u,c,d,p){var M,S=d-c+1,L=this._maxEntries;if(S<=L)return l(M=k(u.slice(c,d+1)),this.toBBox),M;p||(p=Math.ceil(Math.log(S)/Math.log(L)),L=Math.ceil(S/Math.pow(L,p-1))),(M=k([])).leaf=!1,M.height=p;var E=Math.ceil(S/L),B=E*Math.ceil(Math.sqrt(L));F(u,c,d,B,this.compareMinX);for(var f=c;f<=d;f+=B){var _=Math.min(f+B-1,d);F(u,f,_,E,this.compareMinY);for(var O=f;O<=_;O+=E){var Y=Math.min(O+E-1,_);M.children.push(this._build(u,O,Y,p-1))}}return l(M,this.toBBox),M},o.prototype._chooseSubtree=function(u,c,d,p){for(;p.push(c),!c.leaf&&p.length-1!==d;){for(var M=1/0,S=1/0,L=void 0,E=0;E<c.children.length;E++){var B=c.children[E],f=P(B),_=(O=u,Y=B,(Math.max(Y.maxX,O.maxX)-Math.min(Y.minX,O.minX))*(Math.max(Y.maxY,O.maxY)-Math.min(Y.minY,O.minY))-f);_<S?(S=_,M=f<M?f:M,L=B):_===S&&f<M&&(M=f,L=B)}c=L||c.children[0]}var O,Y;return c},o.prototype._insert=function(u,c,d){var p=d?u:this.toBBox(u),M=[],S=this._chooseSubtree(p,this.data,c,M);for(S.children.push(u),h(S,p);c>=0&&M[c].children.length>this._maxEntries;)this._split(M,c),c--;this._adjustParentBBoxes(p,M,c)},o.prototype._split=function(u,c){var d=u[c],p=d.children.length,M=this._minEntries;this._chooseSplitAxis(d,M,p);var S=this._chooseSplitIndex(d,M,p),L=k(d.children.splice(S,d.children.length-S));L.height=d.height,L.leaf=d.leaf,l(d,this.toBBox),l(L,this.toBBox),c?u[c-1].children.push(L):this._splitRoot(d,L)},o.prototype._splitRoot=function(u,c){this.data=k([u,c]),this.data.height=u.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(u,c,d){for(var p,M,S,L,E,B,f,_=1/0,O=1/0,Y=c;Y<=d-c;Y++){var K=s(u,0,Y,this.toBBox),$=s(u,Y,d,this.toBBox),ne=(M=K,S=$,L=void 0,E=void 0,B=void 0,f=void 0,L=Math.max(M.minX,S.minX),E=Math.max(M.minY,S.minY),B=Math.min(M.maxX,S.maxX),f=Math.min(M.maxY,S.maxY),Math.max(0,B-L)*Math.max(0,f-E)),V=P(K)+P($);ne<_?(_=ne,p=Y,O=V<O?V:O):ne===_&&V<O&&(O=V,p=Y)}return p||d-c},o.prototype._chooseSplitAxis=function(u,c,d){var p=u.leaf?this.compareMinX:g,M=u.leaf?this.compareMinY:v;this._allDistMargin(u,c,d,p)<this._allDistMargin(u,c,d,M)&&u.children.sort(p)},o.prototype._allDistMargin=function(u,c,d,p){u.children.sort(p);for(var M=this.toBBox,S=s(u,0,c,M),L=s(u,d-c,d,M),E=b(S)+b(L),B=c;B<d-c;B++){var f=u.children[B];h(S,u.leaf?M(f):f),E+=b(S)}for(var _=d-c-1;_>=c;_--){var O=u.children[_];h(L,u.leaf?M(O):O),E+=b(L)}return E},o.prototype._adjustParentBBoxes=function(u,c,d){for(var p=d;p>=0;p--)h(c[p],u)},o.prototype._condense=function(u){for(var c=u.length-1,d=void 0;c>=0;c--)u[c].children.length===0?c>0?(d=u[c-1].children).splice(d.indexOf(u[c]),1):this.clear():l(u[c],this.toBBox)},o})})(Qr);var Ui=Qr.exports;const Zi=At(Fi),Ki=At(Yi),Vi=At(Tn);var Le=Ui,xr=Zi,jr=Ki,Xe=Vi.default,Wi=jr.featureEach;jr.coordEach;xr.polygon;var br=xr.featureCollection;function $r(r){var e=new Le(r);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Xe(t),Le.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Xe(i),n.push(i)}):Wi(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Xe(i),n.push(i)}),Le.prototype.load.call(this,n)},e.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Xe(t),Le.prototype.remove.call(this,t,n)},e.clear=function(){return Le.prototype.clear.call(this)},e.search=function(t){var n=Le.prototype.search.call(this,this.toBBox(t));return br(n)},e.collides=function(t){return Le.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=Le.prototype.all.call(this);return br(t)},e.toJSON=function(){return Le.prototype.toJSON.call(this)},e.fromJSON=function(t){return Le.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=Xe(t);else if(t.type==="FeatureCollection")n=Xe(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},e}Yt.exports=$r;Yt.exports.default=$r;var Qi=Yt.exports;const xi=An(Qi);function ji(r,e){var t={},n=[];if(r.type==="LineString"&&(r=pe(r)),e.type==="LineString"&&(e=pe(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=_r(r,e);return i&&n.push(i),De(n)}var o=xi();return o.load(pr(e)),gt(pr(r),function(a){gt(o.search(a),function(l){var s=_r(a,l);if(s){var h=He(s).join(",");t[h]||(t[h]=!0,n.push(s))}})}),De(n)}function _r(r,e){var t=He(r),n=He(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],a=t[1][0],l=t[1][1],s=n[0][0],h=n[0][1],g=n[1][0],v=n[1][1],P=(v-h)*(a-i)-(g-s)*(l-o),b=(g-s)*(o-h)-(v-h)*(i-s),y=(a-i)*(o-h)-(l-o)*(i-s);if(P===0)return null;var C=b/P,k=y/P;if(C>=0&&C<=1&&k>=0&&k<=1){var F=i+C*(a-i),u=o+C*(l-o);return ue([F,u])}return null}function $i(r,e,t){t===void 0&&(t={});var n=ue([1/0,1/0],{dist:1/0}),i=0;return Qe(r,function(o){for(var a=He(o),l=0;l<a.length-1;l++){var s=ue(a[l]);s.properties.dist=tt(e,s,t);var h=ue(a[l+1]);h.properties.dist=tt(e,h,t);var g=tt(s,h,t),v=Math.max(s.properties.dist,h.properties.dist),P=Zr(s,h),b=yr(e,v,P+90,t),y=yr(e,v,P-90,t),C=ji(de([b.geometry.coordinates,y.geometry.coordinates]),de([s.geometry.coordinates,h.geometry.coordinates])),k=null;C.features.length>0&&(k=C.features[0],k.properties.dist=tt(e,k,t),k.properties.location=i+tt(s,k,t)),s.properties.dist<n.properties.dist&&(n=s,n.properties.index=l,n.properties.location=i),h.properties.dist<n.properties.dist&&(n=h,n.properties.index=l+1,n.properties.location=i+g),k&&k.properties.dist<n.properties.dist&&(n=k,n.properties.index=l),i+=g}}),n}const eo=["==",["geometry-type"],"Polygon"],to=["==",["geometry-type"],"LineString"],ro=["==",["geometry-type"],"Point"];function St(r){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:en(r)}}}function en(r){return[Math.round(r[0]*1e7)/1e7,Math.round(r[1]*1e7)/1e7]}const tn=ot({type:"FeatureCollection",features:[]}),rn=ot(0),no=100;class io{constructor(e){te(this,"map");te(this,"active");te(this,"eventListenersSuccess");te(this,"eventListenersUpdated");te(this,"eventListenersFailure");te(this,"points");te(this,"cursor");te(this,"hover");te(this,"dragFrom");te(this,"previousStates");te(this,"onMouseMove",e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,n=this.dragFrom[1]-e.lngLat.lat;for(let i of this.points)i[0]-=t,i[1]-=n}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}});te(this,"onClick",e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(wr(this.points).forEach((n,i)=>{t.push([i+1,$i(n,this.cursor).properties.dist])}),t.sort((n,i)=>n[1]-i[1]),t.length>0){let n=t[0][0];this.points.splice(n,0,this.cursor.geometry.coordinates),this.hover=n}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))});te(this,"onDoubleClick",e=>{this.active&&(e.preventDefault(),this.cursor=St(e.lngLat.toArray()),this.onClick(e),this.finish())});te(this,"onMouseDown",e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())});te(this,"onMouseUp",()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())});te(this,"onKeypress",e=>{this.active&&(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())});te(this,"onKeyDown",e=>{this.active&&e.key=="Escape"&&(e.stopPropagation(),this.cancel())});this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e={type:"FeatureCollection",features:[]};this.points.forEach((i,o)=>{let a=St(i);a.properties.hover=this.hover==o,a.properties.idx=o,e.features.push(a)}),e.features=e.features.concat(wr(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),tn.set(e);let n="crosshair";this.hover!=null&&(n=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=n,rn.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=St(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(en),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>no&&this.previousStates.shift()}}function wr(r){let e=[];for(let t=0;t<r.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[t],r[t+1]]},properties:{}});return r.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[r.length-1],r[0]]},properties:{}}),e}let oo=Date.now();function ft(r){return`${r}-${oo++}`}const nn=Symbol.for("svelte-maplibre");function ao(){return _n(nn)}function Mr(r){return{subscribe:r.subscribe}}function on({key:r,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:n=!1}){let i=ao(),o=ot(null),a=Mr(o),l={...i,[r]:Mr(o)};if(e&&(l.popupTarget=a),n){let s=ot(null);l.layerEvent=s,i.layerEvent=s}return t&&(l.cluster=ot()),bn(nn,l),{...i,self:o}}function lo(){return on({key:"source",setCluster:!0})}function so(r=!0){return on({key:"layer",setPopupTarget:r,setMouseEvent:r})}function Sr(r){let e;return t=>{if(t)for(let n in t){let i=e==null?void 0:e[n],o=t[n];i!==o&&r(n,o,i)}else if(e)for(let n in e)r(n,void 0,e[n]);e=t}}function uo(r,...e){let t=[r];for(let n of e)if(n)Array.isArray(n)&&n[0]===r?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function fo(r){return r===!0?["has","point_count"]:r===!1?["!",["has","point_count"]]:void 0}function Lr(r){let e=r[0],t,n,i=Pr(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),I(o,t,a),n=!0},p(o,a){a[0]&1&&Me(e,e=o[0])?(Ve(),A(i,1,1,qe),We(),i=Pr(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){A(i),n=!1},d(o){o&&R(t),i.d(o)}}}function Pr(r){let e;const t=r[36].default,n=Je(t,r,r[35],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o[1]&16)&&Ue(n,t,i,i[35],e?Ke(t,i[35],o,null):Ze(i[35]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function co(r){let e,t,n=r[0]&&Lr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),I(i,e,o),t=!0},p(i,o){i[0]?n?(n.p(i,o),o[0]&1&&T(n,1)):(n=Lr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Ve(),A(n,1,1,()=>{n=null}),We())},i(i){t||(T(n),t=!0)},o(i){A(n),t=!1},d(i){i&&R(e),n&&n.d(i)}}}function mo(r,e,t){let n,i,o,a,l,s,h,g,v,P,b,y,{$$slots:C={},$$scope:k}=e,{id:F=ft("layer")}=e,{source:u=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:d=void 0}=e,{beforeLayerType:p=void 0}=e,{type:M}=e,{paint:S=void 0}=e,{layout:L=void 0}=e,{filter:E=void 0}=e,{applyToClusters:B=void 0}=e,{minzoom:f=void 0}=e,{maxzoom:_=void 0}=e,{manageHoverState:O=!1}=e,{hovered:Y=null}=e,{interactive:K=!0}=e,{hoverCursor:$=void 0}=e,{eventsIfTopMost:ne=!1}=e;const V=wn(),{map:Ae,source:ce,self:W,minzoom:ee,maxzoom:ze,eventTopMost:fe,layerInfo:Be}=so();ve(r,Ae,w=>t(31,v=w)),ve(r,ce,w=>t(32,P=w)),ve(r,W,w=>t(0,g=w)),ve(r,ee,w=>t(34,y=w)),ve(r,ze,w=>t(33,b=w)),ht(()=>{g&&v&&(Be.delete(g),v==null||v.removeLayer(g))});let ae;function se(w){var he,be;if(!K||!g||!v||ne&&fe(w)!==g)return;let H=w.features??[],ke=(be=(he=H[0])==null?void 0:he.properties)==null?void 0:be.cluster_id,me={event:w,map:v,clusterId:ke,layer:g,source:l,features:H};V(w.type,me)}function xe(w){var he,be;if(!K||!g||!v||ne&&fe(w)!==g)return;$&&(v.getCanvas().style.cursor=$);let H=w.features??[];t(6,Y=H[0]??null);let ke=(be=(he=H[0])==null?void 0:he.properties)==null?void 0:be.cluster_id;V("mouseenter",{event:w,map:v,clusterId:ke,layer:g,source:l,features:H})}function Re(w){var he,be,ct;if(!K||!v)return;if(ne&&fe(w)!==g){t(6,Y=null),O&&ae!==void 0&&(v==null||v.setFeatureState({source:l,sourceLayer:c,id:ae},{hover:!1}),ae=void 0);return}v.getCanvas().style.cursor=$;let H=w.features??[],ke=(be=(he=H[0])==null?void 0:he.properties)==null?void 0:be.cluster_id,me=(ct=H[0])==null?void 0:ct.id;me!==ae&&(O&&(ae!==void 0&&(v==null||v.setFeatureState({source:l,id:ae,sourceLayer:c},{hover:!1})),v==null||v.setFeatureState({source:l,id:me,sourceLayer:c},{hover:!0})),ae=me,t(6,Y=H[0]??null)),V("mousemove",{event:w,map:v,clusterId:ke,layer:g,source:l,features:H})}function Se(w){if(!(!K||!g||!v)){if($&&(v.getCanvas().style.cursor=""),t(6,Y=null),O&&ae!==void 0){const H={source:l,id:ae,sourceLayer:c};v==null||v.setFeatureState(H,{hover:!1}),ae=void 0}V("mouseleave",{map:v,layer:g,source:l})}}let Ie=!0;function Oe(w){v&&(v.off("click",w,se),v.off("dblclick",w,se),v.off("contextmenu",w,se),v.off("mouseenter",w,xe),v.off("mousemove",w,Re),v.off("mouseleave",w,Se))}return ht(()=>{v&&g&&Oe(g)}),r.$$set=w=>{"id"in w&&t(7,F=w.id),"source"in w&&t(8,u=w.source),"sourceLayer"in w&&t(9,c=w.sourceLayer),"beforeId"in w&&t(10,d=w.beforeId),"beforeLayerType"in w&&t(11,p=w.beforeLayerType),"type"in w&&t(12,M=w.type),"paint"in w&&t(13,S=w.paint),"layout"in w&&t(14,L=w.layout),"filter"in w&&t(15,E=w.filter),"applyToClusters"in w&&t(16,B=w.applyToClusters),"minzoom"in w&&t(17,f=w.minzoom),"maxzoom"in w&&t(18,_=w.maxzoom),"manageHoverState"in w&&t(19,O=w.manageHoverState),"hovered"in w&&t(6,Y=w.hovered),"interactive"in w&&t(20,K=w.interactive),"hoverCursor"in w&&t(21,$=w.hoverCursor),"eventsIfTopMost"in w&&t(22,ne=w.eventsIfTopMost),"$$scope"in w&&t(35,k=w.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65536&&t(30,n=fo(B)),r.$$.dirty[0]&1073774592&&t(24,i=uo("all",n,E)),r.$$.dirty[0]&131072|r.$$.dirty[1]&8&&t(26,o=f??y),r.$$.dirty[0]&262144|r.$$.dirty[1]&4&&t(25,a=_??b),r.$$.dirty[0]&256|r.$$.dirty[1]&2&&t(29,l=u||P),r.$$.dirty[0]&654343809|r.$$.dirty[1]&1&&v&&g!==F&&l){g&&(Oe(g),Be.delete(g));let w=d;if(!d&&p){let H=v.getStyle().layers,ke=typeof p=="function"?p:he=>he.type===p,me=H==null?void 0:H.find(ke);me&&(w=me.id)}Ne(W,g=F,g),v.addLayer(Pt({id:g,type:M,source:l,"source-layer":c,filter:i,paint:S,layout:L,minzoom:o,maxzoom:a}),w),t(23,Ie=!0),v.on("click",g,se),v.on("dblclick",g,se),v.on("contextmenu",g,se),v.on("mouseenter",g,xe),v.on("mousemove",g,Re),v.on("mouseleave",g,Se)}r.$$.dirty[0]&1048577&&g&&Be.set(g,{interactive:K}),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(28,s=g?Sr((w,H)=>v==null?void 0:v.setPaintProperty(g,w,H)):void 0),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(27,h=g?Sr((w,H)=>v==null?void 0:v.setLayoutProperty(g,w,H)):void 0),r.$$.dirty[0]&268443648&&(s==null||s(S)),r.$$.dirty[0]&134234112&&(h==null||h(L)),r.$$.dirty[0]&100663297|r.$$.dirty[1]&1&&g&&(v==null||v.setLayerZoomRange(g,o,a)),r.$$.dirty[0]&25165825|r.$$.dirty[1]&1&&g&&(Ie?t(23,Ie=!1):v==null||v.setFilter(g,i))},[g,Ae,ce,W,ee,ze,Y,F,u,c,d,p,M,S,L,E,B,f,_,O,K,$,ne,Ie,i,a,o,h,s,l,n,v,P,b,y,k,C]}class Gt extends Fe{constructor(e){super(),Te(this,e,mo,co,Me,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function ho(r){let e;const t=r[16].default,n=Je(t,r,r[24],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16777216)&&Ue(n,t,i,i[24],e?Ke(t,i[24],o,null):Ze(i[24]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function vo(r){let e,t,n;function i(a){r[17](a)}let o={id:r[1],type:"circle",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],applyToClusters:r[9],minzoom:r[10],maxzoom:r[11],hoverCursor:r[12],manageHoverState:r[13],eventsIfTopMost:r[14],interactive:r[15],$$slots:{default:[ho]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>j(e,"hovered",i)),e.$on("click",r[18]),e.$on("dblclick",r[19]),e.$on("contextmenu",r[20]),e.$on("mouseenter",r[21]),e.$on("mousemove",r[22]),e.$on("mouseleave",r[23]),{c(){q(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,l){X(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.applyToClusters=a[9]),l&1024&&(s.minzoom=a[10]),l&2048&&(s.maxzoom=a[11]),l&4096&&(s.hoverCursor=a[12]),l&8192&&(s.manageHoverState=a[13]),l&16384&&(s.eventsIfTopMost=a[14]),l&32768&&(s.interactive=a[15]),l&16777216&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],x(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){A(e.$$.fragment,a),n=!1},d(a){N(e,a)}}}function go(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("circle")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:g}=e,{layout:v=void 0}=e,{filter:P=void 0}=e,{applyToClusters:b=void 0}=e,{minzoom:y=void 0}=e,{maxzoom:C=void 0}=e,{hoverCursor:k=void 0}=e,{manageHoverState:F=!1}=e,{hovered:u=null}=e,{eventsIfTopMost:c=!1}=e,{interactive:d=!0}=e;function p(_){u=_,t(0,u)}function M(_){Z.call(this,r,_)}function S(_){Z.call(this,r,_)}function L(_){Z.call(this,r,_)}function E(_){Z.call(this,r,_)}function B(_){Z.call(this,r,_)}function f(_){Z.call(this,r,_)}return r.$$set=_=>{"id"in _&&t(1,o=_.id),"source"in _&&t(2,a=_.source),"sourceLayer"in _&&t(3,l=_.sourceLayer),"beforeId"in _&&t(4,s=_.beforeId),"beforeLayerType"in _&&t(5,h=_.beforeLayerType),"paint"in _&&t(6,g=_.paint),"layout"in _&&t(7,v=_.layout),"filter"in _&&t(8,P=_.filter),"applyToClusters"in _&&t(9,b=_.applyToClusters),"minzoom"in _&&t(10,y=_.minzoom),"maxzoom"in _&&t(11,C=_.maxzoom),"hoverCursor"in _&&t(12,k=_.hoverCursor),"manageHoverState"in _&&t(13,F=_.manageHoverState),"hovered"in _&&t(0,u=_.hovered),"eventsIfTopMost"in _&&t(14,c=_.eventsIfTopMost),"interactive"in _&&t(15,d=_.interactive),"$$scope"in _&&t(24,i=_.$$scope)},[u,o,a,l,s,h,g,v,P,b,y,C,k,F,c,d,n,p,M,S,L,E,B,f,i]}class yo extends Fe{constructor(e){super(),Te(this,e,go,vo,Me,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function po(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function bo(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[po]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>j(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){q(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,l){X(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],x(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){A(e.$$.fragment,a),n=!1},d(a){N(e,a)}}}function _o(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("fill")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:g}=e,{layout:v=void 0}=e,{filter:P=void 0}=e,{minzoom:b=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:k=!1}=e,{hovered:F=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){F=f,t(0,F)}function p(f){Z.call(this,r,f)}function M(f){Z.call(this,r,f)}function S(f){Z.call(this,r,f)}function L(f){Z.call(this,r,f)}function E(f){Z.call(this,r,f)}function B(f){Z.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,h=f.beforeLayerType),"paint"in f&&t(6,g=f.paint),"layout"in f&&t(7,v=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,b=f.minzoom),"maxzoom"in f&&t(10,y=f.maxzoom),"hoverCursor"in f&&t(11,C=f.hoverCursor),"manageHoverState"in f&&t(12,k=f.manageHoverState),"hovered"in f&&t(0,F=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[F,o,a,l,s,h,g,v,P,b,y,C,k,u,c,n,d,p,M,S,L,E,B,i]}class wo extends Fe{constructor(e){super(),Te(this,e,_o,bo,Me,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Mo(r,e,t,n,i){let o=!1;r.getSource(e)&&(o=!0,r.removeSource(e));const a=()=>{n(e)&&(r.addSource(e,t),i())};if(o){const l=()=>{e&&(r.getSource(e)?setTimeout(l,1):a())};l()}else a()}function So(r,e,t){Mn().then(()=>{let n=Sn(r);if(!n)return;n.getSource(e)===t&&n.removeSource(e)})}function kr(r){let e=r[0],t,n,i=Er(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),I(o,t,a),n=!0},p(o,a){a&1&&Me(e,e=o[0])?(Ve(),A(i,1,1,qe),We(),i=Er(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){A(i),n=!1},d(o){o&&R(t),i.d(o)}}}function Er(r){let e;const t=r[15].default,n=Je(t,r,r[14],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16384)&&Ue(n,t,i,i[14],e?Ke(t,i[14],o,null):Ze(i[14]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function Lo(r){let e,t,n=r[0]&&kr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),I(i,e,o),t=!0},p(i,[o]){i[0]?n?(n.p(i,o),o&1&&T(n,1)):(n=kr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Ve(),A(n,1,1,()=>{n=null}),We())},i(i){t||(T(n),t=!0)},o(i){A(n),t=!1},d(i){i&&R(e),n&&n.d(i)}}}function Po(r,e,t){let n,i,o,{$$slots:a={},$$scope:l}=e,{id:s=ft("geojson")}=e,{data:h}=e,{generateId:g=!1}=e,{promoteId:v=void 0}=e,{filter:P=void 0}=e,{lineMetrics:b=void 0}=e,{cluster:y=void 0}=e;const{map:C,cluster:k,self:F}=lo();ve(r,C,d=>t(13,i=d)),ve(r,k,d=>t(16,o=d)),ve(r,F,d=>t(0,n=d));let u,c=!0;return ht(()=>{n&&u&&i&&(So(C,n,u),Ne(F,n=null,n),t(11,u=void 0))}),r.$$set=d=>{"id"in d&&t(4,s=d.id),"data"in d&&t(5,h=d.data),"generateId"in d&&t(6,g=d.generateId),"promoteId"in d&&t(7,v=d.promoteId),"filter"in d&&t(8,P=d.filter),"lineMetrics"in d&&t(9,b=d.lineMetrics),"cluster"in d&&t(10,y=d.cluster),"$$scope"in d&&t(14,l=d.$$scope)},r.$$.update=()=>{r.$$.dirty&1024&&Ne(k,o=y,o),r.$$.dirty&12273&&i&&n!==s&&(Ne(F,n=s,n),Mo(i,n,Pt({type:"geojson",data:h,filter:P,lineMetrics:b,generateId:g,promoteId:v,cluster:!!y,clusterMinPoints:y==null?void 0:y.minPoints,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius,clusterProperties:y==null?void 0:y.properties}),d=>i&&d===n,()=>{n&&(t(11,u=i==null?void 0:i.getSource(n)),t(12,c=!0))})),r.$$.dirty&8208&&(i==null||i.on("style.load",()=>{t(11,u=i==null?void 0:i.getSource(s))})),r.$$.dirty&6176&&u&&(c?t(12,c=!1):u.setData(h)),r.$$.dirty&3072&&(u==null||u.setClusterOptions(Pt({cluster:!!y,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius})))},[n,C,k,F,s,h,g,v,P,b,y,u,c,i,l,a]}class ko extends Fe{constructor(e){super(),Te(this,e,Po,Lo,Me,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Eo(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){A(n,i),e=!1},d(i){n&&n.d(i)}}}function Co(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"line",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[Eo]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>j(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){q(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,l){X(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],x(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){A(e.$$.fragment,a),n=!1},d(a){N(e,a)}}}function Fo(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("line")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:g}=e,{layout:v=void 0}=e,{filter:P=void 0}=e,{minzoom:b=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:k=!1}=e,{hovered:F=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){F=f,t(0,F)}function p(f){Z.call(this,r,f)}function M(f){Z.call(this,r,f)}function S(f){Z.call(this,r,f)}function L(f){Z.call(this,r,f)}function E(f){Z.call(this,r,f)}function B(f){Z.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,h=f.beforeLayerType),"paint"in f&&t(6,g=f.paint),"layout"in f&&t(7,v=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,b=f.minzoom),"maxzoom"in f&&t(10,y=f.maxzoom),"hoverCursor"in f&&t(11,C=f.hoverCursor),"manageHoverState"in f&&t(12,k=f.manageHoverState),"hovered"in f&&t(0,F=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[F,o,a,l,s,h,g,v,P,b,y,C,k,u,c,n,d,p,M,S,L,E,B,i]}class To extends Fe{constructor(e){super(),Te(this,e,Fo,Co,Me,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Ao(r){let e,t,n,i,o,a;return e=new wo({props:{id:"edit-polygon-fill",filter:eo,paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}}}),n=new To({props:{id:"edit-polygon-lines",filter:to,paint:{"line-color":"black","line-width":8,"line-opacity":.5}}}),o=new yo({props:{id:"edit-polygon-vertices",filter:ro,paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}}),{c(){q(e.$$.fragment),t=J(),q(n.$$.fragment),i=J(),q(o.$$.fragment)},l(l){D(e.$$.fragment,l),t=U(l),D(n.$$.fragment,l),i=U(l),D(o.$$.fragment,l)},m(l,s){X(e,l,s),I(l,t,s),X(n,l,s),I(l,i,s),X(o,l,s),a=!0},p:qe,i(l){a||(T(e.$$.fragment,l),T(n.$$.fragment,l),T(o.$$.fragment,l),a=!0)},o(l){A(e.$$.fragment,l),A(n.$$.fragment,l),A(o.$$.fragment,l),a=!1},d(l){l&&(R(t),R(i)),N(e,l),N(n,l),N(o,l)}}}function zo(r){let e,t;return e=new ko({props:{data:r[0],$$slots:{default:[Ao]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,i){X(e,n,i),t=!0},p(n,[i]){const o={};i&1&&(o.data=n[0]),i&2&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){N(e,n)}}}function Bo(r,e,t){let n;return ve(r,tn,i=>t(0,n=i)),[n]}class Ro extends Fe{constructor(e){super(),Te(this,e,Bo,zo,Me,{})}}function Io(r){let e,t="Map loading...";return{c(){e=Ye("p"),e.textContent=t},l(n){e=Ge(n,"P",{"data-svelte-h":!0}),Lt(e)!=="svelte-1r8199k"&&(e.textContent=t)},m(n,i){I(n,e,i)},p:qe,i:qe,o:qe,d(n){n&&R(e)}}}function Oo(r){let e,t,n,i;e=new Ln({props:{$$slots:{default:[Do]},$$scope:{ctx:r}}}),e.$on("click",r[5]);let o=r[1].summary.polygon&&Cr(r);return{c(){q(e.$$.fragment),t=J(),o&&o.c(),n=ye()},l(a){D(e.$$.fragment,a),t=U(a),o&&o.l(a),n=ye()},m(a,l){X(e,a,l),I(a,t,l),o&&o.m(a,l),I(a,n,l),i=!0},p(a,l){const s={};l&2048&&(s.$$scope={dirty:l,ctx:a}),e.$set(s),a[1].summary.polygon?o?(o.p(a,l),l&2&&T(o,1)):(o=Cr(a),o.c(),T(o,1),o.m(n.parentNode,n)):o&&(Ve(),A(o,1,1,()=>{o=null}),We())},i(a){i||(T(e.$$.fragment,a),T(o),i=!0)},o(a){A(e.$$.fragment,a),A(o),i=!1},d(a){a&&(R(t),R(n)),N(e,a),o&&o.d(a)}}}function qo(r){let e,t,n,i,o,a,l;return t=new wt({props:{$$slots:{default:[No]},$$scope:{ctx:r}}}),t.$on("click",r[7]),i=new wt({props:{$$slots:{default:[Yo]},$$scope:{ctx:r}}}),i.$on("click",r[8]),a=new wt({props:{disabled:r[4]==0,$$slots:{default:[Jo]},$$scope:{ctx:r}}}),a.$on("click",r[9]),{c(){e=Ye("div"),q(t.$$.fragment),n=J(),q(i.$$.fragment),o=J(),q(a.$$.fragment),this.h()},l(s){e=Ge(s,"DIV",{style:!0});var h=Tt(e);D(t.$$.fragment,h),n=U(h),D(i.$$.fragment,h),o=U(h),D(a.$$.fragment,h),h.forEach(R),this.h()},h(){nt(e,"display","flex"),nt(e,"justify-content","space-between")},m(s,h){I(s,e,h),X(t,e,null),it(e,n),X(i,e,null),it(e,o),X(a,e,null),l=!0},p(s,h){const g={};h&2048&&(g.$$scope={dirty:h,ctx:s}),t.$set(g);const v={};h&2048&&(v.$$scope={dirty:h,ctx:s}),i.$set(v);const P={};h&16&&(P.disabled=s[4]==0),h&2064&&(P.$$scope={dirty:h,ctx:s}),a.$set(P)},i(s){l||(T(t.$$.fragment,s),T(i.$$.fragment,s),T(a.$$.fragment,s),l=!0)},o(s){A(t.$$.fragment,s),A(i.$$.fragment,s),A(a.$$.fragment,s),l=!1},d(s){s&&R(e),N(t),N(i),N(a)}}}function Do(r){let e;return{c(){e=_e("Edit polygon")},l(t){e=we(t,"Edit polygon")},m(t,n){I(t,e,n)},d(t){t&&R(e)}}}function Cr(r){let e,t,n,i,o=gr(r[1].summary.polygon).toFixed(1)+"",a,l,s;return e=new Pn({props:{$$slots:{default:[Xo]},$$scope:{ctx:r}}}),e.$on("click",r[6]),{c(){q(e.$$.fragment),t=J(),n=Ye("p"),i=_e("Polygon area: "),a=_e(o),l=_e(" square meters")},l(h){D(e.$$.fragment,h),t=U(h),n=Ge(h,"P",{});var g=Tt(n);i=we(g,"Polygon area: "),a=we(g,o),l=we(g," square meters"),g.forEach(R)},m(h,g){X(e,h,g),I(h,t,g),I(h,n,g),it(n,i),it(n,a),it(n,l),s=!0},p(h,g){const v={};g&2048&&(v.$$scope={dirty:g,ctx:h}),e.$set(v),(!s||g&2)&&o!==(o=gr(h[1].summary.polygon).toFixed(1)+"")&&Fr(a,o)},i(h){s||(T(e.$$.fragment,h),s=!0)},o(h){A(e.$$.fragment,h),s=!1},d(h){h&&(R(t),R(n)),N(e,h)}}}function Xo(r){let e;return{c(){e=_e("Delete and start over")},l(t){e=we(t,"Delete and start over")},m(t,n){I(t,e,n)},d(t){t&&R(e)}}}function No(r){let e;return{c(){e=_e("Finish")},l(t){e=we(t,"Finish")},m(t,n){I(t,e,n)},d(t){t&&R(e)}}}function Yo(r){let e;return{c(){e=_e("Cancel")},l(t){e=we(t,"Cancel")},m(t,n){I(t,e,n)},d(t){t&&R(e)}}}function Go(r){let e,t,n;return{c(){e=_e("Undo ("),t=_e(r[4]),n=_e(")")},l(i){e=we(i,"Undo ("),t=we(i,r[4]),n=we(i,")")},m(i,o){I(i,e,o),I(i,t,o),I(i,n,o)},p(i,o){o&16&&Fr(t,i[4])},d(i){i&&(R(e),R(t),R(n))}}}function Ho(r){let e;return{c(){e=_e("Undo")},l(t){e=we(t,"Undo")},m(t,n){I(t,e,n)},p:qe,d(t){t&&R(e)}}}function Jo(r){let e;function t(o,a){return o[4]==0?Ho:Go}let n=t(r),i=n(r);return{c(){i.c(),e=ye()},l(o){i.l(o),e=ye()},m(o,a){i.m(o,a),I(o,e,a)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&R(e),i.d(o)}}}function Uo(r){let e,t;return e=new Gn({props:{layout:{visibility:r[2]?"none":"visible"},paint:{"fill-color":"red","fill-opacity":.8}}}),{c(){q(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,i){X(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.layout={visibility:n[2]?"none":"visible"}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){A(e.$$.fragment,n),t=!1},d(n){N(e,n)}}}function Zo(r){let e,t,n,i;return e=new Ro({}),n=new Bn({props:{data:r[3],$$slots:{default:[Uo]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment),t=J(),q(n.$$.fragment)},l(o){D(e.$$.fragment,o),t=U(o),D(n.$$.fragment,o)},m(o,a){X(e,o,a),I(o,t,a),X(n,o,a),i=!0},p(o,a){const l={};a&8&&(l.data=o[3]),a&2052&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){i||(T(e.$$.fragment,o),T(n.$$.fragment,o),i=!0)},o(o){A(e.$$.fragment,o),A(n.$$.fragment,o),i=!1},d(o){o&&R(t),N(e,o),N(n,o)}}}function Ko(r){let e,t,n,i,o,a,l;const s=[qo,Oo,Io],h=[];function g(b,y){return b[2]?0:b[0]?1:2}e=g(r),t=h[e]=s[e](r);function v(b){r[10](b)}let P={$$slots:{default:[Zo]},$$scope:{ctx:r}};return r[0]!==void 0&&(P.map=r[0]),o=new zn({props:P}),Q.push(()=>j(o,"map",v)),{c(){t.c(),n=J(),i=Ye("div"),q(o.$$.fragment),this.h()},l(b){t.l(b),n=U(b),i=Ge(b,"DIV",{style:!0});var y=Tt(i);D(o.$$.fragment,y),y.forEach(R),this.h()},h(){nt(i,"position","relative"),nt(i,"width","100%"),nt(i,"height","300px")},m(b,y){h[e].m(b,y),I(b,n,y),I(b,i,y),X(o,i,null),l=!0},p(b,[y]){let C=e;e=g(b),e===C?h[e].p(b,y):(Ve(),A(h[C],1,1,()=>{h[C]=null}),We(),t=h[e],t?t.p(b,y):(t=h[e]=s[e](b),t.c()),T(t,1),t.m(n.parentNode,n));const k={};y&2060&&(k.$$scope={dirty:y,ctx:b}),!a&&y&1&&(a=!0,k.map=b[0],x(()=>a=!1)),o.$set(k)},i(b){l||(T(t),T(o.$$.fragment,b),l=!0)},o(b){A(t),A(o.$$.fragment,b),l=!1},d(b){b&&(R(n),R(i)),h[e].d(b),N(o)}}}function Vo(r,e,t){let n,i,o;ve(r,re,y=>t(1,i=y)),ve(r,rn,y=>t(4,o=y));let a=null,l=null;ht(()=>{l==null||l.tearDown()});function s(){a&&(t(2,l=new io(a)),i.summary.polygon?l.editExisting(i.summary.polygon):l.startNew(),l.addEventListenerSuccess(async y=>{t(2,l=null),Ne(re,i.summary.polygon=y,i)}),l.addEventListenerFailure(()=>{t(2,l=null)}))}function h(){Ne(re,i.summary.polygon=null,i),s()}const g=()=>l==null?void 0:l.finish(),v=()=>l==null?void 0:l.cancel(),P=()=>l==null?void 0:l.undo();function b(y){a=y,t(0,a)}return r.$$.update=()=>{r.$$.dirty&2&&t(3,n=i.summary.polygon??{type:"FeatureCollection",features:[]}),r.$$.dirty&1&&a&&s()},[a,i,l,n,o,s,h,g,v,P,b]}class Wo extends Fe{constructor(e){super(),Te(this,e,Vo,Ko,Me,{})}}function Qo(r){let e,t,n,i,o,a,l,s,h,g,v,P,b,y,C,k,F,u,c,d,p,M,S,L,E,B,f,_,O,Y,K,$,ne,V,Ae,ce,W,ee,ze,fe,Be,ae,se,xe="Network context",Re,Se,Ie=`Please add a drawing of the area being assessed below, including the location
  of measures proposed by the scheme.`,Oe,w,H;function ke(m){r[1](m)}let me={label:"Date of design review"};r[0].summary.dateDesignReview!==void 0&&(me.value=r[0].summary.dateDesignReview),e=new et({props:me}),Q.push(()=>j(e,"value",ke));function he(m){r[2](m)}let be={label:"Scheme reference"};r[0].summary.schemeReference!==void 0&&(be.value=r[0].summary.schemeReference),i=new et({props:be}),Q.push(()=>j(i,"value",he));function ct(m){r[3](m)}let Ht={label:"Scheme name"};r[0].summary.schemeName!==void 0&&(Ht.value=r[0].summary.schemeName),l=new et({props:Ht}),Q.push(()=>j(l,"value",ct));function an(m){r[4](m)}let Jt={label:"Scheme summary"};r[0].summary.schemeSummary!==void 0&&(Jt.value=r[0].summary.schemeSummary),g=new mt({props:Jt}),Q.push(()=>j(g,"value",an));function ln(m){r[5](m)}let Ut={label:"Scheme information reviewed"};r[0].summary.schemeInfoReviewed!==void 0&&(Ut.value=r[0].summary.schemeInfoReviewed),b=new mt({props:Ut}),Q.push(()=>j(b,"value",ln));function sn(m){r[6](m)}let Zt={label:"Authority",emptyOption:!0,choices:je(Rn)};r[0].summary.authority!==void 0&&(Zt.value=r[0].summary.authority),k=new $e({props:Zt}),Q.push(()=>j(k,"value",sn));function un(m){r[7](m)}let Kt={label:"Transport / Combined Authority",emptyOption:!0,choices:je(In)};r[0].summary.transportOrCombinedAuthority!==void 0&&(Kt.value=r[0].summary.transportOrCombinedAuthority),c=new $e({props:Kt}),Q.push(()=>j(c,"value",un));function fn(m){r[8](m)}let Vt={label:"Region",emptyOption:!0,choices:je(On)};r[0].summary.region!==void 0&&(Vt.value=r[0].summary.region),M=new $e({props:Vt}),Q.push(()=>j(M,"value",fn));function cn(m){r[9](m)}let Wt={label:"Funding programme",emptyOption:!0,choices:je(qn)};r[0].summary.fundingProgramme!==void 0&&(Wt.value=r[0].summary.fundingProgramme),E=new $e({props:Wt}),Q.push(()=>j(E,"value",cn));function mn(m){r[10](m)}let Qt={label:"Design stage",emptyOption:!0,choices:je(Dn)};r[0].summary.designStage!==void 0&&(Qt.value=r[0].summary.designStage),_=new $e({props:Qt}),Q.push(()=>j(_,"value",mn));function hn(m){r[11](m)}let xt={label:"Funding conditions"};r[0].summary.fundingConditions!==void 0&&(xt.value=r[0].summary.fundingConditions),K=new mt({props:xt}),Q.push(()=>j(K,"value",hn));function vn(m){r[12](m)}let jt={label:"Inspector email address"};r[0].summary.inspectorEmail!==void 0&&(jt.value=r[0].summary.inspectorEmail),V=new et({props:jt}),Q.push(()=>j(V,"value",vn));function dn(m){r[13](m)}let $t={label:"Scheme area size (km)"};r[0].summary.schemeAreaSizeKm2!==void 0&&($t.value=r[0].summary.schemeAreaSizeKm2),W=new et({props:$t}),Q.push(()=>j(W,"value",dn));function gn(m){r[14](m)}let er={label:"Notes"};return r[0].summary.notes!==void 0&&(er.value=r[0].summary.notes),fe=new mt({props:er}),Q.push(()=>j(fe,"value",gn)),w=new Wo({}),{c(){q(e.$$.fragment),n=J(),q(i.$$.fragment),a=J(),q(l.$$.fragment),h=J(),q(g.$$.fragment),P=J(),q(b.$$.fragment),C=J(),q(k.$$.fragment),u=J(),q(c.$$.fragment),p=J(),q(M.$$.fragment),L=J(),q(E.$$.fragment),f=J(),q(_.$$.fragment),Y=J(),q(K.$$.fragment),ne=J(),q(V.$$.fragment),ce=J(),q(W.$$.fragment),ze=J(),q(fe.$$.fragment),ae=J(),se=Ye("h2"),se.textContent=xe,Re=J(),Se=Ye("p"),Se.textContent=Ie,Oe=J(),q(w.$$.fragment)},l(m){D(e.$$.fragment,m),n=U(m),D(i.$$.fragment,m),a=U(m),D(l.$$.fragment,m),h=U(m),D(g.$$.fragment,m),P=U(m),D(b.$$.fragment,m),C=U(m),D(k.$$.fragment,m),u=U(m),D(c.$$.fragment,m),p=U(m),D(M.$$.fragment,m),L=U(m),D(E.$$.fragment,m),f=U(m),D(_.$$.fragment,m),Y=U(m),D(K.$$.fragment,m),ne=U(m),D(V.$$.fragment,m),ce=U(m),D(W.$$.fragment,m),ze=U(m),D(fe.$$.fragment,m),ae=U(m),se=Ge(m,"H2",{"data-svelte-h":!0}),Lt(se)!=="svelte-1tcb68x"&&(se.textContent=xe),Re=U(m),Se=Ge(m,"P",{"data-svelte-h":!0}),Lt(Se)!=="svelte-1unchfe"&&(Se.textContent=Ie),Oe=U(m),D(w.$$.fragment,m)},m(m,z){X(e,m,z),I(m,n,z),X(i,m,z),I(m,a,z),X(l,m,z),I(m,h,z),X(g,m,z),I(m,P,z),X(b,m,z),I(m,C,z),X(k,m,z),I(m,u,z),X(c,m,z),I(m,p,z),X(M,m,z),I(m,L,z),X(E,m,z),I(m,f,z),X(_,m,z),I(m,Y,z),X(K,m,z),I(m,ne,z),X(V,m,z),I(m,ce,z),X(W,m,z),I(m,ze,z),X(fe,m,z),I(m,ae,z),I(m,se,z),I(m,Re,z),I(m,Se,z),I(m,Oe,z),X(w,m,z),H=!0},p(m,[z]){const tr={};!t&&z&1&&(t=!0,tr.value=m[0].summary.dateDesignReview,x(()=>t=!1)),e.$set(tr);const rr={};!o&&z&1&&(o=!0,rr.value=m[0].summary.schemeReference,x(()=>o=!1)),i.$set(rr);const nr={};!s&&z&1&&(s=!0,nr.value=m[0].summary.schemeName,x(()=>s=!1)),l.$set(nr);const ir={};!v&&z&1&&(v=!0,ir.value=m[0].summary.schemeSummary,x(()=>v=!1)),g.$set(ir);const or={};!y&&z&1&&(y=!0,or.value=m[0].summary.schemeInfoReviewed,x(()=>y=!1)),b.$set(or);const ar={};!F&&z&1&&(F=!0,ar.value=m[0].summary.authority,x(()=>F=!1)),k.$set(ar);const lr={};!d&&z&1&&(d=!0,lr.value=m[0].summary.transportOrCombinedAuthority,x(()=>d=!1)),c.$set(lr);const sr={};!S&&z&1&&(S=!0,sr.value=m[0].summary.region,x(()=>S=!1)),M.$set(sr);const ur={};!B&&z&1&&(B=!0,ur.value=m[0].summary.fundingProgramme,x(()=>B=!1)),E.$set(ur);const fr={};!O&&z&1&&(O=!0,fr.value=m[0].summary.designStage,x(()=>O=!1)),_.$set(fr);const cr={};!$&&z&1&&($=!0,cr.value=m[0].summary.fundingConditions,x(()=>$=!1)),K.$set(cr);const mr={};!Ae&&z&1&&(Ae=!0,mr.value=m[0].summary.inspectorEmail,x(()=>Ae=!1)),V.$set(mr);const hr={};!ee&&z&1&&(ee=!0,hr.value=m[0].summary.schemeAreaSizeKm2,x(()=>ee=!1)),W.$set(hr);const vr={};!Be&&z&1&&(Be=!0,vr.value=m[0].summary.notes,x(()=>Be=!1)),fe.$set(vr)},i(m){H||(T(e.$$.fragment,m),T(i.$$.fragment,m),T(l.$$.fragment,m),T(g.$$.fragment,m),T(b.$$.fragment,m),T(k.$$.fragment,m),T(c.$$.fragment,m),T(M.$$.fragment,m),T(E.$$.fragment,m),T(_.$$.fragment,m),T(K.$$.fragment,m),T(V.$$.fragment,m),T(W.$$.fragment,m),T(fe.$$.fragment,m),T(w.$$.fragment,m),H=!0)},o(m){A(e.$$.fragment,m),A(i.$$.fragment,m),A(l.$$.fragment,m),A(g.$$.fragment,m),A(b.$$.fragment,m),A(k.$$.fragment,m),A(c.$$.fragment,m),A(M.$$.fragment,m),A(E.$$.fragment,m),A(_.$$.fragment,m),A(K.$$.fragment,m),A(V.$$.fragment,m),A(W.$$.fragment,m),A(fe.$$.fragment,m),A(w.$$.fragment,m),H=!1},d(m){m&&(R(n),R(a),R(h),R(P),R(C),R(u),R(p),R(L),R(f),R(Y),R(ne),R(ce),R(ze),R(ae),R(se),R(Re),R(Se),R(Oe)),N(e,m),N(i,m),N(l,m),N(g,m),N(b,m),N(k,m),N(c,m),N(M,m),N(E,m),N(_,m),N(K,m),N(V,m),N(W,m),N(fe,m),N(w,m)}}}function xo(r,e,t){let n;ve(r,re,u=>t(0,n=u));function i(u){r.$$.not_equal(n.summary.dateDesignReview,u)&&(n.summary.dateDesignReview=u,re.set(n))}function o(u){r.$$.not_equal(n.summary.schemeReference,u)&&(n.summary.schemeReference=u,re.set(n))}function a(u){r.$$.not_equal(n.summary.schemeName,u)&&(n.summary.schemeName=u,re.set(n))}function l(u){r.$$.not_equal(n.summary.schemeSummary,u)&&(n.summary.schemeSummary=u,re.set(n))}function s(u){r.$$.not_equal(n.summary.schemeInfoReviewed,u)&&(n.summary.schemeInfoReviewed=u,re.set(n))}function h(u){r.$$.not_equal(n.summary.authority,u)&&(n.summary.authority=u,re.set(n))}function g(u){r.$$.not_equal(n.summary.transportOrCombinedAuthority,u)&&(n.summary.transportOrCombinedAuthority=u,re.set(n))}function v(u){r.$$.not_equal(n.summary.region,u)&&(n.summary.region=u,re.set(n))}function P(u){r.$$.not_equal(n.summary.fundingProgramme,u)&&(n.summary.fundingProgramme=u,re.set(n))}function b(u){r.$$.not_equal(n.summary.designStage,u)&&(n.summary.designStage=u,re.set(n))}function y(u){r.$$.not_equal(n.summary.fundingConditions,u)&&(n.summary.fundingConditions=u,re.set(n))}function C(u){r.$$.not_equal(n.summary.inspectorEmail,u)&&(n.summary.inspectorEmail=u,re.set(n))}function k(u){r.$$.not_equal(n.summary.schemeAreaSizeKm2,u)&&(n.summary.schemeAreaSizeKm2=u,re.set(n))}function F(u){r.$$.not_equal(n.summary.notes,u)&&(n.summary.notes=u,re.set(n))}return[n,i,o,a,l,s,h,g,v,P,b,y,C,k,F]}class ha extends Fe{constructor(e){super(),Te(this,e,xo,Qo,Me,{})}}export{ha as component};
