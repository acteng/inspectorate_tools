import{s as qt,p as K,e as I,a as v,t as de,c as H,x as le,g as $,b as he,d as ye,f as U,q as ge,i as ce,h as c,r as z,k as Tt,U as cr,w as St,A as pr,j as gr}from"../chunks/scheduler.MSc1Qx99.js";import{S as Ot,i as Gt,e as J,c as S,a as L,m as R,t as P,g as hr,b as C,f as dr,d as A}from"../chunks/index.BmLTtO3Q.js";import{p as Te}from"../chunks/index.DxRI_705.js";import{S as Ae}from"../chunks/Select.CWmhn8Ww.js";import{T as Be}from"../chunks/TextArea.ACtZc-6y.js";import{T as Ie}from"../chunks/TextInput.BuUbkcwy.js";import{s as N}from"../chunks/data.CKbaZ9pu.js";import{a as yr,t as vr,r as $r,f as _r,d as wr}from"../chunks/lists.Ci0sBo6t.js";import"../chunks/paths.D_hS_JDz.js";import{E as br}from"../chunks/ErrorMessage.QWb1lYlU.js";import{F as Pr}from"../chunks/FileInput.D4f6cZCf.js";import{W as Cr,S as Er}from"../chunks/WarningButton.B0B59q-T.js";import{E as kr}from"../chunks/ExternalLink.SLoj72IF.js";/* empty css                                                    */import{M as Mr,a as Sr,C as Lr,e as Rr}from"../chunks/index.CB3aLUeB.js";import{D as Lt}from"../chunks/DecimalInput.DNYz4VgO.js";function Rt(e){let t,r,n,i;return t=new Cr({props:{$$slots:{default:[Ar]},$$scope:{ctx:e}}}),t.$on("click",e[3]),n=new Er({props:{$$slots:{default:[Fr]},$$scope:{ctx:e}}}),n.$on("click",e[6]),{c(){S(t.$$.fragment),r=v(),S(n.$$.fragment)},l(a){L(t.$$.fragment,a),r=$(a),L(n.$$.fragment,a)},m(a,u){R(t,a,u),ce(a,r,u),R(n,a,u),i=!0},p(a,u){const l={};u&256&&(l.$$scope={dirty:u,ctx:a}),t.$set(l);const o={};u&256&&(o.$$scope={dirty:u,ctx:a}),n.$set(o)},i(a){i||(P(t.$$.fragment,a),P(n.$$.fragment,a),i=!0)},o(a){C(t.$$.fragment,a),C(n.$$.fragment,a),i=!1},d(a){a&&U(r),A(t,a),A(n,a)}}}function Ar(e){let t;return{c(){t=de("Clear map")},l(r){t=ye(r,"Clear map")},m(r,n){ce(r,t,n)},d(r){r&&U(t)}}}function Fr(e){let t;return{c(){t=de("Zoom to fit")},l(r){t=ye(r,"Zoom to fit")},m(r,n){ce(r,t,n)},d(r){r&&U(t)}}}function qr(e){let t;return{c(){t=de("Scheme Sketcher")},l(r){t=ye(r,"Scheme Sketcher")},m(r,n){ce(r,t,n)},d(r){r&&U(t)}}}function Tr(e){let t,r;return t=new Lr({props:{gj:e[2].summary.networkMap,show:!0}}),{c(){S(t.$$.fragment)},l(n){L(t.$$.fragment,n)},m(n,i){R(t,n,i),r=!0},p(n,i){const a={};i&4&&(a.gj=n[2].summary.networkMap),t.$set(a)},i(n){r||(P(t.$$.fragment,n),r=!0)},o(n){C(t.$$.fragment,n),r=!1},d(n){A(t,n)}}}function Or(e){let t,r="Network Map",n,i,a,u,l=`Please add a map showing the section of route being scored in this file.
      If the route is part of a longer route of multiple sections (covered in
      other files), please show this on the map for context too.`,o,g,E,p,M,F,d,W="You can use the external Scheme Sketcher tool to draw this map:",ee,h,x,O,b,B,m,G,ue="Choose the area best covering this scheme",$e,Y,ke=`Use the <i>New route</i>
        tool to sketch the route. It can contain segments snapped to existing roads
        or free-hand segments.`,_e,Z,Me=`Optionally, use the <i>Split route</i>
        tool to denote just the sections assessed in this file.`,we,Q,Se=`You can set <i>Name</i>
        and
        <i>Description</i>
        to whatever is useful for display on the map`,be,X,Le=`Save the map by clicking <i>Manage files</i>
        , then
        <i>Save</i>`,Pe,ie,re="Load the saved file above",Ce,ae,D,Ee,pe;g=new Pr({props:{label:"Import from GeoJSON file",onLoad:e[4]}}),p=new br({props:{errorMessage:e[1]}});let _=e[2].summary.networkMap.features.length>0&&Rt(e);b=new kr({props:{href:"https://acteng.github.io/atip",$$slots:{default:[qr]},$$scope:{ctx:e}}});function qe(y){e[7](y)}let Re={$$slots:{default:[Tr]},$$scope:{ctx:e}};return e[0]!==void 0&&(Re.map=e[0]),D=new Mr({props:Re}),K.push(()=>J(D,"map",qe)),{c(){t=I("h2"),t.textContent=r,n=v(),i=I("div"),a=I("div"),u=I("p"),u.textContent=l,o=v(),S(g.$$.fragment),E=v(),S(p.$$.fragment),M=v(),_&&_.c(),F=v(),d=I("p"),d.textContent=W,ee=v(),h=I("ol"),x=I("li"),O=de("Go to the "),S(b.$$.fragment),B=de(" tool"),m=v(),G=I("li"),G.textContent=ue,$e=v(),Y=I("li"),Y.innerHTML=ke,_e=v(),Z=I("li"),Z.innerHTML=Me,we=v(),Q=I("li"),Q.innerHTML=Se,be=v(),X=I("li"),X.innerHTML=Le,Pe=v(),ie=I("li"),ie.textContent=re,Ce=v(),ae=I("div"),S(D.$$.fragment),this.h()},l(y){t=H(y,"H2",{"data-svelte-h":!0}),le(t)!=="svelte-1fkh1ci"&&(t.textContent=r),n=$(y),i=H(y,"DIV",{style:!0});var q=he(i);a=H(q,"DIV",{style:!0});var k=he(a);u=H(k,"P",{"data-svelte-h":!0}),le(u)!=="svelte-1r7hkzo"&&(u.textContent=l),o=$(k),L(g.$$.fragment,k),E=$(k),L(p.$$.fragment,k),M=$(k),_&&_.l(k),F=$(k),d=H(k,"P",{"data-svelte-h":!0}),le(d)!=="svelte-1els6f1"&&(d.textContent=W),ee=$(k),h=H(k,"OL",{});var T=he(h);x=H(T,"LI",{});var ne=he(x);O=ye(ne,"Go to the "),L(b.$$.fragment,ne),B=ye(ne," tool"),ne.forEach(U),m=$(T),G=H(T,"LI",{"data-svelte-h":!0}),le(G)!=="svelte-aj705b"&&(G.textContent=ue),$e=$(T),Y=H(T,"LI",{"data-svelte-h":!0}),le(Y)!=="svelte-1vb2muj"&&(Y.innerHTML=ke),_e=$(T),Z=H(T,"LI",{"data-svelte-h":!0}),le(Z)!=="svelte-3xdyru"&&(Z.innerHTML=Me),we=$(T),Q=H(T,"LI",{"data-svelte-h":!0}),le(Q)!=="svelte-1r1ljcj"&&(Q.innerHTML=Se),be=$(T),X=H(T,"LI",{"data-svelte-h":!0}),le(X)!=="svelte-sz4wlr"&&(X.innerHTML=Le),Pe=$(T),ie=H(T,"LI",{"data-svelte-h":!0}),le(ie)!=="svelte-x3zkxb"&&(ie.textContent=re),T.forEach(U),k.forEach(U),Ce=$(q),ae=H(q,"DIV",{style:!0});var oe=he(ae);L(D.$$.fragment,oe),oe.forEach(U),q.forEach(U),this.h()},h(){ge(a,"width","30%"),ge(a,"overflow-y","scroll"),ge(a,"padding","10px"),ge(a,"border","1px solid black"),ge(ae,"position","relative"),ge(ae,"width","70%"),ge(i,"display","flex"),ge(i,"height","80vh")},m(y,q){ce(y,t,q),ce(y,n,q),ce(y,i,q),c(i,a),c(a,u),c(a,o),R(g,a,null),c(a,E),R(p,a,null),c(a,M),_&&_.m(a,null),c(a,F),c(a,d),c(a,ee),c(a,h),c(h,x),c(x,O),R(b,x,null),c(x,B),c(h,m),c(h,G),c(h,$e),c(h,Y),c(h,_e),c(h,Z),c(h,we),c(h,Q),c(h,be),c(h,X),c(h,Pe),c(h,ie),c(i,Ce),c(i,ae),R(D,ae,null),pe=!0},p(y,[q]){const k={};q&2&&(k.errorMessage=y[1]),p.$set(k),y[2].summary.networkMap.features.length>0?_?(_.p(y,q),q&4&&P(_,1)):(_=Rt(y),_.c(),P(_,1),_.m(a,F)):_&&(hr(),C(_,1,1,()=>{_=null}),dr());const T={};q&256&&(T.$$scope={dirty:q,ctx:y}),b.$set(T);const ne={};q&260&&(ne.$$scope={dirty:q,ctx:y}),!Ee&&q&1&&(Ee=!0,ne.map=y[0],z(()=>Ee=!1)),D.$set(ne)},i(y){pe||(P(g.$$.fragment,y),P(p.$$.fragment,y),P(_),P(b.$$.fragment,y),P(D.$$.fragment,y),pe=!0)},o(y){C(g.$$.fragment,y),C(p.$$.fragment,y),C(_),C(b.$$.fragment,y),C(D.$$.fragment,y),pe=!1},d(y){y&&(U(t),U(n),U(i)),A(g),A(p),_&&_.d(),A(b),A(D)}}}function Gr(e,t,r){let n;Tt(e,N,p=>r(2,n=p));let i,a="";cr(()=>{o(!1)});function u(){window.confirm("Do you really want to erase the map data?")&&St(N,n.summary.networkMap={type:"FeatureCollection",features:[]},n)}function l(p,M){var F;r(1,a="");try{let d=JSON.parse(M);if(d.type!="FeatureCollection")throw new Error("This doesn't look like a GeoJSON file");if(!((F=d.origin)!=null&&F.startsWith("atip-")))throw new Error("This file wasn't produced with the Scheme Sketcher");if(d.crs)throw new Error("This file has a Coordinate Reference System set; it's not suitable for a web map");St(N,n.summary.networkMap=d,n),o(!0)}catch(d){r(1,a=`Error importing ${p}: ${d}`)}}function o(p){let M={type:"FeatureCollection",features:n.summary.networkMap.features};M.features.length>0&&i.fitBounds(Sr(M),{padding:20,animate:p})}const g=()=>o(!0);function E(p){i=p,r(0,i)}return[i,a,n,u,l,o,g,E]}class Nr extends Ot{constructor(t){super(),Gt(this,t,Gr,Or,qt,{})}}var Dr=Object.defineProperty,w=(e,t)=>Dr(e,"name",{value:t,configurable:!0}),Br=class{constructor(t){this.direction=!1,this.compareProperties=!0;var r,n,i;this.precision=10**-((r=t==null?void 0:t.precision)!=null?r:17),this.direction=(n=t==null?void 0:t.direction)!=null?n:!1,this.compareProperties=(i=t==null?void 0:t.compareProperties)!=null?i:!0}compare(t,r){if(t.type!==r.type||!Oe(t,r))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,r.coordinates);case"LineString":return this.compareLine(t.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(t,r);case"GeometryCollection":return this.compareGeometryCollection(t,r);case"Feature":return this.compareFeature(t,r);case"FeatureCollection":return this.compareFeatureCollection(t,r);default:if(t.type.startsWith("Multi")){const n=Ke(t),i=Ke(r);return n.every(a=>i.some(u=>this.compare(a,u)))}}return!1}compareCoord(t,r){return t.length===r.length&&t.every((n,i)=>Math.abs(n-r[i])<this.precision)}compareLine(t,r,n=0,i=!1){if(!Oe(t,r))return!1;const a=t;let u=r;if(i&&!this.compareCoord(a[0],u[0])){const o=this.fixStartIndex(u,a);if(o)u=o;else return!1}const l=this.compareCoord(a[n],u[n]);return this.direction||l?this.comparePath(a,u):this.compareCoord(a[n],u[u.length-(1+n)])?this.comparePath(a.slice().reverse(),u):!1}fixStartIndex(t,r){let n,i=-1;for(let a=0;a<t.length;a++)if(this.compareCoord(t[a],r[0])){i=a;break}return i>=0&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n}comparePath(t,r){return t.every((n,i)=>this.compareCoord(n,r[i]))}comparePolygon(t,r){if(this.compareLine(t.coordinates[0],r.coordinates[0],1,!0)){const n=t.coordinates.slice(1,t.coordinates.length),i=r.coordinates.slice(1,r.coordinates.length);return n.every(a=>i.some(u=>this.compareLine(a,u,1,!0)))}return!1}compareGeometryCollection(t,r){return Oe(t.geometries,r.geometries)&&this.compareBBox(t,r)&&t.geometries.every((n,i)=>this.compare(n,r.geometries[i]))}compareFeature(t,r){return t.id===r.id&&(this.compareProperties?Rr(t.properties,r.properties):!0)&&this.compareBBox(t,r)&&this.compare(t.geometry,r.geometry)}compareFeatureCollection(t,r){return Oe(t.features,r.features)&&this.compareBBox(t,r)&&t.features.every((n,i)=>this.compare(n,r.features[i]))}compareBBox(t,r){return!t.bbox&&!r.bbox||(t.bbox&&r.bbox?this.compareCoord(t.bbox,r.bbox):!1)}};w(Br,"GeojsonEquality");function Oe(e,t){return e.coordinates?e.coordinates.length===t.coordinates.length:e.length===t.length}w(Oe,"sameLength");function Ke(e){return e.coordinates.map(t=>({type:e.type.replace("Multi",""),coordinates:t}))}w(Ke,"explode");var te=63710088e-1,Nt={centimeters:te*100,centimetres:te*100,degrees:360/(2*Math.PI),feet:te*3.28084,inches:te*39.37,kilometers:te/1e3,kilometres:te/1e3,meters:te,metres:te,miles:te/1609.344,millimeters:te*1e3,millimetres:te*1e3,nauticalmiles:te/1852,radians:1,yards:te*1.0936},At={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function se(e,t,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}w(se,"feature");function Ir(e,t,r={}){switch(e){case"Point":return me(t).geometry;case"LineString":return fe(t).geometry;case"Polygon":return Je(t).geometry;case"MultiPoint":return Bt(t).geometry;case"MultiLineString":return Dt(t).geometry;case"MultiPolygon":return It(t).geometry;default:throw new Error(e+" is invalid")}}w(Ir,"geometry");function me(e,t,r={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Fe(e[0])||!Fe(e[1]))throw new Error("coordinates must contain numbers");return se({type:"Point",coordinates:e},t,r)}w(me,"point");function Hr(e,t,r={}){return He(e.map(n=>me(n,t)),r)}w(Hr,"points");function Je(e,t,r={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return se({type:"Polygon",coordinates:e},t,r)}w(Je,"polygon");function xr(e,t,r={}){return He(e.map(n=>Je(n,t)),r)}w(xr,"polygons");function fe(e,t,r={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return se({type:"LineString",coordinates:e},t,r)}w(fe,"lineString");function Kr(e,t,r={}){return He(e.map(n=>fe(n,t)),r)}w(Kr,"lineStrings");function He(e,t={}){const r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}w(He,"featureCollection");function Dt(e,t,r={}){return se({type:"MultiLineString",coordinates:e},t,r)}w(Dt,"multiLineString");function Bt(e,t,r={}){return se({type:"MultiPoint",coordinates:e},t,r)}w(Bt,"multiPoint");function It(e,t,r={}){return se({type:"MultiPolygon",coordinates:e},t,r)}w(It,"multiPolygon");function zr(e,t,r={}){return se({type:"GeometryCollection",geometries:e},t,r)}w(zr,"geometryCollection");function Jr(e,t=0){if(t&&!(t>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,t||0);return Math.round(e*r)/r}w(Jr,"round");function Ue(e,t="kilometers"){const r=Nt[t];if(!r)throw new Error(t+" units is invalid");return e*r}w(Ue,"radiansToLength");function Ve(e,t="kilometers"){const r=Nt[t];if(!r)throw new Error(t+" units is invalid");return e/r}w(Ve,"lengthToRadians");function Ur(e,t){return Ht(Ve(e,t))}w(Ur,"lengthToDegrees");function Vr(e){let t=e%360;return t<0&&(t+=360),t}w(Vr,"bearingToAzimuth");function Ht(e){return e%(2*Math.PI)*180/Math.PI}w(Ht,"radiansToDegrees");function Ge(e){return e%360*Math.PI/180}w(Ge,"degreesToRadians");function Wr(e,t="kilometers",r="kilometers"){if(!(e>=0))throw new Error("length must be a positive number");return Ue(Ve(e,t),r)}w(Wr,"convertLength");function Yr(e,t="meters",r="kilometers"){if(!(e>=0))throw new Error("area must be a positive number");const n=At[t];if(!n)throw new Error("invalid original units");const i=At[r];if(!i)throw new Error("invalid final units");return e/n*i}w(Yr,"convertArea");function Fe(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}w(Fe,"isNumber");function We(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}w(We,"isObject");function Zr(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(t=>{if(!Fe(t))throw new Error("bbox must only contain numbers")})}w(Zr,"validateBBox");function Qr(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}w(Qr,"validateId");var Xr=Object.defineProperty,ve=(e,t)=>Xr(e,"name",{value:t,configurable:!0});function ze(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}ve(ze,"getCoord");function jr(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}ve(jr,"getCoords");function xt(e){if(e.length>1&&Fe(e[0])&&Fe(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return xt(e[0]);throw new Error("coordinates must only contain numbers")}ve(xt,"containsNumber");function en(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}ve(en,"geojsonType");function tn(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}ve(tn,"featureOf");function rn(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of e.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+n.geometry.type)}}ve(rn,"collectionOf");function nn(e){return e.type==="Feature"?e.geometry:e}ve(nn,"getGeom");function an(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}ve(an,"getType");var on=Object.defineProperty,sn=(e,t)=>on(e,"name",{value:t,configurable:!0});function Kt(e,t,r={}){var n=ze(e),i=ze(t),a=Ge(i[1]-n[1]),u=Ge(i[0]-n[0]),l=Ge(n[1]),o=Ge(i[1]),g=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(o);return Ue(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)),r.units)}sn(Kt,"distance");var un=Object.defineProperty,V=(e,t)=>un(e,"name",{value:t,configurable:!0});function Ne(e,t,r){if(e!==null)for(var n,i,a,u,l,o,g,E=0,p=0,M,F=e.type,d=F==="FeatureCollection",W=F==="Feature",ee=d?e.features.length:1,h=0;h<ee;h++){g=d?e.features[h].geometry:W?e.geometry:e,M=g?g.type==="GeometryCollection":!1,l=M?g.geometries.length:1;for(var x=0;x<l;x++){var O=0,b=0;if(u=M?g.geometries[x]:g,u!==null){o=u.coordinates;var B=u.type;switch(E=r&&(B==="Polygon"||B==="MultiPolygon")?1:0,B){case null:break;case"Point":if(t(o,p,h,O,b)===!1)return!1;p++,O++;break;case"LineString":case"MultiPoint":for(n=0;n<o.length;n++){if(t(o[n],p,h,O,b)===!1)return!1;p++,B==="MultiPoint"&&O++}B==="LineString"&&O++;break;case"Polygon":case"MultiLineString":for(n=0;n<o.length;n++){for(i=0;i<o[n].length-E;i++){if(t(o[n][i],p,h,O,b)===!1)return!1;p++}B==="MultiLineString"&&O++,B==="Polygon"&&b++}B==="Polygon"&&O++;break;case"MultiPolygon":for(n=0;n<o.length;n++){for(b=0,i=0;i<o[n].length;i++){for(a=0;a<o[n][i].length-E;a++){if(t(o[n][i][a],p,h,O,b)===!1)return!1;p++}b++}O++}break;case"GeometryCollection":for(n=0;n<u.geometries.length;n++)if(Ne(u.geometries[n],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}V(Ne,"coordEach");function ln(e,t,r,n){var i=r;return Ne(e,function(a,u,l,o,g){u===0&&r===void 0?i=a:i=t(i,a,u,l,o,g)},n),i}V(ln,"coordReduce");function zt(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&t(e.features[r].properties,r)!==!1;r++);break;case"Feature":t(e.properties,0);break}}V(zt,"propEach");function mn(e,t,r){var n=r;return zt(e,function(i,a){a===0&&r===void 0?n=i:n=t(n,i,a)}),n}V(mn,"propReduce");function Jt(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var r=0;r<e.features.length&&t(e.features[r],r)!==!1;r++);}V(Jt,"featureEach");function fn(e,t,r){var n=r;return Jt(e,function(i,a){a===0&&r===void 0?n=i:n=t(n,i,a)}),n}V(fn,"featureReduce");function cn(e){var t=[];return Ne(e,function(r){t.push(r)}),t}V(cn,"coordAll");function Ye(e,t){var r,n,i,a,u,l,o,g,E,p,M=0,F=e.type==="FeatureCollection",d=e.type==="Feature",W=F?e.features.length:1;for(r=0;r<W;r++){for(l=F?e.features[r].geometry:d?e.geometry:e,g=F?e.features[r].properties:d?e.properties:{},E=F?e.features[r].bbox:d?e.bbox:void 0,p=F?e.features[r].id:d?e.id:void 0,o=l?l.type==="GeometryCollection":!1,u=o?l.geometries.length:1,i=0;i<u;i++){if(a=o?l.geometries[i]:l,a===null){if(t(null,M,g,E,p)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,M,g,E,p)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],M,g,E,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}M++}}V(Ye,"geomEach");function pn(e,t,r){var n=r;return Ye(e,function(i,a,u,l,o){a===0&&r===void 0?n=i:n=t(n,i,a,u,l,o)}),n}V(pn,"geomReduce");function xe(e,t){Ye(e,function(r,n,i,a,u){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return t(se(r,i,{bbox:a,id:u}),n,0)===!1?!1:void 0}var o;switch(l){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon";break}for(var g=0;g<r.coordinates.length;g++){var E=r.coordinates[g],p={type:o,coordinates:E};if(t(se(p,i),n,g)===!1)return!1}})}V(xe,"flattenEach");function gn(e,t,r){var n=r;return xe(e,function(i,a,u){a===0&&u===0&&r===void 0?n=i:n=t(n,i,a,u)}),n}V(gn,"flattenReduce");function Ut(e,t){xe(e,function(r,n,i){var a=0;if(r.geometry){var u=r.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var l,o=0,g=0,E=0;if(Ne(r,function(p,M,F,d,W){if(l===void 0||n>o||d>g||W>E){l=p,o=n,g=d,E=W,a=0;return}var ee=fe([l,p],r.properties);if(t(ee,n,i,W,a)===!1)return!1;a++,l=p})===!1)return!1}}})}V(Ut,"segmentEach");function Vt(e,t,r){var n=r,i=!1;return Ut(e,function(a,u,l,o,g){i===!1&&r===void 0?n=a:n=t(n,a,u,l,o,g),i=!0}),n}V(Vt,"segmentReduce");function Wt(e,t){if(!e)throw new Error("geojson is required");xe(e,function(r,n,i){if(r.geometry!==null){var a=r.geometry.type,u=r.geometry.coordinates;switch(a){case"LineString":if(t(r,n,i,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<u.length;l++)if(t(fe(u[l],r.properties),n,i,l)===!1)return!1;break}}})}V(Wt,"lineEach");function hn(e,t,r){var n=r;return Wt(e,function(i,a,u,l){a===0&&r===void 0?n=i:n=t(n,i,a,u,l)}),n}V(hn,"lineReduce");function dn(e,t){if(t=t||{},!We(t))throw new Error("options is invalid");var r=t.featureIndex||0,n=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.segmentIndex||0,u=t.properties,l;switch(e.type){case"FeatureCollection":r<0&&(r=e.features.length+r),u=u||e.features[r].properties,l=e.features[r].geometry;break;case"Feature":u=u||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var o=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=o.length+a-1),fe([o[a],o[a+1]],u,t);case"Polygon":return i<0&&(i=o.length+i),a<0&&(a=o[i].length+a-1),fe([o[i][a],o[i][a+1]],u,t);case"MultiLineString":return n<0&&(n=o.length+n),a<0&&(a=o[n].length+a-1),fe([o[n][a],o[n][a+1]],u,t);case"MultiPolygon":return n<0&&(n=o.length+n),i<0&&(i=o[n].length+i),a<0&&(a=o[n][i].length-a-1),fe([o[n][i][a],o[n][i][a+1]],u,t)}throw new Error("geojson is invalid")}V(dn,"findSegment");function yn(e,t){if(t=t||{},!We(t))throw new Error("options is invalid");var r=t.featureIndex||0,n=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.coordIndex||0,u=t.properties,l;switch(e.type){case"FeatureCollection":r<0&&(r=e.features.length+r),u=u||e.features[r].properties,l=e.features[r].geometry;break;case"Feature":u=u||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var o=l.coordinates;switch(l.type){case"Point":return me(o,u,t);case"MultiPoint":return n<0&&(n=o.length+n),me(o[n],u,t);case"LineString":return a<0&&(a=o.length+a),me(o[a],u,t);case"Polygon":return i<0&&(i=o.length+i),a<0&&(a=o[i].length+a),me(o[i][a],u,t);case"MultiLineString":return n<0&&(n=o.length+n),a<0&&(a=o[n].length+a),me(o[n][a],u,t);case"MultiPolygon":return n<0&&(n=o.length+n),i<0&&(i=o[n].length+i),a<0&&(a=o[n][i].length-a),me(o[n][i][a],u,t)}throw new Error("geojson is invalid")}V(yn,"findPoint");var vn=Object.defineProperty,$n=(e,t)=>vn(e,"name",{value:t,configurable:!0});function Yt(e,t={}){return Vt(e,(r,n)=>{const i=n.geometry.coordinates;return r+Kt(i[0],i[1],t)},0)}$n(Yt,"length");var _n=Yt;function Ft(e){let t,r,n,i=e[1].toFixed(2)+"",a,u;return{c(){t=I("p"),r=de("LineStrings in the Network Map cover a total of "),n=I("b"),a=de(i),u=de(`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`)},l(l){t=H(l,"P",{});var o=he(t);r=ye(o,"LineStrings in the Network Map cover a total of "),n=H(o,"B",{});var g=he(n);a=ye(g,i),g.forEach(U),u=ye(o,`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`),o.forEach(U)},m(l,o){ce(l,t,o),c(t,r),c(t,n),c(n,a),c(t,u)},p(l,o){o&2&&i!==(i=l[1].toFixed(2)+"")&&gr(a,i)},d(l){l&&U(t)}}}function wn(e){let t,r,n,i,a,u,l,o,g,E,p,M,F,d,W,ee,h,x,O,b,B,m,G,ue,$e,Y,ke,_e,Z,Me,we,Q,Se,be,X,Le,Pe,ie,re,Ce,ae,D,Ee,pe,_,qe,Re,y,q,k,T,ne,oe,De;function Zt(s){e[2](s)}let Ze={label:"Date of design review"};e[0].summary.dateDesignReview!==void 0&&(Ze.value=e[0].summary.dateDesignReview),r=new Ie({props:Ze}),K.push(()=>J(r,"value",Zt));function Qt(s){e[3](s)}let Qe={label:"Scheme reference"};e[0].summary.schemeReference!==void 0&&(Qe.value=e[0].summary.schemeReference),a=new Ie({props:Qe}),K.push(()=>J(a,"value",Qt));function Xt(s){e[4](s)}let Xe={label:"Scheme name"};e[0].summary.schemeName!==void 0&&(Xe.value=e[0].summary.schemeName),o=new Ie({props:Xe}),K.push(()=>J(o,"value",Xt));function jt(s){e[5](s)}let je={label:"Scheme summary"};e[0].summary.schemeSummary!==void 0&&(je.value=e[0].summary.schemeSummary),p=new Be({props:je}),K.push(()=>J(p,"value",jt));function er(s){e[6](s)}let et={label:"Scheme information reviewed"};e[0].summary.schemeInfoReviewed!==void 0&&(et.value=e[0].summary.schemeInfoReviewed),d=new Be({props:et}),K.push(()=>J(d,"value",er));function tr(s){e[7](s)}let tt={label:"Authority",emptyOption:!0,choices:Te(yr)};e[0].summary.authority!==void 0&&(tt.value=e[0].summary.authority),h=new Ae({props:tt}),K.push(()=>J(h,"value",tr));function rr(s){e[8](s)}let rt={label:"Transport / Combined Authority",emptyOption:!0,choices:Te(vr)};e[0].summary.transportOrCombinedAuthority!==void 0&&(rt.value=e[0].summary.transportOrCombinedAuthority),b=new Ae({props:rt}),K.push(()=>J(b,"value",rr));function nr(s){e[9](s)}let nt={label:"Region",emptyOption:!0,choices:Te($r)};e[0].summary.region!==void 0&&(nt.value=e[0].summary.region),G=new Ae({props:nt}),K.push(()=>J(G,"value",nr));function ir(s){e[10](s)}let it={label:"Funding programme",emptyOption:!0,choices:Te(_r)};e[0].summary.fundingProgramme!==void 0&&(it.value=e[0].summary.fundingProgramme),Y=new Ae({props:it}),K.push(()=>J(Y,"value",ir));function ar(s){e[11](s)}let at={label:"Design stage",emptyOption:!0,choices:Te(wr)};e[0].summary.designStage!==void 0&&(at.value=e[0].summary.designStage),Z=new Ae({props:at}),K.push(()=>J(Z,"value",ar));function or(s){e[12](s)}let ot={label:"Funding conditions"};e[0].summary.fundingConditions!==void 0&&(ot.value=e[0].summary.fundingConditions),Q=new Be({props:ot}),K.push(()=>J(Q,"value",or));function sr(s){e[13](s)}let st={label:"Inspector email address"};e[0].summary.inspectorEmail!==void 0&&(st.value=e[0].summary.inspectorEmail),X=new Ie({props:st}),K.push(()=>J(X,"value",sr));let j=e[1]&&Ft(e);function ur(s){e[14](s)}let ut={label:"Route length assessed here (km)",width:6,min:0};e[0].summary.assessedRouteLengthKm!==void 0&&(ut.value=e[0].summary.assessedRouteLengthKm),re=new Lt({props:ut}),K.push(()=>J(re,"value",ur));function lr(s){e[15](s)}let lt={label:"Total route length (km)",width:6,min:0};e[0].summary.totalRouteLengthKm!==void 0&&(lt.value=e[0].summary.totalRouteLengthKm),D=new Lt({props:lt}),K.push(()=>J(D,"value",lr));function mr(s){e[16](s)}let mt={label:"Notes"};e[0].summary.notes!==void 0&&(mt.value=e[0].summary.notes),_=new Be({props:mt}),K.push(()=>J(_,"value",mr));function fr(s){e[17](s)}let ft={label:"Route Check Type (Street or Path)",hint:"What type of route is being reviewed: Street Check (e.g. on- or by-carriageway) or Path Check (e.g. a traffic-free path featuring minimal interactions with motor traffic)",emptyOption:!0,choices:[["street","Street Check"],["path","Path Check"]]};return e[0].summary.checkType!==void 0&&(ft.value=e[0].summary.checkType),k=new Ae({props:ft}),K.push(()=>J(k,"value",fr)),oe=new Nr({}),{c(){t=I("div"),S(r.$$.fragment),i=v(),S(a.$$.fragment),l=v(),S(o.$$.fragment),E=v(),S(p.$$.fragment),F=v(),S(d.$$.fragment),ee=v(),S(h.$$.fragment),O=v(),S(b.$$.fragment),m=v(),S(G.$$.fragment),$e=v(),S(Y.$$.fragment),_e=v(),S(Z.$$.fragment),we=v(),S(Q.$$.fragment),be=v(),S(X.$$.fragment),Pe=v(),j&&j.c(),ie=v(),S(re.$$.fragment),ae=v(),S(D.$$.fragment),pe=v(),S(_.$$.fragment),Re=v(),y=I("hr"),q=v(),S(k.$$.fragment),ne=v(),S(oe.$$.fragment),this.h()},l(s){t=H(s,"DIV",{class:!0});var f=he(t);L(r.$$.fragment,f),i=$(f),L(a.$$.fragment,f),l=$(f),L(o.$$.fragment,f),E=$(f),L(p.$$.fragment,f),F=$(f),L(d.$$.fragment,f),ee=$(f),L(h.$$.fragment,f),O=$(f),L(b.$$.fragment,f),m=$(f),L(G.$$.fragment,f),$e=$(f),L(Y.$$.fragment,f),_e=$(f),L(Z.$$.fragment,f),we=$(f),L(Q.$$.fragment,f),be=$(f),L(X.$$.fragment,f),Pe=$(f),j&&j.l(f),ie=$(f),L(re.$$.fragment,f),ae=$(f),L(D.$$.fragment,f),pe=$(f),L(_.$$.fragment,f),Re=$(f),y=H(f,"HR",{}),q=$(f),L(k.$$.fragment,f),ne=$(f),L(oe.$$.fragment,f),f.forEach(U),this.h()},h(){pr(t,"class","govuk-width-container")},m(s,f){ce(s,t,f),R(r,t,null),c(t,i),R(a,t,null),c(t,l),R(o,t,null),c(t,E),R(p,t,null),c(t,F),R(d,t,null),c(t,ee),R(h,t,null),c(t,O),R(b,t,null),c(t,m),R(G,t,null),c(t,$e),R(Y,t,null),c(t,_e),R(Z,t,null),c(t,we),R(Q,t,null),c(t,be),R(X,t,null),c(t,Pe),j&&j.m(t,null),c(t,ie),R(re,t,null),c(t,ae),R(D,t,null),c(t,pe),R(_,t,null),c(t,Re),c(t,y),c(t,q),R(k,t,null),c(t,ne),R(oe,t,null),De=!0},p(s,[f]){const ct={};!n&&f&1&&(n=!0,ct.value=s[0].summary.dateDesignReview,z(()=>n=!1)),r.$set(ct);const pt={};!u&&f&1&&(u=!0,pt.value=s[0].summary.schemeReference,z(()=>u=!1)),a.$set(pt);const gt={};!g&&f&1&&(g=!0,gt.value=s[0].summary.schemeName,z(()=>g=!1)),o.$set(gt);const ht={};!M&&f&1&&(M=!0,ht.value=s[0].summary.schemeSummary,z(()=>M=!1)),p.$set(ht);const dt={};!W&&f&1&&(W=!0,dt.value=s[0].summary.schemeInfoReviewed,z(()=>W=!1)),d.$set(dt);const yt={};!x&&f&1&&(x=!0,yt.value=s[0].summary.authority,z(()=>x=!1)),h.$set(yt);const vt={};!B&&f&1&&(B=!0,vt.value=s[0].summary.transportOrCombinedAuthority,z(()=>B=!1)),b.$set(vt);const $t={};!ue&&f&1&&(ue=!0,$t.value=s[0].summary.region,z(()=>ue=!1)),G.$set($t);const _t={};!ke&&f&1&&(ke=!0,_t.value=s[0].summary.fundingProgramme,z(()=>ke=!1)),Y.$set(_t);const wt={};!Me&&f&1&&(Me=!0,wt.value=s[0].summary.designStage,z(()=>Me=!1)),Z.$set(wt);const bt={};!Se&&f&1&&(Se=!0,bt.value=s[0].summary.fundingConditions,z(()=>Se=!1)),Q.$set(bt);const Pt={};!Le&&f&1&&(Le=!0,Pt.value=s[0].summary.inspectorEmail,z(()=>Le=!1)),X.$set(Pt),s[1]?j?j.p(s,f):(j=Ft(s),j.c(),j.m(t,ie)):j&&(j.d(1),j=null);const Ct={};!Ce&&f&1&&(Ce=!0,Ct.value=s[0].summary.assessedRouteLengthKm,z(()=>Ce=!1)),re.$set(Ct);const Et={};!Ee&&f&1&&(Ee=!0,Et.value=s[0].summary.totalRouteLengthKm,z(()=>Ee=!1)),D.$set(Et);const kt={};!qe&&f&1&&(qe=!0,kt.value=s[0].summary.notes,z(()=>qe=!1)),_.$set(kt);const Mt={};!T&&f&1&&(T=!0,Mt.value=s[0].summary.checkType,z(()=>T=!1)),k.$set(Mt)},i(s){De||(P(r.$$.fragment,s),P(a.$$.fragment,s),P(o.$$.fragment,s),P(p.$$.fragment,s),P(d.$$.fragment,s),P(h.$$.fragment,s),P(b.$$.fragment,s),P(G.$$.fragment,s),P(Y.$$.fragment,s),P(Z.$$.fragment,s),P(Q.$$.fragment,s),P(X.$$.fragment,s),P(re.$$.fragment,s),P(D.$$.fragment,s),P(_.$$.fragment,s),P(k.$$.fragment,s),P(oe.$$.fragment,s),De=!0)},o(s){C(r.$$.fragment,s),C(a.$$.fragment,s),C(o.$$.fragment,s),C(p.$$.fragment,s),C(d.$$.fragment,s),C(h.$$.fragment,s),C(b.$$.fragment,s),C(G.$$.fragment,s),C(Y.$$.fragment,s),C(Z.$$.fragment,s),C(Q.$$.fragment,s),C(X.$$.fragment,s),C(re.$$.fragment,s),C(D.$$.fragment,s),C(_.$$.fragment,s),C(k.$$.fragment,s),C(oe.$$.fragment,s),De=!1},d(s){s&&U(t),A(r),A(a),A(o),A(p),A(d),A(h),A(b),A(G),A(Y),A(Z),A(Q),A(X),j&&j.d(),A(re),A(D),A(_),A(k),A(oe)}}}function bn(e,t,r){let n,i;Tt(e,N,m=>r(0,i=m));function a(m){let G=0;for(let ue of m.features)ue.geometry.type=="LineString"&&(G+=_n(ue,{units:"kilometers"}));return G>0?G:null}function u(m){e.$$.not_equal(i.summary.dateDesignReview,m)&&(i.summary.dateDesignReview=m,N.set(i))}function l(m){e.$$.not_equal(i.summary.schemeReference,m)&&(i.summary.schemeReference=m,N.set(i))}function o(m){e.$$.not_equal(i.summary.schemeName,m)&&(i.summary.schemeName=m,N.set(i))}function g(m){e.$$.not_equal(i.summary.schemeSummary,m)&&(i.summary.schemeSummary=m,N.set(i))}function E(m){e.$$.not_equal(i.summary.schemeInfoReviewed,m)&&(i.summary.schemeInfoReviewed=m,N.set(i))}function p(m){e.$$.not_equal(i.summary.authority,m)&&(i.summary.authority=m,N.set(i))}function M(m){e.$$.not_equal(i.summary.transportOrCombinedAuthority,m)&&(i.summary.transportOrCombinedAuthority=m,N.set(i))}function F(m){e.$$.not_equal(i.summary.region,m)&&(i.summary.region=m,N.set(i))}function d(m){e.$$.not_equal(i.summary.fundingProgramme,m)&&(i.summary.fundingProgramme=m,N.set(i))}function W(m){e.$$.not_equal(i.summary.designStage,m)&&(i.summary.designStage=m,N.set(i))}function ee(m){e.$$.not_equal(i.summary.fundingConditions,m)&&(i.summary.fundingConditions=m,N.set(i))}function h(m){e.$$.not_equal(i.summary.inspectorEmail,m)&&(i.summary.inspectorEmail=m,N.set(i))}function x(m){e.$$.not_equal(i.summary.assessedRouteLengthKm,m)&&(i.summary.assessedRouteLengthKm=m,N.set(i))}function O(m){e.$$.not_equal(i.summary.totalRouteLengthKm,m)&&(i.summary.totalRouteLengthKm=m,N.set(i))}function b(m){e.$$.not_equal(i.summary.notes,m)&&(i.summary.notes=m,N.set(i))}function B(m){e.$$.not_equal(i.summary.checkType,m)&&(i.summary.checkType=m,N.set(i))}return e.$$.update=()=>{e.$$.dirty&1&&r(1,n=a(i.summary.networkMap))},[i,n,u,l,o,g,E,p,M,F,d,W,ee,h,x,O,b,B]}class In extends Ot{constructor(t){super(),Gt(this,t,bn,wn,qt,{})}}export{In as component};
