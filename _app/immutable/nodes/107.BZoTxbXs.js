import{s as Ie,w as Q,e as K,t as J,a as q,c as W,b as Z,d as X,f as h,g as A,p as U,q as H,i as L,h as B,x,k as Le,z as ze,R as He,W as be,T as Ee,E as me,m as ke,G as $e,j as ue,n as Ke,K as Ce,L as we}from"../chunks/scheduler.Dk-JDrYY.js";import{S as Se,i as Ne,e as ee,c as G,a as M,m as V,t as I,b as N,d as R,f as ce,g as pe}from"../chunks/index.CsRFimJs.js";import{s as ge,d as de,M as We,f as Ze,b as Ye,C as Je,G as Xe,h as Qe}from"../chunks/index.BoaCPR9V.js";import{e as oe}from"../chunks/each.CDGFUH-m.js";import{c as xe,p as et}from"../chunks/colors.DaC397qr.js";import{p as Me}from"../chunks/index.BSJeUgZ9.js";import{S as he}from"../chunks/Select.sDYZiyFV.js";/* empty css                                                               */import{T as Ve}from"../chunks/TextArea.CWcMMY8c.js";import{T as Re}from"../chunks/TextInput.D4Ne2cWG.js";import{s as Y}from"../chunks/data.ALZ3V6Te.js";import{c as tt,p as lt,b as nt,g as it}from"../chunks/lists.BBs_zCmn.js";import{Y as Fe}from"../chunks/YesNo.BVmLgmZs.js";import{B as ot,G as st,S as at,C as rt,a as ft,M as Oe}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.DsIIad6G.js";import{C as ut}from"../chunks/CollapsibleCard.CjD8ekrq.js";import{D as ct}from"../chunks/DefaultButton.CC-Pd1ev.js";import{R as pt}from"../chunks/Radio.DdII1WVx.js";import{S as _t}from"../chunks/SecondaryButton.8USQHego.js";import{W as mt}from"../chunks/WarningButton.DIgJP2sp.js";import{G as $t}from"../chunks/GeoreferenceLayer.Bgs6bEOy.js";import{C as Ue}from"../chunks/ClickableCard.CTSMXU-9.js";/* empty css                                                    */import"../chunks/paths.B8kBPPtB.js";function gt(t){let e,n,l,o,u,r,c,_,g,a,w,f,$,j,v,E,i,p,y,P,S,b,O,D;function se(s){t[2](s)}let m={label:"Critical Issue",emptyOption:!0,choices:tt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(m.value=t[1].criticalIssues[t[0]].criticalIssue),a=new he({props:m}),Q.push(()=>ee(a,"value",se));function k(s){t[3](s)}let z={label:"Stage",emptyOption:!0,choices:Me(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(z.value=t[1].criticalIssues[t[0]].stage),$=new he({props:z}),Q.push(()=>ee($,"value",k));function ie(s){t[4](s)}let T={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(T.value=t[1].criticalIssues[t[0]].locationName),E=new Re({props:T}),Q.push(()=>ee(E,"value",ie));function ne(s){t[5](s)}let ae={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(ae.value=t[1].criticalIssues[t[0]].resolved),y=new Fe({props:ae}),Q.push(()=>ee(y,"value",ne));function _e(s){t[6](s)}let re={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(re.value=t[1].criticalIssues[t[0]].notes),b=new Ve({props:re}),Q.push(()=>ee(b,"value",_e)),{c(){e=K("div"),n=K("a"),l=J("Google StreetView"),u=q(),r=K("a"),c=J("Bing Streetside"),g=q(),G(a.$$.fragment),f=q(),G($.$$.fragment),v=q(),G(E.$$.fragment),p=q(),G(y.$$.fragment),S=q(),G(b.$$.fragment),this.h()},l(s){e=W(s,"DIV",{style:!0});var C=Z(e);n=W(C,"A",{href:!0,target:!0});var te=Z(n);l=X(te,"Google StreetView"),te.forEach(h),u=A(C),r=W(C,"A",{href:!0,target:!0});var le=Z(r);c=X(le,"Bing Streetside"),le.forEach(h),C.forEach(h),g=A(s),M(a.$$.fragment,s),f=A(s),M($.$$.fragment,s),v=A(s),M(E.$$.fragment,s),p=A(s),M(y.$$.fragment,s),S=A(s),M(b.$$.fragment,s),this.h()},h(){U(n,"href",o=ge(t[1].criticalIssues[t[0]].point)),U(n,"target","_blank"),U(r,"href",_=de(t[1].criticalIssues[t[0]].point)),U(r,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(s,C){L(s,e,C),B(e,n),B(n,l),B(e,u),B(e,r),B(r,c),L(s,g,C),V(a,s,C),L(s,f,C),V($,s,C),L(s,v,C),V(E,s,C),L(s,p,C),V(y,s,C),L(s,S,C),V(b,s,C),D=!0},p(s,[C]){(!D||C&3&&o!==(o=ge(s[1].criticalIssues[s[0]].point)))&&U(n,"href",o),(!D||C&3&&_!==(_=de(s[1].criticalIssues[s[0]].point)))&&U(r,"href",_);const te={};!w&&C&3&&(w=!0,te.value=s[1].criticalIssues[s[0]].criticalIssue,x(()=>w=!1)),a.$set(te);const le={};!j&&C&3&&(j=!0,le.value=s[1].criticalIssues[s[0]].stage,x(()=>j=!1)),$.$set(le);const fe={};!i&&C&3&&(i=!0,fe.value=s[1].criticalIssues[s[0]].locationName,x(()=>i=!1)),E.$set(fe);const d={};!P&&C&3&&(P=!0,d.value=s[1].criticalIssues[s[0]].resolved,x(()=>P=!1)),y.$set(d);const F={};!O&&C&3&&(O=!0,F.value=s[1].criticalIssues[s[0]].notes,x(()=>O=!1)),b.$set(F)},i(s){D||(I(a.$$.fragment,s),I($.$$.fragment,s),I(E.$$.fragment,s),I(y.$$.fragment,s),I(b.$$.fragment,s),D=!0)},o(s){N(a.$$.fragment,s),N($.$$.fragment,s),N(E.$$.fragment,s),N(y.$$.fragment,s),N(b.$$.fragment,s),D=!1},d(s){s&&(h(e),h(g),h(f),h(v),h(p),h(S)),R(a,s),R($,s),R(E,s),R(y,s),R(b,s)}}}function dt(t,e,n){let l;Le(t,Y,a=>n(1,l=a));let{idx:o}=e;function u(a){t.$$.not_equal(l.criticalIssues[o].criticalIssue,a)&&(l.criticalIssues[o].criticalIssue=a,Y.set(l))}function r(a){t.$$.not_equal(l.criticalIssues[o].stage,a)&&(l.criticalIssues[o].stage=a,Y.set(l))}function c(a){t.$$.not_equal(l.criticalIssues[o].locationName,a)&&(l.criticalIssues[o].locationName=a,Y.set(l))}function _(a){t.$$.not_equal(l.criticalIssues[o].resolved,a)&&(l.criticalIssues[o].resolved=a,Y.set(l))}function g(a){t.$$.not_equal(l.criticalIssues[o].notes,a)&&(l.criticalIssues[o].notes=a,Y.set(l))}return t.$$set=a=>{"idx"in a&&n(0,o=a.idx)},[o,l,u,r,c,_,g]}class ht extends Se{constructor(e){super(),Ne(this,e,dt,gt,Ie,{idx:0})}}function vt(t){let e,n,l,o,u,r,c,_,g,a,w,f,$,j,v,E,i,p,y,P,S,b,O,D;function se(s){t[2](s)}let m={label:"Policy Conflict",emptyOption:!0,choices:lt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(m.value=t[1].policyConflictLog[t[0]].conflict),a=new he({props:m}),Q.push(()=>ee(a,"value",se));function k(s){t[3](s)}let z={label:"Stage",emptyOption:!0,choices:Me(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(z.value=t[1].policyConflictLog[t[0]].stage),$=new he({props:z}),Q.push(()=>ee($,"value",k));function ie(s){t[4](s)}let T={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(T.value=t[1].policyConflictLog[t[0]].locationName),E=new Re({props:T}),Q.push(()=>ee(E,"value",ie));function ne(s){t[5](s)}let ae={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(ae.value=t[1].policyConflictLog[t[0]].resolved),y=new Fe({props:ae}),Q.push(()=>ee(y,"value",ne));function _e(s){t[6](s)}let re={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(re.value=t[1].policyConflictLog[t[0]].notes),b=new Ve({props:re}),Q.push(()=>ee(b,"value",_e)),{c(){e=K("div"),n=K("a"),l=J("Google StreetView"),u=q(),r=K("a"),c=J("Bing Streetside"),g=q(),G(a.$$.fragment),f=q(),G($.$$.fragment),v=q(),G(E.$$.fragment),p=q(),G(y.$$.fragment),S=q(),G(b.$$.fragment),this.h()},l(s){e=W(s,"DIV",{style:!0});var C=Z(e);n=W(C,"A",{href:!0,target:!0});var te=Z(n);l=X(te,"Google StreetView"),te.forEach(h),u=A(C),r=W(C,"A",{href:!0,target:!0});var le=Z(r);c=X(le,"Bing Streetside"),le.forEach(h),C.forEach(h),g=A(s),M(a.$$.fragment,s),f=A(s),M($.$$.fragment,s),v=A(s),M(E.$$.fragment,s),p=A(s),M(y.$$.fragment,s),S=A(s),M(b.$$.fragment,s),this.h()},h(){U(n,"href",o=ge(t[1].policyConflictLog[t[0]].point)),U(n,"target","_blank"),U(r,"href",_=de(t[1].policyConflictLog[t[0]].point)),U(r,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(s,C){L(s,e,C),B(e,n),B(n,l),B(e,u),B(e,r),B(r,c),L(s,g,C),V(a,s,C),L(s,f,C),V($,s,C),L(s,v,C),V(E,s,C),L(s,p,C),V(y,s,C),L(s,S,C),V(b,s,C),D=!0},p(s,[C]){(!D||C&3&&o!==(o=ge(s[1].policyConflictLog[s[0]].point)))&&U(n,"href",o),(!D||C&3&&_!==(_=de(s[1].policyConflictLog[s[0]].point)))&&U(r,"href",_);const te={};!w&&C&3&&(w=!0,te.value=s[1].policyConflictLog[s[0]].conflict,x(()=>w=!1)),a.$set(te);const le={};!j&&C&3&&(j=!0,le.value=s[1].policyConflictLog[s[0]].stage,x(()=>j=!1)),$.$set(le);const fe={};!i&&C&3&&(i=!0,fe.value=s[1].policyConflictLog[s[0]].locationName,x(()=>i=!1)),E.$set(fe);const d={};!P&&C&3&&(P=!0,d.value=s[1].policyConflictLog[s[0]].resolved,x(()=>P=!1)),y.$set(d);const F={};!O&&C&3&&(O=!0,F.value=s[1].policyConflictLog[s[0]].notes,x(()=>O=!1)),b.$set(F)},i(s){D||(I(a.$$.fragment,s),I($.$$.fragment,s),I(E.$$.fragment,s),I(y.$$.fragment,s),I(b.$$.fragment,s),D=!0)},o(s){N(a.$$.fragment,s),N($.$$.fragment,s),N(E.$$.fragment,s),N(y.$$.fragment,s),N(b.$$.fragment,s),D=!1},d(s){s&&(h(e),h(g),h(f),h(v),h(p),h(S)),R(a,s),R($,s),R(E,s),R(y,s),R(b,s)}}}function bt(t,e,n){let l;Le(t,Y,a=>n(1,l=a));let{idx:o}=e;function u(a){t.$$.not_equal(l.policyConflictLog[o].conflict,a)&&(l.policyConflictLog[o].conflict=a,Y.set(l))}function r(a){t.$$.not_equal(l.policyConflictLog[o].stage,a)&&(l.policyConflictLog[o].stage=a,Y.set(l))}function c(a){t.$$.not_equal(l.policyConflictLog[o].locationName,a)&&(l.policyConflictLog[o].locationName=a,Y.set(l))}function _(a){t.$$.not_equal(l.policyConflictLog[o].resolved,a)&&(l.policyConflictLog[o].resolved=a,Y.set(l))}function g(a){t.$$.not_equal(l.policyConflictLog[o].notes,a)&&(l.policyConflictLog[o].notes=a,Y.set(l))}return t.$$set=a=>{"idx"in a&&n(0,o=a.idx)},[o,l,u,r,c,_,g]}class kt extends Se{constructor(e){super(),Ne(this,e,bt,vt,Ie,{idx:0})}}const{window:Ct}=Ze;function De(t,e,n){const l=t.slice();return l[37]=e[n],l[38]=e,l[39]=n,l}function je(t,e,n){const l=t.slice();return l[40]=e[n],l[41]=e,l[39]=n,l}function Te(t,e,n){const l=t.slice();return l[37]=e[n],l[39]=n,l}function qe(t,e,n){const l=t.slice();return l[40]=e[n],l[39]=n,l}function wt(t){let e,n,l,o,u,r,c,_;e=new ct({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),e.$on("click",t[11]),l=new mt({props:{$$slots:{default:[Lt]},$$scope:{ctx:t}}}),l.$on("click",t[13]);const g=[Nt,St],a=[];function w(f,$){return f[0].kind=="critical"?0:1}return u=w(t),r=a[u]=g[u](t),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q(),r.c(),c=me()},l(f){M(e.$$.fragment,f),n=A(f),M(l.$$.fragment,f),o=A(f),r.l(f),c=me()},m(f,$){V(e,f,$),L(f,n,$),V(l,f,$),L(f,o,$),a[u].m(f,$),L(f,c,$),_=!0},p(f,$){const j={};$[1]&8192&&(j.$$scope={dirty:$,ctx:f}),e.$set(j);const v={};$[1]&8192&&(v.$$scope={dirty:$,ctx:f}),l.$set(v);let E=u;u=w(f),u===E?a[u].p(f,$):(pe(),N(a[E],1,1,()=>{a[E]=null}),ce(),r=a[u],r?r.p(f,$):(r=a[u]=g[u](f),r.c()),I(r,1),r.m(c.parentNode,c))},i(f){_||(I(e.$$.fragment,f),I(l.$$.fragment,f),I(r),_=!0)},o(f){N(e.$$.fragment,f),N(l.$$.fragment,f),N(r),_=!1},d(f){f&&(h(n),h(o),h(c)),R(e,f),R(l,f),a[u].d(f)}}}function yt(t){let e,n,l,o,u,r,c="Click the map to add a problem, or select a problem to fill out data",_,g,a="Critical Issues",w,f,$,j="Policy Conflicts",v,E,i;e=new ut({props:{label:"Tools",$$slots:{default:[jt]},$$scope:{ctx:t}}});function p(m){t[21](m)}let y={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[5]!==void 0&&(y.value=t[5]),l=new pt({props:y}),Q.push(()=>ee(l,"value",p));let P=oe(t[2].criticalIssues),S=[];for(let m=0;m<P.length;m+=1)S[m]=Ae(qe(t,P,m));const b=m=>N(S[m],1,1,()=>{S[m]=null});let O=oe(t[2].policyConflictLog),D=[];for(let m=0;m<O.length;m+=1)D[m]=Pe(Te(t,O,m));const se=m=>N(D[m],1,1,()=>{D[m]=null});return{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),u=q(),r=K("p"),r.textContent=c,_=q(),g=K("h3"),g.textContent=a,w=q();for(let m=0;m<S.length;m+=1)S[m].c();f=q(),$=K("h3"),$.textContent=j,v=q();for(let m=0;m<D.length;m+=1)D[m].c();E=me()},l(m){M(e.$$.fragment,m),n=A(m),M(l.$$.fragment,m),u=A(m),r=W(m,"P",{"data-svelte-h":!0}),ke(r)!=="svelte-12ba5j2"&&(r.textContent=c),_=A(m),g=W(m,"H3",{"data-svelte-h":!0}),ke(g)!=="svelte-1qhh5xr"&&(g.textContent=a),w=A(m);for(let k=0;k<S.length;k+=1)S[k].l(m);f=A(m),$=W(m,"H3",{"data-svelte-h":!0}),ke($)!=="svelte-eyxzjx"&&($.textContent=j),v=A(m);for(let k=0;k<D.length;k+=1)D[k].l(m);E=me()},m(m,k){V(e,m,k),L(m,n,k),V(l,m,k),L(m,u,k),L(m,r,k),L(m,_,k),L(m,g,k),L(m,w,k);for(let z=0;z<S.length;z+=1)S[z]&&S[z].m(m,k);L(m,f,k),L(m,$,k),L(m,v,k);for(let z=0;z<D.length;z+=1)D[z]&&D[z].m(m,k);L(m,E,k),i=!0},p(m,k){const z={};k[0]&200|k[1]&8192&&(z.$$scope={dirty:k,ctx:m}),e.$set(z);const ie={};if(!o&&k[0]&32&&(o=!0,ie.value=m[5],x(()=>o=!1)),l.$set(ie),k[0]&33798){P=oe(m[2].criticalIssues);let T;for(T=0;T<P.length;T+=1){const ne=qe(m,P,T);S[T]?(S[T].p(ne,k),I(S[T],1)):(S[T]=Ae(ne),S[T].c(),I(S[T],1),S[T].m(f.parentNode,f))}for(pe(),T=P.length;T<S.length;T+=1)b(T);ce()}if(k[0]&66566){O=oe(m[2].policyConflictLog);let T;for(T=0;T<O.length;T+=1){const ne=Te(m,O,T);D[T]?(D[T].p(ne,k),I(D[T],1)):(D[T]=Pe(ne),D[T].c(),I(D[T],1),D[T].m(E.parentNode,E))}for(pe(),T=O.length;T<D.length;T+=1)se(T);ce()}},i(m){if(!i){I(e.$$.fragment,m),I(l.$$.fragment,m);for(let k=0;k<P.length;k+=1)I(S[k]);for(let k=0;k<O.length;k+=1)I(D[k]);i=!0}},o(m){N(e.$$.fragment,m),N(l.$$.fragment,m),S=S.filter(Boolean);for(let k=0;k<S.length;k+=1)N(S[k]);D=D.filter(Boolean);for(let k=0;k<D.length;k+=1)N(D[k]);i=!1},d(m){m&&(h(n),h(u),h(r),h(_),h(g),h(w),h(f),h($),h(v),h(E)),R(e,m),R(l,m),$e(S,m),$e(D,m)}}}function It(t){let e;return{c(){e=J("Save")},l(n){e=X(n,"Save")},m(n,l){L(n,e,l)},d(n){n&&h(e)}}}function Lt(t){let e;return{c(){e=J("Delete")},l(n){e=X(n,"Delete")},m(n,l){L(n,e,l)},d(n){n&&h(e)}}}function St(t){let e,n;return e=new kt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p(l,o){const u={};o[0]&1&&(u.idx=l[0].idx),e.$set(u)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function Nt(t){let e,n;return e=new ht({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p(l,o){const u={};o[0]&1&&(u.idx=l[0].idx),e.$set(u)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function Et(t){let e;return{c(){e=J("Zoom to fit")},l(n){e=X(n,"Zoom to fit")},m(n,l){L(n,e,l)},d(n){n&&h(e)}}}function Dt(t){let e;return{c(){e=J("Show scheme context")},l(n){e=X(n,"Show scheme context")},m(n,l){L(n,e,l)},d(n){n&&h(e)}}}function jt(t){let e,n,l,o,u,r,c,_,g,a,w,f;e=new _t({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),e.$on("click",t[18]),l=new ot({}),u=new st({});function $(i){t[19](i)}let j={map:t[3]};t[6]!==void 0&&(j.enabled=t[6]),c=new at({props:j}),Q.push(()=>ee(c,"enabled",$));function v(i){t[20](i)}let E={$$slots:{default:[Dt]},$$scope:{ctx:t}};return t[7]!==void 0&&(E.checked=t[7]),a=new rt({props:E}),Q.push(()=>ee(a,"checked",v)),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q(),G(u.$$.fragment),r=q(),G(c.$$.fragment),g=q(),G(a.$$.fragment)},l(i){M(e.$$.fragment,i),n=A(i),M(l.$$.fragment,i),o=A(i),M(u.$$.fragment,i),r=A(i),M(c.$$.fragment,i),g=A(i),M(a.$$.fragment,i)},m(i,p){V(e,i,p),L(i,n,p),V(l,i,p),L(i,o,p),V(u,i,p),L(i,r,p),V(c,i,p),L(i,g,p),V(a,i,p),f=!0},p(i,p){const y={};p[1]&8192&&(y.$$scope={dirty:p,ctx:i}),e.$set(y);const P={};p[0]&8&&(P.map=i[3]),!_&&p[0]&64&&(_=!0,P.enabled=i[6],x(()=>_=!1)),c.$set(P);const S={};p[1]&8192&&(S.$$scope={dirty:p,ctx:i}),!w&&p[0]&128&&(w=!0,S.checked=i[7],x(()=>w=!1)),a.$set(S)},i(i){f||(I(e.$$.fragment,i),I(l.$$.fragment,i),I(u.$$.fragment,i),I(c.$$.fragment,i),I(a.$$.fragment,i),f=!0)},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),N(u.$$.fragment,i),N(c.$$.fragment,i),N(a.$$.fragment,i),f=!1},d(i){i&&(h(n),h(o),h(r),h(g)),R(e,i),R(l,i),R(u,i),R(c,i),R(a,i)}}}function Tt(t){let e,n,l,o=t[40].stage+"",u,r,c,_,g=t[40].resolved+"",a;return{c(){e=K("div"),n=K("span"),l=J("Stage: "),u=J(o),r=q(),c=K("span"),_=J("Resolved: "),a=J(g),this.h()},l(w){e=W(w,"DIV",{style:!0});var f=Z(e);n=W(f,"SPAN",{});var $=Z(n);l=X($,"Stage: "),u=X($,o),$.forEach(h),r=A(f),c=W(f,"SPAN",{});var j=Z(c);_=X(j,"Resolved: "),a=X(j,g),j.forEach(h),f.forEach(h),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(w,f){L(w,e,f),B(e,n),B(n,l),B(n,u),B(e,r),B(e,c),B(c,_),B(c,a)},p(w,f){f[0]&4&&o!==(o=w[40].stage+"")&&ue(u,o),f[0]&4&&g!==(g=w[40].resolved+"")&&ue(a,g)},d(w){w&&h(e)}}}function Ae(t){let e,n,l;function o(){return t[22](t[39])}function u(){return t[23](t[39])}return n=new Ue({props:{name:t[15](t[40]),$$slots:{default:[Tt]},$$scope:{ctx:t}}}),n.$on("click",o),n.$on("mouseenter",u),n.$on("mouseleave",t[24]),{c(){e=K("li"),G(n.$$.fragment)},l(r){e=W(r,"LI",{});var c=Z(e);M(n.$$.fragment,c),c.forEach(h)},m(r,c){L(r,e,c),V(n,e,null),l=!0},p(r,c){t=r;const _={};c[0]&4&&(_.name=t[15](t[40])),c[0]&4|c[1]&8192&&(_.$$scope={dirty:c,ctx:t}),n.$set(_)},i(r){l||(I(n.$$.fragment,r),l=!0)},o(r){N(n.$$.fragment,r),l=!1},d(r){r&&h(e),R(n)}}}function qt(t){let e,n,l,o=t[37].stage+"",u,r,c,_,g=t[37].resolved+"",a,w;return{c(){e=K("div"),n=K("span"),l=J("Stage: "),u=J(o),r=q(),c=K("span"),_=J("Resolved: "),a=J(g),w=q(),this.h()},l(f){e=W(f,"DIV",{style:!0});var $=Z(e);n=W($,"SPAN",{});var j=Z(n);l=X(j,"Stage: "),u=X(j,o),j.forEach(h),r=A($),c=W($,"SPAN",{});var v=Z(c);_=X(v,"Resolved: "),a=X(v,g),v.forEach(h),$.forEach(h),w=A(f),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(f,$){L(f,e,$),B(e,n),B(n,l),B(n,u),B(e,r),B(e,c),B(c,_),B(c,a),L(f,w,$)},p(f,$){$[0]&4&&o!==(o=f[37].stage+"")&&ue(u,o),$[0]&4&&g!==(g=f[37].resolved+"")&&ue(a,g)},d(f){f&&(h(e),h(w))}}}function Pe(t){let e,n;function l(){return t[25](t[39])}function o(){return t[26](t[39])}return e=new Ue({props:{name:t[16](t[37]),$$slots:{default:[qt]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",o),e.$on("mouseleave",t[27]),{c(){G(e.$$.fragment)},l(u){M(e.$$.fragment,u)},m(u,r){V(e,u,r),n=!0},p(u,r){t=u;const c={};r[0]&4&&(c.name=t[16](t[37])),r[0]&4|r[1]&8192&&(c.$$scope={dirty:r,ctx:t}),e.$set(c)},i(u){n||(I(e.$$.fragment,u),n=!0)},o(u){N(e.$$.fragment,u),n=!1},d(u){R(e,u)}}}function At(t){let e,n,l,o=t[40].criticalIssue+"",u;return{c(){e=Ce("svg"),n=Ce("polygon"),l=Ce("text"),u=J(o),this.h()},l(r){e=we(r,"svg",{width:!0,height:!0,xmlns:!0});var c=Z(e);n=we(c,"polygon",{points:!0,fill:!0,class:!0}),Z(n).forEach(h),l=we(c,"text",{x:!0,y:!0});var _=Z(l);u=X(_,o),_.forEach(h),c.forEach(h),this.h()},h(){U(n,"points","20,0 0,40 40,40"),U(n,"fill",xe.critical.background),U(n,"class","svelte-ktyu3j"),U(l,"x","13"),U(l,"y","30"),H(l,"fill","white"),U(e,"width","40"),U(e,"height","40"),U(e,"xmlns","http://www.w3.org/2000/svg")},m(r,c){L(r,e,c),B(e,n),B(e,l),B(l,u)},p(r,c){c[0]&4&&o!==(o=r[40].criticalIssue+"")&&ue(u,o)},d(r){r&&h(e)}}}function Be(t){let e,n,l;function o(_){t[29](_,t[40])}function u(){return t[30](t[39])}function r(){return t[31](t[39])}let c={draggable:!0,$$slots:{default:[At]},$$scope:{ctx:t}};return t[40].point!==void 0&&(c.lngLat=t[40].point),e=new Oe({props:c}),Q.push(()=>ee(e,"lngLat",o)),e.$on("click",u),e.$on("dragend",r),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,g){V(e,_,g),l=!0},p(_,g){t=_;const a={};g[0]&4|g[1]&8192&&(a.$$scope={dirty:g,ctx:t}),!n&&g[0]&4&&(n=!0,a.lngLat=t[40].point,x(()=>n=!1)),e.$set(a)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function Pt(t){let e,n=t[37].conflict+"",l;return{c(){e=K("span"),l=J(n),this.h()},l(o){e=W(o,"SPAN",{class:!0});var u=Z(e);l=X(u,n),u.forEach(h),this.h()},h(){U(e,"class","dot svelte-ktyu3j"),H(e,"background",et)},m(o,u){L(o,e,u),B(e,l)},p(o,u){u[0]&4&&n!==(n=o[37].conflict+"")&&ue(l,n)},d(o){o&&h(e)}}}function Ge(t){let e,n,l;function o(_){t[32](_,t[37])}function u(){return t[33](t[39])}function r(){return t[34](t[39])}let c={draggable:!0,$$slots:{default:[Pt]},$$scope:{ctx:t}};return t[37].point!==void 0&&(c.lngLat=t[37].point),e=new Oe({props:c}),Q.push(()=>ee(e,"lngLat",o)),e.$on("click",u),e.$on("dragend",r),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,g){V(e,_,g),l=!0},p(_,g){t=_;const a={};g[0]&4|g[1]&8192&&(a.$$scope={dirty:g,ctx:t}),!n&&g[0]&4&&(n=!0,a.lngLat=t[37].point,x(()=>n=!1)),e.$set(a)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function Bt(t){let e,n;return e=new Qe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,o){V(e,l,o),n=!0},p:Ke,i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){R(e,l)}}}function Gt(t){let e,n,l,o,u,r,c,_,g,a;e=new ft({}),e.$on("click",t[12]),l=new Je({props:{gj:t[2].summary.networkMap,show:t[7]}});let w=oe(t[2].criticalIssues),f=[];for(let i=0;i<w.length;i+=1)f[i]=Be(je(t,w,i));const $=i=>N(f[i],1,1,()=>{f[i]=null});let j=oe(t[2].policyConflictLog),v=[];for(let i=0;i<j.length;i+=1)v[i]=Ge(De(t,j,i));const E=i=>N(v[i],1,1,()=>{v[i]=null});return c=new Xe({props:{data:t[8],$$slots:{default:[Bt]},$$scope:{ctx:t}}}),g=new $t({props:{map:t[3]}}),{c(){G(e.$$.fragment),n=q(),G(l.$$.fragment),o=q();for(let i=0;i<f.length;i+=1)f[i].c();u=q();for(let i=0;i<v.length;i+=1)v[i].c();r=q(),G(c.$$.fragment),_=q(),G(g.$$.fragment)},l(i){M(e.$$.fragment,i),n=A(i),M(l.$$.fragment,i),o=A(i);for(let p=0;p<f.length;p+=1)f[p].l(i);u=A(i);for(let p=0;p<v.length;p+=1)v[p].l(i);r=A(i),M(c.$$.fragment,i),_=A(i),M(g.$$.fragment,i)},m(i,p){V(e,i,p),L(i,n,p),V(l,i,p),L(i,o,p);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(i,p);L(i,u,p);for(let y=0;y<v.length;y+=1)v[y]&&v[y].m(i,p);L(i,r,p),V(c,i,p),L(i,_,p),V(g,i,p),a=!0},p(i,p){const y={};if(p[0]&4&&(y.gj=i[2].summary.networkMap),p[0]&128&&(y.show=i[7]),l.$set(y),p[0]&516){w=oe(i[2].criticalIssues);let b;for(b=0;b<w.length;b+=1){const O=je(i,w,b);f[b]?(f[b].p(O,p),I(f[b],1)):(f[b]=Be(O),f[b].c(),I(f[b],1),f[b].m(u.parentNode,u))}for(pe(),b=w.length;b<f.length;b+=1)$(b);ce()}if(p[0]&516){j=oe(i[2].policyConflictLog);let b;for(b=0;b<j.length;b+=1){const O=De(i,j,b);v[b]?(v[b].p(O,p),I(v[b],1)):(v[b]=Ge(O),v[b].c(),I(v[b],1),v[b].m(r.parentNode,r))}for(pe(),b=j.length;b<v.length;b+=1)E(b);ce()}const P={};p[0]&256&&(P.data=i[8]),p[1]&8192&&(P.$$scope={dirty:p,ctx:i}),c.$set(P);const S={};p[0]&8&&(S.map=i[3]),g.$set(S)},i(i){if(!a){I(e.$$.fragment,i),I(l.$$.fragment,i);for(let p=0;p<w.length;p+=1)I(f[p]);for(let p=0;p<j.length;p+=1)I(v[p]);I(c.$$.fragment,i),I(g.$$.fragment,i),a=!0}},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)N(f[p]);v=v.filter(Boolean);for(let p=0;p<v.length;p+=1)N(v[p]);N(c.$$.fragment,i),N(g.$$.fragment,i),a=!1},d(i){i&&(h(n),h(o),h(u),h(r),h(_)),R(e,i),R(l,i),$e(f,i),$e(v,i),R(c,i),R(g,i)}}}function Mt(t){let e,n,l,o,u,r,c,_,g,a,w;const f=[yt,wt],$=[];function j(i,p){return i[0]==null?0:1}l=j(t),o=$[l]=f[l](t);function v(i){t[35](i)}let E={$$slots:{default:[Gt]},$$scope:{ctx:t}};return t[3]!==void 0&&(E.map=t[3]),c=new We({props:E}),Q.push(()=>ee(c,"map",v)),{c(){e=K("div"),n=K("div"),o.c(),u=q(),r=K("div"),G(c.$$.fragment),this.h()},l(i){e=W(i,"DIV",{style:!0});var p=Z(e);n=W(p,"DIV",{style:!0});var y=Z(n);o.l(y),y.forEach(h),u=A(p),r=W(p,"DIV",{style:!0});var P=Z(r);M(c.$$.fragment,P),P.forEach(h),p.forEach(h),this.h()},h(){H(n,"width","30%"),H(n,"overflow-y","scroll"),H(n,"padding","10px"),H(n,"border","1px solid black"),H(r,"position","relative"),H(r,"width","70%"),H(e,"display","flex"),H(e,"height","80vh")},m(i,p){L(i,e,p),B(e,n),$[l].m(n,null),t[28](n),B(e,u),B(e,r),V(c,r,null),g=!0,a||(w=ze(Ct,"keydown",t[17]),a=!0)},p(i,p){let y=l;l=j(i),l===y?$[l].p(i,p):(pe(),N($[y],1,1,()=>{$[y]=null}),ce(),o=$[l],o?o.p(i,p):(o=$[l]=f[l](i),o.c()),I(o,1),o.m(n,null));const P={};p[0]&396|p[1]&8192&&(P.$$scope={dirty:p,ctx:i}),!_&&p[0]&8&&(_=!0,P.map=i[3],x(()=>_=!1)),c.$set(P)},i(i){g||(I(o),I(c.$$.fragment,i),g=!0)},o(i){N(o),N(c.$$.fragment,i),g=!1},d(i){i&&h(e),$[l].d(),t[28](null),R(c),a=!1,w()}}}function Vt(t,e,n){let l={type:"FeatureCollection",features:[]},o=e??n;if(o!=null){let u=o.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(ye(u[o.idx].point))}return l}function ye(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Rt(t,e,n){let l,o;Le(t,Y,d=>n(2,o=d));let u,r,c="critical",_=null,g=null,a=null,w=!1,f=!0;async function $(d){g=r.scrollTop,n(0,_=d),n(1,a=null),await be(),n(4,r.scrollTop=0,r)}async function j(d){g=r.scrollTop,n(0,_=d),n(1,a=null),await be(),n(4,r.scrollTop=0,r);let F=d.kind=="critical"?o.criticalIssues:o.policyConflictLog;u.flyTo({center:F[d.idx].point,duration:500})}async function v(){n(0,_=null),g!=null&&(await be(),n(4,r.scrollTop=g,r),g=null)}function E(d){if(!w){if(_!=null){v();return}c=="critical"?(Ee(Y,o.criticalIssues=[...o.criticalIssues,{criticalIssue:"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],o),$({kind:"critical",idx:o.criticalIssues.length-1})):(Ee(Y,o.policyConflictLog=[...o.policyConflictLog,{conflict:"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],o),$({kind:"conflict",idx:o.policyConflictLog.length-1}))}}He(()=>{p(!1)});function i(){window.confirm("Delete this entry?")&&(_.kind=="critical"?(o.criticalIssues.splice(_.idx,1),Y.set(o)):(o.policyConflictLog.splice(_.idx,1),Y.set(o)),v())}function p(d){let F={type:"FeatureCollection",features:[...o.criticalIssues.map(ve=>ye(ve.point)),...o.policyConflictLog.map(ve=>ye(ve.point)),...o.summary.networkMap.features]};F.features.length>0&&u.fitBounds(Ye(F),{padding:20,animate:d})}function y(d){let F=d.criticalIssue?nt(d.criticalIssue):"Unknown critical";return d.locationName?`${F} (${d.locationName})`:F}function P(d){let F=d.conflict?it(d.conflict):"Unknown conflict";return d.locationName?`${F} (${d.locationName})`:F}function S(d){if(_!=null&&d.key=="Escape")d.stopPropagation(),v();else if(_!=null&&d.key=="Delete"){let F=d.target.tagName;if(F=="INPUT"||F=="TEXTAREA")return;d.stopPropagation(),i()}}const b=()=>p(!0);function O(d){w=d,n(6,w)}function D(d){f=d,n(7,f)}function se(d){c=d,n(5,c)}const m=d=>j({kind:"critical",idx:d}),k=d=>n(1,a={kind:"critical",idx:d}),z=()=>n(1,a=null),ie=d=>j({kind:"conflict",idx:d}),T=d=>n(1,a={kind:"conflict",idx:d}),ne=()=>n(1,a=null);function ae(d){Q[d?"unshift":"push"](()=>{r=d,n(4,r)})}function _e(d,F){t.$$.not_equal(F.point,d)&&(F.point=d,Y.set(o))}const re=d=>$({kind:"critical",idx:d}),s=d=>$({kind:"critical",idx:d});function C(d,F){t.$$.not_equal(F.point,d)&&(F.point=d,Y.set(o))}const te=d=>$({kind:"conflict",idx:d}),le=d=>$({kind:"conflict",idx:d});function fe(d){u=d,n(3,u)}return t.$$.update=()=>{t.$$.dirty[0]&7&&n(8,l=Vt(o,_,a))},[_,a,o,u,r,c,w,f,l,$,j,v,E,i,p,y,P,S,b,O,D,se,m,k,z,ie,T,ne,ae,_e,re,s,C,te,le,fe]}class ul extends Se{constructor(e){super(),Ne(this,e,Rt,Mt,Ie,{},null,[-1,-1])}}export{ul as component};
