import{s as re,a as R,e as O,c as P,b as V,o as X,i as w,z as Se,A as Ce,d as b,H as xe,r as j,f as z,K as x,j as I,v as U,k as ae,a4 as et,t as M,w as K,h as W,y as ee,g as pe,x as tt,n as ne,l as rt}from"../chunks/scheduler.8Pqdtq9W.js";import{S as se,i as ie,c as L,a as S,m as C,t as k,b as F,d as N,e as A,g as Y,f as J}from"../chunks/index.KrNxZzBh.js";import{e as te,u as je,o as Ue,B as st}from"../chunks/Geocoder.svelte_svelte_type_style_lang.C9M_1801.js";import{p as Z}from"../chunks/index.B6skd2Bf.js";import{S as le}from"../chunks/SecondaryButton.CctJSiA9.js";import{S as Q}from"../chunks/Select.Cl7J0FjW.js";import{W as Ae}from"../chunks/WarningButton.Cyr2mll2.js";import{W as de}from"../chunks/WarningText.DNDO-dlG.js";import{s as E,a as it,b as nt}from"../chunks/data.DhlDRbOc.js";import{a as He,n as at,g as Ne,c as lt,D as ot}from"../chunks/logic.BnJPKzaS.js";import{E as ft}from"../chunks/ExternalLink.DchCAz0l.js";import"../chunks/paths.bzagok_L.js";import{T as ut}from"../chunks/TextInput.CSx64iaK.js";import{v as ze}from"../chunks/v4.D8aEg3BZ.js";import{C as oe}from"../chunks/CollapsibleCard.COCSlxIK.js";import{F as ct,E as pt}from"../chunks/FormElement.C7qRsTEQ.js";function dt(s){let e,r,t,i,l,n,f;return e=new pt({props:{errorMessage:s[5](s[2])}}),{c(){L(e.$$.fragment),r=R(),t=O("input"),this.h()},l(o){S(e.$$.fragment,o),r=P(o),t=V(o,"INPUT",{type:!0,inputmode:!0,class:!0,id:!0}),this.h()},h(){X(t,"type","text"),X(t,"inputmode","numeric"),X(t,"class",i=`govuk-input govuk-input--width-${s[1]}`),X(t,"id",s[3])},m(o,a){C(e,o,a),w(o,r,a),w(o,t,a),Se(t,s[2]),l=!0,n||(f=[Ce(t,"input",s[9]),Ce(t,"change",s[4])],n=!0)},p(o,a){const u={};a&4&&(u.errorMessage=o[5](o[2])),e.$set(u),(!l||a&2&&i!==(i=`govuk-input govuk-input--width-${o[1]}`))&&X(t,"class",i),a&4&&t.value!==o[2]&&Se(t,o[2])},i(o){l||(k(e.$$.fragment,o),l=!0)},o(o){F(e.$$.fragment,o),l=!1},d(o){o&&(b(r),b(t)),N(e,o),n=!1,xe(f)}}}function mt(s){let e,r;return e=new ct({props:{label:s[0],id:s[3],$$slots:{default:[dt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},p(t,[i]){const l={};i&1&&(l.label=t[0]),i&1030&&(l.$$scope={dirty:i,ctx:t}),e.$set(l)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function _t(s,e,r){let{label:t}=e,{value:i}=e,{width:l}=e,{min:n=void 0}=e,{max:f=void 0}=e,o=i==null?void 0:i.toString(),a=ze();function u(){r(6,i=o==null?void 0:parseInt(o,10))}function d($){if($==""||$==null)return"";if($.includes("."))return"Please enter a number without decimals";let v=Number($);return isNaN(v)?"Please enter a valid number":n!=null&&v<n?`Please enter a number that's at least ${n};`:f!=null&&v>f?`Please enter a number that's at most ${f};`:""}function y(){o=this.value,r(2,o)}return s.$$set=$=>{"label"in $&&r(0,t=$.label),"value"in $&&r(6,i=$.value),"width"in $&&r(1,l=$.width),"min"in $&&r(7,n=$.min),"max"in $&&r(8,f=$.max)},[t,l,o,a,u,d,i,n,f,y]}class ht extends se{constructor(e){super(),ie(this,e,_t,mt,re,{label:0,value:6,width:1,min:7,max:8})}}function fe(s){return typeof s=="object"?[]:gt[s]}let gt={Footway:[["Manual for Streets 2: Section 5 pp. 43","https://tsrgd.co.uk/pdf/mfs/mfs2.pdf#page=48"],["DMRB CD143 Designing for walking, cycling & horse-riding Annex pp. 7",""]],"Narrow Traffic / Bus Lane":[],"Wide Traffic / Bus Lane":[],"Traffic Lane (no buses): speed limit 20/30":[["LTN 1/20 Table 7-2 pp. 76",H(76)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"On-highway advisory/mandatory cycle lane":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"1-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"2-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"Shared use cycle track":[["LTN 1/20 Table 6-3 pp. 68",H(68)]],"Parking Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Disabled Parking Bay":[],"Loading Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Buffer / Verge":[["LTN 1/20 table 6-1 pp. 54",H(54)]]};function H(s){return`https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951074/cycle-infrastructure-design-ltn-1-20.pdf#page=${s}`}function ue(s,e){let r=He(e.speedLimit,e.observedSpeed);switch(s){case"Footway":return"There is no maximum width for footways; widths should take account of pedestrian volumes and composition. Suggested widths quoted here are the functional width available to the user";case"Narrow Traffic / Bus Lane":return"";case"Wide Traffic / Bus Lane":return"";case"Traffic Lane (no buses): speed limit 20/30":return e.trafficFlow=="<2,500"&&r==20?"Where traffic volumes are less than 2,500 vpd and speeds are less than 20mph, cycling in mixed traffic may be suitable for all users":"Where traffic volumes are greater than 2,500 vpd or speeds are greater than 20mph, cycling in mixed traffic is not suitable for all users";case"On-highway advisory/mandatory cycle lane":return(e.trafficFlow=="<2,500"||e.trafficFlow=="2,500-5,000")&&r==20?"Where traffic volumes are less than 2,500 vpd and/or speeds are less than 20mph, advisory or mandatory cycle lanes may be suitable for all users":"Where traffic volumes are greater than 5,000 vpd and/or speeds are greater than 20mph, advisory or mandatory cycle lanes are not suitable for all users";case"1-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.";case"2-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the userplus min. protection width 0.3m.";case"Shared use cycle track":return"Potential policy conflict: 'Cyclists must be separated from pedestrians' - have you considered alternatives to a shared use cycle track?";case"Parking Bay":return"";case"Disabled Parking Bay":return"";case"Loading Bay":return"";case"Buffer / Verge":return"Your buffer / verge shouldn't impact on the functional width of your footway or cycle-track";default:return""}}function Re(s,e,r){const t=s.slice();return t[17]=e[r][0],t[18]=e[r][1],t}function Pe(s){let e,r,t,i=Ne(s[0],s[7].proposed.trafficData,s[7].proposed.customFeatures,s[4],s[5])[s[3]=="Desirable"?0:1]+"",l,n,f,o,a,u=fe(s[0]).length>0,d,y=ue(s[0],s[7].proposed.trafficData),$,v;const p=[vt,bt,$t],_=[];function c(m,D){return m[9]=="left"?0:m[9]=="right"?1:m[9]=="both"?2:-1}~(f=c(s))&&(o=_[f]=p[f](s));let g=u&&qe(s),T=y&&We(s);return{c(){e=O("p"),r=M(s[3]),t=M(" minimum width (m): "),l=M(i),n=R(),o&&o.c(),a=R(),g&&g.c(),d=R(),T&&T.c(),$=K()},l(m){e=V(m,"P",{});var D=z(e);r=W(D,s[3]),t=W(D," minimum width (m): "),l=W(D,i),D.forEach(b),n=P(m),o&&o.l(m),a=P(m),g&&g.l(m),d=P(m),T&&T.l(m),$=K()},m(m,D){w(m,e,D),I(e,r),I(e,t),I(e,l),w(m,n,D),~f&&_[f].m(m,D),w(m,a,D),g&&g.m(m,D),w(m,d,D),T&&T.m(m,D),w(m,$,D),v=!0},p(m,D){(!v||D&8)&&ee(r,m[3]),(!v||D&185)&&i!==(i=Ne(m[0],m[7].proposed.trafficData,m[7].proposed.customFeatures,m[4],m[5])[m[3]=="Desirable"?0:1]+"")&&ee(l,i);let G=f;f=c(m),f!==G&&(o&&(Y(),F(_[G],1,1,()=>{_[G]=null}),J()),~f?(o=_[f],o||(o=_[f]=p[f](m),o.c()),k(o,1),o.m(a.parentNode,a)):o=null),D&1&&(u=fe(m[0]).length>0),u?g?(g.p(m,D),D&1&&k(g,1)):(g=qe(m),g.c(),k(g,1),g.m(d.parentNode,d)):g&&(Y(),F(g,1,1,()=>{g=null}),J()),D&129&&(y=ue(m[0],m[7].proposed.trafficData)),y?T?T.p(m,D):(T=We(m),T.c(),T.m($.parentNode,$)):T&&(T.d(1),T=null)},i(m){v||(k(o),k(g),v=!0)},o(m){F(o),F(g),v=!1},d(m){m&&(b(e),b(n),b(a),b(d),b($)),~f&&_[f].d(m),g&&g.d(m),T&&T.d(m)}}}function $t(s){let e,r;return e=new de({props:{$$slots:{default:[wt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function bt(s){let e,r;return e=new de({props:{$$slots:{default:[kt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function vt(s){let e,r;return e=new de({props:{$$slots:{default:[yt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function wt(s){let e;return{c(){e=M("Consider buffers to left and right")},l(r){e=W(r,"Consider buffers to left and right")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function kt(s){let e;return{c(){e=M("Consider buffer to right")},l(r){e=W(r,"Consider buffer to right")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function yt(s){let e;return{c(){e=M("Consider buffer to left")},l(r){e=W(r,"Consider buffer to left")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function qe(s){let e,r="References",t,i,l,n=te(fe(s[0])),f=[];for(let a=0;a<n.length;a+=1)f[a]=Me(Re(s,n,a));const o=a=>F(f[a],1,1,()=>{f[a]=null});return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),i=O("ul");for(let a=0;a<f.length;a+=1)f[a].c()},l(a){e=V(a,"U",{"data-svelte-h":!0}),pe(e)!=="svelte-fk7cdq"&&(e.textContent=r),t=W(a,`
      :
      `),i=V(a,"UL",{});var u=z(i);for(let d=0;d<f.length;d+=1)f[d].l(u);u.forEach(b)},m(a,u){w(a,e,u),w(a,t,u),w(a,i,u);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(i,null);l=!0},p(a,u){if(u&1){n=te(fe(a[0]));let d;for(d=0;d<n.length;d+=1){const y=Re(a,n,d);f[d]?(f[d].p(y,u),k(f[d],1)):(f[d]=Me(y),f[d].c(),k(f[d],1),f[d].m(i,null))}for(Y(),d=n.length;d<f.length;d+=1)o(d);J()}},i(a){if(!l){for(let u=0;u<n.length;u+=1)k(f[u]);l=!0}},o(a){f=f.filter(Boolean);for(let u=0;u<f.length;u+=1)F(f[u]);l=!1},d(a){a&&(b(e),b(t),b(i)),tt(f,a)}}}function Ft(s){let e,r=s[17]+"",t;return{c(){e=O("li"),t=M(r)},l(i){e=V(i,"LI",{});var l=z(e);t=W(l,r),l.forEach(b)},m(i,l){w(i,e,l),I(e,t)},p(i,l){l&1&&r!==(r=i[17]+"")&&ee(t,r)},i:ne,o:ne,d(i){i&&b(e)}}}function Dt(s){let e,r,t;return r=new ft({props:{href:s[18],$$slots:{default:[Tt]},$$scope:{ctx:s}}}),{c(){e=O("li"),L(r.$$.fragment)},l(i){e=V(i,"LI",{});var l=z(e);S(r.$$.fragment,l),l.forEach(b)},m(i,l){w(i,e,l),C(r,e,null),t=!0},p(i,l){const n={};l&1&&(n.href=i[18]),l&2097153&&(n.$$scope={dirty:l,ctx:i}),r.$set(n)},i(i){t||(k(r.$$.fragment,i),t=!0)},o(i){F(r.$$.fragment,i),t=!1},d(i){i&&b(e),N(r)}}}function Tt(s){let e=s[17]+"",r;return{c(){r=M(e)},l(t){r=W(t,e)},m(t,i){w(t,r,i)},p(t,i){i&1&&e!==(e=t[17]+"")&&ee(r,e)},d(t){t&&b(r)}}}function Me(s){let e,r,t,i;const l=[Dt,Ft],n=[];function f(o,a){return o[18]?0:1}return e=f(s),r=n[e]=l[e](s),{c(){r.c(),t=K()},l(o){r.l(o),t=K()},m(o,a){n[e].m(o,a),w(o,t,a),i=!0},p(o,a){let u=e;e=f(o),e===u?n[e].p(o,a):(Y(),F(n[u],1,1,()=>{n[u]=null}),J(),r=n[e],r?r.p(o,a):(r=n[e]=l[e](o),r.c()),k(r,1),r.m(t.parentNode,t))},i(o){i||(k(r),i=!0)},o(o){F(r),i=!1},d(o){o&&b(t),n[e].d(o)}}}function We(s){let e,r="Guidance",t,i,l=ue(s[0],s[7].proposed.trafficData)+"",n;return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),i=O("p"),n=M(l),this.h()},l(f){e=V(f,"U",{"data-svelte-h":!0}),pe(e)!=="svelte-qh7mhq"&&(e.textContent=r),t=W(f,`
      :
      `),i=V(f,"P",{style:!0});var o=z(i);n=W(o,l),o.forEach(b),this.h()},h(){x(i,"max-width","400px")},m(f,o){w(f,e,o),w(f,t,o),w(f,i,o),I(i,n)},p(f,o){o&129&&l!==(l=ue(f[0],f[7].proposed.trafficData)+"")&&ee(n,l)},d(f){f&&(b(e),b(t),b(i))}}}function Lt(s){let e;return{c(){e=M("←")},l(r){e=W(r,"←")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function St(s){let e;return{c(){e=M("Delete")},l(r){e=W(r,"Delete")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function Ct(s){let e;return{c(){e=M("→")},l(r){e=W(r,"→")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function Nt(s){let e,r,t,i,l,n,f,o,a,u,d,y;function $(_){s[11](_)}let v={label:"Street feature type",emptyOption:!0,choices:s[8]};s[6]!==void 0&&(v.value=s[6]),r=new Q({props:v}),j.push(()=>A(r,"value",$));let p=s[0]&&Pe(s);return f=new le({props:{disabled:s[1],$$slots:{default:[Lt]},$$scope:{ctx:s}}}),f.$on("click",s[12]),a=new Ae({props:{$$slots:{default:[St]},$$scope:{ctx:s}}}),a.$on("click",s[13]),d=new le({props:{disabled:s[2],$$slots:{default:[Ct]},$$scope:{ctx:s}}}),d.$on("click",s[14]),{c(){e=O("div"),L(r.$$.fragment),i=R(),p&&p.c(),l=R(),n=O("div"),L(f.$$.fragment),o=R(),L(a.$$.fragment),u=R(),L(d.$$.fragment),this.h()},l(_){e=V(_,"DIV",{class:!0});var c=z(e);S(r.$$.fragment,c),i=P(c),p&&p.l(c),l=P(c),n=V(c,"DIV",{style:!0,class:!0});var g=z(n);S(f.$$.fragment,g),o=P(g),S(a.$$.fragment,g),u=P(g),S(d.$$.fragment,g),g.forEach(b),c.forEach(b),this.h()},h(){x(n,"display","flex"),x(n,"justify-content","space-between"),X(n,"class","svelte-jig4ga"),X(e,"class","svelte-jig4ga")},m(_,c){w(_,e,c),C(r,e,null),I(e,i),p&&p.m(e,null),I(e,l),I(e,n),C(f,n,null),I(n,o),C(a,n,null),I(n,u),C(d,n,null),y=!0},p(_,[c]){const g={};c&256&&(g.choices=_[8]),!t&&c&64&&(t=!0,g.value=_[6],U(()=>t=!1)),r.$set(g),_[0]?p?(p.p(_,c),c&1&&k(p,1)):(p=Pe(_),p.c(),k(p,1),p.m(e,l)):p&&(Y(),F(p,1,1,()=>{p=null}),J());const T={};c&2&&(T.disabled=_[1]),c&2097152&&(T.$$scope={dirty:c,ctx:_}),f.$set(T);const m={};c&2097152&&(m.$$scope={dirty:c,ctx:_}),a.$set(m);const D={};c&4&&(D.disabled=_[2]),c&2097152&&(D.$$scope={dirty:c,ctx:_}),d.$set(D)},i(_){y||(k(r.$$.fragment,_),k(p),k(f.$$.fragment,_),k(a.$$.fragment,_),k(d.$$.fragment,_),y=!0)},o(_){F(r.$$.fragment,_),F(p),F(f.$$.fragment,_),F(a.$$.fragment,_),F(d.$$.fragment,_),y=!1},d(_){_&&b(e),N(r),p&&p.d(),N(f),N(a),N(d)}}}function Rt(s,e,r){let t,i,l;ae(s,E,m=>r(7,l=m));let{value:n}=e,{isFirst:f}=e,{isLast:o}=e,{sectionType:a}=e,{leftFeature:u}=e,{rightFeature:d}=e,y=et(),$=typeof n=="object"?`custom_${n.custom}`:n;function v(m){m.startsWith("custom_")?r(0,n={custom:m.slice(7)}):r(0,n=m)}function p(m){let D=Z(it);for(let[G,ce]of Object.entries(m))D.push([`custom_${G}`,`Custom: ${ce.name}`]);return D}function _(m){$=m,r(6,$)}const c=()=>y("moveLeft"),g=()=>y("delete"),T=()=>y("moveRight");return s.$$set=m=>{"value"in m&&r(0,n=m.value),"isFirst"in m&&r(1,f=m.isFirst),"isLast"in m&&r(2,o=m.isLast),"sectionType"in m&&r(3,a=m.sectionType),"leftFeature"in m&&r(4,u=m.leftFeature),"rightFeature"in m&&r(5,d=m.rightFeature)},s.$$.update=()=>{s.$$.dirty&49&&r(9,t=n&&at(n,u,d)),s.$$.dirty&64&&v($),s.$$.dirty&128&&r(8,i=p(l.proposed.customFeatures))},[n,f,o,a,u,d,$,l,i,t,y,_,c,g,T]}class Pt extends se{constructor(e){super(),ie(this,e,Rt,Nt,re,{value:0,isFirst:1,isLast:2,sectionType:3,leftFeature:4,rightFeature:5})}}function Ee(s,e,r){const t=s.slice();return t[12]=e[r],t[13]=e,t[14]=r,t}function qt(s){let e;return{c(){e=M("Add")},l(r){e=W(r,"Add")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function Ie(s,e){let r,t,i,l;function n(d){e[8](d,e[12],e[13],e[14])}function f(){return e[9](e[14])}function o(){return e[10](e[14])}function a(){return e[11](e[14])}let u={isFirst:e[14]==0,isLast:e[14]==e[0].length-1,leftFeature:e[14]==0?"":e[0][e[14]-1],rightFeature:e[14]==e[0].length-1?"":e[0][e[14]+1],sectionType:e[1]};return e[12]!==void 0&&(u.value=e[12]),t=new Pt({props:u}),j.push(()=>A(t,"value",n)),t.$on("delete",f),t.$on("moveLeft",o),t.$on("moveRight",a),{key:s,first:null,c(){r=K(),L(t.$$.fragment),this.h()},l(d){r=K(),S(t.$$.fragment,d),this.h()},h(){this.first=r},m(d,y){w(d,r,y),C(t,d,y),l=!0},p(d,y){e=d;const $={};y&1&&($.isFirst=e[14]==0),y&1&&($.isLast=e[14]==e[0].length-1),y&1&&($.leftFeature=e[14]==0?"":e[0][e[14]-1]),y&1&&($.rightFeature=e[14]==e[0].length-1?"":e[0][e[14]+1]),y&2&&($.sectionType=e[1]),!i&&y&1&&(i=!0,$.value=e[12],U(()=>i=!1)),t.$set($)},i(d){l||(k(t.$$.fragment,d),l=!0)},o(d){F(t.$$.fragment,d),l=!1},d(d){d&&b(r),N(t,d)}}}function Mt(s){let e,r,t,i=[],l=new Map,n,f,o,a,u=s[2].toFixed(2)+"",d,y;e=new le({props:{$$slots:{default:[qt]},$$scope:{ctx:s}}}),e.$on("click",s[3]);let $=te(s[0]);const v=p=>p[14];for(let p=0;p<$.length;p+=1){let _=Ee(s,$,p),c=v(_);l.set(c,i[p]=Ie(c,_))}return{c(){L(e.$$.fragment),r=R(),t=O("div");for(let p=0;p<i.length;p+=1)i[p].c();n=R(),f=O("p"),o=M("Total width required (m): "),a=O("b"),d=M(u),this.h()},l(p){S(e.$$.fragment,p),r=P(p),t=V(p,"DIV",{style:!0});var _=z(t);for(let T=0;T<i.length;T+=1)i[T].l(_);_.forEach(b),n=P(p),f=V(p,"P",{});var c=z(f);o=W(c,"Total width required (m): "),a=V(c,"B",{});var g=z(a);d=W(g,u),g.forEach(b),c.forEach(b),this.h()},h(){x(t,"display","flex"),x(t,"flex-direction","row")},m(p,_){C(e,p,_),w(p,r,_),w(p,t,_);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(t,null);w(p,n,_),w(p,f,_),I(f,o),I(f,a),I(a,d),y=!0},p(p,[_]){const c={};_&32768&&(c.$$scope={dirty:_,ctx:p}),e.$set(c),_&115&&($=te(p[0]),Y(),i=je(i,_,v,1,p,$,l,t,Ue,Ie,null,Ee),J()),(!y||_&4)&&u!==(u=p[2].toFixed(2)+"")&&ee(d,u)},i(p){if(!y){k(e.$$.fragment,p);for(let _=0;_<$.length;_+=1)k(i[_]);y=!0}},o(p){F(e.$$.fragment,p);for(let _=0;_<i.length;_+=1)F(i[_]);y=!1},d(p){p&&(b(r),b(t),b(n),b(f)),N(e,p);for(let _=0;_<i.length;_+=1)i[_].d()}}}function Wt(s,e,r){let t,i;ae(s,E,p=>r(7,i=p));let{streetFeaturesLeftToRight:l}=e,{sectionType:n}=e;function f(){r(0,l=[...l,""])}function o(p){l.splice(p,1),r(0,l)}function a(p){r(0,[l[p-1],l[p]]=[l[p],l[p-1]],l)}function u(p){r(0,[l[p+1],l[p]]=[l[p],l[p+1]],l)}function d(p,_,c,g){c[g]=p,r(0,l)}const y=p=>o(p),$=p=>a(p),v=p=>u(p);return s.$$set=p=>{"streetFeaturesLeftToRight"in p&&r(0,l=p.streetFeaturesLeftToRight),"sectionType"in p&&r(1,n=p.sectionType)},s.$$.update=()=>{s.$$.dirty&130&&r(2,t=lt(i,n))},[l,n,t,f,o,a,u,i,d,y,$,v]}class Ge extends se{constructor(e){super(),ie(this,e,Wt,Mt,re,{streetFeaturesLeftToRight:0,sectionType:1})}}function Be(s,e,r){const t=s.slice();return t[6]=e[r],t[7]=e,t[8]=r,t}function Et(s){let e;return{c(){e=M("Add")},l(r){e=W(r,"Add")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function It(s){let e;return{c(){e=M("Delete")},l(r){e=W(r,"Delete")},m(r,t){w(r,e,t)},d(r){r&&b(e)}}}function Oe(s,e){let r,t,i,l,n,f,o,a,u,d;function y(c){e[3](c,e[6])}let $={label:"Name"};e[0].proposed.customFeatures[e[6]].name!==void 0&&($.value=e[0].proposed.customFeatures[e[6]].name),t=new ut({props:$}),j.push(()=>A(t,"value",y));function v(c){e[4](c,e[6])}let p={label:"Minimum width (m)",width:4,min:0};e[0].proposed.customFeatures[e[6]].width!==void 0&&(p.value=e[0].proposed.customFeatures[e[6]].width),n=new ot({props:p}),j.push(()=>A(n,"value",v));function _(){return e[5](e[6])}return a=new Ae({props:{$$slots:{default:[It]},$$scope:{ctx:e}}}),a.$on("click",_),{key:s,first:null,c(){r=O("div"),L(t.$$.fragment),l=R(),L(n.$$.fragment),o=R(),L(a.$$.fragment),u=R(),this.h()},l(c){r=V(c,"DIV",{style:!0});var g=z(r);S(t.$$.fragment,g),l=P(g),S(n.$$.fragment,g),o=P(g),S(a.$$.fragment,g),u=P(g),g.forEach(b),this.h()},h(){x(r,"display","flex"),x(r,"justify-content","space-between"),this.first=r},m(c,g){w(c,r,g),C(t,r,null),I(r,l),C(n,r,null),I(r,o),C(a,r,null),I(r,u),d=!0},p(c,g){e=c;const T={};!i&&g&1&&(i=!0,T.value=e[0].proposed.customFeatures[e[6]].name,U(()=>i=!1)),t.$set(T);const m={};!f&&g&1&&(f=!0,m.value=e[0].proposed.customFeatures[e[6]].width,U(()=>f=!1)),n.$set(m);const D={};g&512&&(D.$$scope={dirty:g,ctx:e}),a.$set(D)},i(c){d||(k(t.$$.fragment,c),k(n.$$.fragment,c),k(a.$$.fragment,c),d=!0)},o(c){F(t.$$.fragment,c),F(n.$$.fragment,c),F(a.$$.fragment,c),d=!1},d(c){c&&b(r),N(t),N(n),N(a)}}}function Bt(s){let e,r,t=[],i=new Map,l,n;e=new le({props:{$$slots:{default:[Et]},$$scope:{ctx:s}}}),e.$on("click",s[1]);let f=te(Object.keys(s[0].proposed.customFeatures));const o=a=>a[6];for(let a=0;a<f.length;a+=1){let u=Be(s,f,a),d=o(u);i.set(d,t[a]=Oe(d,u))}return{c(){L(e.$$.fragment),r=R();for(let a=0;a<t.length;a+=1)t[a].c();l=K()},l(a){S(e.$$.fragment,a),r=P(a);for(let u=0;u<t.length;u+=1)t[u].l(a);l=K()},m(a,u){C(e,a,u),w(a,r,u);for(let d=0;d<t.length;d+=1)t[d]&&t[d].m(a,u);w(a,l,u),n=!0},p(a,[u]){const d={};u&512&&(d.$$scope={dirty:u,ctx:a}),e.$set(d),u&5&&(f=te(Object.keys(a[0].proposed.customFeatures)),Y(),t=je(t,u,o,1,a,f,i,l.parentNode,Ue,Oe,l,Be),J())},i(a){if(!n){k(e.$$.fragment,a);for(let u=0;u<f.length;u+=1)k(t[u]);n=!0}},o(a){F(e.$$.fragment,a);for(let u=0;u<t.length;u+=1)F(t[u]);n=!1},d(a){a&&(b(r),b(l)),N(e,a);for(let u=0;u<t.length;u+=1)t[u].d(a)}}}function Ot(s,e,r){let t;ae(s,E,a=>r(0,t=a));function i(){rt(E,t.proposed.customFeatures[ze()]={name:"",width:0},t),E.set(t)}function l(a){let u=t.proposed.customFeatures[a].name;if(t.proposed.desirableMinimumCrossSection.includes({custom:a})){window.alert(`The ${u} custom feature is used in the Desirable Minimum Cross-Section. Remove it below before deleting.`);return}if(t.proposed.absoluteMinimumCrossSection.includes({custom:a})){window.alert(`The ${u} custom feature is used in the Absolute Minimum Cross-Section. Remove it below before deleting.`);return}delete t.proposed.customFeatures[a],E.set(t)}function n(a,u){s.$$.not_equal(t.proposed.customFeatures[u].name,a)&&(t.proposed.customFeatures[u].name=a,E.set(t))}function f(a,u){s.$$.not_equal(t.proposed.customFeatures[u].width,a)&&(t.proposed.customFeatures[u].width=a,E.set(t))}return[t,i,l,n,f,a=>l(a)]}class Vt extends se{constructor(e){super(),ie(this,e,Ot,Bt,re,{})}}function Ve(s){let e,r,t,i;return{c(){e=O("p"),r=M("Effective speed limit, based on the limit and 85 percentile: "),t=M(s[1]),i=M(`
      mph`)},l(l){e=V(l,"P",{});var n=z(e);r=W(n,"Effective speed limit, based on the limit and 85 percentile: "),t=W(n,s[1]),i=W(n,`
      mph`),n.forEach(b)},m(l,n){w(l,e,n),I(e,r),I(e,t),I(e,i)},p(l,n){n&2&&ee(t,l[1])},d(l){l&&b(e)}}}function jt(s){let e,r,t,i,l,n,f,o,a,u,d,y,$,v,p,_,c,g,T,m,D,G;function ce(h){s[4](h)}let me={label:"Expected peak hour cycle flow: 1-way cycle tracks",emptyOption:!0,choices:Z(["<200","200-800",">800"])};s[0].proposed.trafficData.flowOneWay!==void 0&&(me.value=s[0].proposed.trafficData.flowOneWay),e=new Q({props:me}),j.push(()=>A(e,"value",ce));function Ke(h){s[5](h)}let _e={label:"Expected peak hour cycle flow: 2-way cycle tracks",emptyOption:!0,choices:Z(["<300","300-1,000",">1,000"])};s[0].proposed.trafficData.flowTwoWay!==void 0&&(_e.value=s[0].proposed.trafficData.flowTwoWay),i=new Q({props:_e}),j.push(()=>A(i,"value",Ke));function Ye(h){s[6](h)}let he={label:"Expected peak hour cycle flow: shared use cycle tracks",emptyOption:!0,choices:Z(["<300",">300"])};s[0].proposed.trafficData.flowSharedUse!==void 0&&(he.value=s[0].proposed.trafficData.flowSharedUse),f=new Q({props:he}),j.push(()=>A(f,"value",Ye));function Je(h){s[7](h)}let ge={label:"Traffic flow (vpd)",emptyOption:!0,choices:Z(["<2,500","2,500-5,000","5,000-10,000",">10,000"])};s[0].proposed.trafficData.trafficFlow!==void 0&&(ge.value=s[0].proposed.trafficData.trafficFlow),u=new Q({props:ge}),j.push(()=>A(u,"value",Je));function Qe(h){s[8](h)}let $e={label:"Speed limit (MPH)",emptyOption:!0,choices:s[2]};s[0].proposed.trafficData.speedLimit!==void 0&&($e.value=s[0].proposed.trafficData.speedLimit),$=new Q({props:$e}),j.push(()=>A($,"value",Qe));function Xe(h){s[9](h)}let be={label:"Observed 85th percentile speed (MPH)",width:3,min:0,max:120};s[0].proposed.trafficData.observedSpeed!==void 0&&(be.value=s[0].proposed.trafficData.observedSpeed),_=new ht({props:be}),j.push(()=>A(_,"value",Xe));let B=s[1]&&Ve(s);function Ze(h){s[10](h)}let ve={label:"Street function",emptyOption:!0,choices:Z(["High Street (active frontages)","Residential street","Local distributor road"])};return s[0].proposed.trafficData.streetFunction!==void 0&&(ve.value=s[0].proposed.trafficData.streetFunction),m=new Q({props:ve}),j.push(()=>A(m,"value",Ze)),{c(){L(e.$$.fragment),t=R(),L(i.$$.fragment),n=R(),L(f.$$.fragment),a=R(),L(u.$$.fragment),y=R(),L($.$$.fragment),p=R(),L(_.$$.fragment),g=R(),B&&B.c(),T=R(),L(m.$$.fragment)},l(h){S(e.$$.fragment,h),t=P(h),S(i.$$.fragment,h),n=P(h),S(f.$$.fragment,h),a=P(h),S(u.$$.fragment,h),y=P(h),S($.$$.fragment,h),p=P(h),S(_.$$.fragment,h),g=P(h),B&&B.l(h),T=P(h),S(m.$$.fragment,h)},m(h,q){C(e,h,q),w(h,t,q),C(i,h,q),w(h,n,q),C(f,h,q),w(h,a,q),C(u,h,q),w(h,y,q),C($,h,q),w(h,p,q),C(_,h,q),w(h,g,q),B&&B.m(h,q),w(h,T,q),C(m,h,q),G=!0},p(h,q){const we={};!r&&q&1&&(r=!0,we.value=h[0].proposed.trafficData.flowOneWay,U(()=>r=!1)),e.$set(we);const ke={};!l&&q&1&&(l=!0,ke.value=h[0].proposed.trafficData.flowTwoWay,U(()=>l=!1)),i.$set(ke);const ye={};!o&&q&1&&(o=!0,ye.value=h[0].proposed.trafficData.flowSharedUse,U(()=>o=!1)),f.$set(ye);const Fe={};!d&&q&1&&(d=!0,Fe.value=h[0].proposed.trafficData.trafficFlow,U(()=>d=!1)),u.$set(Fe);const De={};!v&&q&1&&(v=!0,De.value=h[0].proposed.trafficData.speedLimit,U(()=>v=!1)),$.$set(De);const Te={};!c&&q&1&&(c=!0,Te.value=h[0].proposed.trafficData.observedSpeed,U(()=>c=!1)),_.$set(Te),h[1]?B?B.p(h,q):(B=Ve(h),B.c(),B.m(T.parentNode,T)):B&&(B.d(1),B=null);const Le={};!D&&q&1&&(D=!0,Le.value=h[0].proposed.trafficData.streetFunction,U(()=>D=!1)),m.$set(Le)},i(h){G||(k(e.$$.fragment,h),k(i.$$.fragment,h),k(f.$$.fragment,h),k(u.$$.fragment,h),k($.$$.fragment,h),k(_.$$.fragment,h),k(m.$$.fragment,h),G=!0)},o(h){F(e.$$.fragment,h),F(i.$$.fragment,h),F(f.$$.fragment,h),F(u.$$.fragment,h),F($.$$.fragment,h),F(_.$$.fragment,h),F(m.$$.fragment,h),G=!1},d(h){h&&(b(t),b(n),b(a),b(y),b(p),b(g),b(T)),N(e,h),N(i,h),N(f,h),N(u,h),N($,h),N(_,h),B&&B.d(h),N(m,h)}}}function Ut(s){let e,r;return e=new oe({props:{label:"Traffic data and additional information",$$slots:{default:[jt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},p(t,[i]){const l={};i&2051&&(l.$$scope={dirty:i,ctx:t}),e.$set(l)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function At(s,e,r){let t,i;ae(s,E,v=>r(0,i=v));let{valid:l}=e,n=Z(nt);function f(v){s.$$.not_equal(i.proposed.trafficData.flowOneWay,v)&&(i.proposed.trafficData.flowOneWay=v,E.set(i))}function o(v){s.$$.not_equal(i.proposed.trafficData.flowTwoWay,v)&&(i.proposed.trafficData.flowTwoWay=v,E.set(i))}function a(v){s.$$.not_equal(i.proposed.trafficData.flowSharedUse,v)&&(i.proposed.trafficData.flowSharedUse=v,E.set(i))}function u(v){s.$$.not_equal(i.proposed.trafficData.trafficFlow,v)&&(i.proposed.trafficData.trafficFlow=v,E.set(i))}function d(v){s.$$.not_equal(i.proposed.trafficData.speedLimit,v)&&(i.proposed.trafficData.speedLimit=v,E.set(i))}function y(v){s.$$.not_equal(i.proposed.trafficData.observedSpeed,v)&&(i.proposed.trafficData.observedSpeed=v,E.set(i))}function $(v){s.$$.not_equal(i.proposed.trafficData.streetFunction,v)&&(i.proposed.trafficData.streetFunction=v,E.set(i))}return s.$$set=v=>{"valid"in v&&r(3,l=v.valid)},s.$$.update=()=>{s.$$.dirty&1&&r(3,l=i.proposed.trafficData.flowOneWay!=""&&i.proposed.trafficData.flowTwoWay!=""&&i.proposed.trafficData.flowSharedUse!=""&&i.proposed.trafficData.trafficFlow!=""&&i.proposed.trafficData.speedLimit!=""&&i.proposed.trafficData.observedSpeed!=null&&i.proposed.trafficData.streetFunction!=""),s.$$.dirty&1&&r(1,t=He(i.proposed.trafficData.speedLimit,i.proposed.trafficData.observedSpeed))},[i,t,n,l,f,o,a,u,d,y,$]}class Ht extends se{constructor(e){super(),ie(this,e,At,Ut,re,{valid:3})}}function zt(s){let e,r;return e=new Vt({}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Gt(s){let e,r="Fill out all traffic data above to continue";return{c(){e=O("p"),e.textContent=r},l(t){e=V(t,"P",{"data-svelte-h":!0}),pe(e)!=="svelte-72a5ry"&&(e.textContent=r)},m(t,i){w(t,e,i)},p:ne,i:ne,o:ne,d(t){t&&b(e)}}}function Kt(s){let e,r,t,i;return e=new oe({props:{label:"Desirable Minimum Cross-Section",$$slots:{default:[Yt]},$$scope:{ctx:s}}}),t=new oe({props:{label:"Absolute Minimum Cross-Section",$$slots:{default:[Jt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment),r=R(),L(t.$$.fragment)},l(l){S(e.$$.fragment,l),r=P(l),S(t.$$.fragment,l)},m(l,n){C(e,l,n),w(l,r,n),C(t,l,n),i=!0},p(l,n){const f={};n&34&&(f.$$scope={dirty:n,ctx:l}),e.$set(f);const o={};n&34&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){i||(k(e.$$.fragment,l),k(t.$$.fragment,l),i=!0)},o(l){F(e.$$.fragment,l),F(t.$$.fragment,l),i=!1},d(l){l&&b(r),N(e,l),N(t,l)}}}function Yt(s){let e,r,t;function i(n){s[3](n)}let l={sectionType:"Desirable"};return s[1].proposed.desirableMinimumCrossSection!==void 0&&(l.streetFeaturesLeftToRight=s[1].proposed.desirableMinimumCrossSection),e=new Ge({props:l}),j.push(()=>A(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,f){C(e,n,f),t=!0},p(n,f){const o={};!r&&f&2&&(r=!0,o.streetFeaturesLeftToRight=n[1].proposed.desirableMinimumCrossSection,U(()=>r=!1)),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){N(e,n)}}}function Jt(s){let e,r,t;function i(n){s[4](n)}let l={sectionType:"Absolute"};return s[1].proposed.absoluteMinimumCrossSection!==void 0&&(l.streetFeaturesLeftToRight=s[1].proposed.absoluteMinimumCrossSection),e=new Ge({props:l}),j.push(()=>A(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,f){C(e,n,f),t=!0},p(n,f){const o={};!r&&f&2&&(r=!0,o.streetFeaturesLeftToRight=n[1].proposed.absoluteMinimumCrossSection,U(()=>r=!1)),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){N(e,n)}}}function Qt(s){let e,r,t,i,l,n,f,o,a,u,d;e=new st({props:{links:[["Tools","/"],["Route cross-section","/cross_section"]],current:"Proposed Cross-Sections"}});function y(c){s[2](c)}let $={};s[0]!==void 0&&($.valid=s[0]),t=new Ht({props:$}),j.push(()=>A(t,"valid",y)),n=new oe({props:{label:"Custom Street Features",$$slots:{default:[zt]},$$scope:{ctx:s}}});const v=[Kt,Gt],p=[];function _(c,g){return c[0]?0:1}return o=_(s),a=p[o]=v[o](s),{c(){L(e.$$.fragment),r=R(),L(t.$$.fragment),l=R(),L(n.$$.fragment),f=R(),a.c(),u=K()},l(c){S(e.$$.fragment,c),r=P(c),S(t.$$.fragment,c),l=P(c),S(n.$$.fragment,c),f=P(c),a.l(c),u=K()},m(c,g){C(e,c,g),w(c,r,g),C(t,c,g),w(c,l,g),C(n,c,g),w(c,f,g),p[o].m(c,g),w(c,u,g),d=!0},p(c,[g]){const T={};!i&&g&1&&(i=!0,T.valid=c[0],U(()=>i=!1)),t.$set(T);const m={};g&32&&(m.$$scope={dirty:g,ctx:c}),n.$set(m);let D=o;o=_(c),o===D?p[o].p(c,g):(Y(),F(p[D],1,1,()=>{p[D]=null}),J(),a=p[o],a?a.p(c,g):(a=p[o]=v[o](c),a.c()),k(a,1),a.m(u.parentNode,u))},i(c){d||(k(e.$$.fragment,c),k(t.$$.fragment,c),k(n.$$.fragment,c),k(a),d=!0)},o(c){F(e.$$.fragment,c),F(t.$$.fragment,c),F(n.$$.fragment,c),F(a),d=!1},d(c){c&&(b(r),b(l),b(f),b(u)),N(e,c),N(t,c),N(n,c),p[o].d(c)}}}function Xt(s,e,r){let t;ae(s,E,o=>r(1,t=o));let i=!1;function l(o){i=o,r(0,i)}function n(o){s.$$.not_equal(t.proposed.desirableMinimumCrossSection,o)&&(t.proposed.desirableMinimumCrossSection=o,E.set(t))}function f(o){s.$$.not_equal(t.proposed.absoluteMinimumCrossSection,o)&&(t.proposed.absoluteMinimumCrossSection=o,E.set(t))}return[i,t,l,n,f]}class mr extends se{constructor(e){super(),ie(this,e,Xt,Qt,re,{})}}export{mr as component};
