import{s as se,x as A,e as O,a as N,b as I,f as z,c as R,d as $,K as te,o as Ce,i as v,j as E,y as j,k as ne,a4 as Ge,t as B,z as K,h as W,B as Q,g as de,A as Ke,n as ee}from"../chunks/scheduler.CKOt2LAZ.js";import{S as le,i as oe,e as H,c as L,a as F,m as S,t as y,g as X,b as D,f as Z,d as C}from"../chunks/index.BDxETPF1.js";import{e as re,u as Ye,o as Je,B as Qe}from"../chunks/Geocoder.svelte_svelte_type_style_lang.AsJd5zsu.js";import{p as Y}from"../chunks/index.DdeVsZGZ.js";import{S as ue}from"../chunks/SecondaryButton.4VAZn6vt.js";import{S as J}from"../chunks/Select.DZs9del_.js";import{W as Xe}from"../chunks/WarningButton.DygY43-6.js";import{W as me}from"../chunks/WarningText.DL4g9wFt.js";import{s as V,a as Ze}from"../chunks/data.C70Kkrvn.js";import{E as xe}from"../chunks/ExternalLink.DeXOkzzb.js";import{C as ce}from"../chunks/CollapsibleCard.CtuKRKsi.js";import{N as et}from"../chunks/NumberInput.BmEmZ4gQ.js";import"../chunks/paths.BSN23lf9.js";function pe(a,e,t,r){switch(a){case"Footway":return[2.6,2];case"Narrow Traffic / Bus Lane":return[3.25,3.25];case"Wide Traffic / Bus Lane":return[4.5,3.9];case"Traffic Lane (no buses): speed limit 20/30":return[3,2.75];case"On-highway advisory/mandatory cycle lane":return[2,1.5];case"1-way protected cycle track":if(!e.flowOneWay)throw new Error("missing input");return{"<200":[2.3,1.8],"200-800":[2.5,2.3],">800":[2.8,2.3]}[e.flowOneWay];case"2-way protected cycle track":if(!e.flowTwoWay)throw new Error("missing input");return{"<300":[3.3,2.3],"300-1,000":[3.3,2.8],">1,000":[4.3,3.3]}[e.flowTwoWay];case"Shared use cycle track":if(!e.flowSharedUse)throw new Error("missing input");return{"<300":[3,3],">300":[4.5,4.5]}[e.flowSharedUse];case"Parking Bay":return[2,1.8];case"Disabled Parking Bay":return[2.7,2.7];case"Loading Bay":return[2.7,1.8];case"Buffer / Verge":{if(!e.speedLimit)throw new Error("missing input");let i=[.5,.5],s=[1.5,1.5],n=0;if(t&&(n+=G[t]),r&&(n+=G[r]),n<=1||n==4||n==10)return i;let l=e.speedLimit=="<30"||e.speedLimit=="30"||e.speedLimit=="40";return t=="Footway"&&r&&G[r]==2||r=="Footway"&&t&&G[t]==2?l?i:s:{"<30":[.5,0],30:[.5,0],40:[1,.5],50:[2,1.5],60:[2.5,2],70:[3.5,3]}[e.speedLimit]}}}let G={Footway:0,"1-way protected cycle track":0,"2-way protected cycle track":0,"Shared use cycle track":0,"Buffer / Verge":1,"Narrow Traffic / Bus Lane":2,"Wide Traffic / Bus Lane":2,"Traffic Lane (no buses): speed limit 20/30":2,"On-highway advisory/mandatory cycle lane":2,"Parking Bay":10,"Disabled Parking Bay":10,"Loading Bay":10};function tt(a,e,t){if(G[a]!=0)return"";let r=e&&(G[e]==2||G[e]==10),i=t&&(G[t]==2||G[t]==10);return r&&i?"both":r?"left":i?"right":""}function Ie(a,e){if(!a||!e)return null;let t=a=="<30"?20:parseInt(a);return e>t*1.1?t+10:t}let ie={Footway:[["Manual for Streets 2: Section 5 pp. 43","https://tsrgd.co.uk/pdf/mfs/mfs2.pdf#page=48"],["DMRB CD143 Designing for walking, cycling & horse-riding Annex pp. 7",""]],"Narrow Traffic / Bus Lane":[],"Wide Traffic / Bus Lane":[],"Traffic Lane (no buses): speed limit 20/30":[["LTN 1/20 Table 7-2 pp. 76",U(76)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"On-highway advisory/mandatory cycle lane":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"1-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"2-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"Shared use cycle track":[["LTN 1/20 Table 6-3 pp. 68",U(68)]],"Parking Bay":[["LTN 1/20 table 7-3 pp. 77",U(77)]],"Disabled Parking Bay":[],"Loading Bay":[["LTN 1/20 table 7-3 pp. 77",U(77)]],"Buffer / Verge":[["LTN 1/20 table 6-1 pp. 54",U(54)]]};function U(a){return`https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951074/cycle-infrastructure-design-ltn-1-20.pdf#page=${a}`}function ae(a,e){let t=Ie(e.speedLimit,e.observedSpeed);switch(a){case"Footway":return"There is no maximum width for footways; widths should take account of pedestrian volumes and composition. Suggested widths quoted here are the functional width available to the user";case"Narrow Traffic / Bus Lane":return"";case"Wide Traffic / Bus Lane":return"";case"Traffic Lane (no buses): speed limit 20/30":return e.trafficFlow=="<2,500"&&t==20?"Where traffic volumes are less than 2,500 vpd and speeds are less than 20mph, cycling in mixed traffic may be suitable for all users":"Where traffic volumes are greater than 2,500 vpd or speeds are greater than 20mph, cycling in mixed traffic is not suitable for all users";case"On-highway advisory/mandatory cycle lane":return(e.trafficFlow=="<2,500"||e.trafficFlow=="2,500-5,000")&&t==20?"Where traffic volumes are less than 2,500 vpd and/or speeds are less than 20mph, advisory or mandatory cycle lanes may be suitable for all users":"Where traffic volumes are greater than 5,000 vpd and/or speeds are greater than 20mph, advisory or mandatory cycle lanes are not suitable for all users";case"1-way protected cycle track":return t==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":t==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":t==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.";case"2-way protected cycle track":return t==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":t==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":t==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the userplus min. protection width 0.3m.";case"Shared use cycle track":return"Potential policy conflict: 'Cyclists must be separated from pedestrians' - have you considered alternatives to a shared use cycle track?";case"Parking Bay":return"";case"Disabled Parking Bay":return"";case"Loading Bay":return"";case"Buffer / Verge":return"Your buffer / verge shouldn't impact on the functional width of your footway or cycle-track"}}function Be(a,e,t){const r=a.slice();return r[14]=e[t][0],r[15]=e[t][1],r}function We(a){let e,t,r,i=pe(a[0],a[7].proposed.trafficData,a[4],a[5])[a[3]=="Desirable"?0:1]+"",s,n,l,u,d,g,m=ae(a[0],a[7].proposed.trafficData),b,h;const P=[at,it,rt],f=[];function o(_,k){return _[6]=="left"?0:_[6]=="right"?1:_[6]=="both"?2:-1}~(l=o(a))&&(u=f[l]=P[l](a));let c=ie[a[0]].length>0&&Pe(a),w=m&&Re(a);return{c(){e=O("p"),t=B(a[3]),r=B(" minimum width (m): "),s=B(i),n=N(),u&&u.c(),d=N(),c&&c.c(),g=N(),w&&w.c(),b=K()},l(_){e=I(_,"P",{});var k=z(e);t=W(k,a[3]),r=W(k," minimum width (m): "),s=W(k,i),k.forEach($),n=R(_),u&&u.l(_),d=R(_),c&&c.l(_),g=R(_),w&&w.l(_),b=K()},m(_,k){v(_,e,k),E(e,t),E(e,r),E(e,s),v(_,n,k),~l&&f[l].m(_,k),v(_,d,k),c&&c.m(_,k),v(_,g,k),w&&w.m(_,k),v(_,b,k),h=!0},p(_,k){(!h||k&8)&&Q(t,_[3]),(!h||k&185)&&i!==(i=pe(_[0],_[7].proposed.trafficData,_[4],_[5])[_[3]=="Desirable"?0:1]+"")&&Q(s,i);let M=l;l=o(_),l!==M&&(u&&(X(),D(f[M],1,1,()=>{f[M]=null}),Z()),~l?(u=f[l],u||(u=f[l]=P[l](_),u.c()),y(u,1),u.m(d.parentNode,d)):u=null),ie[_[0]].length>0?c?(c.p(_,k),k&1&&y(c,1)):(c=Pe(_),c.c(),y(c,1),c.m(g.parentNode,g)):c&&(X(),D(c,1,1,()=>{c=null}),Z()),k&129&&(m=ae(_[0],_[7].proposed.trafficData)),m?w?w.p(_,k):(w=Re(_),w.c(),w.m(b.parentNode,b)):w&&(w.d(1),w=null)},i(_){h||(y(u),y(c),h=!0)},o(_){D(u),D(c),h=!1},d(_){_&&($(e),$(n),$(d),$(g),$(b)),~l&&f[l].d(_),c&&c.d(_),w&&w.d(_)}}}function rt(a){let e,t;return e=new me({props:{$$slots:{default:[st]},$$scope:{ctx:a}}}),{c(){L(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,i){S(e,r,i),t=!0},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function it(a){let e,t;return e=new me({props:{$$slots:{default:[nt]},$$scope:{ctx:a}}}),{c(){L(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,i){S(e,r,i),t=!0},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function at(a){let e,t;return e=new me({props:{$$slots:{default:[lt]},$$scope:{ctx:a}}}),{c(){L(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,i){S(e,r,i),t=!0},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function st(a){let e;return{c(){e=B("Consider buffers to left and right")},l(t){e=W(t,"Consider buffers to left and right")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function nt(a){let e;return{c(){e=B("Consider buffer to right")},l(t){e=W(t,"Consider buffer to right")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function lt(a){let e;return{c(){e=B("Consider buffer to left")},l(t){e=W(t,"Consider buffer to left")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function Pe(a){let e,t="References",r,i,s,n=re(ie[a[0]]),l=[];for(let d=0;d<n.length;d+=1)l[d]=Ne(Be(a,n,d));const u=d=>D(l[d],1,1,()=>{l[d]=null});return{c(){e=O("u"),e.textContent=t,r=B(`
      :
      `),i=O("ul");for(let d=0;d<l.length;d+=1)l[d].c()},l(d){e=I(d,"U",{"data-svelte-h":!0}),de(e)!=="svelte-fk7cdq"&&(e.textContent=t),r=W(d,`
      :
      `),i=I(d,"UL",{});var g=z(i);for(let m=0;m<l.length;m+=1)l[m].l(g);g.forEach($)},m(d,g){v(d,e,g),v(d,r,g),v(d,i,g);for(let m=0;m<l.length;m+=1)l[m]&&l[m].m(i,null);s=!0},p(d,g){if(g&1){n=re(ie[d[0]]);let m;for(m=0;m<n.length;m+=1){const b=Be(d,n,m);l[m]?(l[m].p(b,g),y(l[m],1)):(l[m]=Ne(b),l[m].c(),y(l[m],1),l[m].m(i,null))}for(X(),m=n.length;m<l.length;m+=1)u(m);Z()}},i(d){if(!s){for(let g=0;g<n.length;g+=1)y(l[g]);s=!0}},o(d){l=l.filter(Boolean);for(let g=0;g<l.length;g+=1)D(l[g]);s=!1},d(d){d&&($(e),$(r),$(i)),Ke(l,d)}}}function ot(a){let e,t=a[14]+"",r;return{c(){e=O("li"),r=B(t)},l(i){e=I(i,"LI",{});var s=z(e);r=W(s,t),s.forEach($)},m(i,s){v(i,e,s),E(e,r)},p(i,s){s&1&&t!==(t=i[14]+"")&&Q(r,t)},i:ee,o:ee,d(i){i&&$(e)}}}function ft(a){let e,t,r;return t=new xe({props:{href:a[15],$$slots:{default:[ut]},$$scope:{ctx:a}}}),{c(){e=O("li"),L(t.$$.fragment)},l(i){e=I(i,"LI",{});var s=z(e);F(t.$$.fragment,s),s.forEach($)},m(i,s){v(i,e,s),S(t,e,null),r=!0},p(i,s){const n={};s&1&&(n.href=i[15]),s&262145&&(n.$$scope={dirty:s,ctx:i}),t.$set(n)},i(i){r||(y(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&$(e),C(t)}}}function ut(a){let e=a[14]+"",t;return{c(){t=B(e)},l(r){t=W(r,e)},m(r,i){v(r,t,i)},p(r,i){i&1&&e!==(e=r[14]+"")&&Q(t,e)},d(r){r&&$(t)}}}function Ne(a){let e,t,r,i;const s=[ft,ot],n=[];function l(u,d){return u[15]?0:1}return e=l(a),t=n[e]=s[e](a),{c(){t.c(),r=K()},l(u){t.l(u),r=K()},m(u,d){n[e].m(u,d),v(u,r,d),i=!0},p(u,d){let g=e;e=l(u),e===g?n[e].p(u,d):(X(),D(n[g],1,1,()=>{n[g]=null}),Z(),t=n[e],t?t.p(u,d):(t=n[e]=s[e](u),t.c()),y(t,1),t.m(r.parentNode,r))},i(u){i||(y(t),i=!0)},o(u){D(t),i=!1},d(u){u&&$(r),n[e].d(u)}}}function Re(a){let e,t="Guidance",r,i,s=ae(a[0],a[7].proposed.trafficData)+"",n;return{c(){e=O("u"),e.textContent=t,r=B(`
      :
      `),i=O("p"),n=B(s),this.h()},l(l){e=I(l,"U",{"data-svelte-h":!0}),de(e)!=="svelte-qh7mhq"&&(e.textContent=t),r=W(l,`
      :
      `),i=I(l,"P",{style:!0});var u=z(i);n=W(u,s),u.forEach($),this.h()},h(){te(i,"max-width","400px")},m(l,u){v(l,e,u),v(l,r,u),v(l,i,u),E(i,n)},p(l,u){u&129&&s!==(s=ae(l[0],l[7].proposed.trafficData)+"")&&Q(n,s)},d(l){l&&($(e),$(r),$(i))}}}function ct(a){let e;return{c(){e=B("←")},l(t){e=W(t,"←")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function pt(a){let e;return{c(){e=B("Delete")},l(t){e=W(t,"Delete")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function dt(a){let e;return{c(){e=B("→")},l(t){e=W(t,"→")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function mt(a){let e,t,r,i,s,n,l,u,d,g,m,b;function h(o){a[10](o)}let P={label:"Street feature type",emptyOption:!0,choices:a[9]};a[0]!==void 0&&(P.value=a[0]),t=new J({props:P}),A.push(()=>H(t,"value",h));let f=a[0]&&We(a);return l=new ue({props:{disabled:a[1],$$slots:{default:[ct]},$$scope:{ctx:a}}}),l.$on("click",a[11]),d=new Xe({props:{$$slots:{default:[pt]},$$scope:{ctx:a}}}),d.$on("click",a[12]),m=new ue({props:{disabled:a[2],$$slots:{default:[dt]},$$scope:{ctx:a}}}),m.$on("click",a[13]),{c(){e=O("div"),L(t.$$.fragment),i=N(),f&&f.c(),s=N(),n=O("div"),L(l.$$.fragment),u=N(),L(d.$$.fragment),g=N(),L(m.$$.fragment),this.h()},l(o){e=I(o,"DIV",{class:!0});var c=z(e);F(t.$$.fragment,c),i=R(c),f&&f.l(c),s=R(c),n=I(c,"DIV",{style:!0,class:!0});var w=z(n);F(l.$$.fragment,w),u=R(w),F(d.$$.fragment,w),g=R(w),F(m.$$.fragment,w),w.forEach($),c.forEach($),this.h()},h(){te(n,"display","flex"),te(n,"justify-content","space-between"),Ce(n,"class","svelte-jig4ga"),Ce(e,"class","svelte-jig4ga")},m(o,c){v(o,e,c),S(t,e,null),E(e,i),f&&f.m(e,null),E(e,s),E(e,n),S(l,n,null),E(n,u),S(d,n,null),E(n,g),S(m,n,null),b=!0},p(o,[c]){const w={};!r&&c&1&&(r=!0,w.value=o[0],j(()=>r=!1)),t.$set(w),o[0]?f?(f.p(o,c),c&1&&y(f,1)):(f=We(o),f.c(),y(f,1),f.m(e,s)):f&&(X(),D(f,1,1,()=>{f=null}),Z());const _={};c&2&&(_.disabled=o[1]),c&262144&&(_.$$scope={dirty:c,ctx:o}),l.$set(_);const k={};c&262144&&(k.$$scope={dirty:c,ctx:o}),d.$set(k);const M={};c&4&&(M.disabled=o[2]),c&262144&&(M.$$scope={dirty:c,ctx:o}),m.$set(M)},i(o){b||(y(t.$$.fragment,o),y(f),y(l.$$.fragment,o),y(d.$$.fragment,o),y(m.$$.fragment,o),b=!0)},o(o){D(t.$$.fragment,o),D(f),D(l.$$.fragment,o),D(d.$$.fragment,o),D(m.$$.fragment,o),b=!1},d(o){o&&$(e),C(t),f&&f.d(),C(l),C(d),C(m)}}}function ht(a,e,t){let r,i;ne(a,V,c=>t(7,i=c));let{value:s}=e,{isFirst:n}=e,{isLast:l}=e,{sectionType:u}=e,{leftFeature:d}=e,{rightFeature:g}=e,m=Ge(),b=Y(Ze);function h(c){s=c,t(0,s)}const P=()=>m("moveLeft"),f=()=>m("delete"),o=()=>m("moveRight");return a.$$set=c=>{"value"in c&&t(0,s=c.value),"isFirst"in c&&t(1,n=c.isFirst),"isLast"in c&&t(2,l=c.isLast),"sectionType"in c&&t(3,u=c.sectionType),"leftFeature"in c&&t(4,d=c.leftFeature),"rightFeature"in c&&t(5,g=c.rightFeature)},a.$$.update=()=>{a.$$.dirty&49&&t(6,r=s&&tt(s,d,g))},[s,n,l,u,d,g,r,i,m,b,h,P,f,o]}class _t extends le{constructor(e){super(),oe(this,e,ht,mt,se,{value:0,isFirst:1,isLast:2,sectionType:3,leftFeature:4,rightFeature:5})}}function qe(a,e,t){const r=a.slice();return r[13]=e[t],r[14]=e,r[15]=t,r}function gt(a){let e;return{c(){e=B("Add")},l(t){e=W(t,"Add")},m(t,r){v(t,e,r)},d(t){t&&$(e)}}}function Ee(a,e){let t,r,i,s;function n(m){e[8](m,e[13],e[14],e[15])}function l(){return e[9](e[15])}function u(){return e[10](e[15])}function d(){return e[11](e[15])}let g={isFirst:e[15]==0,isLast:e[15]==e[0].length-1,leftFeature:e[15]==0?"":e[0][e[15]-1],rightFeature:e[15]==e[0].length-1?"":e[0][e[15]+1],sectionType:e[1]};return e[13]!==void 0&&(g.value=e[13]),r=new _t({props:g}),A.push(()=>H(r,"value",n)),r.$on("delete",l),r.$on("moveLeft",u),r.$on("moveRight",d),{key:a,first:null,c(){t=K(),L(r.$$.fragment),this.h()},l(m){t=K(),F(r.$$.fragment,m),this.h()},h(){this.first=t},m(m,b){v(m,t,b),S(r,m,b),s=!0},p(m,b){e=m;const h={};b&1&&(h.isFirst=e[15]==0),b&1&&(h.isLast=e[15]==e[0].length-1),b&1&&(h.leftFeature=e[15]==0?"":e[0][e[15]-1]),b&1&&(h.rightFeature=e[15]==e[0].length-1?"":e[0][e[15]+1]),b&2&&(h.sectionType=e[1]),!i&&b&1&&(i=!0,h.value=e[13],j(()=>i=!1)),r.$set(h)},i(m){s||(y(r.$$.fragment,m),s=!0)},o(m){D(r.$$.fragment,m),s=!1},d(m){m&&$(t),C(r,m)}}}function $t(a){let e,t,r,i=[],s=new Map,n,l,u,d,g=a[2].toFixed(2)+"",m,b;e=new ue({props:{$$slots:{default:[gt]},$$scope:{ctx:a}}}),e.$on("click",a[3]);let h=re(a[0]);const P=f=>f[15];for(let f=0;f<h.length;f+=1){let o=qe(a,h,f),c=P(o);s.set(c,i[f]=Ee(c,o))}return{c(){L(e.$$.fragment),t=N(),r=O("div");for(let f=0;f<i.length;f+=1)i[f].c();n=N(),l=O("p"),u=B("Total width required (m): "),d=O("b"),m=B(g),this.h()},l(f){F(e.$$.fragment,f),t=R(f),r=I(f,"DIV",{style:!0});var o=z(r);for(let _=0;_<i.length;_+=1)i[_].l(o);o.forEach($),n=R(f),l=I(f,"P",{});var c=z(l);u=W(c,"Total width required (m): "),d=I(c,"B",{});var w=z(d);m=W(w,g),w.forEach($),c.forEach($),this.h()},h(){te(r,"display","flex"),te(r,"flex-direction","row")},m(f,o){S(e,f,o),v(f,t,o),v(f,r,o);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,null);v(f,n,o),v(f,l,o),E(l,u),E(l,d),E(d,m),b=!0},p(f,[o]){const c={};o&65536&&(c.$$scope={dirty:o,ctx:f}),e.$set(c),o&115&&(h=re(f[0]),X(),i=Ye(i,o,P,1,f,h,s,r,Je,Ee,null,qe),Z()),(!b||o&4)&&g!==(g=f[2].toFixed(2)+"")&&Q(m,g)},i(f){if(!b){y(e.$$.fragment,f);for(let o=0;o<h.length;o+=1)y(i[o]);b=!0}},o(f){D(e.$$.fragment,f);for(let o=0;o<i.length;o+=1)D(i[o]);b=!1},d(f){f&&($(t),$(r),$(n),$(l)),C(e,f);for(let o=0;o<i.length;o+=1)i[o].d()}}}function bt(a,e,t){let r,i;ne(a,V,o=>t(7,i=o));let{streetFeaturesLeftToRight:s}=e,{sectionType:n}=e;function l(){t(0,s=[...s,""])}function u(o){s.splice(o,1),t(0,s)}function d(o){t(0,[s[o-1],s[o]]=[s[o],s[o-1]],s)}function g(o){t(0,[s[o+1],s[o]]=[s[o],s[o+1]],s)}function m(o,c){let w=0;for(let _=0;_<s.length;_++){let k=s[_];if(!k)continue;let M=_==0?"":s[_-1],x=_==s.length-1?"":s[_+1],fe=pe(k,o.proposed.trafficData,M,x)[c=="Desirable"?0:1];w+=fe}return w}function b(o,c,w,_){w[_]=o,t(0,s)}const h=o=>u(o),P=o=>d(o),f=o=>g(o);return a.$$set=o=>{"streetFeaturesLeftToRight"in o&&t(0,s=o.streetFeaturesLeftToRight),"sectionType"in o&&t(1,n=o.sectionType)},a.$$.update=()=>{a.$$.dirty&130&&t(2,r=m(i,n))},[s,n,r,l,u,d,g,i,b,h,P,f]}class Me extends le{constructor(e){super(),oe(this,e,bt,$t,se,{streetFeaturesLeftToRight:0,sectionType:1})}}function Oe(a){let e,t,r,i;return{c(){e=O("p"),t=B("Effective speed limit, based on the limit and 85 percentile: "),r=B(a[1]),i=B(`
      mph`)},l(s){e=I(s,"P",{});var n=z(e);t=W(n,"Effective speed limit, based on the limit and 85 percentile: "),r=W(n,a[1]),i=W(n,`
      mph`),n.forEach($)},m(s,n){v(s,e,n),E(e,t),E(e,r),E(e,i)},p(s,n){n&2&&Q(r,s[1])},d(s){s&&$(e)}}}function wt(a){let e,t,r,i,s,n,l,u,d,g,m,b,h,P,f,o,c,w,_,k,M,x;function fe(p){a[3](p)}let he={label:"Expected peak hour cycle flow: 1-way cycle tracks",emptyOption:!0,choices:Y(["<200","200-800",">800"])};a[0].proposed.trafficData.flowOneWay!==void 0&&(he.value=a[0].proposed.trafficData.flowOneWay),e=new J({props:he}),A.push(()=>H(e,"value",fe));function Ve(p){a[4](p)}let _e={label:"Expected peak hour cycle flow: 2-way cycle tracks",emptyOption:!0,choices:Y(["<300","300-1,000",">1,000"])};a[0].proposed.trafficData.flowTwoWay!==void 0&&(_e.value=a[0].proposed.trafficData.flowTwoWay),i=new J({props:_e}),A.push(()=>H(i,"value",Ve));function Ue(p){a[5](p)}let ge={label:"Expected peak hour cycle flow: shared use cycle tracks",emptyOption:!0,choices:Y(["<300",">300"])};a[0].proposed.trafficData.flowSharedUse!==void 0&&(ge.value=a[0].proposed.trafficData.flowSharedUse),l=new J({props:ge}),A.push(()=>H(l,"value",Ue));function Ae(p){a[6](p)}let $e={label:"Traffic flow (vpd)",emptyOption:!0,choices:Y(["<2,500","2,500-5,000","5,000-10,000",">10,000"])};a[0].proposed.trafficData.trafficFlow!==void 0&&($e.value=a[0].proposed.trafficData.trafficFlow),g=new J({props:$e}),A.push(()=>H(g,"value",Ae));function je(p){a[7](p)}let be={label:"Speed limit (MPH)",emptyOption:!0,choices:Y(["<30","30","40","50","60","70"])};a[0].proposed.trafficData.speedLimit!==void 0&&(be.value=a[0].proposed.trafficData.speedLimit),h=new J({props:be}),A.push(()=>H(h,"value",je));function He(p){a[8](p)}let we={label:"Observed 85th percentile speed (MPH)",width:3,min:0,max:120};a[0].proposed.trafficData.observedSpeed!==void 0&&(we.value=a[0].proposed.trafficData.observedSpeed),o=new et({props:we}),A.push(()=>H(o,"value",He));let q=a[1]&&Oe(a);function ze(p){a[9](p)}let ve={label:"Street function",emptyOption:!0,choices:Y(["High Street (active frontages)","Residential street","Local distributor road"])};return a[0].proposed.trafficData.streetFunction!==void 0&&(ve.value=a[0].proposed.trafficData.streetFunction),k=new J({props:ve}),A.push(()=>H(k,"value",ze)),{c(){L(e.$$.fragment),r=N(),L(i.$$.fragment),n=N(),L(l.$$.fragment),d=N(),L(g.$$.fragment),b=N(),L(h.$$.fragment),f=N(),L(o.$$.fragment),w=N(),q&&q.c(),_=N(),L(k.$$.fragment)},l(p){F(e.$$.fragment,p),r=R(p),F(i.$$.fragment,p),n=R(p),F(l.$$.fragment,p),d=R(p),F(g.$$.fragment,p),b=R(p),F(h.$$.fragment,p),f=R(p),F(o.$$.fragment,p),w=R(p),q&&q.l(p),_=R(p),F(k.$$.fragment,p)},m(p,T){S(e,p,T),v(p,r,T),S(i,p,T),v(p,n,T),S(l,p,T),v(p,d,T),S(g,p,T),v(p,b,T),S(h,p,T),v(p,f,T),S(o,p,T),v(p,w,T),q&&q.m(p,T),v(p,_,T),S(k,p,T),x=!0},p(p,T){const ye={};!t&&T&1&&(t=!0,ye.value=p[0].proposed.trafficData.flowOneWay,j(()=>t=!1)),e.$set(ye);const ke={};!s&&T&1&&(s=!0,ke.value=p[0].proposed.trafficData.flowTwoWay,j(()=>s=!1)),i.$set(ke);const De={};!u&&T&1&&(u=!0,De.value=p[0].proposed.trafficData.flowSharedUse,j(()=>u=!1)),l.$set(De);const Te={};!m&&T&1&&(m=!0,Te.value=p[0].proposed.trafficData.trafficFlow,j(()=>m=!1)),g.$set(Te);const Le={};!P&&T&1&&(P=!0,Le.value=p[0].proposed.trafficData.speedLimit,j(()=>P=!1)),h.$set(Le);const Fe={};!c&&T&1&&(c=!0,Fe.value=p[0].proposed.trafficData.observedSpeed,j(()=>c=!1)),o.$set(Fe),p[1]?q?q.p(p,T):(q=Oe(p),q.c(),q.m(_.parentNode,_)):q&&(q.d(1),q=null);const Se={};!M&&T&1&&(M=!0,Se.value=p[0].proposed.trafficData.streetFunction,j(()=>M=!1)),k.$set(Se)},i(p){x||(y(e.$$.fragment,p),y(i.$$.fragment,p),y(l.$$.fragment,p),y(g.$$.fragment,p),y(h.$$.fragment,p),y(o.$$.fragment,p),y(k.$$.fragment,p),x=!0)},o(p){D(e.$$.fragment,p),D(i.$$.fragment,p),D(l.$$.fragment,p),D(g.$$.fragment,p),D(h.$$.fragment,p),D(o.$$.fragment,p),D(k.$$.fragment,p),x=!1},d(p){p&&($(r),$(n),$(d),$(b),$(f),$(w),$(_)),C(e,p),C(i,p),C(l,p),C(g,p),C(h,p),C(o,p),q&&q.d(p),C(k,p)}}}function vt(a){let e,t;return e=new ce({props:{label:"Traffic data and additional information",$$slots:{default:[wt]},$$scope:{ctx:a}}}),{c(){L(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,i){S(e,r,i),t=!0},p(r,[i]){const s={};i&1027&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function yt(a,e,t){let r,i;ne(a,V,h=>t(0,i=h));let{valid:s}=e;function n(h){a.$$.not_equal(i.proposed.trafficData.flowOneWay,h)&&(i.proposed.trafficData.flowOneWay=h,V.set(i))}function l(h){a.$$.not_equal(i.proposed.trafficData.flowTwoWay,h)&&(i.proposed.trafficData.flowTwoWay=h,V.set(i))}function u(h){a.$$.not_equal(i.proposed.trafficData.flowSharedUse,h)&&(i.proposed.trafficData.flowSharedUse=h,V.set(i))}function d(h){a.$$.not_equal(i.proposed.trafficData.trafficFlow,h)&&(i.proposed.trafficData.trafficFlow=h,V.set(i))}function g(h){a.$$.not_equal(i.proposed.trafficData.speedLimit,h)&&(i.proposed.trafficData.speedLimit=h,V.set(i))}function m(h){a.$$.not_equal(i.proposed.trafficData.observedSpeed,h)&&(i.proposed.trafficData.observedSpeed=h,V.set(i))}function b(h){a.$$.not_equal(i.proposed.trafficData.streetFunction,h)&&(i.proposed.trafficData.streetFunction=h,V.set(i))}return a.$$set=h=>{"valid"in h&&t(2,s=h.valid)},a.$$.update=()=>{a.$$.dirty&1&&t(2,s=i.proposed.trafficData.flowOneWay!=""&&i.proposed.trafficData.flowTwoWay!=""&&i.proposed.trafficData.flowSharedUse!=""&&i.proposed.trafficData.trafficFlow!=""&&i.proposed.trafficData.speedLimit!=""&&i.proposed.trafficData.observedSpeed!=null&&i.proposed.trafficData.streetFunction!=""),a.$$.dirty&1&&t(1,r=Ie(i.proposed.trafficData.speedLimit,i.proposed.trafficData.observedSpeed))},[i,r,s,n,l,u,d,g,m,b]}class kt extends le{constructor(e){super(),oe(this,e,yt,vt,se,{valid:2})}}function Dt(a){let e,t="Fill out all data above to continue";return{c(){e=O("p"),e.textContent=t},l(r){e=I(r,"P",{"data-svelte-h":!0}),de(e)!=="svelte-ma95"&&(e.textContent=t)},m(r,i){v(r,e,i)},p:ee,i:ee,o:ee,d(r){r&&$(e)}}}function Tt(a){let e,t,r,i;return e=new ce({props:{label:"Desirable Minimum Cross-Section",$$slots:{default:[Lt]},$$scope:{ctx:a}}}),r=new ce({props:{label:"Absolute Minimum Cross-Section",$$slots:{default:[Ft]},$$scope:{ctx:a}}}),{c(){L(e.$$.fragment),t=N(),L(r.$$.fragment)},l(s){F(e.$$.fragment,s),t=R(s),F(r.$$.fragment,s)},m(s,n){S(e,s,n),v(s,t,n),S(r,s,n),i=!0},p(s,n){const l={};n&34&&(l.$$scope={dirty:n,ctx:s}),e.$set(l);const u={};n&34&&(u.$$scope={dirty:n,ctx:s}),r.$set(u)},i(s){i||(y(e.$$.fragment,s),y(r.$$.fragment,s),i=!0)},o(s){D(e.$$.fragment,s),D(r.$$.fragment,s),i=!1},d(s){s&&$(t),C(e,s),C(r,s)}}}function Lt(a){let e,t,r;function i(n){a[3](n)}let s={sectionType:"Desirable"};return a[1].proposed.desirableMinimumCrossSection!==void 0&&(s.streetFeaturesLeftToRight=a[1].proposed.desirableMinimumCrossSection),e=new Me({props:s}),A.push(()=>H(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,l){S(e,n,l),r=!0},p(n,l){const u={};!t&&l&2&&(t=!0,u.streetFeaturesLeftToRight=n[1].proposed.desirableMinimumCrossSection,j(()=>t=!1)),e.$set(u)},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),r=!1},d(n){C(e,n)}}}function Ft(a){let e,t,r;function i(n){a[4](n)}let s={sectionType:"Absolute"};return a[1].proposed.absoluteMinimumCrossSection!==void 0&&(s.streetFeaturesLeftToRight=a[1].proposed.absoluteMinimumCrossSection),e=new Me({props:s}),A.push(()=>H(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,l){S(e,n,l),r=!0},p(n,l){const u={};!t&&l&2&&(t=!0,u.streetFeaturesLeftToRight=n[1].proposed.absoluteMinimumCrossSection,j(()=>t=!1)),e.$set(u)},i(n){r||(y(e.$$.fragment,n),r=!0)},o(n){D(e.$$.fragment,n),r=!1},d(n){C(e,n)}}}function St(a){let e,t,r,i,s,n,l,u,d;e=new Qe({props:{links:[["Tools","/"],["Route cross-section","/cross_section"]],current:"Proposed Cross-Sections"}});function g(f){a[2](f)}let m={};a[0]!==void 0&&(m.valid=a[0]),r=new kt({props:m}),A.push(()=>H(r,"valid",g));const b=[Tt,Dt],h=[];function P(f,o){return f[0]?0:1}return n=P(a),l=h[n]=b[n](a),{c(){L(e.$$.fragment),t=N(),L(r.$$.fragment),s=N(),l.c(),u=K()},l(f){F(e.$$.fragment,f),t=R(f),F(r.$$.fragment,f),s=R(f),l.l(f),u=K()},m(f,o){S(e,f,o),v(f,t,o),S(r,f,o),v(f,s,o),h[n].m(f,o),v(f,u,o),d=!0},p(f,[o]){const c={};!i&&o&1&&(i=!0,c.valid=f[0],j(()=>i=!1)),r.$set(c);let w=n;n=P(f),n===w?h[n].p(f,o):(X(),D(h[w],1,1,()=>{h[w]=null}),Z(),l=h[n],l?l.p(f,o):(l=h[n]=b[n](f),l.c()),y(l,1),l.m(u.parentNode,u))},i(f){d||(y(e.$$.fragment,f),y(r.$$.fragment,f),y(l),d=!0)},o(f){D(e.$$.fragment,f),D(r.$$.fragment,f),D(l),d=!1},d(f){f&&($(t),$(s),$(u)),C(e,f),C(r,f),h[n].d(f)}}}function Ct(a,e,t){let r;ne(a,V,u=>t(1,r=u));let i=!1;function s(u){i=u,t(0,i)}function n(u){a.$$.not_equal(r.proposed.desirableMinimumCrossSection,u)&&(r.proposed.desirableMinimumCrossSection=u,V.set(r))}function l(u){a.$$.not_equal(r.proposed.absoluteMinimumCrossSection,u)&&(r.proposed.absoluteMinimumCrossSection=u,V.set(r))}return[i,r,s,n,l]}class jt extends le{constructor(e){super(),oe(this,e,Ct,St,se,{})}}export{jt as component};
