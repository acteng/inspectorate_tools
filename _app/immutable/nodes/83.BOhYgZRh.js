import{s as ve,v as Z,x as Q,l as Ue,u as Ke,m as Je,o as Ye,H as ue,e as U,t as le,a as M,c as K,b as J,d as ie,f as v,g as q,r as G,w as te,i as S,h as O,k as Ie,z as Ze,U as Qe,a7 as Xe,E as Te,p as ke,q as ge,N as Be,j as $e,n as xe,R as Ce,S as we}from"../chunks/scheduler.Bsni_e59.js";import{S as be,i as ye,e as X,c as z,a as j,m as P,t as C,b as L,d as V,f as ae,g as fe}from"../chunks/index.CCfAUppz.js";import{L as et,g as tt,M as nt,a as lt,G as it}from"../chunks/MapLibreMap.D3PM_1LX.js";import{e as re}from"../chunks/each.ChCadThl.js";import{c as ot,p as rt}from"../chunks/colors.CYEpEtTL.js";import{p as Ge}from"../chunks/index.CJIxAprs.js";import{S as pe}from"../chunks/Select.N7F_8zcJ.js";import{T as He}from"../chunks/TextArea.DbePhW6L.js";import{T as Oe}from"../chunks/TextInput.CHbK327s.js";import{s as H}from"../chunks/data.DnmlV0w6.js";import{s as de,b as he,a as st,B as at,G as ft,R as ut,S as ct,c as _t,M as We}from"../chunks/GeoreferenceLayer.CjbzHi-3.js";import{Y as Re}from"../chunks/YesNo.CO6ROCDj.js";import{D as mt}from"../chunks/DefaultButton.DyQsHGbh.js";import{W as gt,S as Se}from"../chunks/WarningButton.D9QeV9gM.js";function pt(t){let e;const l=t[16].default,n=Ue(l,t,t[24],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,c){n&&n.m(i,c),e=!0},p(i,c){n&&n.p&&(!e||c&16777216)&&Ke(n,l,i,i[24],e?Ye(l,i[24],c,null):Je(i[24]),null)},i(i){e||(C(n,i),e=!0)},o(i){L(n,i),e=!1},d(i){n&&n.d(i)}}}function dt(t){let e,l,n;function i(a){t[17](a)}let c={id:t[1],type:"circle",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[pt]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.hovered=t[0]),e=new et({props:c}),Z.push(()=>X(e,"hovered",i)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){z(e.$$.fragment)},l(a){j(e.$$.fragment,a)},m(a,s){P(e,a,s),n=!0},p(a,[s]){const r={};s&2&&(r.id=a[1]),s&4&&(r.source=a[2]),s&8&&(r.sourceLayer=a[3]),s&16&&(r.beforeId=a[4]),s&32&&(r.beforeLayerType=a[5]),s&64&&(r.paint=a[6]),s&128&&(r.layout=a[7]),s&256&&(r.filter=a[8]),s&512&&(r.applyToClusters=a[9]),s&1024&&(r.minzoom=a[10]),s&2048&&(r.maxzoom=a[11]),s&4096&&(r.hoverCursor=a[12]),s&8192&&(r.manageHoverState=a[13]),s&16384&&(r.eventsIfTopMost=a[14]),s&32768&&(r.interactive=a[15]),s&16777216&&(r.$$scope={dirty:s,ctx:a}),!l&&s&1&&(l=!0,r.hovered=a[0],Q(()=>l=!1)),e.$set(r)},i(a){n||(C(e.$$.fragment,a),n=!0)},o(a){L(e.$$.fragment,a),n=!1},d(a){V(e,a)}}}function ht(t,e,l){let{$$slots:n={},$$scope:i}=e,{id:c=tt("circle")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:r=void 0}=e,{beforeLayerType:y=void 0}=e,{paint:p}=e,{layout:_=void 0}=e,{filter:b=void 0}=e,{applyToClusters:f=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:A=void 0}=e,{hoverCursor:T=void 0}=e,{manageHoverState:g=!1}=e,{hovered:I=null}=e,{eventsIfTopMost:B=!1}=e,{interactive:F=!0}=e;function W(m){I=m,l(0,I)}function E(m){ue.call(this,t,m)}function Y(m){ue.call(this,t,m)}function D(m){ue.call(this,t,m)}function oe(m){ue.call(this,t,m)}function ne(m){ue.call(this,t,m)}function x(m){ue.call(this,t,m)}return t.$$set=m=>{"id"in m&&l(1,c=m.id),"source"in m&&l(2,a=m.source),"sourceLayer"in m&&l(3,s=m.sourceLayer),"beforeId"in m&&l(4,r=m.beforeId),"beforeLayerType"in m&&l(5,y=m.beforeLayerType),"paint"in m&&l(6,p=m.paint),"layout"in m&&l(7,_=m.layout),"filter"in m&&l(8,b=m.filter),"applyToClusters"in m&&l(9,f=m.applyToClusters),"minzoom"in m&&l(10,d=m.minzoom),"maxzoom"in m&&l(11,A=m.maxzoom),"hoverCursor"in m&&l(12,T=m.hoverCursor),"manageHoverState"in m&&l(13,g=m.manageHoverState),"hovered"in m&&l(0,I=m.hovered),"eventsIfTopMost"in m&&l(14,B=m.eventsIfTopMost),"interactive"in m&&l(15,F=m.interactive),"$$scope"in m&&l(24,i=m.$$scope)},[I,c,a,s,r,y,p,_,b,f,d,A,T,g,B,F,n,W,E,Y,D,oe,ne,x,i]}class vt extends be{constructor(e){super(),ye(this,e,ht,dt,ve,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function $t(t){let e,l,n,i,c,a,s,r,y,p,_,b,f,d,A,T,g,I,B,F,W,E,Y,D;function oe(o){t[3](o)}let ne={label:"Critical Issue",emptyOption:!0,choices:t[2]};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(ne.value=t[1].criticalIssues[t[0]].criticalIssue),p=new pe({props:ne}),Z.push(()=>X(p,"value",oe));function x(o){t[4](o)}let m={label:"Stage",emptyOption:!0,choices:Ge(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(m.value=t[1].criticalIssues[t[0]].stage),f=new pe({props:m}),Z.push(()=>X(f,"value",x));function se(o){t[5](o)}let ee={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(ee.value=t[1].criticalIssues[t[0]].locationName),T=new Oe({props:ee}),Z.push(()=>X(T,"value",se));function N(o){t[6](o)}let k={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(k.value=t[1].criticalIssues[t[0]].resolved),B=new Re({props:k}),Z.push(()=>X(B,"value",N));function u(o){t[7](o)}let $={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&($.value=t[1].criticalIssues[t[0]].notes),E=new He({props:$}),Z.push(()=>X(E,"value",u)),{c(){e=U("div"),l=U("a"),n=le("Google StreetView"),c=M(),a=U("a"),s=le("Bing Streetside"),y=M(),z(p.$$.fragment),b=M(),z(f.$$.fragment),A=M(),z(T.$$.fragment),I=M(),z(B.$$.fragment),W=M(),z(E.$$.fragment),this.h()},l(o){e=K(o,"DIV",{style:!0});var h=J(e);l=K(h,"A",{href:!0,target:!0});var w=J(l);n=ie(w,"Google StreetView"),w.forEach(v),c=q(h),a=K(h,"A",{href:!0,target:!0});var R=J(a);s=ie(R,"Bing Streetside"),R.forEach(v),h.forEach(v),y=q(o),j(p.$$.fragment,o),b=q(o),j(f.$$.fragment,o),A=q(o),j(T.$$.fragment,o),I=q(o),j(B.$$.fragment,o),W=q(o),j(E.$$.fragment,o),this.h()},h(){G(l,"href",i=de(t[1].criticalIssues[t[0]].point)),G(l,"target","_blank"),G(a,"href",r=he(t[1].criticalIssues[t[0]].point)),G(a,"target","_blank"),te(e,"display","flex"),te(e,"justify-content","space-evenly")},m(o,h){S(o,e,h),O(e,l),O(l,n),O(e,c),O(e,a),O(a,s),S(o,y,h),P(p,o,h),S(o,b,h),P(f,o,h),S(o,A,h),P(T,o,h),S(o,I,h),P(B,o,h),S(o,W,h),P(E,o,h),D=!0},p(o,[h]){(!D||h&3&&i!==(i=de(o[1].criticalIssues[o[0]].point)))&&G(l,"href",i),(!D||h&3&&r!==(r=he(o[1].criticalIssues[o[0]].point)))&&G(a,"href",r);const w={};!_&&h&3&&(_=!0,w.value=o[1].criticalIssues[o[0]].criticalIssue,Q(()=>_=!1)),p.$set(w);const R={};!d&&h&3&&(d=!0,R.value=o[1].criticalIssues[o[0]].stage,Q(()=>d=!1)),f.$set(R);const ce={};!g&&h&3&&(g=!0,ce.value=o[1].criticalIssues[o[0]].locationName,Q(()=>g=!1)),T.$set(ce);const _e={};!F&&h&3&&(F=!0,_e.value=o[1].criticalIssues[o[0]].resolved,Q(()=>F=!1)),B.$set(_e);const me={};!Y&&h&3&&(Y=!0,me.value=o[1].criticalIssues[o[0]].notes,Q(()=>Y=!1)),E.$set(me)},i(o){D||(C(p.$$.fragment,o),C(f.$$.fragment,o),C(T.$$.fragment,o),C(B.$$.fragment,o),C(E.$$.fragment,o),D=!0)},o(o){L(p.$$.fragment,o),L(f.$$.fragment,o),L(T.$$.fragment,o),L(B.$$.fragment,o),L(E.$$.fragment,o),D=!1},d(o){o&&(v(e),v(y),v(b),v(A),v(I),v(W)),V(p,o),V(f,o),V(T,o),V(B,o),V(E,o)}}}function bt(t,e,l){let n;Ie(t,H,_=>l(1,n=_));let{idx:i}=e,c=[["1","1 - Conflict at Side Roads and Priority Junctions: >2,500vpd cut across main walking, wheeling or cycling streams"],["2","2 - Conflict at Roundabouts and Signal Junctions: >2,500vpd cut across main walking, wheeling or cycling streams"],["3","3 - Lane Widths: Cyclists unprotected in 3.25-3.9m wide nearside lane"],["4","4 - Trip Hazards: Level differences >13mm with no tactile information and colour contrast"],["5A","5A - Kerbside Activity: Cycle facility next to parking/loading with insufficient buffer"],["5B","5B - Kerbside Activity: Unprotected cycle lane next to a frequently used bus layby"],["6A","6A - Provision of Crossings: on busy streets (>8,000vpd), formal crossings are more than 400m apart"],["6B","6B - Provision of Crossings: on quieter streets (<8,000vpd), desire lines are blocked by parking/loading"],["7A","7A - Standard of Crossings: on busy streets (>8,000vpd), uncontrolled crossings of 2+ lanes with no gaps in traffic"],["7B","7B - Standard of Crossings: at signal junctions, there are arms with no green man for pedestrians"],["8","8 - Motor Traffic Speed: Mean speed > 30mph when cyclists/pedestrians are unprotected"],["9A","9A - Motor Traffic Volume: >1,000 vehicles in busiest hour when cyclists/pedestrians are unprotected"],["9B","9B - Motor Traffic Volume: >5% HGV traffic when cyclists/pedestrians are unprotected and >500 vehicles in busiest hour"],["10","10 - Pedestrian Crossing Speed: Pedestrians must cross at speeds >1.2m/s"],["11A","11A - Footway Width: <1m clear width"],["11B","11B - Footway Width: 1.0-1.5m wide clear width for over 6m"],["11C","11C - Footway Width: <2m clear width and pedestrian comfort level is poor (PCL of D-E)"],["11D","11D - Footway Width: no footway"],["12A","12A - Effective Width next to Tram Lines: <2.4m effective width for cyclists from tramline edge to kerb on a straight run"],["12B","12B - Effective Width next to Tram Lines: insufficient effective width for cyclists on a curved section of tram route"],["13","13 - Crossing Angle of Tram/Train Rails: Cyclist crossing angle <60Â°"],["14",'14 - Cycling Surface and Maintenance Defects: Major defects (provide further information in "commentary and feedback")'],["15",'15 - Walking/Wheeling Surface and Maintenance Defects: Major defects (provide further information in "commentary and feedback")'],["16","16 - Guard Railing: used as standard without consideration of inherent safety risks"]];function a(_){t.$$.not_equal(n.criticalIssues[i].criticalIssue,_)&&(n.criticalIssues[i].criticalIssue=_,H.set(n))}function s(_){t.$$.not_equal(n.criticalIssues[i].stage,_)&&(n.criticalIssues[i].stage=_,H.set(n))}function r(_){t.$$.not_equal(n.criticalIssues[i].locationName,_)&&(n.criticalIssues[i].locationName=_,H.set(n))}function y(_){t.$$.not_equal(n.criticalIssues[i].resolved,_)&&(n.criticalIssues[i].resolved=_,H.set(n))}function p(_){t.$$.not_equal(n.criticalIssues[i].notes,_)&&(n.criticalIssues[i].notes=_,H.set(n))}return t.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,n,c,a,s,r,y,p]}class yt extends be{constructor(e){super(),ye(this,e,bt,$t,ve,{idx:0})}}function kt(t){let e,l,n,i,c,a,s,r,y,p,_,b,f,d,A,T,g,I,B,F,W,E,Y,D;function oe(o){t[3](o)}let ne={label:"Policy Conflict",emptyOption:!0,choices:t[2]};t[1].policyConflictLog[t[0]].conflict!==void 0&&(ne.value=t[1].policyConflictLog[t[0]].conflict),p=new pe({props:ne}),Z.push(()=>X(p,"value",oe));function x(o){t[4](o)}let m={label:"Stage",emptyOption:!0,choices:Ge(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(m.value=t[1].policyConflictLog[t[0]].stage),f=new pe({props:m}),Z.push(()=>X(f,"value",x));function se(o){t[5](o)}let ee={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(ee.value=t[1].policyConflictLog[t[0]].locationName),T=new Oe({props:ee}),Z.push(()=>X(T,"value",se));function N(o){t[6](o)}let k={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(k.value=t[1].policyConflictLog[t[0]].resolved),B=new Re({props:k}),Z.push(()=>X(B,"value",N));function u(o){t[7](o)}let $={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&($.value=t[1].policyConflictLog[t[0]].notes),E=new He({props:$}),Z.push(()=>X(E,"value",u)),{c(){e=U("div"),l=U("a"),n=le("Google StreetView"),c=M(),a=U("a"),s=le("Bing Streetside"),y=M(),z(p.$$.fragment),b=M(),z(f.$$.fragment),A=M(),z(T.$$.fragment),I=M(),z(B.$$.fragment),W=M(),z(E.$$.fragment),this.h()},l(o){e=K(o,"DIV",{style:!0});var h=J(e);l=K(h,"A",{href:!0,target:!0});var w=J(l);n=ie(w,"Google StreetView"),w.forEach(v),c=q(h),a=K(h,"A",{href:!0,target:!0});var R=J(a);s=ie(R,"Bing Streetside"),R.forEach(v),h.forEach(v),y=q(o),j(p.$$.fragment,o),b=q(o),j(f.$$.fragment,o),A=q(o),j(T.$$.fragment,o),I=q(o),j(B.$$.fragment,o),W=q(o),j(E.$$.fragment,o),this.h()},h(){G(l,"href",i=de(t[1].policyConflictLog[t[0]].point)),G(l,"target","_blank"),G(a,"href",r=he(t[1].policyConflictLog[t[0]].point)),G(a,"target","_blank"),te(e,"display","flex"),te(e,"justify-content","space-evenly")},m(o,h){S(o,e,h),O(e,l),O(l,n),O(e,c),O(e,a),O(a,s),S(o,y,h),P(p,o,h),S(o,b,h),P(f,o,h),S(o,A,h),P(T,o,h),S(o,I,h),P(B,o,h),S(o,W,h),P(E,o,h),D=!0},p(o,[h]){(!D||h&3&&i!==(i=de(o[1].policyConflictLog[o[0]].point)))&&G(l,"href",i),(!D||h&3&&r!==(r=he(o[1].policyConflictLog[o[0]].point)))&&G(a,"href",r);const w={};!_&&h&3&&(_=!0,w.value=o[1].policyConflictLog[o[0]].conflict,Q(()=>_=!1)),p.$set(w);const R={};!d&&h&3&&(d=!0,R.value=o[1].policyConflictLog[o[0]].stage,Q(()=>d=!1)),f.$set(R);const ce={};!g&&h&3&&(g=!0,ce.value=o[1].policyConflictLog[o[0]].locationName,Q(()=>g=!1)),T.$set(ce);const _e={};!F&&h&3&&(F=!0,_e.value=o[1].policyConflictLog[o[0]].resolved,Q(()=>F=!1)),B.$set(_e);const me={};!Y&&h&3&&(Y=!0,me.value=o[1].policyConflictLog[o[0]].notes,Q(()=>Y=!1)),E.$set(me)},i(o){D||(C(p.$$.fragment,o),C(f.$$.fragment,o),C(T.$$.fragment,o),C(B.$$.fragment,o),C(E.$$.fragment,o),D=!0)},o(o){L(p.$$.fragment,o),L(f.$$.fragment,o),L(T.$$.fragment,o),L(B.$$.fragment,o),L(E.$$.fragment,o),D=!1},d(o){o&&(v(e),v(y),v(b),v(A),v(I),v(W)),V(p,o),V(f,o),V(T,o),V(B,o),V(E,o)}}}function Ct(t,e,l){let n;Ie(t,H,_=>l(1,n=_));let{idx:i}=e,c=[["1","1 - Cyclists are not separated from pedestrians"],["2",'2 - Barriers, steps, or "Cyclist Dismount" signs are present'],["3","3 - The route is not direct, logical and intuitive"],["4","4 - Inappropriate surface materials"],["5","5 - Appropriate lighting is not provided"],["6","6 - Routes miss opportunities to join together with other facilities as a network"]];function a(_){t.$$.not_equal(n.policyConflictLog[i].conflict,_)&&(n.policyConflictLog[i].conflict=_,H.set(n))}function s(_){t.$$.not_equal(n.policyConflictLog[i].stage,_)&&(n.policyConflictLog[i].stage=_,H.set(n))}function r(_){t.$$.not_equal(n.policyConflictLog[i].locationName,_)&&(n.policyConflictLog[i].locationName=_,H.set(n))}function y(_){t.$$.not_equal(n.policyConflictLog[i].resolved,_)&&(n.policyConflictLog[i].resolved=_,H.set(n))}function p(_){t.$$.not_equal(n.policyConflictLog[i].notes,_)&&(n.policyConflictLog[i].notes=_,H.set(n))}return t.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,n,c,a,s,r,y,p]}class wt extends be{constructor(e){super(),ye(this,e,Ct,kt,ve,{idx:0})}}const{window:Lt}=lt;function De(t,e,l){const n=t.slice();return n[29]=e[l],n[30]=e,n[31]=l,n}function Ae(t,e,l){const n=t.slice();return n[32]=e[l],n[33]=e,n[31]=l,n}function Ee(t,e,l){const n=t.slice();return n[29]=e[l],n[31]=l,n}function Ne(t,e,l){const n=t.slice();return n[32]=e[l],n[31]=l,n}function It(t){let e,l,n,i,c,a,s,r;e=new mt({props:{$$slots:{default:[Tt]},$$scope:{ctx:t}}}),e.$on("click",t[20]),n=new gt({props:{$$slots:{default:[Bt]},$$scope:{ctx:t}}}),n.$on("click",t[8]);const y=[At,Dt],p=[];function _(b,f){return b[0].kind=="critical"?0:1}return c=_(t),a=p[c]=y[c](t),{c(){z(e.$$.fragment),l=M(),z(n.$$.fragment),i=M(),a.c(),s=Te()},l(b){j(e.$$.fragment,b),l=q(b),j(n.$$.fragment,b),i=q(b),a.l(b),s=Te()},m(b,f){P(e,b,f),S(b,l,f),P(n,b,f),S(b,i,f),p[c].m(b,f),S(b,s,f),r=!0},p(b,f){const d={};f[1]&32&&(d.$$scope={dirty:f,ctx:b}),e.$set(d);const A={};f[1]&32&&(A.$$scope={dirty:f,ctx:b}),n.$set(A);let T=c;c=_(b),c===T?p[c].p(b,f):(fe(),L(p[T],1,1,()=>{p[T]=null}),ae(),a=p[c],a?a.p(b,f):(a=p[c]=y[c](b),a.c()),C(a,1),a.m(s.parentNode,s))},i(b){r||(C(e.$$.fragment,b),C(n.$$.fragment,b),C(a),r=!0)},o(b){L(e.$$.fragment,b),L(n.$$.fragment,b),L(a),r=!1},d(b){b&&(v(l),v(i),v(s)),V(e,b),V(n,b),p[c].d(b)}}}function St(t){let e,l,n,i,c,a,s,r,y,p,_,b="Click the map to add a problem, or select a problem to fill out data",f,d,A="Critical Issues",T,g,I,B,F="Policy Conflicts",W,E,Y;e=new Se({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),e.$on("click",t[11]),n=new at({}),c=new ft({});let D=t[3]&&Me(t);function oe(u){t[13](u)}let ne={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[4]!==void 0&&(ne.value=t[4]),r=new ut({props:ne}),Z.push(()=>X(r,"value",oe));let x=re(t[2].criticalIssues),m=[];for(let u=0;u<x.length;u+=1)m[u]=qe(Ne(t,x,u));const se=u=>L(m[u],1,1,()=>{m[u]=null});let ee=re(t[2].policyConflictLog),N=[];for(let u=0;u<ee.length;u+=1)N[u]=ze(Ee(t,ee,u));const k=u=>L(N[u],1,1,()=>{N[u]=null});return{c(){z(e.$$.fragment),l=M(),z(n.$$.fragment),i=M(),z(c.$$.fragment),a=M(),D&&D.c(),s=M(),z(r.$$.fragment),p=M(),_=U("p"),_.textContent=b,f=M(),d=U("h3"),d.textContent=A,T=M(),g=U("ol");for(let u=0;u<m.length;u+=1)m[u].c();I=M(),B=U("h3"),B.textContent=F,W=M(),E=U("ol");for(let u=0;u<N.length;u+=1)N[u].c()},l(u){j(e.$$.fragment,u),l=q(u),j(n.$$.fragment,u),i=q(u),j(c.$$.fragment,u),a=q(u),D&&D.l(u),s=q(u),j(r.$$.fragment,u),p=q(u),_=K(u,"P",{"data-svelte-h":!0}),ke(_)!=="svelte-12ba5j2"&&(_.textContent=b),f=q(u),d=K(u,"H3",{"data-svelte-h":!0}),ke(d)!=="svelte-1qhh5xr"&&(d.textContent=A),T=q(u),g=K(u,"OL",{});var $=J(g);for(let h=0;h<m.length;h+=1)m[h].l($);$.forEach(v),I=q(u),B=K(u,"H3",{"data-svelte-h":!0}),ke(B)!=="svelte-eyxzjx"&&(B.textContent=F),W=q(u),E=K(u,"OL",{});var o=J(E);for(let h=0;h<N.length;h+=1)N[h].l(o);o.forEach(v)},m(u,$){P(e,u,$),S(u,l,$),P(n,u,$),S(u,i,$),P(c,u,$),S(u,a,$),D&&D.m(u,$),S(u,s,$),P(r,u,$),S(u,p,$),S(u,_,$),S(u,f,$),S(u,d,$),S(u,T,$),S(u,g,$);for(let o=0;o<m.length;o+=1)m[o]&&m[o].m(g,null);S(u,I,$),S(u,B,$),S(u,W,$),S(u,E,$);for(let o=0;o<N.length;o+=1)N[o]&&N[o].m(E,null);Y=!0},p(u,$){const o={};$[1]&32&&(o.$$scope={dirty:$,ctx:u}),e.$set(o),u[3]?D?(D.p(u,$),$[0]&8&&C(D,1)):(D=Me(u),D.c(),C(D,1),D.m(s.parentNode,s)):D&&(fe(),L(D,1,1,()=>{D=null}),ae());const h={};if(!y&&$[0]&16&&(y=!0,h.value=u[4],Q(()=>y=!1)),r.$set(h),$[0]&134){x=re(u[2].criticalIssues);let w;for(w=0;w<x.length;w+=1){const R=Ne(u,x,w);m[w]?(m[w].p(R,$),C(m[w],1)):(m[w]=qe(R),m[w].c(),C(m[w],1),m[w].m(g,null))}for(fe(),w=x.length;w<m.length;w+=1)se(w);ae()}if($[0]&134){ee=re(u[2].policyConflictLog);let w;for(w=0;w<ee.length;w+=1){const R=Ee(u,ee,w);N[w]?(N[w].p(R,$),C(N[w],1)):(N[w]=ze(R),N[w].c(),C(N[w],1),N[w].m(E,null))}for(fe(),w=ee.length;w<N.length;w+=1)k(w);ae()}},i(u){if(!Y){C(e.$$.fragment,u),C(n.$$.fragment,u),C(c.$$.fragment,u),C(D),C(r.$$.fragment,u);for(let $=0;$<x.length;$+=1)C(m[$]);for(let $=0;$<ee.length;$+=1)C(N[$]);Y=!0}},o(u){L(e.$$.fragment,u),L(n.$$.fragment,u),L(c.$$.fragment,u),L(D),L(r.$$.fragment,u),m=m.filter(Boolean);for(let $=0;$<m.length;$+=1)L(m[$]);N=N.filter(Boolean);for(let $=0;$<N.length;$+=1)L(N[$]);Y=!1},d(u){u&&(v(l),v(i),v(a),v(s),v(p),v(_),v(f),v(d),v(T),v(g),v(I),v(B),v(W),v(E)),V(e,u),V(n,u),V(c,u),D&&D.d(u),V(r,u),ge(m,u),ge(N,u)}}}function Tt(t){let e;return{c(){e=le("Save")},l(l){e=ie(l,"Save")},m(l,n){S(l,e,n)},d(l){l&&v(e)}}}function Bt(t){let e;return{c(){e=le("Delete")},l(l){e=ie(l,"Delete")},m(l,n){S(l,e,n)},d(l){l&&v(e)}}}function Dt(t){let e,l;return e=new wt({props:{idx:t[0].idx}}),{c(){z(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,i){P(e,n,i),l=!0},p(n,i){const c={};i[0]&1&&(c.idx=n[0].idx),e.$set(c)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function At(t){let e,l;return e=new yt({props:{idx:t[0].idx}}),{c(){z(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,i){P(e,n,i),l=!0},p(n,i){const c={};i[0]&1&&(c.idx=n[0].idx),e.$set(c)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function Et(t){let e;return{c(){e=le("Zoom to fit")},l(l){e=ie(l,"Zoom to fit")},m(l,n){S(l,e,n)},d(l){l&&v(e)}}}function Me(t){let e,l,n;function i(a){t[12](a)}let c={map:t[3]};return t[5]!==void 0&&(c.enabled=t[5]),e=new ct({props:c}),Z.push(()=>X(e,"enabled",i)),{c(){z(e.$$.fragment)},l(a){j(e.$$.fragment,a)},m(a,s){P(e,a,s),n=!0},p(a,s){const r={};s[0]&8&&(r.map=a[3]),!l&&s[0]&32&&(l=!0,r.enabled=a[5],Q(()=>l=!1)),e.$set(r)},i(a){n||(C(e.$$.fragment,a),n=!0)},o(a){L(e.$$.fragment,a),n=!1},d(a){V(e,a)}}}function Nt(t){let e=Ve(t[32])+"",l;return{c(){l=le(e)},l(n){l=ie(n,e)},m(n,i){S(n,l,i)},p(n,i){i[0]&4&&e!==(e=Ve(n[32])+"")&&$e(l,e)},d(n){n&&v(l)}}}function qe(t){let e,l,n,i;function c(){return t[14](t[31])}function a(){return t[15](t[31])}return l=new Se({props:{$$slots:{default:[Nt]},$$scope:{ctx:t}}}),l.$on("click",c),l.$on("mouseenter",a),l.$on("mouseleave",t[16]),{c(){e=U("li"),z(l.$$.fragment),n=M()},l(s){e=K(s,"LI",{});var r=J(e);j(l.$$.fragment,r),n=q(r),r.forEach(v)},m(s,r){S(s,e,r),P(l,e,null),O(e,n),i=!0},p(s,r){t=s;const y={};r[0]&4|r[1]&32&&(y.$$scope={dirty:r,ctx:t}),l.$set(y)},i(s){i||(C(l.$$.fragment,s),i=!0)},o(s){L(l.$$.fragment,s),i=!1},d(s){s&&v(e),V(l)}}}function Mt(t){let e=Fe(t[29])+"",l;return{c(){l=le(e)},l(n){l=ie(n,e)},m(n,i){S(n,l,i)},p(n,i){i[0]&4&&e!==(e=Fe(n[29])+"")&&$e(l,e)},d(n){n&&v(l)}}}function ze(t){let e,l,n,i;function c(){return t[17](t[31])}function a(){return t[18](t[31])}return l=new Se({props:{$$slots:{default:[Mt]},$$scope:{ctx:t}}}),l.$on("click",c),l.$on("mouseenter",a),l.$on("mouseleave",t[19]),{c(){e=U("li"),z(l.$$.fragment),n=M()},l(s){e=K(s,"LI",{});var r=J(e);j(l.$$.fragment,r),n=q(r),r.forEach(v)},m(s,r){S(s,e,r),P(l,e,null),O(e,n),i=!0},p(s,r){t=s;const y={};r[0]&4|r[1]&32&&(y.$$scope={dirty:r,ctx:t}),l.$set(y)},i(s){i||(C(l.$$.fragment,s),i=!0)},o(s){L(l.$$.fragment,s),i=!1},d(s){s&&v(e),V(l)}}}function qt(t){let e,l,n,i=t[32].criticalIssue+"",c;return{c(){e=Ce("svg"),l=Ce("polygon"),n=Ce("text"),c=le(i),this.h()},l(a){e=we(a,"svg",{width:!0,height:!0,xmlns:!0});var s=J(e);l=we(s,"polygon",{points:!0,fill:!0,class:!0}),J(l).forEach(v),n=we(s,"text",{x:!0,y:!0});var r=J(n);c=ie(r,i),r.forEach(v),s.forEach(v),this.h()},h(){G(l,"points","20,0 0,40 40,40"),G(l,"fill",ot.critical.background),G(l,"class","svelte-996go8"),G(n,"x","13"),G(n,"y","30"),te(n,"fill","white"),G(e,"width","40"),G(e,"height","40"),G(e,"xmlns","http://www.w3.org/2000/svg")},m(a,s){S(a,e,s),O(e,l),O(e,n),O(n,c)},p(a,s){s[0]&4&&i!==(i=a[32].criticalIssue+"")&&$e(c,i)},d(a){a&&v(e)}}}function je(t){let e,l,n;function i(r){t[21](r,t[32])}function c(){return t[22](t[31])}function a(){return t[23](t[31])}let s={draggable:!0,$$slots:{default:[qt]},$$scope:{ctx:t}};return t[32].point!==void 0&&(s.lngLat=t[32].point),e=new We({props:s}),Z.push(()=>X(e,"lngLat",i)),e.$on("click",c),e.$on("dragend",a),{c(){z(e.$$.fragment)},l(r){j(e.$$.fragment,r)},m(r,y){P(e,r,y),n=!0},p(r,y){t=r;const p={};y[0]&4|y[1]&32&&(p.$$scope={dirty:y,ctx:t}),!l&&y[0]&4&&(l=!0,p.lngLat=t[32].point,Q(()=>l=!1)),e.$set(p)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),n=!1},d(r){V(e,r)}}}function zt(t){let e,l=t[29].conflict+"",n;return{c(){e=U("span"),n=le(l),this.h()},l(i){e=K(i,"SPAN",{class:!0});var c=J(e);n=ie(c,l),c.forEach(v),this.h()},h(){G(e,"class","dot svelte-996go8"),te(e,"background",rt)},m(i,c){S(i,e,c),O(e,n)},p(i,c){c[0]&4&&l!==(l=i[29].conflict+"")&&$e(n,l)},d(i){i&&v(e)}}}function Pe(t){let e,l,n;function i(r){t[24](r,t[29])}function c(){return t[25](t[31])}function a(){return t[26](t[31])}let s={draggable:!0,$$slots:{default:[zt]},$$scope:{ctx:t}};return t[29].point!==void 0&&(s.lngLat=t[29].point),e=new We({props:s}),Z.push(()=>X(e,"lngLat",i)),e.$on("click",c),e.$on("dragend",a),{c(){z(e.$$.fragment)},l(r){j(e.$$.fragment,r)},m(r,y){P(e,r,y),n=!0},p(r,y){t=r;const p={};y[0]&4|y[1]&32&&(p.$$scope={dirty:y,ctx:t}),!l&&y[0]&4&&(l=!0,p.lngLat=t[29].point,Q(()=>l=!1)),e.$set(p)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),n=!1},d(r){V(e,r)}}}function jt(t){let e,l;return e=new vt({props:{paint:{"circle-radius":30,"circle-color":"yellow"}}}),{c(){z(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,i){P(e,n,i),l=!0},p:xe,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function Pt(t){let e,l,n,i,c,a,s=re(t[2].criticalIssues),r=[];for(let f=0;f<s.length;f+=1)r[f]=je(Ae(t,s,f));const y=f=>L(r[f],1,1,()=>{r[f]=null});let p=re(t[2].policyConflictLog),_=[];for(let f=0;f<p.length;f+=1)_[f]=Pe(De(t,p,f));const b=f=>L(_[f],1,1,()=>{_[f]=null});return n=new it({props:{data:t[6],$$slots:{default:[jt]},$$scope:{ctx:t}}}),c=new _t({props:{map:t[3]}}),{c(){for(let f=0;f<r.length;f+=1)r[f].c();e=M();for(let f=0;f<_.length;f+=1)_[f].c();l=M(),z(n.$$.fragment),i=M(),z(c.$$.fragment)},l(f){for(let d=0;d<r.length;d+=1)r[d].l(f);e=q(f);for(let d=0;d<_.length;d+=1)_[d].l(f);l=q(f),j(n.$$.fragment,f),i=q(f),j(c.$$.fragment,f)},m(f,d){for(let A=0;A<r.length;A+=1)r[A]&&r[A].m(f,d);S(f,e,d);for(let A=0;A<_.length;A+=1)_[A]&&_[A].m(f,d);S(f,l,d),P(n,f,d),S(f,i,d),P(c,f,d),a=!0},p(f,d){if(d[0]&132){s=re(f[2].criticalIssues);let g;for(g=0;g<s.length;g+=1){const I=Ae(f,s,g);r[g]?(r[g].p(I,d),C(r[g],1)):(r[g]=je(I),r[g].c(),C(r[g],1),r[g].m(e.parentNode,e))}for(fe(),g=s.length;g<r.length;g+=1)y(g);ae()}if(d[0]&132){p=re(f[2].policyConflictLog);let g;for(g=0;g<p.length;g+=1){const I=De(f,p,g);_[g]?(_[g].p(I,d),C(_[g],1)):(_[g]=Pe(I),_[g].c(),C(_[g],1),_[g].m(l.parentNode,l))}for(fe(),g=p.length;g<_.length;g+=1)b(g);ae()}const A={};d[0]&64&&(A.data=f[6]),d[1]&32&&(A.$$scope={dirty:d,ctx:f}),n.$set(A);const T={};d[0]&8&&(T.map=f[3]),c.$set(T)},i(f){if(!a){for(let d=0;d<s.length;d+=1)C(r[d]);for(let d=0;d<p.length;d+=1)C(_[d]);C(n.$$.fragment,f),C(c.$$.fragment,f),a=!0}},o(f){r=r.filter(Boolean);for(let d=0;d<r.length;d+=1)L(r[d]);_=_.filter(Boolean);for(let d=0;d<_.length;d+=1)L(_[d]);L(n.$$.fragment,f),L(c.$$.fragment,f),a=!1},d(f){f&&(v(e),v(l),v(i)),ge(r,f),ge(_,f),V(n,f),V(c,f)}}}function Vt(t){let e,l,n,i,c,a,s,r,y,p,_;const b=[St,It],f=[];function d(g,I){return g[0]==null?0:1}n=d(t),i=f[n]=b[n](t);function A(g){t[27](g)}let T={$$slots:{default:[Pt]},$$scope:{ctx:t}};return t[3]!==void 0&&(T.map=t[3]),s=new nt({props:T}),Z.push(()=>X(s,"map",A)),{c(){e=U("div"),l=U("div"),i.c(),c=M(),a=U("div"),z(s.$$.fragment),this.h()},l(g){e=K(g,"DIV",{style:!0});var I=J(e);l=K(I,"DIV",{style:!0});var B=J(l);i.l(B),B.forEach(v),c=q(I),a=K(I,"DIV",{style:!0});var F=J(a);j(s.$$.fragment,F),F.forEach(v),I.forEach(v),this.h()},h(){te(l,"width","30%"),te(l,"overflow-y","scroll"),te(l,"padding","10px"),te(a,"position","relative"),te(a,"width","70%"),te(e,"display","flex"),te(e,"height","80vh")},m(g,I){S(g,e,I),O(e,l),f[n].m(l,null),O(e,c),O(e,a),P(s,a,null),y=!0,p||(_=Ze(Lt,"keydown",t[10]),p=!0)},p(g,I){let B=n;n=d(g),n===B?f[n].p(g,I):(fe(),L(f[B],1,1,()=>{f[B]=null}),ae(),i=f[n],i?i.p(g,I):(i=f[n]=b[n](g),i.c()),C(i,1),i.m(l,null));const F={};I[0]&76|I[1]&32&&(F.$$scope={dirty:I,ctx:g}),!r&&I[0]&8&&(r=!0,F.map=g[3],Q(()=>r=!1)),s.$set(F)},i(g){y||(C(i),C(s.$$.fragment,g),y=!0)},o(g){L(i),L(s.$$.fragment,g),y=!1},d(g){g&&v(e),f[n].d(),V(s),p=!1,_()}}}function Ft(t,e,l){let n={type:"FeatureCollection",features:[]},i=e??l;if(i!=null){let c=i.kind=="critical"?t.criticalIssues:t.policyConflictLog;n.features.push(Le(c[i.idx].point))}return n}function Le(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Ve(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Fe(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function Gt(t,e,l){let n,i;Ie(t,H,k=>l(2,i=k));let c,a="critical",s=null,r=null,y=!1;function p(k){l(0,s=k),l(1,r=null)}function _(k){if(!y){if(s!=null){l(0,s=null);return}a=="critical"?(Be(H,i.criticalIssues=[...i.criticalIssues,{id:"TODO",criticalIssue:"",stage:"",point:k.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),l(0,s={kind:"critical",idx:i.criticalIssues.length-1})):(Be(H,i.policyConflictLog=[...i.policyConflictLog,{id:"TODO",conflict:"",stage:"",point:k.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),l(0,s={kind:"conflict",idx:i.policyConflictLog.length-1})),l(1,r=null)}}Qe(()=>{c.on("click",_),f(!1)}),Xe(()=>{c.off("click",_)});function b(){window.confirm("Delete this entry?")&&(s.kind=="critical"?(i.criticalIssues.splice(s.idx,1),H.set(i)):(i.policyConflictLog.splice(s.idx,1),H.set(i)),l(0,s=null))}function f(k){let u={type:"FeatureCollection",features:[...i.criticalIssues.map($=>Le($.point)),...i.policyConflictLog.map($=>Le($.point))]};u.features.length>0&&c.fitBounds(st(u),{padding:20,animate:k})}function d(k){s!=null&&k.key=="Escape"?(k.stopPropagation(),l(0,s=null)):s!=null&&k.key=="Delete"&&b()}const A=()=>f(!0);function T(k){y=k,l(5,y)}function g(k){a=k,l(4,a)}const I=k=>p({kind:"critical",idx:k}),B=k=>l(1,r={kind:"critical",idx:k}),F=()=>l(1,r=null),W=k=>p({kind:"conflict",idx:k}),E=k=>l(1,r={kind:"conflict",idx:k}),Y=()=>l(1,r=null),D=()=>l(0,s=null);function oe(k,u){t.$$.not_equal(u.point,k)&&(u.point=k,H.set(i))}const ne=k=>p({kind:"critical",idx:k}),x=k=>p({kind:"critical",idx:k});function m(k,u){t.$$.not_equal(u.point,k)&&(u.point=k,H.set(i))}const se=k=>p({kind:"conflict",idx:k}),ee=k=>p({kind:"conflict",idx:k});function N(k){c=k,l(3,c)}return t.$$.update=()=>{t.$$.dirty[0]&7&&l(6,n=Ft(i,s,r))},[s,r,i,c,a,y,n,p,b,f,d,A,T,g,I,B,F,W,E,Y,D,oe,ne,x,m,se,ee,N]}class nn extends be{constructor(e){super(),ye(this,e,Gt,Vt,ve,{},null,[-1,-1])}}export{nn as component};
