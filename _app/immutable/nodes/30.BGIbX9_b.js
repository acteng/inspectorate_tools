import{s as O,T as Ae,U as me,V as ge,E as D,e as ie,t as R,a as S,c as ae,b as se,d as V,f as v,g as I,v as F,i as w,h as Be,j as Me,F as T,I as oe,q as de,k as Se,M as Ie}from"../chunks/scheduler.BnUV8E0D.js";import{S as j,i as J,f as L,c as y,a as k,m as C,t as _,b as h,d as A,g as $e,e as _e}from"../chunks/index.Bd8LklJ7.js";import{e as W}from"../chunks/each.CAlpr5f-.js";import{m as De,M as Te}from"../chunks/MapLibreMap.7lvoKX4P.js";import{p as Le}from"../chunks/index.Dy8GpxKW.js";import{C as Ee}from"../chunks/CollapsibleCard.CEjTdvyl.js";import{S as Ne,W as We}from"../chunks/WarningButton.D5fc_pEn.js";import{S as re}from"../chunks/Select.DCL1uIyl.js";import{T as qe}from"../chunks/TextArea.CVWbqg4Y.js";import{T as le}from"../chunks/TextInput.CdRNF-nE.js";import{s as M}from"../chunks/data.Cs5XKbFD.js";import{Y as Pe}from"../chunks/YesNo.CZ7nC3mh.js";function Fe(e,n,l){let t=Ae(),{map:r}=n,{position:c}=n,a=null;return me(()=>{a=new De.Marker({draggable:!0}).setLngLat(c).addTo(r),a.on("dragstart",()=>{r.getCanvas().style.cursor="grabbing"}),a.on("drag",()=>{l(0,c=a.getLngLat())}),a.on("dragend",()=>{r.getCanvas().style.cursor="inherit"}),a.getElement().addEventListener("click",i=>{t("click"),i.stopPropagation()})}),ge(()=>{a==null||a.remove()}),e.$$set=i=>{"map"in i&&l(1,r=i.map),"position"in i&&l(0,c=i.position)},[c,r]}class Oe extends j{constructor(n){super(),J(this,n,Fe,null,O,{map:1,position:0})}}function fe(e,n,l){const t=e.slice();return t[6]=n[l],t[7]=n,t[8]=l,t}function ue(e){let n,l,t;function r(i){e[2](i,e[6],e[7],e[8])}function c(){return e[3](e[8])}let a={map:e[0]};return e[6]!==void 0&&(a.position=e[6]),n=new Oe({props:a}),D.push(()=>L(n,"position",r)),n.$on("click",c),{c(){y(n.$$.fragment)},l(i){k(n.$$.fragment,i)},m(i,f){C(n,i,f),t=!0},p(i,f){e=i;const s={};f&1&&(s.map=e[0]),!l&&f&2&&(l=!0,s.position=e[6],T(()=>l=!1)),n.$set(s)},i(i){t||(_(n.$$.fragment,i),t=!0)},o(i){h(n.$$.fragment,i),t=!1},d(i){A(n,i)}}}function Re(e){let n,l,t=W(e[1]),r=[];for(let a=0;a<t.length;a+=1)r[a]=ue(fe(e,t,a));const c=a=>h(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();n=oe()},l(a){for(let i=0;i<r.length;i+=1)r[i].l(a);n=oe()},m(a,i){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(a,i);w(a,n,i),l=!0},p(a,i){if(i&3){t=W(a[1]);let f;for(f=0;f<t.length;f+=1){const s=fe(a,t,f);r[f]?(r[f].p(s,i),_(r[f],1)):(r[f]=ue(s),r[f].c(),_(r[f],1),r[f].m(n.parentNode,n))}for($e(),f=t.length;f<r.length;f+=1)c(f);_e()}},i(a){if(!l){for(let i=0;i<t.length;i+=1)_(r[i]);l=!0}},o(a){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)h(r[i]);l=!1},d(a){a&&v(n),de(r,a)}}}function Ve(e){let n,l=JSON.stringify(e[1])+"",t,r,c,a,i,f;function s(p){e[4](p)}let m={$$slots:{default:[Re]},$$scope:{ctx:e}};return e[0]!==void 0&&(m.map=e[0]),a=new Te({props:m}),D.push(()=>L(a,"map",s)),{c(){n=ie("pre"),t=R(l),r=S(),c=ie("div"),y(a.$$.fragment),this.h()},l(p){n=ae(p,"PRE",{});var u=se(n);t=V(u,l),u.forEach(v),r=I(p),c=ae(p,"DIV",{style:!0});var b=se(c);k(a.$$.fragment,b),b.forEach(v),this.h()},h(){F(c,"position","relative"),F(c,"width","100%"),F(c,"height","300px")},m(p,u){w(p,n,u),Be(n,t),w(p,r,u),w(p,c,u),C(a,c,null),f=!0},p(p,[u]){(!f||u&2)&&l!==(l=JSON.stringify(p[1])+"")&&Me(t,l);const b={};u&515&&(b.$$scope={dirty:u,ctx:p}),!i&&u&1&&(i=!0,b.map=p[0],T(()=>i=!1)),a.$set(b)},i(p){f||(_(a.$$.fragment,p),f=!0)},o(p){h(a.$$.fragment,p),f=!1},d(p){p&&(v(n),v(r),v(c)),A(a)}}}function je(e){window.alert(`Clicked ${e}`)}function Je(e,n,l){let t,r=[];function c(s){l(1,r=[...r,s.lngLat])}me(()=>{t.on("click",c)}),ge(()=>{t.off("click",c)});function a(s,m,p,u){p[u]=s,l(1,r)}const i=s=>je(s);function f(s){t=s,l(0,t)}return[t,r,a,i,f]}class Ge extends j{constructor(n){super(),J(this,n,Je,Ve,O,{})}}function ce(e,n,l){const t=e.slice();return t[11]=n[l],t[12]=n,t[13]=l,t}function He(e){let n;return{c(){n=R("Add")},l(l){n=V(l,"Add")},m(l,t){w(l,n,t)},d(l){l&&v(n)}}}function Ke(e){let n;return{c(){n=R("Delete")},l(l){n=V(l,"Delete")},m(l,t){w(l,n,t)},d(l){l&&v(n)}}}function Ue(e){let n,l,t,r,c,a,i,f,s,m,p,u,b,g,d,q,E,B,P,N;function he(){return e[4](e[13])}n=new We({props:{$$slots:{default:[Ke]},$$scope:{ctx:e}}}),n.$on("click",he);function ve(o){e[5](o,e[11])}let G={label:"Critical Issue",emptyOption:!0,choices:e[1]};e[11].criticalIssue!==void 0&&(G.value=e[11].criticalIssue),t=new re({props:G}),D.push(()=>L(t,"value",ve));function be(o){e[6](o,e[11])}let H={label:"Stage",emptyOption:!0,choices:Le(["Existing","Design"])};e[11].stage!==void 0&&(H.value=e[11].stage),a=new re({props:H}),D.push(()=>L(a,"value",be));function we(o){e[7](o,e[11])}let K={label:"Location"};e[11].point!==void 0&&(K.value=e[11].point),s=new le({props:K}),D.push(()=>L(s,"value",we));function ye(o){e[8](o,e[11])}let U={label:"Location Name"};e[11].locationName!==void 0&&(U.value=e[11].locationName),u=new le({props:U}),D.push(()=>L(u,"value",ye));function ke(o){e[9](o,e[11])}let Y={label:"Resolved by Design"};e[11].resolved!==void 0&&(Y.value=e[11].resolved),d=new Pe({props:Y}),D.push(()=>L(d,"value",ke));function Ce(o){e[10](o,e[11])}let z={label:"Commentary & Feedback"};return e[11].notes!==void 0&&(z.value=e[11].notes),B=new qe({props:z}),D.push(()=>L(B,"value",Ce)),{c(){y(n.$$.fragment),l=S(),y(t.$$.fragment),c=S(),y(a.$$.fragment),f=S(),y(s.$$.fragment),p=S(),y(u.$$.fragment),g=S(),y(d.$$.fragment),E=S(),y(B.$$.fragment)},l(o){k(n.$$.fragment,o),l=I(o),k(t.$$.fragment,o),c=I(o),k(a.$$.fragment,o),f=I(o),k(s.$$.fragment,o),p=I(o),k(u.$$.fragment,o),g=I(o),k(d.$$.fragment,o),E=I(o),k(B.$$.fragment,o)},m(o,$){C(n,o,$),w(o,l,$),C(t,o,$),w(o,c,$),C(a,o,$),w(o,f,$),C(s,o,$),w(o,p,$),C(u,o,$),w(o,g,$),C(d,o,$),w(o,E,$),C(B,o,$),N=!0},p(o,$){e=o;const Q={};$&16384&&(Q.$$scope={dirty:$,ctx:e}),n.$set(Q);const X={};!r&&$&1&&(r=!0,X.value=e[11].criticalIssue,T(()=>r=!1)),t.$set(X);const Z={};!i&&$&1&&(i=!0,Z.value=e[11].stage,T(()=>i=!1)),a.$set(Z);const x={};!m&&$&1&&(m=!0,x.value=e[11].point,T(()=>m=!1)),s.$set(x);const ee={};!b&&$&1&&(b=!0,ee.value=e[11].locationName,T(()=>b=!1)),u.$set(ee);const te={};!q&&$&1&&(q=!0,te.value=e[11].resolved,T(()=>q=!1)),d.$set(te);const ne={};!P&&$&1&&(P=!0,ne.value=e[11].notes,T(()=>P=!1)),B.$set(ne)},i(o){N||(_(n.$$.fragment,o),_(t.$$.fragment,o),_(a.$$.fragment,o),_(s.$$.fragment,o),_(u.$$.fragment,o),_(d.$$.fragment,o),_(B.$$.fragment,o),N=!0)},o(o){h(n.$$.fragment,o),h(t.$$.fragment,o),h(a.$$.fragment,o),h(s.$$.fragment,o),h(u.$$.fragment,o),h(d.$$.fragment,o),h(B.$$.fragment,o),N=!1},d(o){o&&(v(l),v(c),v(f),v(p),v(g),v(E)),A(n,o),A(t,o),A(a,o),A(s,o),A(u,o),A(d,o),A(B,o)}}}function pe(e){let n,l;return n=new Ee({props:{label:e[11].id,open:!0,$$slots:{default:[Ue]},$$scope:{ctx:e}}}),{c(){y(n.$$.fragment)},l(t){k(n.$$.fragment,t)},m(t,r){C(n,t,r),l=!0},p(t,r){const c={};r&1&&(c.label=t[11].id),r&16385&&(c.$$scope={dirty:r,ctx:t}),n.$set(c)},i(t){l||(_(n.$$.fragment,t),l=!0)},o(t){h(n.$$.fragment,t),l=!1},d(t){A(n,t)}}}function Ye(e){let n,l,t,r,c;n=new Ne({props:{$$slots:{default:[He]},$$scope:{ctx:e}}}),n.$on("click",e[2]);let a=W(e[0].criticalIssues),i=[];for(let s=0;s<a.length;s+=1)i[s]=pe(ce(e,a,s));const f=s=>h(i[s],1,1,()=>{i[s]=null});return r=new Ge({}),{c(){y(n.$$.fragment),l=S();for(let s=0;s<i.length;s+=1)i[s].c();t=S(),y(r.$$.fragment)},l(s){k(n.$$.fragment,s),l=I(s);for(let m=0;m<i.length;m+=1)i[m].l(s);t=I(s),k(r.$$.fragment,s)},m(s,m){C(n,s,m),w(s,l,m);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(s,m);w(s,t,m),C(r,s,m),c=!0},p(s,[m]){const p={};if(m&16384&&(p.$$scope={dirty:m,ctx:s}),n.$set(p),m&11){a=W(s[0].criticalIssues);let u;for(u=0;u<a.length;u+=1){const b=ce(s,a,u);i[u]?(i[u].p(b,m),_(i[u],1)):(i[u]=pe(b),i[u].c(),_(i[u],1),i[u].m(t.parentNode,t))}for($e(),u=a.length;u<i.length;u+=1)f(u);_e()}},i(s){if(!c){_(n.$$.fragment,s);for(let m=0;m<a.length;m+=1)_(i[m]);_(r.$$.fragment,s),c=!0}},o(s){h(n.$$.fragment,s),i=i.filter(Boolean);for(let m=0;m<i.length;m+=1)h(i[m]);h(r.$$.fragment,s),c=!1},d(s){s&&(v(l),v(t)),A(n,s),de(i,s),A(r,s)}}}function ze(e,n,l){let t;Se(e,M,g=>l(0,t=g));let r=[["1","1 - Conflict at Side Roads and Priority Junctions: >2,500vpd cut across main walking, wheeling or cycling streams"],["2","2 - Conflict at Roundabouts and Signal Junctions: >2,500vpd cut across main walking, wheeling or cycling streams"],["3","3 - Lane Widths: Cyclists unprotected in 3.25-3.9m wide nearside lane"],["4","4 - Trip Hazards: Level differences >13mm with no tactile information and colour contrast"],["5A","5A - Kerbside Activity: Cycle facility next to parking/loading with insufficient buffer"],["5B","5B - Kerbside Activity: Unprotected cycle lane next to a frequently used bus layby"],["6A","6A - Provision of Crossings: on busy streets (>8,000vpd), formal crossings are more than 400m apart"],["6B","6B - Provision of Crossings: on quieter streets (<8,000vpd), desire lines are blocked by parking/loading"],["7A","7A - Standard of Crossings: on busy streets (>8,000vpd), uncontrolled crossings of 2+ lanes with no gaps in traffic"],["7B","7B - Standard of Crossings: at signal junctions, there are arms with no green man for pedestrians"],["8","8 - Motor Traffic Speed: Mean speed > 30mph when cyclists/pedestrians are unprotected"],["9A","9A - Motor Traffic Volume: >1,000 vehicles in busiest hour when cyclists/pedestrians are unprotected"],["9B","9B - Motor Traffic Volume: >5% HGV traffic when cyclists/pedestrians are unprotected and >500 vehicles in busiest hour"],["10","10 - Pedestrian Crossing Speed: Pedestrians must cross at speeds >1.2m/s"],["11A","11A - Footway Width: <1m clear width"],["11B","11B - Footway Width: 1.0-1.5m wide clear width for over 6m"],["11C","11C - Footway Width: <2m clear width and pedestrian comfort level is poor (PCL of D-E)"],["11D","11D - Footway Width: no footway"],["12A","12A - Effective Width next to Tram Lines: <2.4m effective width for cyclists from tramline edge to kerb on a straight run"],["12B","12B - Effective Width next to Tram Lines: insufficient effective width for cyclists on a curved section of tram route"],["13","13 - Crossing Angle of Tram/Train Rails: Cyclist crossing angle <60°"],["14",'14 - Cycling Surface and Maintenance Defects: Major defects (provide further information in "commentary and feedback")'],["15",'15 - Walking/Wheeling Surface and Maintenance Defects: Major defects (provide further information in "commentary and feedback")'],["16","16 - Guard Railing: used as standard without consideration of inherent safety risks"]];function c(){Ie(M,t.criticalIssues=[...t.criticalIssues,{id:"TODO",criticalIssue:"",stage:"",point:"",locationName:"",resolved:"",notes:""}],t)}function a(g){window.confirm("Delete this entry?")&&(t.criticalIssues.splice(g,1),M.set(t))}const i=g=>a(g);function f(g,d){e.$$.not_equal(d.criticalIssue,g)&&(d.criticalIssue=g,M.set(t))}function s(g,d){e.$$.not_equal(d.stage,g)&&(d.stage=g,M.set(t))}function m(g,d){e.$$.not_equal(d.point,g)&&(d.point=g,M.set(t))}function p(g,d){e.$$.not_equal(d.locationName,g)&&(d.locationName=g,M.set(t))}function u(g,d){e.$$.not_equal(d.resolved,g)&&(d.resolved=g,M.set(t))}function b(g,d){e.$$.not_equal(d.notes,g)&&(d.notes=g,M.set(t))}return[t,r,c,a,i,f,s,m,p,u,b]}class lt extends j{constructor(n){super(),J(this,n,ze,Ye,O,{})}}export{lt as component};
