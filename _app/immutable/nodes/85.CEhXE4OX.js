import{s as T,e as E,a as d,c as W,p as A,g as y,i as C,n as R,f as h,k as I}from"../chunks/scheduler.BBS-fkhU.js";import{S as O,i as x,c as S,a as $,m as P,t as v,b as D,d as L}from"../chunks/index.B8H3ypVf.js";import{s as j}from"../chunks/data.gTGK0hKM.js";import{g as _}from"../chunks/results.EvrlvKUy.js";import{p as b,c as M}from"../chunks/lists.BnA5ucEg.js";import{T as k}from"../chunks/TextArea.Ck6ITb4v.js";function w(t){let e=_(t),n=t.summary.checkType=="street",r=t.summary.checkType=="path",i={Safety:"Sa",Accessibility:"Ac",Comfort:"Cf",Directness:"Di",Attractiveness:"At",Cohesion:"Co",overall:"To"},o={"Social activity":"SA","Personal security":"PS","Character and legibility":"CL",Environment:"En",overall:"To"};return[...J(t),...N(t),...f("SA",0,t.safetyCheck),...f("ST",16,t.streetCheck),...f("SP",0,t.streetPlacemakingCheck),...f("PA",16,t.pathCheck),...f("PP",16,t.pathPlacemakingCheck),...F(t),...G(t),...m("ST-LOS",[...e.levelOfService,e.overall],n,i),...m("ST-LOS",e.byMode,n,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy"}),...m("SP-LOS",[...e.placemakingCategories,e.placemakingOverall],n,o),...m("PA-LOS",[...e.levelOfService,e.overall],r,i),...m("PA-LOS",e.byMode,r,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy","Horse Riding":"HR"}),...m("PP-LOS",[...e.placemakingCategories,e.placemakingOverall],r,o),...V(t,e),...H(t),...Y(t),...q()]}function J(t){let e=t.summary;return[["Scheme Ref",e.schemeReference],["Date of Design Review",e.dateDesignReview],["Scheme Name",e.schemeName],["Authority",e.authority],["Transport/ Combined Authority",e.transportOrCombinedAuthority],["Region",e.region],["Funding Programme",e.fundingProgramme],["Design Stage",e.designStage],["Funding Conditions",e.fundingConditions],["Inspector",e.inspectorEmail],["RouteLength",e.totalRouteLengthKm],["RouteFileLength",e.assessedRouteLengthKm],["Notes",e.notes],["Tool","Route Check online-alpha"],["Sub-tool",e.checkType=="street"?"Street Check":"Path Check"]]}function N(t){let e=[];for(let[n,r]of t.policyCheck.entries())e.push([`PC${p(n)}-E`,r.existing]),e.push([`PC${p(n)}-D`,r.proposed]);return e}function f(t,e,n){let r=[];for(let i=0;i<n.existingScores.length;i++)r.push([`${t}${p(i+e)}-E`,n.existingScores[i]]),r.push([`${t}${p(i+e)}-D`,n.proposedScores[i]]);return r}function p(t){return(t+1).toString().padStart(2,"0")}function F(t){let e={existing:t.policyConflictLog.filter(n=>n.stage=="Existing").length,designed:t.policyConflictLog.filter(n=>n.stage=="Design").length,removed:t.policyConflictLog.filter(n=>n.resolved=="Yes").length};return[["PC-E",e.existing],["PC-D",e.designed],["PC-Rem",e.removed],["PC-Int",e.designed],["PC-Tot",e.designed+e.existing-e.removed]]}function G(t){let e={existing:t.criticalIssues.filter(n=>n.stage=="Existing").length,designed:t.criticalIssues.filter(n=>n.stage=="Design").length,removed:t.criticalIssues.filter(n=>n.resolved=="Yes").length};return[["SA-E",e.existing],["SA-D",e.designed],["SA-Rem",e.removed],["SA-Int",e.designed],["SA-Tot",e.designed+e.existing-e.removed]]}function m(t,e,n,r){let i=[];for(let o of e){let l=r[o.category];i.push([`${t}-${l}-E`,n?"":`${Math.round(o.existing.scorePercent)}%`]),i.push([`${t}-${l}-D`,n?"":`${Math.round(o.proposed.scorePercent)}%`])}return i}function V(t,e){let n=[],r=12;for(let i=1;i<=r;i++)for(let[o,l]of[["walkingWheeling","WW"],["cycling","Cy"],["total","To"]])n.push([`J${i}-LOS-${l}-E`,i<=e.jat.length?e.jat[i-1][o].existing:""]),n.push([`J${i}-LOS-${l}-D`,i<=e.jat.length?e.jat[i-1][o].proposed:""]);for(let i=1;i<=r;i++)i<=e.jat.length?n.push([`J${i}-Arms`,t.jat[i-1].proposed.arms.length]):n.push([`J${i}-Arms`,0]);return n}function B(t,e){let n=t.policyConflictLog[e],r=0;for(let o=0;o<=e;o++)t.policyConflictLog[o].conflict==n.conflict&&r++;return[t.summary.schemeReference,`P${n.conflict.padStart(3,"0")}`,`${r.toString().padStart(2,"0")}P`].join("_")}function H(t){let e=[],n=35;for(let r=0;r<n;r++){let i;if(r<t.policyConflictLog.length){let o=t.policyConflictLog[r];i={Ref:B(t,r),Typ:b.find(l=>l[0]==o.conflict)[1],Sta:o.stage,LaL:`${o.point[1]}, ${o.point[0]}`,Loc:o.locationName,Res:o.resolved,Com:o.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[o,l]of Object.entries(i))e.push([`${p(r)}PC${o}`,l])}return e}function K(t,e){let n=t.criticalIssues[e],r=0;for(let o=0;o<=e;o++)t.criticalIssues[o].criticalIssue==n.criticalIssue&&r++;return[t.summary.schemeReference,`SA${n.criticalIssue.padStart(2,"0")}`,`${r.toString().padStart(2,"0")}P`].join("_")}function Y(t){let e=[],n=35;for(let r=0;r<n;r++){let i;if(r<t.criticalIssues.length){let o=t.criticalIssues[r];i={Ref:K(t,r),Typ:M.find(l=>l[0]==o.criticalIssue)[1],Sta:o.stage,LaL:`${o.point[1]}, ${o.point[0]}`,Loc:o.locationName,Res:o.resolved,Com:o.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[o,l]of Object.entries(i))e.push([`${p(r)}SA${o}`,l])}return e}function q(){return["Area-E","Area-D","Po-WW-E","Po-WW-D","Po-Cy-E","Po-Cy-D","Cr-WW-E","Cr-WW-D","Cr-Cy-E","Cr-Cy-D","Pe-WW-D","Pe-WW-E","Pe-Cy-D","Pe-Cy-E","MD-WW-D","MD-WW-E","MD-Cy-D","MD-Cy-E","MT-E","MT-D","PT-E","PT-D","GI-E","GI-D","IT-E","IT-D","EP-E","EP-D","TM-Comments","AC-Comments"].map(e=>[e,""])}function z(t){let e,n="TODO. Below is the start to the DALOG output as TSV (tab-separated values).",r,i,o,l,a,c,g;return i=new k({props:{label:"TSV output, just the one row of values",value:t[2]}}),l=new k({props:{label:"TSV output with header",value:`${t[1]}
${t[2]}
`}}),c=new k({props:{label:"JSON mapping",value:JSON.stringify(Object.fromEntries(t[0]),null,"  ")}}),{c(){e=E("p"),e.textContent=n,r=d(),S(i.$$.fragment),o=d(),S(l.$$.fragment),a=d(),S(c.$$.fragment)},l(s){e=W(s,"P",{"data-svelte-h":!0}),A(e)!=="svelte-163miu5"&&(e.textContent=n),r=y(s),$(i.$$.fragment,s),o=y(s),$(l.$$.fragment,s),a=y(s),$(c.$$.fragment,s)},m(s,u){C(s,e,u),C(s,r,u),P(i,s,u),C(s,o,u),P(l,s,u),C(s,a,u),P(c,s,u),g=!0},p:R,i(s){g||(v(i.$$.fragment,s),v(l.$$.fragment,s),v(c.$$.fragment,s),g=!0)},o(s){D(i.$$.fragment,s),D(l.$$.fragment,s),D(c.$$.fragment,s),g=!1},d(s){s&&(h(e),h(r),h(o),h(a)),L(i,s),L(l,s),L(c,s)}}}function Q(t,e,n){let r;I(t,j,a=>n(3,r=a));let i=w(r),o=i.map(a=>a[0]).join("	"),l=i.map(a=>a[1]).join("	");return[i,o,l]}class ne extends O{constructor(e){super(),x(this,e,Q,z,T,{})}}export{ne as component};
