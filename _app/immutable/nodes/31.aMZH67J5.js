import{s as de,e as P,t as X,a as q,c as T,b as V,d as Y,f as j,g as D,r as C,w as U,i as I,h as L,j as he,q as ee,Q as je,C as le,x as ae,z as we,H as Ee,A as O,v as Q,B as z,k as Se,N as Le,O as qe,P as De,n as Me}from"../chunks/scheduler.DUXu1fc4.js";import{S as $e,i as ve,c as N,a as A,m as F,t as w,b as E,d as G,f as R,e as be,g as ke}from"../chunks/index.Cw3Z3Eqf.js";import{e as J}from"../chunks/each.CBIw2Sej.js";import{p as ie}from"../chunks/index.1D6E3q4g.js";import{b as Be}from"../chunks/colors.cXDjJPjh.js";import{E as Ce}from"../chunks/FormElement.BUZgaVT-.js";import{v as Ie}from"../chunks/v4.D8aEg3BZ.js";import{S as Ne,W as Ae}from"../chunks/WarningButton.M-LXQQTX.js";import{S as oe}from"../chunks/Select.CZexGjXH.js";import{T as Fe}from"../chunks/TextInput.BwN4dbUN.js";import{t as Ge,L as Pe}from"../chunks/LineLayer.Dv28RwkM.js";import{M as Te,G as Ve}from"../chunks/MapLibreMap.B3Y5dvyS.js";import{s as K}from"../chunks/data.DJtq5Z8k.js";import{D as re}from"../chunks/DraggablePin.BRMZNIX3.js";function se(e,t,n){const l=e.slice();return l[10]=t[n][0],l[11]=t[n][1],l}function ue(e){let t,n,l,f,u=!1,c,i,r=e[11]+"",m,_,o,g,p,v;return g=je(e[9][0]),{c(){t=P("div"),n=P("input"),c=q(),i=P("label"),m=X(r),o=q(),this.h()},l(d){t=T(d,"DIV",{class:!0});var b=V(t);n=T(b,"INPUT",{class:!0,id:!0,type:!0}),c=D(b),i=T(b,"LABEL",{class:!0,for:!0});var M=V(i);m=Y(M,r),M.forEach(j),o=D(b),b.forEach(j),this.h()},h(){C(n,"class","govuk-radios__input"),C(n,"id",l=e[5]+e[10]),C(n,"type","radio"),n.__value=f=e[10],le(n,n.__value),C(i,"class","govuk-label govuk-radios__label"),C(i,"for",_=e[5]+e[10]),C(t,"class","govuk-radios__item"),g.p(n)},m(d,b){I(d,t,b),L(t,n),n.checked=n.__value===e[0],L(t,c),L(t,i),L(i,m),L(t,o),p||(v=[ae(n,"change",e[8]),ae(n,"change",e[7])],p=!0)},p(d,b){b&4&&l!==(l=d[5]+d[10])&&C(n,"id",l),b&4&&f!==(f=d[10])&&(n.__value=f,le(n,n.__value),u=!0),(u||b&5)&&(n.checked=n.__value===d[0]),b&4&&r!==(r=d[11]+"")&&he(m,r),b&4&&_!==(_=d[5]+d[10])&&C(i,"for",_)},d(d){d&&j(t),g.r(),p=!1,we(v)}}}function Ke(e){let t,n,l,f,u,c,i,r,m;c=new Ce({props:{errorMessage:e[4]}});let _=J(e[2]),o=[];for(let g=0;g<_.length;g+=1)o[g]=ue(se(e,_,g));return{c(){t=P("div"),n=P("fieldset"),l=P("legend"),f=X(e[1]),u=q(),N(c.$$.fragment),i=q(),r=P("div");for(let g=0;g<o.length;g+=1)o[g].c();this.h()},l(g){t=T(g,"DIV",{class:!0});var p=V(t);n=T(p,"FIELDSET",{class:!0});var v=V(n);l=T(v,"LEGEND",{class:!0});var d=V(l);f=Y(d,e[1]),d.forEach(j),u=D(v),A(c.$$.fragment,v),i=D(v),r=T(v,"DIV",{class:!0,"data-module":!0});var b=V(r);for(let M=0;M<o.length;M+=1)o[M].l(b);b.forEach(j),v.forEach(j),p.forEach(j),this.h()},h(){C(l,"class","govuk-fieldset__legend govuk-label--s"),C(r,"class","govuk-radios"),C(r,"data-module","govuk-radios"),U(r,"govuk-radios--inline",e[3]),U(r,"govuk-radios--small",e[3]),C(n,"class","govuk-fieldset"),C(t,"class","govuk-form-group")},m(g,p){I(g,t,p),L(t,n),L(n,l),L(l,f),L(n,u),F(c,n,null),L(n,i),L(n,r);for(let v=0;v<o.length;v+=1)o[v]&&o[v].m(r,null);m=!0},p(g,[p]){(!m||p&2)&&he(f,g[1]);const v={};if(p&16&&(v.errorMessage=g[4]),c.$set(v),p&37){_=J(g[2]);let d;for(d=0;d<_.length;d+=1){const b=se(g,_,d);o[d]?o[d].p(b,p):(o[d]=ue(b),o[d].c(),o[d].m(r,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=_.length}(!m||p&8)&&U(r,"govuk-radios--inline",g[3]),(!m||p&8)&&U(r,"govuk-radios--small",g[3])},i(g){m||(w(c.$$.fragment,g),m=!0)},o(g){E(c.$$.fragment,g),m=!1},d(g){g&&j(t),G(c),ee(o,g)}}}function Oe(e,t,n){let l,{legend:f}=t,{choices:u}=t,{inlineSmall:c=!1}=t,{required:i=!1}=t,{value:r}=t,m=Ie();const _=[[]];function o(p){Ee.call(this,e,p)}function g(){r=this.__value,n(0,r)}return e.$$set=p=>{"legend"in p&&n(1,f=p.legend),"choices"in p&&n(2,u=p.choices),"inlineSmall"in p&&n(3,c=p.inlineSmall),"required"in p&&n(6,i=p.required),"value"in p&&n(0,r=p.value)},e.$$.update=()=>{e.$$.dirty&65&&n(4,l=i&&r==""?"Required":"")},[r,f,u,c,l,m,i,o,g,_]}class fe extends $e{constructor(t){super(),ve(this,t,Oe,Ke,de,{legend:1,choices:2,inlineSmall:3,required:6,value:0})}}function ge(e){return Ge(e)}function _e(e,t,n){const l=e.slice();return l[19]=t[n],l[20]=t,l[21]=n,l}function pe(e,t,n){const l=e.slice();return l[19]=t[n],l[22]=t,l[23]=n,l}function ze(e){let t;return{c(){t=X("Zoom to fit")},l(n){t=Y(n,"Zoom to fit")},m(n,l){I(n,t,l)},d(n){n&&j(t)}}}function me(e){let t,n,l,f,u,c;function i(o){e[11](o,e[19])}let r={map:e[0]};e[19].point1!==void 0&&(r.position=e[19].point1),t=new re({props:r}),O.push(()=>R(t,"position",i));function m(o){e[12](o,e[19])}let _={map:e[0]};return e[19].point2!==void 0&&(_.position=e[19].point2),f=new re({props:_}),O.push(()=>R(f,"position",m)),{c(){N(t.$$.fragment),l=q(),N(f.$$.fragment)},l(o){A(t.$$.fragment,o),l=D(o),A(f.$$.fragment,o)},m(o,g){F(t,o,g),I(o,l,g),F(f,o,g),c=!0},p(o,g){e=o;const p={};g&1&&(p.map=e[0]),!n&&g&8&&(n=!0,p.position=e[19].point1,z(()=>n=!1)),t.$set(p);const v={};g&1&&(v.map=e[0]),!u&&g&8&&(u=!0,v.position=e[19].point2,z(()=>u=!1)),f.$set(v)},i(o){c||(w(t.$$.fragment,o),w(f.$$.fragment,o),c=!0)},o(o){E(t.$$.fragment,o),E(f.$$.fragment,o),c=!1},d(o){o&&j(l),G(t,o),G(f,o)}}}function Re(e){let t,n;return t=new Pe({props:{paint:{"line-width":6,"line-color":["get","color"]}}}),{c(){N(t.$$.fragment)},l(l){A(t.$$.fragment,l)},m(l,f){F(t,l,f),n=!0},p:Me,i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){E(t.$$.fragment,l),n=!1},d(l){G(t,l)}}}function We(e){let t,n,l,f=J(e[3].jat.movements),u=[];for(let i=0;i<f.length;i+=1)u[i]=me(pe(e,f,i));const c=i=>E(u[i],1,1,()=>{u[i]=null});return n=new Ve({props:{data:e[6](e[3].jat.movements),$$slots:{default:[Re]},$$scope:{ctx:e}}}),{c(){for(let i=0;i<u.length;i+=1)u[i].c();t=q(),N(n.$$.fragment)},l(i){for(let r=0;r<u.length;r+=1)u[r].l(i);t=D(i),A(n.$$.fragment,i)},m(i,r){for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(i,r);I(i,t,r),F(n,i,r),l=!0},p(i,r){if(r&9){f=J(i[3].jat.movements);let _;for(_=0;_<f.length;_+=1){const o=pe(i,f,_);u[_]?(u[_].p(o,r),w(u[_],1)):(u[_]=me(o),u[_].c(),w(u[_],1),u[_].m(t.parentNode,t))}for(ke(),_=f.length;_<u.length;_+=1)c(_);be()}const m={};r&8&&(m.data=i[6](i[3].jat.movements)),r&16777216&&(m.$$scope={dirty:r,ctx:i}),n.$set(m)},i(i){if(!l){for(let r=0;r<f.length;r+=1)w(u[r]);w(n.$$.fragment,i),l=!0}},o(i){u=u.filter(Boolean);for(let r=0;r<u.length;r+=1)E(u[r]);E(n.$$.fragment,i),l=!1},d(i){i&&j(t),ee(u,i),G(n,i)}}}function Ze(e){let t;return{c(){t=X("Delete")},l(n){t=Y(n,"Delete")},m(n,l){I(n,t,l)},d(n){n&&j(t)}}}function ce(e){let t,n,l,f,u,c,i,r,m,_,o,g,p;function v($){e[14]($,e[19])}let d={label:"Name"};e[19].name!==void 0&&(d.value=e[19].name),n=new Fe({props:d}),O.push(()=>R(n,"value",v));function b($){e[15]($,e[19])}let M={label:"Kind",choices:e[4]};e[19].kind!==void 0&&(M.value=e[19].kind),u=new oe({props:M}),O.push(()=>R(u,"value",b));function W($){e[16]($,e[19])}let Z={label:"Color",choices:e[5]};e[19].color!==void 0&&(Z.value=e[19].color),r=new oe({props:Z}),O.push(()=>R(r,"value",W));function y(){return e[17](e[21])}return o=new Ae({props:{$$slots:{default:[Ze]},$$scope:{ctx:e}}}),o.$on("click",y),{c(){t=P("li"),N(n.$$.fragment),f=q(),N(u.$$.fragment),i=q(),N(r.$$.fragment),_=q(),N(o.$$.fragment),g=q(),this.h()},l($){t=T($,"LI",{style:!0});var a=V(t);A(n.$$.fragment,a),f=D(a),A(u.$$.fragment,a),i=D(a),A(r.$$.fragment,a),_=D(a),A(o.$$.fragment,a),g=D(a),a.forEach(j),this.h()},h(){Q(t,"display","flex"),Q(t,"justify-content","space-evenly")},m($,a){I($,t,a),F(n,t,null),L(t,f),F(u,t,null),L(t,i),F(r,t,null),L(t,_),F(o,t,null),L(t,g),p=!0},p($,a){e=$;const k={};!l&&a&8&&(l=!0,k.value=e[19].name,z(()=>l=!1)),n.$set(k);const s={};!c&&a&8&&(c=!0,s.value=e[19].kind,z(()=>c=!1)),u.$set(s);const h={};!m&&a&8&&(m=!0,h.value=e[19].color,z(()=>m=!1)),r.$set(h);const B={};a&16777216&&(B.$$scope={dirty:a,ctx:e}),o.$set(B)},i($){p||(w(n.$$.fragment,$),w(u.$$.fragment,$),w(r.$$.fragment,$),w(o.$$.fragment,$),p=!0)},o($){E(n.$$.fragment,$),E(u.$$.fragment,$),E(r.$$.fragment,$),E(o.$$.fragment,$),p=!1},d($){$&&j(t),G(n),G(u),G(r),G(o)}}}function ye(e){let t,n,l,f,u,c,i,r,m,_,o,g,p,v;function d(s){e[9](s)}let b={legend:"Kind",choices:e[4],inlineSmall:!0};e[1]!==void 0&&(b.value=e[1]),t=new fe({props:b}),O.push(()=>R(t,"value",d));function M(s){e[10](s)}let W={legend:"Color",choices:e[5],inlineSmall:!0};e[2]!==void 0&&(W.value=e[2]),f=new fe({props:W}),O.push(()=>R(f,"value",M)),i=new Ne({props:{$$slots:{default:[ze]},$$scope:{ctx:e}}}),i.$on("click",e[8]);function Z(s){e[13](s)}let y={$$slots:{default:[We]},$$scope:{ctx:e}};e[0]!==void 0&&(y.map=e[0]),_=new Te({props:y}),O.push(()=>R(_,"map",Z));let $=J(e[3].jat.movements),a=[];for(let s=0;s<$.length;s+=1)a[s]=ce(_e(e,$,s));const k=s=>E(a[s],1,1,()=>{a[s]=null});return{c(){N(t.$$.fragment),l=q(),N(f.$$.fragment),c=q(),N(i.$$.fragment),r=q(),m=P("div"),N(_.$$.fragment),g=q(),p=P("ol");for(let s=0;s<a.length;s+=1)a[s].c();this.h()},l(s){A(t.$$.fragment,s),l=D(s),A(f.$$.fragment,s),c=D(s),A(i.$$.fragment,s),r=D(s),m=T(s,"DIV",{style:!0});var h=V(m);A(_.$$.fragment,h),h.forEach(j),g=D(s),p=T(s,"OL",{});var B=V(p);for(let H=0;H<a.length;H+=1)a[H].l(B);B.forEach(j),this.h()},h(){Q(m,"position","relative"),Q(m,"width","100%"),Q(m,"height","600px")},m(s,h){F(t,s,h),I(s,l,h),F(f,s,h),I(s,c,h),F(i,s,h),I(s,r,h),I(s,m,h),F(_,m,null),I(s,g,h),I(s,p,h);for(let B=0;B<a.length;B+=1)a[B]&&a[B].m(p,null);v=!0},p(s,[h]){const B={};!n&&h&2&&(n=!0,B.value=s[1],z(()=>n=!1)),t.$set(B);const H={};!u&&h&4&&(u=!0,H.value=s[2],z(()=>u=!1)),f.$set(H);const te={};h&16777216&&(te.$$scope={dirty:h,ctx:s}),i.$set(te);const x={};if(h&16777225&&(x.$$scope={dirty:h,ctx:s}),!o&&h&1&&(o=!0,x.map=s[0],z(()=>o=!1)),_.$set(x),h&184){$=J(s[3].jat.movements);let S;for(S=0;S<$.length;S+=1){const ne=_e(s,$,S);a[S]?(a[S].p(ne,h),w(a[S],1)):(a[S]=ce(ne),a[S].c(),w(a[S],1),a[S].m(p,null))}for(ke(),S=$.length;S<a.length;S+=1)k(S);be()}},i(s){if(!v){w(t.$$.fragment,s),w(f.$$.fragment,s),w(i.$$.fragment,s),w(_.$$.fragment,s);for(let h=0;h<$.length;h+=1)w(a[h]);v=!0}},o(s){E(t.$$.fragment,s),E(f.$$.fragment,s),E(i.$$.fragment,s),E(_.$$.fragment,s),a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)E(a[h]);v=!1},d(s){s&&(j(l),j(c),j(r),j(m),j(g),j(p)),G(t,s),G(f,s),G(i,s),G(_),ee(a,s)}}}function He(e,t,n){let l;Se(e,K,a=>n(3,l=a));let f,u="cycling-straight",c="green",i=ie(["cycling-straight","cycling-turn","pedestrian"]),r=ie(["green","amber","red","critical"]);function m(a){De(K,l.jat.movements=[...l.jat.movements,{point1:a.lngLat.toArray(),point2:a.lngLat.toArray(),kind:u,color:c,name:"",notes:""}],l)}Le(()=>{f.on("click",m),l.jat.movements.length>0&&f.fitBounds(ge(_(l.jat.movements)),{padding:20,animate:!1})}),qe(()=>{f.off("click",m)});function _(a){return{type:"FeatureCollection",features:a.map(k=>({type:"Feature",properties:{kind:k.kind,color:Be[k.color].background},geometry:{type:"LineString",coordinates:[k.point1,k.point2]}}))}}function o(a){l.jat.movements.splice(a,1),K.set(l)}function g(){l.jat.movements.length>0&&f.fitBounds(ge(_(l.jat.movements)),{padding:20,animate:!0})}function p(a){u=a,n(1,u)}function v(a){c=a,n(2,c)}function d(a,k){e.$$.not_equal(k.point1,a)&&(k.point1=a,K.set(l))}function b(a,k){e.$$.not_equal(k.point2,a)&&(k.point2=a,K.set(l))}function M(a){f=a,n(0,f)}function W(a,k){e.$$.not_equal(k.name,a)&&(k.name=a,K.set(l))}function Z(a,k){e.$$.not_equal(k.kind,a)&&(k.kind=a,K.set(l))}function y(a,k){e.$$.not_equal(k.color,a)&&(k.color=a,K.set(l))}return[f,u,c,l,i,r,_,o,g,p,v,d,b,M,W,Z,y,a=>o(a)]}class st extends $e{constructor(t){super(),ve(this,t,He,ye,de,{})}}export{st as component};
