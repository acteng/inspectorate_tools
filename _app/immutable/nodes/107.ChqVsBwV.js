import{s as we,r as J,e as z,t as W,a as A,c as H,b as K,d as Y,f as d,g as q,o as F,v as U,i as I,h as P,w as X,k as ye,z as ze,U as He,S as Se,E as me,m as ve,G as $e,j as re,n as Ke,K as be,L as ke}from"../chunks/scheduler.DNnUYlgZ.js";import{S as Ie,i as Le,e as Q,c as G,a as M,m as V,t as y,b as S,d as R,f as ae,g as fe}from"../chunks/index.tVBxdTp3.js";import{s as ge,d as de,M as Ze,f as We,b as Ye,C as Je,G as Xe,h as Qe}from"../chunks/index.CGKOjZ2U.js";import{e as ne}from"../chunks/each.BkSaxPTE.js";import{c as xe,p as et}from"../chunks/colors.CYEpEtTL.js";import{p as Ve}from"../chunks/index.B7xTXe2E.js";import{S as he}from"../chunks/Select.J5KI9BoG.js";/* empty css                                                               */import{T as Re}from"../chunks/TextArea.NwvsZ3J4.js";import{T as Te}from"../chunks/TextInput.BIr_xOOQ.js";import{s as Z}from"../chunks/data.BpKMtiS3.js";import{c as tt,p as lt}from"../chunks/lists.djxH55N_.js";import{Y as Fe}from"../chunks/YesNo.CqgSJIxq.js";import{B as nt,G as it,S as ot,C as st,a as rt,M as Oe}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.D4aUOt7-.js";import{C as at}from"../chunks/CollapsibleCard.JZZ-_N1r.js";import{D as ft}from"../chunks/DefaultButton.B_sEEUsJ.js";import{R as ut}from"../chunks/Radio.DQ8GJLiV.js";import{S as ct}from"../chunks/SecondaryButton.CsCq7jjb.js";import{W as pt}from"../chunks/WarningButton.BcgE3MAp.js";import{G as _t}from"../chunks/GeoreferenceLayer.C-dFJx0e.js";import{C as Ue}from"../chunks/ClickableCard.C-b1L8ER.js";/* empty css                                                    */import"../chunks/paths.D0jihDZH.js";function mt(t){let e,i,l,s,c,u,a,_,$,r,C,f,g,j,b,N,o,p,w,B,L,v,T,E;function ie(n){t[2](n)}let m={label:"Critical Issue",emptyOption:!0,choices:tt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(m.value=t[1].criticalIssues[t[0]].criticalIssue),r=new he({props:m}),J.push(()=>Q(r,"value",ie));function k(n){t[3](n)}let O={label:"Stage",emptyOption:!0,choices:Ve(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(O.value=t[1].criticalIssues[t[0]].stage),g=new he({props:O}),J.push(()=>Q(g,"value",k));function le(n){t[4](n)}let D={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(D.value=t[1].criticalIssues[t[0]].locationName),N=new Te({props:D}),J.push(()=>Q(N,"value",le));function ee(n){t[5](n)}let oe={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(oe.value=t[1].criticalIssues[t[0]].resolved),w=new Fe({props:oe}),J.push(()=>Q(w,"value",ee));function ue(n){t[6](n)}let se={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(se.value=t[1].criticalIssues[t[0]].notes),v=new Re({props:se}),J.push(()=>Q(v,"value",ue)),{c(){e=z("div"),i=z("a"),l=W("Google StreetView"),c=A(),u=z("a"),a=W("Bing Streetside"),$=A(),G(r.$$.fragment),f=A(),G(g.$$.fragment),b=A(),G(N.$$.fragment),p=A(),G(w.$$.fragment),L=A(),G(v.$$.fragment),this.h()},l(n){e=H(n,"DIV",{style:!0});var h=K(e);i=H(h,"A",{href:!0,target:!0});var x=K(i);l=Y(x,"Google StreetView"),x.forEach(d),c=q(h),u=H(h,"A",{href:!0,target:!0});var te=K(u);a=Y(te,"Bing Streetside"),te.forEach(d),h.forEach(d),$=q(n),M(r.$$.fragment,n),f=q(n),M(g.$$.fragment,n),b=q(n),M(N.$$.fragment,n),p=q(n),M(w.$$.fragment,n),L=q(n),M(v.$$.fragment,n),this.h()},h(){F(i,"href",s=ge(t[1].criticalIssues[t[0]].point)),F(i,"target","_blank"),F(u,"href",_=de(t[1].criticalIssues[t[0]].point)),F(u,"target","_blank"),U(e,"display","flex"),U(e,"justify-content","space-evenly")},m(n,h){I(n,e,h),P(e,i),P(i,l),P(e,c),P(e,u),P(u,a),I(n,$,h),V(r,n,h),I(n,f,h),V(g,n,h),I(n,b,h),V(N,n,h),I(n,p,h),V(w,n,h),I(n,L,h),V(v,n,h),E=!0},p(n,[h]){(!E||h&3&&s!==(s=ge(n[1].criticalIssues[n[0]].point)))&&F(i,"href",s),(!E||h&3&&_!==(_=de(n[1].criticalIssues[n[0]].point)))&&F(u,"href",_);const x={};!C&&h&3&&(C=!0,x.value=n[1].criticalIssues[n[0]].criticalIssue,X(()=>C=!1)),r.$set(x);const te={};!j&&h&3&&(j=!0,te.value=n[1].criticalIssues[n[0]].stage,X(()=>j=!1)),g.$set(te);const ce={};!o&&h&3&&(o=!0,ce.value=n[1].criticalIssues[n[0]].locationName,X(()=>o=!1)),N.$set(ce);const pe={};!B&&h&3&&(B=!0,pe.value=n[1].criticalIssues[n[0]].resolved,X(()=>B=!1)),w.$set(pe);const _e={};!T&&h&3&&(T=!0,_e.value=n[1].criticalIssues[n[0]].notes,X(()=>T=!1)),v.$set(_e)},i(n){E||(y(r.$$.fragment,n),y(g.$$.fragment,n),y(N.$$.fragment,n),y(w.$$.fragment,n),y(v.$$.fragment,n),E=!0)},o(n){S(r.$$.fragment,n),S(g.$$.fragment,n),S(N.$$.fragment,n),S(w.$$.fragment,n),S(v.$$.fragment,n),E=!1},d(n){n&&(d(e),d($),d(f),d(b),d(p),d(L)),R(r,n),R(g,n),R(N,n),R(w,n),R(v,n)}}}function $t(t,e,i){let l;ye(t,Z,r=>i(1,l=r));let{idx:s}=e;function c(r){t.$$.not_equal(l.criticalIssues[s].criticalIssue,r)&&(l.criticalIssues[s].criticalIssue=r,Z.set(l))}function u(r){t.$$.not_equal(l.criticalIssues[s].stage,r)&&(l.criticalIssues[s].stage=r,Z.set(l))}function a(r){t.$$.not_equal(l.criticalIssues[s].locationName,r)&&(l.criticalIssues[s].locationName=r,Z.set(l))}function _(r){t.$$.not_equal(l.criticalIssues[s].resolved,r)&&(l.criticalIssues[s].resolved=r,Z.set(l))}function $(r){t.$$.not_equal(l.criticalIssues[s].notes,r)&&(l.criticalIssues[s].notes=r,Z.set(l))}return t.$$set=r=>{"idx"in r&&i(0,s=r.idx)},[s,l,c,u,a,_,$]}class gt extends Ie{constructor(e){super(),Le(this,e,$t,mt,we,{idx:0})}}function dt(t){let e,i,l,s,c,u,a,_,$,r,C,f,g,j,b,N,o,p,w,B,L,v,T,E;function ie(n){t[2](n)}let m={label:"Policy Conflict",emptyOption:!0,choices:lt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(m.value=t[1].policyConflictLog[t[0]].conflict),r=new he({props:m}),J.push(()=>Q(r,"value",ie));function k(n){t[3](n)}let O={label:"Stage",emptyOption:!0,choices:Ve(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(O.value=t[1].policyConflictLog[t[0]].stage),g=new he({props:O}),J.push(()=>Q(g,"value",k));function le(n){t[4](n)}let D={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(D.value=t[1].policyConflictLog[t[0]].locationName),N=new Te({props:D}),J.push(()=>Q(N,"value",le));function ee(n){t[5](n)}let oe={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(oe.value=t[1].policyConflictLog[t[0]].resolved),w=new Fe({props:oe}),J.push(()=>Q(w,"value",ee));function ue(n){t[6](n)}let se={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(se.value=t[1].policyConflictLog[t[0]].notes),v=new Re({props:se}),J.push(()=>Q(v,"value",ue)),{c(){e=z("div"),i=z("a"),l=W("Google StreetView"),c=A(),u=z("a"),a=W("Bing Streetside"),$=A(),G(r.$$.fragment),f=A(),G(g.$$.fragment),b=A(),G(N.$$.fragment),p=A(),G(w.$$.fragment),L=A(),G(v.$$.fragment),this.h()},l(n){e=H(n,"DIV",{style:!0});var h=K(e);i=H(h,"A",{href:!0,target:!0});var x=K(i);l=Y(x,"Google StreetView"),x.forEach(d),c=q(h),u=H(h,"A",{href:!0,target:!0});var te=K(u);a=Y(te,"Bing Streetside"),te.forEach(d),h.forEach(d),$=q(n),M(r.$$.fragment,n),f=q(n),M(g.$$.fragment,n),b=q(n),M(N.$$.fragment,n),p=q(n),M(w.$$.fragment,n),L=q(n),M(v.$$.fragment,n),this.h()},h(){F(i,"href",s=ge(t[1].policyConflictLog[t[0]].point)),F(i,"target","_blank"),F(u,"href",_=de(t[1].policyConflictLog[t[0]].point)),F(u,"target","_blank"),U(e,"display","flex"),U(e,"justify-content","space-evenly")},m(n,h){I(n,e,h),P(e,i),P(i,l),P(e,c),P(e,u),P(u,a),I(n,$,h),V(r,n,h),I(n,f,h),V(g,n,h),I(n,b,h),V(N,n,h),I(n,p,h),V(w,n,h),I(n,L,h),V(v,n,h),E=!0},p(n,[h]){(!E||h&3&&s!==(s=ge(n[1].policyConflictLog[n[0]].point)))&&F(i,"href",s),(!E||h&3&&_!==(_=de(n[1].policyConflictLog[n[0]].point)))&&F(u,"href",_);const x={};!C&&h&3&&(C=!0,x.value=n[1].policyConflictLog[n[0]].conflict,X(()=>C=!1)),r.$set(x);const te={};!j&&h&3&&(j=!0,te.value=n[1].policyConflictLog[n[0]].stage,X(()=>j=!1)),g.$set(te);const ce={};!o&&h&3&&(o=!0,ce.value=n[1].policyConflictLog[n[0]].locationName,X(()=>o=!1)),N.$set(ce);const pe={};!B&&h&3&&(B=!0,pe.value=n[1].policyConflictLog[n[0]].resolved,X(()=>B=!1)),w.$set(pe);const _e={};!T&&h&3&&(T=!0,_e.value=n[1].policyConflictLog[n[0]].notes,X(()=>T=!1)),v.$set(_e)},i(n){E||(y(r.$$.fragment,n),y(g.$$.fragment,n),y(N.$$.fragment,n),y(w.$$.fragment,n),y(v.$$.fragment,n),E=!0)},o(n){S(r.$$.fragment,n),S(g.$$.fragment,n),S(N.$$.fragment,n),S(w.$$.fragment,n),S(v.$$.fragment,n),E=!1},d(n){n&&(d(e),d($),d(f),d(b),d(p),d(L)),R(r,n),R(g,n),R(N,n),R(w,n),R(v,n)}}}function ht(t,e,i){let l;ye(t,Z,r=>i(1,l=r));let{idx:s}=e;function c(r){t.$$.not_equal(l.policyConflictLog[s].conflict,r)&&(l.policyConflictLog[s].conflict=r,Z.set(l))}function u(r){t.$$.not_equal(l.policyConflictLog[s].stage,r)&&(l.policyConflictLog[s].stage=r,Z.set(l))}function a(r){t.$$.not_equal(l.policyConflictLog[s].locationName,r)&&(l.policyConflictLog[s].locationName=r,Z.set(l))}function _(r){t.$$.not_equal(l.policyConflictLog[s].resolved,r)&&(l.policyConflictLog[s].resolved=r,Z.set(l))}function $(r){t.$$.not_equal(l.policyConflictLog[s].notes,r)&&(l.policyConflictLog[s].notes=r,Z.set(l))}return t.$$set=r=>{"idx"in r&&i(0,s=r.idx)},[s,l,c,u,a,_,$]}class vt extends Ie{constructor(e){super(),Le(this,e,ht,dt,we,{idx:0})}}const{window:bt}=We;function Ne(t,e,i){const l=t.slice();return l[32]=e[i],l[33]=e,l[34]=i,l}function Ee(t,e,i){const l=t.slice();return l[35]=e[i],l[36]=e,l[34]=i,l}function De(t,e,i){const l=t.slice();return l[32]=e[i],l[34]=i,l}function je(t,e,i){const l=t.slice();return l[35]=e[i],l[34]=i,l}function kt(t){let e,i,l,s,c,u,a,_;e=new ft({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),e.$on("click",t[24]),l=new pt({props:{$$slots:{default:[yt]},$$scope:{ctx:t}}}),l.$on("click",t[11]);const $=[Lt,It],r=[];function C(f,g){return f[0].kind=="critical"?0:1}return c=C(t),u=r[c]=$[c](t),{c(){G(e.$$.fragment),i=A(),G(l.$$.fragment),s=A(),u.c(),a=me()},l(f){M(e.$$.fragment,f),i=q(f),M(l.$$.fragment,f),s=q(f),u.l(f),a=me()},m(f,g){V(e,f,g),I(f,i,g),V(l,f,g),I(f,s,g),r[c].m(f,g),I(f,a,g),_=!0},p(f,g){const j={};g[1]&256&&(j.$$scope={dirty:g,ctx:f}),e.$set(j);const b={};g[1]&256&&(b.$$scope={dirty:g,ctx:f}),l.$set(b);let N=c;c=C(f),c===N?r[c].p(f,g):(fe(),S(r[N],1,1,()=>{r[N]=null}),ae(),u=r[c],u?u.p(f,g):(u=r[c]=$[c](f),u.c()),y(u,1),u.m(a.parentNode,a))},i(f){_||(y(e.$$.fragment,f),y(l.$$.fragment,f),y(u),_=!0)},o(f){S(e.$$.fragment,f),S(l.$$.fragment,f),S(u),_=!1},d(f){f&&(d(i),d(s),d(a)),R(e,f),R(l,f),r[c].d(f)}}}function Ct(t){let e,i,l,s,c,u,a="Click the map to add a problem, or select a problem to fill out data",_,$,r="Critical Issues",C,f,g,j="Policy Conflicts",b,N,o;e=new at({props:{label:"Tools",$$slots:{default:[Et]},$$scope:{ctx:t}}});function p(m){t[17](m)}let w={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[4]!==void 0&&(w.value=t[4]),l=new ut({props:w}),J.push(()=>Q(l,"value",p));let B=ne(t[2].criticalIssues),L=[];for(let m=0;m<B.length;m+=1)L[m]=Ae(je(t,B,m));const v=m=>S(L[m],1,1,()=>{L[m]=null});let T=ne(t[2].policyConflictLog),E=[];for(let m=0;m<T.length;m+=1)E[m]=qe(De(t,T,m));const ie=m=>S(E[m],1,1,()=>{E[m]=null});return{c(){G(e.$$.fragment),i=A(),G(l.$$.fragment),c=A(),u=z("p"),u.textContent=a,_=A(),$=z("h3"),$.textContent=r,C=A();for(let m=0;m<L.length;m+=1)L[m].c();f=A(),g=z("h3"),g.textContent=j,b=A();for(let m=0;m<E.length;m+=1)E[m].c();N=me()},l(m){M(e.$$.fragment,m),i=q(m),M(l.$$.fragment,m),c=q(m),u=H(m,"P",{"data-svelte-h":!0}),ve(u)!=="svelte-12ba5j2"&&(u.textContent=a),_=q(m),$=H(m,"H3",{"data-svelte-h":!0}),ve($)!=="svelte-1qhh5xr"&&($.textContent=r),C=q(m);for(let k=0;k<L.length;k+=1)L[k].l(m);f=q(m),g=H(m,"H3",{"data-svelte-h":!0}),ve(g)!=="svelte-eyxzjx"&&(g.textContent=j),b=q(m);for(let k=0;k<E.length;k+=1)E[k].l(m);N=me()},m(m,k){V(e,m,k),I(m,i,k),V(l,m,k),I(m,c,k),I(m,u,k),I(m,_,k),I(m,$,k),I(m,C,k);for(let O=0;O<L.length;O+=1)L[O]&&L[O].m(m,k);I(m,f,k),I(m,g,k),I(m,b,k);for(let O=0;O<E.length;O+=1)E[O]&&E[O].m(m,k);I(m,N,k),o=!0},p(m,k){const O={};k[0]&104|k[1]&256&&(O.$$scope={dirty:k,ctx:m}),e.$set(O);const le={};if(!s&&k[0]&16&&(s=!0,le.value=m[4],X(()=>s=!1)),l.$set(le),k[0]&518){B=ne(m[2].criticalIssues);let D;for(D=0;D<B.length;D+=1){const ee=je(m,B,D);L[D]?(L[D].p(ee,k),y(L[D],1)):(L[D]=Ae(ee),L[D].c(),y(L[D],1),L[D].m(f.parentNode,f))}for(fe(),D=B.length;D<L.length;D+=1)v(D);ae()}if(k[0]&518){T=ne(m[2].policyConflictLog);let D;for(D=0;D<T.length;D+=1){const ee=De(m,T,D);E[D]?(E[D].p(ee,k),y(E[D],1)):(E[D]=qe(ee),E[D].c(),y(E[D],1),E[D].m(N.parentNode,N))}for(fe(),D=T.length;D<E.length;D+=1)ie(D);ae()}},i(m){if(!o){y(e.$$.fragment,m),y(l.$$.fragment,m);for(let k=0;k<B.length;k+=1)y(L[k]);for(let k=0;k<T.length;k+=1)y(E[k]);o=!0}},o(m){S(e.$$.fragment,m),S(l.$$.fragment,m),L=L.filter(Boolean);for(let k=0;k<L.length;k+=1)S(L[k]);E=E.filter(Boolean);for(let k=0;k<E.length;k+=1)S(E[k]);o=!1},d(m){m&&(d(i),d(c),d(u),d(_),d($),d(C),d(f),d(g),d(b),d(N)),R(e,m),R(l,m),$e(L,m),$e(E,m)}}}function wt(t){let e;return{c(){e=W("Save")},l(i){e=Y(i,"Save")},m(i,l){I(i,e,l)},d(i){i&&d(e)}}}function yt(t){let e;return{c(){e=W("Delete")},l(i){e=Y(i,"Delete")},m(i,l){I(i,e,l)},d(i){i&&d(e)}}}function It(t){let e,i;return e=new vt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,s){V(e,l,s),i=!0},p(l,s){const c={};s[0]&1&&(c.idx=l[0].idx),e.$set(c)},i(l){i||(y(e.$$.fragment,l),i=!0)},o(l){S(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function Lt(t){let e,i;return e=new gt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,s){V(e,l,s),i=!0},p(l,s){const c={};s[0]&1&&(c.idx=l[0].idx),e.$set(c)},i(l){i||(y(e.$$.fragment,l),i=!0)},o(l){S(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function St(t){let e;return{c(){e=W("Zoom to fit")},l(i){e=Y(i,"Zoom to fit")},m(i,l){I(i,e,l)},d(i){i&&d(e)}}}function Nt(t){let e;return{c(){e=W("Show scheme context")},l(i){e=Y(i,"Show scheme context")},m(i,l){I(i,e,l)},d(i){i&&d(e)}}}function Et(t){let e,i,l,s,c,u,a,_,$,r,C,f;e=new ct({props:{$$slots:{default:[St]},$$scope:{ctx:t}}}),e.$on("click",t[14]),l=new nt({}),c=new it({});function g(o){t[15](o)}let j={map:t[3]};t[5]!==void 0&&(j.enabled=t[5]),a=new ot({props:j}),J.push(()=>Q(a,"enabled",g));function b(o){t[16](o)}let N={$$slots:{default:[Nt]},$$scope:{ctx:t}};return t[6]!==void 0&&(N.checked=t[6]),r=new st({props:N}),J.push(()=>Q(r,"checked",b)),{c(){G(e.$$.fragment),i=A(),G(l.$$.fragment),s=A(),G(c.$$.fragment),u=A(),G(a.$$.fragment),$=A(),G(r.$$.fragment)},l(o){M(e.$$.fragment,o),i=q(o),M(l.$$.fragment,o),s=q(o),M(c.$$.fragment,o),u=q(o),M(a.$$.fragment,o),$=q(o),M(r.$$.fragment,o)},m(o,p){V(e,o,p),I(o,i,p),V(l,o,p),I(o,s,p),V(c,o,p),I(o,u,p),V(a,o,p),I(o,$,p),V(r,o,p),f=!0},p(o,p){const w={};p[1]&256&&(w.$$scope={dirty:p,ctx:o}),e.$set(w);const B={};p[0]&8&&(B.map=o[3]),!_&&p[0]&32&&(_=!0,B.enabled=o[5],X(()=>_=!1)),a.$set(B);const L={};p[1]&256&&(L.$$scope={dirty:p,ctx:o}),!C&&p[0]&64&&(C=!0,L.checked=o[6],X(()=>C=!1)),r.$set(L)},i(o){f||(y(e.$$.fragment,o),y(l.$$.fragment,o),y(c.$$.fragment,o),y(a.$$.fragment,o),y(r.$$.fragment,o),f=!0)},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),S(c.$$.fragment,o),S(a.$$.fragment,o),S(r.$$.fragment,o),f=!1},d(o){o&&(d(i),d(s),d(u),d($)),R(e,o),R(l,o),R(c,o),R(a,o),R(r,o)}}}function Dt(t){let e,i,l,s=t[35].stage+"",c,u,a,_,$=t[35].resolved+"",r;return{c(){e=z("div"),i=z("span"),l=W("Stage: "),c=W(s),u=A(),a=z("span"),_=W("Resolved: "),r=W($),this.h()},l(C){e=H(C,"DIV",{style:!0});var f=K(e);i=H(f,"SPAN",{});var g=K(i);l=Y(g,"Stage: "),c=Y(g,s),g.forEach(d),u=q(f),a=H(f,"SPAN",{});var j=K(a);_=Y(j,"Resolved: "),r=Y(j,$),j.forEach(d),f.forEach(d),this.h()},h(){U(e,"width","100%"),U(e,"display","flex"),U(e,"justify-content","space-between")},m(C,f){I(C,e,f),P(e,i),P(i,l),P(i,c),P(e,u),P(e,a),P(a,_),P(a,r)},p(C,f){f[0]&4&&s!==(s=C[35].stage+"")&&re(c,s),f[0]&4&&$!==($=C[35].resolved+"")&&re(r,$)},d(C){C&&d(e)}}}function Ae(t){let e,i,l;function s(){return t[18](t[34])}function c(){return t[19](t[34])}return i=new Ue({props:{name:Ge(t[35]),$$slots:{default:[Dt]},$$scope:{ctx:t}}}),i.$on("click",s),i.$on("mouseenter",c),i.$on("mouseleave",t[20]),{c(){e=z("li"),G(i.$$.fragment)},l(u){e=H(u,"LI",{});var a=K(e);M(i.$$.fragment,a),a.forEach(d)},m(u,a){I(u,e,a),V(i,e,null),l=!0},p(u,a){t=u;const _={};a[0]&4&&(_.name=Ge(t[35])),a[0]&4|a[1]&256&&(_.$$scope={dirty:a,ctx:t}),i.$set(_)},i(u){l||(y(i.$$.fragment,u),l=!0)},o(u){S(i.$$.fragment,u),l=!1},d(u){u&&d(e),R(i)}}}function jt(t){let e,i,l,s=t[32].stage+"",c,u,a,_,$=t[32].resolved+"",r,C;return{c(){e=z("div"),i=z("span"),l=W("Stage: "),c=W(s),u=A(),a=z("span"),_=W("Resolved: "),r=W($),C=A(),this.h()},l(f){e=H(f,"DIV",{style:!0});var g=K(e);i=H(g,"SPAN",{});var j=K(i);l=Y(j,"Stage: "),c=Y(j,s),j.forEach(d),u=q(g),a=H(g,"SPAN",{});var b=K(a);_=Y(b,"Resolved: "),r=Y(b,$),b.forEach(d),g.forEach(d),C=q(f),this.h()},h(){U(e,"width","100%"),U(e,"display","flex"),U(e,"justify-content","space-between")},m(f,g){I(f,e,g),P(e,i),P(i,l),P(i,c),P(e,u),P(e,a),P(a,_),P(a,r),I(f,C,g)},p(f,g){g[0]&4&&s!==(s=f[32].stage+"")&&re(c,s),g[0]&4&&$!==($=f[32].resolved+"")&&re(r,$)},d(f){f&&(d(e),d(C))}}}function qe(t){let e,i;function l(){return t[21](t[34])}function s(){return t[22](t[34])}return e=new Ue({props:{name:Me(t[32]),$$slots:{default:[jt]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",s),e.$on("mouseleave",t[23]),{c(){G(e.$$.fragment)},l(c){M(e.$$.fragment,c)},m(c,u){V(e,c,u),i=!0},p(c,u){t=c;const a={};u[0]&4&&(a.name=Me(t[32])),u[0]&4|u[1]&256&&(a.$$scope={dirty:u,ctx:t}),e.$set(a)},i(c){i||(y(e.$$.fragment,c),i=!0)},o(c){S(e.$$.fragment,c),i=!1},d(c){R(e,c)}}}function At(t){let e,i,l,s=t[35].criticalIssue+"",c;return{c(){e=be("svg"),i=be("polygon"),l=be("text"),c=W(s),this.h()},l(u){e=ke(u,"svg",{width:!0,height:!0,xmlns:!0});var a=K(e);i=ke(a,"polygon",{points:!0,fill:!0,class:!0}),K(i).forEach(d),l=ke(a,"text",{x:!0,y:!0});var _=K(l);c=Y(_,s),_.forEach(d),a.forEach(d),this.h()},h(){F(i,"points","20,0 0,40 40,40"),F(i,"fill",xe.critical.background),F(i,"class","svelte-ktyu3j"),F(l,"x","13"),F(l,"y","30"),U(l,"fill","white"),F(e,"width","40"),F(e,"height","40"),F(e,"xmlns","http://www.w3.org/2000/svg")},m(u,a){I(u,e,a),P(e,i),P(e,l),P(l,c)},p(u,a){a[0]&4&&s!==(s=u[35].criticalIssue+"")&&re(c,s)},d(u){u&&d(e)}}}function Be(t){let e,i,l;function s(_){t[25](_,t[35])}function c(){return t[26](t[34])}function u(){return t[27](t[34])}let a={draggable:!0,$$slots:{default:[At]},$$scope:{ctx:t}};return t[35].point!==void 0&&(a.lngLat=t[35].point),e=new Oe({props:a}),J.push(()=>Q(e,"lngLat",s)),e.$on("click",c),e.$on("dragend",u),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,$){V(e,_,$),l=!0},p(_,$){t=_;const r={};$[0]&4|$[1]&256&&(r.$$scope={dirty:$,ctx:t}),!i&&$[0]&4&&(i=!0,r.lngLat=t[35].point,X(()=>i=!1)),e.$set(r)},i(_){l||(y(e.$$.fragment,_),l=!0)},o(_){S(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function qt(t){let e,i=t[32].conflict+"",l;return{c(){e=z("span"),l=W(i),this.h()},l(s){e=H(s,"SPAN",{class:!0});var c=K(e);l=Y(c,i),c.forEach(d),this.h()},h(){F(e,"class","dot svelte-ktyu3j"),U(e,"background",et)},m(s,c){I(s,e,c),P(e,l)},p(s,c){c[0]&4&&i!==(i=s[32].conflict+"")&&re(l,i)},d(s){s&&d(e)}}}function Pe(t){let e,i,l;function s(_){t[28](_,t[32])}function c(){return t[29](t[34])}function u(){return t[30](t[34])}let a={draggable:!0,$$slots:{default:[qt]},$$scope:{ctx:t}};return t[32].point!==void 0&&(a.lngLat=t[32].point),e=new Oe({props:a}),J.push(()=>Q(e,"lngLat",s)),e.$on("click",c),e.$on("dragend",u),{c(){G(e.$$.fragment)},l(_){M(e.$$.fragment,_)},m(_,$){V(e,_,$),l=!0},p(_,$){t=_;const r={};$[0]&4|$[1]&256&&(r.$$scope={dirty:$,ctx:t}),!i&&$[0]&4&&(i=!0,r.lngLat=t[32].point,X(()=>i=!1)),e.$set(r)},i(_){l||(y(e.$$.fragment,_),l=!0)},o(_){S(e.$$.fragment,_),l=!1},d(_){R(e,_)}}}function Bt(t){let e,i;return e=new Qe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,s){V(e,l,s),i=!0},p:Ke,i(l){i||(y(e.$$.fragment,l),i=!0)},o(l){S(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function Pt(t){let e,i,l,s,c,u,a,_,$,r;e=new rt({}),e.$on("click",t[10]),l=new Je({props:{gj:t[2].summary.networkMap,show:t[6]}});let C=ne(t[2].criticalIssues),f=[];for(let o=0;o<C.length;o+=1)f[o]=Be(Ee(t,C,o));const g=o=>S(f[o],1,1,()=>{f[o]=null});let j=ne(t[2].policyConflictLog),b=[];for(let o=0;o<j.length;o+=1)b[o]=Pe(Ne(t,j,o));const N=o=>S(b[o],1,1,()=>{b[o]=null});return a=new Xe({props:{data:t[7],$$slots:{default:[Bt]},$$scope:{ctx:t}}}),$=new _t({props:{map:t[3]}}),{c(){G(e.$$.fragment),i=A(),G(l.$$.fragment),s=A();for(let o=0;o<f.length;o+=1)f[o].c();c=A();for(let o=0;o<b.length;o+=1)b[o].c();u=A(),G(a.$$.fragment),_=A(),G($.$$.fragment)},l(o){M(e.$$.fragment,o),i=q(o),M(l.$$.fragment,o),s=q(o);for(let p=0;p<f.length;p+=1)f[p].l(o);c=q(o);for(let p=0;p<b.length;p+=1)b[p].l(o);u=q(o),M(a.$$.fragment,o),_=q(o),M($.$$.fragment,o)},m(o,p){V(e,o,p),I(o,i,p),V(l,o,p),I(o,s,p);for(let w=0;w<f.length;w+=1)f[w]&&f[w].m(o,p);I(o,c,p);for(let w=0;w<b.length;w+=1)b[w]&&b[w].m(o,p);I(o,u,p),V(a,o,p),I(o,_,p),V($,o,p),r=!0},p(o,p){const w={};if(p[0]&4&&(w.gj=o[2].summary.networkMap),p[0]&64&&(w.show=o[6]),l.$set(w),p[0]&260){C=ne(o[2].criticalIssues);let v;for(v=0;v<C.length;v+=1){const T=Ee(o,C,v);f[v]?(f[v].p(T,p),y(f[v],1)):(f[v]=Be(T),f[v].c(),y(f[v],1),f[v].m(c.parentNode,c))}for(fe(),v=C.length;v<f.length;v+=1)g(v);ae()}if(p[0]&260){j=ne(o[2].policyConflictLog);let v;for(v=0;v<j.length;v+=1){const T=Ne(o,j,v);b[v]?(b[v].p(T,p),y(b[v],1)):(b[v]=Pe(T),b[v].c(),y(b[v],1),b[v].m(u.parentNode,u))}for(fe(),v=j.length;v<b.length;v+=1)N(v);ae()}const B={};p[0]&128&&(B.data=o[7]),p[1]&256&&(B.$$scope={dirty:p,ctx:o}),a.$set(B);const L={};p[0]&8&&(L.map=o[3]),$.$set(L)},i(o){if(!r){y(e.$$.fragment,o),y(l.$$.fragment,o);for(let p=0;p<C.length;p+=1)y(f[p]);for(let p=0;p<j.length;p+=1)y(b[p]);y(a.$$.fragment,o),y($.$$.fragment,o),r=!0}},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)S(f[p]);b=b.filter(Boolean);for(let p=0;p<b.length;p+=1)S(b[p]);S(a.$$.fragment,o),S($.$$.fragment,o),r=!1},d(o){o&&(d(i),d(s),d(c),d(u),d(_)),R(e,o),R(l,o),$e(f,o),$e(b,o),R(a,o),R($,o)}}}function Gt(t){let e,i,l,s,c,u,a,_,$,r,C;const f=[Ct,kt],g=[];function j(o,p){return o[0]==null?0:1}l=j(t),s=g[l]=f[l](t);function b(o){t[31](o)}let N={$$slots:{default:[Pt]},$$scope:{ctx:t}};return t[3]!==void 0&&(N.map=t[3]),a=new Ze({props:N}),J.push(()=>Q(a,"map",b)),{c(){e=z("div"),i=z("div"),s.c(),c=A(),u=z("div"),G(a.$$.fragment),this.h()},l(o){e=H(o,"DIV",{style:!0});var p=K(e);i=H(p,"DIV",{style:!0});var w=K(i);s.l(w),w.forEach(d),c=q(p),u=H(p,"DIV",{style:!0});var B=K(u);M(a.$$.fragment,B),B.forEach(d),p.forEach(d),this.h()},h(){U(i,"width","30%"),U(i,"overflow-y","scroll"),U(i,"padding","10px"),U(i,"border","1px solid black"),U(u,"position","relative"),U(u,"width","70%"),U(e,"display","flex"),U(e,"height","80vh")},m(o,p){I(o,e,p),P(e,i),g[l].m(i,null),P(e,c),P(e,u),V(a,u,null),$=!0,r||(C=ze(bt,"keydown",t[13]),r=!0)},p(o,p){let w=l;l=j(o),l===w?g[l].p(o,p):(fe(),S(g[w],1,1,()=>{g[w]=null}),ae(),s=g[l],s?s.p(o,p):(s=g[l]=f[l](o),s.c()),y(s,1),s.m(i,null));const B={};p[0]&204|p[1]&256&&(B.$$scope={dirty:p,ctx:o}),!_&&p[0]&8&&(_=!0,B.map=o[3],X(()=>_=!1)),a.$set(B)},i(o){$||(y(s),y(a.$$.fragment,o),$=!0)},o(o){S(s),S(a.$$.fragment,o),$=!1},d(o){o&&d(e),g[l].d(),R(a),r=!1,C()}}}function Mt(t,e,i){let l={type:"FeatureCollection",features:[]},s=e??i;if(s!=null){let c=s.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(Ce(c[s.idx].point))}return l}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Ge(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Me(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function Vt(t,e,i){let l,s;ye(t,Z,n=>i(2,s=n));let c,u="critical",a=null,_=null,$=!1,r=!0;function C(n){i(0,a=n),i(1,_=null)}function f(n){i(0,a=n),i(1,_=null);let h=n.kind=="critical"?s.criticalIssues:s.policyConflictLog;c.flyTo({center:h[n.idx].point,duration:500})}function g(n){if(!$){if(a!=null){i(0,a=null);return}u=="critical"?(Se(Z,s.criticalIssues=[...s.criticalIssues,{criticalIssue:"",stage:"",point:n.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),C({kind:"critical",idx:s.criticalIssues.length-1})):(Se(Z,s.policyConflictLog=[...s.policyConflictLog,{conflict:"",stage:"",point:n.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),C({kind:"conflict",idx:s.policyConflictLog.length-1}))}}He(()=>{b(!1)});function j(){window.confirm("Delete this entry?")&&(a.kind=="critical"?(s.criticalIssues.splice(a.idx,1),Z.set(s)):(s.policyConflictLog.splice(a.idx,1),Z.set(s)),i(0,a=null))}function b(n){let h={type:"FeatureCollection",features:[...s.criticalIssues.map(x=>Ce(x.point)),...s.policyConflictLog.map(x=>Ce(x.point)),...s.summary.networkMap.features]};h.features.length>0&&c.fitBounds(Ye(h),{padding:20,animate:n})}function N(n){if(a!=null&&n.key=="Escape")n.stopPropagation(),i(0,a=null);else if(a!=null&&n.key=="Delete"){let h=n.target.tagName;if(h=="INPUT"||h=="TEXTAREA")return;n.stopPropagation(),j()}}const o=()=>b(!0);function p(n){$=n,i(5,$)}function w(n){r=n,i(6,r)}function B(n){u=n,i(4,u)}const L=n=>f({kind:"critical",idx:n}),v=n=>i(1,_={kind:"critical",idx:n}),T=()=>i(1,_=null),E=n=>f({kind:"conflict",idx:n}),ie=n=>i(1,_={kind:"conflict",idx:n}),m=()=>i(1,_=null),k=()=>i(0,a=null);function O(n,h){t.$$.not_equal(h.point,n)&&(h.point=n,Z.set(s))}const le=n=>C({kind:"critical",idx:n}),D=n=>C({kind:"critical",idx:n});function ee(n,h){t.$$.not_equal(h.point,n)&&(h.point=n,Z.set(s))}const oe=n=>C({kind:"conflict",idx:n}),ue=n=>C({kind:"conflict",idx:n});function se(n){c=n,i(3,c)}return t.$$.update=()=>{t.$$.dirty[0]&7&&i(7,l=Mt(s,a,_))},[a,_,s,c,u,$,r,l,C,f,g,j,b,N,o,p,w,B,L,v,T,E,ie,m,k,O,le,D,ee,oe,ue,se]}class al extends Ie{constructor(e){super(),Le(this,e,Vt,Gt,we,{},null,[-1,-1])}}export{al as component};
