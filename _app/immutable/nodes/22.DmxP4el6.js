var pn=Object.defineProperty;var bn=(r,e,t)=>e in r?pn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $=(r,e,t)=>(bn(r,typeof e!="symbol"?e+"":e,t),t);import{s as Le,v as Q,x as j,l as Je,u as Ue,m as Ze,o as Ke,H as V,ad as _n,ae as wn,E as ye,i as H,f as Y,a7 as Mn,k as de,a9 as ht,N as Ge,n as Re,W as Sn,D as Ln,a as Z,g as K,e as Oe,c as De,b as yt,w as it,p as Pt,h as W,t as Me,d as Se,j as Fr,r as Pn}from"../chunks/scheduler.BV_JqZpr.js";import{S as ze,i as Be,e as x,c as R,a as O,m as D,t as T,b as B,d as q,g as Ve,f as We}from"../chunks/index.DDJL-Wug.js";import{p as et}from"../chunks/index.C2VrFbbB.js";import{S as tt}from"../chunks/Select.C1vp33wH.js";import{T as ct}from"../chunks/TextArea.e-LUVmrn.js";import{T as mt}from"../chunks/TextInput.Daolq3gG.js";import{s as ee}from"../chunks/data.CfrvZXzO.js";import{D as kn}from"../chunks/DefaultButton.DCHkaEOp.js";import{S as Mt,W as En}from"../chunks/WarningButton.Ck9VEuu1.js";import{L as Cn,a as Fn,f as Tn,j as An,c as kt,M as zn,G as Bn}from"../chunks/MapLibreMap.Dv9o_FLb.js";import{c as In,a as At,g as Rn}from"../chunks/_commonjsHelpers.BosuxZz1.js";import{w as ot}from"../chunks/entry.CUGOHFlb.js";import{a as On,t as Dn,r as qn,f as Xn,d as Nn}from"../chunks/lists.Ci0sBo6t.js";import{D as Yn}from"../chunks/DecimalInput.DBcoappO.js";function Gn(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Hn(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[Gn]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Cn({props:o}),Q.push(()=>x(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){R(e.$$.fragment)},l(a){O(e.$$.fragment,a)},m(a,l){D(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],j(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function Jn(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=Fn("fill")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:v}=e,{layout:h=void 0}=e,{filter:P=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:C=!1}=e,{hovered:k=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){k=f,t(0,k)}function y(f){V.call(this,r,f)}function S(f){V.call(this,r,f)}function b(f){V.call(this,r,f)}function L(f){V.call(this,r,f)}function A(f){V.call(this,r,f)}function F(f){V.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,m=f.beforeLayerType),"paint"in f&&t(6,v=f.paint),"layout"in f&&t(7,h=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,p=f.minzoom),"maxzoom"in f&&t(10,g=f.maxzoom),"hoverCursor"in f&&t(11,E=f.hoverCursor),"manageHoverState"in f&&t(12,C=f.manageHoverState),"hovered"in f&&t(0,k=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[k,o,a,l,s,m,v,h,P,p,g,E,C,u,c,n,d,y,S,b,L,A,F,i]}let Un=class extends ze{constructor(e){super(),Be(this,e,Jn,Hn,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}};var Zn=Object.defineProperty,G=(r,e)=>Zn(r,"name",{value:e,configurable:!0}),Kn=class{constructor(e){this.direction=!1,this.compareProperties=!0;var t,n,i;this.precision=10**-((t=e==null?void 0:e.precision)!=null?t:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(i=e==null?void 0:e.compareProperties)!=null?i:!0}compare(e,t){if(e.type!==t.type||!nt(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates);case"Polygon":return this.comparePolygon(e,t);case"GeometryCollection":return this.compareGeometryCollection(e,t);case"Feature":return this.compareFeature(e,t);case"FeatureCollection":return this.compareFeatureCollection(e,t);default:if(e.type.startsWith("Multi")){const n=Et(e),i=Et(t);return n.every(o=>i.some(a=>this.compare(o,a)))}}return!1}compareCoord(e,t){return e.length===t.length&&e.every((n,i)=>Math.abs(n-t[i])<this.precision)}compareLine(e,t,n=0,i=!1){if(!nt(e,t))return!1;const o=e;let a=t;if(i&&!this.compareCoord(o[0],a[0])){const s=this.fixStartIndex(a,o);if(s)a=s;else return!1}const l=this.compareCoord(o[n],a[n]);return this.direction||l?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}fixStartIndex(e,t){let n,i=-1;for(let o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){i=o;break}return i>=0&&(n=[].concat(e.slice(i,e.length),e.slice(1,i+1))),n}comparePath(e,t){return e.every((n,i)=>this.compareCoord(n,t[i]))}comparePolygon(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),i=t.coordinates.slice(1,t.coordinates.length);return n.every(o=>i.some(a=>this.compareLine(o,a,1,!0)))}return!1}compareGeometryCollection(e,t){return nt(e.geometries,t.geometries)&&this.compareBBox(e,t)&&e.geometries.every((n,i)=>this.compare(n,t.geometries[i]))}compareFeature(e,t){return e.id===t.id&&(this.compareProperties?Tn(e.properties,t.properties):!0)&&this.compareBBox(e,t)&&this.compare(e.geometry,t.geometry)}compareFeatureCollection(e,t){return nt(e.features,t.features)&&this.compareBBox(e,t)&&e.features.every((n,i)=>this.compare(n,t.features[i]))}compareBBox(e,t){return!e.bbox&&!t.bbox||(e.bbox&&t.bbox?this.compareCoord(e.bbox,t.bbox):!1)}};G(Kn,"GeojsonEquality");function nt(r,e){return r.coordinates?r.coordinates.length===e.coordinates.length:r.length===e.length}G(nt,"sameLength");function Et(r){return r.coordinates.map(e=>({type:r.type.replace("Multi",""),coordinates:e}))}G(Et,"explode");var ae=63710088e-1,Tr={centimeters:ae*100,centimetres:ae*100,degrees:360/(2*Math.PI),feet:ae*3.28084,inches:ae*39.37,kilometers:ae/1e3,kilometres:ae/1e3,meters:ae,metres:ae,miles:ae/1609.344,millimeters:ae*1e3,millimetres:ae*1e3,nauticalmiles:ae/1852,radians:1,yards:ae*1.0936},vr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Ce(r,e,t={}){const n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}G(Ce,"feature");function Vn(r,e,t={}){switch(r){case"Point":return Te(e).geometry;case"LineString":return Ae(e).geometry;case"Polygon":return zt(e).geometry;case"MultiPoint":return zr(e).geometry;case"MultiLineString":return Ar(e).geometry;case"MultiPolygon":return Br(e).geometry;default:throw new Error(r+" is invalid")}}G(Vn,"geometry");function Te(r,e,t={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!dt(r[0])||!dt(r[1]))throw new Error("coordinates must contain numbers");return Ce({type:"Point",coordinates:r},e,t)}G(Te,"point");function Wn(r,e,t={}){return pt(r.map(n=>Te(n,e)),t)}G(Wn,"points");function zt(r,e,t={}){for(const i of r){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return Ce({type:"Polygon",coordinates:r},e,t)}G(zt,"polygon");function Qn(r,e,t={}){return pt(r.map(n=>zt(n,e)),t)}G(Qn,"polygons");function Ae(r,e,t={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return Ce({type:"LineString",coordinates:r},e,t)}G(Ae,"lineString");function jn(r,e,t={}){return pt(r.map(n=>Ae(n,e)),t)}G(jn,"lineStrings");function pt(r,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}G(pt,"featureCollection");function Ar(r,e,t={}){return Ce({type:"MultiLineString",coordinates:r},e,t)}G(Ar,"multiLineString");function zr(r,e,t={}){return Ce({type:"MultiPoint",coordinates:r},e,t)}G(zr,"multiPoint");function Br(r,e,t={}){return Ce({type:"MultiPolygon",coordinates:r},e,t)}G(Br,"multiPolygon");function xn(r,e,t={}){return Ce({type:"GeometryCollection",geometries:r},e,t)}G(xn,"geometryCollection");function $n(r,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const t=Math.pow(10,e||0);return Math.round(r*t)/t}G($n,"round");function Ir(r,e="kilometers"){const t=Tr[e];if(!t)throw new Error(e+" units is invalid");return r*t}G(Ir,"radiansToLength");function Bt(r,e="kilometers"){const t=Tr[e];if(!t)throw new Error(e+" units is invalid");return r/t}G(Bt,"lengthToRadians");function ei(r,e){return Rr(Bt(r,e))}G(ei,"lengthToDegrees");function ti(r){let e=r%360;return e<0&&(e+=360),e}G(ti,"bearingToAzimuth");function Rr(r){return r%(2*Math.PI)*180/Math.PI}G(Rr,"radiansToDegrees");function ri(r){return r%360*Math.PI/180}G(ri,"degreesToRadians");function ni(r,e="kilometers",t="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return Ir(Bt(r,e),t)}G(ni,"convertLength");function ii(r,e="meters",t="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const n=vr[e];if(!n)throw new Error("invalid original units");const i=vr[t];if(!i)throw new Error("invalid final units");return r/n*i}G(ii,"convertArea");function dt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}G(dt,"isNumber");function It(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}G(It,"isObject");function oi(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(e=>{if(!dt(e))throw new Error("bbox must only contain numbers")})}G(oi,"validateBBox");function ai(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}G(ai,"validateId");var li=Object.defineProperty,re=(r,e)=>li(r,"name",{value:e,configurable:!0});function st(r,e,t){if(r!==null)for(var n,i,o,a,l,s,m,v=0,h=0,P,p=r.type,g=p==="FeatureCollection",E=p==="Feature",C=g?r.features.length:1,k=0;k<C;k++){m=g?r.features[k].geometry:E?r.geometry:r,P=m?m.type==="GeometryCollection":!1,l=P?m.geometries.length:1;for(var u=0;u<l;u++){var c=0,d=0;if(a=P?m.geometries[u]:m,a!==null){s=a.coordinates;var y=a.type;switch(v=t&&(y==="Polygon"||y==="MultiPolygon")?1:0,y){case null:break;case"Point":if(e(s,h,k,c,d)===!1)return!1;h++,c++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(e(s[n],h,k,c,d)===!1)return!1;h++,y==="MultiPoint"&&c++}y==="LineString"&&c++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-v;i++){if(e(s[n][i],h,k,c,d)===!1)return!1;h++}y==="MultiLineString"&&c++,y==="Polygon"&&d++}y==="Polygon"&&c++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(d=0,i=0;i<s[n].length;i++){for(o=0;o<s[n][i].length-v;o++){if(e(s[n][i][o],h,k,c,d)===!1)return!1;h++}d++}c++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(st(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}re(st,"coordEach");function si(r,e,t,n){var i=t;return st(r,function(o,a,l,s,m){a===0&&t===void 0?i=o:i=e(i,o,a,l,s,m)},n),i}re(si,"coordReduce");function Or(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}re(Or,"propEach");function ui(r,e,t){var n=t;return Or(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}re(ui,"propReduce");function Dr(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}re(Dr,"featureEach");function fi(r,e,t){var n=t;return Dr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}re(fi,"featureReduce");function ci(r){var e=[];return st(r,function(t){e.push(t)}),e}re(ci,"coordAll");function Rt(r,e){var t,n,i,o,a,l,s,m,v,h,P=0,p=r.type==="FeatureCollection",g=r.type==="Feature",E=p?r.features.length:1;for(t=0;t<E;t++){for(l=p?r.features[t].geometry:g?r.geometry:r,m=p?r.features[t].properties:g?r.properties:{},v=p?r.features[t].bbox:g?r.bbox:void 0,h=p?r.features[t].id:g?r.id:void 0,s=l?l.type==="GeometryCollection":!1,a=s?l.geometries.length:1,i=0;i<a;i++){if(o=s?l.geometries[i]:l,o===null){if(e(null,P,m,v,h)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,P,m,v,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],P,m,v,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}re(Rt,"geomEach");function qr(r,e,t){var n=t;return Rt(r,function(i,o,a,l,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,l,s)}),n}re(qr,"geomReduce");function bt(r,e){Rt(r,function(t,n,i,o,a){var l=t===null?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(Ce(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var s;switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var v=t.coordinates[m],h={type:s,coordinates:v};if(e(Ce(h,i),n,m)===!1)return!1}})}re(bt,"flattenEach");function mi(r,e,t){var n=t;return bt(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}re(mi,"flattenReduce");function Xr(r,e){bt(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var l,s=0,m=0,v=0;if(st(t,function(h,P,p,g,E){if(l===void 0||n>s||g>m||E>v){l=h,s=n,m=g,v=E,o=0;return}var C=Ae([l,h],t.properties);if(e(C,n,i,E,o)===!1)return!1;o++,l=h})===!1)return!1}}})}re(Xr,"segmentEach");function hi(r,e,t){var n=t,i=!1;return Xr(r,function(o,a,l,s,m){i===!1&&t===void 0?n=o:n=e(n,o,a,l,s,m),i=!0}),n}re(hi,"segmentReduce");function Nr(r,e){if(!r)throw new Error("geojson is required");bt(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(e(Ae(a[l],t.properties),n,i,l)===!1)return!1;break}}})}re(Nr,"lineEach");function di(r,e,t){var n=t;return Nr(r,function(i,o,a,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,l)}),n}re(di,"lineReduce");function vi(r,e){if(e=e||{},!It(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=s.length+o-1),Ae([s[o],s[o+1]],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o-1),Ae([s[i][o],s[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o-1),Ae([s[n][o],s[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o-1),Ae([s[n][i][o],s[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}re(vi,"findSegment");function gi(r,e){if(e=e||{},!It(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":return Te(s,a,e);case"MultiPoint":return n<0&&(n=s.length+n),Te(s[n],a,e);case"LineString":return o<0&&(o=s.length+o),Te(s[o],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o),Te(s[i][o],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o),Te(s[n][o],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o),Te(s[n][i][o],a,e)}throw new Error("geojson is invalid")}re(gi,"findPoint");var yi=Object.defineProperty,_t=(r,e)=>yi(r,"name",{value:e,configurable:!0});function Yr(r){return qr(r,(e,t)=>e+Gr(t),0)}_t(Yr,"area");function Gr(r){let e=0,t;switch(r.type){case"Polygon":return Ct(r.coordinates);case"MultiPolygon":for(t=0;t<r.coordinates.length;t++)e+=Ct(r.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}_t(Gr,"calculateArea");function Ct(r){let e=0;if(r&&r.length>0){e+=Math.abs(Ft(r[0]));for(let t=1;t<r.length;t++)e-=Math.abs(Ft(r[t]))}return e}_t(Ct,"polygonArea");var pi=ae*ae/2,St=Math.PI/180;function Ft(r){const e=r.length;if(e<=2)return 0;let t=0,n=0;for(;n<e;){const i=r[n],o=r[n+1===e?0:n+1],a=r[n+2>=e?(n+2)%e:n+2],l=i[0]*St,s=o[1]*St,m=a[0]*St;t+=(m-l)*Math.sin(s),n++}return t*pi}_t(Ft,"ringArea");var gr=Yr,ie=63710088e-1,Ot={centimeters:ie*100,centimetres:ie*100,degrees:ie/111325,feet:ie*3.28084,inches:ie*39.37,kilometers:ie/1e3,kilometres:ie/1e3,meters:ie,metres:ie,miles:ie/1609.344,millimeters:ie*1e3,millimetres:ie*1e3,nauticalmiles:ie/1852,radians:1,yards:ie*1.0936},bi={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ie,yards:1.0936133},Tt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function pe(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function _i(r,e,t){switch(r){case"Point":return ue(e).geometry;case"LineString":return ve(e).geometry;case"Polygon":return Dt(e).geometry;case"MultiPoint":return Jr(e).geometry;case"MultiLineString":return Hr(e).geometry;case"MultiPolygon":return Ur(e).geometry;default:throw new Error(r+" is invalid")}}function ue(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!vt(r[0])||!vt(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return pe(n,e,t)}function wi(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return ue(n,e)}),t)}function Dt(r,e,t){t===void 0&&(t={});for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:r};return pe(l,e,t)}function Mi(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return Dt(n,e)}),t)}function ve(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return pe(n,e,t)}function Si(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return ve(n,e)}),t)}function qe(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function Hr(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return pe(n,e,t)}function Jr(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return pe(n,e,t)}function Ur(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return pe(n,e,t)}function Li(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return pe(n,e,t)}function Pi(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function qt(r,e){e===void 0&&(e="kilometers");var t=Ot[e];if(!t)throw new Error(e+" units is invalid");return r*t}function wt(r,e){e===void 0&&(e="kilometers");var t=Ot[e];if(!t)throw new Error(e+" units is invalid");return r/t}function ki(r,e){return at(wt(r,e))}function Ei(r){var e=r%360;return e<0&&(e+=360),e}function at(r){var e=r%(2*Math.PI);return e*180/Math.PI}function ge(r){var e=r%360;return e*Math.PI/180}function Ci(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return qt(wt(r,e),t)}function Fi(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=Tt[e];if(!n)throw new Error("invalid original units");var i=Tt[t];if(!i)throw new Error("invalid final units");return r/n*i}function vt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function Xt(r){return!!r&&r.constructor===Object}function Ti(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!vt(e))throw new Error("bbox must only contain numbers")})}function Ai(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const zi=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Tt,bearingToAzimuth:Ei,convertArea:Fi,convertLength:Ci,degreesToRadians:ge,earthRadius:ie,factors:Ot,feature:pe,featureCollection:qe,geometry:_i,geometryCollection:Li,isNumber:vt,isObject:Xt,lengthToDegrees:ki,lengthToRadians:wt,lineString:ve,lineStrings:Si,multiLineString:Hr,multiPoint:Jr,multiPolygon:Ur,point:ue,points:wi,polygon:Dt,polygons:Mi,radiansToDegrees:at,radiansToLength:qt,round:Pi,unitsFactors:bi,validateBBox:Ti,validateId:Ai},Symbol.toStringTag,{value:"Module"}));function lt(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Zr(r,e,t){if(t===void 0&&(t={}),t.final===!0)return Bi(r,e);var n=lt(r),i=lt(e),o=ge(n[0]),a=ge(i[0]),l=ge(n[1]),s=ge(i[1]),m=Math.sin(a-o)*Math.cos(s),v=Math.cos(l)*Math.sin(s)-Math.sin(l)*Math.cos(s)*Math.cos(a-o);return at(Math.atan2(m,v))}function Bi(r,e){var t=Zr(e,r);return t=(t+180)%360,t}function rt(r,e,t){t===void 0&&(t={});var n=lt(r),i=lt(e),o=ge(i[1]-n[1]),a=ge(i[0]-n[0]),l=ge(n[1]),s=ge(i[1]),m=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(s);return qt(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t.units)}function yr(r,e,t,n){n===void 0&&(n={});var i=lt(r),o=ge(i[0]),a=ge(i[1]),l=ge(t),s=wt(e,n.units),m=Math.asin(Math.sin(a)*Math.cos(s)+Math.cos(a)*Math.sin(s)*Math.cos(l)),v=o+Math.atan2(Math.sin(l)*Math.sin(s)*Math.cos(a),Math.cos(s)-Math.sin(a)*Math.sin(m)),h=at(v),P=at(m);return ue([h,P],n.properties)}function ut(r,e,t){if(r!==null)for(var n,i,o,a,l,s,m,v=0,h=0,P,p=r.type,g=p==="FeatureCollection",E=p==="Feature",C=g?r.features.length:1,k=0;k<C;k++){m=g?r.features[k].geometry:E?r.geometry:r,P=m?m.type==="GeometryCollection":!1,l=P?m.geometries.length:1;for(var u=0;u<l;u++){var c=0,d=0;if(a=P?m.geometries[u]:m,a!==null){s=a.coordinates;var y=a.type;switch(v=t&&(y==="Polygon"||y==="MultiPolygon")?1:0,y){case null:break;case"Point":if(e(s,h,k,c,d)===!1)return!1;h++,c++;break;case"LineString":case"MultiPoint":for(n=0;n<s.length;n++){if(e(s[n],h,k,c,d)===!1)return!1;h++,y==="MultiPoint"&&c++}y==="LineString"&&c++;break;case"Polygon":case"MultiLineString":for(n=0;n<s.length;n++){for(i=0;i<s[n].length-v;i++){if(e(s[n][i],h,k,c,d)===!1)return!1;h++}y==="MultiLineString"&&c++,y==="Polygon"&&d++}y==="Polygon"&&c++;break;case"MultiPolygon":for(n=0;n<s.length;n++){for(d=0,i=0;i<s[n].length;i++){for(o=0;o<s[n][i].length-v;o++){if(e(s[n][i][o],h,k,c,d)===!1)return!1;h++}d++}c++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(ut(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ii(r,e,t,n){var i=t;return ut(r,function(o,a,l,s,m){a===0&&t===void 0?i=o:i=e(i,o,a,l,s,m)},n),i}function Kr(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function Ri(r,e,t){var n=t;return Kr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function gt(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Oi(r,e,t){var n=t;return gt(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Di(r){var e=[];return ut(r,function(t){e.push(t)}),e}function Nt(r,e){var t,n,i,o,a,l,s,m,v,h,P=0,p=r.type==="FeatureCollection",g=r.type==="Feature",E=p?r.features.length:1;for(t=0;t<E;t++){for(l=p?r.features[t].geometry:g?r.geometry:r,m=p?r.features[t].properties:g?r.properties:{},v=p?r.features[t].bbox:g?r.bbox:void 0,h=p?r.features[t].id:g?r.id:void 0,s=l?l.type==="GeometryCollection":!1,a=s?l.geometries.length:1,i=0;i<a;i++){if(o=s?l.geometries[i]:l,o===null){if(e(null,P,m,v,h)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,P,m,v,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],P,m,v,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function qi(r,e,t){var n=t;return Nt(r,function(i,o,a,l,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,l,s)}),n}function Qe(r,e){Nt(r,function(t,n,i,o,a){var l=t===null?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(pe(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var s;switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var v=t.coordinates[m],h={type:s,coordinates:v};if(e(pe(h,i),n,m)===!1)return!1}})}function Xi(r,e,t){var n=t;return Qe(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}function Vr(r,e){Qe(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var l,s=0,m=0,v=0;if(ut(t,function(h,P,p,g,E){if(l===void 0||n>s||g>m||E>v){l=h,s=n,m=g,v=E,o=0;return}var C=ve([l,h],t.properties);if(e(C,n,i,E,o)===!1)return!1;o++,l=h})===!1)return!1}}})}function Ni(r,e,t){var n=t,i=!1;return Vr(r,function(o,a,l,s,m){i===!1&&t===void 0?n=o:n=e(n,o,a,l,s,m),i=!0}),n}function Wr(r,e){if(!r)throw new Error("geojson is required");Qe(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(e(ve(a[l],t.properties),n,i,l)===!1)return!1;break}}})}function Yi(r,e,t){var n=t;return Wr(r,function(i,o,a,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,l)}),n}function Gi(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=s.length+o-1),ve([s[o],s[o+1]],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o-1),ve([s[i][o],s[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o-1),ve([s[n][o],s[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o-1),ve([s[n][i][o],s[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}function Hi(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,l;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,l=r.features[t].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var s=l.coordinates;switch(l.type){case"Point":return ue(s,a,e);case"MultiPoint":return n<0&&(n=s.length+n),ue(s[n],a,e);case"LineString":return o<0&&(o=s.length+o),ue(s[o],a,e);case"Polygon":return i<0&&(i=s.length+i),o<0&&(o=s[i].length+o),ue(s[i][o],a,e);case"MultiLineString":return n<0&&(n=s.length+n),o<0&&(o=s[n].length+o),ue(s[n][o],a,e);case"MultiPolygon":return n<0&&(n=s.length+n),i<0&&(i=s[n].length+i),o<0&&(o=s[n][i].length-o),ue(s[n][i][o],a,e)}throw new Error("geojson is invalid")}const Ji=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Di,coordEach:ut,coordReduce:Ii,featureEach:gt,featureReduce:Oi,findPoint:Hi,findSegment:Gi,flattenEach:Qe,flattenReduce:Xi,geomEach:Nt,geomReduce:qi,lineEach:Wr,lineReduce:Yi,propEach:Kr,propReduce:Ri,segmentEach:Vr,segmentReduce:Ni},Symbol.toStringTag,{value:"Module"}));function pr(r){if(!r)throw new Error("geojson is required");var e=[];return Qe(r,function(t){Ui(t,e)}),qe(e)}function Ui(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=He(n);break;case"LineString":t=[He(n)]}t.forEach(function(i){var o=Zi(i,r.properties);o.forEach(function(a){a.id=e.length,e.push(a)})})}}function Zi(r,e){var t=[];return r.reduce(function(n,i){var o=ve([n,i],e);return o.bbox=Ki(n,i),t.push(o),i}),t}function Ki(r,e){var t=r[0],n=r[1],i=e[0],o=e[1],a=t<i?t:i,l=n<o?n:o,s=t>i?t:i,m=n>o?n:o;return[a,l,s,m]}var Yt={exports:{}},Qr={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(In,function(){function t(u,c,d,y,S){(function b(L,A,F,f,w){for(;f>F;){if(f-F>600){var I=f-F+1,X=A-F+1,te=Math.log(I),J=.5*Math.exp(2*te/3),ne=.5*Math.sqrt(te*J*(I-J)/I)*(X-I/2<0?-1:1),oe=Math.max(F,Math.floor(A-X*J/I+ne)),le=Math.min(f,Math.floor(A+(I-X)*J/I+ne));b(L,A,oe,le,w)}var be=L[A],fe=F,U=f;for(n(L,F,A),w(L[f],be)>0&&n(L,F,f);fe<U;){for(n(L,fe,U),fe++,U--;w(L[fe],be)<0;)fe++;for(;w(L[U],be)>0;)U--}w(L[F],be)===0?n(L,F,U):n(L,++U,f),U<=A&&(F=U+1),A<=U&&(f=U-1)}})(u,c,d||0,y||u.length-1,S||i)}function n(u,c,d){var y=u[c];u[c]=u[d],u[d]=y}function i(u,c){return u<c?-1:u>c?1:0}var o=function(u){u===void 0&&(u=9),this._maxEntries=Math.max(4,u),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(u,c,d){if(!d)return c.indexOf(u);for(var y=0;y<c.length;y++)if(d(u,c[y]))return y;return-1}function l(u,c){s(u,0,u.children.length,c,u)}function s(u,c,d,y,S){S||(S=C(null)),S.minX=1/0,S.minY=1/0,S.maxX=-1/0,S.maxY=-1/0;for(var b=c;b<d;b++){var L=u.children[b];m(S,u.leaf?y(L):L)}return S}function m(u,c){return u.minX=Math.min(u.minX,c.minX),u.minY=Math.min(u.minY,c.minY),u.maxX=Math.max(u.maxX,c.maxX),u.maxY=Math.max(u.maxY,c.maxY),u}function v(u,c){return u.minX-c.minX}function h(u,c){return u.minY-c.minY}function P(u){return(u.maxX-u.minX)*(u.maxY-u.minY)}function p(u){return u.maxX-u.minX+(u.maxY-u.minY)}function g(u,c){return u.minX<=c.minX&&u.minY<=c.minY&&c.maxX<=u.maxX&&c.maxY<=u.maxY}function E(u,c){return c.minX<=u.maxX&&c.minY<=u.maxY&&c.maxX>=u.minX&&c.maxY>=u.minY}function C(u){return{children:u,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(u,c,d,y,S){for(var b=[c,d];b.length;)if(!((d=b.pop())-(c=b.pop())<=y)){var L=c+Math.ceil((d-c)/y/2)*y;t(u,L,c,d,S),b.push(c,L,L,d)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(u){var c=this.data,d=[];if(!E(u,c))return d;for(var y=this.toBBox,S=[];c;){for(var b=0;b<c.children.length;b++){var L=c.children[b],A=c.leaf?y(L):L;E(u,A)&&(c.leaf?d.push(L):g(u,A)?this._all(L,d):S.push(L))}c=S.pop()}return d},o.prototype.collides=function(u){var c=this.data;if(!E(u,c))return!1;for(var d=[];c;){for(var y=0;y<c.children.length;y++){var S=c.children[y],b=c.leaf?this.toBBox(S):S;if(E(u,b)){if(c.leaf||g(u,b))return!0;d.push(S)}}c=d.pop()}return!1},o.prototype.load=function(u){if(!u||!u.length)return this;if(u.length<this._minEntries){for(var c=0;c<u.length;c++)this.insert(u[c]);return this}var d=this._build(u.slice(),0,u.length-1,0);if(this.data.children.length)if(this.data.height===d.height)this._splitRoot(this.data,d);else{if(this.data.height<d.height){var y=this.data;this.data=d,d=y}this._insert(d,this.data.height-d.height-1,!0)}else this.data=d;return this},o.prototype.insert=function(u){return u&&this._insert(u,this.data.height-1),this},o.prototype.clear=function(){return this.data=C([]),this},o.prototype.remove=function(u,c){if(!u)return this;for(var d,y,S,b=this.data,L=this.toBBox(u),A=[],F=[];b||A.length;){if(b||(b=A.pop(),y=A[A.length-1],d=F.pop(),S=!0),b.leaf){var f=a(u,b.children,c);if(f!==-1)return b.children.splice(f,1),A.push(b),this._condense(A),this}S||b.leaf||!g(b,L)?y?(d++,b=y.children[d],S=!1):b=null:(A.push(b),F.push(d),d=0,y=b,b=b.children[0])}return this},o.prototype.toBBox=function(u){return u},o.prototype.compareMinX=function(u,c){return u.minX-c.minX},o.prototype.compareMinY=function(u,c){return u.minY-c.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(u){return this.data=u,this},o.prototype._all=function(u,c){for(var d=[];u;)u.leaf?c.push.apply(c,u.children):d.push.apply(d,u.children),u=d.pop();return c},o.prototype._build=function(u,c,d,y){var S,b=d-c+1,L=this._maxEntries;if(b<=L)return l(S=C(u.slice(c,d+1)),this.toBBox),S;y||(y=Math.ceil(Math.log(b)/Math.log(L)),L=Math.ceil(b/Math.pow(L,y-1))),(S=C([])).leaf=!1,S.height=y;var A=Math.ceil(b/L),F=A*Math.ceil(Math.sqrt(L));k(u,c,d,F,this.compareMinX);for(var f=c;f<=d;f+=F){var w=Math.min(f+F-1,d);k(u,f,w,A,this.compareMinY);for(var I=f;I<=w;I+=A){var X=Math.min(I+A-1,w);S.children.push(this._build(u,I,X,y-1))}}return l(S,this.toBBox),S},o.prototype._chooseSubtree=function(u,c,d,y){for(;y.push(c),!c.leaf&&y.length-1!==d;){for(var S=1/0,b=1/0,L=void 0,A=0;A<c.children.length;A++){var F=c.children[A],f=P(F),w=(I=u,X=F,(Math.max(X.maxX,I.maxX)-Math.min(X.minX,I.minX))*(Math.max(X.maxY,I.maxY)-Math.min(X.minY,I.minY))-f);w<b?(b=w,S=f<S?f:S,L=F):w===b&&f<S&&(S=f,L=F)}c=L||c.children[0]}var I,X;return c},o.prototype._insert=function(u,c,d){var y=d?u:this.toBBox(u),S=[],b=this._chooseSubtree(y,this.data,c,S);for(b.children.push(u),m(b,y);c>=0&&S[c].children.length>this._maxEntries;)this._split(S,c),c--;this._adjustParentBBoxes(y,S,c)},o.prototype._split=function(u,c){var d=u[c],y=d.children.length,S=this._minEntries;this._chooseSplitAxis(d,S,y);var b=this._chooseSplitIndex(d,S,y),L=C(d.children.splice(b,d.children.length-b));L.height=d.height,L.leaf=d.leaf,l(d,this.toBBox),l(L,this.toBBox),c?u[c-1].children.push(L):this._splitRoot(d,L)},o.prototype._splitRoot=function(u,c){this.data=C([u,c]),this.data.height=u.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(u,c,d){for(var y,S,b,L,A,F,f,w=1/0,I=1/0,X=c;X<=d-c;X++){var te=s(u,0,X,this.toBBox),J=s(u,X,d,this.toBBox),ne=(S=te,b=J,L=void 0,A=void 0,F=void 0,f=void 0,L=Math.max(S.minX,b.minX),A=Math.max(S.minY,b.minY),F=Math.min(S.maxX,b.maxX),f=Math.min(S.maxY,b.maxY),Math.max(0,F-L)*Math.max(0,f-A)),oe=P(te)+P(J);ne<w?(w=ne,y=X,I=oe<I?oe:I):ne===w&&oe<I&&(I=oe,y=X)}return y||d-c},o.prototype._chooseSplitAxis=function(u,c,d){var y=u.leaf?this.compareMinX:v,S=u.leaf?this.compareMinY:h;this._allDistMargin(u,c,d,y)<this._allDistMargin(u,c,d,S)&&u.children.sort(y)},o.prototype._allDistMargin=function(u,c,d,y){u.children.sort(y);for(var S=this.toBBox,b=s(u,0,c,S),L=s(u,d-c,d,S),A=p(b)+p(L),F=c;F<d-c;F++){var f=u.children[F];m(b,u.leaf?S(f):f),A+=p(b)}for(var w=d-c-1;w>=c;w--){var I=u.children[w];m(L,u.leaf?S(I):I),A+=p(L)}return A},o.prototype._adjustParentBBoxes=function(u,c,d){for(var y=d;y>=0;y--)m(c[y],u)},o.prototype._condense=function(u){for(var c=u.length-1,d=void 0;c>=0;c--)u[c].children.length===0?c>0?(d=u[c-1].children).splice(d.indexOf(u[c]),1):this.clear():l(u[c],this.toBBox)},o})})(Qr);var Vi=Qr.exports;const Wi=At(zi),Qi=At(Ji),ji=At(An);var Ee=Vi,jr=Wi,xr=Qi,Ye=ji.default,xi=xr.featureEach;xr.coordEach;jr.polygon;var br=jr.featureCollection;function $r(r){var e=new Ee(r);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Ye(t),Ee.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ye(i),n.push(i)}):xi(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ye(i),n.push(i)}),Ee.prototype.load.call(this,n)},e.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Ye(t),Ee.prototype.remove.call(this,t,n)},e.clear=function(){return Ee.prototype.clear.call(this)},e.search=function(t){var n=Ee.prototype.search.call(this,this.toBBox(t));return br(n)},e.collides=function(t){return Ee.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=Ee.prototype.all.call(this);return br(t)},e.toJSON=function(){return Ee.prototype.toJSON.call(this)},e.fromJSON=function(t){return Ee.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=Ye(t);else if(t.type==="FeatureCollection")n=Ye(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},e}Yt.exports=$r;Yt.exports.default=$r;var $i=Yt.exports;const eo=Rn($i);function to(r,e){var t={},n=[];if(r.type==="LineString"&&(r=pe(r)),e.type==="LineString"&&(e=pe(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=_r(r,e);return i&&n.push(i),qe(n)}var o=eo();return o.load(pr(e)),gt(pr(r),function(a){gt(o.search(a),function(l){var s=_r(a,l);if(s){var m=He(s).join(",");t[m]||(t[m]=!0,n.push(s))}})}),qe(n)}function _r(r,e){var t=He(r),n=He(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],a=t[1][0],l=t[1][1],s=n[0][0],m=n[0][1],v=n[1][0],h=n[1][1],P=(h-m)*(a-i)-(v-s)*(l-o),p=(v-s)*(o-m)-(h-m)*(i-s),g=(a-i)*(o-m)-(l-o)*(i-s);if(P===0)return null;var E=p/P,C=g/P;if(E>=0&&E<=1&&C>=0&&C<=1){var k=i+E*(a-i),u=o+E*(l-o);return ue([k,u])}return null}function ro(r,e,t){t===void 0&&(t={});var n=ue([1/0,1/0],{dist:1/0}),i=0;return Qe(r,function(o){for(var a=He(o),l=0;l<a.length-1;l++){var s=ue(a[l]);s.properties.dist=rt(e,s,t);var m=ue(a[l+1]);m.properties.dist=rt(e,m,t);var v=rt(s,m,t),h=Math.max(s.properties.dist,m.properties.dist),P=Zr(s,m),p=yr(e,h,P+90,t),g=yr(e,h,P-90,t),E=to(ve([p.geometry.coordinates,g.geometry.coordinates]),ve([s.geometry.coordinates,m.geometry.coordinates])),C=null;E.features.length>0&&(C=E.features[0],C.properties.dist=rt(e,C,t),C.properties.location=i+rt(s,C,t)),s.properties.dist<n.properties.dist&&(n=s,n.properties.index=l,n.properties.location=i),m.properties.dist<n.properties.dist&&(n=m,n.properties.index=l+1,n.properties.location=i+v),C&&C.properties.dist<n.properties.dist&&(n=C,n.properties.index=l),i+=v}}),n}const no=["==",["geometry-type"],"Polygon"],io=["==",["geometry-type"],"LineString"],oo=["==",["geometry-type"],"Point"];function Lt(r){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:en(r)}}}function en(r){return[Math.round(r[0]*1e7)/1e7,Math.round(r[1]*1e7)/1e7]}const tn=ot({type:"FeatureCollection",features:[]}),rn=ot(0),ao=100;class lo{constructor(e){$(this,"map");$(this,"active");$(this,"eventListenersSuccess");$(this,"eventListenersUpdated");$(this,"eventListenersFailure");$(this,"points");$(this,"cursor");$(this,"hover");$(this,"dragFrom");$(this,"previousStates");$(this,"onMouseMove",e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,n=this.dragFrom[1]-e.lngLat.lat;for(let i of this.points)i[0]-=t,i[1]-=n}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}});$(this,"onClick",e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(wr(this.points).forEach((n,i)=>{t.push([i+1,ro(n,this.cursor).properties.dist])}),t.sort((n,i)=>n[1]-i[1]),t.length>0){let n=t[0][0];this.points.splice(n,0,this.cursor.geometry.coordinates),this.hover=n}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))});$(this,"onDoubleClick",e=>{this.active&&(e.preventDefault(),this.cursor=Lt(e.lngLat.toArray()),this.onClick(e),this.finish())});$(this,"onMouseDown",e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())});$(this,"onMouseUp",()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())});$(this,"onKeypress",e=>{this.active&&(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())});$(this,"onKeyDown",e=>{this.active&&e.key=="Escape"&&(e.stopPropagation(),this.cancel())});this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e={type:"FeatureCollection",features:[]};this.points.forEach((i,o)=>{let a=Lt(i);a.properties.hover=this.hover==o,a.properties.idx=o,e.features.push(a)}),e.features=e.features.concat(wr(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),tn.set(e);let n="crosshair";this.hover!=null&&(n=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=n,rn.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=Lt(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(en),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>ao&&this.previousStates.shift()}}function wr(r){let e=[];for(let t=0;t<r.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[t],r[t+1]]},properties:{}});return r.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[r.length-1],r[0]]},properties:{}}),e}let so=Date.now();function ft(r){return`${r}-${so++}`}const nn=Symbol.for("svelte-maplibre");function uo(){return wn(nn)}function Mr(r){return{subscribe:r.subscribe}}function on({key:r,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:n=!1}){let i=uo(),o=ot(null),a=Mr(o),l={...i,[r]:Mr(o)};if(e&&(l.popupTarget=a),n){let s=ot(null);l.layerEvent=s,i.layerEvent=s}return t&&(l.cluster=ot()),_n(nn,l),{...i,self:o}}function fo(){return on({key:"source",setCluster:!0})}function co(r=!0){return on({key:"layer",setPopupTarget:r,setMouseEvent:r})}function Sr(r){let e;return t=>{if(t)for(let n in t){let i=e==null?void 0:e[n],o=t[n];i!==o&&r(n,o,i)}else if(e)for(let n in e)r(n,void 0,e[n]);e=t}}function mo(r,...e){let t=[r];for(let n of e)if(n)Array.isArray(n)&&n[0]===r?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function ho(r){return r===!0?["has","point_count"]:r===!1?["!",["has","point_count"]]:void 0}function Lr(r){let e=r[0],t,n,i=Pr(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),H(o,t,a),n=!0},p(o,a){a[0]&1&&Le(e,e=o[0])?(Ve(),B(i,1,1,Re),We(),i=Pr(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){B(i),n=!1},d(o){o&&Y(t),i.d(o)}}}function Pr(r){let e;const t=r[36].default,n=Je(t,r,r[35],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o[1]&16)&&Ue(n,t,i,i[35],e?Ke(t,i[35],o,null):Ze(i[35]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function vo(r){let e,t,n=r[0]&&Lr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),H(i,e,o),t=!0},p(i,o){i[0]?n?(n.p(i,o),o[0]&1&&T(n,1)):(n=Lr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Ve(),B(n,1,1,()=>{n=null}),We())},i(i){t||(T(n),t=!0)},o(i){B(n),t=!1},d(i){i&&Y(e),n&&n.d(i)}}}function go(r,e,t){let n,i,o,a,l,s,m,v,h,P,p,g,{$$slots:E={},$$scope:C}=e,{id:k=ft("layer")}=e,{source:u=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:d=void 0}=e,{beforeLayerType:y=void 0}=e,{type:S}=e,{paint:b=void 0}=e,{layout:L=void 0}=e,{filter:A=void 0}=e,{applyToClusters:F=void 0}=e,{minzoom:f=void 0}=e,{maxzoom:w=void 0}=e,{manageHoverState:I=!1}=e,{hovered:X=null}=e,{interactive:te=!0}=e,{hoverCursor:J=void 0}=e,{eventsIfTopMost:ne=!1}=e;const oe=Mn(),{map:le,source:be,self:fe,minzoom:U,maxzoom:Xe,eventTopMost:Ie,layerInfo:ce}=co();de(r,le,M=>t(31,h=M)),de(r,be,M=>t(32,P=M)),de(r,fe,M=>t(0,v=M)),de(r,U,M=>t(34,g=M)),de(r,Xe,M=>t(33,p=M)),ht(()=>{v&&h&&(ce.delete(v),h==null||h.removeLayer(v))});let se;function Pe(M){var me,ke;if(!te||!v||!h||ne&&Ie(M)!==v)return;let N=M.features??[],he=(ke=(me=N[0])==null?void 0:me.properties)==null?void 0:ke.cluster_id,we={event:M,map:h,clusterId:he,layer:v,source:l,features:N};oe(M.type,we)}function Fe(M){var me,ke;if(!te||!v||!h||ne&&Ie(M)!==v)return;J&&(h.getCanvas().style.cursor=J);let N=M.features??[];t(6,X=N[0]??null);let he=(ke=(me=N[0])==null?void 0:me.properties)==null?void 0:ke.cluster_id;oe("mouseenter",{event:M,map:h,clusterId:he,layer:v,source:l,features:N})}function je(M){var me,ke,$e;if(!te||!h)return;if(ne&&Ie(M)!==v){t(6,X=null),I&&se!==void 0&&(h==null||h.setFeatureState({source:l,sourceLayer:c,id:se},{hover:!1}),se=void 0);return}h.getCanvas().style.cursor=J;let N=M.features??[],he=(ke=(me=N[0])==null?void 0:me.properties)==null?void 0:ke.cluster_id,we=($e=N[0])==null?void 0:$e.id;we!==se&&(I&&(se!==void 0&&(h==null||h.setFeatureState({source:l,id:se,sourceLayer:c},{hover:!1})),h==null||h.setFeatureState({source:l,id:we,sourceLayer:c},{hover:!0})),se=we,t(6,X=N[0]??null)),oe("mousemove",{event:M,map:h,clusterId:he,layer:v,source:l,features:N})}function Ne(M){if(!(!te||!v||!h)){if(J&&(h.getCanvas().style.cursor=""),t(6,X=null),I&&se!==void 0){const N={source:l,id:se,sourceLayer:c};h==null||h.setFeatureState(N,{hover:!1}),se=void 0}oe("mouseleave",{map:h,layer:v,source:l})}}let _e=!0;function xe(M){h&&(h.off("click",M,Pe),h.off("dblclick",M,Pe),h.off("contextmenu",M,Pe),h.off("mouseenter",M,Fe),h.off("mousemove",M,je),h.off("mouseleave",M,Ne))}return ht(()=>{h&&v&&xe(v)}),r.$$set=M=>{"id"in M&&t(7,k=M.id),"source"in M&&t(8,u=M.source),"sourceLayer"in M&&t(9,c=M.sourceLayer),"beforeId"in M&&t(10,d=M.beforeId),"beforeLayerType"in M&&t(11,y=M.beforeLayerType),"type"in M&&t(12,S=M.type),"paint"in M&&t(13,b=M.paint),"layout"in M&&t(14,L=M.layout),"filter"in M&&t(15,A=M.filter),"applyToClusters"in M&&t(16,F=M.applyToClusters),"minzoom"in M&&t(17,f=M.minzoom),"maxzoom"in M&&t(18,w=M.maxzoom),"manageHoverState"in M&&t(19,I=M.manageHoverState),"hovered"in M&&t(6,X=M.hovered),"interactive"in M&&t(20,te=M.interactive),"hoverCursor"in M&&t(21,J=M.hoverCursor),"eventsIfTopMost"in M&&t(22,ne=M.eventsIfTopMost),"$$scope"in M&&t(35,C=M.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65536&&t(30,n=ho(F)),r.$$.dirty[0]&1073774592&&t(24,i=mo("all",n,A)),r.$$.dirty[0]&131072|r.$$.dirty[1]&8&&t(26,o=f??g),r.$$.dirty[0]&262144|r.$$.dirty[1]&4&&t(25,a=w??p),r.$$.dirty[0]&256|r.$$.dirty[1]&2&&t(29,l=u||P),r.$$.dirty[0]&654343809|r.$$.dirty[1]&1&&h&&v!==k&&l){v&&(xe(v),ce.delete(v));let M=d;if(!d&&y){let N=h.getStyle().layers,he=typeof y=="function"?y:me=>me.type===y,we=N==null?void 0:N.find(he);we&&(M=we.id)}Ge(fe,v=k,v),h.addLayer(kt({id:v,type:S,source:l,"source-layer":c,filter:i,paint:b,layout:L,minzoom:o,maxzoom:a}),M),t(23,_e=!0),h.on("click",v,Pe),h.on("dblclick",v,Pe),h.on("contextmenu",v,Pe),h.on("mouseenter",v,Fe),h.on("mousemove",v,je),h.on("mouseleave",v,Ne)}r.$$.dirty[0]&1048577&&v&&ce.set(v,{interactive:te}),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(28,s=v?Sr((M,N)=>h==null?void 0:h.setPaintProperty(v,M,N)):void 0),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(27,m=v?Sr((M,N)=>h==null?void 0:h.setLayoutProperty(v,M,N)):void 0),r.$$.dirty[0]&268443648&&(s==null||s(b)),r.$$.dirty[0]&134234112&&(m==null||m(L)),r.$$.dirty[0]&100663297|r.$$.dirty[1]&1&&v&&(h==null||h.setLayerZoomRange(v,o,a)),r.$$.dirty[0]&25165825|r.$$.dirty[1]&1&&v&&(_e?t(23,_e=!1):h==null||h.setFilter(v,i))},[v,le,be,fe,U,Xe,X,k,u,c,d,y,S,b,L,A,F,f,w,I,te,J,ne,_e,i,a,o,m,s,l,n,h,P,p,g,C,E]}class Gt extends ze{constructor(e){super(),Be(this,e,go,vo,Le,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function yo(r){let e;const t=r[16].default,n=Je(t,r,r[24],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16777216)&&Ue(n,t,i,i[24],e?Ke(t,i[24],o,null):Ze(i[24]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function po(r){let e,t,n;function i(a){r[17](a)}let o={id:r[1],type:"circle",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],applyToClusters:r[9],minzoom:r[10],maxzoom:r[11],hoverCursor:r[12],manageHoverState:r[13],eventsIfTopMost:r[14],interactive:r[15],$$slots:{default:[yo]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>x(e,"hovered",i)),e.$on("click",r[18]),e.$on("dblclick",r[19]),e.$on("contextmenu",r[20]),e.$on("mouseenter",r[21]),e.$on("mousemove",r[22]),e.$on("mouseleave",r[23]),{c(){R(e.$$.fragment)},l(a){O(e.$$.fragment,a)},m(a,l){D(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.applyToClusters=a[9]),l&1024&&(s.minzoom=a[10]),l&2048&&(s.maxzoom=a[11]),l&4096&&(s.hoverCursor=a[12]),l&8192&&(s.manageHoverState=a[13]),l&16384&&(s.eventsIfTopMost=a[14]),l&32768&&(s.interactive=a[15]),l&16777216&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],j(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function bo(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("circle")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:v}=e,{layout:h=void 0}=e,{filter:P=void 0}=e,{applyToClusters:p=void 0}=e,{minzoom:g=void 0}=e,{maxzoom:E=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:k=!1}=e,{hovered:u=null}=e,{eventsIfTopMost:c=!1}=e,{interactive:d=!0}=e;function y(w){u=w,t(0,u)}function S(w){V.call(this,r,w)}function b(w){V.call(this,r,w)}function L(w){V.call(this,r,w)}function A(w){V.call(this,r,w)}function F(w){V.call(this,r,w)}function f(w){V.call(this,r,w)}return r.$$set=w=>{"id"in w&&t(1,o=w.id),"source"in w&&t(2,a=w.source),"sourceLayer"in w&&t(3,l=w.sourceLayer),"beforeId"in w&&t(4,s=w.beforeId),"beforeLayerType"in w&&t(5,m=w.beforeLayerType),"paint"in w&&t(6,v=w.paint),"layout"in w&&t(7,h=w.layout),"filter"in w&&t(8,P=w.filter),"applyToClusters"in w&&t(9,p=w.applyToClusters),"minzoom"in w&&t(10,g=w.minzoom),"maxzoom"in w&&t(11,E=w.maxzoom),"hoverCursor"in w&&t(12,C=w.hoverCursor),"manageHoverState"in w&&t(13,k=w.manageHoverState),"hovered"in w&&t(0,u=w.hovered),"eventsIfTopMost"in w&&t(14,c=w.eventsIfTopMost),"interactive"in w&&t(15,d=w.interactive),"$$scope"in w&&t(24,i=w.$$scope)},[u,o,a,l,s,m,v,h,P,p,g,E,C,k,c,d,n,y,S,b,L,A,F,f,i]}class _o extends ze{constructor(e){super(),Be(this,e,bo,po,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function wo(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Mo(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[wo]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>x(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){R(e.$$.fragment)},l(a){O(e.$$.fragment,a)},m(a,l){D(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],j(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function So(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("fill")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:v}=e,{layout:h=void 0}=e,{filter:P=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:C=!1}=e,{hovered:k=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){k=f,t(0,k)}function y(f){V.call(this,r,f)}function S(f){V.call(this,r,f)}function b(f){V.call(this,r,f)}function L(f){V.call(this,r,f)}function A(f){V.call(this,r,f)}function F(f){V.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,m=f.beforeLayerType),"paint"in f&&t(6,v=f.paint),"layout"in f&&t(7,h=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,p=f.minzoom),"maxzoom"in f&&t(10,g=f.maxzoom),"hoverCursor"in f&&t(11,E=f.hoverCursor),"manageHoverState"in f&&t(12,C=f.manageHoverState),"hovered"in f&&t(0,k=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[k,o,a,l,s,m,v,h,P,p,g,E,C,u,c,n,d,y,S,b,L,A,F,i]}class Lo extends ze{constructor(e){super(),Be(this,e,So,Mo,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Po(r,e,t,n,i){let o=!1;r.getSource(e)&&(o=!0,r.removeSource(e));const a=()=>{n(e)&&(r.addSource(e,t),i())};if(o){const l=()=>{e&&(r.getSource(e)?setTimeout(l,1):a())};l()}else a()}function ko(r,e,t){Sn().then(()=>{let n=Ln(r);if(!n)return;n.getSource(e)===t&&n.removeSource(e)})}function kr(r){let e=r[0],t,n,i=Er(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),H(o,t,a),n=!0},p(o,a){a&1&&Le(e,e=o[0])?(Ve(),B(i,1,1,Re),We(),i=Er(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){B(i),n=!1},d(o){o&&Y(t),i.d(o)}}}function Er(r){let e;const t=r[15].default,n=Je(t,r,r[14],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16384)&&Ue(n,t,i,i[14],e?Ke(t,i[14],o,null):Ze(i[14]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Eo(r){let e,t,n=r[0]&&kr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),H(i,e,o),t=!0},p(i,[o]){i[0]?n?(n.p(i,o),o&1&&T(n,1)):(n=kr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Ve(),B(n,1,1,()=>{n=null}),We())},i(i){t||(T(n),t=!0)},o(i){B(n),t=!1},d(i){i&&Y(e),n&&n.d(i)}}}function Co(r,e,t){let n,i,o,{$$slots:a={},$$scope:l}=e,{id:s=ft("geojson")}=e,{data:m}=e,{generateId:v=!1}=e,{promoteId:h=void 0}=e,{filter:P=void 0}=e,{lineMetrics:p=void 0}=e,{cluster:g=void 0}=e;const{map:E,cluster:C,self:k}=fo();de(r,E,d=>t(13,i=d)),de(r,C,d=>t(16,o=d)),de(r,k,d=>t(0,n=d));let u,c=!0;return ht(()=>{n&&u&&i&&(ko(E,n,u),Ge(k,n=null,n),t(11,u=void 0))}),r.$$set=d=>{"id"in d&&t(4,s=d.id),"data"in d&&t(5,m=d.data),"generateId"in d&&t(6,v=d.generateId),"promoteId"in d&&t(7,h=d.promoteId),"filter"in d&&t(8,P=d.filter),"lineMetrics"in d&&t(9,p=d.lineMetrics),"cluster"in d&&t(10,g=d.cluster),"$$scope"in d&&t(14,l=d.$$scope)},r.$$.update=()=>{r.$$.dirty&1024&&Ge(C,o=g,o),r.$$.dirty&12273&&i&&n!==s&&(Ge(k,n=s,n),Po(i,n,kt({type:"geojson",data:m,filter:P,lineMetrics:p,generateId:v,promoteId:h,cluster:!!g,clusterMinPoints:g==null?void 0:g.minPoints,clusterMaxZoom:g==null?void 0:g.maxZoom,clusterRadius:g==null?void 0:g.radius,clusterProperties:g==null?void 0:g.properties}),d=>i&&d===n,()=>{n&&(t(11,u=i==null?void 0:i.getSource(n)),t(12,c=!0))})),r.$$.dirty&8208&&(i==null||i.on("style.load",()=>{t(11,u=i==null?void 0:i.getSource(s))})),r.$$.dirty&6176&&u&&(c?t(12,c=!1):u.setData(m)),r.$$.dirty&3072&&(u==null||u.setClusterOptions(kt({cluster:!!g,clusterMaxZoom:g==null?void 0:g.maxZoom,clusterRadius:g==null?void 0:g.radius})))},[n,E,C,k,s,m,v,h,P,p,g,u,c,i,l,a]}class Fo extends ze{constructor(e){super(),Be(this,e,Co,Eo,Le,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function To(r){let e;const t=r[15].default,n=Je(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&Ue(n,t,i,i[23],e?Ke(t,i[23],o,null):Ze(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){B(n,i),e=!1},d(i){n&&n.d(i)}}}function Ao(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"line",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[To]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),Q.push(()=>x(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){R(e.$$.fragment)},l(a){O(e.$$.fragment,a)},m(a,l){D(e,a,l),n=!0},p(a,[l]){const s={};l&2&&(s.id=a[1]),l&4&&(s.source=a[2]),l&8&&(s.sourceLayer=a[3]),l&16&&(s.beforeId=a[4]),l&32&&(s.beforeLayerType=a[5]),l&64&&(s.paint=a[6]),l&128&&(s.layout=a[7]),l&256&&(s.filter=a[8]),l&512&&(s.minzoom=a[9]),l&1024&&(s.maxzoom=a[10]),l&2048&&(s.hoverCursor=a[11]),l&4096&&(s.manageHoverState=a[12]),l&8192&&(s.eventsIfTopMost=a[13]),l&16384&&(s.interactive=a[14]),l&8388608&&(s.$$scope={dirty:l,ctx:a}),!t&&l&1&&(t=!0,s.hovered=a[0],j(()=>t=!1)),e.$set(s)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){B(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function zo(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("line")}=e,{source:a=void 0}=e,{sourceLayer:l=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:v}=e,{layout:h=void 0}=e,{filter:P=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:g=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:C=!1}=e,{hovered:k=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:c=!0}=e;function d(f){k=f,t(0,k)}function y(f){V.call(this,r,f)}function S(f){V.call(this,r,f)}function b(f){V.call(this,r,f)}function L(f){V.call(this,r,f)}function A(f){V.call(this,r,f)}function F(f){V.call(this,r,f)}return r.$$set=f=>{"id"in f&&t(1,o=f.id),"source"in f&&t(2,a=f.source),"sourceLayer"in f&&t(3,l=f.sourceLayer),"beforeId"in f&&t(4,s=f.beforeId),"beforeLayerType"in f&&t(5,m=f.beforeLayerType),"paint"in f&&t(6,v=f.paint),"layout"in f&&t(7,h=f.layout),"filter"in f&&t(8,P=f.filter),"minzoom"in f&&t(9,p=f.minzoom),"maxzoom"in f&&t(10,g=f.maxzoom),"hoverCursor"in f&&t(11,E=f.hoverCursor),"manageHoverState"in f&&t(12,C=f.manageHoverState),"hovered"in f&&t(0,k=f.hovered),"eventsIfTopMost"in f&&t(13,u=f.eventsIfTopMost),"interactive"in f&&t(14,c=f.interactive),"$$scope"in f&&t(23,i=f.$$scope)},[k,o,a,l,s,m,v,h,P,p,g,E,C,u,c,n,d,y,S,b,L,A,F,i]}class Bo extends ze{constructor(e){super(),Be(this,e,zo,Ao,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Io(r){let e,t,n,i,o,a;return e=new Lo({props:{id:"edit-polygon-fill",filter:no,paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}}}),n=new Bo({props:{id:"edit-polygon-lines",filter:io,paint:{"line-color":"black","line-width":8,"line-opacity":.5}}}),o=new _o({props:{id:"edit-polygon-vertices",filter:oo,paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}}),{c(){R(e.$$.fragment),t=Z(),R(n.$$.fragment),i=Z(),R(o.$$.fragment)},l(l){O(e.$$.fragment,l),t=K(l),O(n.$$.fragment,l),i=K(l),O(o.$$.fragment,l)},m(l,s){D(e,l,s),H(l,t,s),D(n,l,s),H(l,i,s),D(o,l,s),a=!0},p:Re,i(l){a||(T(e.$$.fragment,l),T(n.$$.fragment,l),T(o.$$.fragment,l),a=!0)},o(l){B(e.$$.fragment,l),B(n.$$.fragment,l),B(o.$$.fragment,l),a=!1},d(l){l&&(Y(t),Y(i)),q(e,l),q(n,l),q(o,l)}}}function Ro(r){let e,t;return e=new Fo({props:{data:r[0],$$slots:{default:[Io]},$$scope:{ctx:r}}}),{c(){R(e.$$.fragment)},l(n){O(e.$$.fragment,n)},m(n,i){D(e,n,i),t=!0},p(n,[i]){const o={};i&1&&(o.data=n[0]),i&2&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Oo(r,e,t){let n;return de(r,tn,i=>t(0,n=i)),[n]}class Do extends ze{constructor(e){super(),Be(this,e,Oo,Ro,Le,{})}}function qo(r){let e,t="Map loading...";return{c(){e=Oe("p"),e.textContent=t},l(n){e=De(n,"P",{"data-svelte-h":!0}),Pt(e)!=="svelte-1r8199k"&&(e.textContent=t)},m(n,i){H(n,e,i)},p:Re,i:Re,o:Re,d(n){n&&Y(e)}}}function Xo(r){let e,t,n,i;e=new kn({props:{$$slots:{default:[Yo]},$$scope:{ctx:r}}}),e.$on("click",r[5]);let o=r[1].summary.polygon&&Cr(r);return{c(){R(e.$$.fragment),t=Z(),o&&o.c(),n=ye()},l(a){O(e.$$.fragment,a),t=K(a),o&&o.l(a),n=ye()},m(a,l){D(e,a,l),H(a,t,l),o&&o.m(a,l),H(a,n,l),i=!0},p(a,l){const s={};l&2048&&(s.$$scope={dirty:l,ctx:a}),e.$set(s),a[1].summary.polygon?o?(o.p(a,l),l&2&&T(o,1)):(o=Cr(a),o.c(),T(o,1),o.m(n.parentNode,n)):o&&(Ve(),B(o,1,1,()=>{o=null}),We())},i(a){i||(T(e.$$.fragment,a),T(o),i=!0)},o(a){B(e.$$.fragment,a),B(o),i=!1},d(a){a&&(Y(t),Y(n)),q(e,a),o&&o.d(a)}}}function No(r){let e,t,n,i,o,a,l;return t=new Mt({props:{$$slots:{default:[Ho]},$$scope:{ctx:r}}}),t.$on("click",r[7]),i=new Mt({props:{$$slots:{default:[Jo]},$$scope:{ctx:r}}}),i.$on("click",r[8]),a=new Mt({props:{disabled:r[4]==0,$$slots:{default:[Ko]},$$scope:{ctx:r}}}),a.$on("click",r[9]),{c(){e=Oe("div"),R(t.$$.fragment),n=Z(),R(i.$$.fragment),o=Z(),R(a.$$.fragment),this.h()},l(s){e=De(s,"DIV",{style:!0});var m=yt(e);O(t.$$.fragment,m),n=K(m),O(i.$$.fragment,m),o=K(m),O(a.$$.fragment,m),m.forEach(Y),this.h()},h(){it(e,"display","flex"),it(e,"justify-content","space-between")},m(s,m){H(s,e,m),D(t,e,null),W(e,n),D(i,e,null),W(e,o),D(a,e,null),l=!0},p(s,m){const v={};m&2048&&(v.$$scope={dirty:m,ctx:s}),t.$set(v);const h={};m&2048&&(h.$$scope={dirty:m,ctx:s}),i.$set(h);const P={};m&16&&(P.disabled=s[4]==0),m&2064&&(P.$$scope={dirty:m,ctx:s}),a.$set(P)},i(s){l||(T(t.$$.fragment,s),T(i.$$.fragment,s),T(a.$$.fragment,s),l=!0)},o(s){B(t.$$.fragment,s),B(i.$$.fragment,s),B(a.$$.fragment,s),l=!1},d(s){s&&Y(e),q(t),q(i),q(a)}}}function Yo(r){let e;return{c(){e=Me("Edit polygon")},l(t){e=Se(t,"Edit polygon")},m(t,n){H(t,e,n)},d(t){t&&Y(e)}}}function Cr(r){let e,t,n,i,o=gr(r[1].summary.polygon).toFixed(1)+"",a,l,s;return e=new En({props:{$$slots:{default:[Go]},$$scope:{ctx:r}}}),e.$on("click",r[6]),{c(){R(e.$$.fragment),t=Z(),n=Oe("p"),i=Me("Polygon area: "),a=Me(o),l=Me(" square meters")},l(m){O(e.$$.fragment,m),t=K(m),n=De(m,"P",{});var v=yt(n);i=Se(v,"Polygon area: "),a=Se(v,o),l=Se(v," square meters"),v.forEach(Y)},m(m,v){D(e,m,v),H(m,t,v),H(m,n,v),W(n,i),W(n,a),W(n,l),s=!0},p(m,v){const h={};v&2048&&(h.$$scope={dirty:v,ctx:m}),e.$set(h),(!s||v&2)&&o!==(o=gr(m[1].summary.polygon).toFixed(1)+"")&&Fr(a,o)},i(m){s||(T(e.$$.fragment,m),s=!0)},o(m){B(e.$$.fragment,m),s=!1},d(m){m&&(Y(t),Y(n)),q(e,m)}}}function Go(r){let e;return{c(){e=Me("Delete and start over")},l(t){e=Se(t,"Delete and start over")},m(t,n){H(t,e,n)},d(t){t&&Y(e)}}}function Ho(r){let e;return{c(){e=Me("Finish")},l(t){e=Se(t,"Finish")},m(t,n){H(t,e,n)},d(t){t&&Y(e)}}}function Jo(r){let e;return{c(){e=Me("Cancel")},l(t){e=Se(t,"Cancel")},m(t,n){H(t,e,n)},d(t){t&&Y(e)}}}function Uo(r){let e,t,n;return{c(){e=Me("Undo ("),t=Me(r[4]),n=Me(")")},l(i){e=Se(i,"Undo ("),t=Se(i,r[4]),n=Se(i,")")},m(i,o){H(i,e,o),H(i,t,o),H(i,n,o)},p(i,o){o&16&&Fr(t,i[4])},d(i){i&&(Y(e),Y(t),Y(n))}}}function Zo(r){let e;return{c(){e=Me("Undo")},l(t){e=Se(t,"Undo")},m(t,n){H(t,e,n)},p:Re,d(t){t&&Y(e)}}}function Ko(r){let e;function t(o,a){return o[4]==0?Zo:Uo}let n=t(r),i=n(r);return{c(){i.c(),e=ye()},l(o){i.l(o),e=ye()},m(o,a){i.m(o,a),H(o,e,a)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&Y(e),i.d(o)}}}function Vo(r){let e,t;return e=new Un({props:{layout:{visibility:r[2]?"none":"visible"},paint:{"fill-color":"red","fill-opacity":.8}}}),{c(){R(e.$$.fragment)},l(n){O(e.$$.fragment,n)},m(n,i){D(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.layout={visibility:n[2]?"none":"visible"}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Wo(r){let e,t,n,i;return e=new Do({}),n=new Bn({props:{data:r[3],$$slots:{default:[Vo]},$$scope:{ctx:r}}}),{c(){R(e.$$.fragment),t=Z(),R(n.$$.fragment)},l(o){O(e.$$.fragment,o),t=K(o),O(n.$$.fragment,o)},m(o,a){D(e,o,a),H(o,t,a),D(n,o,a),i=!0},p(o,a){const l={};a&8&&(l.data=o[3]),a&2052&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){i||(T(e.$$.fragment,o),T(n.$$.fragment,o),i=!0)},o(o){B(e.$$.fragment,o),B(n.$$.fragment,o),i=!1},d(o){o&&Y(t),q(e,o),q(n,o)}}}function Qo(r){let e,t,n,i,o,a,l;const s=[No,Xo,qo],m=[];function v(p,g){return p[2]?0:p[0]?1:2}e=v(r),t=m[e]=s[e](r);function h(p){r[10](p)}let P={$$slots:{default:[Wo]},$$scope:{ctx:r}};return r[0]!==void 0&&(P.map=r[0]),o=new zn({props:P}),Q.push(()=>x(o,"map",h)),{c(){t.c(),n=Z(),i=Oe("div"),R(o.$$.fragment),this.h()},l(p){t.l(p),n=K(p),i=De(p,"DIV",{style:!0});var g=yt(i);O(o.$$.fragment,g),g.forEach(Y),this.h()},h(){it(i,"position","relative"),it(i,"width","100%"),it(i,"height","300px")},m(p,g){m[e].m(p,g),H(p,n,g),H(p,i,g),D(o,i,null),l=!0},p(p,[g]){let E=e;e=v(p),e===E?m[e].p(p,g):(Ve(),B(m[E],1,1,()=>{m[E]=null}),We(),t=m[e],t?t.p(p,g):(t=m[e]=s[e](p),t.c()),T(t,1),t.m(n.parentNode,n));const C={};g&2060&&(C.$$scope={dirty:g,ctx:p}),!a&&g&1&&(a=!0,C.map=p[0],j(()=>a=!1)),o.$set(C)},i(p){l||(T(t),T(o.$$.fragment,p),l=!0)},o(p){B(t),B(o.$$.fragment,p),l=!1},d(p){p&&(Y(n),Y(i)),m[e].d(p),q(o)}}}function jo(r,e,t){let n,i,o;de(r,ee,g=>t(1,i=g)),de(r,rn,g=>t(4,o=g));let a=null,l=null;ht(()=>{l==null||l.tearDown()});function s(){a&&(t(2,l=new lo(a)),i.summary.polygon?l.editExisting(i.summary.polygon):l.startNew(),l.addEventListenerSuccess(async g=>{t(2,l=null),Ge(ee,i.summary.polygon=g,i)}),l.addEventListenerFailure(()=>{t(2,l=null)}))}function m(){Ge(ee,i.summary.polygon=null,i),s()}const v=()=>l==null?void 0:l.finish(),h=()=>l==null?void 0:l.cancel(),P=()=>l==null?void 0:l.undo();function p(g){a=g,t(0,a)}return r.$$.update=()=>{r.$$.dirty&2&&t(3,n=i.summary.polygon??{type:"FeatureCollection",features:[]}),r.$$.dirty&1&&a&&s()},[a,i,l,n,o,s,m,v,h,P,p]}class xo extends ze{constructor(e){super(),Be(this,e,jo,Qo,Le,{})}}function $o(r){let e,t,n,i,o,a,l,s,m,v,h,P,p,g,E,C,k,u,c,d,y,S,b,L,A,F,f,w,I,X,te,J,ne,oe,le,be,fe,U,Xe,Ie,ce,se,Pe,Fe,je="Network context",Ne,_e,xe=`Please add a drawing of the area being assessed below, including the
    location of measures proposed by the scheme.`,M,N,he;function we(_){r[1](_)}let me={label:"Date of design review"};r[0].summary.dateDesignReview!==void 0&&(me.value=r[0].summary.dateDesignReview),t=new mt({props:me}),Q.push(()=>x(t,"value",we));function ke(_){r[2](_)}let $e={label:"Scheme reference"};r[0].summary.schemeReference!==void 0&&($e.value=r[0].summary.schemeReference),o=new mt({props:$e}),Q.push(()=>x(o,"value",ke));function an(_){r[3](_)}let Ht={label:"Scheme name"};r[0].summary.schemeName!==void 0&&(Ht.value=r[0].summary.schemeName),s=new mt({props:Ht}),Q.push(()=>x(s,"value",an));function ln(_){r[4](_)}let Jt={label:"Scheme summary"};r[0].summary.schemeSummary!==void 0&&(Jt.value=r[0].summary.schemeSummary),h=new ct({props:Jt}),Q.push(()=>x(h,"value",ln));function sn(_){r[5](_)}let Ut={label:"Scheme information reviewed"};r[0].summary.schemeInfoReviewed!==void 0&&(Ut.value=r[0].summary.schemeInfoReviewed),g=new ct({props:Ut}),Q.push(()=>x(g,"value",sn));function un(_){r[6](_)}let Zt={label:"Authority",emptyOption:!0,choices:et(On)};r[0].summary.authority!==void 0&&(Zt.value=r[0].summary.authority),k=new tt({props:Zt}),Q.push(()=>x(k,"value",un));function fn(_){r[7](_)}let Kt={label:"Transport / Combined Authority",emptyOption:!0,choices:et(Dn)};r[0].summary.transportOrCombinedAuthority!==void 0&&(Kt.value=r[0].summary.transportOrCombinedAuthority),d=new tt({props:Kt}),Q.push(()=>x(d,"value",fn));function cn(_){r[8](_)}let Vt={label:"Region",emptyOption:!0,choices:et(qn)};r[0].summary.region!==void 0&&(Vt.value=r[0].summary.region),b=new tt({props:Vt}),Q.push(()=>x(b,"value",cn));function mn(_){r[9](_)}let Wt={label:"Funding programme",emptyOption:!0,choices:et(Xn)};r[0].summary.fundingProgramme!==void 0&&(Wt.value=r[0].summary.fundingProgramme),F=new tt({props:Wt}),Q.push(()=>x(F,"value",mn));function hn(_){r[10](_)}let Qt={label:"Design stage",emptyOption:!0,choices:et(Nn)};r[0].summary.designStage!==void 0&&(Qt.value=r[0].summary.designStage),I=new tt({props:Qt}),Q.push(()=>x(I,"value",hn));function dn(_){r[11](_)}let jt={label:"Funding conditions"};r[0].summary.fundingConditions!==void 0&&(jt.value=r[0].summary.fundingConditions),J=new ct({props:jt}),Q.push(()=>x(J,"value",dn));function vn(_){r[12](_)}let xt={label:"Inspector email address"};r[0].summary.inspectorEmail!==void 0&&(xt.value=r[0].summary.inspectorEmail),le=new mt({props:xt}),Q.push(()=>x(le,"value",vn));function gn(_){r[13](_)}let $t={label:"Scheme area size (km)",width:6,min:0};r[0].summary.schemeAreaSizeKm2!==void 0&&($t.value=r[0].summary.schemeAreaSizeKm2),U=new Yn({props:$t}),Q.push(()=>x(U,"value",gn));function yn(_){r[14](_)}let er={label:"Notes"};return r[0].summary.notes!==void 0&&(er.value=r[0].summary.notes),ce=new ct({props:er}),Q.push(()=>x(ce,"value",yn)),N=new xo({}),{c(){e=Oe("div"),R(t.$$.fragment),i=Z(),R(o.$$.fragment),l=Z(),R(s.$$.fragment),v=Z(),R(h.$$.fragment),p=Z(),R(g.$$.fragment),C=Z(),R(k.$$.fragment),c=Z(),R(d.$$.fragment),S=Z(),R(b.$$.fragment),A=Z(),R(F.$$.fragment),w=Z(),R(I.$$.fragment),te=Z(),R(J.$$.fragment),oe=Z(),R(le.$$.fragment),fe=Z(),R(U.$$.fragment),Ie=Z(),R(ce.$$.fragment),Pe=Z(),Fe=Oe("h2"),Fe.textContent=je,Ne=Z(),_e=Oe("p"),_e.textContent=xe,M=Z(),R(N.$$.fragment),this.h()},l(_){e=De(_,"DIV",{class:!0});var z=yt(e);O(t.$$.fragment,z),i=K(z),O(o.$$.fragment,z),l=K(z),O(s.$$.fragment,z),v=K(z),O(h.$$.fragment,z),p=K(z),O(g.$$.fragment,z),C=K(z),O(k.$$.fragment,z),c=K(z),O(d.$$.fragment,z),S=K(z),O(b.$$.fragment,z),A=K(z),O(F.$$.fragment,z),w=K(z),O(I.$$.fragment,z),te=K(z),O(J.$$.fragment,z),oe=K(z),O(le.$$.fragment,z),fe=K(z),O(U.$$.fragment,z),Ie=K(z),O(ce.$$.fragment,z),Pe=K(z),Fe=De(z,"H2",{"data-svelte-h":!0}),Pt(Fe)!=="svelte-1tcb68x"&&(Fe.textContent=je),Ne=K(z),_e=De(z,"P",{"data-svelte-h":!0}),Pt(_e)!=="svelte-2zany2"&&(_e.textContent=xe),M=K(z),O(N.$$.fragment,z),z.forEach(Y),this.h()},h(){Pn(e,"class","govuk-width-container")},m(_,z){H(_,e,z),D(t,e,null),W(e,i),D(o,e,null),W(e,l),D(s,e,null),W(e,v),D(h,e,null),W(e,p),D(g,e,null),W(e,C),D(k,e,null),W(e,c),D(d,e,null),W(e,S),D(b,e,null),W(e,A),D(F,e,null),W(e,w),D(I,e,null),W(e,te),D(J,e,null),W(e,oe),D(le,e,null),W(e,fe),D(U,e,null),W(e,Ie),D(ce,e,null),W(e,Pe),W(e,Fe),W(e,Ne),W(e,_e),W(e,M),D(N,e,null),he=!0},p(_,[z]){const tr={};!n&&z&1&&(n=!0,tr.value=_[0].summary.dateDesignReview,j(()=>n=!1)),t.$set(tr);const rr={};!a&&z&1&&(a=!0,rr.value=_[0].summary.schemeReference,j(()=>a=!1)),o.$set(rr);const nr={};!m&&z&1&&(m=!0,nr.value=_[0].summary.schemeName,j(()=>m=!1)),s.$set(nr);const ir={};!P&&z&1&&(P=!0,ir.value=_[0].summary.schemeSummary,j(()=>P=!1)),h.$set(ir);const or={};!E&&z&1&&(E=!0,or.value=_[0].summary.schemeInfoReviewed,j(()=>E=!1)),g.$set(or);const ar={};!u&&z&1&&(u=!0,ar.value=_[0].summary.authority,j(()=>u=!1)),k.$set(ar);const lr={};!y&&z&1&&(y=!0,lr.value=_[0].summary.transportOrCombinedAuthority,j(()=>y=!1)),d.$set(lr);const sr={};!L&&z&1&&(L=!0,sr.value=_[0].summary.region,j(()=>L=!1)),b.$set(sr);const ur={};!f&&z&1&&(f=!0,ur.value=_[0].summary.fundingProgramme,j(()=>f=!1)),F.$set(ur);const fr={};!X&&z&1&&(X=!0,fr.value=_[0].summary.designStage,j(()=>X=!1)),I.$set(fr);const cr={};!ne&&z&1&&(ne=!0,cr.value=_[0].summary.fundingConditions,j(()=>ne=!1)),J.$set(cr);const mr={};!be&&z&1&&(be=!0,mr.value=_[0].summary.inspectorEmail,j(()=>be=!1)),le.$set(mr);const hr={};!Xe&&z&1&&(Xe=!0,hr.value=_[0].summary.schemeAreaSizeKm2,j(()=>Xe=!1)),U.$set(hr);const dr={};!se&&z&1&&(se=!0,dr.value=_[0].summary.notes,j(()=>se=!1)),ce.$set(dr)},i(_){he||(T(t.$$.fragment,_),T(o.$$.fragment,_),T(s.$$.fragment,_),T(h.$$.fragment,_),T(g.$$.fragment,_),T(k.$$.fragment,_),T(d.$$.fragment,_),T(b.$$.fragment,_),T(F.$$.fragment,_),T(I.$$.fragment,_),T(J.$$.fragment,_),T(le.$$.fragment,_),T(U.$$.fragment,_),T(ce.$$.fragment,_),T(N.$$.fragment,_),he=!0)},o(_){B(t.$$.fragment,_),B(o.$$.fragment,_),B(s.$$.fragment,_),B(h.$$.fragment,_),B(g.$$.fragment,_),B(k.$$.fragment,_),B(d.$$.fragment,_),B(b.$$.fragment,_),B(F.$$.fragment,_),B(I.$$.fragment,_),B(J.$$.fragment,_),B(le.$$.fragment,_),B(U.$$.fragment,_),B(ce.$$.fragment,_),B(N.$$.fragment,_),he=!1},d(_){_&&Y(e),q(t),q(o),q(s),q(h),q(g),q(k),q(d),q(b),q(F),q(I),q(J),q(le),q(U),q(ce),q(N)}}}function ea(r,e,t){let n;de(r,ee,u=>t(0,n=u));function i(u){r.$$.not_equal(n.summary.dateDesignReview,u)&&(n.summary.dateDesignReview=u,ee.set(n))}function o(u){r.$$.not_equal(n.summary.schemeReference,u)&&(n.summary.schemeReference=u,ee.set(n))}function a(u){r.$$.not_equal(n.summary.schemeName,u)&&(n.summary.schemeName=u,ee.set(n))}function l(u){r.$$.not_equal(n.summary.schemeSummary,u)&&(n.summary.schemeSummary=u,ee.set(n))}function s(u){r.$$.not_equal(n.summary.schemeInfoReviewed,u)&&(n.summary.schemeInfoReviewed=u,ee.set(n))}function m(u){r.$$.not_equal(n.summary.authority,u)&&(n.summary.authority=u,ee.set(n))}function v(u){r.$$.not_equal(n.summary.transportOrCombinedAuthority,u)&&(n.summary.transportOrCombinedAuthority=u,ee.set(n))}function h(u){r.$$.not_equal(n.summary.region,u)&&(n.summary.region=u,ee.set(n))}function P(u){r.$$.not_equal(n.summary.fundingProgramme,u)&&(n.summary.fundingProgramme=u,ee.set(n))}function p(u){r.$$.not_equal(n.summary.designStage,u)&&(n.summary.designStage=u,ee.set(n))}function g(u){r.$$.not_equal(n.summary.fundingConditions,u)&&(n.summary.fundingConditions=u,ee.set(n))}function E(u){r.$$.not_equal(n.summary.inspectorEmail,u)&&(n.summary.inspectorEmail=u,ee.set(n))}function C(u){r.$$.not_equal(n.summary.schemeAreaSizeKm2,u)&&(n.summary.schemeAreaSizeKm2=u,ee.set(n))}function k(u){r.$$.not_equal(n.summary.notes,u)&&(n.summary.notes=u,ee.set(n))}return[n,i,o,a,l,s,m,v,h,P,p,g,E,C,k]}class pa extends ze{constructor(e){super(),Be(this,e,ea,$o,Le,{})}}export{pa as component};
