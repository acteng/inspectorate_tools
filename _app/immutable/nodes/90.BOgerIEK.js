import{s as we,v as X,e as H,t as Z,a as P,c as K,b as W,d as J,f as d,g as q,o as O,x as z,i as L,h as M,w as Q,k as ye,z as ze,U as He,S as Se,B as $e,m as ve,r as me,j as ae,n as Ke,O as be,P as ke}from"../chunks/scheduler.DH2GUgXz.js";import{S as Ie,i as Le,e as x,c as V,b as G,m as R,t as I,a as N,d as F,f as re,g as fe}from"../chunks/index.BHUn3u8Z.js";import{s as ge,d as de,M as We,f as Ye,b as Ze,C as Je,G as Xe,h as Qe}from"../chunks/index.D5MTNeEK.js";import{e as ie}from"../chunks/each.CZblyi7L.js";import{c as xe,p as et}from"../chunks/colors.CYEpEtTL.js";import{p as Ge}from"../chunks/index.BQCILISC.js";import{S as he}from"../chunks/Select.BObLJK-W.js";import{T as Re}from"../chunks/TextArea.Bfj0cJeT.js";import{T as Fe}from"../chunks/TextInput.CDomP4SG.js";import{s as Y}from"../chunks/data.XBuhxKPL.js";import{c as tt,p as lt}from"../chunks/lists.BnA5ucEg.js";import{Y as Te}from"../chunks/YesNo.fW5MmlsM.js";import{R as nt,B as it,G as ot,S as st,C as at,a as rt,M as Oe}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.9azZOhz4.js";import{D as ft,C as ut}from"../chunks/DefaultButton.DSpbdVzv.js";import{W as ct,S as pt}from"../chunks/WarningButton.DMIZkWvd.js";import{G as _t}from"../chunks/GeoreferenceLayer.m6UjNBeH.js";import"../chunks/paths.QSZq-5XT.js";import{C as Ue}from"../chunks/ClickableCard.Bn1EQJOx.js";/* empty css                                                               */function $t(t){let e,n,l,s,c,r,f,_,m,a,v,u,g,j,C,E,i,p,y,A,S,h,T,D;function oe(o){t[2](o)}let $={label:"Critical Issue",emptyOption:!0,choices:tt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&($.value=t[1].criticalIssues[t[0]].criticalIssue),a=new he({props:$}),X.push(()=>x(a,"value",oe));function b(o){t[3](o)}let U={label:"Stage",emptyOption:!0,choices:Ge(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(U.value=t[1].criticalIssues[t[0]].stage),g=new he({props:U}),X.push(()=>x(g,"value",b));function ne(o){t[4](o)}let B={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(B.value=t[1].criticalIssues[t[0]].locationName),E=new Fe({props:B}),X.push(()=>x(E,"value",ne));function ee(o){t[5](o)}let se={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(se.value=t[1].criticalIssues[t[0]].resolved),y=new Te({props:se}),X.push(()=>x(y,"value",ee));function ue(o){t[6](o)}let w={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(w.value=t[1].criticalIssues[t[0]].notes),h=new Re({props:w}),X.push(()=>x(h,"value",ue)),{c(){e=H("div"),n=H("a"),l=Z("Google StreetView"),c=P(),r=H("a"),f=Z("Bing Streetside"),m=P(),V(a.$$.fragment),u=P(),V(g.$$.fragment),C=P(),V(E.$$.fragment),p=P(),V(y.$$.fragment),S=P(),V(h.$$.fragment),this.h()},l(o){e=K(o,"DIV",{style:!0});var k=W(e);n=K(k,"A",{href:!0,target:!0});var te=W(n);l=J(te,"Google StreetView"),te.forEach(d),c=q(k),r=K(k,"A",{href:!0,target:!0});var le=W(r);f=J(le,"Bing Streetside"),le.forEach(d),k.forEach(d),m=q(o),G(a.$$.fragment,o),u=q(o),G(g.$$.fragment,o),C=q(o),G(E.$$.fragment,o),p=q(o),G(y.$$.fragment,o),S=q(o),G(h.$$.fragment,o),this.h()},h(){O(n,"href",s=ge(t[1].criticalIssues[t[0]].point)),O(n,"target","_blank"),O(r,"href",_=de(t[1].criticalIssues[t[0]].point)),O(r,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(o,k){L(o,e,k),M(e,n),M(n,l),M(e,c),M(e,r),M(r,f),L(o,m,k),R(a,o,k),L(o,u,k),R(g,o,k),L(o,C,k),R(E,o,k),L(o,p,k),R(y,o,k),L(o,S,k),R(h,o,k),D=!0},p(o,[k]){(!D||k&3&&s!==(s=ge(o[1].criticalIssues[o[0]].point)))&&O(n,"href",s),(!D||k&3&&_!==(_=de(o[1].criticalIssues[o[0]].point)))&&O(r,"href",_);const te={};!v&&k&3&&(v=!0,te.value=o[1].criticalIssues[o[0]].criticalIssue,Q(()=>v=!1)),a.$set(te);const le={};!j&&k&3&&(j=!0,le.value=o[1].criticalIssues[o[0]].stage,Q(()=>j=!1)),g.$set(le);const ce={};!i&&k&3&&(i=!0,ce.value=o[1].criticalIssues[o[0]].locationName,Q(()=>i=!1)),E.$set(ce);const pe={};!A&&k&3&&(A=!0,pe.value=o[1].criticalIssues[o[0]].resolved,Q(()=>A=!1)),y.$set(pe);const _e={};!T&&k&3&&(T=!0,_e.value=o[1].criticalIssues[o[0]].notes,Q(()=>T=!1)),h.$set(_e)},i(o){D||(I(a.$$.fragment,o),I(g.$$.fragment,o),I(E.$$.fragment,o),I(y.$$.fragment,o),I(h.$$.fragment,o),D=!0)},o(o){N(a.$$.fragment,o),N(g.$$.fragment,o),N(E.$$.fragment,o),N(y.$$.fragment,o),N(h.$$.fragment,o),D=!1},d(o){o&&(d(e),d(m),d(u),d(C),d(p),d(S)),F(a,o),F(g,o),F(E,o),F(y,o),F(h,o)}}}function mt(t,e,n){let l;ye(t,Y,a=>n(1,l=a));let{idx:s}=e;function c(a){t.$$.not_equal(l.criticalIssues[s].criticalIssue,a)&&(l.criticalIssues[s].criticalIssue=a,Y.set(l))}function r(a){t.$$.not_equal(l.criticalIssues[s].stage,a)&&(l.criticalIssues[s].stage=a,Y.set(l))}function f(a){t.$$.not_equal(l.criticalIssues[s].locationName,a)&&(l.criticalIssues[s].locationName=a,Y.set(l))}function _(a){t.$$.not_equal(l.criticalIssues[s].resolved,a)&&(l.criticalIssues[s].resolved=a,Y.set(l))}function m(a){t.$$.not_equal(l.criticalIssues[s].notes,a)&&(l.criticalIssues[s].notes=a,Y.set(l))}return t.$$set=a=>{"idx"in a&&n(0,s=a.idx)},[s,l,c,r,f,_,m]}class gt extends Ie{constructor(e){super(),Le(this,e,mt,$t,we,{idx:0})}}function dt(t){let e,n,l,s,c,r,f,_,m,a,v,u,g,j,C,E,i,p,y,A,S,h,T,D;function oe(o){t[2](o)}let $={label:"Policy Conflict",emptyOption:!0,choices:lt};t[1].policyConflictLog[t[0]].conflict!==void 0&&($.value=t[1].policyConflictLog[t[0]].conflict),a=new he({props:$}),X.push(()=>x(a,"value",oe));function b(o){t[3](o)}let U={label:"Stage",emptyOption:!0,choices:Ge(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(U.value=t[1].policyConflictLog[t[0]].stage),g=new he({props:U}),X.push(()=>x(g,"value",b));function ne(o){t[4](o)}let B={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(B.value=t[1].policyConflictLog[t[0]].locationName),E=new Fe({props:B}),X.push(()=>x(E,"value",ne));function ee(o){t[5](o)}let se={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(se.value=t[1].policyConflictLog[t[0]].resolved),y=new Te({props:se}),X.push(()=>x(y,"value",ee));function ue(o){t[6](o)}let w={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(w.value=t[1].policyConflictLog[t[0]].notes),h=new Re({props:w}),X.push(()=>x(h,"value",ue)),{c(){e=H("div"),n=H("a"),l=Z("Google StreetView"),c=P(),r=H("a"),f=Z("Bing Streetside"),m=P(),V(a.$$.fragment),u=P(),V(g.$$.fragment),C=P(),V(E.$$.fragment),p=P(),V(y.$$.fragment),S=P(),V(h.$$.fragment),this.h()},l(o){e=K(o,"DIV",{style:!0});var k=W(e);n=K(k,"A",{href:!0,target:!0});var te=W(n);l=J(te,"Google StreetView"),te.forEach(d),c=q(k),r=K(k,"A",{href:!0,target:!0});var le=W(r);f=J(le,"Bing Streetside"),le.forEach(d),k.forEach(d),m=q(o),G(a.$$.fragment,o),u=q(o),G(g.$$.fragment,o),C=q(o),G(E.$$.fragment,o),p=q(o),G(y.$$.fragment,o),S=q(o),G(h.$$.fragment,o),this.h()},h(){O(n,"href",s=ge(t[1].policyConflictLog[t[0]].point)),O(n,"target","_blank"),O(r,"href",_=de(t[1].policyConflictLog[t[0]].point)),O(r,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(o,k){L(o,e,k),M(e,n),M(n,l),M(e,c),M(e,r),M(r,f),L(o,m,k),R(a,o,k),L(o,u,k),R(g,o,k),L(o,C,k),R(E,o,k),L(o,p,k),R(y,o,k),L(o,S,k),R(h,o,k),D=!0},p(o,[k]){(!D||k&3&&s!==(s=ge(o[1].policyConflictLog[o[0]].point)))&&O(n,"href",s),(!D||k&3&&_!==(_=de(o[1].policyConflictLog[o[0]].point)))&&O(r,"href",_);const te={};!v&&k&3&&(v=!0,te.value=o[1].policyConflictLog[o[0]].conflict,Q(()=>v=!1)),a.$set(te);const le={};!j&&k&3&&(j=!0,le.value=o[1].policyConflictLog[o[0]].stage,Q(()=>j=!1)),g.$set(le);const ce={};!i&&k&3&&(i=!0,ce.value=o[1].policyConflictLog[o[0]].locationName,Q(()=>i=!1)),E.$set(ce);const pe={};!A&&k&3&&(A=!0,pe.value=o[1].policyConflictLog[o[0]].resolved,Q(()=>A=!1)),y.$set(pe);const _e={};!T&&k&3&&(T=!0,_e.value=o[1].policyConflictLog[o[0]].notes,Q(()=>T=!1)),h.$set(_e)},i(o){D||(I(a.$$.fragment,o),I(g.$$.fragment,o),I(E.$$.fragment,o),I(y.$$.fragment,o),I(h.$$.fragment,o),D=!0)},o(o){N(a.$$.fragment,o),N(g.$$.fragment,o),N(E.$$.fragment,o),N(y.$$.fragment,o),N(h.$$.fragment,o),D=!1},d(o){o&&(d(e),d(m),d(u),d(C),d(p),d(S)),F(a,o),F(g,o),F(E,o),F(y,o),F(h,o)}}}function ht(t,e,n){let l;ye(t,Y,a=>n(1,l=a));let{idx:s}=e;function c(a){t.$$.not_equal(l.policyConflictLog[s].conflict,a)&&(l.policyConflictLog[s].conflict=a,Y.set(l))}function r(a){t.$$.not_equal(l.policyConflictLog[s].stage,a)&&(l.policyConflictLog[s].stage=a,Y.set(l))}function f(a){t.$$.not_equal(l.policyConflictLog[s].locationName,a)&&(l.policyConflictLog[s].locationName=a,Y.set(l))}function _(a){t.$$.not_equal(l.policyConflictLog[s].resolved,a)&&(l.policyConflictLog[s].resolved=a,Y.set(l))}function m(a){t.$$.not_equal(l.policyConflictLog[s].notes,a)&&(l.policyConflictLog[s].notes=a,Y.set(l))}return t.$$set=a=>{"idx"in a&&n(0,s=a.idx)},[s,l,c,r,f,_,m]}class vt extends Ie{constructor(e){super(),Le(this,e,ht,dt,we,{idx:0})}}const{window:bt}=Ye;function Ne(t,e,n){const l=t.slice();return l[31]=e[n],l[32]=e,l[33]=n,l}function Ee(t,e,n){const l=t.slice();return l[34]=e[n],l[35]=e,l[33]=n,l}function De(t,e,n){const l=t.slice();return l[31]=e[n],l[33]=n,l}function je(t,e,n){const l=t.slice();return l[34]=e[n],l[33]=n,l}function kt(t){let e,n,l,s,c,r,f,_;e=new ft({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),e.$on("click",t[23]),l=new ct({props:{$$slots:{default:[yt]},$$scope:{ctx:t}}}),l.$on("click",t[10]);const m=[Lt,It],a=[];function v(u,g){return u[0].kind=="critical"?0:1}return c=v(t),r=a[c]=m[c](t),{c(){V(e.$$.fragment),n=P(),V(l.$$.fragment),s=P(),r.c(),f=$e()},l(u){G(e.$$.fragment,u),n=q(u),G(l.$$.fragment,u),s=q(u),r.l(u),f=$e()},m(u,g){R(e,u,g),L(u,n,g),R(l,u,g),L(u,s,g),a[c].m(u,g),L(u,f,g),_=!0},p(u,g){const j={};g[1]&128&&(j.$$scope={dirty:g,ctx:u}),e.$set(j);const C={};g[1]&128&&(C.$$scope={dirty:g,ctx:u}),l.$set(C);let E=c;c=v(u),c===E?a[c].p(u,g):(fe(),N(a[E],1,1,()=>{a[E]=null}),re(),r=a[c],r?r.p(u,g):(r=a[c]=m[c](u),r.c()),I(r,1),r.m(f.parentNode,f))},i(u){_||(I(e.$$.fragment,u),I(l.$$.fragment,u),I(r),_=!0)},o(u){N(e.$$.fragment,u),N(l.$$.fragment,u),N(r),_=!1},d(u){u&&(d(n),d(s),d(f)),F(e,u),F(l,u),a[c].d(u)}}}function Ct(t){let e,n,l,s,c,r,f="Click the map to add a problem, or select a problem to fill out data",_,m,a="Critical Issues",v,u,g,j="Policy Conflicts",C,E,i;e=new ut({props:{label:"Tools",$$slots:{default:[Et]},$$scope:{ctx:t}}});function p($){t[16]($)}let y={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[4]!==void 0&&(y.value=t[4]),l=new nt({props:y}),X.push(()=>x(l,"value",p));let A=ie(t[2].criticalIssues),S=[];for(let $=0;$<A.length;$+=1)S[$]=Be(je(t,A,$));const h=$=>N(S[$],1,1,()=>{S[$]=null});let T=ie(t[2].policyConflictLog),D=[];for(let $=0;$<T.length;$+=1)D[$]=Pe(De(t,T,$));const oe=$=>N(D[$],1,1,()=>{D[$]=null});return{c(){V(e.$$.fragment),n=P(),V(l.$$.fragment),c=P(),r=H("p"),r.textContent=f,_=P(),m=H("h3"),m.textContent=a,v=P();for(let $=0;$<S.length;$+=1)S[$].c();u=P(),g=H("h3"),g.textContent=j,C=P();for(let $=0;$<D.length;$+=1)D[$].c();E=$e()},l($){G(e.$$.fragment,$),n=q($),G(l.$$.fragment,$),c=q($),r=K($,"P",{"data-svelte-h":!0}),ve(r)!=="svelte-12ba5j2"&&(r.textContent=f),_=q($),m=K($,"H3",{"data-svelte-h":!0}),ve(m)!=="svelte-1qhh5xr"&&(m.textContent=a),v=q($);for(let b=0;b<S.length;b+=1)S[b].l($);u=q($),g=K($,"H3",{"data-svelte-h":!0}),ve(g)!=="svelte-eyxzjx"&&(g.textContent=j),C=q($);for(let b=0;b<D.length;b+=1)D[b].l($);E=$e()},m($,b){R(e,$,b),L($,n,b),R(l,$,b),L($,c,b),L($,r,b),L($,_,b),L($,m,b),L($,v,b);for(let U=0;U<S.length;U+=1)S[U]&&S[U].m($,b);L($,u,b),L($,g,b),L($,C,b);for(let U=0;U<D.length;U+=1)D[U]&&D[U].m($,b);L($,E,b),i=!0},p($,b){const U={};b[0]&104|b[1]&128&&(U.$$scope={dirty:b,ctx:$}),e.$set(U);const ne={};if(!s&&b[0]&16&&(s=!0,ne.value=$[4],Q(()=>s=!1)),l.$set(ne),b[0]&262){A=ie($[2].criticalIssues);let B;for(B=0;B<A.length;B+=1){const ee=je($,A,B);S[B]?(S[B].p(ee,b),I(S[B],1)):(S[B]=Be(ee),S[B].c(),I(S[B],1),S[B].m(u.parentNode,u))}for(fe(),B=A.length;B<S.length;B+=1)h(B);re()}if(b[0]&262){T=ie($[2].policyConflictLog);let B;for(B=0;B<T.length;B+=1){const ee=De($,T,B);D[B]?(D[B].p(ee,b),I(D[B],1)):(D[B]=Pe(ee),D[B].c(),I(D[B],1),D[B].m(E.parentNode,E))}for(fe(),B=T.length;B<D.length;B+=1)oe(B);re()}},i($){if(!i){I(e.$$.fragment,$),I(l.$$.fragment,$);for(let b=0;b<A.length;b+=1)I(S[b]);for(let b=0;b<T.length;b+=1)I(D[b]);i=!0}},o($){N(e.$$.fragment,$),N(l.$$.fragment,$),S=S.filter(Boolean);for(let b=0;b<S.length;b+=1)N(S[b]);D=D.filter(Boolean);for(let b=0;b<D.length;b+=1)N(D[b]);i=!1},d($){$&&(d(n),d(c),d(r),d(_),d(m),d(v),d(u),d(g),d(C),d(E)),F(e,$),F(l,$),me(S,$),me(D,$)}}}function wt(t){let e;return{c(){e=Z("Save")},l(n){e=J(n,"Save")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function yt(t){let e;return{c(){e=Z("Delete")},l(n){e=J(n,"Delete")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function It(t){let e,n;return e=new vt({props:{idx:t[0].idx}}),{c(){V(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){R(e,l,s),n=!0},p(l,s){const c={};s[0]&1&&(c.idx=l[0].idx),e.$set(c)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Lt(t){let e,n;return e=new gt({props:{idx:t[0].idx}}),{c(){V(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){R(e,l,s),n=!0},p(l,s){const c={};s[0]&1&&(c.idx=l[0].idx),e.$set(c)},i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function St(t){let e;return{c(){e=Z("Zoom to fit")},l(n){e=J(n,"Zoom to fit")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Nt(t){let e;return{c(){e=Z("Show scheme context")},l(n){e=J(n,"Show scheme context")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Et(t){let e,n,l,s,c,r,f,_,m,a,v,u;e=new pt({props:{$$slots:{default:[St]},$$scope:{ctx:t}}}),e.$on("click",t[13]),l=new it({}),c=new ot({});function g(i){t[14](i)}let j={map:t[3]};t[5]!==void 0&&(j.enabled=t[5]),f=new st({props:j}),X.push(()=>x(f,"enabled",g));function C(i){t[15](i)}let E={$$slots:{default:[Nt]},$$scope:{ctx:t}};return t[6]!==void 0&&(E.checked=t[6]),a=new at({props:E}),X.push(()=>x(a,"checked",C)),{c(){V(e.$$.fragment),n=P(),V(l.$$.fragment),s=P(),V(c.$$.fragment),r=P(),V(f.$$.fragment),m=P(),V(a.$$.fragment)},l(i){G(e.$$.fragment,i),n=q(i),G(l.$$.fragment,i),s=q(i),G(c.$$.fragment,i),r=q(i),G(f.$$.fragment,i),m=q(i),G(a.$$.fragment,i)},m(i,p){R(e,i,p),L(i,n,p),R(l,i,p),L(i,s,p),R(c,i,p),L(i,r,p),R(f,i,p),L(i,m,p),R(a,i,p),u=!0},p(i,p){const y={};p[1]&128&&(y.$$scope={dirty:p,ctx:i}),e.$set(y);const A={};p[0]&8&&(A.map=i[3]),!_&&p[0]&32&&(_=!0,A.enabled=i[5],Q(()=>_=!1)),f.$set(A);const S={};p[1]&128&&(S.$$scope={dirty:p,ctx:i}),!v&&p[0]&64&&(v=!0,S.checked=i[6],Q(()=>v=!1)),a.$set(S)},i(i){u||(I(e.$$.fragment,i),I(l.$$.fragment,i),I(c.$$.fragment,i),I(f.$$.fragment,i),I(a.$$.fragment,i),u=!0)},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),N(c.$$.fragment,i),N(f.$$.fragment,i),N(a.$$.fragment,i),u=!1},d(i){i&&(d(n),d(s),d(r),d(m)),F(e,i),F(l,i),F(c,i),F(f,i),F(a,i)}}}function Dt(t){let e,n,l,s=t[34].stage+"",c,r,f,_,m=t[34].resolved+"",a;return{c(){e=H("div"),n=H("span"),l=Z("Stage: "),c=Z(s),r=P(),f=H("span"),_=Z("Resolved: "),a=Z(m),this.h()},l(v){e=K(v,"DIV",{style:!0});var u=W(e);n=K(u,"SPAN",{});var g=W(n);l=J(g,"Stage: "),c=J(g,s),g.forEach(d),r=q(u),f=K(u,"SPAN",{});var j=W(f);_=J(j,"Resolved: "),a=J(j,m),j.forEach(d),u.forEach(d),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(v,u){L(v,e,u),M(e,n),M(n,l),M(n,c),M(e,r),M(e,f),M(f,_),M(f,a)},p(v,u){u[0]&4&&s!==(s=v[34].stage+"")&&ae(c,s),u[0]&4&&m!==(m=v[34].resolved+"")&&ae(a,m)},d(v){v&&d(e)}}}function Be(t){let e,n,l;function s(){return t[17](t[33])}function c(){return t[18](t[33])}return n=new Ue({props:{name:Me(t[34]),$$slots:{default:[Dt]},$$scope:{ctx:t}}}),n.$on("click",s),n.$on("mouseenter",c),n.$on("mouseleave",t[19]),{c(){e=H("li"),V(n.$$.fragment)},l(r){e=K(r,"LI",{});var f=W(e);G(n.$$.fragment,f),f.forEach(d)},m(r,f){L(r,e,f),R(n,e,null),l=!0},p(r,f){t=r;const _={};f[0]&4&&(_.name=Me(t[34])),f[0]&4|f[1]&128&&(_.$$scope={dirty:f,ctx:t}),n.$set(_)},i(r){l||(I(n.$$.fragment,r),l=!0)},o(r){N(n.$$.fragment,r),l=!1},d(r){r&&d(e),F(n)}}}function jt(t){let e,n,l,s=t[31].stage+"",c,r,f,_,m=t[31].resolved+"",a,v;return{c(){e=H("div"),n=H("span"),l=Z("Stage: "),c=Z(s),r=P(),f=H("span"),_=Z("Resolved: "),a=Z(m),v=P(),this.h()},l(u){e=K(u,"DIV",{style:!0});var g=W(e);n=K(g,"SPAN",{});var j=W(n);l=J(j,"Stage: "),c=J(j,s),j.forEach(d),r=q(g),f=K(g,"SPAN",{});var C=W(f);_=J(C,"Resolved: "),a=J(C,m),C.forEach(d),g.forEach(d),v=q(u),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(u,g){L(u,e,g),M(e,n),M(n,l),M(n,c),M(e,r),M(e,f),M(f,_),M(f,a),L(u,v,g)},p(u,g){g[0]&4&&s!==(s=u[31].stage+"")&&ae(c,s),g[0]&4&&m!==(m=u[31].resolved+"")&&ae(a,m)},d(u){u&&(d(e),d(v))}}}function Pe(t){let e,n;function l(){return t[20](t[33])}function s(){return t[21](t[33])}return e=new Ue({props:{name:Ve(t[31]),$$slots:{default:[jt]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",s),e.$on("mouseleave",t[22]),{c(){V(e.$$.fragment)},l(c){G(e.$$.fragment,c)},m(c,r){R(e,c,r),n=!0},p(c,r){t=c;const f={};r[0]&4&&(f.name=Ve(t[31])),r[0]&4|r[1]&128&&(f.$$scope={dirty:r,ctx:t}),e.$set(f)},i(c){n||(I(e.$$.fragment,c),n=!0)},o(c){N(e.$$.fragment,c),n=!1},d(c){F(e,c)}}}function Bt(t){let e,n,l,s=t[34].criticalIssue+"",c;return{c(){e=be("svg"),n=be("polygon"),l=be("text"),c=Z(s),this.h()},l(r){e=ke(r,"svg",{width:!0,height:!0,xmlns:!0});var f=W(e);n=ke(f,"polygon",{points:!0,fill:!0,class:!0}),W(n).forEach(d),l=ke(f,"text",{x:!0,y:!0});var _=W(l);c=J(_,s),_.forEach(d),f.forEach(d),this.h()},h(){O(n,"points","20,0 0,40 40,40"),O(n,"fill",xe.critical.background),O(n,"class","svelte-ktyu3j"),O(l,"x","13"),O(l,"y","30"),z(l,"fill","white"),O(e,"width","40"),O(e,"height","40"),O(e,"xmlns","http://www.w3.org/2000/svg")},m(r,f){L(r,e,f),M(e,n),M(e,l),M(l,c)},p(r,f){f[0]&4&&s!==(s=r[34].criticalIssue+"")&&ae(c,s)},d(r){r&&d(e)}}}function qe(t){let e,n,l;function s(_){t[24](_,t[34])}function c(){return t[25](t[33])}function r(){return t[26](t[33])}let f={draggable:!0,$$slots:{default:[Bt]},$$scope:{ctx:t}};return t[34].point!==void 0&&(f.lngLat=t[34].point),e=new Oe({props:f}),X.push(()=>x(e,"lngLat",s)),e.$on("click",c),e.$on("dragend",r),{c(){V(e.$$.fragment)},l(_){G(e.$$.fragment,_)},m(_,m){R(e,_,m),l=!0},p(_,m){t=_;const a={};m[0]&4|m[1]&128&&(a.$$scope={dirty:m,ctx:t}),!n&&m[0]&4&&(n=!0,a.lngLat=t[34].point,Q(()=>n=!1)),e.$set(a)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){F(e,_)}}}function Pt(t){let e,n=t[31].conflict+"",l;return{c(){e=H("span"),l=Z(n),this.h()},l(s){e=K(s,"SPAN",{class:!0});var c=W(e);l=J(c,n),c.forEach(d),this.h()},h(){O(e,"class","dot svelte-ktyu3j"),z(e,"background",et)},m(s,c){L(s,e,c),M(e,l)},p(s,c){c[0]&4&&n!==(n=s[31].conflict+"")&&ae(l,n)},d(s){s&&d(e)}}}function Ae(t){let e,n,l;function s(_){t[27](_,t[31])}function c(){return t[28](t[33])}function r(){return t[29](t[33])}let f={draggable:!0,$$slots:{default:[Pt]},$$scope:{ctx:t}};return t[31].point!==void 0&&(f.lngLat=t[31].point),e=new Oe({props:f}),X.push(()=>x(e,"lngLat",s)),e.$on("click",c),e.$on("dragend",r),{c(){V(e.$$.fragment)},l(_){G(e.$$.fragment,_)},m(_,m){R(e,_,m),l=!0},p(_,m){t=_;const a={};m[0]&4|m[1]&128&&(a.$$scope={dirty:m,ctx:t}),!n&&m[0]&4&&(n=!0,a.lngLat=t[31].point,Q(()=>n=!1)),e.$set(a)},i(_){l||(I(e.$$.fragment,_),l=!0)},o(_){N(e.$$.fragment,_),l=!1},d(_){F(e,_)}}}function qt(t){let e,n;return e=new Qe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){V(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,s){R(e,l,s),n=!0},p:Ke,i(l){n||(I(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function At(t){let e,n,l,s,c,r,f,_,m,a;e=new rt({}),e.$on("click",t[9]),l=new Je({props:{gj:t[2].summary.networkMap,show:t[6]}});let v=ie(t[2].criticalIssues),u=[];for(let i=0;i<v.length;i+=1)u[i]=qe(Ee(t,v,i));const g=i=>N(u[i],1,1,()=>{u[i]=null});let j=ie(t[2].policyConflictLog),C=[];for(let i=0;i<j.length;i+=1)C[i]=Ae(Ne(t,j,i));const E=i=>N(C[i],1,1,()=>{C[i]=null});return f=new Xe({props:{data:t[7],$$slots:{default:[qt]},$$scope:{ctx:t}}}),m=new _t({props:{map:t[3]}}),{c(){V(e.$$.fragment),n=P(),V(l.$$.fragment),s=P();for(let i=0;i<u.length;i+=1)u[i].c();c=P();for(let i=0;i<C.length;i+=1)C[i].c();r=P(),V(f.$$.fragment),_=P(),V(m.$$.fragment)},l(i){G(e.$$.fragment,i),n=q(i),G(l.$$.fragment,i),s=q(i);for(let p=0;p<u.length;p+=1)u[p].l(i);c=q(i);for(let p=0;p<C.length;p+=1)C[p].l(i);r=q(i),G(f.$$.fragment,i),_=q(i),G(m.$$.fragment,i)},m(i,p){R(e,i,p),L(i,n,p),R(l,i,p),L(i,s,p);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(i,p);L(i,c,p);for(let y=0;y<C.length;y+=1)C[y]&&C[y].m(i,p);L(i,r,p),R(f,i,p),L(i,_,p),R(m,i,p),a=!0},p(i,p){const y={};if(p[0]&4&&(y.gj=i[2].summary.networkMap),p[0]&64&&(y.show=i[6]),l.$set(y),p[0]&260){v=ie(i[2].criticalIssues);let h;for(h=0;h<v.length;h+=1){const T=Ee(i,v,h);u[h]?(u[h].p(T,p),I(u[h],1)):(u[h]=qe(T),u[h].c(),I(u[h],1),u[h].m(c.parentNode,c))}for(fe(),h=v.length;h<u.length;h+=1)g(h);re()}if(p[0]&260){j=ie(i[2].policyConflictLog);let h;for(h=0;h<j.length;h+=1){const T=Ne(i,j,h);C[h]?(C[h].p(T,p),I(C[h],1)):(C[h]=Ae(T),C[h].c(),I(C[h],1),C[h].m(r.parentNode,r))}for(fe(),h=j.length;h<C.length;h+=1)E(h);re()}const A={};p[0]&128&&(A.data=i[7]),p[1]&128&&(A.$$scope={dirty:p,ctx:i}),f.$set(A);const S={};p[0]&8&&(S.map=i[3]),m.$set(S)},i(i){if(!a){I(e.$$.fragment,i),I(l.$$.fragment,i);for(let p=0;p<v.length;p+=1)I(u[p]);for(let p=0;p<j.length;p+=1)I(C[p]);I(f.$$.fragment,i),I(m.$$.fragment,i),a=!0}},o(i){N(e.$$.fragment,i),N(l.$$.fragment,i),u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)N(u[p]);C=C.filter(Boolean);for(let p=0;p<C.length;p+=1)N(C[p]);N(f.$$.fragment,i),N(m.$$.fragment,i),a=!1},d(i){i&&(d(n),d(s),d(c),d(r),d(_)),F(e,i),F(l,i),me(u,i),me(C,i),F(f,i),F(m,i)}}}function Mt(t){let e,n,l,s,c,r,f,_,m,a,v;const u=[Ct,kt],g=[];function j(i,p){return i[0]==null?0:1}l=j(t),s=g[l]=u[l](t);function C(i){t[30](i)}let E={$$slots:{default:[At]},$$scope:{ctx:t}};return t[3]!==void 0&&(E.map=t[3]),f=new We({props:E}),X.push(()=>x(f,"map",C)),{c(){e=H("div"),n=H("div"),s.c(),c=P(),r=H("div"),V(f.$$.fragment),this.h()},l(i){e=K(i,"DIV",{style:!0});var p=W(e);n=K(p,"DIV",{style:!0});var y=W(n);s.l(y),y.forEach(d),c=q(p),r=K(p,"DIV",{style:!0});var A=W(r);G(f.$$.fragment,A),A.forEach(d),p.forEach(d),this.h()},h(){z(n,"width","30%"),z(n,"overflow-y","scroll"),z(n,"padding","10px"),z(n,"border","1px solid black"),z(r,"position","relative"),z(r,"width","70%"),z(e,"display","flex"),z(e,"height","80vh")},m(i,p){L(i,e,p),M(e,n),g[l].m(n,null),M(e,c),M(e,r),R(f,r,null),m=!0,a||(v=ze(bt,"keydown",t[12]),a=!0)},p(i,p){let y=l;l=j(i),l===y?g[l].p(i,p):(fe(),N(g[y],1,1,()=>{g[y]=null}),re(),s=g[l],s?s.p(i,p):(s=g[l]=u[l](i),s.c()),I(s,1),s.m(n,null));const A={};p[0]&204|p[1]&128&&(A.$$scope={dirty:p,ctx:i}),!_&&p[0]&8&&(_=!0,A.map=i[3],Q(()=>_=!1)),f.$set(A)},i(i){m||(I(s),I(f.$$.fragment,i),m=!0)},o(i){N(s),N(f.$$.fragment,i),m=!1},d(i){i&&d(e),g[l].d(),F(f),a=!1,v()}}}function Vt(t,e,n){let l={type:"FeatureCollection",features:[]},s=e??n;if(s!=null){let c=s.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(Ce(c[s.idx].point))}return l}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Me(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Ve(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function Gt(t,e,n){let l,s;ye(t,Y,w=>n(2,s=w));let c,r="critical",f=null,_=null,m=!1,a=!0;function v(w){n(0,f=w),n(1,_=null)}function u(w){if(!m){if(f!=null){n(0,f=null);return}r=="critical"?(Se(Y,s.criticalIssues=[...s.criticalIssues,{criticalIssue:"",stage:"",point:w.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),v({kind:"critical",idx:s.criticalIssues.length-1})):(Se(Y,s.policyConflictLog=[...s.policyConflictLog,{conflict:"",stage:"",point:w.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),v({kind:"conflict",idx:s.policyConflictLog.length-1}))}}He(()=>{j(!1)});function g(){window.confirm("Delete this entry?")&&(f.kind=="critical"?(s.criticalIssues.splice(f.idx,1),Y.set(s)):(s.policyConflictLog.splice(f.idx,1),Y.set(s)),n(0,f=null))}function j(w){let o={type:"FeatureCollection",features:[...s.criticalIssues.map(k=>Ce(k.point)),...s.policyConflictLog.map(k=>Ce(k.point)),...s.summary.networkMap.features]};o.features.length>0&&c.fitBounds(Ze(o),{padding:20,animate:w})}function C(w){if(f!=null&&w.key=="Escape")w.stopPropagation(),n(0,f=null);else if(f!=null&&w.key=="Delete"){let o=w.target.tagName;if(o=="INPUT"||o=="TEXTAREA")return;w.stopPropagation(),g()}}const E=()=>j(!0);function i(w){m=w,n(5,m)}function p(w){a=w,n(6,a)}function y(w){r=w,n(4,r)}const A=w=>v({kind:"critical",idx:w}),S=w=>n(1,_={kind:"critical",idx:w}),h=()=>n(1,_=null),T=w=>v({kind:"conflict",idx:w}),D=w=>n(1,_={kind:"conflict",idx:w}),oe=()=>n(1,_=null),$=()=>n(0,f=null);function b(w,o){t.$$.not_equal(o.point,w)&&(o.point=w,Y.set(s))}const U=w=>v({kind:"critical",idx:w}),ne=w=>v({kind:"critical",idx:w});function B(w,o){t.$$.not_equal(o.point,w)&&(o.point=w,Y.set(s))}const ee=w=>v({kind:"conflict",idx:w}),se=w=>v({kind:"conflict",idx:w});function ue(w){c=w,n(3,c)}return t.$$.update=()=>{t.$$.dirty[0]&7&&n(7,l=Vt(s,f,_))},[f,_,s,c,r,m,a,l,v,u,g,j,C,E,i,p,y,A,S,h,T,D,oe,$,b,U,ne,B,ee,se,ue]}class il extends Ie{constructor(e){super(),Le(this,e,Gt,Mt,we,{},null,[-1,-1])}}export{il as component};
