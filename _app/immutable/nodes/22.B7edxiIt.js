var pn=Object.defineProperty;var bn=(r,e,t)=>e in r?pn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var W=(r,e,t)=>(bn(r,typeof e!="symbol"?e+"":e,t),t);import{ad as _n,ae as wn,s as Ce,y as ye,i as H,f as N,U as Mn,k as de,W as ht,w as Ge,n as Oe,l as it,u as ot,m as at,o as st,p as x,r as j,I as ee,Z as Sn,K as Pn,a as Z,g as K,e as Ie,c as De,b as yt,q as et,x as Lt,h as V,t as Me,d as Se,j as Fr,A as Ln}from"../chunks/scheduler.BJRqm_YT.js";import{S as Be,i as ze,t as T,g as Je,b as z,f as Ue,e as $,c as O,a as I,m as D,d as q}from"../chunks/index.18SuDt2z.js";import{p as Qe}from"../chunks/index.CLbx_zmS.js";import{S as xe}from"../chunks/Select.BZaUknG-.js";import{T as ct}from"../chunks/TextArea.CDFsaoN6.js";import{T as mt}from"../chunks/TextInput.BDjywaHi.js";import{s as Q}from"../chunks/data.C0eTUkPz.js";import{D as kn}from"../chunks/DefaultButton.DUqytxqy.js";import{S as Mt}from"../chunks/SecondaryButton.2stnaXwc.js";import{W as En}from"../chunks/WarningButton.Dm1EdBVd.js";import{d as kt,M as Cn,G as Fn}from"../chunks/MapLibreMap.Ck6raeBt.js";import{F as An}from"../chunks/FillLayer.CEAai0F0.js";import{e as Tn,a as Bn}from"../chunks/index.d-adz-yj.js";import{c as zn,a as Tt,g as Rn}from"../chunks/_commonjsHelpers.BosuxZz1.js";import{w as tt}from"../chunks/entry.SbABDEL3.js";import{a as On,t as In,r as Dn,f as qn,d as Xn}from"../chunks/lists.Ci0sBo6t.js";import{D as Yn}from"../chunks/DecimalInput.BT6q_0-L.js";var Nn=Object.defineProperty,G=(r,e)=>Nn(r,"name",{value:e,configurable:!0}),Gn=class{constructor(e){this.direction=!1,this.compareProperties=!0;var t,n,i;this.precision=10**-((t=e==null?void 0:e.precision)!=null?t:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(i=e==null?void 0:e.compareProperties)!=null?i:!0}compare(e,t){if(e.type!==t.type||!$e(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates);case"Polygon":return this.comparePolygon(e,t);case"GeometryCollection":return this.compareGeometryCollection(e,t);case"Feature":return this.compareFeature(e,t);case"FeatureCollection":return this.compareFeatureCollection(e,t);default:if(e.type.startsWith("Multi")){const n=Et(e),i=Et(t);return n.every(o=>i.some(a=>this.compare(o,a)))}}return!1}compareCoord(e,t){return e.length===t.length&&e.every((n,i)=>Math.abs(n-t[i])<this.precision)}compareLine(e,t,n=0,i=!1){if(!$e(e,t))return!1;const o=e;let a=t;if(i&&!this.compareCoord(o[0],a[0])){const l=this.fixStartIndex(a,o);if(l)a=l;else return!1}const s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}fixStartIndex(e,t){let n,i=-1;for(let o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){i=o;break}return i>=0&&(n=[].concat(e.slice(i,e.length),e.slice(1,i+1))),n}comparePath(e,t){return e.every((n,i)=>this.compareCoord(n,t[i]))}comparePolygon(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),i=t.coordinates.slice(1,t.coordinates.length);return n.every(o=>i.some(a=>this.compareLine(o,a,1,!0)))}return!1}compareGeometryCollection(e,t){return $e(e.geometries,t.geometries)&&this.compareBBox(e,t)&&e.geometries.every((n,i)=>this.compare(n,t.geometries[i]))}compareFeature(e,t){return e.id===t.id&&(this.compareProperties?Tn(e.properties,t.properties):!0)&&this.compareBBox(e,t)&&this.compare(e.geometry,t.geometry)}compareFeatureCollection(e,t){return $e(e.features,t.features)&&this.compareBBox(e,t)&&e.features.every((n,i)=>this.compare(n,t.features[i]))}compareBBox(e,t){return!e.bbox&&!t.bbox||(e.bbox&&t.bbox?this.compareCoord(e.bbox,t.bbox):!1)}};G(Gn,"GeojsonEquality");function $e(r,e){return r.coordinates?r.coordinates.length===e.coordinates.length:r.length===e.length}G($e,"sameLength");function Et(r){return r.coordinates.map(e=>({type:r.type.replace("Multi",""),coordinates:e}))}G(Et,"explode");var ae=63710088e-1,Ar={centimeters:ae*100,centimetres:ae*100,degrees:360/(2*Math.PI),feet:ae*3.28084,inches:ae*39.37,kilometers:ae/1e3,kilometres:ae/1e3,meters:ae,metres:ae,miles:ae/1609.344,millimeters:ae*1e3,millimetres:ae*1e3,nauticalmiles:ae/1852,radians:1,yards:ae*1.0936},gr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Ee(r,e,t={}){const n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}G(Ee,"feature");function Hn(r,e,t={}){switch(r){case"Point":return Ae(e).geometry;case"LineString":return Te(e).geometry;case"Polygon":return Bt(e).geometry;case"MultiPoint":return Br(e).geometry;case"MultiLineString":return Tr(e).geometry;case"MultiPolygon":return zr(e).geometry;default:throw new Error(r+" is invalid")}}G(Hn,"geometry");function Ae(r,e,t={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!dt(r[0])||!dt(r[1]))throw new Error("coordinates must contain numbers");return Ee({type:"Point",coordinates:r},e,t)}G(Ae,"point");function Jn(r,e,t={}){return pt(r.map(n=>Ae(n,e)),t)}G(Jn,"points");function Bt(r,e,t={}){for(const i of r){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return Ee({type:"Polygon",coordinates:r},e,t)}G(Bt,"polygon");function Un(r,e,t={}){return pt(r.map(n=>Bt(n,e)),t)}G(Un,"polygons");function Te(r,e,t={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return Ee({type:"LineString",coordinates:r},e,t)}G(Te,"lineString");function Zn(r,e,t={}){return pt(r.map(n=>Te(n,e)),t)}G(Zn,"lineStrings");function pt(r,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}G(pt,"featureCollection");function Tr(r,e,t={}){return Ee({type:"MultiLineString",coordinates:r},e,t)}G(Tr,"multiLineString");function Br(r,e,t={}){return Ee({type:"MultiPoint",coordinates:r},e,t)}G(Br,"multiPoint");function zr(r,e,t={}){return Ee({type:"MultiPolygon",coordinates:r},e,t)}G(zr,"multiPolygon");function Kn(r,e,t={}){return Ee({type:"GeometryCollection",geometries:r},e,t)}G(Kn,"geometryCollection");function Vn(r,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const t=Math.pow(10,e||0);return Math.round(r*t)/t}G(Vn,"round");function Rr(r,e="kilometers"){const t=Ar[e];if(!t)throw new Error(e+" units is invalid");return r*t}G(Rr,"radiansToLength");function zt(r,e="kilometers"){const t=Ar[e];if(!t)throw new Error(e+" units is invalid");return r/t}G(zt,"lengthToRadians");function Wn(r,e){return Or(zt(r,e))}G(Wn,"lengthToDegrees");function Qn(r){let e=r%360;return e<0&&(e+=360),e}G(Qn,"bearingToAzimuth");function Or(r){return r%(2*Math.PI)*180/Math.PI}G(Or,"radiansToDegrees");function xn(r){return r%360*Math.PI/180}G(xn,"degreesToRadians");function jn(r,e="kilometers",t="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return Rr(zt(r,e),t)}G(jn,"convertLength");function $n(r,e="meters",t="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const n=gr[e];if(!n)throw new Error("invalid original units");const i=gr[t];if(!i)throw new Error("invalid final units");return r/n*i}G($n,"convertArea");function dt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}G(dt,"isNumber");function Rt(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}G(Rt,"isObject");function ei(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(e=>{if(!dt(e))throw new Error("bbox must only contain numbers")})}G(ei,"validateBBox");function ti(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}G(ti,"validateId");var ri=Object.defineProperty,re=(r,e)=>ri(r,"name",{value:e,configurable:!0});function lt(r,e,t){if(r!==null)for(var n,i,o,a,s,l,c,g=0,m=0,L,p=r.type,v=p==="FeatureCollection",E=p==="Feature",C=v?r.features.length:1,k=0;k<C;k++){c=v?r.features[k].geometry:E?r.geometry:r,L=c?c.type==="GeometryCollection":!1,s=L?c.geometries.length:1;for(var u=0;u<s;u++){var f=0,h=0;if(a=L?c.geometries[u]:c,a!==null){l=a.coordinates;var y=a.type;switch(g=t&&(y==="Polygon"||y==="MultiPolygon")?1:0,y){case null:break;case"Point":if(e(l,m,k,f,h)===!1)return!1;m++,f++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],m,k,f,h)===!1)return!1;m++,y==="MultiPoint"&&f++}y==="LineString"&&f++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-g;i++){if(e(l[n][i],m,k,f,h)===!1)return!1;m++}y==="MultiLineString"&&f++,y==="Polygon"&&h++}y==="Polygon"&&f++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(h=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-g;o++){if(e(l[n][i][o],m,k,f,h)===!1)return!1;m++}h++}f++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(lt(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}re(lt,"coordEach");function ni(r,e,t,n){var i=t;return lt(r,function(o,a,s,l,c){a===0&&t===void 0?i=o:i=e(i,o,a,s,l,c)},n),i}re(ni,"coordReduce");function Ir(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}re(Ir,"propEach");function ii(r,e,t){var n=t;return Ir(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}re(ii,"propReduce");function Dr(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}re(Dr,"featureEach");function oi(r,e,t){var n=t;return Dr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}re(oi,"featureReduce");function ai(r){var e=[];return lt(r,function(t){e.push(t)}),e}re(ai,"coordAll");function Ot(r,e){var t,n,i,o,a,s,l,c,g,m,L=0,p=r.type==="FeatureCollection",v=r.type==="Feature",E=p?r.features.length:1;for(t=0;t<E;t++){for(s=p?r.features[t].geometry:v?r.geometry:r,c=p?r.features[t].properties:v?r.properties:{},g=p?r.features[t].bbox:v?r.bbox:void 0,m=p?r.features[t].id:v?r.id:void 0,l=s?s.type==="GeometryCollection":!1,a=l?s.geometries.length:1,i=0;i<a;i++){if(o=l?s.geometries[i]:s,o===null){if(e(null,L,c,g,m)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,L,c,g,m)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],L,c,g,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}re(Ot,"geomEach");function qr(r,e,t){var n=t;return Ot(r,function(i,o,a,s,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,s,l)}),n}re(qr,"geomReduce");function bt(r,e){Ot(r,function(t,n,i,o,a){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Ee(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var c=0;c<t.coordinates.length;c++){var g=t.coordinates[c],m={type:l,coordinates:g};if(e(Ee(m,i),n,c)===!1)return!1}})}re(bt,"flattenEach");function si(r,e,t){var n=t;return bt(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}re(si,"flattenReduce");function Xr(r,e){bt(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var s,l=0,c=0,g=0;if(lt(t,function(m,L,p,v,E){if(s===void 0||n>l||v>c||E>g){s=m,l=n,c=v,g=E,o=0;return}var C=Te([s,m],t.properties);if(e(C,n,i,E,o)===!1)return!1;o++,s=m})===!1)return!1}}})}re(Xr,"segmentEach");function li(r,e,t){var n=t,i=!1;return Xr(r,function(o,a,s,l,c){i===!1&&t===void 0?n=o:n=e(n,o,a,s,l,c),i=!0}),n}re(li,"segmentReduce");function Yr(r,e){if(!r)throw new Error("geojson is required");bt(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(e(Te(a[s],t.properties),n,i,s)===!1)return!1;break}}})}re(Yr,"lineEach");function ui(r,e,t){var n=t;return Yr(r,function(i,o,a,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,s)}),n}re(ui,"lineReduce");function fi(r,e){if(e=e||{},!Rt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=l.length+o-1),Te([l[o],l[o+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o-1),Te([l[i][o],l[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o-1),Te([l[n][o],l[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o-1),Te([l[n][i][o],l[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}re(fi,"findSegment");function ci(r,e){if(e=e||{},!Rt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":return Ae(l,a,e);case"MultiPoint":return n<0&&(n=l.length+n),Ae(l[n],a,e);case"LineString":return o<0&&(o=l.length+o),Ae(l[o],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),Ae(l[i][o],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o),Ae(l[n][o],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o),Ae(l[n][i][o],a,e)}throw new Error("geojson is invalid")}re(ci,"findPoint");var mi=Object.defineProperty,_t=(r,e)=>mi(r,"name",{value:e,configurable:!0});function Nr(r){return qr(r,(e,t)=>e+Gr(t),0)}_t(Nr,"area");function Gr(r){let e=0,t;switch(r.type){case"Polygon":return Ct(r.coordinates);case"MultiPolygon":for(t=0;t<r.coordinates.length;t++)e+=Ct(r.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}_t(Gr,"calculateArea");function Ct(r){let e=0;if(r&&r.length>0){e+=Math.abs(Ft(r[0]));for(let t=1;t<r.length;t++)e-=Math.abs(Ft(r[t]))}return e}_t(Ct,"polygonArea");var hi=ae*ae/2,St=Math.PI/180;function Ft(r){const e=r.length;if(e<=2)return 0;let t=0,n=0;for(;n<e;){const i=r[n],o=r[n+1===e?0:n+1],a=r[n+2>=e?(n+2)%e:n+2],s=i[0]*St,l=o[1]*St,c=a[0]*St;t+=(c-s)*Math.sin(l),n++}return t*hi}_t(Ft,"ringArea");var vr=Nr,ie=63710088e-1,It={centimeters:ie*100,centimetres:ie*100,degrees:ie/111325,feet:ie*3.28084,inches:ie*39.37,kilometers:ie/1e3,kilometres:ie/1e3,meters:ie,metres:ie,miles:ie/1609.344,millimeters:ie*1e3,millimetres:ie*1e3,nauticalmiles:ie/1852,radians:1,yards:ie*1.0936},di={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ie,yards:1.0936133},At={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function pe(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function gi(r,e,t){switch(r){case"Point":return ue(e).geometry;case"LineString":return ge(e).geometry;case"Polygon":return Dt(e).geometry;case"MultiPoint":return Jr(e).geometry;case"MultiLineString":return Hr(e).geometry;case"MultiPolygon":return Ur(e).geometry;default:throw new Error(r+" is invalid")}}function ue(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gt(r[0])||!gt(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return pe(n,e,t)}function vi(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return ue(n,e)}),t)}function Dt(r,e,t){t===void 0&&(t={});for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:r};return pe(s,e,t)}function yi(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return Dt(n,e)}),t)}function ge(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return pe(n,e,t)}function pi(r,e,t){return t===void 0&&(t={}),qe(r.map(function(n){return ge(n,e)}),t)}function qe(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function Hr(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return pe(n,e,t)}function Jr(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return pe(n,e,t)}function Ur(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return pe(n,e,t)}function bi(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return pe(n,e,t)}function _i(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function qt(r,e){e===void 0&&(e="kilometers");var t=It[e];if(!t)throw new Error(e+" units is invalid");return r*t}function wt(r,e){e===void 0&&(e="kilometers");var t=It[e];if(!t)throw new Error(e+" units is invalid");return r/t}function wi(r,e){return rt(wt(r,e))}function Mi(r){var e=r%360;return e<0&&(e+=360),e}function rt(r){var e=r%(2*Math.PI);return e*180/Math.PI}function ve(r){var e=r%360;return e*Math.PI/180}function Si(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return qt(wt(r,e),t)}function Pi(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=At[e];if(!n)throw new Error("invalid original units");var i=At[t];if(!i)throw new Error("invalid final units");return r/n*i}function gt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function Xt(r){return!!r&&r.constructor===Object}function Li(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!gt(e))throw new Error("bbox must only contain numbers")})}function ki(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const Ei=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:At,bearingToAzimuth:Mi,convertArea:Pi,convertLength:Si,degreesToRadians:ve,earthRadius:ie,factors:It,feature:pe,featureCollection:qe,geometry:gi,geometryCollection:bi,isNumber:gt,isObject:Xt,lengthToDegrees:wi,lengthToRadians:wt,lineString:ge,lineStrings:pi,multiLineString:Hr,multiPoint:Jr,multiPolygon:Ur,point:ue,points:vi,polygon:Dt,polygons:yi,radiansToDegrees:rt,radiansToLength:qt,round:_i,unitsFactors:di,validateBBox:Li,validateId:ki},Symbol.toStringTag,{value:"Module"}));function nt(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Zr(r,e,t){if(t===void 0&&(t={}),t.final===!0)return Ci(r,e);var n=nt(r),i=nt(e),o=ve(n[0]),a=ve(i[0]),s=ve(n[1]),l=ve(i[1]),c=Math.sin(a-o)*Math.cos(l),g=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return rt(Math.atan2(c,g))}function Ci(r,e){var t=Zr(e,r);return t=(t+180)%360,t}function je(r,e,t){t===void 0&&(t={});var n=nt(r),i=nt(e),o=ve(i[1]-n[1]),a=ve(i[0]-n[0]),s=ve(n[1]),l=ve(i[1]),c=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(l);return qt(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),t.units)}function yr(r,e,t,n){n===void 0&&(n={});var i=nt(r),o=ve(i[0]),a=ve(i[1]),s=ve(t),l=wt(e,n.units),c=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(s)),g=o+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(c)),m=rt(g),L=rt(c);return ue([m,L],n.properties)}function ut(r,e,t){if(r!==null)for(var n,i,o,a,s,l,c,g=0,m=0,L,p=r.type,v=p==="FeatureCollection",E=p==="Feature",C=v?r.features.length:1,k=0;k<C;k++){c=v?r.features[k].geometry:E?r.geometry:r,L=c?c.type==="GeometryCollection":!1,s=L?c.geometries.length:1;for(var u=0;u<s;u++){var f=0,h=0;if(a=L?c.geometries[u]:c,a!==null){l=a.coordinates;var y=a.type;switch(g=t&&(y==="Polygon"||y==="MultiPolygon")?1:0,y){case null:break;case"Point":if(e(l,m,k,f,h)===!1)return!1;m++,f++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],m,k,f,h)===!1)return!1;m++,y==="MultiPoint"&&f++}y==="LineString"&&f++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-g;i++){if(e(l[n][i],m,k,f,h)===!1)return!1;m++}y==="MultiLineString"&&f++,y==="Polygon"&&h++}y==="Polygon"&&f++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(h=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-g;o++){if(e(l[n][i][o],m,k,f,h)===!1)return!1;m++}h++}f++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(ut(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Fi(r,e,t,n){var i=t;return ut(r,function(o,a,s,l,c){a===0&&t===void 0?i=o:i=e(i,o,a,s,l,c)},n),i}function Kr(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function Ai(r,e,t){var n=t;return Kr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function vt(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Ti(r,e,t){var n=t;return vt(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Bi(r){var e=[];return ut(r,function(t){e.push(t)}),e}function Yt(r,e){var t,n,i,o,a,s,l,c,g,m,L=0,p=r.type==="FeatureCollection",v=r.type==="Feature",E=p?r.features.length:1;for(t=0;t<E;t++){for(s=p?r.features[t].geometry:v?r.geometry:r,c=p?r.features[t].properties:v?r.properties:{},g=p?r.features[t].bbox:v?r.bbox:void 0,m=p?r.features[t].id:v?r.id:void 0,l=s?s.type==="GeometryCollection":!1,a=l?s.geometries.length:1,i=0;i<a;i++){if(o=l?s.geometries[i]:s,o===null){if(e(null,L,c,g,m)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,L,c,g,m)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],L,c,g,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function zi(r,e,t){var n=t;return Yt(r,function(i,o,a,s,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,s,l)}),n}function Ze(r,e){Yt(r,function(t,n,i,o,a){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(pe(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var c=0;c<t.coordinates.length;c++){var g=t.coordinates[c],m={type:l,coordinates:g};if(e(pe(m,i),n,c)===!1)return!1}})}function Ri(r,e,t){var n=t;return Ze(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}function Vr(r,e){Ze(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var s,l=0,c=0,g=0;if(ut(t,function(m,L,p,v,E){if(s===void 0||n>l||v>c||E>g){s=m,l=n,c=v,g=E,o=0;return}var C=ge([s,m],t.properties);if(e(C,n,i,E,o)===!1)return!1;o++,s=m})===!1)return!1}}})}function Oi(r,e,t){var n=t,i=!1;return Vr(r,function(o,a,s,l,c){i===!1&&t===void 0?n=o:n=e(n,o,a,s,l,c),i=!0}),n}function Wr(r,e){if(!r)throw new Error("geojson is required");Ze(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(e(ge(a[s],t.properties),n,i,s)===!1)return!1;break}}})}function Ii(r,e,t){var n=t;return Wr(r,function(i,o,a,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,s)}),n}function Di(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=l.length+o-1),ge([l[o],l[o+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o-1),ge([l[i][o],l[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o-1),ge([l[n][o],l[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o-1),ge([l[n][i][o],l[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}function qi(r,e){if(e=e||{},!Xt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":return ue(l,a,e);case"MultiPoint":return n<0&&(n=l.length+n),ue(l[n],a,e);case"LineString":return o<0&&(o=l.length+o),ue(l[o],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),ue(l[i][o],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o),ue(l[n][o],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o),ue(l[n][i][o],a,e)}throw new Error("geojson is invalid")}const Xi=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Bi,coordEach:ut,coordReduce:Fi,featureEach:vt,featureReduce:Ti,findPoint:qi,findSegment:Di,flattenEach:Ze,flattenReduce:Ri,geomEach:Yt,geomReduce:zi,lineEach:Wr,lineReduce:Ii,propEach:Kr,propReduce:Ai,segmentEach:Vr,segmentReduce:Oi},Symbol.toStringTag,{value:"Module"}));function pr(r){if(!r)throw new Error("geojson is required");var e=[];return Ze(r,function(t){Yi(t,e)}),qe(e)}function Yi(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=He(n);break;case"LineString":t=[He(n)]}t.forEach(function(i){var o=Ni(i,r.properties);o.forEach(function(a){a.id=e.length,e.push(a)})})}}function Ni(r,e){var t=[];return r.reduce(function(n,i){var o=ge([n,i],e);return o.bbox=Gi(n,i),t.push(o),i}),t}function Gi(r,e){var t=r[0],n=r[1],i=e[0],o=e[1],a=t<i?t:i,s=n<o?n:o,l=t>i?t:i,c=n>o?n:o;return[a,s,l,c]}var Nt={exports:{}},Qr={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(zn,function(){function t(u,f,h,y,S){(function _(P,B,F,d,w){for(;d>F;){if(d-F>600){var R=d-F+1,X=B-F+1,te=Math.log(R),J=.5*Math.exp(2*te/3),ne=.5*Math.sqrt(te*J*(R-J)/R)*(X-R/2<0?-1:1),oe=Math.max(F,Math.floor(B-X*J/R+ne)),se=Math.min(d,Math.floor(B+(R-X)*J/R+ne));_(P,B,oe,se,w)}var be=P[B],fe=F,U=d;for(n(P,F,B),w(P[d],be)>0&&n(P,F,d);fe<U;){for(n(P,fe,U),fe++,U--;w(P[fe],be)<0;)fe++;for(;w(P[U],be)>0;)U--}w(P[F],be)===0?n(P,F,U):n(P,++U,d),U<=B&&(F=U+1),B<=U&&(d=U-1)}})(u,f,h||0,y||u.length-1,S||i)}function n(u,f,h){var y=u[f];u[f]=u[h],u[h]=y}function i(u,f){return u<f?-1:u>f?1:0}var o=function(u){u===void 0&&(u=9),this._maxEntries=Math.max(4,u),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(u,f,h){if(!h)return f.indexOf(u);for(var y=0;y<f.length;y++)if(h(u,f[y]))return y;return-1}function s(u,f){l(u,0,u.children.length,f,u)}function l(u,f,h,y,S){S||(S=C(null)),S.minX=1/0,S.minY=1/0,S.maxX=-1/0,S.maxY=-1/0;for(var _=f;_<h;_++){var P=u.children[_];c(S,u.leaf?y(P):P)}return S}function c(u,f){return u.minX=Math.min(u.minX,f.minX),u.minY=Math.min(u.minY,f.minY),u.maxX=Math.max(u.maxX,f.maxX),u.maxY=Math.max(u.maxY,f.maxY),u}function g(u,f){return u.minX-f.minX}function m(u,f){return u.minY-f.minY}function L(u){return(u.maxX-u.minX)*(u.maxY-u.minY)}function p(u){return u.maxX-u.minX+(u.maxY-u.minY)}function v(u,f){return u.minX<=f.minX&&u.minY<=f.minY&&f.maxX<=u.maxX&&f.maxY<=u.maxY}function E(u,f){return f.minX<=u.maxX&&f.minY<=u.maxY&&f.maxX>=u.minX&&f.maxY>=u.minY}function C(u){return{children:u,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(u,f,h,y,S){for(var _=[f,h];_.length;)if(!((h=_.pop())-(f=_.pop())<=y)){var P=f+Math.ceil((h-f)/y/2)*y;t(u,P,f,h,S),_.push(f,P,P,h)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(u){var f=this.data,h=[];if(!E(u,f))return h;for(var y=this.toBBox,S=[];f;){for(var _=0;_<f.children.length;_++){var P=f.children[_],B=f.leaf?y(P):P;E(u,B)&&(f.leaf?h.push(P):v(u,B)?this._all(P,h):S.push(P))}f=S.pop()}return h},o.prototype.collides=function(u){var f=this.data;if(!E(u,f))return!1;for(var h=[];f;){for(var y=0;y<f.children.length;y++){var S=f.children[y],_=f.leaf?this.toBBox(S):S;if(E(u,_)){if(f.leaf||v(u,_))return!0;h.push(S)}}f=h.pop()}return!1},o.prototype.load=function(u){if(!u||!u.length)return this;if(u.length<this._minEntries){for(var f=0;f<u.length;f++)this.insert(u[f]);return this}var h=this._build(u.slice(),0,u.length-1,0);if(this.data.children.length)if(this.data.height===h.height)this._splitRoot(this.data,h);else{if(this.data.height<h.height){var y=this.data;this.data=h,h=y}this._insert(h,this.data.height-h.height-1,!0)}else this.data=h;return this},o.prototype.insert=function(u){return u&&this._insert(u,this.data.height-1),this},o.prototype.clear=function(){return this.data=C([]),this},o.prototype.remove=function(u,f){if(!u)return this;for(var h,y,S,_=this.data,P=this.toBBox(u),B=[],F=[];_||B.length;){if(_||(_=B.pop(),y=B[B.length-1],h=F.pop(),S=!0),_.leaf){var d=a(u,_.children,f);if(d!==-1)return _.children.splice(d,1),B.push(_),this._condense(B),this}S||_.leaf||!v(_,P)?y?(h++,_=y.children[h],S=!1):_=null:(B.push(_),F.push(h),h=0,y=_,_=_.children[0])}return this},o.prototype.toBBox=function(u){return u},o.prototype.compareMinX=function(u,f){return u.minX-f.minX},o.prototype.compareMinY=function(u,f){return u.minY-f.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(u){return this.data=u,this},o.prototype._all=function(u,f){for(var h=[];u;)u.leaf?f.push.apply(f,u.children):h.push.apply(h,u.children),u=h.pop();return f},o.prototype._build=function(u,f,h,y){var S,_=h-f+1,P=this._maxEntries;if(_<=P)return s(S=C(u.slice(f,h+1)),this.toBBox),S;y||(y=Math.ceil(Math.log(_)/Math.log(P)),P=Math.ceil(_/Math.pow(P,y-1))),(S=C([])).leaf=!1,S.height=y;var B=Math.ceil(_/P),F=B*Math.ceil(Math.sqrt(P));k(u,f,h,F,this.compareMinX);for(var d=f;d<=h;d+=F){var w=Math.min(d+F-1,h);k(u,d,w,B,this.compareMinY);for(var R=d;R<=w;R+=B){var X=Math.min(R+B-1,w);S.children.push(this._build(u,R,X,y-1))}}return s(S,this.toBBox),S},o.prototype._chooseSubtree=function(u,f,h,y){for(;y.push(f),!f.leaf&&y.length-1!==h;){for(var S=1/0,_=1/0,P=void 0,B=0;B<f.children.length;B++){var F=f.children[B],d=L(F),w=(R=u,X=F,(Math.max(X.maxX,R.maxX)-Math.min(X.minX,R.minX))*(Math.max(X.maxY,R.maxY)-Math.min(X.minY,R.minY))-d);w<_?(_=w,S=d<S?d:S,P=F):w===_&&d<S&&(S=d,P=F)}f=P||f.children[0]}var R,X;return f},o.prototype._insert=function(u,f,h){var y=h?u:this.toBBox(u),S=[],_=this._chooseSubtree(y,this.data,f,S);for(_.children.push(u),c(_,y);f>=0&&S[f].children.length>this._maxEntries;)this._split(S,f),f--;this._adjustParentBBoxes(y,S,f)},o.prototype._split=function(u,f){var h=u[f],y=h.children.length,S=this._minEntries;this._chooseSplitAxis(h,S,y);var _=this._chooseSplitIndex(h,S,y),P=C(h.children.splice(_,h.children.length-_));P.height=h.height,P.leaf=h.leaf,s(h,this.toBBox),s(P,this.toBBox),f?u[f-1].children.push(P):this._splitRoot(h,P)},o.prototype._splitRoot=function(u,f){this.data=C([u,f]),this.data.height=u.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(u,f,h){for(var y,S,_,P,B,F,d,w=1/0,R=1/0,X=f;X<=h-f;X++){var te=l(u,0,X,this.toBBox),J=l(u,X,h,this.toBBox),ne=(S=te,_=J,P=void 0,B=void 0,F=void 0,d=void 0,P=Math.max(S.minX,_.minX),B=Math.max(S.minY,_.minY),F=Math.min(S.maxX,_.maxX),d=Math.min(S.maxY,_.maxY),Math.max(0,F-P)*Math.max(0,d-B)),oe=L(te)+L(J);ne<w?(w=ne,y=X,R=oe<R?oe:R):ne===w&&oe<R&&(R=oe,y=X)}return y||h-f},o.prototype._chooseSplitAxis=function(u,f,h){var y=u.leaf?this.compareMinX:g,S=u.leaf?this.compareMinY:m;this._allDistMargin(u,f,h,y)<this._allDistMargin(u,f,h,S)&&u.children.sort(y)},o.prototype._allDistMargin=function(u,f,h,y){u.children.sort(y);for(var S=this.toBBox,_=l(u,0,f,S),P=l(u,h-f,h,S),B=p(_)+p(P),F=f;F<h-f;F++){var d=u.children[F];c(_,u.leaf?S(d):d),B+=p(_)}for(var w=h-f-1;w>=f;w--){var R=u.children[w];c(P,u.leaf?S(R):R),B+=p(P)}return B},o.prototype._adjustParentBBoxes=function(u,f,h){for(var y=h;y>=0;y--)c(f[y],u)},o.prototype._condense=function(u){for(var f=u.length-1,h=void 0;f>=0;f--)u[f].children.length===0?f>0?(h=u[f-1].children).splice(h.indexOf(u[f]),1):this.clear():s(u[f],this.toBBox)},o})})(Qr);var Hi=Qr.exports;const Ji=Tt(Ei),Ui=Tt(Xi),Zi=Tt(Bn);var ke=Hi,xr=Ji,jr=Ui,Ne=Zi.default,Ki=jr.featureEach;jr.coordEach;xr.polygon;var br=xr.featureCollection;function $r(r){var e=new ke(r);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Ne(t),ke.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ne(i),n.push(i)}):Ki(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ne(i),n.push(i)}),ke.prototype.load.call(this,n)},e.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Ne(t),ke.prototype.remove.call(this,t,n)},e.clear=function(){return ke.prototype.clear.call(this)},e.search=function(t){var n=ke.prototype.search.call(this,this.toBBox(t));return br(n)},e.collides=function(t){return ke.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=ke.prototype.all.call(this);return br(t)},e.toJSON=function(){return ke.prototype.toJSON.call(this)},e.fromJSON=function(t){return ke.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=Ne(t);else if(t.type==="FeatureCollection")n=Ne(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},e}Nt.exports=$r;Nt.exports.default=$r;var Vi=Nt.exports;const Wi=Rn(Vi);function Qi(r,e){var t={},n=[];if(r.type==="LineString"&&(r=pe(r)),e.type==="LineString"&&(e=pe(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=_r(r,e);return i&&n.push(i),qe(n)}var o=Wi();return o.load(pr(e)),vt(pr(r),function(a){vt(o.search(a),function(s){var l=_r(a,s);if(l){var c=He(l).join(",");t[c]||(t[c]=!0,n.push(l))}})}),qe(n)}function _r(r,e){var t=He(r),n=He(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],a=t[1][0],s=t[1][1],l=n[0][0],c=n[0][1],g=n[1][0],m=n[1][1],L=(m-c)*(a-i)-(g-l)*(s-o),p=(g-l)*(o-c)-(m-c)*(i-l),v=(a-i)*(o-c)-(s-o)*(i-l);if(L===0)return null;var E=p/L,C=v/L;if(E>=0&&E<=1&&C>=0&&C<=1){var k=i+E*(a-i),u=o+E*(s-o);return ue([k,u])}return null}function xi(r,e,t){t===void 0&&(t={});var n=ue([1/0,1/0],{dist:1/0}),i=0;return Ze(r,function(o){for(var a=He(o),s=0;s<a.length-1;s++){var l=ue(a[s]);l.properties.dist=je(e,l,t);var c=ue(a[s+1]);c.properties.dist=je(e,c,t);var g=je(l,c,t),m=Math.max(l.properties.dist,c.properties.dist),L=Zr(l,c),p=yr(e,m,L+90,t),v=yr(e,m,L-90,t),E=Qi(ge([p.geometry.coordinates,v.geometry.coordinates]),ge([l.geometry.coordinates,c.geometry.coordinates])),C=null;E.features.length>0&&(C=E.features[0],C.properties.dist=je(e,C,t),C.properties.location=i+je(l,C,t)),l.properties.dist<n.properties.dist&&(n=l,n.properties.index=s,n.properties.location=i),c.properties.dist<n.properties.dist&&(n=c,n.properties.index=s+1,n.properties.location=i+g),C&&C.properties.dist<n.properties.dist&&(n=C,n.properties.index=s),i+=g}}),n}const ji=["==",["geometry-type"],"Polygon"],$i=["==",["geometry-type"],"LineString"],eo=["==",["geometry-type"],"Point"];function Pt(r){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:en(r)}}}function en(r){return[Math.round(r[0]*1e7)/1e7,Math.round(r[1]*1e7)/1e7]}const tn=tt({type:"FeatureCollection",features:[]}),rn=tt(0),to=100;class ro{constructor(e){W(this,"map");W(this,"active");W(this,"eventListenersSuccess");W(this,"eventListenersUpdated");W(this,"eventListenersFailure");W(this,"points");W(this,"cursor");W(this,"hover");W(this,"dragFrom");W(this,"previousStates");W(this,"onMouseMove",e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,n=this.dragFrom[1]-e.lngLat.lat;for(let i of this.points)i[0]-=t,i[1]-=n}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}});W(this,"onClick",e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(wr(this.points).forEach((n,i)=>{t.push([i+1,xi(n,this.cursor).properties.dist])}),t.sort((n,i)=>n[1]-i[1]),t.length>0){let n=t[0][0];this.points.splice(n,0,this.cursor.geometry.coordinates),this.hover=n}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))});W(this,"onDoubleClick",e=>{this.active&&(e.preventDefault(),this.cursor=Pt(e.lngLat.toArray()),this.onClick(e),this.finish())});W(this,"onMouseDown",e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())});W(this,"onMouseUp",()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())});W(this,"onKeypress",e=>{this.active&&(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())});W(this,"onKeyDown",e=>{this.active&&e.key=="Escape"&&(e.stopPropagation(),this.cancel())});this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e={type:"FeatureCollection",features:[]};this.points.forEach((i,o)=>{let a=Pt(i);a.properties.hover=this.hover==o,a.properties.idx=o,e.features.push(a)}),e.features=e.features.concat(wr(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),tn.set(e);let n="crosshair";this.hover!=null&&(n=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=n,rn.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=Pt(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(en),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>to&&this.previousStates.shift()}}function wr(r){let e=[];for(let t=0;t<r.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[t],r[t+1]]},properties:{}});return r.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[r.length-1],r[0]]},properties:{}}),e}let no=Date.now();function ft(r){return`${r}-${no++}`}const nn=Symbol.for("svelte-maplibre");function io(){return wn(nn)}function Mr(r){return{subscribe:r.subscribe}}function on({key:r,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:n=!1}){let i=io(),o=tt(null),a=Mr(o),s={...i,[r]:Mr(o)};if(e&&(s.popupTarget=a),n){let l=tt(null);s.layerEvent=l,i.layerEvent=l}return t&&(s.cluster=tt()),_n(nn,s),{...i,self:o}}function oo(){return on({key:"source",setCluster:!0})}function ao(r=!0){return on({key:"layer",setPopupTarget:r,setMouseEvent:r})}function Sr(r){let e;return t=>{if(t)for(let n in t){let i=e==null?void 0:e[n],o=t[n];i!==o&&r(n,o,i)}else if(e)for(let n in e)r(n,void 0,e[n]);e=t}}function so(r,...e){let t=[r];for(let n of e)if(n)Array.isArray(n)&&n[0]===r?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function lo(r){return r===!0?["has","point_count"]:r===!1?["!",["has","point_count"]]:void 0}function Pr(r){let e=r[0],t,n,i=Lr(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),H(o,t,a),n=!0},p(o,a){a[0]&1&&Ce(e,e=o[0])?(Je(),z(i,1,1,Oe),Ue(),i=Lr(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){z(i),n=!1},d(o){o&&N(t),i.d(o)}}}function Lr(r){let e;const t=r[36].default,n=it(t,r,r[35],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o[1]&16)&&ot(n,t,i,i[35],e?st(t,i[35],o,null):at(i[35]),null)},i(i){e||(T(n,i),e=!0)},o(i){z(n,i),e=!1},d(i){n&&n.d(i)}}}function uo(r){let e,t,n=r[0]&&Pr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),H(i,e,o),t=!0},p(i,o){i[0]?n?(n.p(i,o),o[0]&1&&T(n,1)):(n=Pr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),z(n,1,1,()=>{n=null}),Ue())},i(i){t||(T(n),t=!0)},o(i){z(n),t=!1},d(i){i&&N(e),n&&n.d(i)}}}function fo(r,e,t){let n,i,o,a,s,l,c,g,m,L,p,v,{$$slots:E={},$$scope:C}=e,{id:k=ft("layer")}=e,{source:u=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:h=void 0}=e,{beforeLayerType:y=void 0}=e,{type:S}=e,{paint:_=void 0}=e,{layout:P=void 0}=e,{filter:B=void 0}=e,{applyToClusters:F=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:w=void 0}=e,{manageHoverState:R=!1}=e,{hovered:X=null}=e,{interactive:te=!0}=e,{hoverCursor:J=void 0}=e,{eventsIfTopMost:ne=!1}=e;const oe=Mn(),{map:se,source:be,self:fe,minzoom:U,maxzoom:Xe,eventTopMost:Re,layerInfo:ce}=ao();de(r,se,M=>t(31,m=M)),de(r,be,M=>t(32,L=M)),de(r,fe,M=>t(0,g=M)),de(r,U,M=>t(34,v=M)),de(r,Xe,M=>t(33,p=M)),ht(()=>{g&&m&&(ce.delete(g),m==null||m.removeLayer(g))});let le;function Pe(M){var me,Le;if(!te||!g||!m||ne&&Re(M)!==g)return;let Y=M.features??[],he=(Le=(me=Y[0])==null?void 0:me.properties)==null?void 0:Le.cluster_id,we={event:M,map:m,clusterId:he,layer:g,source:s,features:Y};oe(M.type,we)}function Fe(M){var me,Le;if(!te||!g||!m||ne&&Re(M)!==g)return;J&&(m.getCanvas().style.cursor=J);let Y=M.features??[];t(6,X=Y[0]??null);let he=(Le=(me=Y[0])==null?void 0:me.properties)==null?void 0:Le.cluster_id;oe("mouseenter",{event:M,map:m,clusterId:he,layer:g,source:s,features:Y})}function Ke(M){var me,Le,We;if(!te||!m)return;if(ne&&Re(M)!==g){t(6,X=null),R&&le!==void 0&&(m==null||m.setFeatureState({source:s,sourceLayer:f,id:le},{hover:!1}),le=void 0);return}m.getCanvas().style.cursor=J;let Y=M.features??[],he=(Le=(me=Y[0])==null?void 0:me.properties)==null?void 0:Le.cluster_id,we=(We=Y[0])==null?void 0:We.id;we!==le&&(R&&(le!==void 0&&(m==null||m.setFeatureState({source:s,id:le,sourceLayer:f},{hover:!1})),m==null||m.setFeatureState({source:s,id:we,sourceLayer:f},{hover:!0})),le=we,t(6,X=Y[0]??null)),oe("mousemove",{event:M,map:m,clusterId:he,layer:g,source:s,features:Y})}function Ye(M){if(!(!te||!g||!m)){if(J&&(m.getCanvas().style.cursor=""),t(6,X=null),R&&le!==void 0){const Y={source:s,id:le,sourceLayer:f};m==null||m.setFeatureState(Y,{hover:!1}),le=void 0}oe("mouseleave",{map:m,layer:g,source:s})}}let _e=!0;function Ve(M){m&&(m.off("click",M,Pe),m.off("dblclick",M,Pe),m.off("contextmenu",M,Pe),m.off("mouseenter",M,Fe),m.off("mousemove",M,Ke),m.off("mouseleave",M,Ye))}return ht(()=>{m&&g&&Ve(g)}),r.$$set=M=>{"id"in M&&t(7,k=M.id),"source"in M&&t(8,u=M.source),"sourceLayer"in M&&t(9,f=M.sourceLayer),"beforeId"in M&&t(10,h=M.beforeId),"beforeLayerType"in M&&t(11,y=M.beforeLayerType),"type"in M&&t(12,S=M.type),"paint"in M&&t(13,_=M.paint),"layout"in M&&t(14,P=M.layout),"filter"in M&&t(15,B=M.filter),"applyToClusters"in M&&t(16,F=M.applyToClusters),"minzoom"in M&&t(17,d=M.minzoom),"maxzoom"in M&&t(18,w=M.maxzoom),"manageHoverState"in M&&t(19,R=M.manageHoverState),"hovered"in M&&t(6,X=M.hovered),"interactive"in M&&t(20,te=M.interactive),"hoverCursor"in M&&t(21,J=M.hoverCursor),"eventsIfTopMost"in M&&t(22,ne=M.eventsIfTopMost),"$$scope"in M&&t(35,C=M.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65536&&t(30,n=lo(F)),r.$$.dirty[0]&1073774592&&t(24,i=so("all",n,B)),r.$$.dirty[0]&131072|r.$$.dirty[1]&8&&t(26,o=d??v),r.$$.dirty[0]&262144|r.$$.dirty[1]&4&&t(25,a=w??p),r.$$.dirty[0]&256|r.$$.dirty[1]&2&&t(29,s=u||L),r.$$.dirty[0]&654343809|r.$$.dirty[1]&1&&m&&g!==k&&s){g&&(Ve(g),ce.delete(g));let M=h;if(!h&&y){let Y=m.getStyle().layers,he=typeof y=="function"?y:me=>me.type===y,we=Y==null?void 0:Y.find(he);we&&(M=we.id)}Ge(fe,g=k,g),m.addLayer(kt({id:g,type:S,source:s,"source-layer":f,filter:i,paint:_,layout:P,minzoom:o,maxzoom:a}),M),t(23,_e=!0),m.on("click",g,Pe),m.on("dblclick",g,Pe),m.on("contextmenu",g,Pe),m.on("mouseenter",g,Fe),m.on("mousemove",g,Ke),m.on("mouseleave",g,Ye)}r.$$.dirty[0]&1048577&&g&&ce.set(g,{interactive:te}),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(28,l=g?Sr((M,Y)=>m==null?void 0:m.setPaintProperty(g,M,Y)):void 0),r.$$.dirty[0]&1|r.$$.dirty[1]&1&&t(27,c=g?Sr((M,Y)=>m==null?void 0:m.setLayoutProperty(g,M,Y)):void 0),r.$$.dirty[0]&268443648&&(l==null||l(_)),r.$$.dirty[0]&134234112&&(c==null||c(P)),r.$$.dirty[0]&100663297|r.$$.dirty[1]&1&&g&&(m==null||m.setLayerZoomRange(g,o,a)),r.$$.dirty[0]&25165825|r.$$.dirty[1]&1&&g&&(_e?t(23,_e=!1):m==null||m.setFilter(g,i))},[g,se,be,fe,U,Xe,X,k,u,f,h,y,S,_,P,B,F,d,w,R,te,J,ne,_e,i,a,o,c,l,s,n,m,L,p,v,C,E]}class Gt extends Be{constructor(e){super(),ze(this,e,fo,uo,Ce,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function co(r){let e;const t=r[16].default,n=it(t,r,r[24],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16777216)&&ot(n,t,i,i[24],e?st(t,i[24],o,null):at(i[24]),null)},i(i){e||(T(n,i),e=!0)},o(i){z(n,i),e=!1},d(i){n&&n.d(i)}}}function mo(r){let e,t,n;function i(a){r[17](a)}let o={id:r[1],type:"circle",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],applyToClusters:r[9],minzoom:r[10],maxzoom:r[11],hoverCursor:r[12],manageHoverState:r[13],eventsIfTopMost:r[14],interactive:r[15],$$slots:{default:[co]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),x.push(()=>$(e,"hovered",i)),e.$on("click",r[18]),e.$on("dblclick",r[19]),e.$on("contextmenu",r[20]),e.$on("mouseenter",r[21]),e.$on("mousemove",r[22]),e.$on("mouseleave",r[23]),{c(){O(e.$$.fragment)},l(a){I(e.$$.fragment,a)},m(a,s){D(e,a,s),n=!0},p(a,[s]){const l={};s&2&&(l.id=a[1]),s&4&&(l.source=a[2]),s&8&&(l.sourceLayer=a[3]),s&16&&(l.beforeId=a[4]),s&32&&(l.beforeLayerType=a[5]),s&64&&(l.paint=a[6]),s&128&&(l.layout=a[7]),s&256&&(l.filter=a[8]),s&512&&(l.applyToClusters=a[9]),s&1024&&(l.minzoom=a[10]),s&2048&&(l.maxzoom=a[11]),s&4096&&(l.hoverCursor=a[12]),s&8192&&(l.manageHoverState=a[13]),s&16384&&(l.eventsIfTopMost=a[14]),s&32768&&(l.interactive=a[15]),s&16777216&&(l.$$scope={dirty:s,ctx:a}),!t&&s&1&&(t=!0,l.hovered=a[0],j(()=>t=!1)),e.$set(l)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function ho(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("circle")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:l=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:g}=e,{layout:m=void 0}=e,{filter:L=void 0}=e,{applyToClusters:p=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:E=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:k=!1}=e,{hovered:u=null}=e,{eventsIfTopMost:f=!1}=e,{interactive:h=!0}=e;function y(w){u=w,t(0,u)}function S(w){ee.call(this,r,w)}function _(w){ee.call(this,r,w)}function P(w){ee.call(this,r,w)}function B(w){ee.call(this,r,w)}function F(w){ee.call(this,r,w)}function d(w){ee.call(this,r,w)}return r.$$set=w=>{"id"in w&&t(1,o=w.id),"source"in w&&t(2,a=w.source),"sourceLayer"in w&&t(3,s=w.sourceLayer),"beforeId"in w&&t(4,l=w.beforeId),"beforeLayerType"in w&&t(5,c=w.beforeLayerType),"paint"in w&&t(6,g=w.paint),"layout"in w&&t(7,m=w.layout),"filter"in w&&t(8,L=w.filter),"applyToClusters"in w&&t(9,p=w.applyToClusters),"minzoom"in w&&t(10,v=w.minzoom),"maxzoom"in w&&t(11,E=w.maxzoom),"hoverCursor"in w&&t(12,C=w.hoverCursor),"manageHoverState"in w&&t(13,k=w.manageHoverState),"hovered"in w&&t(0,u=w.hovered),"eventsIfTopMost"in w&&t(14,f=w.eventsIfTopMost),"interactive"in w&&t(15,h=w.interactive),"$$scope"in w&&t(24,i=w.$$scope)},[u,o,a,s,l,c,g,m,L,p,v,E,C,k,f,h,n,y,S,_,P,B,F,d,i]}class go extends Be{constructor(e){super(),ze(this,e,ho,mo,Ce,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function vo(r){let e;const t=r[15].default,n=it(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&ot(n,t,i,i[23],e?st(t,i[23],o,null):at(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){z(n,i),e=!1},d(i){n&&n.d(i)}}}function yo(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[vo]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),x.push(()=>$(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){O(e.$$.fragment)},l(a){I(e.$$.fragment,a)},m(a,s){D(e,a,s),n=!0},p(a,[s]){const l={};s&2&&(l.id=a[1]),s&4&&(l.source=a[2]),s&8&&(l.sourceLayer=a[3]),s&16&&(l.beforeId=a[4]),s&32&&(l.beforeLayerType=a[5]),s&64&&(l.paint=a[6]),s&128&&(l.layout=a[7]),s&256&&(l.filter=a[8]),s&512&&(l.minzoom=a[9]),s&1024&&(l.maxzoom=a[10]),s&2048&&(l.hoverCursor=a[11]),s&4096&&(l.manageHoverState=a[12]),s&8192&&(l.eventsIfTopMost=a[13]),s&16384&&(l.interactive=a[14]),s&8388608&&(l.$$scope={dirty:s,ctx:a}),!t&&s&1&&(t=!0,l.hovered=a[0],j(()=>t=!1)),e.$set(l)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function po(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("fill")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:l=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:g}=e,{layout:m=void 0}=e,{filter:L=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:v=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:C=!1}=e,{hovered:k=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:f=!0}=e;function h(d){k=d,t(0,k)}function y(d){ee.call(this,r,d)}function S(d){ee.call(this,r,d)}function _(d){ee.call(this,r,d)}function P(d){ee.call(this,r,d)}function B(d){ee.call(this,r,d)}function F(d){ee.call(this,r,d)}return r.$$set=d=>{"id"in d&&t(1,o=d.id),"source"in d&&t(2,a=d.source),"sourceLayer"in d&&t(3,s=d.sourceLayer),"beforeId"in d&&t(4,l=d.beforeId),"beforeLayerType"in d&&t(5,c=d.beforeLayerType),"paint"in d&&t(6,g=d.paint),"layout"in d&&t(7,m=d.layout),"filter"in d&&t(8,L=d.filter),"minzoom"in d&&t(9,p=d.minzoom),"maxzoom"in d&&t(10,v=d.maxzoom),"hoverCursor"in d&&t(11,E=d.hoverCursor),"manageHoverState"in d&&t(12,C=d.manageHoverState),"hovered"in d&&t(0,k=d.hovered),"eventsIfTopMost"in d&&t(13,u=d.eventsIfTopMost),"interactive"in d&&t(14,f=d.interactive),"$$scope"in d&&t(23,i=d.$$scope)},[k,o,a,s,l,c,g,m,L,p,v,E,C,u,f,n,h,y,S,_,P,B,F,i]}class bo extends Be{constructor(e){super(),ze(this,e,po,yo,Ce,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function _o(r,e,t,n,i){let o=!1;r.getSource(e)&&(o=!0,r.removeSource(e));const a=()=>{n(e)&&(r.addSource(e,t),i())};if(o){const s=()=>{e&&(r.getSource(e)?setTimeout(s,1):a())};s()}else a()}function wo(r,e,t){Sn().then(()=>{let n=Pn(r);if(!n)return;n.getSource(e)===t&&n.removeSource(e)})}function kr(r){let e=r[0],t,n,i=Er(r);return{c(){i.c(),t=ye()},l(o){i.l(o),t=ye()},m(o,a){i.m(o,a),H(o,t,a),n=!0},p(o,a){a&1&&Ce(e,e=o[0])?(Je(),z(i,1,1,Oe),Ue(),i=Er(o),i.c(),T(i,1),i.m(t.parentNode,t)):i.p(o,a)},i(o){n||(T(i),n=!0)},o(o){z(i),n=!1},d(o){o&&N(t),i.d(o)}}}function Er(r){let e;const t=r[15].default,n=it(t,r,r[14],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16384)&&ot(n,t,i,i[14],e?st(t,i[14],o,null):at(i[14]),null)},i(i){e||(T(n,i),e=!0)},o(i){z(n,i),e=!1},d(i){n&&n.d(i)}}}function Mo(r){let e,t,n=r[0]&&kr(r);return{c(){n&&n.c(),e=ye()},l(i){n&&n.l(i),e=ye()},m(i,o){n&&n.m(i,o),H(i,e,o),t=!0},p(i,[o]){i[0]?n?(n.p(i,o),o&1&&T(n,1)):(n=kr(i),n.c(),T(n,1),n.m(e.parentNode,e)):n&&(Je(),z(n,1,1,()=>{n=null}),Ue())},i(i){t||(T(n),t=!0)},o(i){z(n),t=!1},d(i){i&&N(e),n&&n.d(i)}}}function So(r,e,t){let n,i,o,{$$slots:a={},$$scope:s}=e,{id:l=ft("geojson")}=e,{data:c}=e,{generateId:g=!1}=e,{promoteId:m=void 0}=e,{filter:L=void 0}=e,{lineMetrics:p=void 0}=e,{cluster:v=void 0}=e;const{map:E,cluster:C,self:k}=oo();de(r,E,h=>t(13,i=h)),de(r,C,h=>t(16,o=h)),de(r,k,h=>t(0,n=h));let u,f=!0;return ht(()=>{n&&u&&i&&(wo(E,n,u),Ge(k,n=null,n),t(11,u=void 0))}),r.$$set=h=>{"id"in h&&t(4,l=h.id),"data"in h&&t(5,c=h.data),"generateId"in h&&t(6,g=h.generateId),"promoteId"in h&&t(7,m=h.promoteId),"filter"in h&&t(8,L=h.filter),"lineMetrics"in h&&t(9,p=h.lineMetrics),"cluster"in h&&t(10,v=h.cluster),"$$scope"in h&&t(14,s=h.$$scope)},r.$$.update=()=>{r.$$.dirty&1024&&Ge(C,o=v,o),r.$$.dirty&12273&&i&&n!==l&&(Ge(k,n=l,n),_o(i,n,kt({type:"geojson",data:c,filter:L,lineMetrics:p,generateId:g,promoteId:m,cluster:!!v,clusterMinPoints:v==null?void 0:v.minPoints,clusterMaxZoom:v==null?void 0:v.maxZoom,clusterRadius:v==null?void 0:v.radius,clusterProperties:v==null?void 0:v.properties}),h=>i&&h===n,()=>{n&&(t(11,u=i==null?void 0:i.getSource(n)),t(12,f=!0))})),r.$$.dirty&8208&&(i==null||i.on("style.load",()=>{t(11,u=i==null?void 0:i.getSource(l))})),r.$$.dirty&6176&&u&&(f?t(12,f=!1):u.setData(c)),r.$$.dirty&3072&&(u==null||u.setClusterOptions(kt({cluster:!!v,clusterMaxZoom:v==null?void 0:v.maxZoom,clusterRadius:v==null?void 0:v.radius})))},[n,E,C,k,l,c,g,m,L,p,v,u,f,i,s,a]}class Po extends Be{constructor(e){super(),ze(this,e,So,Mo,Ce,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Lo(r){let e;const t=r[15].default,n=it(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&ot(n,t,i,i[23],e?st(t,i[23],o,null):at(i[23]),null)},i(i){e||(T(n,i),e=!0)},o(i){z(n,i),e=!1},d(i){n&&n.d(i)}}}function ko(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"line",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[Lo]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new Gt({props:o}),x.push(()=>$(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){O(e.$$.fragment)},l(a){I(e.$$.fragment,a)},m(a,s){D(e,a,s),n=!0},p(a,[s]){const l={};s&2&&(l.id=a[1]),s&4&&(l.source=a[2]),s&8&&(l.sourceLayer=a[3]),s&16&&(l.beforeId=a[4]),s&32&&(l.beforeLayerType=a[5]),s&64&&(l.paint=a[6]),s&128&&(l.layout=a[7]),s&256&&(l.filter=a[8]),s&512&&(l.minzoom=a[9]),s&1024&&(l.maxzoom=a[10]),s&2048&&(l.hoverCursor=a[11]),s&4096&&(l.manageHoverState=a[12]),s&8192&&(l.eventsIfTopMost=a[13]),s&16384&&(l.interactive=a[14]),s&8388608&&(l.$$scope={dirty:s,ctx:a}),!t&&s&1&&(t=!0,l.hovered=a[0],j(()=>t=!1)),e.$set(l)},i(a){n||(T(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){q(e,a)}}}function Eo(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=ft("line")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:l=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:g}=e,{layout:m=void 0}=e,{filter:L=void 0}=e,{minzoom:p=void 0}=e,{maxzoom:v=void 0}=e,{hoverCursor:E=void 0}=e,{manageHoverState:C=!1}=e,{hovered:k=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:f=!0}=e;function h(d){k=d,t(0,k)}function y(d){ee.call(this,r,d)}function S(d){ee.call(this,r,d)}function _(d){ee.call(this,r,d)}function P(d){ee.call(this,r,d)}function B(d){ee.call(this,r,d)}function F(d){ee.call(this,r,d)}return r.$$set=d=>{"id"in d&&t(1,o=d.id),"source"in d&&t(2,a=d.source),"sourceLayer"in d&&t(3,s=d.sourceLayer),"beforeId"in d&&t(4,l=d.beforeId),"beforeLayerType"in d&&t(5,c=d.beforeLayerType),"paint"in d&&t(6,g=d.paint),"layout"in d&&t(7,m=d.layout),"filter"in d&&t(8,L=d.filter),"minzoom"in d&&t(9,p=d.minzoom),"maxzoom"in d&&t(10,v=d.maxzoom),"hoverCursor"in d&&t(11,E=d.hoverCursor),"manageHoverState"in d&&t(12,C=d.manageHoverState),"hovered"in d&&t(0,k=d.hovered),"eventsIfTopMost"in d&&t(13,u=d.eventsIfTopMost),"interactive"in d&&t(14,f=d.interactive),"$$scope"in d&&t(23,i=d.$$scope)},[k,o,a,s,l,c,g,m,L,p,v,E,C,u,f,n,h,y,S,_,P,B,F,i]}class Co extends Be{constructor(e){super(),ze(this,e,Eo,ko,Ce,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Fo(r){let e,t,n,i,o,a;return e=new bo({props:{id:"edit-polygon-fill",filter:ji,paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}}}),n=new Co({props:{id:"edit-polygon-lines",filter:$i,paint:{"line-color":"black","line-width":8,"line-opacity":.5}}}),o=new go({props:{id:"edit-polygon-vertices",filter:eo,paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}}),{c(){O(e.$$.fragment),t=Z(),O(n.$$.fragment),i=Z(),O(o.$$.fragment)},l(s){I(e.$$.fragment,s),t=K(s),I(n.$$.fragment,s),i=K(s),I(o.$$.fragment,s)},m(s,l){D(e,s,l),H(s,t,l),D(n,s,l),H(s,i,l),D(o,s,l),a=!0},p:Oe,i(s){a||(T(e.$$.fragment,s),T(n.$$.fragment,s),T(o.$$.fragment,s),a=!0)},o(s){z(e.$$.fragment,s),z(n.$$.fragment,s),z(o.$$.fragment,s),a=!1},d(s){s&&(N(t),N(i)),q(e,s),q(n,s),q(o,s)}}}function Ao(r){let e,t;return e=new Po({props:{data:r[0],$$slots:{default:[Fo]},$$scope:{ctx:r}}}),{c(){O(e.$$.fragment)},l(n){I(e.$$.fragment,n)},m(n,i){D(e,n,i),t=!0},p(n,[i]){const o={};i&1&&(o.data=n[0]),i&2&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function To(r,e,t){let n;return de(r,tn,i=>t(0,n=i)),[n]}class Bo extends Be{constructor(e){super(),ze(this,e,To,Ao,Ce,{})}}function zo(r){let e,t="Map loading...";return{c(){e=Ie("p"),e.textContent=t},l(n){e=De(n,"P",{"data-svelte-h":!0}),Lt(e)!=="svelte-1r8199k"&&(e.textContent=t)},m(n,i){H(n,e,i)},p:Oe,i:Oe,o:Oe,d(n){n&&N(e)}}}function Ro(r){let e,t,n,i;e=new kn({props:{$$slots:{default:[Io]},$$scope:{ctx:r}}}),e.$on("click",r[5]);let o=r[1].summary.polygon&&Cr(r);return{c(){O(e.$$.fragment),t=Z(),o&&o.c(),n=ye()},l(a){I(e.$$.fragment,a),t=K(a),o&&o.l(a),n=ye()},m(a,s){D(e,a,s),H(a,t,s),o&&o.m(a,s),H(a,n,s),i=!0},p(a,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:a}),e.$set(l),a[1].summary.polygon?o?(o.p(a,s),s&2&&T(o,1)):(o=Cr(a),o.c(),T(o,1),o.m(n.parentNode,n)):o&&(Je(),z(o,1,1,()=>{o=null}),Ue())},i(a){i||(T(e.$$.fragment,a),T(o),i=!0)},o(a){z(e.$$.fragment,a),z(o),i=!1},d(a){a&&(N(t),N(n)),q(e,a),o&&o.d(a)}}}function Oo(r){let e,t,n,i,o,a,s;return t=new Mt({props:{$$slots:{default:[qo]},$$scope:{ctx:r}}}),t.$on("click",r[7]),i=new Mt({props:{$$slots:{default:[Xo]},$$scope:{ctx:r}}}),i.$on("click",r[8]),a=new Mt({props:{disabled:r[4]==0,$$slots:{default:[Go]},$$scope:{ctx:r}}}),a.$on("click",r[9]),{c(){e=Ie("div"),O(t.$$.fragment),n=Z(),O(i.$$.fragment),o=Z(),O(a.$$.fragment),this.h()},l(l){e=De(l,"DIV",{style:!0});var c=yt(e);I(t.$$.fragment,c),n=K(c),I(i.$$.fragment,c),o=K(c),I(a.$$.fragment,c),c.forEach(N),this.h()},h(){et(e,"display","flex"),et(e,"justify-content","space-between")},m(l,c){H(l,e,c),D(t,e,null),V(e,n),D(i,e,null),V(e,o),D(a,e,null),s=!0},p(l,c){const g={};c&2048&&(g.$$scope={dirty:c,ctx:l}),t.$set(g);const m={};c&2048&&(m.$$scope={dirty:c,ctx:l}),i.$set(m);const L={};c&16&&(L.disabled=l[4]==0),c&2064&&(L.$$scope={dirty:c,ctx:l}),a.$set(L)},i(l){s||(T(t.$$.fragment,l),T(i.$$.fragment,l),T(a.$$.fragment,l),s=!0)},o(l){z(t.$$.fragment,l),z(i.$$.fragment,l),z(a.$$.fragment,l),s=!1},d(l){l&&N(e),q(t),q(i),q(a)}}}function Io(r){let e;return{c(){e=Me("Edit polygon")},l(t){e=Se(t,"Edit polygon")},m(t,n){H(t,e,n)},d(t){t&&N(e)}}}function Cr(r){let e,t,n,i,o=vr(r[1].summary.polygon).toFixed(1)+"",a,s,l;return e=new En({props:{$$slots:{default:[Do]},$$scope:{ctx:r}}}),e.$on("click",r[6]),{c(){O(e.$$.fragment),t=Z(),n=Ie("p"),i=Me("Polygon area: "),a=Me(o),s=Me(" square meters")},l(c){I(e.$$.fragment,c),t=K(c),n=De(c,"P",{});var g=yt(n);i=Se(g,"Polygon area: "),a=Se(g,o),s=Se(g," square meters"),g.forEach(N)},m(c,g){D(e,c,g),H(c,t,g),H(c,n,g),V(n,i),V(n,a),V(n,s),l=!0},p(c,g){const m={};g&2048&&(m.$$scope={dirty:g,ctx:c}),e.$set(m),(!l||g&2)&&o!==(o=vr(c[1].summary.polygon).toFixed(1)+"")&&Fr(a,o)},i(c){l||(T(e.$$.fragment,c),l=!0)},o(c){z(e.$$.fragment,c),l=!1},d(c){c&&(N(t),N(n)),q(e,c)}}}function Do(r){let e;return{c(){e=Me("Delete and start over")},l(t){e=Se(t,"Delete and start over")},m(t,n){H(t,e,n)},d(t){t&&N(e)}}}function qo(r){let e;return{c(){e=Me("Finish")},l(t){e=Se(t,"Finish")},m(t,n){H(t,e,n)},d(t){t&&N(e)}}}function Xo(r){let e;return{c(){e=Me("Cancel")},l(t){e=Se(t,"Cancel")},m(t,n){H(t,e,n)},d(t){t&&N(e)}}}function Yo(r){let e,t,n;return{c(){e=Me("Undo ("),t=Me(r[4]),n=Me(")")},l(i){e=Se(i,"Undo ("),t=Se(i,r[4]),n=Se(i,")")},m(i,o){H(i,e,o),H(i,t,o),H(i,n,o)},p(i,o){o&16&&Fr(t,i[4])},d(i){i&&(N(e),N(t),N(n))}}}function No(r){let e;return{c(){e=Me("Undo")},l(t){e=Se(t,"Undo")},m(t,n){H(t,e,n)},p:Oe,d(t){t&&N(e)}}}function Go(r){let e;function t(o,a){return o[4]==0?No:Yo}let n=t(r),i=n(r);return{c(){i.c(),e=ye()},l(o){i.l(o),e=ye()},m(o,a){i.m(o,a),H(o,e,a)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&N(e),i.d(o)}}}function Ho(r){let e,t;return e=new An({props:{layout:{visibility:r[2]?"none":"visible"},paint:{"fill-color":"red","fill-opacity":.8}}}),{c(){O(e.$$.fragment)},l(n){I(e.$$.fragment,n)},m(n,i){D(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.layout={visibility:n[2]?"none":"visible"}),e.$set(o)},i(n){t||(T(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Jo(r){let e,t,n,i;return e=new Bo({}),n=new Fn({props:{data:r[3],$$slots:{default:[Ho]},$$scope:{ctx:r}}}),{c(){O(e.$$.fragment),t=Z(),O(n.$$.fragment)},l(o){I(e.$$.fragment,o),t=K(o),I(n.$$.fragment,o)},m(o,a){D(e,o,a),H(o,t,a),D(n,o,a),i=!0},p(o,a){const s={};a&8&&(s.data=o[3]),a&2052&&(s.$$scope={dirty:a,ctx:o}),n.$set(s)},i(o){i||(T(e.$$.fragment,o),T(n.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),i=!1},d(o){o&&N(t),q(e,o),q(n,o)}}}function Uo(r){let e,t,n,i,o,a,s;const l=[Oo,Ro,zo],c=[];function g(p,v){return p[2]?0:p[0]?1:2}e=g(r),t=c[e]=l[e](r);function m(p){r[10](p)}let L={$$slots:{default:[Jo]},$$scope:{ctx:r}};return r[0]!==void 0&&(L.map=r[0]),o=new Cn({props:L}),x.push(()=>$(o,"map",m)),{c(){t.c(),n=Z(),i=Ie("div"),O(o.$$.fragment),this.h()},l(p){t.l(p),n=K(p),i=De(p,"DIV",{style:!0});var v=yt(i);I(o.$$.fragment,v),v.forEach(N),this.h()},h(){et(i,"position","relative"),et(i,"width","100%"),et(i,"height","300px")},m(p,v){c[e].m(p,v),H(p,n,v),H(p,i,v),D(o,i,null),s=!0},p(p,[v]){let E=e;e=g(p),e===E?c[e].p(p,v):(Je(),z(c[E],1,1,()=>{c[E]=null}),Ue(),t=c[e],t?t.p(p,v):(t=c[e]=l[e](p),t.c()),T(t,1),t.m(n.parentNode,n));const C={};v&2060&&(C.$$scope={dirty:v,ctx:p}),!a&&v&1&&(a=!0,C.map=p[0],j(()=>a=!1)),o.$set(C)},i(p){s||(T(t),T(o.$$.fragment,p),s=!0)},o(p){z(t),z(o.$$.fragment,p),s=!1},d(p){p&&(N(n),N(i)),c[e].d(p),q(o)}}}function Zo(r,e,t){let n,i,o;de(r,Q,v=>t(1,i=v)),de(r,rn,v=>t(4,o=v));let a=null,s=null;ht(()=>{s==null||s.tearDown()});function l(){a&&(t(2,s=new ro(a)),i.summary.polygon?s.editExisting(i.summary.polygon):s.startNew(),s.addEventListenerSuccess(async v=>{t(2,s=null),Ge(Q,i.summary.polygon=v,i)}),s.addEventListenerFailure(()=>{t(2,s=null)}))}function c(){Ge(Q,i.summary.polygon=null,i),l()}const g=()=>s==null?void 0:s.finish(),m=()=>s==null?void 0:s.cancel(),L=()=>s==null?void 0:s.undo();function p(v){a=v,t(0,a)}return r.$$.update=()=>{r.$$.dirty&2&&t(3,n=i.summary.polygon??{type:"FeatureCollection",features:[]}),r.$$.dirty&1&&a&&l()},[a,i,s,n,o,l,c,g,m,L,p]}class Ko extends Be{constructor(e){super(),ze(this,e,Zo,Uo,Ce,{})}}function Vo(r){let e,t,n,i,o,a,s,l,c,g,m,L,p,v,E,C,k,u,f,h,y,S,_,P,B,F,d,w,R,X,te,J,ne,oe,se,be,fe,U,Xe,Re,ce,le,Pe,Fe,Ke="Network context",Ye,_e,Ve=`Please add a drawing of the area being assessed below, including the
    location of measures proposed by the scheme.`,M,Y,he;function we(b){r[1](b)}let me={label:"Date of design review"};r[0].summary.dateDesignReview!==void 0&&(me.value=r[0].summary.dateDesignReview),t=new mt({props:me}),x.push(()=>$(t,"value",we));function Le(b){r[2](b)}let We={label:"Scheme reference"};r[0].summary.schemeReference!==void 0&&(We.value=r[0].summary.schemeReference),o=new mt({props:We}),x.push(()=>$(o,"value",Le));function an(b){r[3](b)}let Ht={label:"Scheme name"};r[0].summary.schemeName!==void 0&&(Ht.value=r[0].summary.schemeName),l=new mt({props:Ht}),x.push(()=>$(l,"value",an));function sn(b){r[4](b)}let Jt={label:"Scheme summary"};r[0].summary.schemeSummary!==void 0&&(Jt.value=r[0].summary.schemeSummary),m=new ct({props:Jt}),x.push(()=>$(m,"value",sn));function ln(b){r[5](b)}let Ut={label:"Scheme information reviewed"};r[0].summary.schemeInfoReviewed!==void 0&&(Ut.value=r[0].summary.schemeInfoReviewed),v=new ct({props:Ut}),x.push(()=>$(v,"value",ln));function un(b){r[6](b)}let Zt={label:"Authority",emptyOption:!0,choices:Qe(On)};r[0].summary.authority!==void 0&&(Zt.value=r[0].summary.authority),k=new xe({props:Zt}),x.push(()=>$(k,"value",un));function fn(b){r[7](b)}let Kt={label:"Transport / Combined Authority",emptyOption:!0,choices:Qe(In)};r[0].summary.transportOrCombinedAuthority!==void 0&&(Kt.value=r[0].summary.transportOrCombinedAuthority),h=new xe({props:Kt}),x.push(()=>$(h,"value",fn));function cn(b){r[8](b)}let Vt={label:"Region",emptyOption:!0,choices:Qe(Dn)};r[0].summary.region!==void 0&&(Vt.value=r[0].summary.region),_=new xe({props:Vt}),x.push(()=>$(_,"value",cn));function mn(b){r[9](b)}let Wt={label:"Funding programme",emptyOption:!0,choices:Qe(qn)};r[0].summary.fundingProgramme!==void 0&&(Wt.value=r[0].summary.fundingProgramme),F=new xe({props:Wt}),x.push(()=>$(F,"value",mn));function hn(b){r[10](b)}let Qt={label:"Design stage",emptyOption:!0,choices:Qe(Xn)};r[0].summary.designStage!==void 0&&(Qt.value=r[0].summary.designStage),R=new xe({props:Qt}),x.push(()=>$(R,"value",hn));function dn(b){r[11](b)}let xt={label:"Funding conditions"};r[0].summary.fundingConditions!==void 0&&(xt.value=r[0].summary.fundingConditions),J=new ct({props:xt}),x.push(()=>$(J,"value",dn));function gn(b){r[12](b)}let jt={label:"Inspector email address"};r[0].summary.inspectorEmail!==void 0&&(jt.value=r[0].summary.inspectorEmail),se=new mt({props:jt}),x.push(()=>$(se,"value",gn));function vn(b){r[13](b)}let $t={label:"Scheme area size (km)",width:6,min:0};r[0].summary.schemeAreaSizeKm2!==void 0&&($t.value=r[0].summary.schemeAreaSizeKm2),U=new Yn({props:$t}),x.push(()=>$(U,"value",vn));function yn(b){r[14](b)}let er={label:"Notes"};return r[0].summary.notes!==void 0&&(er.value=r[0].summary.notes),ce=new ct({props:er}),x.push(()=>$(ce,"value",yn)),Y=new Ko({}),{c(){e=Ie("div"),O(t.$$.fragment),i=Z(),O(o.$$.fragment),s=Z(),O(l.$$.fragment),g=Z(),O(m.$$.fragment),p=Z(),O(v.$$.fragment),C=Z(),O(k.$$.fragment),f=Z(),O(h.$$.fragment),S=Z(),O(_.$$.fragment),B=Z(),O(F.$$.fragment),w=Z(),O(R.$$.fragment),te=Z(),O(J.$$.fragment),oe=Z(),O(se.$$.fragment),fe=Z(),O(U.$$.fragment),Re=Z(),O(ce.$$.fragment),Pe=Z(),Fe=Ie("h2"),Fe.textContent=Ke,Ye=Z(),_e=Ie("p"),_e.textContent=Ve,M=Z(),O(Y.$$.fragment),this.h()},l(b){e=De(b,"DIV",{class:!0});var A=yt(e);I(t.$$.fragment,A),i=K(A),I(o.$$.fragment,A),s=K(A),I(l.$$.fragment,A),g=K(A),I(m.$$.fragment,A),p=K(A),I(v.$$.fragment,A),C=K(A),I(k.$$.fragment,A),f=K(A),I(h.$$.fragment,A),S=K(A),I(_.$$.fragment,A),B=K(A),I(F.$$.fragment,A),w=K(A),I(R.$$.fragment,A),te=K(A),I(J.$$.fragment,A),oe=K(A),I(se.$$.fragment,A),fe=K(A),I(U.$$.fragment,A),Re=K(A),I(ce.$$.fragment,A),Pe=K(A),Fe=De(A,"H2",{"data-svelte-h":!0}),Lt(Fe)!=="svelte-1tcb68x"&&(Fe.textContent=Ke),Ye=K(A),_e=De(A,"P",{"data-svelte-h":!0}),Lt(_e)!=="svelte-2zany2"&&(_e.textContent=Ve),M=K(A),I(Y.$$.fragment,A),A.forEach(N),this.h()},h(){Ln(e,"class","govuk-width-container")},m(b,A){H(b,e,A),D(t,e,null),V(e,i),D(o,e,null),V(e,s),D(l,e,null),V(e,g),D(m,e,null),V(e,p),D(v,e,null),V(e,C),D(k,e,null),V(e,f),D(h,e,null),V(e,S),D(_,e,null),V(e,B),D(F,e,null),V(e,w),D(R,e,null),V(e,te),D(J,e,null),V(e,oe),D(se,e,null),V(e,fe),D(U,e,null),V(e,Re),D(ce,e,null),V(e,Pe),V(e,Fe),V(e,Ye),V(e,_e),V(e,M),D(Y,e,null),he=!0},p(b,[A]){const tr={};!n&&A&1&&(n=!0,tr.value=b[0].summary.dateDesignReview,j(()=>n=!1)),t.$set(tr);const rr={};!a&&A&1&&(a=!0,rr.value=b[0].summary.schemeReference,j(()=>a=!1)),o.$set(rr);const nr={};!c&&A&1&&(c=!0,nr.value=b[0].summary.schemeName,j(()=>c=!1)),l.$set(nr);const ir={};!L&&A&1&&(L=!0,ir.value=b[0].summary.schemeSummary,j(()=>L=!1)),m.$set(ir);const or={};!E&&A&1&&(E=!0,or.value=b[0].summary.schemeInfoReviewed,j(()=>E=!1)),v.$set(or);const ar={};!u&&A&1&&(u=!0,ar.value=b[0].summary.authority,j(()=>u=!1)),k.$set(ar);const sr={};!y&&A&1&&(y=!0,sr.value=b[0].summary.transportOrCombinedAuthority,j(()=>y=!1)),h.$set(sr);const lr={};!P&&A&1&&(P=!0,lr.value=b[0].summary.region,j(()=>P=!1)),_.$set(lr);const ur={};!d&&A&1&&(d=!0,ur.value=b[0].summary.fundingProgramme,j(()=>d=!1)),F.$set(ur);const fr={};!X&&A&1&&(X=!0,fr.value=b[0].summary.designStage,j(()=>X=!1)),R.$set(fr);const cr={};!ne&&A&1&&(ne=!0,cr.value=b[0].summary.fundingConditions,j(()=>ne=!1)),J.$set(cr);const mr={};!be&&A&1&&(be=!0,mr.value=b[0].summary.inspectorEmail,j(()=>be=!1)),se.$set(mr);const hr={};!Xe&&A&1&&(Xe=!0,hr.value=b[0].summary.schemeAreaSizeKm2,j(()=>Xe=!1)),U.$set(hr);const dr={};!le&&A&1&&(le=!0,dr.value=b[0].summary.notes,j(()=>le=!1)),ce.$set(dr)},i(b){he||(T(t.$$.fragment,b),T(o.$$.fragment,b),T(l.$$.fragment,b),T(m.$$.fragment,b),T(v.$$.fragment,b),T(k.$$.fragment,b),T(h.$$.fragment,b),T(_.$$.fragment,b),T(F.$$.fragment,b),T(R.$$.fragment,b),T(J.$$.fragment,b),T(se.$$.fragment,b),T(U.$$.fragment,b),T(ce.$$.fragment,b),T(Y.$$.fragment,b),he=!0)},o(b){z(t.$$.fragment,b),z(o.$$.fragment,b),z(l.$$.fragment,b),z(m.$$.fragment,b),z(v.$$.fragment,b),z(k.$$.fragment,b),z(h.$$.fragment,b),z(_.$$.fragment,b),z(F.$$.fragment,b),z(R.$$.fragment,b),z(J.$$.fragment,b),z(se.$$.fragment,b),z(U.$$.fragment,b),z(ce.$$.fragment,b),z(Y.$$.fragment,b),he=!1},d(b){b&&N(e),q(t),q(o),q(l),q(m),q(v),q(k),q(h),q(_),q(F),q(R),q(J),q(se),q(U),q(ce),q(Y)}}}function Wo(r,e,t){let n;de(r,Q,u=>t(0,n=u));function i(u){r.$$.not_equal(n.summary.dateDesignReview,u)&&(n.summary.dateDesignReview=u,Q.set(n))}function o(u){r.$$.not_equal(n.summary.schemeReference,u)&&(n.summary.schemeReference=u,Q.set(n))}function a(u){r.$$.not_equal(n.summary.schemeName,u)&&(n.summary.schemeName=u,Q.set(n))}function s(u){r.$$.not_equal(n.summary.schemeSummary,u)&&(n.summary.schemeSummary=u,Q.set(n))}function l(u){r.$$.not_equal(n.summary.schemeInfoReviewed,u)&&(n.summary.schemeInfoReviewed=u,Q.set(n))}function c(u){r.$$.not_equal(n.summary.authority,u)&&(n.summary.authority=u,Q.set(n))}function g(u){r.$$.not_equal(n.summary.transportOrCombinedAuthority,u)&&(n.summary.transportOrCombinedAuthority=u,Q.set(n))}function m(u){r.$$.not_equal(n.summary.region,u)&&(n.summary.region=u,Q.set(n))}function L(u){r.$$.not_equal(n.summary.fundingProgramme,u)&&(n.summary.fundingProgramme=u,Q.set(n))}function p(u){r.$$.not_equal(n.summary.designStage,u)&&(n.summary.designStage=u,Q.set(n))}function v(u){r.$$.not_equal(n.summary.fundingConditions,u)&&(n.summary.fundingConditions=u,Q.set(n))}function E(u){r.$$.not_equal(n.summary.inspectorEmail,u)&&(n.summary.inspectorEmail=u,Q.set(n))}function C(u){r.$$.not_equal(n.summary.schemeAreaSizeKm2,u)&&(n.summary.schemeAreaSizeKm2=u,Q.set(n))}function k(u){r.$$.not_equal(n.summary.notes,u)&&(n.summary.notes=u,Q.set(n))}return[n,i,o,a,s,l,c,g,m,L,p,v,E,C,k]}class ga extends Be{constructor(e){super(),ze(this,e,Wo,Vo,Ce,{})}}export{ga as component};
