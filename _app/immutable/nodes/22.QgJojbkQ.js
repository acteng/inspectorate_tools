import{s as re,r as U,e as O,a as W,b as V,f as G,c as N,d as g,K as Z,o as Te,i as v,j as E,v as j,k as ie,a4 as Xe,t as M,w as K,h as P,y as x,g as ue,x as Ze,n as te,l as xe}from"../chunks/scheduler.8Pqdtq9W.js";import{S as se,i as ne,e as A,c as L,a as S,m as C,t as w,g as z,b as D,f as J,d as R}from"../chunks/index.KrNxZzBh.js";import{e as ee,u as Ie,o as Oe,B as et}from"../chunks/Geocoder.svelte_svelte_type_style_lang.DFk5YD4v.js";import{p as X}from"../chunks/index.Cy9rwH1V.js";import{S as ae}from"../chunks/SecondaryButton.CctJSiA9.js";import{S as Q}from"../chunks/Select.CDozVlAb.js";import{W as Ve}from"../chunks/WarningButton.Cyr2mll2.js";import{W as ce}from"../chunks/WarningText.DNDO-dlG.js";import{s as B,a as tt,b as rt}from"../chunks/data.DhlDRbOc.js";import{a as Ue,n as it,g as Le,c as st,N as je}from"../chunks/logic.BW_M7Tfl.js";import{E as nt}from"../chunks/ExternalLink.DchCAz0l.js";import{T as at}from"../chunks/TextInput.CSx64iaK.js";import{v as lt}from"../chunks/v4.D8aEg3BZ.js";import{C as le}from"../chunks/CollapsibleCard.COCSlxIK.js";import"../chunks/paths.Bgz_mC8X.js";function oe(i){return i.startsWith("custom_")?[]:ot[i]}let ot={Footway:[["Manual for Streets 2: Section 5 pp. 43","https://tsrgd.co.uk/pdf/mfs/mfs2.pdf#page=48"],["DMRB CD143 Designing for walking, cycling & horse-riding Annex pp. 7",""]],"Narrow Traffic / Bus Lane":[],"Wide Traffic / Bus Lane":[],"Traffic Lane (no buses): speed limit 20/30":[["LTN 1/20 Table 7-2 pp. 76",H(76)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"On-highway advisory/mandatory cycle lane":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"1-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"2-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"Shared use cycle track":[["LTN 1/20 Table 6-3 pp. 68",H(68)]],"Parking Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Disabled Parking Bay":[],"Loading Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Buffer / Verge":[["LTN 1/20 table 6-1 pp. 54",H(54)]]};function H(i){return`https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951074/cycle-infrastructure-design-ltn-1-20.pdf#page=${i}`}function fe(i,e){let r=Ue(e.speedLimit,e.observedSpeed);switch(i){case"Footway":return"There is no maximum width for footways; widths should take account of pedestrian volumes and composition. Suggested widths quoted here are the functional width available to the user";case"Narrow Traffic / Bus Lane":return"";case"Wide Traffic / Bus Lane":return"";case"Traffic Lane (no buses): speed limit 20/30":return e.trafficFlow=="<2,500"&&r==20?"Where traffic volumes are less than 2,500 vpd and speeds are less than 20mph, cycling in mixed traffic may be suitable for all users":"Where traffic volumes are greater than 2,500 vpd or speeds are greater than 20mph, cycling in mixed traffic is not suitable for all users";case"On-highway advisory/mandatory cycle lane":return(e.trafficFlow=="<2,500"||e.trafficFlow=="2,500-5,000")&&r==20?"Where traffic volumes are less than 2,500 vpd and/or speeds are less than 20mph, advisory or mandatory cycle lanes may be suitable for all users":"Where traffic volumes are greater than 5,000 vpd and/or speeds are greater than 20mph, advisory or mandatory cycle lanes are not suitable for all users";case"1-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.";case"2-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the userplus min. protection width 0.3m.";case"Shared use cycle track":return"Potential policy conflict: 'Cyclists must be separated from pedestrians' - have you considered alternatives to a shared use cycle track?";case"Parking Bay":return"";case"Disabled Parking Bay":return"";case"Loading Bay":return"";case"Buffer / Verge":return"Your buffer / verge shouldn't impact on the functional width of your footway or cycle-track";default:return""}}function Se(i,e,r){const t=i.slice();return t[15]=e[r][0],t[16]=e[r][1],t}function Ce(i){let e,r,t,s=Le(i[0],i[6].proposed.trafficData,i[6].proposed.customFeatures,i[4],i[5])[i[3]=="Desirable"?0:1]+"",l,n,o,c,a,u=oe(i[0]).length>0,d,k=fe(i[0],i[6].proposed.trafficData),y,b;const p=[ct,ut,ft],_=[];function f($,T){return $[8]=="left"?0:$[8]=="right"?1:$[8]=="both"?2:-1}~(o=f(i))&&(c=_[o]=p[o](i));let m=u&&Re(i),F=k&&We(i);return{c(){e=O("p"),r=M(i[3]),t=M(" minimum width (m): "),l=M(s),n=W(),c&&c.c(),a=W(),m&&m.c(),d=W(),F&&F.c(),y=K()},l($){e=V($,"P",{});var T=G(e);r=P(T,i[3]),t=P(T," minimum width (m): "),l=P(T,s),T.forEach(g),n=N($),c&&c.l($),a=N($),m&&m.l($),d=N($),F&&F.l($),y=K()},m($,T){v($,e,T),E(e,r),E(e,t),E(e,l),v($,n,T),~o&&_[o].m($,T),v($,a,T),m&&m.m($,T),v($,d,T),F&&F.m($,T),v($,y,T),b=!0},p($,T){(!b||T&8)&&x(r,$[3]),(!b||T&121)&&s!==(s=Le($[0],$[6].proposed.trafficData,$[6].proposed.customFeatures,$[4],$[5])[$[3]=="Desirable"?0:1]+"")&&x(l,s);let Y=o;o=f($),o!==Y&&(c&&(z(),D(_[Y],1,1,()=>{_[Y]=null}),J()),~o?(c=_[o],c||(c=_[o]=p[o]($),c.c()),w(c,1),c.m(a.parentNode,a)):c=null),T&1&&(u=oe($[0]).length>0),u?m?(m.p($,T),T&1&&w(m,1)):(m=Re($),m.c(),w(m,1),m.m(d.parentNode,d)):m&&(z(),D(m,1,1,()=>{m=null}),J()),T&65&&(k=fe($[0],$[6].proposed.trafficData)),k?F?F.p($,T):(F=We($),F.c(),F.m(y.parentNode,y)):F&&(F.d(1),F=null)},i($){b||(w(c),w(m),b=!0)},o($){D(c),D(m),b=!1},d($){$&&(g(e),g(n),g(a),g(d),g(y)),~o&&_[o].d($),m&&m.d($),F&&F.d($)}}}function ft(i){let e,r;return e=new ce({props:{$$slots:{default:[pt]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,s){C(e,t,s),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ut(i){let e,r;return e=new ce({props:{$$slots:{default:[dt]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,s){C(e,t,s),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ct(i){let e,r;return e=new ce({props:{$$slots:{default:[mt]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,s){C(e,t,s),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function pt(i){let e;return{c(){e=M("Consider buffers to left and right")},l(r){e=P(r,"Consider buffers to left and right")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function dt(i){let e;return{c(){e=M("Consider buffer to right")},l(r){e=P(r,"Consider buffer to right")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function mt(i){let e;return{c(){e=M("Consider buffer to left")},l(r){e=P(r,"Consider buffer to left")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function Re(i){let e,r="References",t,s,l,n=ee(oe(i[0])),o=[];for(let a=0;a<n.length;a+=1)o[a]=qe(Se(i,n,a));const c=a=>D(o[a],1,1,()=>{o[a]=null});return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),s=O("ul");for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=V(a,"U",{"data-svelte-h":!0}),ue(e)!=="svelte-fk7cdq"&&(e.textContent=r),t=P(a,`
      :
      `),s=V(a,"UL",{});var u=G(s);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(g)},m(a,u){v(a,e,u),v(a,t,u),v(a,s,u);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(s,null);l=!0},p(a,u){if(u&1){n=ee(oe(a[0]));let d;for(d=0;d<n.length;d+=1){const k=Se(a,n,d);o[d]?(o[d].p(k,u),w(o[d],1)):(o[d]=qe(k),o[d].c(),w(o[d],1),o[d].m(s,null))}for(z(),d=n.length;d<o.length;d+=1)c(d);J()}},i(a){if(!l){for(let u=0;u<n.length;u+=1)w(o[u]);l=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)D(o[u]);l=!1},d(a){a&&(g(e),g(t),g(s)),Ze(o,a)}}}function _t(i){let e,r=i[15]+"",t;return{c(){e=O("li"),t=M(r)},l(s){e=V(s,"LI",{});var l=G(e);t=P(l,r),l.forEach(g)},m(s,l){v(s,e,l),E(e,t)},p(s,l){l&1&&r!==(r=s[15]+"")&&x(t,r)},i:te,o:te,d(s){s&&g(e)}}}function ht(i){let e,r,t;return r=new nt({props:{href:i[16],$$slots:{default:[$t]},$$scope:{ctx:i}}}),{c(){e=O("li"),L(r.$$.fragment)},l(s){e=V(s,"LI",{});var l=G(e);S(r.$$.fragment,l),l.forEach(g)},m(s,l){v(s,e,l),C(r,e,null),t=!0},p(s,l){const n={};l&1&&(n.href=s[16]),l&524289&&(n.$$scope={dirty:l,ctx:s}),r.$set(n)},i(s){t||(w(r.$$.fragment,s),t=!0)},o(s){D(r.$$.fragment,s),t=!1},d(s){s&&g(e),R(r)}}}function $t(i){let e=i[15]+"",r;return{c(){r=M(e)},l(t){r=P(t,e)},m(t,s){v(t,r,s)},p(t,s){s&1&&e!==(e=t[15]+"")&&x(r,e)},d(t){t&&g(r)}}}function qe(i){let e,r,t,s;const l=[ht,_t],n=[];function o(c,a){return c[16]?0:1}return e=o(i),r=n[e]=l[e](i),{c(){r.c(),t=K()},l(c){r.l(c),t=K()},m(c,a){n[e].m(c,a),v(c,t,a),s=!0},p(c,a){let u=e;e=o(c),e===u?n[e].p(c,a):(z(),D(n[u],1,1,()=>{n[u]=null}),J(),r=n[e],r?r.p(c,a):(r=n[e]=l[e](c),r.c()),w(r,1),r.m(t.parentNode,t))},i(c){s||(w(r),s=!0)},o(c){D(r),s=!1},d(c){c&&g(t),n[e].d(c)}}}function We(i){let e,r="Guidance",t,s,l=fe(i[0],i[6].proposed.trafficData)+"",n;return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),s=O("p"),n=M(l),this.h()},l(o){e=V(o,"U",{"data-svelte-h":!0}),ue(e)!=="svelte-qh7mhq"&&(e.textContent=r),t=P(o,`
      :
      `),s=V(o,"P",{style:!0});var c=G(s);n=P(c,l),c.forEach(g),this.h()},h(){Z(s,"max-width","400px")},m(o,c){v(o,e,c),v(o,t,c),v(o,s,c),E(s,n)},p(o,c){c&65&&l!==(l=fe(o[0],o[6].proposed.trafficData)+"")&&x(n,l)},d(o){o&&(g(e),g(t),g(s))}}}function gt(i){let e;return{c(){e=M("←")},l(r){e=P(r,"←")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function bt(i){let e;return{c(){e=M("Delete")},l(r){e=P(r,"Delete")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function vt(i){let e;return{c(){e=M("→")},l(r){e=P(r,"→")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function wt(i){let e,r,t,s,l,n,o,c,a,u,d,k;function y(_){i[10](_)}let b={label:"Street feature type",emptyOption:!0,choices:i[7]};i[0]!==void 0&&(b.value=i[0]),r=new Q({props:b}),U.push(()=>A(r,"value",y));let p=i[0]&&Ce(i);return o=new ae({props:{disabled:i[1],$$slots:{default:[gt]},$$scope:{ctx:i}}}),o.$on("click",i[11]),a=new Ve({props:{$$slots:{default:[bt]},$$scope:{ctx:i}}}),a.$on("click",i[12]),d=new ae({props:{disabled:i[2],$$slots:{default:[vt]},$$scope:{ctx:i}}}),d.$on("click",i[13]),{c(){e=O("div"),L(r.$$.fragment),s=W(),p&&p.c(),l=W(),n=O("div"),L(o.$$.fragment),c=W(),L(a.$$.fragment),u=W(),L(d.$$.fragment),this.h()},l(_){e=V(_,"DIV",{class:!0});var f=G(e);S(r.$$.fragment,f),s=N(f),p&&p.l(f),l=N(f),n=V(f,"DIV",{style:!0,class:!0});var m=G(n);S(o.$$.fragment,m),c=N(m),S(a.$$.fragment,m),u=N(m),S(d.$$.fragment,m),m.forEach(g),f.forEach(g),this.h()},h(){Z(n,"display","flex"),Z(n,"justify-content","space-between"),Te(n,"class","svelte-jig4ga"),Te(e,"class","svelte-jig4ga")},m(_,f){v(_,e,f),C(r,e,null),E(e,s),p&&p.m(e,null),E(e,l),E(e,n),C(o,n,null),E(n,c),C(a,n,null),E(n,u),C(d,n,null),k=!0},p(_,[f]){const m={};f&128&&(m.choices=_[7]),!t&&f&1&&(t=!0,m.value=_[0],j(()=>t=!1)),r.$set(m),_[0]?p?(p.p(_,f),f&1&&w(p,1)):(p=Ce(_),p.c(),w(p,1),p.m(e,l)):p&&(z(),D(p,1,1,()=>{p=null}),J());const F={};f&2&&(F.disabled=_[1]),f&524288&&(F.$$scope={dirty:f,ctx:_}),o.$set(F);const $={};f&524288&&($.$$scope={dirty:f,ctx:_}),a.$set($);const T={};f&4&&(T.disabled=_[2]),f&524288&&(T.$$scope={dirty:f,ctx:_}),d.$set(T)},i(_){k||(w(r.$$.fragment,_),w(p),w(o.$$.fragment,_),w(a.$$.fragment,_),w(d.$$.fragment,_),k=!0)},o(_){D(r.$$.fragment,_),D(p),D(o.$$.fragment,_),D(a.$$.fragment,_),D(d.$$.fragment,_),k=!1},d(_){_&&g(e),R(r),p&&p.d(),R(o),R(a),R(d)}}}function kt(i,e,r){let t,s,l;ie(i,B,m=>r(6,l=m));let{value:n}=e,{isFirst:o}=e,{isLast:c}=e,{sectionType:a}=e,{leftFeature:u}=e,{rightFeature:d}=e,k=Xe();function y(m){let F=X(tt);for(let[$,T]of Object.entries(m))F.push([`custom_${$}`,`Custom: ${T.name}`]);return F}function b(m){n=m,r(0,n)}const p=()=>k("moveLeft"),_=()=>k("delete"),f=()=>k("moveRight");return i.$$set=m=>{"value"in m&&r(0,n=m.value),"isFirst"in m&&r(1,o=m.isFirst),"isLast"in m&&r(2,c=m.isLast),"sectionType"in m&&r(3,a=m.sectionType),"leftFeature"in m&&r(4,u=m.leftFeature),"rightFeature"in m&&r(5,d=m.rightFeature)},i.$$.update=()=>{i.$$.dirty&49&&r(8,t=n&&it(n,u,d)),i.$$.dirty&64&&r(7,s=y(l.proposed.customFeatures))},[n,o,c,a,u,d,l,s,t,k,b,p,_,f]}class yt extends se{constructor(e){super(),ne(this,e,kt,wt,re,{value:0,isFirst:1,isLast:2,sectionType:3,leftFeature:4,rightFeature:5})}}function Ne(i,e,r){const t=i.slice();return t[12]=e[r],t[13]=e,t[14]=r,t}function Dt(i){let e;return{c(){e=M("Add")},l(r){e=P(r,"Add")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function Me(i,e){let r,t,s,l;function n(d){e[8](d,e[12],e[13],e[14])}function o(){return e[9](e[14])}function c(){return e[10](e[14])}function a(){return e[11](e[14])}let u={isFirst:e[14]==0,isLast:e[14]==e[0].length-1,leftFeature:e[14]==0?"":e[0][e[14]-1],rightFeature:e[14]==e[0].length-1?"":e[0][e[14]+1],sectionType:e[1]};return e[12]!==void 0&&(u.value=e[12]),t=new yt({props:u}),U.push(()=>A(t,"value",n)),t.$on("delete",o),t.$on("moveLeft",c),t.$on("moveRight",a),{key:i,first:null,c(){r=K(),L(t.$$.fragment),this.h()},l(d){r=K(),S(t.$$.fragment,d),this.h()},h(){this.first=r},m(d,k){v(d,r,k),C(t,d,k),l=!0},p(d,k){e=d;const y={};k&1&&(y.isFirst=e[14]==0),k&1&&(y.isLast=e[14]==e[0].length-1),k&1&&(y.leftFeature=e[14]==0?"":e[0][e[14]-1]),k&1&&(y.rightFeature=e[14]==e[0].length-1?"":e[0][e[14]+1]),k&2&&(y.sectionType=e[1]),!s&&k&1&&(s=!0,y.value=e[12],j(()=>s=!1)),t.$set(y)},i(d){l||(w(t.$$.fragment,d),l=!0)},o(d){D(t.$$.fragment,d),l=!1},d(d){d&&g(r),R(t,d)}}}function Ft(i){let e,r,t,s=[],l=new Map,n,o,c,a,u=i[2].toFixed(2)+"",d,k;e=new ae({props:{$$slots:{default:[Dt]},$$scope:{ctx:i}}}),e.$on("click",i[3]);let y=ee(i[0]);const b=p=>p[14];for(let p=0;p<y.length;p+=1){let _=Ne(i,y,p),f=b(_);l.set(f,s[p]=Me(f,_))}return{c(){L(e.$$.fragment),r=W(),t=O("div");for(let p=0;p<s.length;p+=1)s[p].c();n=W(),o=O("p"),c=M("Total width required (m): "),a=O("b"),d=M(u),this.h()},l(p){S(e.$$.fragment,p),r=N(p),t=V(p,"DIV",{style:!0});var _=G(t);for(let F=0;F<s.length;F+=1)s[F].l(_);_.forEach(g),n=N(p),o=V(p,"P",{});var f=G(o);c=P(f,"Total width required (m): "),a=V(f,"B",{});var m=G(a);d=P(m,u),m.forEach(g),f.forEach(g),this.h()},h(){Z(t,"display","flex"),Z(t,"flex-direction","row")},m(p,_){C(e,p,_),v(p,r,_),v(p,t,_);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(t,null);v(p,n,_),v(p,o,_),E(o,c),E(o,a),E(a,d),k=!0},p(p,[_]){const f={};_&32768&&(f.$$scope={dirty:_,ctx:p}),e.$set(f),_&115&&(y=ee(p[0]),z(),s=Ie(s,_,b,1,p,y,l,t,Oe,Me,null,Ne),J()),(!k||_&4)&&u!==(u=p[2].toFixed(2)+"")&&x(d,u)},i(p){if(!k){w(e.$$.fragment,p);for(let _=0;_<y.length;_+=1)w(s[_]);k=!0}},o(p){D(e.$$.fragment,p);for(let _=0;_<s.length;_+=1)D(s[_]);k=!1},d(p){p&&(g(r),g(t),g(n),g(o)),R(e,p);for(let _=0;_<s.length;_+=1)s[_].d()}}}function Tt(i,e,r){let t,s;ie(i,B,p=>r(7,s=p));let{streetFeaturesLeftToRight:l}=e,{sectionType:n}=e;function o(){r(0,l=[...l,""])}function c(p){l.splice(p,1),r(0,l)}function a(p){r(0,[l[p-1],l[p]]=[l[p],l[p-1]],l)}function u(p){r(0,[l[p+1],l[p]]=[l[p],l[p+1]],l)}function d(p,_,f,m){f[m]=p,r(0,l)}const k=p=>c(p),y=p=>a(p),b=p=>u(p);return i.$$set=p=>{"streetFeaturesLeftToRight"in p&&r(0,l=p.streetFeaturesLeftToRight),"sectionType"in p&&r(1,n=p.sectionType)},i.$$.update=()=>{i.$$.dirty&130&&r(2,t=st(s,n))},[l,n,t,o,c,a,u,s,d,k,y,b]}class Ae extends se{constructor(e){super(),ne(this,e,Tt,Ft,re,{streetFeaturesLeftToRight:0,sectionType:1})}}function Pe(i,e,r){const t=i.slice();return t[6]=e[r][0],t[7]=e[r][1],t[8]=e,t[9]=r,t}function Lt(i){let e;return{c(){e=M("Add")},l(r){e=P(r,"Add")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function St(i){let e;return{c(){e=M("Delete")},l(r){e=P(r,"Delete")},m(r,t){v(r,e,t)},d(r){r&&g(e)}}}function Ee(i,e){let r,t,s,l,n,o,c,a,u,d;function k(f){e[3](f,e[7])}let y={label:"Name"};e[7].name!==void 0&&(y.value=e[7].name),t=new at({props:y}),U.push(()=>A(t,"value",k));function b(f){e[4](f,e[7])}let p={label:"Minimum width (m)",width:3,min:0};e[7].width!==void 0&&(p.value=e[7].width),n=new je({props:p}),U.push(()=>A(n,"value",b));function _(){return e[5](e[6])}return a=new Ve({props:{$$slots:{default:[St]},$$scope:{ctx:e}}}),a.$on("click",_),{key:i,first:null,c(){r=O("div"),L(t.$$.fragment),l=W(),L(n.$$.fragment),c=W(),L(a.$$.fragment),u=W(),this.h()},l(f){r=V(f,"DIV",{style:!0});var m=G(r);S(t.$$.fragment,m),l=N(m),S(n.$$.fragment,m),c=N(m),S(a.$$.fragment,m),u=N(m),m.forEach(g),this.h()},h(){Z(r,"display","flex"),Z(r,"justify-content","space-between"),this.first=r},m(f,m){v(f,r,m),C(t,r,null),E(r,l),C(n,r,null),E(r,c),C(a,r,null),E(r,u),d=!0},p(f,m){e=f;const F={};!s&&m&1&&(s=!0,F.value=e[7].name,j(()=>s=!1)),t.$set(F);const $={};!o&&m&1&&(o=!0,$.value=e[7].width,j(()=>o=!1)),n.$set($);const T={};m&1024&&(T.$$scope={dirty:m,ctx:e}),a.$set(T)},i(f){d||(w(t.$$.fragment,f),w(n.$$.fragment,f),w(a.$$.fragment,f),d=!0)},o(f){D(t.$$.fragment,f),D(n.$$.fragment,f),D(a.$$.fragment,f),d=!1},d(f){f&&g(r),R(t),R(n),R(a)}}}function Ct(i){let e,r,t=[],s=new Map,l,n;e=new ae({props:{$$slots:{default:[Lt]},$$scope:{ctx:i}}}),e.$on("click",i[1]);let o=ee(Object.entries(i[0].proposed.customFeatures));const c=a=>a[6];for(let a=0;a<o.length;a+=1){let u=Pe(i,o,a),d=c(u);s.set(d,t[a]=Ee(d,u))}return{c(){L(e.$$.fragment),r=W();for(let a=0;a<t.length;a+=1)t[a].c();l=K()},l(a){S(e.$$.fragment,a),r=N(a);for(let u=0;u<t.length;u+=1)t[u].l(a);l=K()},m(a,u){C(e,a,u),v(a,r,u);for(let d=0;d<t.length;d+=1)t[d]&&t[d].m(a,u);v(a,l,u),n=!0},p(a,[u]){const d={};u&1024&&(d.$$scope={dirty:u,ctx:a}),e.$set(d),u&5&&(o=ee(Object.entries(a[0].proposed.customFeatures)),z(),t=Ie(t,u,c,1,a,o,s,l.parentNode,Oe,Ee,l,Pe),J())},i(a){if(!n){w(e.$$.fragment,a);for(let u=0;u<o.length;u+=1)w(t[u]);n=!0}},o(a){D(e.$$.fragment,a);for(let u=0;u<t.length;u+=1)D(t[u]);n=!1},d(a){a&&(g(r),g(l)),R(e,a);for(let u=0;u<t.length;u+=1)t[u].d(a)}}}function Rt(i,e,r){let t;ie(i,B,a=>r(0,t=a));function s(){xe(B,t.proposed.customFeatures[lt()]={name:"",width:0},t),B.set(t)}function l(a){let u=t.proposed.customFeatures[a].name;if(t.proposed.desirableMinimumCrossSection.includes(`custom_${a}`)){window.alert(`The ${u} custom feature is used in the Desirable Minimum Cross-Section. Remove it below before deleting.`);return}if(t.proposed.absoluteMinimumCrossSection.includes(`custom_${a}`)){window.alert(`The ${u} custom feature is used in the Absolute Minimum Cross-Section. Remove it below before deleting.`);return}delete t.proposed.customFeatures[a],B.set(t)}function n(a,u){i.$$.not_equal(u.name,a)&&(u.name=a)}function o(a,u){i.$$.not_equal(u.width,a)&&(u.width=a)}return[t,s,l,n,o,a=>l(a)]}class qt extends se{constructor(e){super(),ne(this,e,Rt,Ct,re,{})}}function Be(i){let e,r,t,s;return{c(){e=O("p"),r=M("Effective speed limit, based on the limit and 85 percentile: "),t=M(i[1]),s=M(`
      mph`)},l(l){e=V(l,"P",{});var n=G(e);r=P(n,"Effective speed limit, based on the limit and 85 percentile: "),t=P(n,i[1]),s=P(n,`
      mph`),n.forEach(g)},m(l,n){v(l,e,n),E(e,r),E(e,t),E(e,s)},p(l,n){n&2&&x(t,l[1])},d(l){l&&g(e)}}}function Wt(i){let e,r,t,s,l,n,o,c,a,u,d,k,y,b,p,_,f,m,F,$,T,Y;function He(h){i[4](h)}let pe={label:"Expected peak hour cycle flow: 1-way cycle tracks",emptyOption:!0,choices:X(["<200","200-800",">800"])};i[0].proposed.trafficData.flowOneWay!==void 0&&(pe.value=i[0].proposed.trafficData.flowOneWay),e=new Q({props:pe}),U.push(()=>A(e,"value",He));function Ge(h){i[5](h)}let de={label:"Expected peak hour cycle flow: 2-way cycle tracks",emptyOption:!0,choices:X(["<300","300-1,000",">1,000"])};i[0].proposed.trafficData.flowTwoWay!==void 0&&(de.value=i[0].proposed.trafficData.flowTwoWay),s=new Q({props:de}),U.push(()=>A(s,"value",Ge));function Ke(h){i[6](h)}let me={label:"Expected peak hour cycle flow: shared use cycle tracks",emptyOption:!0,choices:X(["<300",">300"])};i[0].proposed.trafficData.flowSharedUse!==void 0&&(me.value=i[0].proposed.trafficData.flowSharedUse),o=new Q({props:me}),U.push(()=>A(o,"value",Ke));function Ye(h){i[7](h)}let _e={label:"Traffic flow (vpd)",emptyOption:!0,choices:X(["<2,500","2,500-5,000","5,000-10,000",">10,000"])};i[0].proposed.trafficData.trafficFlow!==void 0&&(_e.value=i[0].proposed.trafficData.trafficFlow),u=new Q({props:_e}),U.push(()=>A(u,"value",Ye));function ze(h){i[8](h)}let he={label:"Speed limit (MPH)",emptyOption:!0,choices:i[2]};i[0].proposed.trafficData.speedLimit!==void 0&&(he.value=i[0].proposed.trafficData.speedLimit),y=new Q({props:he}),U.push(()=>A(y,"value",ze));function Je(h){i[9](h)}let $e={label:"Observed 85th percentile speed (MPH)",width:3,min:0,max:120};i[0].proposed.trafficData.observedSpeed!==void 0&&($e.value=i[0].proposed.trafficData.observedSpeed),_=new je({props:$e}),U.push(()=>A(_,"value",Je));let I=i[1]&&Be(i);function Qe(h){i[10](h)}let ge={label:"Street function",emptyOption:!0,choices:X(["High Street (active frontages)","Residential street","Local distributor road"])};return i[0].proposed.trafficData.streetFunction!==void 0&&(ge.value=i[0].proposed.trafficData.streetFunction),$=new Q({props:ge}),U.push(()=>A($,"value",Qe)),{c(){L(e.$$.fragment),t=W(),L(s.$$.fragment),n=W(),L(o.$$.fragment),a=W(),L(u.$$.fragment),k=W(),L(y.$$.fragment),p=W(),L(_.$$.fragment),m=W(),I&&I.c(),F=W(),L($.$$.fragment)},l(h){S(e.$$.fragment,h),t=N(h),S(s.$$.fragment,h),n=N(h),S(o.$$.fragment,h),a=N(h),S(u.$$.fragment,h),k=N(h),S(y.$$.fragment,h),p=N(h),S(_.$$.fragment,h),m=N(h),I&&I.l(h),F=N(h),S($.$$.fragment,h)},m(h,q){C(e,h,q),v(h,t,q),C(s,h,q),v(h,n,q),C(o,h,q),v(h,a,q),C(u,h,q),v(h,k,q),C(y,h,q),v(h,p,q),C(_,h,q),v(h,m,q),I&&I.m(h,q),v(h,F,q),C($,h,q),Y=!0},p(h,q){const be={};!r&&q&1&&(r=!0,be.value=h[0].proposed.trafficData.flowOneWay,j(()=>r=!1)),e.$set(be);const ve={};!l&&q&1&&(l=!0,ve.value=h[0].proposed.trafficData.flowTwoWay,j(()=>l=!1)),s.$set(ve);const we={};!c&&q&1&&(c=!0,we.value=h[0].proposed.trafficData.flowSharedUse,j(()=>c=!1)),o.$set(we);const ke={};!d&&q&1&&(d=!0,ke.value=h[0].proposed.trafficData.trafficFlow,j(()=>d=!1)),u.$set(ke);const ye={};!b&&q&1&&(b=!0,ye.value=h[0].proposed.trafficData.speedLimit,j(()=>b=!1)),y.$set(ye);const De={};!f&&q&1&&(f=!0,De.value=h[0].proposed.trafficData.observedSpeed,j(()=>f=!1)),_.$set(De),h[1]?I?I.p(h,q):(I=Be(h),I.c(),I.m(F.parentNode,F)):I&&(I.d(1),I=null);const Fe={};!T&&q&1&&(T=!0,Fe.value=h[0].proposed.trafficData.streetFunction,j(()=>T=!1)),$.$set(Fe)},i(h){Y||(w(e.$$.fragment,h),w(s.$$.fragment,h),w(o.$$.fragment,h),w(u.$$.fragment,h),w(y.$$.fragment,h),w(_.$$.fragment,h),w($.$$.fragment,h),Y=!0)},o(h){D(e.$$.fragment,h),D(s.$$.fragment,h),D(o.$$.fragment,h),D(u.$$.fragment,h),D(y.$$.fragment,h),D(_.$$.fragment,h),D($.$$.fragment,h),Y=!1},d(h){h&&(g(t),g(n),g(a),g(k),g(p),g(m),g(F)),R(e,h),R(s,h),R(o,h),R(u,h),R(y,h),R(_,h),I&&I.d(h),R($,h)}}}function Nt(i){let e,r;return e=new le({props:{label:"Traffic data and additional information",$$slots:{default:[Wt]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,s){C(e,t,s),r=!0},p(t,[s]){const l={};s&2051&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function Mt(i,e,r){let t,s;ie(i,B,b=>r(0,s=b));let{valid:l}=e,n=X(rt);function o(b){i.$$.not_equal(s.proposed.trafficData.flowOneWay,b)&&(s.proposed.trafficData.flowOneWay=b,B.set(s))}function c(b){i.$$.not_equal(s.proposed.trafficData.flowTwoWay,b)&&(s.proposed.trafficData.flowTwoWay=b,B.set(s))}function a(b){i.$$.not_equal(s.proposed.trafficData.flowSharedUse,b)&&(s.proposed.trafficData.flowSharedUse=b,B.set(s))}function u(b){i.$$.not_equal(s.proposed.trafficData.trafficFlow,b)&&(s.proposed.trafficData.trafficFlow=b,B.set(s))}function d(b){i.$$.not_equal(s.proposed.trafficData.speedLimit,b)&&(s.proposed.trafficData.speedLimit=b,B.set(s))}function k(b){i.$$.not_equal(s.proposed.trafficData.observedSpeed,b)&&(s.proposed.trafficData.observedSpeed=b,B.set(s))}function y(b){i.$$.not_equal(s.proposed.trafficData.streetFunction,b)&&(s.proposed.trafficData.streetFunction=b,B.set(s))}return i.$$set=b=>{"valid"in b&&r(3,l=b.valid)},i.$$.update=()=>{i.$$.dirty&1&&r(3,l=s.proposed.trafficData.flowOneWay!=""&&s.proposed.trafficData.flowTwoWay!=""&&s.proposed.trafficData.flowSharedUse!=""&&s.proposed.trafficData.trafficFlow!=""&&s.proposed.trafficData.speedLimit!=""&&s.proposed.trafficData.observedSpeed!=null&&s.proposed.trafficData.streetFunction!=""),i.$$.dirty&1&&r(1,t=Ue(s.proposed.trafficData.speedLimit,s.proposed.trafficData.observedSpeed))},[s,t,n,l,o,c,a,u,d,k,y]}class Pt extends se{constructor(e){super(),ne(this,e,Mt,Nt,re,{valid:3})}}function Et(i){let e,r;return e=new qt({}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,s){C(e,t,s),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function Bt(i){let e,r="Fill out all traffic data above to continue";return{c(){e=O("p"),e.textContent=r},l(t){e=V(t,"P",{"data-svelte-h":!0}),ue(e)!=="svelte-72a5ry"&&(e.textContent=r)},m(t,s){v(t,e,s)},p:te,i:te,o:te,d(t){t&&g(e)}}}function It(i){let e,r,t,s;return e=new le({props:{label:"Desirable Minimum Cross-Section",$$slots:{default:[Ot]},$$scope:{ctx:i}}}),t=new le({props:{label:"Absolute Minimum Cross-Section",$$slots:{default:[Vt]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment),r=W(),L(t.$$.fragment)},l(l){S(e.$$.fragment,l),r=N(l),S(t.$$.fragment,l)},m(l,n){C(e,l,n),v(l,r,n),C(t,l,n),s=!0},p(l,n){const o={};n&34&&(o.$$scope={dirty:n,ctx:l}),e.$set(o);const c={};n&34&&(c.$$scope={dirty:n,ctx:l}),t.$set(c)},i(l){s||(w(e.$$.fragment,l),w(t.$$.fragment,l),s=!0)},o(l){D(e.$$.fragment,l),D(t.$$.fragment,l),s=!1},d(l){l&&g(r),R(e,l),R(t,l)}}}function Ot(i){let e,r,t;function s(n){i[3](n)}let l={sectionType:"Desirable"};return i[1].proposed.desirableMinimumCrossSection!==void 0&&(l.streetFeaturesLeftToRight=i[1].proposed.desirableMinimumCrossSection),e=new Ae({props:l}),U.push(()=>A(e,"streetFeaturesLeftToRight",s)),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,o){const c={};!r&&o&2&&(r=!0,c.streetFeaturesLeftToRight=n[1].proposed.desirableMinimumCrossSection,j(()=>r=!1)),e.$set(c)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Vt(i){let e,r,t;function s(n){i[4](n)}let l={sectionType:"Absolute"};return i[1].proposed.absoluteMinimumCrossSection!==void 0&&(l.streetFeaturesLeftToRight=i[1].proposed.absoluteMinimumCrossSection),e=new Ae({props:l}),U.push(()=>A(e,"streetFeaturesLeftToRight",s)),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,o){C(e,n,o),t=!0},p(n,o){const c={};!r&&o&2&&(r=!0,c.streetFeaturesLeftToRight=n[1].proposed.absoluteMinimumCrossSection,j(()=>r=!1)),e.$set(c)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Ut(i){let e,r,t,s,l,n,o,c,a,u,d;e=new et({props:{links:[["Tools","/"],["Route cross-section","/cross_section"]],current:"Proposed Cross-Sections"}});function k(f){i[2](f)}let y={};i[0]!==void 0&&(y.valid=i[0]),t=new Pt({props:y}),U.push(()=>A(t,"valid",k)),n=new le({props:{label:"Custom Street Features",$$slots:{default:[Et]},$$scope:{ctx:i}}});const b=[It,Bt],p=[];function _(f,m){return f[0]?0:1}return c=_(i),a=p[c]=b[c](i),{c(){L(e.$$.fragment),r=W(),L(t.$$.fragment),l=W(),L(n.$$.fragment),o=W(),a.c(),u=K()},l(f){S(e.$$.fragment,f),r=N(f),S(t.$$.fragment,f),l=N(f),S(n.$$.fragment,f),o=N(f),a.l(f),u=K()},m(f,m){C(e,f,m),v(f,r,m),C(t,f,m),v(f,l,m),C(n,f,m),v(f,o,m),p[c].m(f,m),v(f,u,m),d=!0},p(f,[m]){const F={};!s&&m&1&&(s=!0,F.valid=f[0],j(()=>s=!1)),t.$set(F);const $={};m&32&&($.$$scope={dirty:m,ctx:f}),n.$set($);let T=c;c=_(f),c===T?p[c].p(f,m):(z(),D(p[T],1,1,()=>{p[T]=null}),J(),a=p[c],a?a.p(f,m):(a=p[c]=b[c](f),a.c()),w(a,1),a.m(u.parentNode,u))},i(f){d||(w(e.$$.fragment,f),w(t.$$.fragment,f),w(n.$$.fragment,f),w(a),d=!0)},o(f){D(e.$$.fragment,f),D(t.$$.fragment,f),D(n.$$.fragment,f),D(a),d=!1},d(f){f&&(g(r),g(l),g(o),g(u)),R(e,f),R(t,f),R(n,f),p[c].d(f)}}}function jt(i,e,r){let t;ie(i,B,c=>r(1,t=c));let s=!1;function l(c){s=c,r(0,s)}function n(c){i.$$.not_equal(t.proposed.desirableMinimumCrossSection,c)&&(t.proposed.desirableMinimumCrossSection=c,B.set(t))}function o(c){i.$$.not_equal(t.proposed.absoluteMinimumCrossSection,c)&&(t.proposed.absoluteMinimumCrossSection=c,B.set(t))}return[s,t,l,n,o]}class sr extends se{constructor(e){super(),ne(this,e,jt,Ut,re,{})}}export{sr as component};
