import{s as fe,v as ge,e as m,a as _,t as q,c as f,b,m as D,g as k,d as L,f as c,o as ae,i as W,h as n,j as F,x as Ce,k as de}from"../chunks/scheduler.D-L5_EKR.js";import{S as he,i as pe,e as ve,c as le,a as oe,m as re,t as se,b as ne,d as ie}from"../chunks/index.DlIJmOlE.js";import{s as ue}from"../chunks/data.Bf-mRr8I.js";import{d as _e,s as ce}from"../chunks/index.Bwlmt_-P.js";import{S as ke}from"../chunks/SecondaryButton.BwAQ38qq.js";/* empty css                                                               */import{T as xe}from"../chunks/TextArea.2b1Cppq0.js";import{E as ye}from"../chunks/exceljs.min.BuyXGIGS.js";const Se=""+new URL("../assets/blank_area_check.Bd5ntWwK.xlsx",import.meta.url).href;async function be(e){console.log("Loading blank area check xlsx");let t=await(await fetch(Se)).arrayBuffer(),a=new ye.Workbook;await a.xlsx.load(t),$e(e,a),we(e,a),Ee(e,a),a.getWorksheet("Results & Commentary").getCell("F17").value=e.resultsNotes,console.log("Writing area check xlsx");let s=await a.xlsx.writeBuffer();_e(s,"out.xlsx")}function $e(e,o){let t=o.getWorksheet("Summary of Scheme");t.getCell("C6").value=e.summary.dateDesignReview,t.getCell("C7").value=e.summary.schemeReference,t.getCell("C8").value=e.summary.schemeName,t.getCell("C9").value=e.summary.schemeSummary,t.getCell("C10").value=e.summary.schemeInfoReviewed,t.getCell("C11").value=e.summary.authority,t.getCell("C12").value=e.summary.transportOrCombinedAuthority,t.getCell("C13").value=e.summary.region,t.getCell("C14").value=e.summary.fundingProgramme,t.getCell("C15").value=e.summary.designStage,t.getCell("C16").value=e.summary.fundingConditions,t.getCell("C17").value=e.summary.inspectorEmail,t.getCell("C18").value=e.summary.schemeAreaSizeKm2,t.getCell("C19").value=e.summary.notes}function we(e,o){let t=o.getWorksheet("Traffic Mitigation Check"),a=e.trafficMitigationCheck;t.getCell("C6").value=a.q1,t.getCell("C11").value=a.q2,t.getCell("C16").value=a.q3,a.q3=="Major routes (e.g. scheme eliminates a rat run)"?(t.getCell("C21").value=a.majorQ1,t.getCell("C26").value=a.majorQ2,t.getCell("C31").value=a.majorQ3,t.getCell("C36").value=a.majorQ4):a.q3=="Minor streets (e.g. residential)"&&(t.getCell("C21").value=a.minorQ1,t.getCell("C26").value=a.minorQ2),t.getCell("E11").value=a.notes}function Ee(e,o){let t=o.getWorksheet("Area Scorecard"),a=[10,15,21,26,32,37,43,48,54,60,66,72,78];for(let s=0;s<e.existingScores.length;s++){t.getCell("H"+a[s]).value=e.existingScoreNotes[s],t.getCell("L"+a[s]).value=e.proposedScoreNotes[s];for(let[i,g]of["4","3","2","1","0"].entries())t.getCell("F"+(a[s]+i)).value=e.existingScores[s]==g||i==0&&e.existingScores[s]==""?"Yes":"No",t.getCell("J"+(a[s]+i)).value=e.proposedScores[s]==g||i==0&&e.proposedScores[s]==""?"Yes":"No"}}function Te(e){let o;return{c(){o=q("Convert to .xlsx (takes a few seconds)")},l(t){o=L(t,"Convert to .xlsx (takes a few seconds)")},m(t,a){W(t,o,a)},d(t){t&&c(o)}}}function Me(e){let o,t,a="Traffic Mitigation Check Results",s,i,g=e[0].trafficMitigationCheck.notes+"",$,u,C,y,z="Area Scorecard Results",I,w,V="<th>Existing Area Score</th> <th>Proposed Area Score</th> <th>Uplift</th>",O,d,T,B,U,M,P,J,N,A=e[1]-e[2]+"",j,K,h,Y,H,p,Q,S,G=`<i>When you open the file, you need to force Excel to recalculate all formulas
    with Ctrl + Alt + F9</i>`,x;function me(l){e[3](l)}let X={label:"Comments on Area Scorecard"};return e[0].resultsNotes!==void 0&&(X.value=e[0].resultsNotes),h=new xe({props:X}),ge.push(()=>ve(h,"value",me)),p=new ke({props:{$$slots:{default:[Te]},$$scope:{ctx:e}}}),p.$on("click",e[4]),{c(){o=m("div"),t=m("h2"),t.textContent=a,s=_(),i=m("p"),$=q(g),u=_(),C=m("table"),y=m("caption"),y.textContent=z,I=_(),w=m("tr"),w.innerHTML=V,O=_(),d=m("tr"),T=m("td"),B=q(e[2]),U=_(),M=m("td"),P=q(e[1]),J=_(),N=m("td"),j=q(A),K=_(),le(h.$$.fragment),H=_(),le(p.$$.fragment),Q=_(),S=m("p"),S.innerHTML=G,this.h()},l(l){o=f(l,"DIV",{class:!0});var r=b(o);t=f(r,"H2",{"data-svelte-h":!0}),D(t)!=="svelte-anx0ls"&&(t.textContent=a),s=k(r),i=f(r,"P",{});var R=b(i);$=L(R,g),R.forEach(c),u=k(r),C=f(r,"TABLE",{});var v=b(C);y=f(v,"CAPTION",{class:!0,"data-svelte-h":!0}),D(y)!=="svelte-n1427n"&&(y.textContent=z),I=k(v),w=f(v,"TR",{"data-svelte-h":!0}),D(w)!=="svelte-18seq6c"&&(w.innerHTML=V),O=k(v),d=f(v,"TR",{});var E=b(d);T=f(E,"TD",{});var Z=b(T);B=L(Z,e[2]),Z.forEach(c),U=k(E),M=f(E,"TD",{});var ee=b(M);P=L(ee,e[1]),ee.forEach(c),J=k(E),N=f(E,"TD",{});var te=b(N);j=L(te,A),te.forEach(c),E.forEach(c),v.forEach(c),K=k(r),oe(h.$$.fragment,r),r.forEach(c),H=k(l),oe(p.$$.fragment,l),Q=k(l),S=f(l,"P",{"data-svelte-h":!0}),D(S)!=="svelte-6hhtkc"&&(S.innerHTML=G),this.h()},h(){ae(y,"class","govuk-table__caption govuk-table__caption--m"),ae(o,"class","govuk-width-container")},m(l,r){W(l,o,r),n(o,t),n(o,s),n(o,i),n(i,$),n(o,u),n(o,C),n(C,y),n(C,I),n(C,w),n(C,O),n(C,d),n(d,T),n(T,B),n(d,U),n(d,M),n(M,P),n(d,J),n(d,N),n(N,j),n(o,K),re(h,o,null),W(l,H,r),re(p,l,r),W(l,Q,r),W(l,S,r),x=!0},p(l,[r]){(!x||r&1)&&g!==(g=l[0].trafficMitigationCheck.notes+"")&&F($,g),(!x||r&4)&&F(B,l[2]),(!x||r&2)&&F(P,l[1]),(!x||r&6)&&A!==(A=l[1]-l[2]+"")&&F(j,A);const R={};!Y&&r&1&&(Y=!0,R.value=l[0].resultsNotes,Ce(()=>Y=!1)),h.$set(R);const v={};r&64&&(v.$$scope={dirty:r,ctx:l}),p.$set(v)},i(l){x||(se(h.$$.fragment,l),se(p.$$.fragment,l),x=!0)},o(l){ne(h.$$.fragment,l),ne(p.$$.fragment,l),x=!1},d(l){l&&(c(o),c(H),c(Q),c(S)),ie(h),ie(p,l)}}}function Ne(e,o,t){let a,s,i;de(e,ue,u=>t(0,i=u));function g(u){e.$$.not_equal(i.resultsNotes,u)&&(i.resultsNotes=u,ue.set(i))}const $=()=>be(i);return e.$$.update=()=>{e.$$.dirty&1&&t(2,a=ce(i.existingScores.map(u=>parseInt(u||"0")))),e.$$.dirty&1&&t(1,s=ce(i.proposedScores.map(u=>parseInt(u||"0"))))},[i,s,a,g,$]}class He extends he{constructor(o){super(),pe(this,o,Ne,Me,fe,{})}}export{He as component};
