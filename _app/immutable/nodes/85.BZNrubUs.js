import{s as y,e as m,a as S,t as v,c as h,p as P,g as k,b as L,d as $,f as p,i as f,h as x,j as R,n as d,k as A}from"../chunks/scheduler.Bsni_e59.js";import{S as O,i as D}from"../chunks/index.CCfAUppz.js";import{s as T}from"../chunks/data.DXCRtQFg.js";import{g as _}from"../chunks/results.CG6JO5Ni.js";function C(t){let e=_(t),i=t.summary.checkType=="street",o=t.summary.checkType=="path",n={Safety:"Sa",Accessibility:"Ac",Comfort:"Cf",Directness:"Di",Attractiveness:"At",Cohesion:"Co",overall:"To"},l={"Social activity":"SA","Personal security":"PS","Character and legibility":"CL",Environment:"En",overall:"To"};return[...E(t),...j(t),...g("SA",0,t.safetyCheck),...g("ST",16,t.streetCheck),...g("SP",0,t.streetPlacemakingCheck),...g("PA",16,t.pathCheck),...g("PP",16,t.pathPlacemakingCheck),...b(t),...w(t),...a("ST-LOS",[...e.levelOfService,e.overall],i,n),...a("ST-LOS",e.byMode,i,{walking:"Wa",wheeling:"Wh",cycling:"Cy"}),...a("SP-LOS",[...e.placemakingCategories,e.placemakingOverall],i,l),...a("PA-LOS",[...e.levelOfService,e.overall],o,n),...a("PA-LOS",e.byMode,o,{walking:"Wa",wheeling:"Wh",cycling:"Cy",horse:"HR"}),...a("PP-LOS",[...e.placemakingCategories,e.placemakingOverall],o,l),...I(t,e),...W(t)]}function E(t){let e=t.summary;return[["Scheme Ref",e.schemeReference],["Date of Design Review",e.dateDesignReview],["Scheme Name",e.schemeName],["Authority",e.authority],["Transport/ Combined Authority",e.transportOrCombinedAuthority],["Region",e.region],["Funding Programme",e.fundingProgramme],["Design Stage",e.designStage],["Funding Conditions",e.fundingConditions],["Inspector",e.inspectorEmail],["RouteLength",e.totalRouteLengthKm],["RouteFileLength",e.assessedRouteLengthKm],["Notes",e.notes],["Tool","Route Check online-alpha"],["Sub-tool",e.checkType=="street"?"Street Check":"Path Check"]]}function j(t){let e=[];for(let[i,o]of t.policyCheck.entries())e.push([`PC${u(i)}-E`,o.existing]),e.push([`PC${u(i)}-D`,o.proposed]);return e}function g(t,e,i){let o=[];for(let n=0;n<i.existingScores.length;n++)o.push([`${t}${u(n+e)}-E`,i.existingScores[n]]),o.push([`${t}${u(n+e)}-D`,i.proposedScores[n]]);return o}function u(t){return(t+1).toString().padStart(2,"0")}function b(t){let e={existing:t.policyConflictLog.filter(i=>i.stage=="Existing").length,designed:t.policyConflictLog.filter(i=>i.stage=="Design").length,removed:t.policyConflictLog.filter(i=>i.resolved=="Yes").length};return[["PC-E",e.existing],["PC-D",e.designed],["PC-Rem",e.removed],["PC-Int",e.designed],["PC-Tot",e.designed+e.existing-e.removed]]}function w(t){let e={existing:t.criticalIssues.filter(i=>i.stage=="Existing").length,designed:t.criticalIssues.filter(i=>i.stage=="Design").length,removed:t.criticalIssues.filter(i=>i.resolved=="Yes").length};return[["SA-E",e.existing],["SA-D",e.designed],["SA-Rem",e.removed],["SA-Int",e.designed],["SA-Tot",e.designed+e.existing-e.removed]]}function a(t,e,i,o){let n=[];for(let l of e){let r=o[l.category];n.push([`${t}-${r}-E`,i?"":`${Math.round(l.existing.scorePercent)}%`]),n.push([`${t}-${r}-D`,i?"":`${Math.round(l.proposed.scorePercent)}%`])}return n}function I(t,e){let i=[],o=12;for(let n=1;n<=o;n++)for(let[l,r]of[["walkingWheeling","WW"],["cycling","Cy"],["total","To"]])i.push([`J${n}-LOS-${r}-E`,n<=e.jat.length?e.jat[n-1][l].existing:""]),i.push([`J${n}-LOS-${r}-D`,n<=e.jat.length?e.jat[n-1][l].proposed:""]);for(let n=1;n<=o;n++)n<=e.jat.length?i.push([`J${n}-Arms`,t.jat[n-1].proposed.movements.filter(l=>l.kind=="pedestrian").length]):i.push([`J${n}-Arms`,0]);return i}function J(t,e){let i=t.policyConflictLog[e],o=0;for(let l=0;l<=e;l++)t.policyConflictLog[l].conflict==i.conflict&&o++;return[t.summary.schemeReference,`P${i.conflict.padStart(3,"0")}`,`${o.toString().padStart(2,"0")}P`].join("_")}function W(t){let e=[],i=35;for(let o=0;o<i;o++){let n;if(o<t.policyConflictLog.length){let l=t.policyConflictLog[o];n={Ref:J(t,o),Typ:l.conflict,Sta:l.stage,LaL:`${l.point[1]}, ${l.point[0]}`,Loc:l.locationName,Res:l.resolved,Com:l.notes}}else n={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[l,r]of Object.entries(n))e.push([`${u(o)}PC${l}`,r])}return e}function N(t){let e,i="TODO. Below is the start to the DALOG output.",o,n,l=JSON.stringify(C(t[0]),null,"  ")+"",r;return{c(){e=m("p"),e.textContent=i,o=S(),n=m("pre"),r=v(l)},l(s){e=h(s,"P",{"data-svelte-h":!0}),P(e)!=="svelte-10g90aq"&&(e.textContent=i),o=k(s),n=h(s,"PRE",{});var c=L(n);r=$(c,l),c.forEach(p)},m(s,c){f(s,e,c),f(s,o,c),f(s,n,c),x(n,r)},p(s,[c]){c&1&&l!==(l=JSON.stringify(C(s[0]),null,"  ")+"")&&R(r,l)},i:d,o:d,d(s){s&&(p(e),p(o),p(n))}}}function M(t,e,i){let o;return A(t,T,n=>i(0,o=n)),[o]}class Y extends O{constructor(e){super(),D(this,e,M,N,y,{})}}export{Y as component};
