import{s as St,p as X,e as B,a as y,t as he,c as N,x as se,g as $,b as pe,d as ge,f as I,q as ce,i as me,h as p,r as Z,k as Mt,O as Qt,w as _t,A as jt,j as er}from"../chunks/scheduler.C0ulHN8K.js";import{S as Et,i as kt,e as Q,c as E,a as k,m as L,t as P,g as tr,b as S,f as rr,d as A}from"../chunks/index.D0begEaS.js";import{p as Le}from"../chunks/index.YLlc_VAO.js";import{S as bt}from"../chunks/Select.BD67FBW0.js";import{T as Oe}from"../chunks/TextArea.rFpIclU-.js";import{T as Te}from"../chunks/TextInput.DYQX_wRu.js";import{s as G}from"../chunks/data.CugHHTb3.js";import{S as Ne,a as nr,t as ir,r as ar,f as or,d as sr}from"../chunks/lists.Ck-fV-N5.js";import"../chunks/paths.ArZyOjwu.js";import{E as lr}from"../chunks/ErrorMessage.MCHYhRZR.js";import{F as ur}from"../chunks/FileInput.CSr50loT.js";import{W as mr,S as fr}from"../chunks/WarningButton.1L7-E1vj.js";import{E as cr}from"../chunks/ExternalLink.zCV_yNpK.js";/* empty css                                                               */import{M as pr,b as hr,C as gr,e as dr}from"../chunks/index.DyQLronI.js";import{D as vr}from"../chunks/DecimalInput.C261lj8P.js";function wt(t){let e,r,n,i;return e=new mr({props:{$$slots:{default:[yr]},$$scope:{ctx:t}}}),e.$on("click",t[3]),n=new fr({props:{$$slots:{default:[$r]},$$scope:{ctx:t}}}),n.$on("click",t[6]),{c(){E(e.$$.fragment),r=y(),E(n.$$.fragment)},l(a){k(e.$$.fragment,a),r=$(a),k(n.$$.fragment,a)},m(a,s){L(e,a,s),me(a,r,s),L(n,a,s),i=!0},p(a,s){const m={};s&256&&(m.$$scope={dirty:s,ctx:a}),e.$set(m);const o={};s&256&&(o.$$scope={dirty:s,ctx:a}),n.$set(o)},i(a){i||(P(e.$$.fragment,a),P(n.$$.fragment,a),i=!0)},o(a){S(e.$$.fragment,a),S(n.$$.fragment,a),i=!1},d(a){a&&I(r),A(e,a),A(n,a)}}}function yr(t){let e;return{c(){e=he("Clear map")},l(r){e=ge(r,"Clear map")},m(r,n){me(r,e,n)},d(r){r&&I(e)}}}function $r(t){let e;return{c(){e=he("Zoom to fit")},l(r){e=ge(r,"Zoom to fit")},m(r,n){me(r,e,n)},d(r){r&&I(e)}}}function _r(t){let e;return{c(){e=he("Scheme Sketcher")},l(r){e=ge(r,"Scheme Sketcher")},m(r,n){me(r,e,n)},d(r){r&&I(e)}}}function br(t){let e,r;return e=new gr({props:{gj:t[2].summary.networkMap,show:!0}}),{c(){E(e.$$.fragment)},l(n){k(e.$$.fragment,n)},m(n,i){L(e,n,i),r=!0},p(n,i){const a={};i&4&&(a.gj=n[2].summary.networkMap),e.$set(a)},i(n){r||(P(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){A(e,n)}}}function wr(t){let e,r="Network Context",n,i,a,s,m=`Please add a map showing the area being assessed, including the location
      of measures proposed by the scheme.`,o,h,w,c,C,M,d,H="You can use the external Scheme Sketcher tool to draw this map:",ee,g,x,R,u,F,ae,K,Pe="Choose the area best covering this scheme",de,V,Ce=`Use the <i>New polygon</i>
        tools (freehand or snapped) to sketch the area.`,ve,W,Se="Optionally, include more point and route details.",ye,J,Me=`You can set <i>Name</i>
        and
        <i>Description</i>
        to whatever is useful for display on the map`,$e,U,Ee=`Save the map by clicking <i>Manage files</i>
        , then
        <i>Save</i>`,_e,re,te="Load the saved file above",be,ne,q,we,fe;h=new ur({props:{label:"Import from GeoJSON file",onLoad:t[4]}}),c=new lr({props:{errorMessage:t[1]}});let b=t[2].summary.networkMap.features.length>0&&wt(t);u=new cr({props:{href:"https://acteng.github.io/atip",$$slots:{default:[_r]},$$scope:{ctx:t}}});function ke(v){t[7](v)}let Fe={$$slots:{default:[br]},$$scope:{ctx:t}};return t[0]!==void 0&&(Fe.map=t[0]),q=new pr({props:Fe}),X.push(()=>Q(q,"map",ke)),{c(){e=B("h2"),e.textContent=r,n=y(),i=B("div"),a=B("div"),s=B("p"),s.textContent=m,o=y(),E(h.$$.fragment),w=y(),E(c.$$.fragment),C=y(),b&&b.c(),M=y(),d=B("p"),d.textContent=H,ee=y(),g=B("ol"),x=B("li"),R=he("Go to the "),E(u.$$.fragment),F=he(" tool"),ae=y(),K=B("li"),K.textContent=Pe,de=y(),V=B("li"),V.innerHTML=Ce,ve=y(),W=B("li"),W.textContent=Se,ye=y(),J=B("li"),J.innerHTML=Me,$e=y(),U=B("li"),U.innerHTML=Ee,_e=y(),re=B("li"),re.textContent=te,be=y(),ne=B("div"),E(q.$$.fragment),this.h()},l(v){e=N(v,"H2",{"data-svelte-h":!0}),se(e)!=="svelte-1ru16kh"&&(e.textContent=r),n=$(v),i=N(v,"DIV",{style:!0});var O=pe(i);a=N(O,"DIV",{style:!0});var D=pe(a);s=N(D,"P",{"data-svelte-h":!0}),se(s)!=="svelte-1bo1bph"&&(s.textContent=m),o=$(D),k(h.$$.fragment,D),w=$(D),k(c.$$.fragment,D),C=$(D),b&&b.l(D),M=$(D),d=N(D,"P",{"data-svelte-h":!0}),se(d)!=="svelte-1els6f1"&&(d.textContent=H),ee=$(D),g=N(D,"OL",{});var T=pe(g);x=N(T,"LI",{});var ie=pe(x);R=ge(ie,"Go to the "),k(u.$$.fragment,ie),F=ge(ie," tool"),ie.forEach(I),ae=$(T),K=N(T,"LI",{"data-svelte-h":!0}),se(K)!=="svelte-aj705b"&&(K.textContent=Pe),de=$(T),V=N(T,"LI",{"data-svelte-h":!0}),se(V)!=="svelte-185cfyh"&&(V.innerHTML=Ce),ve=$(T),W=N(T,"LI",{"data-svelte-h":!0}),se(W)!=="svelte-14ytbn2"&&(W.textContent=Se),ye=$(T),J=N(T,"LI",{"data-svelte-h":!0}),se(J)!=="svelte-1r1ljcj"&&(J.innerHTML=Me),$e=$(T),U=N(T,"LI",{"data-svelte-h":!0}),se(U)!=="svelte-sz4wlr"&&(U.innerHTML=Ee),_e=$(T),re=N(T,"LI",{"data-svelte-h":!0}),se(re)!=="svelte-x3zkxb"&&(re.textContent=te),T.forEach(I),D.forEach(I),be=$(O),ne=N(O,"DIV",{style:!0});var qe=pe(ne);k(q.$$.fragment,qe),qe.forEach(I),O.forEach(I),this.h()},h(){ce(a,"width","30%"),ce(a,"overflow-y","scroll"),ce(a,"padding","10px"),ce(a,"border","1px solid black"),ce(ne,"position","relative"),ce(ne,"width","70%"),ce(i,"display","flex"),ce(i,"height","80vh")},m(v,O){me(v,e,O),me(v,n,O),me(v,i,O),p(i,a),p(a,s),p(a,o),L(h,a,null),p(a,w),L(c,a,null),p(a,C),b&&b.m(a,null),p(a,M),p(a,d),p(a,ee),p(a,g),p(g,x),p(x,R),L(u,x,null),p(x,F),p(g,ae),p(g,K),p(g,de),p(g,V),p(g,ve),p(g,W),p(g,ye),p(g,J),p(g,$e),p(g,U),p(g,_e),p(g,re),p(i,be),p(i,ne),L(q,ne,null),fe=!0},p(v,[O]){const D={};O&2&&(D.errorMessage=v[1]),c.$set(D),v[2].summary.networkMap.features.length>0?b?(b.p(v,O),O&4&&P(b,1)):(b=wt(v),b.c(),P(b,1),b.m(a,M)):b&&(tr(),S(b,1,1,()=>{b=null}),rr());const T={};O&256&&(T.$$scope={dirty:O,ctx:v}),u.$set(T);const ie={};O&260&&(ie.$$scope={dirty:O,ctx:v}),!we&&O&1&&(we=!0,ie.map=v[0],Z(()=>we=!1)),q.$set(ie)},i(v){fe||(P(h.$$.fragment,v),P(c.$$.fragment,v),P(b),P(u.$$.fragment,v),P(q.$$.fragment,v),fe=!0)},o(v){S(h.$$.fragment,v),S(c.$$.fragment,v),S(b),S(u.$$.fragment,v),S(q.$$.fragment,v),fe=!1},d(v){v&&(I(e),I(n),I(i)),A(h),A(c),b&&b.d(),A(u),A(q)}}}function Pr(t,e,r){let n;Mt(t,G,c=>r(2,n=c));let i,a="";Qt(()=>{o(!1)});function s(){window.confirm("Do you really want to erase the map data?")&&_t(G,n.summary.networkMap={type:"FeatureCollection",features:[]},n)}function m(c,C){var M;r(1,a="");try{let d=JSON.parse(C);if(d.type!="FeatureCollection")throw new Error("This doesn't look like a GeoJSON file");if(!((M=d.origin)!=null&&M.startsWith("atip-")))throw new Error("This file wasn't produced with the Scheme Sketcher");if(d.crs)throw new Error("This file has a Coordinate Reference System set; it's not suitable for a web map");_t(G,n.summary.networkMap=d,n),o(!0)}catch(d){r(1,a=`Error importing ${c}: ${d}`)}}function o(c){let C={type:"FeatureCollection",features:n.summary.networkMap.features};C.features.length>0&&i.fitBounds(hr(C),{padding:20,animate:c})}const h=()=>o(!0);function w(c){i=c,r(0,i)}return[i,a,n,s,m,o,h,w]}class Cr extends Et{constructor(e){super(),kt(this,e,Pr,wr,St,{})}}var Sr=Object.defineProperty,_=(t,e)=>Sr(t,"name",{value:e,configurable:!0}),Mr=class{constructor(e){this.direction=!1,this.compareProperties=!0;var r,n,i;this.precision=10**-((r=e==null?void 0:e.precision)!=null?r:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(i=e==null?void 0:e.compareProperties)!=null?i:!0}compare(e,r){if(e.type!==r.type||!Ae(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(e,r);case"GeometryCollection":return this.compareGeometryCollection(e,r);case"Feature":return this.compareFeature(e,r);case"FeatureCollection":return this.compareFeatureCollection(e,r);default:if(e.type.startsWith("Multi")){const n=ze(e),i=ze(r);return n.every(a=>i.some(s=>this.compare(a,s)))}}return!1}compareCoord(e,r){return e.length===r.length&&e.every((n,i)=>Math.abs(n-r[i])<this.precision)}compareLine(e,r,n=0,i=!1){if(!Ae(e,r))return!1;const a=e;let s=r;if(i&&!this.compareCoord(a[0],s[0])){const o=this.fixStartIndex(s,a);if(o)s=o;else return!1}const m=this.compareCoord(a[n],s[n]);return this.direction||m?this.comparePath(a,s):this.compareCoord(a[n],s[s.length-(1+n)])?this.comparePath(a.slice().reverse(),s):!1}fixStartIndex(e,r){let n,i=-1;for(let a=0;a<e.length;a++)if(this.compareCoord(e[a],r[0])){i=a;break}return i>=0&&(n=[].concat(e.slice(i,e.length),e.slice(1,i+1))),n}comparePath(e,r){return e.every((n,i)=>this.compareCoord(n,r[i]))}comparePolygon(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),i=r.coordinates.slice(1,r.coordinates.length);return n.every(a=>i.some(s=>this.compareLine(a,s,1,!0)))}return!1}compareGeometryCollection(e,r){return Ae(e.geometries,r.geometries)&&this.compareBBox(e,r)&&e.geometries.every((n,i)=>this.compare(n,r.geometries[i]))}compareFeature(e,r){return e.id===r.id&&(this.compareProperties?dr(e.properties,r.properties):!0)&&this.compareBBox(e,r)&&this.compare(e.geometry,r.geometry)}compareFeatureCollection(e,r){return Ae(e.features,r.features)&&this.compareBBox(e,r)&&e.features.every((n,i)=>this.compare(n,r.features[i]))}compareBBox(e,r){return!e.bbox&&!r.bbox||(e.bbox&&r.bbox?this.compareCoord(e.bbox,r.bbox):!1)}};_(Mr,"GeojsonEquality");function Ae(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}_(Ae,"sameLength");function ze(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}_(ze,"explode");var j=63710088e-1,Lt={centimeters:j*100,centimetres:j*100,degrees:360/(2*Math.PI),feet:j*3.28084,inches:j*39.37,kilometers:j/1e3,kilometres:j/1e3,meters:j,metres:j,miles:j/1609.344,millimeters:j*1e3,millimetres:j*1e3,nauticalmiles:j/1852,radians:1,yards:j*1.0936},Pt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function oe(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}_(oe,"feature");function Er(t,e,r={}){switch(t){case"Point":return le(e).geometry;case"LineString":return ue(e).geometry;case"Polygon":return Ve(e).geometry;case"MultiPoint":return Rt(e).geometry;case"MultiLineString":return At(e).geometry;case"MultiPolygon":return Ft(e).geometry;default:throw new Error(t+" is invalid")}}_(Er,"geometry");function le(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!De(t[0])||!De(t[1]))throw new Error("coordinates must contain numbers");return oe({type:"Point",coordinates:t},e,r)}_(le,"point");function kr(t,e,r={}){return Ge(t.map(n=>le(n,e)),r)}_(kr,"points");function Ve(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return oe({type:"Polygon",coordinates:t},e,r)}_(Ve,"polygon");function Lr(t,e,r={}){return Ge(t.map(n=>Ve(n,e)),r)}_(Lr,"polygons");function ue(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return oe({type:"LineString",coordinates:t},e,r)}_(ue,"lineString");function Ar(t,e,r={}){return Ge(t.map(n=>ue(n,e)),r)}_(Ar,"lineStrings");function Ge(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}_(Ge,"featureCollection");function At(t,e,r={}){return oe({type:"MultiLineString",coordinates:t},e,r)}_(At,"multiLineString");function Rt(t,e,r={}){return oe({type:"MultiPoint",coordinates:t},e,r)}_(Rt,"multiPoint");function Ft(t,e,r={}){return oe({type:"MultiPolygon",coordinates:t},e,r)}_(Ft,"multiPolygon");function Rr(t,e,r={}){return oe({type:"GeometryCollection",geometries:t},e,r)}_(Rr,"geometryCollection");function Fr(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,e||0);return Math.round(t*r)/r}_(Fr,"round");function qt(t,e="kilometers"){const r=Lt[e];if(!r)throw new Error(e+" units is invalid");return t*r}_(qt,"radiansToLength");function We(t,e="kilometers"){const r=Lt[e];if(!r)throw new Error(e+" units is invalid");return t/r}_(We,"lengthToRadians");function qr(t,e){return Ot(We(t,e))}_(qr,"lengthToDegrees");function Or(t){let e=t%360;return e<0&&(e+=360),e}_(Or,"bearingToAzimuth");function Ot(t){return t%(2*Math.PI)*180/Math.PI}_(Ot,"radiansToDegrees");function Tr(t){return t%360*Math.PI/180}_(Tr,"degreesToRadians");function Dr(t,e="kilometers",r="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return qt(We(t,e),r)}_(Dr,"convertLength");function Gr(t,e="meters",r="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const n=Pt[e];if(!n)throw new Error("invalid original units");const i=Pt[r];if(!i)throw new Error("invalid final units");return t/n*i}_(Gr,"convertArea");function De(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}_(De,"isNumber");function Je(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}_(Je,"isObject");function xr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!De(e))throw new Error("bbox must only contain numbers")})}_(xr,"validateBBox");function Br(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}_(Br,"validateId");var Nr=Object.defineProperty,z=(t,e)=>Nr(t,"name",{value:e,configurable:!0});function Re(t,e,r){if(t!==null)for(var n,i,a,s,m,o,h,w=0,c=0,C,M=t.type,d=M==="FeatureCollection",H=M==="Feature",ee=d?t.features.length:1,g=0;g<ee;g++){h=d?t.features[g].geometry:H?t.geometry:t,C=h?h.type==="GeometryCollection":!1,m=C?h.geometries.length:1;for(var x=0;x<m;x++){var R=0,u=0;if(s=C?h.geometries[x]:h,s!==null){o=s.coordinates;var F=s.type;switch(w=r&&(F==="Polygon"||F==="MultiPolygon")?1:0,F){case null:break;case"Point":if(e(o,c,g,R,u)===!1)return!1;c++,R++;break;case"LineString":case"MultiPoint":for(n=0;n<o.length;n++){if(e(o[n],c,g,R,u)===!1)return!1;c++,F==="MultiPoint"&&R++}F==="LineString"&&R++;break;case"Polygon":case"MultiLineString":for(n=0;n<o.length;n++){for(i=0;i<o[n].length-w;i++){if(e(o[n][i],c,g,R,u)===!1)return!1;c++}F==="MultiLineString"&&R++,F==="Polygon"&&u++}F==="Polygon"&&R++;break;case"MultiPolygon":for(n=0;n<o.length;n++){for(u=0,i=0;i<o[n].length;i++){for(a=0;a<o[n][i].length-w;a++){if(e(o[n][i][a],c,g,R,u)===!1)return!1;c++}u++}R++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(Re(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}z(Re,"coordEach");function Ir(t,e,r,n){var i=r;return Re(t,function(a,s,m,o,h){s===0&&r===void 0?i=a:i=e(i,a,s,m,o,h)},n),i}z(Ir,"coordReduce");function Tt(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&e(t.features[r].properties,r)!==!1;r++);break;case"Feature":e(t.properties,0);break}}z(Tt,"propEach");function zr(t,e,r){var n=r;return Tt(t,function(i,a){a===0&&r===void 0?n=i:n=e(n,i,a)}),n}z(zr,"propReduce");function Dt(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}z(Dt,"featureEach");function Hr(t,e,r){var n=r;return Dt(t,function(i,a){a===0&&r===void 0?n=i:n=e(n,i,a)}),n}z(Hr,"featureReduce");function Kr(t){var e=[];return Re(t,function(r){e.push(r)}),e}z(Kr,"coordAll");function Ue(t,e){var r,n,i,a,s,m,o,h,w,c,C=0,M=t.type==="FeatureCollection",d=t.type==="Feature",H=M?t.features.length:1;for(r=0;r<H;r++){for(m=M?t.features[r].geometry:d?t.geometry:t,h=M?t.features[r].properties:d?t.properties:{},w=M?t.features[r].bbox:d?t.bbox:void 0,c=M?t.features[r].id:d?t.id:void 0,o=m?m.type==="GeometryCollection":!1,s=o?m.geometries.length:1,i=0;i<s;i++){if(a=o?m.geometries[i]:m,a===null){if(e(null,C,h,w,c)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,C,h,w,c)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],C,h,w,c)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}z(Ue,"geomEach");function Gt(t,e,r){var n=r;return Ue(t,function(i,a,s,m,o){a===0&&r===void 0?n=i:n=e(n,i,a,s,m,o)}),n}z(Gt,"geomReduce");function xe(t,e){Ue(t,function(r,n,i,a,s){var m=r===null?null:r.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return e(oe(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var o;switch(m){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon";break}for(var h=0;h<r.coordinates.length;h++){var w=r.coordinates[h],c={type:o,coordinates:w};if(e(oe(c,i),n,h)===!1)return!1}})}z(xe,"flattenEach");function Vr(t,e,r){var n=r;return xe(t,function(i,a,s){a===0&&s===0&&r===void 0?n=i:n=e(n,i,a,s)}),n}z(Vr,"flattenReduce");function xt(t,e){xe(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var m,o=0,h=0,w=0;if(Re(r,function(c,C,M,d,H){if(m===void 0||n>o||d>h||H>w){m=c,o=n,h=d,w=H,a=0;return}var ee=ue([m,c],r.properties);if(e(ee,n,i,H,a)===!1)return!1;a++,m=c})===!1)return!1}}})}z(xt,"segmentEach");function Wr(t,e,r){var n=r,i=!1;return xt(t,function(a,s,m,o,h){i===!1&&r===void 0?n=a:n=e(n,a,s,m,o,h),i=!0}),n}z(Wr,"segmentReduce");function Bt(t,e){if(!t)throw new Error("geojson is required");xe(t,function(r,n,i){if(r.geometry!==null){var a=r.geometry.type,s=r.geometry.coordinates;switch(a){case"LineString":if(e(r,n,i,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<s.length;m++)if(e(ue(s[m],r.properties),n,i,m)===!1)return!1;break}}})}z(Bt,"lineEach");function Jr(t,e,r){var n=r;return Bt(t,function(i,a,s,m){a===0&&r===void 0?n=i:n=e(n,i,a,s,m)}),n}z(Jr,"lineReduce");function Ur(t,e){if(e=e||{},!Je(e))throw new Error("options is invalid");var r=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,a=e.segmentIndex||0,s=e.properties,m;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),s=s||t.features[r].properties,m=t.features[r].geometry;break;case"Feature":s=s||t.properties,m=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=t;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var o=m.coordinates;switch(m.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=o.length+a-1),ue([o[a],o[a+1]],s,e);case"Polygon":return i<0&&(i=o.length+i),a<0&&(a=o[i].length+a-1),ue([o[i][a],o[i][a+1]],s,e);case"MultiLineString":return n<0&&(n=o.length+n),a<0&&(a=o[n].length+a-1),ue([o[n][a],o[n][a+1]],s,e);case"MultiPolygon":return n<0&&(n=o.length+n),i<0&&(i=o[n].length+i),a<0&&(a=o[n][i].length-a-1),ue([o[n][i][a],o[n][i][a+1]],s,e)}throw new Error("geojson is invalid")}z(Ur,"findSegment");function Yr(t,e){if(e=e||{},!Je(e))throw new Error("options is invalid");var r=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,a=e.coordIndex||0,s=e.properties,m;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),s=s||t.features[r].properties,m=t.features[r].geometry;break;case"Feature":s=s||t.properties,m=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=t;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var o=m.coordinates;switch(m.type){case"Point":return le(o,s,e);case"MultiPoint":return n<0&&(n=o.length+n),le(o[n],s,e);case"LineString":return a<0&&(a=o.length+a),le(o[a],s,e);case"Polygon":return i<0&&(i=o.length+i),a<0&&(a=o[i].length+a),le(o[i][a],s,e);case"MultiLineString":return n<0&&(n=o.length+n),a<0&&(a=o[n].length+a),le(o[n][a],s,e);case"MultiPolygon":return n<0&&(n=o.length+n),i<0&&(i=o[n].length+i),a<0&&(a=o[n][i].length-a),le(o[n][i][a],s,e)}throw new Error("geojson is invalid")}z(Yr,"findPoint");var Xr=Object.defineProperty,Be=(t,e)=>Xr(t,"name",{value:e,configurable:!0});function Nt(t){return Gt(t,(e,r)=>e+It(r),0)}Be(Nt,"area");function It(t){let e=0,r;switch(t.type){case"Polygon":return He(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=He(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}Be(It,"calculateArea");function He(t){let e=0;if(t&&t.length>0){e+=Math.abs(Ke(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(Ke(t[r]))}return e}Be(He,"polygonArea");var Zr=j*j/2,Ie=Math.PI/180;function Ke(t){const e=t.length;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],m=i[0]*Ie,o=a[1]*Ie,h=s[0]*Ie;r+=(h-m)*Math.sin(o),n++}return r*Zr}Be(Ke,"ringArea");var Qr=Nt;function Ct(t){let e,r,n,i=(t[1]*1e-6).toFixed(2)+"",a,s;return{c(){e=B("p"),r=he("Polygons in the Network Map cover a total of "),n=B("b"),a=he(i),s=he(`
      squared kilometers. Depending what that map represents, you can use this value
      directly.`)},l(m){e=N(m,"P",{});var o=pe(e);r=ge(o,"Polygons in the Network Map cover a total of "),n=N(o,"B",{});var h=pe(n);a=ge(h,i),h.forEach(I),s=ge(o,`
      squared kilometers. Depending what that map represents, you can use this value
      directly.`),o.forEach(I)},m(m,o){me(m,e,o),p(e,r),p(e,n),p(n,a),p(e,s)},p(m,o){o&2&&i!==(i=(m[1]*1e-6).toFixed(2)+"")&&er(a,i)},d(m){m&&I(e)}}}function jr(t){let e,r,n,i,a,s,m,o,h,w,c,C,M,d,H,ee,g,x,R,u,F,ae,K,Pe,de,V,Ce,ve,W,Se,ye,J,Me,$e,U,Ee,_e,re,te,be,ne,q,we,fe,b,ke;function Fe(l){t[2](l)}let v={label:"Date of design review"};t[0].summary.dateDesignReview!==void 0&&(v.value=t[0].summary.dateDesignReview),r=new Te({props:v}),X.push(()=>Q(r,"value",Fe));function O(l){t[3](l)}let D={label:"Scheme reference"};t[0].summary.schemeReference!==void 0&&(D.value=t[0].summary.schemeReference),a=new Te({props:D}),X.push(()=>Q(a,"value",O));function T(l){t[4](l)}let ie={label:"Scheme name"};t[0].summary.schemeName!==void 0&&(ie.value=t[0].summary.schemeName),o=new Te({props:ie}),X.push(()=>Q(o,"value",T));function qe(l){t[5](l)}let Ye={label:"Scheme summary"};t[0].summary.schemeSummary!==void 0&&(Ye.value=t[0].summary.schemeSummary),c=new Oe({props:Ye}),X.push(()=>Q(c,"value",qe));function zt(l){t[6](l)}let Xe={label:"Scheme information reviewed"};t[0].summary.schemeInfoReviewed!==void 0&&(Xe.value=t[0].summary.schemeInfoReviewed),d=new Oe({props:Xe}),X.push(()=>Q(d,"value",zt));function Ht(l){t[7](l)}let Ze={label:"Authority",emptyOption:!0,choices:Le(nr)};t[0].summary.authority!==void 0&&(Ze.value=t[0].summary.authority),g=new bt({props:Ze}),X.push(()=>Q(g,"value",Ht));function Kt(l){t[8](l)}let Qe={label:"Transport / Combined Authority",emptyOption:!0,choices:Le(ir)};t[0].summary.transportOrCombinedAuthority!==void 0&&(Qe.value=t[0].summary.transportOrCombinedAuthority),u=new bt({props:Qe}),X.push(()=>Q(u,"value",Kt));function Vt(l){t[9](l)}let je={label:"Region",emptyOption:!0,choices:Le(ar)};t[0].summary.region!==void 0&&(je.value=t[0].summary.region),K=new Ne({props:je}),X.push(()=>Q(K,"value",Vt));function Wt(l){t[10](l)}let et={label:"Funding programme",emptyOption:!0,choices:Le(or)};t[0].summary.fundingProgramme!==void 0&&(et.value=t[0].summary.fundingProgramme),V=new Ne({props:et}),X.push(()=>Q(V,"value",Wt));function Jt(l){t[11](l)}let tt={label:"Design stage",emptyOption:!0,choices:Le(sr)};t[0].summary.designStage!==void 0&&(tt.value=t[0].summary.designStage),W=new Ne({props:tt}),X.push(()=>Q(W,"value",Jt));function Ut(l){t[12](l)}let rt={label:"Funding conditions"};t[0].summary.fundingConditions!==void 0&&(rt.value=t[0].summary.fundingConditions),J=new Oe({props:rt}),X.push(()=>Q(J,"value",Ut));function Yt(l){t[13](l)}let nt={label:"Inspector email address"};t[0].summary.inspectorEmail!==void 0&&(nt.value=t[0].summary.inspectorEmail),U=new Te({props:nt}),X.push(()=>Q(U,"value",Yt));let Y=t[1]&&Ct(t);function Xt(l){t[14](l)}let it={label:"Scheme area size (km²)",width:6,min:0};t[0].summary.schemeAreaSizeKm2!==void 0&&(it.value=t[0].summary.schemeAreaSizeKm2),te=new vr({props:it}),X.push(()=>Q(te,"value",Xt));function Zt(l){t[15](l)}let at={label:"Notes"};return t[0].summary.notes!==void 0&&(at.value=t[0].summary.notes),q=new Oe({props:at}),X.push(()=>Q(q,"value",Zt)),b=new Cr({}),{c(){e=B("div"),E(r.$$.fragment),i=y(),E(a.$$.fragment),m=y(),E(o.$$.fragment),w=y(),E(c.$$.fragment),M=y(),E(d.$$.fragment),ee=y(),E(g.$$.fragment),R=y(),E(u.$$.fragment),ae=y(),E(K.$$.fragment),de=y(),E(V.$$.fragment),ve=y(),E(W.$$.fragment),ye=y(),E(J.$$.fragment),$e=y(),E(U.$$.fragment),_e=y(),Y&&Y.c(),re=y(),E(te.$$.fragment),ne=y(),E(q.$$.fragment),fe=y(),E(b.$$.fragment),this.h()},l(l){e=N(l,"DIV",{class:!0});var f=pe(e);k(r.$$.fragment,f),i=$(f),k(a.$$.fragment,f),m=$(f),k(o.$$.fragment,f),w=$(f),k(c.$$.fragment,f),M=$(f),k(d.$$.fragment,f),ee=$(f),k(g.$$.fragment,f),R=$(f),k(u.$$.fragment,f),ae=$(f),k(K.$$.fragment,f),de=$(f),k(V.$$.fragment,f),ve=$(f),k(W.$$.fragment,f),ye=$(f),k(J.$$.fragment,f),$e=$(f),k(U.$$.fragment,f),_e=$(f),Y&&Y.l(f),re=$(f),k(te.$$.fragment,f),ne=$(f),k(q.$$.fragment,f),fe=$(f),k(b.$$.fragment,f),f.forEach(I),this.h()},h(){jt(e,"class","govuk-width-container")},m(l,f){me(l,e,f),L(r,e,null),p(e,i),L(a,e,null),p(e,m),L(o,e,null),p(e,w),L(c,e,null),p(e,M),L(d,e,null),p(e,ee),L(g,e,null),p(e,R),L(u,e,null),p(e,ae),L(K,e,null),p(e,de),L(V,e,null),p(e,ve),L(W,e,null),p(e,ye),L(J,e,null),p(e,$e),L(U,e,null),p(e,_e),Y&&Y.m(e,null),p(e,re),L(te,e,null),p(e,ne),L(q,e,null),p(e,fe),L(b,e,null),ke=!0},p(l,[f]){const ot={};!n&&f&1&&(n=!0,ot.value=l[0].summary.dateDesignReview,Z(()=>n=!1)),r.$set(ot);const st={};!s&&f&1&&(s=!0,st.value=l[0].summary.schemeReference,Z(()=>s=!1)),a.$set(st);const lt={};!h&&f&1&&(h=!0,lt.value=l[0].summary.schemeName,Z(()=>h=!1)),o.$set(lt);const ut={};!C&&f&1&&(C=!0,ut.value=l[0].summary.schemeSummary,Z(()=>C=!1)),c.$set(ut);const mt={};!H&&f&1&&(H=!0,mt.value=l[0].summary.schemeInfoReviewed,Z(()=>H=!1)),d.$set(mt);const ft={};!x&&f&1&&(x=!0,ft.value=l[0].summary.authority,Z(()=>x=!1)),g.$set(ft);const ct={};!F&&f&1&&(F=!0,ct.value=l[0].summary.transportOrCombinedAuthority,Z(()=>F=!1)),u.$set(ct);const pt={};!Pe&&f&1&&(Pe=!0,pt.value=l[0].summary.region,Z(()=>Pe=!1)),K.$set(pt);const ht={};!Ce&&f&1&&(Ce=!0,ht.value=l[0].summary.fundingProgramme,Z(()=>Ce=!1)),V.$set(ht);const gt={};!Se&&f&1&&(Se=!0,gt.value=l[0].summary.designStage,Z(()=>Se=!1)),W.$set(gt);const dt={};!Me&&f&1&&(Me=!0,dt.value=l[0].summary.fundingConditions,Z(()=>Me=!1)),J.$set(dt);const vt={};!Ee&&f&1&&(Ee=!0,vt.value=l[0].summary.inspectorEmail,Z(()=>Ee=!1)),U.$set(vt),l[1]?Y?Y.p(l,f):(Y=Ct(l),Y.c(),Y.m(e,re)):Y&&(Y.d(1),Y=null);const yt={};!be&&f&1&&(be=!0,yt.value=l[0].summary.schemeAreaSizeKm2,Z(()=>be=!1)),te.$set(yt);const $t={};!we&&f&1&&(we=!0,$t.value=l[0].summary.notes,Z(()=>we=!1)),q.$set($t)},i(l){ke||(P(r.$$.fragment,l),P(a.$$.fragment,l),P(o.$$.fragment,l),P(c.$$.fragment,l),P(d.$$.fragment,l),P(g.$$.fragment,l),P(u.$$.fragment,l),P(K.$$.fragment,l),P(V.$$.fragment,l),P(W.$$.fragment,l),P(J.$$.fragment,l),P(U.$$.fragment,l),P(te.$$.fragment,l),P(q.$$.fragment,l),P(b.$$.fragment,l),ke=!0)},o(l){S(r.$$.fragment,l),S(a.$$.fragment,l),S(o.$$.fragment,l),S(c.$$.fragment,l),S(d.$$.fragment,l),S(g.$$.fragment,l),S(u.$$.fragment,l),S(K.$$.fragment,l),S(V.$$.fragment,l),S(W.$$.fragment,l),S(J.$$.fragment,l),S(U.$$.fragment,l),S(te.$$.fragment,l),S(q.$$.fragment,l),S(b.$$.fragment,l),ke=!1},d(l){l&&I(e),A(r),A(a),A(o),A(c),A(d),A(g),A(u),A(K),A(V),A(W),A(J),A(U),Y&&Y.d(),A(te),A(q),A(b)}}}function en(t,e,r){let n,i;Mt(t,G,u=>r(0,i=u));function a(u){let F=0;for(let ae of u.features)ae.geometry.type=="Polygon"&&(F+=Qr(ae));return F>0?F:null}function s(u){t.$$.not_equal(i.summary.dateDesignReview,u)&&(i.summary.dateDesignReview=u,G.set(i))}function m(u){t.$$.not_equal(i.summary.schemeReference,u)&&(i.summary.schemeReference=u,G.set(i))}function o(u){t.$$.not_equal(i.summary.schemeName,u)&&(i.summary.schemeName=u,G.set(i))}function h(u){t.$$.not_equal(i.summary.schemeSummary,u)&&(i.summary.schemeSummary=u,G.set(i))}function w(u){t.$$.not_equal(i.summary.schemeInfoReviewed,u)&&(i.summary.schemeInfoReviewed=u,G.set(i))}function c(u){t.$$.not_equal(i.summary.authority,u)&&(i.summary.authority=u,G.set(i))}function C(u){t.$$.not_equal(i.summary.transportOrCombinedAuthority,u)&&(i.summary.transportOrCombinedAuthority=u,G.set(i))}function M(u){t.$$.not_equal(i.summary.region,u)&&(i.summary.region=u,G.set(i))}function d(u){t.$$.not_equal(i.summary.fundingProgramme,u)&&(i.summary.fundingProgramme=u,G.set(i))}function H(u){t.$$.not_equal(i.summary.designStage,u)&&(i.summary.designStage=u,G.set(i))}function ee(u){t.$$.not_equal(i.summary.fundingConditions,u)&&(i.summary.fundingConditions=u,G.set(i))}function g(u){t.$$.not_equal(i.summary.inspectorEmail,u)&&(i.summary.inspectorEmail=u,G.set(i))}function x(u){t.$$.not_equal(i.summary.schemeAreaSizeKm2,u)&&(i.summary.schemeAreaSizeKm2=u,G.set(i))}function R(u){t.$$.not_equal(i.summary.notes,u)&&(i.summary.notes=u,G.set(i))}return t.$$.update=()=>{t.$$.dirty&1&&r(1,n=a(i.summary.networkMap))},[i,n,s,m,o,h,w,c,C,M,d,H,ee,g,x,R]}class $n extends Et{constructor(e){super(),kt(this,e,en,jr,St,{})}}export{$n as component};
