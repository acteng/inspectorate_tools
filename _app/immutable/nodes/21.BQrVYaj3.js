import{s as ie,a as P,e as I,c as W,b as O,o as Q,i as v,z as Be,A as Pe,d as b,H as Ye,r as A,f as z,K as re,j as q,v as j,k as fe,a4 as Je,t as N,w as K,h as E,y as X,g as me,x as Qe,n as te}from"../chunks/scheduler.8Pqdtq9W.js";import{S as ae,i as se,c as T,a as L,m as F,t as y,b as k,d as S,e as H,g as Z,f as x}from"../chunks/index.KrNxZzBh.js";import{e as ne,u as Xe,o as Ze,B as xe}from"../chunks/Geocoder.svelte_svelte_type_style_lang.DgqoFFed.js";import{p as Y}from"../chunks/index.DjS60LUw.js";import{S as ce}from"../chunks/SecondaryButton.CctJSiA9.js";import{S as J}from"../chunks/Select.Bt1_W9Pf.js";import{W as et}from"../chunks/WarningButton.Cyr2mll2.js";import{W as he}from"../chunks/WarningText.DNDO-dlG.js";import{s as V,a as tt}from"../chunks/data.BCuT2WwA.js";import{E as rt}from"../chunks/ExternalLink.DchCAz0l.js";import{C as pe}from"../chunks/CollapsibleCard.COCSlxIK.js";import{F as it,E as at}from"../chunks/FormElement.C7qRsTEQ.js";import{v as st}from"../chunks/v4.D8aEg3BZ.js";import"../chunks/paths.DrcgM7qX.js";function nt(a){let e,r,t,i,s,n,l;return e=new at({props:{errorMessage:a[5](a[2])}}),{c(){T(e.$$.fragment),r=P(),t=I("input"),this.h()},l(o){L(e.$$.fragment,o),r=W(o),t=O(o,"INPUT",{type:!0,inputmode:!0,class:!0,id:!0}),this.h()},h(){Q(t,"type","text"),Q(t,"inputmode","numeric"),Q(t,"class",i=`govuk-input govuk-input--width-${a[1]}`),Q(t,"id",a[3])},m(o,c){F(e,o,c),v(o,r,c),v(o,t,c),Be(t,a[2]),s=!0,n||(l=[Pe(t,"input",a[9]),Pe(t,"change",a[4])],n=!0)},p(o,c){const g={};c&4&&(g.errorMessage=o[5](o[2])),e.$set(g),(!s||c&2&&i!==(i=`govuk-input govuk-input--width-${o[1]}`))&&Q(t,"class",i),c&4&&t.value!==o[2]&&Be(t,o[2])},i(o){s||(y(e.$$.fragment,o),s=!0)},o(o){k(e.$$.fragment,o),s=!1},d(o){o&&(b(r),b(t)),S(e,o),n=!1,Ye(l)}}}function lt(a){let e,r;return e=new it({props:{label:a[0],id:a[3],$$slots:{default:[nt]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,i){F(e,t,i),r=!0},p(t,[i]){const s={};i&1&&(s.label=t[0]),i&1030&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){r||(y(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function ot(a,e,r){let{label:t}=e,{value:i}=e,{width:s}=e,{min:n=void 0}=e,{max:l=void 0}=e,o=i==null?void 0:i.toString(),c=st();function g(){r(6,i=o==null?void 0:parseInt(o,10))}function h(p){if(p==""||p==null)return"";if(p.includes("."))return"Please enter a number without decimals";let B=Number(p);return isNaN(B)?"Please enter a valid number":n!=null&&B<n?`Please enter a number that's at least ${n};`:l!=null&&B>l?`Please enter a number that's at most ${l};`:""}function $(){o=this.value,r(2,o)}return a.$$set=p=>{"label"in p&&r(0,t=p.label),"value"in p&&r(6,i=p.value),"width"in p&&r(1,s=p.width),"min"in p&&r(7,n=p.min),"max"in p&&r(8,l=p.max)},[t,s,o,c,g,h,i,n,l,$]}class ft extends ae{constructor(e){super(),se(this,e,ot,lt,ie,{label:0,value:6,width:1,min:7,max:8})}}function de(a,e,r,t){switch(a){case"Footway":return[2.6,2];case"Narrow Traffic / Bus Lane":return[3.25,3.25];case"Wide Traffic / Bus Lane":return[4.5,3.9];case"Traffic Lane (no buses): speed limit 20/30":return[3,2.75];case"On-highway advisory/mandatory cycle lane":return[2,1.5];case"1-way protected cycle track":if(!e.flowOneWay)throw new Error("missing input");return{"<200":[2.3,1.8],"200-800":[2.5,2.3],">800":[2.8,2.3]}[e.flowOneWay];case"2-way protected cycle track":if(!e.flowTwoWay)throw new Error("missing input");return{"<300":[3.3,2.3],"300-1,000":[3.3,2.8],">1,000":[4.3,3.3]}[e.flowTwoWay];case"Shared use cycle track":if(!e.flowSharedUse)throw new Error("missing input");return{"<300":[3,3],">300":[4.5,4.5]}[e.flowSharedUse];case"Parking Bay":return[2,1.8];case"Disabled Parking Bay":return[2.7,2.7];case"Loading Bay":return[2.7,1.8];case"Buffer / Verge":{if(!e.speedLimit)throw new Error("missing input");let i=[.5,.5],s=[1.5,1.5],n=0;if(r&&(n+=G[r]),t&&(n+=G[t]),n<=1||n==4||n==10)return i;let l=e.speedLimit=="<30"||e.speedLimit=="30"||e.speedLimit=="40";return r=="Footway"&&t&&G[t]==2||t=="Footway"&&r&&G[r]==2?l?i:s:{"<30":[.5,0],30:[.5,0],40:[1,.5],50:[2,1.5],60:[2.5,2],70:[3.5,3]}[e.speedLimit]}}}let G={Footway:0,"1-way protected cycle track":0,"2-way protected cycle track":0,"Shared use cycle track":0,"Buffer / Verge":1,"Narrow Traffic / Bus Lane":2,"Wide Traffic / Bus Lane":2,"Traffic Lane (no buses): speed limit 20/30":2,"On-highway advisory/mandatory cycle lane":2,"Parking Bay":10,"Disabled Parking Bay":10,"Loading Bay":10};function ut(a,e,r){if(G[a]!=0)return"";let t=e&&(G[e]==2||G[e]==10),i=r&&(G[r]==2||G[r]==10);return t&&i?"both":t?"left":i?"right":""}function Ve(a,e){if(!a||!e)return null;let r=a=="<30"?20:parseInt(a);return e>r*1.1?r+10:r}let le={Footway:[["Manual for Streets 2: Section 5 pp. 43","https://tsrgd.co.uk/pdf/mfs/mfs2.pdf#page=48"],["DMRB CD143 Designing for walking, cycling & horse-riding Annex pp. 7",""]],"Narrow Traffic / Bus Lane":[],"Wide Traffic / Bus Lane":[],"Traffic Lane (no buses): speed limit 20/30":[["LTN 1/20 Table 7-2 pp. 76",U(76)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"On-highway advisory/mandatory cycle lane":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"1-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"2-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",U(43)],["LTN 1/20 Figure 4.1 pp. 33",U(33)]],"Shared use cycle track":[["LTN 1/20 Table 6-3 pp. 68",U(68)]],"Parking Bay":[["LTN 1/20 table 7-3 pp. 77",U(77)]],"Disabled Parking Bay":[],"Loading Bay":[["LTN 1/20 table 7-3 pp. 77",U(77)]],"Buffer / Verge":[["LTN 1/20 table 6-1 pp. 54",U(54)]]};function U(a){return`https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951074/cycle-infrastructure-design-ltn-1-20.pdf#page=${a}`}function oe(a,e){let r=Ve(e.speedLimit,e.observedSpeed);switch(a){case"Footway":return"There is no maximum width for footways; widths should take account of pedestrian volumes and composition. Suggested widths quoted here are the functional width available to the user";case"Narrow Traffic / Bus Lane":return"";case"Wide Traffic / Bus Lane":return"";case"Traffic Lane (no buses): speed limit 20/30":return e.trafficFlow=="<2,500"&&r==20?"Where traffic volumes are less than 2,500 vpd and speeds are less than 20mph, cycling in mixed traffic may be suitable for all users":"Where traffic volumes are greater than 2,500 vpd or speeds are greater than 20mph, cycling in mixed traffic is not suitable for all users";case"On-highway advisory/mandatory cycle lane":return(e.trafficFlow=="<2,500"||e.trafficFlow=="2,500-5,000")&&r==20?"Where traffic volumes are less than 2,500 vpd and/or speeds are less than 20mph, advisory or mandatory cycle lanes may be suitable for all users":"Where traffic volumes are greater than 5,000 vpd and/or speeds are greater than 20mph, advisory or mandatory cycle lanes are not suitable for all users";case"1-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.";case"2-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the userplus min. protection width 0.3m.";case"Shared use cycle track":return"Potential policy conflict: 'Cyclists must be separated from pedestrians' - have you considered alternatives to a shared use cycle track?";case"Parking Bay":return"";case"Disabled Parking Bay":return"";case"Loading Bay":return"";case"Buffer / Verge":return"Your buffer / verge shouldn't impact on the functional width of your footway or cycle-track"}}function We(a,e,r){const t=a.slice();return t[14]=e[r][0],t[15]=e[r][1],t}function Ne(a){let e,r,t,i=de(a[0],a[7].proposed.trafficData,a[4],a[5])[a[3]=="Desirable"?0:1]+"",s,n,l,o,c,g,h=oe(a[0],a[7].proposed.trafficData),$,p;const B=[dt,pt,ct],u=[];function f(_,D){return _[6]=="left"?0:_[6]=="right"?1:_[6]=="both"?2:-1}~(l=f(a))&&(o=u[l]=B[l](a));let d=le[a[0]].length>0&&Ee(a),w=h&&qe(a);return{c(){e=I("p"),r=N(a[3]),t=N(" minimum width (m): "),s=N(i),n=P(),o&&o.c(),c=P(),d&&d.c(),g=P(),w&&w.c(),$=K()},l(_){e=O(_,"P",{});var D=z(e);r=E(D,a[3]),t=E(D," minimum width (m): "),s=E(D,i),D.forEach(b),n=W(_),o&&o.l(_),c=W(_),d&&d.l(_),g=W(_),w&&w.l(_),$=K()},m(_,D){v(_,e,D),q(e,r),q(e,t),q(e,s),v(_,n,D),~l&&u[l].m(_,D),v(_,c,D),d&&d.m(_,D),v(_,g,D),w&&w.m(_,D),v(_,$,D),p=!0},p(_,D){(!p||D&8)&&X(r,_[3]),(!p||D&185)&&i!==(i=de(_[0],_[7].proposed.trafficData,_[4],_[5])[_[3]=="Desirable"?0:1]+"")&&X(s,i);let M=l;l=f(_),l!==M&&(o&&(Z(),k(u[M],1,1,()=>{u[M]=null}),x()),~l?(o=u[l],o||(o=u[l]=B[l](_),o.c()),y(o,1),o.m(c.parentNode,c)):o=null),le[_[0]].length>0?d?(d.p(_,D),D&1&&y(d,1)):(d=Ee(_),d.c(),y(d,1),d.m(g.parentNode,g)):d&&(Z(),k(d,1,1,()=>{d=null}),x()),D&129&&(h=oe(_[0],_[7].proposed.trafficData)),h?w?w.p(_,D):(w=qe(_),w.c(),w.m($.parentNode,$)):w&&(w.d(1),w=null)},i(_){p||(y(o),y(d),p=!0)},o(_){k(o),k(d),p=!1},d(_){_&&(b(e),b(n),b(c),b(g),b($)),~l&&u[l].d(_),d&&d.d(_),w&&w.d(_)}}}function ct(a){let e,r;return e=new he({props:{$$slots:{default:[mt]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,i){F(e,t,i),r=!0},i(t){r||(y(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function pt(a){let e,r;return e=new he({props:{$$slots:{default:[ht]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,i){F(e,t,i),r=!0},i(t){r||(y(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function dt(a){let e,r;return e=new he({props:{$$slots:{default:[_t]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,i){F(e,t,i),r=!0},i(t){r||(y(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function mt(a){let e;return{c(){e=N("Consider buffers to left and right")},l(r){e=E(r,"Consider buffers to left and right")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function ht(a){let e;return{c(){e=N("Consider buffer to right")},l(r){e=E(r,"Consider buffer to right")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function _t(a){let e;return{c(){e=N("Consider buffer to left")},l(r){e=E(r,"Consider buffer to left")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function Ee(a){let e,r="References",t,i,s,n=ne(le[a[0]]),l=[];for(let c=0;c<n.length;c+=1)l[c]=Re(We(a,n,c));const o=c=>k(l[c],1,1,()=>{l[c]=null});return{c(){e=I("u"),e.textContent=r,t=N(`
      :
      `),i=I("ul");for(let c=0;c<l.length;c+=1)l[c].c()},l(c){e=O(c,"U",{"data-svelte-h":!0}),me(e)!=="svelte-fk7cdq"&&(e.textContent=r),t=E(c,`
      :
      `),i=O(c,"UL",{});var g=z(i);for(let h=0;h<l.length;h+=1)l[h].l(g);g.forEach(b)},m(c,g){v(c,e,g),v(c,t,g),v(c,i,g);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(i,null);s=!0},p(c,g){if(g&1){n=ne(le[c[0]]);let h;for(h=0;h<n.length;h+=1){const $=We(c,n,h);l[h]?(l[h].p($,g),y(l[h],1)):(l[h]=Re($),l[h].c(),y(l[h],1),l[h].m(i,null))}for(Z(),h=n.length;h<l.length;h+=1)o(h);x()}},i(c){if(!s){for(let g=0;g<n.length;g+=1)y(l[g]);s=!0}},o(c){l=l.filter(Boolean);for(let g=0;g<l.length;g+=1)k(l[g]);s=!1},d(c){c&&(b(e),b(t),b(i)),Qe(l,c)}}}function gt(a){let e,r=a[14]+"",t;return{c(){e=I("li"),t=N(r)},l(i){e=O(i,"LI",{});var s=z(e);t=E(s,r),s.forEach(b)},m(i,s){v(i,e,s),q(e,t)},p(i,s){s&1&&r!==(r=i[14]+"")&&X(t,r)},i:te,o:te,d(i){i&&b(e)}}}function bt(a){let e,r,t;return r=new rt({props:{href:a[15],$$slots:{default:[$t]},$$scope:{ctx:a}}}),{c(){e=I("li"),T(r.$$.fragment)},l(i){e=O(i,"LI",{});var s=z(e);L(r.$$.fragment,s),s.forEach(b)},m(i,s){v(i,e,s),F(r,e,null),t=!0},p(i,s){const n={};s&1&&(n.href=i[15]),s&262145&&(n.$$scope={dirty:s,ctx:i}),r.$set(n)},i(i){t||(y(r.$$.fragment,i),t=!0)},o(i){k(r.$$.fragment,i),t=!1},d(i){i&&b(e),S(r)}}}function $t(a){let e=a[14]+"",r;return{c(){r=N(e)},l(t){r=E(t,e)},m(t,i){v(t,r,i)},p(t,i){i&1&&e!==(e=t[14]+"")&&X(r,e)},d(t){t&&b(r)}}}function Re(a){let e,r,t,i;const s=[bt,gt],n=[];function l(o,c){return o[15]?0:1}return e=l(a),r=n[e]=s[e](a),{c(){r.c(),t=K()},l(o){r.l(o),t=K()},m(o,c){n[e].m(o,c),v(o,t,c),i=!0},p(o,c){let g=e;e=l(o),e===g?n[e].p(o,c):(Z(),k(n[g],1,1,()=>{n[g]=null}),x(),r=n[e],r?r.p(o,c):(r=n[e]=s[e](o),r.c()),y(r,1),r.m(t.parentNode,t))},i(o){i||(y(r),i=!0)},o(o){k(r),i=!1},d(o){o&&b(t),n[e].d(o)}}}function qe(a){let e,r="Guidance",t,i,s=oe(a[0],a[7].proposed.trafficData)+"",n;return{c(){e=I("u"),e.textContent=r,t=N(`
      :
      `),i=I("p"),n=N(s),this.h()},l(l){e=O(l,"U",{"data-svelte-h":!0}),me(e)!=="svelte-qh7mhq"&&(e.textContent=r),t=E(l,`
      :
      `),i=O(l,"P",{style:!0});var o=z(i);n=E(o,s),o.forEach(b),this.h()},h(){re(i,"max-width","400px")},m(l,o){v(l,e,o),v(l,t,o),v(l,i,o),q(i,n)},p(l,o){o&129&&s!==(s=oe(l[0],l[7].proposed.trafficData)+"")&&X(n,s)},d(l){l&&(b(e),b(t),b(i))}}}function wt(a){let e;return{c(){e=N("←")},l(r){e=E(r,"←")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function vt(a){let e;return{c(){e=N("Delete")},l(r){e=E(r,"Delete")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function yt(a){let e;return{c(){e=N("→")},l(r){e=E(r,"→")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function kt(a){let e,r,t,i,s,n,l,o,c,g,h,$;function p(f){a[10](f)}let B={label:"Street feature type",emptyOption:!0,choices:a[9]};a[0]!==void 0&&(B.value=a[0]),r=new J({props:B}),A.push(()=>H(r,"value",p));let u=a[0]&&Ne(a);return l=new ce({props:{disabled:a[1],$$slots:{default:[wt]},$$scope:{ctx:a}}}),l.$on("click",a[11]),c=new et({props:{$$slots:{default:[vt]},$$scope:{ctx:a}}}),c.$on("click",a[12]),h=new ce({props:{disabled:a[2],$$slots:{default:[yt]},$$scope:{ctx:a}}}),h.$on("click",a[13]),{c(){e=I("div"),T(r.$$.fragment),i=P(),u&&u.c(),s=P(),n=I("div"),T(l.$$.fragment),o=P(),T(c.$$.fragment),g=P(),T(h.$$.fragment),this.h()},l(f){e=O(f,"DIV",{class:!0});var d=z(e);L(r.$$.fragment,d),i=W(d),u&&u.l(d),s=W(d),n=O(d,"DIV",{style:!0,class:!0});var w=z(n);L(l.$$.fragment,w),o=W(w),L(c.$$.fragment,w),g=W(w),L(h.$$.fragment,w),w.forEach(b),d.forEach(b),this.h()},h(){re(n,"display","flex"),re(n,"justify-content","space-between"),Q(n,"class","svelte-jig4ga"),Q(e,"class","svelte-jig4ga")},m(f,d){v(f,e,d),F(r,e,null),q(e,i),u&&u.m(e,null),q(e,s),q(e,n),F(l,n,null),q(n,o),F(c,n,null),q(n,g),F(h,n,null),$=!0},p(f,[d]){const w={};!t&&d&1&&(t=!0,w.value=f[0],j(()=>t=!1)),r.$set(w),f[0]?u?(u.p(f,d),d&1&&y(u,1)):(u=Ne(f),u.c(),y(u,1),u.m(e,s)):u&&(Z(),k(u,1,1,()=>{u=null}),x());const _={};d&2&&(_.disabled=f[1]),d&262144&&(_.$$scope={dirty:d,ctx:f}),l.$set(_);const D={};d&262144&&(D.$$scope={dirty:d,ctx:f}),c.$set(D);const M={};d&4&&(M.disabled=f[2]),d&262144&&(M.$$scope={dirty:d,ctx:f}),h.$set(M)},i(f){$||(y(r.$$.fragment,f),y(u),y(l.$$.fragment,f),y(c.$$.fragment,f),y(h.$$.fragment,f),$=!0)},o(f){k(r.$$.fragment,f),k(u),k(l.$$.fragment,f),k(c.$$.fragment,f),k(h.$$.fragment,f),$=!1},d(f){f&&b(e),S(r),u&&u.d(),S(l),S(c),S(h)}}}function Dt(a,e,r){let t,i;fe(a,V,d=>r(7,i=d));let{value:s}=e,{isFirst:n}=e,{isLast:l}=e,{sectionType:o}=e,{leftFeature:c}=e,{rightFeature:g}=e,h=Je(),$=Y(tt);function p(d){s=d,r(0,s)}const B=()=>h("moveLeft"),u=()=>h("delete"),f=()=>h("moveRight");return a.$$set=d=>{"value"in d&&r(0,s=d.value),"isFirst"in d&&r(1,n=d.isFirst),"isLast"in d&&r(2,l=d.isLast),"sectionType"in d&&r(3,o=d.sectionType),"leftFeature"in d&&r(4,c=d.leftFeature),"rightFeature"in d&&r(5,g=d.rightFeature)},a.$$.update=()=>{a.$$.dirty&49&&r(6,t=s&&ut(s,c,g))},[s,n,l,o,c,g,t,i,h,$,p,B,u,f]}class Tt extends ae{constructor(e){super(),se(this,e,Dt,kt,ie,{value:0,isFirst:1,isLast:2,sectionType:3,leftFeature:4,rightFeature:5})}}function Ie(a,e,r){const t=a.slice();return t[13]=e[r],t[14]=e,t[15]=r,t}function Lt(a){let e;return{c(){e=N("Add")},l(r){e=E(r,"Add")},m(r,t){v(r,e,t)},d(r){r&&b(e)}}}function Oe(a,e){let r,t,i,s;function n(h){e[8](h,e[13],e[14],e[15])}function l(){return e[9](e[15])}function o(){return e[10](e[15])}function c(){return e[11](e[15])}let g={isFirst:e[15]==0,isLast:e[15]==e[0].length-1,leftFeature:e[15]==0?"":e[0][e[15]-1],rightFeature:e[15]==e[0].length-1?"":e[0][e[15]+1],sectionType:e[1]};return e[13]!==void 0&&(g.value=e[13]),t=new Tt({props:g}),A.push(()=>H(t,"value",n)),t.$on("delete",l),t.$on("moveLeft",o),t.$on("moveRight",c),{key:a,first:null,c(){r=K(),T(t.$$.fragment),this.h()},l(h){r=K(),L(t.$$.fragment,h),this.h()},h(){this.first=r},m(h,$){v(h,r,$),F(t,h,$),s=!0},p(h,$){e=h;const p={};$&1&&(p.isFirst=e[15]==0),$&1&&(p.isLast=e[15]==e[0].length-1),$&1&&(p.leftFeature=e[15]==0?"":e[0][e[15]-1]),$&1&&(p.rightFeature=e[15]==e[0].length-1?"":e[0][e[15]+1]),$&2&&(p.sectionType=e[1]),!i&&$&1&&(i=!0,p.value=e[13],j(()=>i=!1)),t.$set(p)},i(h){s||(y(t.$$.fragment,h),s=!0)},o(h){k(t.$$.fragment,h),s=!1},d(h){h&&b(r),S(t,h)}}}function Ft(a){let e,r,t,i=[],s=new Map,n,l,o,c,g=a[2].toFixed(2)+"",h,$;e=new ce({props:{$$slots:{default:[Lt]},$$scope:{ctx:a}}}),e.$on("click",a[3]);let p=ne(a[0]);const B=u=>u[15];for(let u=0;u<p.length;u+=1){let f=Ie(a,p,u),d=B(f);s.set(d,i[u]=Oe(d,f))}return{c(){T(e.$$.fragment),r=P(),t=I("div");for(let u=0;u<i.length;u+=1)i[u].c();n=P(),l=I("p"),o=N("Total width required (m): "),c=I("b"),h=N(g),this.h()},l(u){L(e.$$.fragment,u),r=W(u),t=O(u,"DIV",{style:!0});var f=z(t);for(let _=0;_<i.length;_+=1)i[_].l(f);f.forEach(b),n=W(u),l=O(u,"P",{});var d=z(l);o=E(d,"Total width required (m): "),c=O(d,"B",{});var w=z(c);h=E(w,g),w.forEach(b),d.forEach(b),this.h()},h(){re(t,"display","flex"),re(t,"flex-direction","row")},m(u,f){F(e,u,f),v(u,r,f),v(u,t,f);for(let d=0;d<i.length;d+=1)i[d]&&i[d].m(t,null);v(u,n,f),v(u,l,f),q(l,o),q(l,c),q(c,h),$=!0},p(u,[f]){const d={};f&65536&&(d.$$scope={dirty:f,ctx:u}),e.$set(d),f&115&&(p=ne(u[0]),Z(),i=Xe(i,f,B,1,u,p,s,t,Ze,Oe,null,Ie),x()),(!$||f&4)&&g!==(g=u[2].toFixed(2)+"")&&X(h,g)},i(u){if(!$){y(e.$$.fragment,u);for(let f=0;f<p.length;f+=1)y(i[f]);$=!0}},o(u){k(e.$$.fragment,u);for(let f=0;f<i.length;f+=1)k(i[f]);$=!1},d(u){u&&(b(r),b(t),b(n),b(l)),S(e,u);for(let f=0;f<i.length;f+=1)i[f].d()}}}function St(a,e,r){let t,i;fe(a,V,f=>r(7,i=f));let{streetFeaturesLeftToRight:s}=e,{sectionType:n}=e;function l(){r(0,s=[...s,""])}function o(f){s.splice(f,1),r(0,s)}function c(f){r(0,[s[f-1],s[f]]=[s[f],s[f-1]],s)}function g(f){r(0,[s[f+1],s[f]]=[s[f],s[f+1]],s)}function h(f,d){let w=0;for(let _=0;_<s.length;_++){let D=s[_];if(!D)continue;let M=_==0?"":s[_-1],ee=_==s.length-1?"":s[_+1],ue=de(D,f.proposed.trafficData,M,ee)[d=="Desirable"?0:1];w+=ue}return w}function $(f,d,w,_){w[_]=f,r(0,s)}const p=f=>o(f),B=f=>c(f),u=f=>g(f);return a.$$set=f=>{"streetFeaturesLeftToRight"in f&&r(0,s=f.streetFeaturesLeftToRight),"sectionType"in f&&r(1,n=f.sectionType)},a.$$.update=()=>{a.$$.dirty&130&&r(2,t=h(i,n))},[s,n,t,l,o,c,g,i,$,p,B,u]}class Ue extends ae{constructor(e){super(),se(this,e,St,Ft,ie,{streetFeaturesLeftToRight:0,sectionType:1})}}function Me(a){let e,r,t,i;return{c(){e=I("p"),r=N("Effective speed limit, based on the limit and 85 percentile: "),t=N(a[1]),i=N(`
      mph`)},l(s){e=O(s,"P",{});var n=z(e);r=E(n,"Effective speed limit, based on the limit and 85 percentile: "),t=E(n,a[1]),i=E(n,`
      mph`),n.forEach(b)},m(s,n){v(s,e,n),q(e,r),q(e,t),q(e,i)},p(s,n){n&2&&X(t,s[1])},d(s){s&&b(e)}}}function Ct(a){let e,r,t,i,s,n,l,o,c,g,h,$,p,B,u,f,d,w,_,D,M,ee;function ue(m){a[3](m)}let _e={label:"Expected peak hour cycle flow: 1-way cycle tracks",emptyOption:!0,choices:Y(["<200","200-800",">800"])};a[0].proposed.trafficData.flowOneWay!==void 0&&(_e.value=a[0].proposed.trafficData.flowOneWay),e=new J({props:_e}),A.push(()=>H(e,"value",ue));function Ae(m){a[4](m)}let ge={label:"Expected peak hour cycle flow: 2-way cycle tracks",emptyOption:!0,choices:Y(["<300","300-1,000",">1,000"])};a[0].proposed.trafficData.flowTwoWay!==void 0&&(ge.value=a[0].proposed.trafficData.flowTwoWay),i=new J({props:ge}),A.push(()=>H(i,"value",Ae));function je(m){a[5](m)}let be={label:"Expected peak hour cycle flow: shared use cycle tracks",emptyOption:!0,choices:Y(["<300",">300"])};a[0].proposed.trafficData.flowSharedUse!==void 0&&(be.value=a[0].proposed.trafficData.flowSharedUse),l=new J({props:be}),A.push(()=>H(l,"value",je));function He(m){a[6](m)}let $e={label:"Traffic flow (vpd)",emptyOption:!0,choices:Y(["<2,500","2,500-5,000","5,000-10,000",">10,000"])};a[0].proposed.trafficData.trafficFlow!==void 0&&($e.value=a[0].proposed.trafficData.trafficFlow),g=new J({props:$e}),A.push(()=>H(g,"value",He));function ze(m){a[7](m)}let we={label:"Speed limit (MPH)",emptyOption:!0,choices:Y(["<30","30","40","50","60","70"])};a[0].proposed.trafficData.speedLimit!==void 0&&(we.value=a[0].proposed.trafficData.speedLimit),p=new J({props:we}),A.push(()=>H(p,"value",ze));function Ge(m){a[8](m)}let ve={label:"Observed 85th percentile speed (MPH)",width:3,min:0,max:120};a[0].proposed.trafficData.observedSpeed!==void 0&&(ve.value=a[0].proposed.trafficData.observedSpeed),f=new ft({props:ve}),A.push(()=>H(f,"value",Ge));let R=a[1]&&Me(a);function Ke(m){a[9](m)}let ye={label:"Street function",emptyOption:!0,choices:Y(["High Street (active frontages)","Residential street","Local distributor road"])};return a[0].proposed.trafficData.streetFunction!==void 0&&(ye.value=a[0].proposed.trafficData.streetFunction),D=new J({props:ye}),A.push(()=>H(D,"value",Ke)),{c(){T(e.$$.fragment),t=P(),T(i.$$.fragment),n=P(),T(l.$$.fragment),c=P(),T(g.$$.fragment),$=P(),T(p.$$.fragment),u=P(),T(f.$$.fragment),w=P(),R&&R.c(),_=P(),T(D.$$.fragment)},l(m){L(e.$$.fragment,m),t=W(m),L(i.$$.fragment,m),n=W(m),L(l.$$.fragment,m),c=W(m),L(g.$$.fragment,m),$=W(m),L(p.$$.fragment,m),u=W(m),L(f.$$.fragment,m),w=W(m),R&&R.l(m),_=W(m),L(D.$$.fragment,m)},m(m,C){F(e,m,C),v(m,t,C),F(i,m,C),v(m,n,C),F(l,m,C),v(m,c,C),F(g,m,C),v(m,$,C),F(p,m,C),v(m,u,C),F(f,m,C),v(m,w,C),R&&R.m(m,C),v(m,_,C),F(D,m,C),ee=!0},p(m,C){const ke={};!r&&C&1&&(r=!0,ke.value=m[0].proposed.trafficData.flowOneWay,j(()=>r=!1)),e.$set(ke);const De={};!s&&C&1&&(s=!0,De.value=m[0].proposed.trafficData.flowTwoWay,j(()=>s=!1)),i.$set(De);const Te={};!o&&C&1&&(o=!0,Te.value=m[0].proposed.trafficData.flowSharedUse,j(()=>o=!1)),l.$set(Te);const Le={};!h&&C&1&&(h=!0,Le.value=m[0].proposed.trafficData.trafficFlow,j(()=>h=!1)),g.$set(Le);const Fe={};!B&&C&1&&(B=!0,Fe.value=m[0].proposed.trafficData.speedLimit,j(()=>B=!1)),p.$set(Fe);const Se={};!d&&C&1&&(d=!0,Se.value=m[0].proposed.trafficData.observedSpeed,j(()=>d=!1)),f.$set(Se),m[1]?R?R.p(m,C):(R=Me(m),R.c(),R.m(_.parentNode,_)):R&&(R.d(1),R=null);const Ce={};!M&&C&1&&(M=!0,Ce.value=m[0].proposed.trafficData.streetFunction,j(()=>M=!1)),D.$set(Ce)},i(m){ee||(y(e.$$.fragment,m),y(i.$$.fragment,m),y(l.$$.fragment,m),y(g.$$.fragment,m),y(p.$$.fragment,m),y(f.$$.fragment,m),y(D.$$.fragment,m),ee=!0)},o(m){k(e.$$.fragment,m),k(i.$$.fragment,m),k(l.$$.fragment,m),k(g.$$.fragment,m),k(p.$$.fragment,m),k(f.$$.fragment,m),k(D.$$.fragment,m),ee=!1},d(m){m&&(b(t),b(n),b(c),b($),b(u),b(w),b(_)),S(e,m),S(i,m),S(l,m),S(g,m),S(p,m),S(f,m),R&&R.d(m),S(D,m)}}}function Bt(a){let e,r;return e=new pe({props:{label:"Traffic data and additional information",$$slots:{default:[Ct]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,i){F(e,t,i),r=!0},p(t,[i]){const s={};i&1027&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){r||(y(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function Pt(a,e,r){let t,i;fe(a,V,p=>r(0,i=p));let{valid:s}=e;function n(p){a.$$.not_equal(i.proposed.trafficData.flowOneWay,p)&&(i.proposed.trafficData.flowOneWay=p,V.set(i))}function l(p){a.$$.not_equal(i.proposed.trafficData.flowTwoWay,p)&&(i.proposed.trafficData.flowTwoWay=p,V.set(i))}function o(p){a.$$.not_equal(i.proposed.trafficData.flowSharedUse,p)&&(i.proposed.trafficData.flowSharedUse=p,V.set(i))}function c(p){a.$$.not_equal(i.proposed.trafficData.trafficFlow,p)&&(i.proposed.trafficData.trafficFlow=p,V.set(i))}function g(p){a.$$.not_equal(i.proposed.trafficData.speedLimit,p)&&(i.proposed.trafficData.speedLimit=p,V.set(i))}function h(p){a.$$.not_equal(i.proposed.trafficData.observedSpeed,p)&&(i.proposed.trafficData.observedSpeed=p,V.set(i))}function $(p){a.$$.not_equal(i.proposed.trafficData.streetFunction,p)&&(i.proposed.trafficData.streetFunction=p,V.set(i))}return a.$$set=p=>{"valid"in p&&r(2,s=p.valid)},a.$$.update=()=>{a.$$.dirty&1&&r(2,s=i.proposed.trafficData.flowOneWay!=""&&i.proposed.trafficData.flowTwoWay!=""&&i.proposed.trafficData.flowSharedUse!=""&&i.proposed.trafficData.trafficFlow!=""&&i.proposed.trafficData.speedLimit!=""&&i.proposed.trafficData.observedSpeed!=null&&i.proposed.trafficData.streetFunction!=""),a.$$.dirty&1&&r(1,t=Ve(i.proposed.trafficData.speedLimit,i.proposed.trafficData.observedSpeed))},[i,t,s,n,l,o,c,g,h,$]}class Wt extends ae{constructor(e){super(),se(this,e,Pt,Bt,ie,{valid:2})}}function Nt(a){let e,r="Fill out all data above to continue";return{c(){e=I("p"),e.textContent=r},l(t){e=O(t,"P",{"data-svelte-h":!0}),me(e)!=="svelte-ma95"&&(e.textContent=r)},m(t,i){v(t,e,i)},p:te,i:te,o:te,d(t){t&&b(e)}}}function Et(a){let e,r,t,i;return e=new pe({props:{label:"Desirable Minimum Cross-Section",$$slots:{default:[Rt]},$$scope:{ctx:a}}}),t=new pe({props:{label:"Absolute Minimum Cross-Section",$$slots:{default:[qt]},$$scope:{ctx:a}}}),{c(){T(e.$$.fragment),r=P(),T(t.$$.fragment)},l(s){L(e.$$.fragment,s),r=W(s),L(t.$$.fragment,s)},m(s,n){F(e,s,n),v(s,r,n),F(t,s,n),i=!0},p(s,n){const l={};n&34&&(l.$$scope={dirty:n,ctx:s}),e.$set(l);const o={};n&34&&(o.$$scope={dirty:n,ctx:s}),t.$set(o)},i(s){i||(y(e.$$.fragment,s),y(t.$$.fragment,s),i=!0)},o(s){k(e.$$.fragment,s),k(t.$$.fragment,s),i=!1},d(s){s&&b(r),S(e,s),S(t,s)}}}function Rt(a){let e,r,t;function i(n){a[3](n)}let s={sectionType:"Desirable"};return a[1].proposed.desirableMinimumCrossSection!==void 0&&(s.streetFeaturesLeftToRight=a[1].proposed.desirableMinimumCrossSection),e=new Ue({props:s}),A.push(()=>H(e,"streetFeaturesLeftToRight",i)),{c(){T(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,l){F(e,n,l),t=!0},p(n,l){const o={};!r&&l&2&&(r=!0,o.streetFeaturesLeftToRight=n[1].proposed.desirableMinimumCrossSection,j(()=>r=!1)),e.$set(o)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){S(e,n)}}}function qt(a){let e,r,t;function i(n){a[4](n)}let s={sectionType:"Absolute"};return a[1].proposed.absoluteMinimumCrossSection!==void 0&&(s.streetFeaturesLeftToRight=a[1].proposed.absoluteMinimumCrossSection),e=new Ue({props:s}),A.push(()=>H(e,"streetFeaturesLeftToRight",i)),{c(){T(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,l){F(e,n,l),t=!0},p(n,l){const o={};!r&&l&2&&(r=!0,o.streetFeaturesLeftToRight=n[1].proposed.absoluteMinimumCrossSection,j(()=>r=!1)),e.$set(o)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){S(e,n)}}}function It(a){let e,r,t,i,s,n,l,o,c;e=new xe({props:{links:[["Tools","/"],["Route cross-section","/cross_section"]],current:"Proposed Cross-Sections"}});function g(u){a[2](u)}let h={};a[0]!==void 0&&(h.valid=a[0]),t=new Wt({props:h}),A.push(()=>H(t,"valid",g));const $=[Et,Nt],p=[];function B(u,f){return u[0]?0:1}return n=B(a),l=p[n]=$[n](a),{c(){T(e.$$.fragment),r=P(),T(t.$$.fragment),s=P(),l.c(),o=K()},l(u){L(e.$$.fragment,u),r=W(u),L(t.$$.fragment,u),s=W(u),l.l(u),o=K()},m(u,f){F(e,u,f),v(u,r,f),F(t,u,f),v(u,s,f),p[n].m(u,f),v(u,o,f),c=!0},p(u,[f]){const d={};!i&&f&1&&(i=!0,d.valid=u[0],j(()=>i=!1)),t.$set(d);let w=n;n=B(u),n===w?p[n].p(u,f):(Z(),k(p[w],1,1,()=>{p[w]=null}),x(),l=p[n],l?l.p(u,f):(l=p[n]=$[n](u),l.c()),y(l,1),l.m(o.parentNode,o))},i(u){c||(y(e.$$.fragment,u),y(t.$$.fragment,u),y(l),c=!0)},o(u){k(e.$$.fragment,u),k(t.$$.fragment,u),k(l),c=!1},d(u){u&&(b(r),b(s),b(o)),S(e,u),S(t,u),p[n].d(u)}}}function Ot(a,e,r){let t;fe(a,V,o=>r(1,t=o));let i=!1;function s(o){i=o,r(0,i)}function n(o){a.$$.not_equal(t.proposed.desirableMinimumCrossSection,o)&&(t.proposed.desirableMinimumCrossSection=o,V.set(t))}function l(o){a.$$.not_equal(t.proposed.absoluteMinimumCrossSection,o)&&(t.proposed.absoluteMinimumCrossSection=o,V.set(t))}return[i,t,s,n,l]}class xt extends ae{constructor(e){super(),se(this,e,Ot,It,ie,{})}}export{xt as component};
