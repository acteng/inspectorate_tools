import{s as Ne,r as Z,e as U,t as J,a as A,c as z,b as O,d as K,f as m,g as R,q,v as H,i as v,h as B,w as X,k as be,V as re,y as dt,G as ye,E as x,p as $e,K as ve,j as ae,I as $t,O as _e,P as me,n as ht}from"../chunks/scheduler.Bpan6Ont.js";import{S as Se,i as Ee,e as Q,c as M,a as G,m as T,t as b,g as ie,b as y,f as ne,d as j}from"../chunks/index.B_gktW-4.js";import{g as bt}from"../chunks/globals.D0QH3NT1.js";import{e as se}from"../chunks/each.rqQRCiyP.js";import{p as vt}from"../chunks/stores.WOyG67lt.js";import{G as kt,S as wt,C as Ze}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.CiH6l16w.js";import{C as Ct}from"../chunks/CheckboxGroup.DNpm-CPd.js";import{B as yt,C as Xe,M as Qe}from"../chunks/Marker.BhXLM7Rn.js";import{C as It}from"../chunks/CollapsibleCard.CnaEhlqF.js";import{D as Lt}from"../chunks/DefaultButton.pW5DN5JW.js";import{I as Ie,p as Nt,G as St}from"../chunks/pan.BDGbVWTk.js";import"../chunks/SelectWithCustom.svelte_svelte_type_style_lang.mCxeWoP_.js";import{S as xe}from"../chunks/SecondaryButton.HKMnZBz0.js";import{W as Et}from"../chunks/WarningButton.BjgVp-1z.js";import{p as et}from"../chunks/authority_names.C6vM84VF.js";import"../chunks/paths.BKPy1OM6.js";import"../chunks/entry.CBaGzV-9.js";import{p as De,c as tt}from"../chunks/colors.DaC397qr.js";import{f as ke,j as we,M as Dt,k as Pt,G as Bt,b as qt,C as At}from"../chunks/index.Bxcrufpp.js";import{s as W,a as he}from"../chunks/data.CZhTkLnl.js";import"../chunks/index.CHG3vOGW.js";import{p as Rt,c as Vt,b as Be,e as qe,f as Mt,g as Gt}from"../chunks/lists.ubQNs_Tl.js";import{R as Tt}from"../chunks/RouteMapLayer.kBBYGv5Z.js";import{R as lt}from"../chunks/Radio.CPadpTTy.js";import{S as it}from"../chunks/Select.DqpT1fCa.js";import{T as nt}from"../chunks/TextArea.BWjdpn4-.js";import{T as ot}from"../chunks/TextInput.QEIGYZPk.js";import{Y as rt}from"../chunks/YesNo.B3MxVbGr.js";function Ae(n){let e,l,t;function i(o){n[5](o)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].policyConflictLog[n[0]].resolved!==void 0&&(s.value=n[1].policyConflictLog[n[0]].resolved),e=new rt({props:s}),Z.push(()=>Q(e,"value",i)),{c(){M(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,a){T(e,o,a),t=!0},p(o,a){const r={};!l&&a&3&&(l=!0,r.value=o[1].policyConflictLog[o[0]].resolved,X(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function jt(n){let e,l,t,i,s,o,a,r,u,c,k,L,D,g,E,w,_,C,f,$,d,I;function N(p){n[2](p)}let Y={label:"Policy Conflict",emptyOption:!0,choices:Rt};n[1].policyConflictLog[n[0]].conflict!==void 0&&(Y.value=n[1].policyConflictLog[n[0]].conflict),c=new it({props:Y}),Z.push(()=>Q(c,"value",N));function V(p){n[3](p)}let ee={label:"Stage",choices:et(["Existing","Design"]),inlineSmall:!0};n[1].policyConflictLog[n[0]].stage!==void 0&&(ee.value=n[1].policyConflictLog[n[0]].stage),D=new lt({props:ee}),Z.push(()=>Q(D,"value",V));function ge(p){n[4](p)}let fe={label:"Location Name"};n[1].policyConflictLog[n[0]].locationName!==void 0&&(fe.value=n[1].policyConflictLog[n[0]].locationName),w=new ot({props:fe}),Z.push(()=>Q(w,"value",ge));let P=n[1].policyConflictLog[n[0]].stage!="Design"&&Ae(n);function de(p){n[6](p)}let ce={label:"Commentary & Feedback"};return n[1].policyConflictLog[n[0]].notes!==void 0&&(ce.value=n[1].policyConflictLog[n[0]].notes),$=new nt({props:ce}),Z.push(()=>Q($,"value",de)),{c(){e=U("div"),l=U("a"),t=J("Google StreetView"),s=A(),o=U("a"),a=J("Bing Streetside"),u=A(),M(c.$$.fragment),L=A(),M(D.$$.fragment),E=A(),M(w.$$.fragment),C=A(),P&&P.c(),f=A(),M($.$$.fragment),this.h()},l(p){e=z(p,"DIV",{style:!0});var S=O(e);l=z(S,"A",{href:!0,target:!0});var te=O(l);t=K(te,"Google StreetView"),te.forEach(m),s=R(S),o=z(S,"A",{href:!0,target:!0});var le=O(o);a=K(le,"Bing Streetside"),le.forEach(m),S.forEach(m),u=R(p),G(c.$$.fragment,p),L=R(p),G(D.$$.fragment,p),E=R(p),G(w.$$.fragment,p),C=R(p),P&&P.l(p),f=R(p),G($.$$.fragment,p),this.h()},h(){q(l,"href",i=ke(n[1].policyConflictLog[n[0]].point)),q(l,"target","_blank"),q(o,"href",r=we(n[1].policyConflictLog[n[0]].point)),q(o,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(p,S){v(p,e,S),B(e,l),B(l,t),B(e,s),B(e,o),B(o,a),v(p,u,S),T(c,p,S),v(p,L,S),T(D,p,S),v(p,E,S),T(w,p,S),v(p,C,S),P&&P.m(p,S),v(p,f,S),T($,p,S),I=!0},p(p,[S]){(!I||S&3&&i!==(i=ke(p[1].policyConflictLog[p[0]].point)))&&q(l,"href",i),(!I||S&3&&r!==(r=we(p[1].policyConflictLog[p[0]].point)))&&q(o,"href",r);const te={};!k&&S&3&&(k=!0,te.value=p[1].policyConflictLog[p[0]].conflict,X(()=>k=!1)),c.$set(te);const le={};!g&&S&3&&(g=!0,le.value=p[1].policyConflictLog[p[0]].stage,X(()=>g=!1)),D.$set(le);const ue={};!_&&S&3&&(_=!0,ue.value=p[1].policyConflictLog[p[0]].locationName,X(()=>_=!1)),w.$set(ue),p[1].policyConflictLog[p[0]].stage!="Design"?P?(P.p(p,S),S&3&&b(P,1)):(P=Ae(p),P.c(),b(P,1),P.m(f.parentNode,f)):P&&(ie(),y(P,1,1,()=>{P=null}),ne());const pe={};!d&&S&3&&(d=!0,pe.value=p[1].policyConflictLog[p[0]].notes,X(()=>d=!1)),$.$set(pe)},i(p){I||(b(c.$$.fragment,p),b(D.$$.fragment,p),b(w.$$.fragment,p),b(P),b($.$$.fragment,p),I=!0)},o(p){y(c.$$.fragment,p),y(D.$$.fragment,p),y(w.$$.fragment,p),y(P),y($.$$.fragment,p),I=!1},d(p){p&&(m(e),m(u),m(L),m(E),m(C),m(f)),j(c,p),j(D,p),j(w,p),P&&P.d(p),j($,p)}}}function Ft(n,e,l){let t;be(n,W,c=>l(1,t=c));let{idx:i}=e;function s(c){n.$$.not_equal(t.policyConflictLog[i].conflict,c)&&(t.policyConflictLog[i].conflict=c,W.set(t))}function o(c){n.$$.not_equal(t.policyConflictLog[i].stage,c)&&(t.policyConflictLog[i].stage=c,W.set(t))}function a(c){n.$$.not_equal(t.policyConflictLog[i].locationName,c)&&(t.policyConflictLog[i].locationName=c,W.set(t))}function r(c){n.$$.not_equal(t.policyConflictLog[i].resolved,c)&&(t.policyConflictLog[i].resolved=c,W.set(t))}function u(c){n.$$.not_equal(t.policyConflictLog[i].notes,c)&&(t.policyConflictLog[i].notes=c,W.set(t))}return n.$$set=c=>{"idx"in c&&l(0,i=c.idx)},n.$$.update=()=>{n.$$.dirty&3&&t.policyConflictLog[i].stage=="Design"&&re(W,t.policyConflictLog[i].resolved="",t)},[i,t,s,o,a,r,u]}class Ot extends Se{constructor(e){super(),Ee(this,e,Ft,jt,Ne,{idx:0})}}function Re(n){let e,l,t;function i(o){n[5](o)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].criticalIssues[n[0]].resolved!==void 0&&(s.value=n[1].criticalIssues[n[0]].resolved),e=new rt({props:s}),Z.push(()=>Q(e,"value",i)),{c(){M(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,a){T(e,o,a),t=!0},p(o,a){const r={};!l&&a&3&&(l=!0,r.value=o[1].criticalIssues[o[0]].resolved,X(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function Ut(n){let e,l,t,i,s,o,a,r,u,c,k,L,D,g,E,w,_,C,f,$,d,I;function N(p){n[2](p)}let Y={label:"Critical Issue",emptyOption:!0,choices:Vt};n[1].criticalIssues[n[0]].criticalIssue!==void 0&&(Y.value=n[1].criticalIssues[n[0]].criticalIssue),c=new it({props:Y}),Z.push(()=>Q(c,"value",N));function V(p){n[3](p)}let ee={label:"Stage",choices:et(["Existing","Design"]),inlineSmall:!0};n[1].criticalIssues[n[0]].stage!==void 0&&(ee.value=n[1].criticalIssues[n[0]].stage),D=new lt({props:ee}),Z.push(()=>Q(D,"value",V));function ge(p){n[4](p)}let fe={label:"Location Name"};n[1].criticalIssues[n[0]].locationName!==void 0&&(fe.value=n[1].criticalIssues[n[0]].locationName),w=new ot({props:fe}),Z.push(()=>Q(w,"value",ge));let P=n[1].criticalIssues[n[0]].stage!="Design"&&Re(n);function de(p){n[6](p)}let ce={label:"Commentary & Feedback"};return n[1].criticalIssues[n[0]].notes!==void 0&&(ce.value=n[1].criticalIssues[n[0]].notes),$=new nt({props:ce}),Z.push(()=>Q($,"value",de)),{c(){e=U("div"),l=U("a"),t=J("Google StreetView"),s=A(),o=U("a"),a=J("Bing Streetside"),u=A(),M(c.$$.fragment),L=A(),M(D.$$.fragment),E=A(),M(w.$$.fragment),C=A(),P&&P.c(),f=A(),M($.$$.fragment),this.h()},l(p){e=z(p,"DIV",{style:!0});var S=O(e);l=z(S,"A",{href:!0,target:!0});var te=O(l);t=K(te,"Google StreetView"),te.forEach(m),s=R(S),o=z(S,"A",{href:!0,target:!0});var le=O(o);a=K(le,"Bing Streetside"),le.forEach(m),S.forEach(m),u=R(p),G(c.$$.fragment,p),L=R(p),G(D.$$.fragment,p),E=R(p),G(w.$$.fragment,p),C=R(p),P&&P.l(p),f=R(p),G($.$$.fragment,p),this.h()},h(){q(l,"href",i=ke(n[1].criticalIssues[n[0]].point)),q(l,"target","_blank"),q(o,"href",r=we(n[1].criticalIssues[n[0]].point)),q(o,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(p,S){v(p,e,S),B(e,l),B(l,t),B(e,s),B(e,o),B(o,a),v(p,u,S),T(c,p,S),v(p,L,S),T(D,p,S),v(p,E,S),T(w,p,S),v(p,C,S),P&&P.m(p,S),v(p,f,S),T($,p,S),I=!0},p(p,[S]){(!I||S&3&&i!==(i=ke(p[1].criticalIssues[p[0]].point)))&&q(l,"href",i),(!I||S&3&&r!==(r=we(p[1].criticalIssues[p[0]].point)))&&q(o,"href",r);const te={};!k&&S&3&&(k=!0,te.value=p[1].criticalIssues[p[0]].criticalIssue,X(()=>k=!1)),c.$set(te);const le={};!g&&S&3&&(g=!0,le.value=p[1].criticalIssues[p[0]].stage,X(()=>g=!1)),D.$set(le);const ue={};!_&&S&3&&(_=!0,ue.value=p[1].criticalIssues[p[0]].locationName,X(()=>_=!1)),w.$set(ue),p[1].criticalIssues[p[0]].stage!="Design"?P?(P.p(p,S),S&3&&b(P,1)):(P=Re(p),P.c(),b(P,1),P.m(f.parentNode,f)):P&&(ie(),y(P,1,1,()=>{P=null}),ne());const pe={};!d&&S&3&&(d=!0,pe.value=p[1].criticalIssues[p[0]].notes,X(()=>d=!1)),$.$set(pe)},i(p){I||(b(c.$$.fragment,p),b(D.$$.fragment,p),b(w.$$.fragment,p),b(P),b($.$$.fragment,p),I=!0)},o(p){y(c.$$.fragment,p),y(D.$$.fragment,p),y(w.$$.fragment,p),y(P),y($.$$.fragment,p),I=!1},d(p){p&&(m(e),m(u),m(L),m(E),m(C),m(f)),j(c,p),j(D,p),j(w,p),P&&P.d(p),j($,p)}}}function zt(n,e,l){let t;be(n,W,c=>l(1,t=c));let{idx:i}=e;function s(c){n.$$.not_equal(t.criticalIssues[i].criticalIssue,c)&&(t.criticalIssues[i].criticalIssue=c,W.set(t))}function o(c){n.$$.not_equal(t.criticalIssues[i].stage,c)&&(t.criticalIssues[i].stage=c,W.set(t))}function a(c){n.$$.not_equal(t.criticalIssues[i].locationName,c)&&(t.criticalIssues[i].locationName=c,W.set(t))}function r(c){n.$$.not_equal(t.criticalIssues[i].resolved,c)&&(t.criticalIssues[i].resolved=c,W.set(t))}function u(c){n.$$.not_equal(t.criticalIssues[i].notes,c)&&(t.criticalIssues[i].notes=c,W.set(t))}return n.$$set=c=>{"idx"in c&&l(0,i=c.idx)},n.$$.update=()=>{n.$$.dirty&3&&t.criticalIssues[i].stage=="Design"&&re(W,t.criticalIssues[i].resolved="",t)},[i,t,s,o,a,r,u]}class Ht extends Se{constructor(e){super(),Ee(this,e,zt,Ut,Ne,{idx:0})}}const{window:Jt}=bt;function Ve(n,e,l){const t=n.slice();return t[42]=e[l],t[43]=e,t[44]=l,t}function Me(n,e,l){const t=n.slice();return t[45]=e[l],t[46]=e,t[44]=l,t}function Ge(n,e,l){const t=n.slice();return t[42]=e[l],t[44]=l,t}function Te(n,e,l){const t=n.slice();return t[45]=e[l],t[44]=l,t}function Kt(n){let e,l,t,i,s,o,a,r,u,c;e=new Lt({props:{$$slots:{default:[Yt]},$$scope:{ctx:n}}}),e.$on("click",n[12]),t=new Et({props:{$$slots:{default:[Zt]},$$scope:{ctx:n}}}),t.$on("click",n[14]),s=new xe({props:{$$slots:{default:[Xt]},$$scope:{ctx:n}}}),s.$on("click",n[11]);const k=[xt,Qt],L=[];function D(g,E){return g[1].id.kind=="critical"?0:1}return a=D(n),r=L[a]=k[a](n),{c(){M(e.$$.fragment),l=A(),M(t.$$.fragment),i=A(),M(s.$$.fragment),o=A(),r.c(),u=x()},l(g){G(e.$$.fragment,g),l=R(g),G(t.$$.fragment,g),i=R(g),G(s.$$.fragment,g),o=R(g),r.l(g),u=x()},m(g,E){T(e,g,E),v(g,l,E),T(t,g,E),v(g,i,E),T(s,g,E),v(g,o,E),L[a].m(g,E),v(g,u,E),c=!0},p(g,E){const w={};E[1]&262144&&(w.$$scope={dirty:E,ctx:g}),e.$set(w);const _={};E[1]&262144&&(_.$$scope={dirty:E,ctx:g}),t.$set(_);const C={};E[1]&262144&&(C.$$scope={dirty:E,ctx:g}),s.$set(C);let f=a;a=D(g),a===f?L[a].p(g,E):(ie(),y(L[f],1,1,()=>{L[f]=null}),ne(),r=L[a],r?r.p(g,E):(r=L[a]=k[a](g),r.c()),b(r,1),r.m(u.parentNode,u))},i(g){c||(b(e.$$.fragment,g),b(t.$$.fragment,g),b(s.$$.fragment,g),b(r),c=!0)},o(g){y(e.$$.fragment,g),y(t.$$.fragment,g),y(s.$$.fragment,g),y(r),c=!1},d(g){g&&(m(l),m(i),m(o),m(u)),j(e,g),j(t,g),j(s,g),L[a].d(g)}}}function Wt(n){let e,l,t,i,s,o,a="Critical Issue Log",r,u,c,k,L="Policy Conflict Log",D,g;e=new It({props:{label:"Map tools",$$slots:{default:[ll]},$$scope:{ctx:n}}}),t=new Ct({props:{small:!0,$$slots:{default:[nl]},$$scope:{ctx:n}}});let E=se(n[3].criticalIssues),w=[];for(let d=0;d<E.length;d+=1)w[d]=Fe(Te(n,E,d));const _=d=>y(w[d],1,1,()=>{w[d]=null});let C=se(n[3].policyConflictLog),f=[];for(let d=0;d<C.length;d+=1)f[d]=Ue(Ge(n,C,d));const $=d=>y(f[d],1,1,()=>{f[d]=null});return{c(){M(e.$$.fragment),l=A(),M(t.$$.fragment),i=A(),s=U("div"),o=U("h3"),o.textContent=a,r=A();for(let d=0;d<w.length;d+=1)w[d].c();u=A(),c=U("div"),k=U("h3"),k.textContent=L,D=A();for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){G(e.$$.fragment,d),l=R(d),G(t.$$.fragment,d),i=R(d),s=z(d,"DIV",{style:!0});var I=O(s);o=z(I,"H3",{"data-svelte-h":!0}),$e(o)!=="svelte-e9mkko"&&(o.textContent=a),r=R(I);for(let Y=0;Y<w.length;Y+=1)w[Y].l(I);I.forEach(m),u=R(d),c=z(d,"DIV",{style:!0});var N=O(c);k=z(N,"H3",{"data-svelte-h":!0}),$e(k)!=="svelte-y008oc"&&(k.textContent=L),D=R(N);for(let Y=0;Y<f.length;Y+=1)f[Y].l(N);N.forEach(m),this.h()},h(){H(s,"background-color","grey"),H(s,"padding","4px"),H(c,"background-color",De),H(c,"padding","4px")},m(d,I){T(e,d,I),v(d,l,I),T(t,d,I),v(d,i,I),v(d,s,I),B(s,o),B(s,r);for(let N=0;N<w.length;N+=1)w[N]&&w[N].m(s,null);v(d,u,I),v(d,c,I),B(c,k),B(c,D);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(c,null);g=!0},p(d,I){const N={};I[0]&97|I[1]&262144&&(N.$$scope={dirty:I,ctx:d}),e.$set(N);const Y={};if(I[0]&128|I[1]&262144&&(Y.$$scope={dirty:I,ctx:d}),t.$set(Y),I[0]&66572){E=se(d[3].criticalIssues);let V;for(V=0;V<E.length;V+=1){const ee=Te(d,E,V);w[V]?(w[V].p(ee,I),b(w[V],1)):(w[V]=Fe(ee),w[V].c(),b(w[V],1),w[V].m(s,null))}for(ie(),V=E.length;V<w.length;V+=1)_(V);ne()}if(I[0]&132108){C=se(d[3].policyConflictLog);let V;for(V=0;V<C.length;V+=1){const ee=Ge(d,C,V);f[V]?(f[V].p(ee,I),b(f[V],1)):(f[V]=Ue(ee),f[V].c(),b(f[V],1),f[V].m(c,null))}for(ie(),V=C.length;V<f.length;V+=1)$(V);ne()}},i(d){if(!g){b(e.$$.fragment,d),b(t.$$.fragment,d);for(let I=0;I<E.length;I+=1)b(w[I]);for(let I=0;I<C.length;I+=1)b(f[I]);g=!0}},o(d){y(e.$$.fragment,d),y(t.$$.fragment,d),w=w.filter(Boolean);for(let I=0;I<w.length;I+=1)y(w[I]);f=f.filter(Boolean);for(let I=0;I<f.length;I+=1)y(f[I]);g=!1},d(d){d&&(m(l),m(i),m(s),m(u),m(c)),j(e,d),j(t,d),ve(w,d),ve(f,d)}}}function Yt(n){let e;return{c(){e=J("Save")},l(l){e=K(l,"Save")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function Zt(n){let e;return{c(){e=J("Delete")},l(l){e=K(l,"Delete")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function Xt(n){let e;return{c(){e=J("Copy")},l(l){e=K(l,"Copy")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function Qt(n){let e,l;return e=new Ot({props:{idx:n[1].id.idx}}),{c(){M(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function xt(n){let e,l;return e=new Ht({props:{idx:n[1].id.idx}}),{c(){M(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function el(n){let e;return{c(){e=J("Zoom to fit")},l(l){e=K(l,"Zoom to fit")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function tl(n){let e;return{c(){e=J("Show route")},l(l){e=K(l,"Show route")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function ll(n){let e,l,t,i,s,o,a,r,u,c,k,L;e=new xe({props:{$$slots:{default:[el]},$$scope:{ctx:n}}}),e.$on("click",n[19]),t=new yt({}),s=new kt({});function D(_){n[20](_)}let g={map:n[0]};n[5]!==void 0&&(g.enabled=n[5]),a=new wt({props:g}),Z.push(()=>Q(a,"enabled",D));function E(_){n[21](_)}let w={$$slots:{default:[tl]},$$scope:{ctx:n}};return n[6]!==void 0&&(w.checked=n[6]),c=new Xe({props:w}),Z.push(()=>Q(c,"checked",E)),{c(){M(e.$$.fragment),l=A(),M(t.$$.fragment),i=A(),M(s.$$.fragment),o=A(),M(a.$$.fragment),u=A(),M(c.$$.fragment)},l(_){G(e.$$.fragment,_),l=R(_),G(t.$$.fragment,_),i=R(_),G(s.$$.fragment,_),o=R(_),G(a.$$.fragment,_),u=R(_),G(c.$$.fragment,_)},m(_,C){T(e,_,C),v(_,l,C),T(t,_,C),v(_,i,C),T(s,_,C),v(_,o,C),T(a,_,C),v(_,u,C),T(c,_,C),L=!0},p(_,C){const f={};C[1]&262144&&(f.$$scope={dirty:C,ctx:_}),e.$set(f);const $={};C[0]&1&&($.map=_[0]),!r&&C[0]&32&&(r=!0,$.enabled=_[5],X(()=>r=!1)),a.$set($);const d={};C[1]&262144&&(d.$$scope={dirty:C,ctx:_}),!k&&C[0]&64&&(k=!0,d.checked=_[6],X(()=>k=!1)),c.$set(d)},i(_){L||(b(e.$$.fragment,_),b(t.$$.fragment,_),b(s.$$.fragment,_),b(a.$$.fragment,_),b(c.$$.fragment,_),L=!0)},o(_){y(e.$$.fragment,_),y(t.$$.fragment,_),y(s.$$.fragment,_),y(a.$$.fragment,_),y(c.$$.fragment,_),L=!1},d(_){_&&(m(l),m(i),m(o),m(u)),j(e,_),j(t,_),j(s,_),j(a,_),j(c,_)}}}function il(n){let e;return{c(){e=J("Show resolved problems")},l(l){e=K(l,"Show resolved problems")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function nl(n){let e,l,t;function i(o){n[22](o)}let s={$$slots:{default:[il]},$$scope:{ctx:n}};return n[7]!==void 0&&(s.checked=n[7]),e=new Xe({props:s}),Z.push(()=>Q(e,"checked",i)),{c(){M(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,a){T(e,o,a),t=!0},p(o,a){const r={};a[1]&262144&&(r.$$scope={dirty:a,ctx:o}),!l&&a[0]&128&&(l=!0,r.checked=o[7],X(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function je(n){let e;function l(s,o){return s[45].resolved=="No"?rl:ol}let t=l(n),i=t(n);return{c(){i.c(),e=x()},l(s){i.l(s),e=x()},m(s,o){i.m(s,o),v(s,e,o)},p(s,o){t===(t=l(s))&&i?i.p(s,o):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&m(e),i.d(s)}}}function ol(n){let e,l,t=n[45].resolved+"",i;return{c(){e=U("span"),l=J("Resolved: "),i=J(t)},l(s){e=z(s,"SPAN",{});var o=O(e);l=K(o,"Resolved: "),i=K(o,t),o.forEach(m)},m(s,o){v(s,e,o),B(e,l),B(e,i)},p(s,o){o[0]&8&&t!==(t=s[45].resolved+"")&&ae(i,t)},d(s){s&&m(e)}}}function rl(n){let e,l,t,i=n[45].resolved+"",s;return{c(){e=U("span"),l=U("b"),t=J("Resolved: "),s=J(i)},l(o){e=z(o,"SPAN",{});var a=O(e);l=z(a,"B",{});var r=O(l);t=K(r,"Resolved: "),s=K(r,i),r.forEach(m),a.forEach(m)},m(o,a){v(o,e,a),B(e,l),B(l,t),B(l,s)},p(o,a){a[0]&8&&i!==(i=o[45].resolved+"")&&ae(s,i)},d(o){o&&m(e)}}}function sl(n){let e,l,t,i=n[45].stage+"",s,o,a,r=n[45].stage!="Design"&&je(n);return{c(){e=U("div"),l=U("span"),t=J("Stage: "),s=J(i),o=A(),r&&r.c(),a=A(),this.h()},l(u){e=z(u,"DIV",{style:!0});var c=O(e);l=z(c,"SPAN",{});var k=O(l);t=K(k,"Stage: "),s=K(k,i),k.forEach(m),o=R(c),r&&r.l(c),c.forEach(m),a=R(u),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(u,c){v(u,e,c),B(e,l),B(l,t),B(l,s),B(e,o),r&&r.m(e,null),v(u,a,c)},p(u,c){c[0]&8&&i!==(i=u[45].stage+"")&&ae(s,i),u[45].stage!="Design"?r?r.p(u,c):(r=je(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(m(e),m(a)),r&&r.d()}}}function Fe(n){let e,l;function t(){return n[23](n[44])}function i(){return n[24](n[44])}return e=new Ze({props:{name:n[16](n[45]),$$slots:{default:[sl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[25]),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,o){T(e,s,o),l=!0},p(s,o){n=s;const a={};o[0]&8&&(a.name=n[16](n[45])),o[0]&8|o[1]&262144&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){y(e.$$.fragment,s),l=!1},d(s){j(e,s)}}}function Oe(n){let e;function l(s,o){return s[42].resolved=="No"?fl:al}let t=l(n),i=t(n);return{c(){i.c(),e=x()},l(s){i.l(s),e=x()},m(s,o){i.m(s,o),v(s,e,o)},p(s,o){t===(t=l(s))&&i?i.p(s,o):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&m(e),i.d(s)}}}function al(n){let e,l,t=n[42].resolved+"",i;return{c(){e=U("span"),l=J("Resolved: "),i=J(t)},l(s){e=z(s,"SPAN",{});var o=O(e);l=K(o,"Resolved: "),i=K(o,t),o.forEach(m)},m(s,o){v(s,e,o),B(e,l),B(e,i)},p(s,o){o[0]&8&&t!==(t=s[42].resolved+"")&&ae(i,t)},d(s){s&&m(e)}}}function fl(n){let e,l,t,i=n[42].resolved+"",s;return{c(){e=U("span"),l=U("b"),t=J("Resolved: "),s=J(i)},l(o){e=z(o,"SPAN",{});var a=O(e);l=z(a,"B",{});var r=O(l);t=K(r,"Resolved: "),s=K(r,i),r.forEach(m),a.forEach(m)},m(o,a){v(o,e,a),B(e,l),B(l,t),B(l,s)},p(o,a){a[0]&8&&i!==(i=o[42].resolved+"")&&ae(s,i)},d(o){o&&m(e)}}}function cl(n){let e,l,t,i=n[42].stage+"",s,o,a,r=n[42].stage!="Design"&&Oe(n);return{c(){e=U("div"),l=U("span"),t=J("Stage: "),s=J(i),o=A(),r&&r.c(),a=A(),this.h()},l(u){e=z(u,"DIV",{style:!0});var c=O(e);l=z(c,"SPAN",{});var k=O(l);t=K(k,"Stage: "),s=K(k,i),k.forEach(m),o=R(c),r&&r.l(c),c.forEach(m),a=R(u),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(u,c){v(u,e,c),B(e,l),B(l,t),B(l,s),B(e,o),r&&r.m(e,null),v(u,a,c)},p(u,c){c[0]&8&&i!==(i=u[42].stage+"")&&ae(s,i),u[42].stage!="Design"?r?r.p(u,c):(r=Oe(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(m(e),m(a)),r&&r.d()}}}function Ue(n){let e,l;function t(){return n[26](n[44])}function i(){return n[27](n[44])}return e=new Ze({props:{name:n[17](n[42]),$$slots:{default:[cl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[28]),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,o){T(e,s,o),l=!0},p(s,o){n=s;const a={};o[0]&8&&(a.name=n[17](n[42])),o[0]&8|o[1]&262144&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){y(e.$$.fragment,s),l=!1},d(s){j(e,s)}}}function ze(n){let e,l,t,i,s,o,a;return l=new Ie({props:{$$slots:{default:[_l]},$$scope:{ctx:n}}}),l.$on("click",n[12]),i=new Ie({props:{$$slots:{default:[dl]},$$scope:{ctx:n}}}),i.$on("click",n[30]),o=new Ie({props:{$$slots:{default:[bl]},$$scope:{ctx:n}}}),o.$on("click",n[31]),{c(){e=U("div"),M(l.$$.fragment),t=A(),M(i.$$.fragment),s=A(),M(o.$$.fragment),this.h()},l(r){e=z(r,"DIV",{class:!0});var u=O(e);G(l.$$.fragment,u),t=R(u),G(i.$$.fragment,u),s=R(u),G(o.$$.fragment,u),u.forEach(m),this.h()},h(){q(e,"class","control-panel svelte-70vzbr")},m(r,u){v(r,e,u),T(l,e,null),B(e,t),T(i,e,null),B(e,s),T(o,e,null),a=!0},p(r,u){const c={};u[0]&2|u[1]&262144&&(c.$$scope={dirty:u,ctx:r}),l.$set(c);const k={};u[0]&2|u[1]&262144&&(k.$$scope={dirty:u,ctx:r}),i.$set(k);const L={};u[0]&2|u[1]&262144&&(L.$$scope={dirty:u,ctx:r}),o.$set(L)},i(r){a||(b(l.$$.fragment,r),b(i.$$.fragment,r),b(o.$$.fragment,r),a=!0)},o(r){y(l.$$.fragment,r),y(i.$$.fragment,r),y(o.$$.fragment,r),a=!1},d(r){r&&m(e),j(l),j(i),j(o)}}}function ul(n){let e;return{c(){e=J("Move map")},l(l){e=K(l,"Move map")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function pl(n){let e,l="Move map";return{c(){e=U("b"),e.textContent=l},l(t){e=z(t,"B",{"data-svelte-h":!0}),$e(e)!=="svelte-ydcbkl"&&(e.textContent=l)},m(t,i){v(t,e,i)},d(t){t&&m(e)}}}function _l(n){let e,l,t,i;function s(r,u){return r[1].mode=="select"?pl:ul}let o=s(n),a=o(n);return{c(){e=U("img"),t=A(),a.c(),i=x(),this.h()},l(r){e=z(r,"IMG",{src:!0,alt:!0,style:!0}),t=R(r),a.l(r),i=x(),this.h()},h(){$t(e.src,l=Nt)||q(e,"src",l),q(e,"alt","Move map"),H(e,"vertical-align","middle")},m(r,u){v(r,e,u),v(r,t,u),a.m(r,u),v(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(m(e),m(t),m(i)),a.d(r)}}}function ml(n){let e;return{c(){e=J("New critical issue")},l(l){e=K(l,"New critical issue")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function gl(n){let e,l="New critical issue";return{c(){e=U("b"),e.textContent=l},l(t){e=z(t,"B",{"data-svelte-h":!0}),$e(e)!=="svelte-1q9dhgs"&&(e.textContent=l)},m(t,i){v(t,e,i)},d(t){t&&m(e)}}}function dl(n){let e,l,t,i;function s(r,u){return r[1].mode=="new-critical"?gl:ml}let o=s(n),a=o(n);return{c(){e=_e("svg"),l=_e("rect"),t=A(),a.c(),i=x(),this.h()},l(r){e=me(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=O(e);l=me(u,"rect",{width:!0,height:!0,fill:!0,class:!0}),O(l).forEach(m),u.forEach(m),t=R(r),a.l(r),i=x(),this.h()},h(){q(l,"width","24"),q(l,"height","24"),q(l,"fill",tt.critical.background),q(l,"class","svelte-70vzbr"),q(e,"width","24"),q(e,"height","24"),q(e,"xmlns","http://www.w3.org/2000/svg"),H(e,"vertical-align","middle")},m(r,u){v(r,e,u),B(e,l),v(r,t,u),a.m(r,u),v(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(m(e),m(t),m(i)),a.d(r)}}}function $l(n){let e;return{c(){e=J("New policy conflict")},l(l){e=K(l,"New policy conflict")},m(l,t){v(l,e,t)},d(l){l&&m(e)}}}function hl(n){let e,l="New policy conflict";return{c(){e=U("b"),e.textContent=l},l(t){e=z(t,"B",{"data-svelte-h":!0}),$e(e)!=="svelte-pf83jq"&&(e.textContent=l)},m(t,i){v(t,e,i)},d(t){t&&m(e)}}}function bl(n){let e,l,t,i;function s(r,u){return r[1].mode=="new-conflict"?hl:$l}let o=s(n),a=o(n);return{c(){e=_e("svg"),l=_e("circle"),t=A(),a.c(),i=x(),this.h()},l(r){e=me(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=O(e);l=me(u,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),O(l).forEach(m),u.forEach(m),t=R(r),a.l(r),i=x(),this.h()},h(){q(l,"cx","12"),q(l,"cy","12"),q(l,"r","12"),q(l,"fill",De),q(e,"width","24"),q(e,"height","24"),q(e,"xmlns","http://www.w3.org/2000/svg"),H(e,"vertical-align","middle")},m(r,u){v(r,e,u),B(e,l),v(r,t,u),a.m(r,u),v(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(m(e),m(t),m(i)),a.d(r)}}}function He(n){let e,l;return e=new St({props:{map:n[0],beforeId:"route-map"}}),{c(){M(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p(t,i){const s={};i[0]&1&&(s.map=t[0]),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function Je(n){let e,l,t;function i(r){n[32](r,n[45])}function s(){return n[33](n[44])}function o(){return n[34](n[44])}let a={draggable:!0,$$slots:{default:[vl]},$$scope:{ctx:n}};return n[45].point!==void 0&&(a.lngLat=n[45].point),e=new Qe({props:a}),Z.push(()=>Q(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",o),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,u){T(e,r,u),t=!0},p(r,u){n=r;const c={};u[0]&8|u[1]&262144&&(c.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,c.lngLat=n[45].point,X(()=>l=!1)),e.$set(c)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function vl(n){let e,l,t,i=n[45].criticalIssue+"",s;return{c(){e=_e("svg"),l=_e("rect"),t=_e("text"),s=J(i),this.h()},l(o){e=me(o,"svg",{width:!0,height:!0,xmlns:!0});var a=O(e);l=me(a,"rect",{width:!0,height:!0,fill:!0,class:!0}),O(l).forEach(m),t=me(a,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var r=O(t);s=K(r,i),r.forEach(m),a.forEach(m),this.h()},h(){q(l,"width","40"),q(l,"height","40"),q(l,"fill",tt.critical.background),q(l,"class","svelte-70vzbr"),q(t,"x","50%"),q(t,"y","50%"),q(t,"dominant-baseline","middle"),q(t,"text-anchor","middle"),H(t,"fill","white"),H(t,"font","bold 15px sans-serif"),q(e,"width","40"),q(e,"height","40"),q(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){v(o,e,a),B(e,l),B(e,t),B(t,s)},p(o,a){a[0]&8&&i!==(i=o[45].criticalIssue+"")&&ae(s,i)},d(o){o&&m(e)}}}function Ke(n){let e=Ce(n[7],n[45].resolved),l,t,i=e&&Je(n);return{c(){i&&i.c(),l=x()},l(s){i&&i.l(s),l=x()},m(s,o){i&&i.m(s,o),v(s,l,o),t=!0},p(s,o){o[0]&136&&(e=Ce(s[7],s[45].resolved)),e?i?(i.p(s,o),o[0]&136&&b(i,1)):(i=Je(s),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(ie(),y(i,1,1,()=>{i=null}),ne())},i(s){t||(b(i),t=!0)},o(s){y(i),t=!1},d(s){s&&m(l),i&&i.d(s)}}}function We(n){let e,l,t;function i(r){n[35](r,n[42])}function s(){return n[36](n[44])}function o(){return n[37](n[44])}let a={draggable:!0,$$slots:{default:[kl]},$$scope:{ctx:n}};return n[42].point!==void 0&&(a.lngLat=n[42].point),e=new Qe({props:a}),Z.push(()=>Q(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",o),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,u){T(e,r,u),t=!0},p(r,u){n=r;const c={};u[0]&8|u[1]&262144&&(c.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,c.lngLat=n[42].point,X(()=>l=!1)),e.$set(c)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function kl(n){let e,l=n[42].conflict+"",t;return{c(){e=U("span"),t=J(l),this.h()},l(i){e=z(i,"SPAN",{class:!0});var s=O(e);t=K(s,l),s.forEach(m),this.h()},h(){q(e,"class","dot svelte-70vzbr"),H(e,"background",De)},m(i,s){v(i,e,s),B(e,t)},p(i,s){s[0]&8&&l!==(l=i[42].conflict+"")&&ae(t,l)},d(i){i&&m(e)}}}function Ye(n){let e=Ce(n[7],n[42].resolved),l,t,i=e&&We(n);return{c(){i&&i.c(),l=x()},l(s){i&&i.l(s),l=x()},m(s,o){i&&i.m(s,o),v(s,l,o),t=!0},p(s,o){o[0]&136&&(e=Ce(s[7],s[42].resolved)),e?i?(i.p(s,o),o[0]&136&&b(i,1)):(i=We(s),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(ie(),y(i,1,1,()=>{i=null}),ne())},i(s){t||(b(i),t=!0)},o(s){y(i),t=!1},d(s){s&&m(l),i&&i.d(s)}}}function wl(n){let e,l;return e=new At({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){M(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p:ht,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function Cl(n){let e,l,t,i,s,o,a,r,u,c;e=new Pt({}),e.$on("click",n[13]);let k=n[1].mode!="editing"&&ze(n);i=new Tt({props:{show:n[6],id:"route-map"}});let L=n[0]&&He(n),D=se(n[3].criticalIssues),g=[];for(let f=0;f<D.length;f+=1)g[f]=Ke(Me(n,D,f));const E=f=>y(g[f],1,1,()=>{g[f]=null});let w=se(n[3].policyConflictLog),_=[];for(let f=0;f<w.length;f+=1)_[f]=Ye(Ve(n,w,f));const C=f=>y(_[f],1,1,()=>{_[f]=null});return u=new Bt({props:{data:n[8],$$slots:{default:[wl]},$$scope:{ctx:n}}}),{c(){M(e.$$.fragment),l=A(),k&&k.c(),t=A(),M(i.$$.fragment),s=A(),L&&L.c(),o=A();for(let f=0;f<g.length;f+=1)g[f].c();a=A();for(let f=0;f<_.length;f+=1)_[f].c();r=A(),M(u.$$.fragment)},l(f){G(e.$$.fragment,f),l=R(f),k&&k.l(f),t=R(f),G(i.$$.fragment,f),s=R(f),L&&L.l(f),o=R(f);for(let $=0;$<g.length;$+=1)g[$].l(f);a=R(f);for(let $=0;$<_.length;$+=1)_[$].l(f);r=R(f),G(u.$$.fragment,f)},m(f,$){T(e,f,$),v(f,l,$),k&&k.m(f,$),v(f,t,$),T(i,f,$),v(f,s,$),L&&L.m(f,$),v(f,o,$);for(let d=0;d<g.length;d+=1)g[d]&&g[d].m(f,$);v(f,a,$);for(let d=0;d<_.length;d+=1)_[d]&&_[d].m(f,$);v(f,r,$),T(u,f,$),c=!0},p(f,$){f[1].mode!="editing"?k?(k.p(f,$),$[0]&2&&b(k,1)):(k=ze(f),k.c(),b(k,1),k.m(t.parentNode,t)):k&&(ie(),y(k,1,1,()=>{k=null}),ne());const d={};if($[0]&64&&(d.show=f[6]),i.$set(d),f[0]?L?(L.p(f,$),$[0]&1&&b(L,1)):(L=He(f),L.c(),b(L,1),L.m(o.parentNode,o)):L&&(ie(),y(L,1,1,()=>{L=null}),ne()),$[0]&648){D=se(f[3].criticalIssues);let N;for(N=0;N<D.length;N+=1){const Y=Me(f,D,N);g[N]?(g[N].p(Y,$),b(g[N],1)):(g[N]=Ke(Y),g[N].c(),b(g[N],1),g[N].m(a.parentNode,a))}for(ie(),N=D.length;N<g.length;N+=1)E(N);ne()}if($[0]&648){w=se(f[3].policyConflictLog);let N;for(N=0;N<w.length;N+=1){const Y=Ve(f,w,N);_[N]?(_[N].p(Y,$),b(_[N],1)):(_[N]=Ye(Y),_[N].c(),b(_[N],1),_[N].m(r.parentNode,r))}for(ie(),N=w.length;N<_.length;N+=1)C(N);ne()}const I={};$[0]&256&&(I.data=f[8]),$[1]&262144&&(I.$$scope={dirty:$,ctx:f}),u.$set(I)},i(f){if(!c){b(e.$$.fragment,f),b(k),b(i.$$.fragment,f),b(L);for(let $=0;$<D.length;$+=1)b(g[$]);for(let $=0;$<w.length;$+=1)b(_[$]);b(u.$$.fragment,f),c=!0}},o(f){y(e.$$.fragment,f),y(k),y(i.$$.fragment,f),y(L),g=g.filter(Boolean);for(let $=0;$<g.length;$+=1)y(g[$]);_=_.filter(Boolean);for(let $=0;$<_.length;$+=1)y(_[$]);y(u.$$.fragment,f),c=!1},d(f){f&&(m(l),m(t),m(s),m(o),m(a),m(r)),j(e,f),k&&k.d(f),j(i,f),L&&L.d(f),ve(g,f),ve(_,f),j(u,f)}}}function yl(n){let e,l,t,i,s,o,a,r,u,c,k;const L=[Wt,Kt],D=[];function g(_,C){return _[1].mode!="editing"?0:1}t=g(n),i=D[t]=L[t](n);function E(_){n[38](_)}let w={$$slots:{default:[Cl]},$$scope:{ctx:n}};return n[0]!==void 0&&(w.map=n[0]),a=new Dt({props:w}),Z.push(()=>Q(a,"map",E)),{c(){e=U("div"),l=U("div"),i.c(),s=A(),o=U("div"),M(a.$$.fragment),this.h()},l(_){e=z(_,"DIV",{style:!0});var C=O(e);l=z(C,"DIV",{style:!0});var f=O(l);i.l(f),f.forEach(m),s=R(C),o=z(C,"DIV",{style:!0});var $=O(o);G(a.$$.fragment,$),$.forEach(m),C.forEach(m),this.h()},h(){H(l,"width","30%"),H(l,"overflow-y","scroll"),H(l,"padding","10px"),H(l,"border","1px solid black"),H(o,"position","relative"),H(o,"width","70%"),H(e,"display","flex"),H(e,"height","80vh")},m(_,C){v(_,e,C),B(e,l),D[t].m(l,null),n[29](l),B(e,s),B(e,o),T(a,o,null),u=!0,c||(k=dt(Jt,"keydown",n[18]),c=!0)},p(_,C){let f=t;t=g(_),t===f?D[t].p(_,C):(ie(),y(D[f],1,1,()=>{D[f]=null}),ne(),i=D[t],i?i.p(_,C):(i=D[t]=L[t](_),i.c()),b(i,1),i.m(l,null));const $={};C[0]&459|C[1]&262144&&($.$$scope={dirty:C,ctx:_}),!r&&C[0]&1&&(r=!0,$.map=_[0],X(()=>r=!1)),a.$set($)},i(_){u||(b(i),b(a.$$.fragment,_),u=!0)},o(_){y(i),y(a.$$.fragment,_),u=!1},d(_){_&&m(e),D[t].d(),n[29](null),j(a),c=!1,k()}}}function Il(n,e,l){let t={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:l;if(i!=null){let s=i.kind=="critical"?n.criticalIssues:n.policyConflictLog;t.features.push(Le(s[i.idx].point))}return t}function Le(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function Ce(n,e){return n||e!="Yes"}function Ll(n,e,l){let t,i,s;be(n,W,h=>l(3,i=h)),be(n,vt,h=>l(40,s=h));let o,a,r={mode:"select"},u=s.url.searchParams.get("kind")||"";u=="critical"?r={mode:"new-critical"}:u=="conflict"&&(r={mode:"new-conflict"});let c=null,k=null,L=!1,D=!0,g=!0;async function E(h){c=a.scrollTop,l(1,r={mode:"editing",id:h}),l(2,k=null),await ye(),l(4,a.scrollTop=0,a)}async function w(h){c=a.scrollTop,l(1,r={mode:"editing",id:h}),l(2,k=null),await ye(),l(4,a.scrollTop=0,a);let F=h.kind=="critical"?i.criticalIssues:i.policyConflictLog;o==null||o.flyTo({center:F[h.idx].point,duration:500})}async function _(){if(r.mode!="editing"||!o)return;let h=r.id,F=h.kind=="critical"?i.criticalIssues:i.policyConflictLog,oe=JSON.parse(JSON.stringify(F[h.idx])),mt=o.getBounds().getWest(),gt=o.getBounds().getEast();oe.point[0]+=(gt-mt)*.05;let Pe=F.toSpliced(h.idx+1,0,oe);oe.point=he(oe.point),h.kind=="critical"?re(W,i.criticalIssues=Pe,i):re(W,i.policyConflictLog=Pe,i),await E({kind:h.kind,idx:h.idx+1})}async function C(){if(r.mode=="editing"&&r.id!=null){const h=r.id.kind=="critical"?i.criticalIssues:i.policyConflictLog,F=he(h[r.id.idx].point);h[r.id.idx].point=[F[0],F[1]]}l(1,r={mode:"select"}),re(W,i.policyConflictLog=i.policyConflictLog.toSorted((h,F)=>Be(h.conflict)-Be(F.conflict)),i),re(W,i.criticalIssues=i.criticalIssues.toSorted((h,F)=>qe(h.criticalIssue)-qe(F.criticalIssue)),i),c!=null&&(await ye(),l(4,a.scrollTop=c,a),c=null)}function f(h){if(!L&&r.mode!="select"){if(r.mode=="editing"){C();return}if(r.mode=="new-critical"){const F=he(h.detail.lngLat.toArray());re(W,i.criticalIssues=[...i.criticalIssues,{criticalIssue:s.url.searchParams.get("code")||"",stage:"",point:[F[0],F[1]],locationName:"",resolved:"",notes:""}],i),E({kind:"critical",idx:i.criticalIssues.length-1})}else if(r.mode=="new-conflict"){const F=he(h.detail.lngLat.toArray());re(W,i.policyConflictLog=[...i.policyConflictLog,{conflict:s.url.searchParams.get("code")||"",stage:"",point:[F[0],F[1]],locationName:"",resolved:"",notes:""}],i),E({kind:"conflict",idx:i.policyConflictLog.length-1})}}}function $(){r.mode=="editing"&&window.confirm("Delete this entry?")&&(r.id.kind=="critical"?(i.criticalIssues.splice(r.id.idx,1),W.set(i)):(i.policyConflictLog.splice(r.id.idx,1),W.set(i)),C())}function d(h){if(!o)return;let F={type:"FeatureCollection",features:[...i.criticalIssues.map(oe=>Le(oe.point)),...i.policyConflictLog.map(oe=>Le(oe.point)),...i.summary.networkMap.features]};F.features.length>0&&o.fitBounds(qt(F),{padding:20,animate:h})}function I(h){let F=h.criticalIssue?Mt(h.criticalIssue):"Unknown critical";return h.locationName?`${F} (${h.locationName})`:F}function N(h){let F=h.conflict?"PO0"+Gt(h.conflict):"Unknown conflict";return h.locationName?`${F} (${h.locationName})`:F}function Y(h){if(r.mode=="editing"){let F=h.target.tagName,oe=F=="INPUT"||F=="TEXTAREA";h.key=="Escape"||h.key=="Enter"&&!oe?(h.stopPropagation(),C()):h.key=="Delete"&&!oe&&(h.stopPropagation(),$())}else(r.mode=="new-critical"||r.mode=="new-conflict")&&h.key=="Escape"&&(h.stopPropagation(),l(1,r={mode:"select"}))}const V=()=>d(!0);function ee(h){L=h,l(5,L)}function ge(h){D=h,l(6,D)}function fe(h){g=h,l(7,g)}const P=h=>w({kind:"critical",idx:h}),de=h=>l(2,k={kind:"critical",idx:h}),ce=()=>l(2,k=null),p=h=>w({kind:"conflict",idx:h}),S=h=>l(2,k={kind:"conflict",idx:h}),te=()=>l(2,k=null);function le(h){Z[h?"unshift":"push"](()=>{a=h,l(4,a)})}const ue=()=>l(1,r={mode:"new-critical"}),pe=()=>l(1,r={mode:"new-conflict"});function st(h,F){n.$$.not_equal(F.point,h)&&(F.point=h,W.set(i))}const at=h=>E({kind:"critical",idx:h}),ft=h=>E({kind:"critical",idx:h});function ct(h,F){n.$$.not_equal(F.point,h)&&(F.point=h,W.set(i))}const ut=h=>E({kind:"conflict",idx:h}),pt=h=>E({kind:"conflict",idx:h});function _t(h){o=h,l(0,o)}return n.$$.update=()=>{n.$$.dirty[0]&1&&o&&d(!1),n.$$.dirty[0]&3&&o&&(o.getCanvas().style.cursor=r.mode=="new-critical"||r.mode=="new-conflict"?"crosshair":"auto"),n.$$.dirty[0]&14&&l(8,t=Il(i,r,k))},[o,r,k,i,a,L,D,g,t,E,w,_,C,f,$,d,I,N,Y,V,ee,ge,fe,P,de,ce,p,S,te,le,ue,pe,st,at,ft,ct,ut,pt,_t]}class ti extends Se{constructor(e){super(),Ee(this,e,Ll,yl,Ne,{},null,[-1,-1])}}export{ti as component};
