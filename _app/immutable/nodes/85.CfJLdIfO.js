import{s as L,e as k,a as C,c as T,p as E,g as h,i as g,n as W,f,k as A}from"../chunks/scheduler.BBS-fkhU.js";import{S as R,i as I,c as d,a as y,m as S,t as $,b as P,d as v}from"../chunks/index.B8H3ypVf.js";import{s as x}from"../chunks/data.BfNL0_sG.js";import{g as O}from"../chunks/results.C35TC6mx.js";import{p as _,c as j}from"../chunks/lists.BnA5ucEg.js";import{T as D}from"../chunks/TextArea.Ck6ITb4v.js";function b(t){let e=O(t),o=t.summary.checkType=="street",r=t.summary.checkType=="path",i={Safety:"Sa",Accessibility:"Ac",Comfort:"Cf",Directness:"Di",Attractiveness:"At",Cohesion:"Co",overall:"To"},n={"Social activity":"SA","Personal security":"PS","Character and legibility":"CL",Environment:"En",overall:"To"};return[...M(t),...w(t),...p("SA",0,t.safetyCheck),...p("ST",16,t.streetCheck),...p("SP",0,t.streetPlacemakingCheck),...p("PA",16,t.pathCheck),...p("PP",16,t.pathPlacemakingCheck),...J(t),...N(t),...a("ST-LOS",[...e.levelOfService,e.overall],o,i),...a("ST-LOS",e.byMode,o,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy"}),...a("SP-LOS",[...e.placemakingCategories,e.placemakingOverall],o,n),...a("PA-LOS",[...e.levelOfService,e.overall],r,i),...a("PA-LOS",e.byMode,r,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy","Horse Riding":"HR"}),...a("PP-LOS",[...e.placemakingCategories,e.placemakingOverall],r,n),...F(t,e),...V(t),...H(t),...K()]}function M(t){let e=t.summary;return[["Scheme Ref",e.schemeReference],["Date of Design Review",e.dateDesignReview],["Scheme Name",e.schemeName],["Authority",e.authority],["Transport/ Combined Authority",e.transportOrCombinedAuthority],["Region",e.region],["Funding Programme",e.fundingProgramme],["Design Stage",e.designStage],["Funding Conditions",e.fundingConditions],["Inspector",e.inspectorEmail],["RouteLength",e.totalRouteLengthKm],["RouteFileLength",e.assessedRouteLengthKm],["Notes",e.notes],["Tool","Route Check online-alpha"],["Sub-tool",e.checkType=="street"?"Street Check":"Path Check"]]}function w(t){let e=[];for(let[o,r]of t.policyCheck.entries())e.push([`PC${u(o)}-E`,r.existing]),e.push([`PC${u(o)}-D`,r.proposed]);return e}function p(t,e,o){let r=[];for(let i=0;i<o.existingScores.length;i++)r.push([`${t}${u(i+e)}-E`,o.existingScores[i]]),r.push([`${t}${u(i+e)}-D`,o.proposedScores[i]]);return r}function u(t){return(t+1).toString().padStart(2,"0")}function J(t){let e={existing:t.policyConflictLog.filter(o=>o.stage=="Existing").length,designed:t.policyConflictLog.filter(o=>o.stage=="Design").length,removed:t.policyConflictLog.filter(o=>o.resolved=="Yes").length};return[["PC-E",e.existing],["PC-D",e.designed],["PC-Rem",e.removed],["PC-Int",e.designed],["PC-Tot",e.designed+e.existing-e.removed]]}function N(t){let e={existing:t.criticalIssues.filter(o=>o.stage=="Existing").length,designed:t.criticalIssues.filter(o=>o.stage=="Design").length,removed:t.criticalIssues.filter(o=>o.resolved=="Yes").length};return[["SA-E",e.existing],["SA-D",e.designed],["SA-Rem",e.removed],["SA-Int",e.designed],["SA-Tot",e.designed+e.existing-e.removed]]}function a(t,e,o,r){let i=[];for(let n of e){let s=r[n.category];i.push([`${t}-${s}-E`,o?"":`${Math.round(n.existing.scorePercent)}%`]),i.push([`${t}-${s}-D`,o?"":`${Math.round(n.proposed.scorePercent)}%`])}return i}function F(t,e){let o=[],r=12;for(let i=1;i<=r;i++)for(let[n,s]of[["walkingWheeling","WW"],["cycling","Cy"],["total","To"]])o.push([`J${i}-LOS-${s}-E`,i<=e.jat.length?e.jat[i-1][n].existing:""]),o.push([`J${i}-LOS-${s}-D`,i<=e.jat.length?e.jat[i-1][n].proposed:""]);for(let i=1;i<=r;i++)i<=e.jat.length?o.push([`J${i}-Arms`,t.jat[i-1].proposed.arms.length]):o.push([`J${i}-Arms`,0]);return o}function G(t,e){let o=t.policyConflictLog[e],r=0;for(let n=0;n<=e;n++)t.policyConflictLog[n].conflict==o.conflict&&r++;return[t.summary.schemeReference,`P${o.conflict.padStart(3,"0")}`,`${r.toString().padStart(2,"0")}P`].join("_")}function V(t){let e=[],o=35;for(let r=0;r<o;r++){let i;if(r<t.policyConflictLog.length){let n=t.policyConflictLog[r];i={Ref:G(t,r),Typ:_.find(s=>s[0]==n.conflict)[1],Sta:n.stage,LaL:`${n.point[1]}, ${n.point[0]}`,Loc:n.locationName,Res:n.resolved,Com:n.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[n,s]of Object.entries(i))e.push([`${u(r)}PC${n}`,s])}return e}function B(t,e){let o=t.criticalIssues[e],r=0;for(let n=0;n<=e;n++)t.criticalIssues[n].criticalIssue==o.criticalIssue&&r++;return[t.summary.schemeReference,`SA${o.criticalIssue.padStart(2,"0")}`,`${r.toString().padStart(2,"0")}P`].join("_")}function H(t){let e=[],o=35;for(let r=0;r<o;r++){let i;if(r<t.criticalIssues.length){let n=t.criticalIssues[r];i={Ref:B(t,r),Typ:j.find(s=>s[0]==n.criticalIssue)[1],Sta:n.stage,LaL:`${n.point[1]}, ${n.point[0]}`,Loc:n.locationName,Res:n.resolved,Com:n.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[n,s]of Object.entries(i))e.push([`${u(r)}SA${n}`,s])}return e}function K(){return["Area-E","Area-D","Po-WW-E","Po-WW-D","Po-Cy-E","Po-Cy-D","Cr-WW-E","Cr-WW-D","Cr-Cy-E","Cr-Cy-D","Pe-WW-D","Pe-WW-E","Pe-Cy-D","Pe-Cy-E","MD-WW-D","MD-WW-E","MD-Cy-D","MD-Cy-E","MT-E","MT-D","PT-E","PT-D","GI-E","GI-D","IT-E","IT-D","EP-E","EP-D","TM-Comments","AC-Comments"].map(e=>[e,""])}function Y(t){let e,o="TODO. Below is the start to the DALOG output as TSV (tab-separated values).",r,i,n,s,c;return i=new D({props:{label:"TSV output, just the one row of values",value:t[1]}}),s=new D({props:{label:"TSV output with header",value:`${t[0]}
${t[1]}
`}}),{c(){e=k("p"),e.textContent=o,r=C(),d(i.$$.fragment),n=C(),d(s.$$.fragment)},l(l){e=T(l,"P",{"data-svelte-h":!0}),E(e)!=="svelte-163miu5"&&(e.textContent=o),r=h(l),y(i.$$.fragment,l),n=h(l),y(s.$$.fragment,l)},m(l,m){g(l,e,m),g(l,r,m),S(i,l,m),g(l,n,m),S(s,l,m),c=!0},p:W,i(l){c||($(i.$$.fragment,l),$(s.$$.fragment,l),c=!0)},o(l){P(i.$$.fragment,l),P(s.$$.fragment,l),c=!1},d(l){l&&(f(e),f(r),f(n)),v(i,l),v(s,l)}}}function q(t,e,o){let r;A(t,x,c=>o(2,r=c));let i=b(r),n=i.map(c=>c[0]).join("	"),s=i.map(c=>c[1]).join("	");return[n,s]}class te extends R{constructor(e){super(),I(this,e,q,Y,L,{})}}export{te as component};
