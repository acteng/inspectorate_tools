import{s as re,r as j,e as O,a as W,b as V,f as G,c as N,d as g,K as Z,o as Le,i as w,j as B,v as U,k as se,a4 as Xe,t as M,w as Y,h as P,y as x,g as ce,x as Ze,n as te,l as xe}from"../chunks/scheduler.8Pqdtq9W.js";import{S as ie,i as ae,e as A,c as L,a as S,m as C,t as k,g as z,b as F,f as J,d as R}from"../chunks/index.KrNxZzBh.js";import{e as ee,u as Oe,o as Ve,B as et}from"../chunks/Geocoder.svelte_svelte_type_style_lang.DoeV07QM.js";import{p as X}from"../chunks/index.B5kdFRuP.js";import{S as ne}from"../chunks/SecondaryButton.CctJSiA9.js";import{S as Q}from"../chunks/Select.CM5L1t_m.js";import{W as je}from"../chunks/WarningButton.Cyr2mll2.js";import{W as pe}from"../chunks/WarningText.DNDO-dlG.js";import{s as E,a as tt,b as rt}from"../chunks/data.DhlDRbOc.js";import{a as Ue,n as st,g as Se,c as it,N as Ae}from"../chunks/logic.3rG38Fu6.js";import{E as at}from"../chunks/ExternalLink.DchCAz0l.js";import{T as nt}from"../chunks/TextInput.CSx64iaK.js";import{v as ot}from"../chunks/v4.D8aEg3BZ.js";import{C as oe}from"../chunks/CollapsibleCard.COCSlxIK.js";import"../chunks/paths.E8QV3XQP.js";function le(s){return typeof s=="object"?[]:lt[s]}let lt={Footway:[["Manual for Streets 2: Section 5 pp. 43","https://tsrgd.co.uk/pdf/mfs/mfs2.pdf#page=48"],["DMRB CD143 Designing for walking, cycling & horse-riding Annex pp. 7",""]],"Narrow Traffic / Bus Lane":[],"Wide Traffic / Bus Lane":[],"Traffic Lane (no buses): speed limit 20/30":[["LTN 1/20 Table 7-2 pp. 76",H(76)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"On-highway advisory/mandatory cycle lane":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"1-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"2-way protected cycle track":[["LTN 1/20 Table 5-2 pp. 43",H(43)],["LTN 1/20 Figure 4.1 pp. 33",H(33)]],"Shared use cycle track":[["LTN 1/20 Table 6-3 pp. 68",H(68)]],"Parking Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Disabled Parking Bay":[],"Loading Bay":[["LTN 1/20 table 7-3 pp. 77",H(77)]],"Buffer / Verge":[["LTN 1/20 table 6-1 pp. 54",H(54)]]};function H(s){return`https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/951074/cycle-infrastructure-design-ltn-1-20.pdf#page=${s}`}function fe(s,e){let r=Ue(e.speedLimit,e.observedSpeed);switch(s){case"Footway":return"There is no maximum width for footways; widths should take account of pedestrian volumes and composition. Suggested widths quoted here are the functional width available to the user";case"Narrow Traffic / Bus Lane":return"";case"Wide Traffic / Bus Lane":return"";case"Traffic Lane (no buses): speed limit 20/30":return e.trafficFlow=="<2,500"&&r==20?"Where traffic volumes are less than 2,500 vpd and speeds are less than 20mph, cycling in mixed traffic may be suitable for all users":"Where traffic volumes are greater than 2,500 vpd or speeds are greater than 20mph, cycling in mixed traffic is not suitable for all users";case"On-highway advisory/mandatory cycle lane":return(e.trafficFlow=="<2,500"||e.trafficFlow=="2,500-5,000")&&r==20?"Where traffic volumes are less than 2,500 vpd and/or speeds are less than 20mph, advisory or mandatory cycle lanes may be suitable for all users":"Where traffic volumes are greater than 5,000 vpd and/or speeds are greater than 20mph, advisory or mandatory cycle lanes are not suitable for all users";case"1-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.";case"2-way protected cycle track":return r==20?e.trafficFlow=="<2,500"?"If traffic flows are less than 2,500VPD and observed 85th percentile speed/speed limit is less than 30mph, then conditions for cycling in mixed traffic will suit most users":e.trafficFlow=="2,500-5,000"?"If traffic flows are greater than 2,500VPD but less than 5,000VPD, and observed 85th percentile speed/speed limit less than 30mph, then a mandatory or advisory cycle lane at the appropriate width will suit most users":"If traffic flows are greater than 5,000VPD and observed 85th percentile speed/speed limit less than 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==30?"If the observed 85th percentile speed or the speed limit is 30mph, provision of a light-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":r==40?"If the observed 85th percentile speed or the speed limit is 40mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the user plus min. protection width 0.3m.":"If the observed 85th percentile speed or the speed limit is 50+ mph, provision of a kerb-protected cycle track will suit most users. Suggested widths quoted here are the functional width available to the userplus min. protection width 0.3m.";case"Shared use cycle track":return"Potential policy conflict: 'Cyclists must be separated from pedestrians' - have you considered alternatives to a shared use cycle track?";case"Parking Bay":return"";case"Disabled Parking Bay":return"";case"Loading Bay":return"";case"Buffer / Verge":return"Your buffer / verge shouldn't impact on the functional width of your footway or cycle-track";default:return""}}function Ce(s,e,r){const t=s.slice();return t[17]=e[r][0],t[18]=e[r][1],t}function Re(s){let e,r,t,i=Se(s[0],s[7].proposed.trafficData,s[7].proposed.customFeatures,s[4],s[5])[s[3]=="Desirable"?0:1]+"",o,a,l,c,n,u=le(s[0]).length>0,d,y=fe(s[0],s[7].proposed.trafficData),v,b;const p=[ct,ut,ft],_=[];function f(m,D){return m[9]=="left"?0:m[9]=="right"?1:m[9]=="both"?2:-1}~(l=f(s))&&(c=_[l]=p[l](s));let $=u&&qe(s),T=y&&Ne(s);return{c(){e=O("p"),r=M(s[3]),t=M(" minimum width (m): "),o=M(i),a=W(),c&&c.c(),n=W(),$&&$.c(),d=W(),T&&T.c(),v=Y()},l(m){e=V(m,"P",{});var D=G(e);r=P(D,s[3]),t=P(D," minimum width (m): "),o=P(D,i),D.forEach(g),a=N(m),c&&c.l(m),n=N(m),$&&$.l(m),d=N(m),T&&T.l(m),v=Y()},m(m,D){w(m,e,D),B(e,r),B(e,t),B(e,o),w(m,a,D),~l&&_[l].m(m,D),w(m,n,D),$&&$.m(m,D),w(m,d,D),T&&T.m(m,D),w(m,v,D),b=!0},p(m,D){(!b||D&8)&&x(r,m[3]),(!b||D&185)&&i!==(i=Se(m[0],m[7].proposed.trafficData,m[7].proposed.customFeatures,m[4],m[5])[m[3]=="Desirable"?0:1]+"")&&x(o,i);let K=l;l=f(m),l!==K&&(c&&(z(),F(_[K],1,1,()=>{_[K]=null}),J()),~l?(c=_[l],c||(c=_[l]=p[l](m),c.c()),k(c,1),c.m(n.parentNode,n)):c=null),D&1&&(u=le(m[0]).length>0),u?$?($.p(m,D),D&1&&k($,1)):($=qe(m),$.c(),k($,1),$.m(d.parentNode,d)):$&&(z(),F($,1,1,()=>{$=null}),J()),D&129&&(y=fe(m[0],m[7].proposed.trafficData)),y?T?T.p(m,D):(T=Ne(m),T.c(),T.m(v.parentNode,v)):T&&(T.d(1),T=null)},i(m){b||(k(c),k($),b=!0)},o(m){F(c),F($),b=!1},d(m){m&&(g(e),g(a),g(n),g(d),g(v)),~l&&_[l].d(m),$&&$.d(m),T&&T.d(m)}}}function ft(s){let e,r;return e=new pe({props:{$$slots:{default:[pt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ut(s){let e,r;return e=new pe({props:{$$slots:{default:[dt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ct(s){let e,r;return e=new pe({props:{$$slots:{default:[mt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function pt(s){let e;return{c(){e=M("Consider buffers to left and right")},l(r){e=P(r,"Consider buffers to left and right")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function dt(s){let e;return{c(){e=M("Consider buffer to right")},l(r){e=P(r,"Consider buffer to right")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function mt(s){let e;return{c(){e=M("Consider buffer to left")},l(r){e=P(r,"Consider buffer to left")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function qe(s){let e,r="References",t,i,o,a=ee(le(s[0])),l=[];for(let n=0;n<a.length;n+=1)l[n]=We(Ce(s,a,n));const c=n=>F(l[n],1,1,()=>{l[n]=null});return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),i=O("ul");for(let n=0;n<l.length;n+=1)l[n].c()},l(n){e=V(n,"U",{"data-svelte-h":!0}),ce(e)!=="svelte-fk7cdq"&&(e.textContent=r),t=P(n,`
      :
      `),i=V(n,"UL",{});var u=G(i);for(let d=0;d<l.length;d+=1)l[d].l(u);u.forEach(g)},m(n,u){w(n,e,u),w(n,t,u),w(n,i,u);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(i,null);o=!0},p(n,u){if(u&1){a=ee(le(n[0]));let d;for(d=0;d<a.length;d+=1){const y=Ce(n,a,d);l[d]?(l[d].p(y,u),k(l[d],1)):(l[d]=We(y),l[d].c(),k(l[d],1),l[d].m(i,null))}for(z(),d=a.length;d<l.length;d+=1)c(d);J()}},i(n){if(!o){for(let u=0;u<a.length;u+=1)k(l[u]);o=!0}},o(n){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)F(l[u]);o=!1},d(n){n&&(g(e),g(t),g(i)),Ze(l,n)}}}function _t(s){let e,r=s[17]+"",t;return{c(){e=O("li"),t=M(r)},l(i){e=V(i,"LI",{});var o=G(e);t=P(o,r),o.forEach(g)},m(i,o){w(i,e,o),B(e,t)},p(i,o){o&1&&r!==(r=i[17]+"")&&x(t,r)},i:te,o:te,d(i){i&&g(e)}}}function ht(s){let e,r,t;return r=new at({props:{href:s[18],$$slots:{default:[$t]},$$scope:{ctx:s}}}),{c(){e=O("li"),L(r.$$.fragment)},l(i){e=V(i,"LI",{});var o=G(e);S(r.$$.fragment,o),o.forEach(g)},m(i,o){w(i,e,o),C(r,e,null),t=!0},p(i,o){const a={};o&1&&(a.href=i[18]),o&2097153&&(a.$$scope={dirty:o,ctx:i}),r.$set(a)},i(i){t||(k(r.$$.fragment,i),t=!0)},o(i){F(r.$$.fragment,i),t=!1},d(i){i&&g(e),R(r)}}}function $t(s){let e=s[17]+"",r;return{c(){r=M(e)},l(t){r=P(t,e)},m(t,i){w(t,r,i)},p(t,i){i&1&&e!==(e=t[17]+"")&&x(r,e)},d(t){t&&g(r)}}}function We(s){let e,r,t,i;const o=[ht,_t],a=[];function l(c,n){return c[18]?0:1}return e=l(s),r=a[e]=o[e](s),{c(){r.c(),t=Y()},l(c){r.l(c),t=Y()},m(c,n){a[e].m(c,n),w(c,t,n),i=!0},p(c,n){let u=e;e=l(c),e===u?a[e].p(c,n):(z(),F(a[u],1,1,()=>{a[u]=null}),J(),r=a[e],r?r.p(c,n):(r=a[e]=o[e](c),r.c()),k(r,1),r.m(t.parentNode,t))},i(c){i||(k(r),i=!0)},o(c){F(r),i=!1},d(c){c&&g(t),a[e].d(c)}}}function Ne(s){let e,r="Guidance",t,i,o=fe(s[0],s[7].proposed.trafficData)+"",a;return{c(){e=O("u"),e.textContent=r,t=M(`
      :
      `),i=O("p"),a=M(o),this.h()},l(l){e=V(l,"U",{"data-svelte-h":!0}),ce(e)!=="svelte-qh7mhq"&&(e.textContent=r),t=P(l,`
      :
      `),i=V(l,"P",{style:!0});var c=G(i);a=P(c,o),c.forEach(g),this.h()},h(){Z(i,"max-width","400px")},m(l,c){w(l,e,c),w(l,t,c),w(l,i,c),B(i,a)},p(l,c){c&129&&o!==(o=fe(l[0],l[7].proposed.trafficData)+"")&&x(a,o)},d(l){l&&(g(e),g(t),g(i))}}}function gt(s){let e;return{c(){e=M("←")},l(r){e=P(r,"←")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function bt(s){let e;return{c(){e=M("Delete")},l(r){e=P(r,"Delete")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function vt(s){let e;return{c(){e=M("→")},l(r){e=P(r,"→")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function wt(s){let e,r,t,i,o,a,l,c,n,u,d,y;function v(_){s[11](_)}let b={label:"Street feature type",emptyOption:!0,choices:s[8]};s[6]!==void 0&&(b.value=s[6]),r=new Q({props:b}),j.push(()=>A(r,"value",v));let p=s[0]&&Re(s);return l=new ne({props:{disabled:s[1],$$slots:{default:[gt]},$$scope:{ctx:s}}}),l.$on("click",s[12]),n=new je({props:{$$slots:{default:[bt]},$$scope:{ctx:s}}}),n.$on("click",s[13]),d=new ne({props:{disabled:s[2],$$slots:{default:[vt]},$$scope:{ctx:s}}}),d.$on("click",s[14]),{c(){e=O("div"),L(r.$$.fragment),i=W(),p&&p.c(),o=W(),a=O("div"),L(l.$$.fragment),c=W(),L(n.$$.fragment),u=W(),L(d.$$.fragment),this.h()},l(_){e=V(_,"DIV",{class:!0});var f=G(e);S(r.$$.fragment,f),i=N(f),p&&p.l(f),o=N(f),a=V(f,"DIV",{style:!0,class:!0});var $=G(a);S(l.$$.fragment,$),c=N($),S(n.$$.fragment,$),u=N($),S(d.$$.fragment,$),$.forEach(g),f.forEach(g),this.h()},h(){Z(a,"display","flex"),Z(a,"justify-content","space-between"),Le(a,"class","svelte-jig4ga"),Le(e,"class","svelte-jig4ga")},m(_,f){w(_,e,f),C(r,e,null),B(e,i),p&&p.m(e,null),B(e,o),B(e,a),C(l,a,null),B(a,c),C(n,a,null),B(a,u),C(d,a,null),y=!0},p(_,[f]){const $={};f&256&&($.choices=_[8]),!t&&f&64&&(t=!0,$.value=_[6],U(()=>t=!1)),r.$set($),_[0]?p?(p.p(_,f),f&1&&k(p,1)):(p=Re(_),p.c(),k(p,1),p.m(e,o)):p&&(z(),F(p,1,1,()=>{p=null}),J());const T={};f&2&&(T.disabled=_[1]),f&2097152&&(T.$$scope={dirty:f,ctx:_}),l.$set(T);const m={};f&2097152&&(m.$$scope={dirty:f,ctx:_}),n.$set(m);const D={};f&4&&(D.disabled=_[2]),f&2097152&&(D.$$scope={dirty:f,ctx:_}),d.$set(D)},i(_){y||(k(r.$$.fragment,_),k(p),k(l.$$.fragment,_),k(n.$$.fragment,_),k(d.$$.fragment,_),y=!0)},o(_){F(r.$$.fragment,_),F(p),F(l.$$.fragment,_),F(n.$$.fragment,_),F(d.$$.fragment,_),y=!1},d(_){_&&g(e),R(r),p&&p.d(),R(l),R(n),R(d)}}}function kt(s,e,r){let t,i,o;se(s,E,m=>r(7,o=m));let{value:a}=e,{isFirst:l}=e,{isLast:c}=e,{sectionType:n}=e,{leftFeature:u}=e,{rightFeature:d}=e,y=Xe(),v=typeof a=="object"?`custom_${a.custom}`:a;function b(m){m.startsWith("custom_")?r(0,a={custom:m.slice(7)}):r(0,a=m)}function p(m){let D=X(tt);for(let[K,ue]of Object.entries(m))D.push([`custom_${K}`,`Custom: ${ue.name}`]);return D}function _(m){v=m,r(6,v)}const f=()=>y("moveLeft"),$=()=>y("delete"),T=()=>y("moveRight");return s.$$set=m=>{"value"in m&&r(0,a=m.value),"isFirst"in m&&r(1,l=m.isFirst),"isLast"in m&&r(2,c=m.isLast),"sectionType"in m&&r(3,n=m.sectionType),"leftFeature"in m&&r(4,u=m.leftFeature),"rightFeature"in m&&r(5,d=m.rightFeature)},s.$$.update=()=>{s.$$.dirty&49&&r(9,t=a&&st(a,u,d)),s.$$.dirty&64&&b(v),s.$$.dirty&128&&r(8,i=p(o.proposed.customFeatures))},[a,l,c,n,u,d,v,o,i,t,y,_,f,$,T]}class yt extends ie{constructor(e){super(),ae(this,e,kt,wt,re,{value:0,isFirst:1,isLast:2,sectionType:3,leftFeature:4,rightFeature:5})}}function Me(s,e,r){const t=s.slice();return t[12]=e[r],t[13]=e,t[14]=r,t}function Ft(s){let e;return{c(){e=M("Add")},l(r){e=P(r,"Add")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function Pe(s,e){let r,t,i,o;function a(d){e[8](d,e[12],e[13],e[14])}function l(){return e[9](e[14])}function c(){return e[10](e[14])}function n(){return e[11](e[14])}let u={isFirst:e[14]==0,isLast:e[14]==e[0].length-1,leftFeature:e[14]==0?"":e[0][e[14]-1],rightFeature:e[14]==e[0].length-1?"":e[0][e[14]+1],sectionType:e[1]};return e[12]!==void 0&&(u.value=e[12]),t=new yt({props:u}),j.push(()=>A(t,"value",a)),t.$on("delete",l),t.$on("moveLeft",c),t.$on("moveRight",n),{key:s,first:null,c(){r=Y(),L(t.$$.fragment),this.h()},l(d){r=Y(),S(t.$$.fragment,d),this.h()},h(){this.first=r},m(d,y){w(d,r,y),C(t,d,y),o=!0},p(d,y){e=d;const v={};y&1&&(v.isFirst=e[14]==0),y&1&&(v.isLast=e[14]==e[0].length-1),y&1&&(v.leftFeature=e[14]==0?"":e[0][e[14]-1]),y&1&&(v.rightFeature=e[14]==e[0].length-1?"":e[0][e[14]+1]),y&2&&(v.sectionType=e[1]),!i&&y&1&&(i=!0,v.value=e[12],U(()=>i=!1)),t.$set(v)},i(d){o||(k(t.$$.fragment,d),o=!0)},o(d){F(t.$$.fragment,d),o=!1},d(d){d&&g(r),R(t,d)}}}function Dt(s){let e,r,t,i=[],o=new Map,a,l,c,n,u=s[2].toFixed(2)+"",d,y;e=new ne({props:{$$slots:{default:[Ft]},$$scope:{ctx:s}}}),e.$on("click",s[3]);let v=ee(s[0]);const b=p=>p[14];for(let p=0;p<v.length;p+=1){let _=Me(s,v,p),f=b(_);o.set(f,i[p]=Pe(f,_))}return{c(){L(e.$$.fragment),r=W(),t=O("div");for(let p=0;p<i.length;p+=1)i[p].c();a=W(),l=O("p"),c=M("Total width required (m): "),n=O("b"),d=M(u),this.h()},l(p){S(e.$$.fragment,p),r=N(p),t=V(p,"DIV",{style:!0});var _=G(t);for(let T=0;T<i.length;T+=1)i[T].l(_);_.forEach(g),a=N(p),l=V(p,"P",{});var f=G(l);c=P(f,"Total width required (m): "),n=V(f,"B",{});var $=G(n);d=P($,u),$.forEach(g),f.forEach(g),this.h()},h(){Z(t,"display","flex"),Z(t,"flex-direction","row")},m(p,_){C(e,p,_),w(p,r,_),w(p,t,_);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(t,null);w(p,a,_),w(p,l,_),B(l,c),B(l,n),B(n,d),y=!0},p(p,[_]){const f={};_&32768&&(f.$$scope={dirty:_,ctx:p}),e.$set(f),_&115&&(v=ee(p[0]),z(),i=Oe(i,_,b,1,p,v,o,t,Ve,Pe,null,Me),J()),(!y||_&4)&&u!==(u=p[2].toFixed(2)+"")&&x(d,u)},i(p){if(!y){k(e.$$.fragment,p);for(let _=0;_<v.length;_+=1)k(i[_]);y=!0}},o(p){F(e.$$.fragment,p);for(let _=0;_<i.length;_+=1)F(i[_]);y=!1},d(p){p&&(g(r),g(t),g(a),g(l)),R(e,p);for(let _=0;_<i.length;_+=1)i[_].d()}}}function Tt(s,e,r){let t,i;se(s,E,p=>r(7,i=p));let{streetFeaturesLeftToRight:o}=e,{sectionType:a}=e;function l(){r(0,o=[...o,""])}function c(p){o.splice(p,1),r(0,o)}function n(p){r(0,[o[p-1],o[p]]=[o[p],o[p-1]],o)}function u(p){r(0,[o[p+1],o[p]]=[o[p],o[p+1]],o)}function d(p,_,f,$){f[$]=p,r(0,o)}const y=p=>c(p),v=p=>n(p),b=p=>u(p);return s.$$set=p=>{"streetFeaturesLeftToRight"in p&&r(0,o=p.streetFeaturesLeftToRight),"sectionType"in p&&r(1,a=p.sectionType)},s.$$.update=()=>{s.$$.dirty&130&&r(2,t=it(i,a))},[o,a,t,l,c,n,u,i,d,y,v,b]}class He extends ie{constructor(e){super(),ae(this,e,Tt,Dt,re,{streetFeaturesLeftToRight:0,sectionType:1})}}function Ee(s,e,r){const t=s.slice();return t[6]=e[r],t[7]=e,t[8]=r,t}function Lt(s){let e;return{c(){e=M("Add")},l(r){e=P(r,"Add")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function St(s){let e;return{c(){e=M("Delete")},l(r){e=P(r,"Delete")},m(r,t){w(r,e,t)},d(r){r&&g(e)}}}function Be(s,e){let r,t,i,o,a,l,c,n,u,d;function y(f){e[3](f,e[6])}let v={label:"Name"};e[0].proposed.customFeatures[e[6]].name!==void 0&&(v.value=e[0].proposed.customFeatures[e[6]].name),t=new nt({props:v}),j.push(()=>A(t,"value",y));function b(f){e[4](f,e[6])}let p={label:"Minimum width (m)",width:3,min:0};e[0].proposed.customFeatures[e[6]].width!==void 0&&(p.value=e[0].proposed.customFeatures[e[6]].width),a=new Ae({props:p}),j.push(()=>A(a,"value",b));function _(){return e[5](e[6])}return n=new je({props:{$$slots:{default:[St]},$$scope:{ctx:e}}}),n.$on("click",_),{key:s,first:null,c(){r=O("div"),L(t.$$.fragment),o=W(),L(a.$$.fragment),c=W(),L(n.$$.fragment),u=W(),this.h()},l(f){r=V(f,"DIV",{style:!0});var $=G(r);S(t.$$.fragment,$),o=N($),S(a.$$.fragment,$),c=N($),S(n.$$.fragment,$),u=N($),$.forEach(g),this.h()},h(){Z(r,"display","flex"),Z(r,"justify-content","space-between"),this.first=r},m(f,$){w(f,r,$),C(t,r,null),B(r,o),C(a,r,null),B(r,c),C(n,r,null),B(r,u),d=!0},p(f,$){e=f;const T={};!i&&$&1&&(i=!0,T.value=e[0].proposed.customFeatures[e[6]].name,U(()=>i=!1)),t.$set(T);const m={};!l&&$&1&&(l=!0,m.value=e[0].proposed.customFeatures[e[6]].width,U(()=>l=!1)),a.$set(m);const D={};$&512&&(D.$$scope={dirty:$,ctx:e}),n.$set(D)},i(f){d||(k(t.$$.fragment,f),k(a.$$.fragment,f),k(n.$$.fragment,f),d=!0)},o(f){F(t.$$.fragment,f),F(a.$$.fragment,f),F(n.$$.fragment,f),d=!1},d(f){f&&g(r),R(t),R(a),R(n)}}}function Ct(s){let e,r,t=[],i=new Map,o,a;e=new ne({props:{$$slots:{default:[Lt]},$$scope:{ctx:s}}}),e.$on("click",s[1]);let l=ee(Object.keys(s[0].proposed.customFeatures));const c=n=>n[6];for(let n=0;n<l.length;n+=1){let u=Ee(s,l,n),d=c(u);i.set(d,t[n]=Be(d,u))}return{c(){L(e.$$.fragment),r=W();for(let n=0;n<t.length;n+=1)t[n].c();o=Y()},l(n){S(e.$$.fragment,n),r=N(n);for(let u=0;u<t.length;u+=1)t[u].l(n);o=Y()},m(n,u){C(e,n,u),w(n,r,u);for(let d=0;d<t.length;d+=1)t[d]&&t[d].m(n,u);w(n,o,u),a=!0},p(n,[u]){const d={};u&512&&(d.$$scope={dirty:u,ctx:n}),e.$set(d),u&5&&(l=ee(Object.keys(n[0].proposed.customFeatures)),z(),t=Oe(t,u,c,1,n,l,i,o.parentNode,Ve,Be,o,Ee),J())},i(n){if(!a){k(e.$$.fragment,n);for(let u=0;u<l.length;u+=1)k(t[u]);a=!0}},o(n){F(e.$$.fragment,n);for(let u=0;u<t.length;u+=1)F(t[u]);a=!1},d(n){n&&(g(r),g(o)),R(e,n);for(let u=0;u<t.length;u+=1)t[u].d(n)}}}function Rt(s,e,r){let t;se(s,E,n=>r(0,t=n));function i(){xe(E,t.proposed.customFeatures[ot()]={name:"",width:0},t),E.set(t)}function o(n){let u=t.proposed.customFeatures[n].name;if(t.proposed.desirableMinimumCrossSection.includes({custom:n})){window.alert(`The ${u} custom feature is used in the Desirable Minimum Cross-Section. Remove it below before deleting.`);return}if(t.proposed.absoluteMinimumCrossSection.includes({custom:n})){window.alert(`The ${u} custom feature is used in the Absolute Minimum Cross-Section. Remove it below before deleting.`);return}delete t.proposed.customFeatures[n],E.set(t)}function a(n,u){s.$$.not_equal(t.proposed.customFeatures[u].name,n)&&(t.proposed.customFeatures[u].name=n,E.set(t))}function l(n,u){s.$$.not_equal(t.proposed.customFeatures[u].width,n)&&(t.proposed.customFeatures[u].width=n,E.set(t))}return[t,i,o,a,l,n=>o(n)]}class qt extends ie{constructor(e){super(),ae(this,e,Rt,Ct,re,{})}}function Ie(s){let e,r,t,i;return{c(){e=O("p"),r=M("Effective speed limit, based on the limit and 85 percentile: "),t=M(s[1]),i=M(`
      mph`)},l(o){e=V(o,"P",{});var a=G(e);r=P(a,"Effective speed limit, based on the limit and 85 percentile: "),t=P(a,s[1]),i=P(a,`
      mph`),a.forEach(g)},m(o,a){w(o,e,a),B(e,r),B(e,t),B(e,i)},p(o,a){a&2&&x(t,o[1])},d(o){o&&g(e)}}}function Wt(s){let e,r,t,i,o,a,l,c,n,u,d,y,v,b,p,_,f,$,T,m,D,K;function ue(h){s[4](h)}let de={label:"Expected peak hour cycle flow: 1-way cycle tracks",emptyOption:!0,choices:X(["<200","200-800",">800"])};s[0].proposed.trafficData.flowOneWay!==void 0&&(de.value=s[0].proposed.trafficData.flowOneWay),e=new Q({props:de}),j.push(()=>A(e,"value",ue));function Ge(h){s[5](h)}let me={label:"Expected peak hour cycle flow: 2-way cycle tracks",emptyOption:!0,choices:X(["<300","300-1,000",">1,000"])};s[0].proposed.trafficData.flowTwoWay!==void 0&&(me.value=s[0].proposed.trafficData.flowTwoWay),i=new Q({props:me}),j.push(()=>A(i,"value",Ge));function Ke(h){s[6](h)}let _e={label:"Expected peak hour cycle flow: shared use cycle tracks",emptyOption:!0,choices:X(["<300",">300"])};s[0].proposed.trafficData.flowSharedUse!==void 0&&(_e.value=s[0].proposed.trafficData.flowSharedUse),l=new Q({props:_e}),j.push(()=>A(l,"value",Ke));function Ye(h){s[7](h)}let he={label:"Traffic flow (vpd)",emptyOption:!0,choices:X(["<2,500","2,500-5,000","5,000-10,000",">10,000"])};s[0].proposed.trafficData.trafficFlow!==void 0&&(he.value=s[0].proposed.trafficData.trafficFlow),u=new Q({props:he}),j.push(()=>A(u,"value",Ye));function ze(h){s[8](h)}let $e={label:"Speed limit (MPH)",emptyOption:!0,choices:s[2]};s[0].proposed.trafficData.speedLimit!==void 0&&($e.value=s[0].proposed.trafficData.speedLimit),v=new Q({props:$e}),j.push(()=>A(v,"value",ze));function Je(h){s[9](h)}let ge={label:"Observed 85th percentile speed (MPH)",width:3,min:0,max:120};s[0].proposed.trafficData.observedSpeed!==void 0&&(ge.value=s[0].proposed.trafficData.observedSpeed),_=new Ae({props:ge}),j.push(()=>A(_,"value",Je));let I=s[1]&&Ie(s);function Qe(h){s[10](h)}let be={label:"Street function",emptyOption:!0,choices:X(["High Street (active frontages)","Residential street","Local distributor road"])};return s[0].proposed.trafficData.streetFunction!==void 0&&(be.value=s[0].proposed.trafficData.streetFunction),m=new Q({props:be}),j.push(()=>A(m,"value",Qe)),{c(){L(e.$$.fragment),t=W(),L(i.$$.fragment),a=W(),L(l.$$.fragment),n=W(),L(u.$$.fragment),y=W(),L(v.$$.fragment),p=W(),L(_.$$.fragment),$=W(),I&&I.c(),T=W(),L(m.$$.fragment)},l(h){S(e.$$.fragment,h),t=N(h),S(i.$$.fragment,h),a=N(h),S(l.$$.fragment,h),n=N(h),S(u.$$.fragment,h),y=N(h),S(v.$$.fragment,h),p=N(h),S(_.$$.fragment,h),$=N(h),I&&I.l(h),T=N(h),S(m.$$.fragment,h)},m(h,q){C(e,h,q),w(h,t,q),C(i,h,q),w(h,a,q),C(l,h,q),w(h,n,q),C(u,h,q),w(h,y,q),C(v,h,q),w(h,p,q),C(_,h,q),w(h,$,q),I&&I.m(h,q),w(h,T,q),C(m,h,q),K=!0},p(h,q){const ve={};!r&&q&1&&(r=!0,ve.value=h[0].proposed.trafficData.flowOneWay,U(()=>r=!1)),e.$set(ve);const we={};!o&&q&1&&(o=!0,we.value=h[0].proposed.trafficData.flowTwoWay,U(()=>o=!1)),i.$set(we);const ke={};!c&&q&1&&(c=!0,ke.value=h[0].proposed.trafficData.flowSharedUse,U(()=>c=!1)),l.$set(ke);const ye={};!d&&q&1&&(d=!0,ye.value=h[0].proposed.trafficData.trafficFlow,U(()=>d=!1)),u.$set(ye);const Fe={};!b&&q&1&&(b=!0,Fe.value=h[0].proposed.trafficData.speedLimit,U(()=>b=!1)),v.$set(Fe);const De={};!f&&q&1&&(f=!0,De.value=h[0].proposed.trafficData.observedSpeed,U(()=>f=!1)),_.$set(De),h[1]?I?I.p(h,q):(I=Ie(h),I.c(),I.m(T.parentNode,T)):I&&(I.d(1),I=null);const Te={};!D&&q&1&&(D=!0,Te.value=h[0].proposed.trafficData.streetFunction,U(()=>D=!1)),m.$set(Te)},i(h){K||(k(e.$$.fragment,h),k(i.$$.fragment,h),k(l.$$.fragment,h),k(u.$$.fragment,h),k(v.$$.fragment,h),k(_.$$.fragment,h),k(m.$$.fragment,h),K=!0)},o(h){F(e.$$.fragment,h),F(i.$$.fragment,h),F(l.$$.fragment,h),F(u.$$.fragment,h),F(v.$$.fragment,h),F(_.$$.fragment,h),F(m.$$.fragment,h),K=!1},d(h){h&&(g(t),g(a),g(n),g(y),g(p),g($),g(T)),R(e,h),R(i,h),R(l,h),R(u,h),R(v,h),R(_,h),I&&I.d(h),R(m,h)}}}function Nt(s){let e,r;return e=new oe({props:{label:"Traffic data and additional information",$$slots:{default:[Wt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},p(t,[i]){const o={};i&2051&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function Mt(s,e,r){let t,i;se(s,E,b=>r(0,i=b));let{valid:o}=e,a=X(rt);function l(b){s.$$.not_equal(i.proposed.trafficData.flowOneWay,b)&&(i.proposed.trafficData.flowOneWay=b,E.set(i))}function c(b){s.$$.not_equal(i.proposed.trafficData.flowTwoWay,b)&&(i.proposed.trafficData.flowTwoWay=b,E.set(i))}function n(b){s.$$.not_equal(i.proposed.trafficData.flowSharedUse,b)&&(i.proposed.trafficData.flowSharedUse=b,E.set(i))}function u(b){s.$$.not_equal(i.proposed.trafficData.trafficFlow,b)&&(i.proposed.trafficData.trafficFlow=b,E.set(i))}function d(b){s.$$.not_equal(i.proposed.trafficData.speedLimit,b)&&(i.proposed.trafficData.speedLimit=b,E.set(i))}function y(b){s.$$.not_equal(i.proposed.trafficData.observedSpeed,b)&&(i.proposed.trafficData.observedSpeed=b,E.set(i))}function v(b){s.$$.not_equal(i.proposed.trafficData.streetFunction,b)&&(i.proposed.trafficData.streetFunction=b,E.set(i))}return s.$$set=b=>{"valid"in b&&r(3,o=b.valid)},s.$$.update=()=>{s.$$.dirty&1&&r(3,o=i.proposed.trafficData.flowOneWay!=""&&i.proposed.trafficData.flowTwoWay!=""&&i.proposed.trafficData.flowSharedUse!=""&&i.proposed.trafficData.trafficFlow!=""&&i.proposed.trafficData.speedLimit!=""&&i.proposed.trafficData.observedSpeed!=null&&i.proposed.trafficData.streetFunction!=""),s.$$.dirty&1&&r(1,t=Ue(i.proposed.trafficData.speedLimit,i.proposed.trafficData.observedSpeed))},[i,t,a,o,l,c,n,u,d,y,v]}class Pt extends ie{constructor(e){super(),ae(this,e,Mt,Nt,re,{valid:3})}}function Et(s){let e,r;return e=new qt({}),{c(){L(e.$$.fragment)},l(t){S(e.$$.fragment,t)},m(t,i){C(e,t,i),r=!0},i(t){r||(k(e.$$.fragment,t),r=!0)},o(t){F(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function Bt(s){let e,r="Fill out all traffic data above to continue";return{c(){e=O("p"),e.textContent=r},l(t){e=V(t,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-72a5ry"&&(e.textContent=r)},m(t,i){w(t,e,i)},p:te,i:te,o:te,d(t){t&&g(e)}}}function It(s){let e,r,t,i;return e=new oe({props:{label:"Desirable Minimum Cross-Section",$$slots:{default:[Ot]},$$scope:{ctx:s}}}),t=new oe({props:{label:"Absolute Minimum Cross-Section",$$slots:{default:[Vt]},$$scope:{ctx:s}}}),{c(){L(e.$$.fragment),r=W(),L(t.$$.fragment)},l(o){S(e.$$.fragment,o),r=N(o),S(t.$$.fragment,o)},m(o,a){C(e,o,a),w(o,r,a),C(t,o,a),i=!0},p(o,a){const l={};a&34&&(l.$$scope={dirty:a,ctx:o}),e.$set(l);const c={};a&34&&(c.$$scope={dirty:a,ctx:o}),t.$set(c)},i(o){i||(k(e.$$.fragment,o),k(t.$$.fragment,o),i=!0)},o(o){F(e.$$.fragment,o),F(t.$$.fragment,o),i=!1},d(o){o&&g(r),R(e,o),R(t,o)}}}function Ot(s){let e,r,t;function i(a){s[3](a)}let o={sectionType:"Desirable"};return s[1].proposed.desirableMinimumCrossSection!==void 0&&(o.streetFeaturesLeftToRight=s[1].proposed.desirableMinimumCrossSection),e=new He({props:o}),j.push(()=>A(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(a){S(e.$$.fragment,a)},m(a,l){C(e,a,l),t=!0},p(a,l){const c={};!r&&l&2&&(r=!0,c.streetFeaturesLeftToRight=a[1].proposed.desirableMinimumCrossSection,U(()=>r=!1)),e.$set(c)},i(a){t||(k(e.$$.fragment,a),t=!0)},o(a){F(e.$$.fragment,a),t=!1},d(a){R(e,a)}}}function Vt(s){let e,r,t;function i(a){s[4](a)}let o={sectionType:"Absolute"};return s[1].proposed.absoluteMinimumCrossSection!==void 0&&(o.streetFeaturesLeftToRight=s[1].proposed.absoluteMinimumCrossSection),e=new He({props:o}),j.push(()=>A(e,"streetFeaturesLeftToRight",i)),{c(){L(e.$$.fragment)},l(a){S(e.$$.fragment,a)},m(a,l){C(e,a,l),t=!0},p(a,l){const c={};!r&&l&2&&(r=!0,c.streetFeaturesLeftToRight=a[1].proposed.absoluteMinimumCrossSection,U(()=>r=!1)),e.$set(c)},i(a){t||(k(e.$$.fragment,a),t=!0)},o(a){F(e.$$.fragment,a),t=!1},d(a){R(e,a)}}}function jt(s){let e,r,t,i,o,a,l,c,n,u,d;e=new et({props:{links:[["Tools","/"],["Route cross-section","/cross_section"]],current:"Proposed Cross-Sections"}});function y(f){s[2](f)}let v={};s[0]!==void 0&&(v.valid=s[0]),t=new Pt({props:v}),j.push(()=>A(t,"valid",y)),a=new oe({props:{label:"Custom Street Features",$$slots:{default:[Et]},$$scope:{ctx:s}}});const b=[It,Bt],p=[];function _(f,$){return f[0]?0:1}return c=_(s),n=p[c]=b[c](s),{c(){L(e.$$.fragment),r=W(),L(t.$$.fragment),o=W(),L(a.$$.fragment),l=W(),n.c(),u=Y()},l(f){S(e.$$.fragment,f),r=N(f),S(t.$$.fragment,f),o=N(f),S(a.$$.fragment,f),l=N(f),n.l(f),u=Y()},m(f,$){C(e,f,$),w(f,r,$),C(t,f,$),w(f,o,$),C(a,f,$),w(f,l,$),p[c].m(f,$),w(f,u,$),d=!0},p(f,[$]){const T={};!i&&$&1&&(i=!0,T.valid=f[0],U(()=>i=!1)),t.$set(T);const m={};$&32&&(m.$$scope={dirty:$,ctx:f}),a.$set(m);let D=c;c=_(f),c===D?p[c].p(f,$):(z(),F(p[D],1,1,()=>{p[D]=null}),J(),n=p[c],n?n.p(f,$):(n=p[c]=b[c](f),n.c()),k(n,1),n.m(u.parentNode,u))},i(f){d||(k(e.$$.fragment,f),k(t.$$.fragment,f),k(a.$$.fragment,f),k(n),d=!0)},o(f){F(e.$$.fragment,f),F(t.$$.fragment,f),F(a.$$.fragment,f),F(n),d=!1},d(f){f&&(g(r),g(o),g(l),g(u)),R(e,f),R(t,f),R(a,f),p[c].d(f)}}}function Ut(s,e,r){let t;se(s,E,c=>r(1,t=c));let i=!1;function o(c){i=c,r(0,i)}function a(c){s.$$.not_equal(t.proposed.desirableMinimumCrossSection,c)&&(t.proposed.desirableMinimumCrossSection=c,E.set(t))}function l(c){s.$$.not_equal(t.proposed.absoluteMinimumCrossSection,c)&&(t.proposed.absoluteMinimumCrossSection=c,E.set(t))}return[i,t,o,a,l]}class ir extends ie{constructor(e){super(),ae(this,e,Ut,jt,re,{})}}export{ir as component};
