import{s as be,y as oe,z as ae,l as ut,u as mt,r as ct,v as _t,E as ve,k as ye,Q as bt,x as we,a as O,g as R,i as k,f as p,H as je,Y as kt,e as X,c as W,b as Q,p as te,h as q,G as ie,o as dt,q as V,L as Ie,t as H,M as Ne,d as G,n as Le,m as Ce,j as fe,w as wt,$ as Re}from"../chunks/scheduler.V-ByFQ7u.js";import{S as Me,i as Se,e as se,c as P,a as D,m as U,t as b,b as j,d as B,g as ue,f as me}from"../chunks/index.Zcf2TLuh.js";import{e as ce}from"../chunks/each.BkLWSQYL.js";import{B as jt}from"../chunks/ButtonGroup.DzOmczhL.js";import{D as Be}from"../chunks/DefaultButton.CzxH7UXd.js";import{S as ke}from"../chunks/SecondaryButton.BQqRVY7L.js";/* empty css                                                    */import{T as Fe}from"../chunks/TextInput.DTVg4cyR.js";import{W as ze}from"../chunks/WarningButton.BdQPQy4u.js";import{s as ee}from"../chunks/data.C4tUU67Z.js";import{g as Ct}from"../chunks/globals.D0QH3NT1.js";import{c as He}from"../chunks/index.DbRnLzA7.js";import{a as Lt,c as Mt,j as $e,v as St,w as Et,x as Pe,M as yt,b as It,G as Ge,L as De,h as Je,C as Nt}from"../chunks/index.CEvIUK6s.js";import{g as Ue}from"../chunks/index.CLZBLwsY.js";import{c as ge}from"../chunks/colors.DaC397qr.js";import{G as Tt,I as Te,p as At}from"../chunks/pan.BxeVykQX.js";import{M as Pt,G as Dt,S as Ut}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.DdslpJ6a.js";import{M as Ee,B as Bt,C as Ft}from"../chunks/Marker.VbHMNTk1.js";import"../chunks/paths.CT8hyD6a.js";import{R as zt}from"../chunks/RouteMapLayer.CqKCRbZ5.js";import{P as gt}from"../chunks/Popup.DZzJ2FsJ.js";import{C as qt}from"../chunks/CollapsibleCard.DJ2nM1Gw.js";import{T as pt}from"../chunks/TextArea.DEpFTjcM.js";import{R as Ve}from"../chunks/Radio.Ct96aa65.js";import{C as qe}from"../chunks/ClickableCard.DTtXZajF.js";function Ot(t){let e;const l=t[16].default,n=ut(l,t,t[24],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,i){n&&n.m(o,i),e=!0},p(o,i){n&&n.p&&(!e||i&16777216)&&mt(n,l,o,o[24],e?_t(l,o[24],i,null):ct(o[24]),null)},i(o){e||(b(n,o),e=!0)},o(o){j(n,o),e=!1},d(o){n&&n.d(o)}}}function Rt(t){let e,l,n;function o(r){t[17](r)}let i={id:t[1],type:"symbol",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[Ot]},$$scope:{ctx:t}};return t[0]!==void 0&&(i.hovered=t[0]),e=new Lt({props:i}),oe.push(()=>se(e,"hovered",o)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){P(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,a){U(e,r,a),n=!0},p(r,[a]){const s={};a&2&&(s.id=r[1]),a&4&&(s.source=r[2]),a&8&&(s.sourceLayer=r[3]),a&16&&(s.beforeId=r[4]),a&32&&(s.beforeLayerType=r[5]),a&64&&(s.paint=r[6]),a&128&&(s.layout=r[7]),a&256&&(s.filter=r[8]),a&512&&(s.applyToClusters=r[9]),a&1024&&(s.minzoom=r[10]),a&2048&&(s.maxzoom=r[11]),a&4096&&(s.hoverCursor=r[12]),a&8192&&(s.manageHoverState=r[13]),a&16384&&(s.eventsIfTopMost=r[14]),a&32768&&(s.interactive=r[15]),a&16777216&&(s.$$scope={dirty:a,ctx:r}),!l&&a&1&&(l=!0,s.hovered=r[0],ae(()=>l=!1)),e.$set(s)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){j(e.$$.fragment,r),n=!1},d(r){B(e,r)}}}function Ht(t,e,l){let{$$slots:n={},$$scope:o}=e,{id:i=Mt("symbol")}=e,{source:r=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:c=void 0}=e,{layout:g=void 0}=e,{filter:_=void 0}=e,{applyToClusters:w=void 0}=e,{minzoom:E=void 0}=e,{maxzoom:N=void 0}=e,{hoverCursor:L=void 0}=e,{manageHoverState:y=!1}=e,{hovered:$=null}=e,{eventsIfTopMost:v=!1}=e,{interactive:T=!0}=e;function f(M){$=M,l(0,$)}function d(M){ve.call(this,t,M)}function I(M){ve.call(this,t,M)}function Y(M){ve.call(this,t,M)}function K(M){ve.call(this,t,M)}function ne(M){ve.call(this,t,M)}function A(M){ve.call(this,t,M)}return t.$$set=M=>{"id"in M&&l(1,i=M.id),"source"in M&&l(2,r=M.source),"sourceLayer"in M&&l(3,a=M.sourceLayer),"beforeId"in M&&l(4,s=M.beforeId),"beforeLayerType"in M&&l(5,u=M.beforeLayerType),"paint"in M&&l(6,c=M.paint),"layout"in M&&l(7,g=M.layout),"filter"in M&&l(8,_=M.filter),"applyToClusters"in M&&l(9,w=M.applyToClusters),"minzoom"in M&&l(10,E=M.minzoom),"maxzoom"in M&&l(11,N=M.maxzoom),"hoverCursor"in M&&l(12,L=M.hoverCursor),"manageHoverState"in M&&l(13,y=M.manageHoverState),"hovered"in M&&l(0,$=M.hovered),"eventsIfTopMost"in M&&l(14,v=M.eventsIfTopMost),"interactive"in M&&l(15,T=M.interactive),"$$scope"in M&&l(24,o=M.$$scope)},[$,i,r,a,s,u,c,g,_,w,E,N,L,y,v,T,n,f,d,I,Y,K,ne,A,o]}class Gt extends Me{constructor(e){super(),Se(this,e,Ht,Rt,be,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}var Jt=Object.defineProperty,Vt=(t,e)=>Jt(t,"name",{value:e,configurable:!0});function $t(t,e,l,n={}){const o=Ue(t),i=$e(o[0]),r=$e(o[1]),a=$e(l),s=St(e,n.units),u=Math.asin(Math.sin(r)*Math.cos(s)+Math.cos(r)*Math.sin(s)*Math.cos(a)),c=i+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(r),Math.cos(s)-Math.sin(r)*Math.sin(u)),g=Pe(c),_=Pe(u);return Et([g,_],n.properties)}Vt($t,"destination");var Xe=$t,Xt=Object.defineProperty,ht=(t,e)=>Xt(t,"name",{value:e,configurable:!0});function Oe(t,e,l={}){if(l.final===!0)return vt(t,e);const n=Ue(t),o=Ue(e),i=$e(n[0]),r=$e(o[0]),a=$e(n[1]),s=$e(o[1]),u=Math.sin(r-i)*Math.cos(s),c=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(r-i);return Pe(Math.atan2(u,c))}ht(Oe,"bearing");function vt(t,e){let l=Oe(e,t);return l=(l+180)%360,l}ht(vt,"calculateFinalBearing");var Wt=Oe;const Zt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23FFFFFF'%3e%3cpath%20d='m136-240-56-56%20296-298%20160%20160%20208-206H640v-80h240v240h-80v-104L536-320%20376-480%20136-240Z'%20fill='black'/%3e%3c/svg%3e";function We(t,e,l){const n=t.slice();return n[36]=e[l],n[37]=e,n[38]=l,n}function Ze(t,e,l){const n=t.slice();return n[39]=e[l],n[40]=e,n[38]=l,n}function Ke(t){let e,l,n,o,i,r,a;return l=new Te({props:{$$slots:{default:[Yt]},$$scope:{ctx:t}}}),l.$on("click",function(){kt(t[5])&&t[5].apply(this,arguments)}),o=new Te({props:{$$slots:{default:[tn]},$$scope:{ctx:t}}}),o.$on("click",t[17]),r=new Te({props:{$$slots:{default:[on]},$$scope:{ctx:t}}}),r.$on("click",t[18]),{c(){e=X("div"),P(l.$$.fragment),n=O(),P(o.$$.fragment),i=O(),P(r.$$.fragment),this.h()},l(s){e=W(s,"DIV",{class:!0});var u=Q(e);D(l.$$.fragment,u),n=R(u),D(o.$$.fragment,u),i=R(u),D(r.$$.fragment,u),u.forEach(p),this.h()},h(){te(e,"class","control-panel svelte-1w3m76d")},m(s,u){k(s,e,u),U(l,e,null),q(e,n),U(o,e,null),q(e,i),U(r,e,null),a=!0},p(s,u){t=s;const c={};u[0]&1|u[1]&1024&&(c.$$scope={dirty:u,ctx:t}),l.$set(c);const g={};u[0]&1|u[1]&1024&&(g.$$scope={dirty:u,ctx:t}),o.$set(g);const _={};u[0]&1|u[1]&1024&&(_.$$scope={dirty:u,ctx:t}),r.$set(_)},i(s){a||(b(l.$$.fragment,s),b(o.$$.fragment,s),b(r.$$.fragment,s),a=!0)},o(s){j(l.$$.fragment,s),j(o.$$.fragment,s),j(r.$$.fragment,s),a=!1},d(s){s&&p(e),B(l),B(o),B(r)}}}function Kt(t){let e;return{c(){e=H("Move map")},l(l){e=G(l,"Move map")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Qt(t){let e,l="Move map";return{c(){e=X("u"),e.textContent=l},l(n){e=W(n,"U",{"data-svelte-h":!0}),Ce(e)!=="svelte-1719ytd"&&(e.textContent=l)},m(n,o){k(n,e,o)},d(n){n&&p(e)}}}function Yt(t){let e,l,n,o;function i(s,u){return s[0].mode=="select"?Qt:Kt}let r=i(t),a=r(t);return{c(){e=X("img"),n=O(),a.c(),o=ie(),this.h()},l(s){e=W(s,"IMG",{src:!0,alt:!0,style:!0}),n=R(s),a.l(s),o=ie(),this.h()},h(){dt(e.src,l=At)||te(e,"src",l),te(e,"alt","Move map"),V(e,"vertical-align","middle")},m(s,u){k(s,e,u),k(s,n,u),a.m(s,u),k(s,o,u)},p(s,u){r!==(r=i(s))&&(a.d(1),a=r(s),a&&(a.c(),a.m(o.parentNode,o)))},d(s){s&&(p(e),p(n),p(o)),a.d(s)}}}function xt(t){let e;return{c(){e=H("New arm")},l(l){e=G(l,"New arm")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function en(t){let e,l="New arm";return{c(){e=X("u"),e.textContent=l},l(n){e=W(n,"U",{"data-svelte-h":!0}),Ce(e)!=="svelte-1typ7gq"&&(e.textContent=l)},m(n,o){k(n,e,o)},d(n){n&&p(e)}}}function tn(t){let e,l,n,o,i,r;function a(c,g){return c[0].mode=="new-arm"?en:xt}let s=a(t),u=s(t);return{c(){e=Ie("svg"),l=Ie("circle"),n=Ie("text"),o=H("A"),i=O(),u.c(),r=ie(),this.h()},l(c){e=Ne(c,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var g=Q(e);l=Ne(g,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),Q(l).forEach(p),n=Ne(g,"text",{x:!0,y:!0,fill:!0});var _=Q(n);o=G(_,"A"),_.forEach(p),g.forEach(p),i=R(c),u.l(c),r=ie(),this.h()},h(){te(l,"cx","12"),te(l,"cy","12"),te(l,"r","12"),te(l,"fill","white"),te(n,"x","6"),te(n,"y","16"),te(n,"fill","#4472c4"),te(e,"width","24"),te(e,"height","24"),te(e,"xmlns","http://www.w3.org/2000/svg"),V(e,"vertical-align","middle")},m(c,g){k(c,e,g),q(e,l),q(e,n),q(n,o),k(c,i,g),u.m(c,g),k(c,r,g)},p(c,g){s!==(s=a(c))&&(u.d(1),u=s(c),u&&(u.c(),u.m(r.parentNode,r)))},d(c){c&&(p(e),p(i),p(r)),u.d(c)}}}function nn(t){let e;return{c(){e=H("New movement")},l(l){e=G(l,"New movement")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function ln(t){let e,l="New movement";return{c(){e=X("u"),e.textContent=l},l(n){e=W(n,"U",{"data-svelte-h":!0}),Ce(e)!=="svelte-o92ucp"&&(e.textContent=l)},m(n,o){k(n,e,o)},d(n){n&&p(e)}}}function on(t){let e,l,n,o;function i(s,u){return s[0].mode=="new-movement"?ln:nn}let r=i(t),a=r(t);return{c(){e=X("img"),n=O(),a.c(),o=ie(),this.h()},l(s){e=W(s,"IMG",{src:!0,alt:!0,style:!0}),n=R(s),a.l(s),o=ie(),this.h()},h(){dt(e.src,l=Zt)||te(e,"src",l),te(e,"alt","New movement"),V(e,"vertical-align","middle")},m(s,u){k(s,e,u),k(s,n,u),a.m(s,u),k(s,o,u)},p(s,u){r!==(r=i(s))&&(a.d(1),a=r(s),a&&(a.c(),a.m(o.parentNode,o)))},d(s){s&&(p(e),p(n),p(o)),a.d(s)}}}function rn(t){let e,l=hn(t[38])+"",n;return{c(){e=X("span"),n=H(l),this.h()},l(o){e=W(o,"SPAN",{class:!0});var i=Q(e);n=G(i,l),i.forEach(p),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),V(e,"color","#4472c4"),V(e,"background-color","white")},m(o,i){k(o,e,i),q(e,n)},p:Le,d(o){o&&p(e)}}}function Qe(t){let e,l,n;function o(s){t[19](s,t[39])}function i(){return t[20](t[38])}function r(){return t[21](t[38])}let a={draggable:!0,$$slots:{default:[rn]},$$scope:{ctx:t}};return t[39].point!==void 0&&(a.lngLat=t[39].point),e=new Ee({props:a}),oe.push(()=>se(e,"lngLat",o)),e.$on("dragend",i),e.$on("click",r),{c(){P(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,u){U(e,s,u),n=!0},p(s,u){t=s;const c={};u[1]&1024&&(c.$$scope={dirty:u,ctx:t}),!l&&u[0]&70&&(l=!0,c.lngLat=t[39].point,ae(()=>l=!1)),e.$set(c)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){j(e.$$.fragment,s),n=!1},d(s){B(e,s)}}}function an(t){let e;return{c(){e=X("span"),this.h()},l(l){e=W(l,"SPAN",{class:!0}),Q(e).forEach(p),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),V(e,"background-color",t[9][t[36].score]),V(e,"opacity",t[36].kind=="walking & wheeling"?"0%":"100%")},m(l,n){k(l,e,n)},p(l,n){n[0]&70&&V(e,"background-color",l[9][l[36].score]),n[0]&70&&V(e,"opacity",l[36].kind=="walking & wheeling"?"0%":"100%")},d(l){l&&p(e)}}}function sn(t){let e;return{c(){e=X("span"),this.h()},l(l){e=W(l,"SPAN",{class:!0}),Q(e).forEach(p),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),V(e,"background-color",t[9][t[36].score])},m(l,n){k(l,e,n)},p(l,n){n[0]&70&&V(e,"background-color",l[9][l[36].score])},d(l){l&&p(e)}}}function fn(t){let e;return{c(){e=X("span"),this.h()},l(l){e=W(l,"SPAN",{class:!0}),Q(e).forEach(p),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),V(e,"background-color",t[9][t[36].score]),V(e,"opacity","0%")},m(l,n){k(l,e,n)},p(l,n){n[0]&70&&V(e,"background-color",l[9][l[36].score])},d(l){l&&p(e)}}}function Ye(t){let e,l,n,o,i,r,a,s,u;function c(d){t[22](d,t[36])}function g(){return t[23](t[38])}function _(){return t[24](t[38])}let w={draggable:!0,$$slots:{default:[an]},$$scope:{ctx:t}};t[36].point1!==void 0&&(w.lngLat=t[36].point1),e=new Ee({props:w}),oe.push(()=>se(e,"lngLat",c)),e.$on("dragend",g),e.$on("click",_);function E(d){t[25](d,t[36])}function N(){return t[26](t[38])}function L(){return t[27](t[38])}let y={draggable:!0,$$slots:{default:[sn]},$$scope:{ctx:t}};t[36].point2!==void 0&&(y.lngLat=t[36].point2),o=new Ee({props:y}),oe.push(()=>se(o,"lngLat",E)),o.$on("dragend",N),o.$on("click",L);function $(d){t[28](d,t[36])}function v(){return t[29](t[38])}function T(){return t[30](t[38])}let f={draggable:!0,$$slots:{default:[fn]},$$scope:{ctx:t}};return t[36].point3!==void 0&&(f.lngLat=t[36].point3),a=new Ee({props:f}),oe.push(()=>se(a,"lngLat",$)),a.$on("dragend",v),a.$on("click",T),{c(){P(e.$$.fragment),n=O(),P(o.$$.fragment),r=O(),P(a.$$.fragment)},l(d){D(e.$$.fragment,d),n=R(d),D(o.$$.fragment,d),r=R(d),D(a.$$.fragment,d)},m(d,I){U(e,d,I),k(d,n,I),U(o,d,I),k(d,r,I),U(a,d,I),u=!0},p(d,I){t=d;const Y={};I[0]&70|I[1]&1024&&(Y.$$scope={dirty:I,ctx:t}),!l&&I[0]&70&&(l=!0,Y.lngLat=t[36].point1,ae(()=>l=!1)),e.$set(Y);const K={};I[0]&70|I[1]&1024&&(K.$$scope={dirty:I,ctx:t}),!i&&I[0]&70&&(i=!0,K.lngLat=t[36].point2,ae(()=>i=!1)),o.$set(K);const ne={};I[0]&70|I[1]&1024&&(ne.$$scope={dirty:I,ctx:t}),!s&&I[0]&70&&(s=!0,ne.lngLat=t[36].point3,ae(()=>s=!1)),a.$set(ne)},i(d){u||(b(e.$$.fragment,d),b(o.$$.fragment,d),b(a.$$.fragment,d),u=!0)},o(d){j(e.$$.fragment,d),j(o.$$.fragment,d),j(a.$$.fragment,d),u=!1},d(d){d&&(p(n),p(r)),B(e,d),B(o,d),B(a,d)}}}function un(t){let e=(t[35].name||"Untitled movement")+"",l;return{c(){l=H(e)},l(n){l=G(n,e)},m(n,o){k(n,l,o)},p(n,o){o[1]&16&&e!==(e=(n[35].name||"Untitled movement")+"")&&fe(l,e)},d(n){n&&p(l)}}}function mn(t){let e,l;return e=new gt({props:{$$slots:{default:[un,({props:n})=>({35:n}),({props:n})=>[0,n?16:0]]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o[1]&1040&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function cn(t){let e=(t[35].name||"Untitled movement")+"",l;return{c(){l=H(e)},l(n){l=G(n,e)},m(n,o){k(n,l,o)},p(n,o){o[1]&16&&e!==(e=(n[35].name||"Untitled movement")+"")&&fe(l,e)},d(n){n&&p(l)}}}function _n(t){let e,l;return e=new gt({props:{$$slots:{default:[cn,({props:n})=>({35:n}),({props:n})=>[0,n?16:0]]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o[1]&1040&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function dn(t){let e,l,n,o,i,r;return e=new De({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":Je(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[mn]},$$scope:{ctx:t}}}),e.$on("click",t[11]),n=new De({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":Je(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[_n]},$$scope:{ctx:t}}}),n.$on("click",t[11]),i=new Gt({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"â¬†","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment),o=O(),P(i.$$.fragment)},l(a){D(e.$$.fragment,a),l=R(a),D(n.$$.fragment,a),o=R(a),D(i.$$.fragment,a)},m(a,s){U(e,a,s),k(a,l,s),U(n,a,s),k(a,o,s),U(i,a,s),r=!0},p(a,s){const u={};s[1]&1024&&(u.$$scope={dirty:s,ctx:a}),e.$set(u);const c={};s[1]&1024&&(c.$$scope={dirty:s,ctx:a}),n.$set(c)},i(a){r||(b(e.$$.fragment,a),b(n.$$.fragment,a),b(i.$$.fragment,a),r=!0)},o(a){j(e.$$.fragment,a),j(n.$$.fragment,a),j(i.$$.fragment,a),r=!1},d(a){a&&(p(l),p(o)),B(e,a),B(n,a),B(i,a)}}}function gn(t){let e,l,n,o;return e=new De({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),n=new Nt({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment)},l(i){D(e.$$.fragment,i),l=R(i),D(n.$$.fragment,i)},m(i,r){U(e,i,r),k(i,l,r),U(n,i,r),o=!0},p:Le,i(i){o||(b(e.$$.fragment,i),b(n.$$.fragment,i),o=!0)},o(i){j(e.$$.fragment,i),j(n.$$.fragment,i),o=!1},d(i){i&&p(l),B(e,i),B(n,i)}}}function pn(t){let e,l,n,o,i,r,a,s,u,c,g,_,w;e=new Pt({}),e.$on("click",t[10]);let E=t[0].mode!="editing"&&Ke(t);o=new zt({props:{show:t[3]}});let N=ce(t[6].jat[t[1]][t[2]].arms),L=[];for(let f=0;f<N.length;f+=1)L[f]=Qe(Ze(t,N,f));const y=f=>j(L[f],1,1,()=>{L[f]=null});let $=ce(t[6].jat[t[1]][t[2]].movements),v=[];for(let f=0;f<$.length;f+=1)v[f]=Ye(We(t,$,f));const T=f=>j(v[f],1,1,()=>{v[f]=null});return s=new Ge({props:{data:t[12](t[6]),$$slots:{default:[dn]},$$scope:{ctx:t}}}),c=new Ge({props:{data:t[8],$$slots:{default:[gn]},$$scope:{ctx:t}}}),_=new Tt({props:{map:t[7]}}),{c(){P(e.$$.fragment),l=O(),E&&E.c(),n=O(),P(o.$$.fragment),i=O();for(let f=0;f<L.length;f+=1)L[f].c();r=O();for(let f=0;f<v.length;f+=1)v[f].c();a=O(),P(s.$$.fragment),u=O(),P(c.$$.fragment),g=O(),P(_.$$.fragment)},l(f){D(e.$$.fragment,f),l=R(f),E&&E.l(f),n=R(f),D(o.$$.fragment,f),i=R(f);for(let d=0;d<L.length;d+=1)L[d].l(f);r=R(f);for(let d=0;d<v.length;d+=1)v[d].l(f);a=R(f),D(s.$$.fragment,f),u=R(f),D(c.$$.fragment,f),g=R(f),D(_.$$.fragment,f)},m(f,d){U(e,f,d),k(f,l,d),E&&E.m(f,d),k(f,n,d),U(o,f,d),k(f,i,d);for(let I=0;I<L.length;I+=1)L[I]&&L[I].m(f,d);k(f,r,d);for(let I=0;I<v.length;I+=1)v[I]&&v[I].m(f,d);k(f,a,d),U(s,f,d),k(f,u,d),U(c,f,d),k(f,g,d),U(_,f,d),w=!0},p(f,d){f[0].mode!="editing"?E?(E.p(f,d),d[0]&1&&b(E,1)):(E=Ke(f),E.c(),b(E,1),E.m(n.parentNode,n)):E&&(ue(),j(E,1,1,()=>{E=null}),me());const I={};if(d[0]&8&&(I.show=f[3]),o.$set(I),d[0]&86){N=ce(f[6].jat[f[1]][f[2]].arms);let A;for(A=0;A<N.length;A+=1){const M=Ze(f,N,A);L[A]?(L[A].p(M,d),b(L[A],1)):(L[A]=Qe(M),L[A].c(),b(L[A],1),L[A].m(r.parentNode,r))}for(ue(),A=N.length;A<L.length;A+=1)y(A);me()}if(d[0]&598){$=ce(f[6].jat[f[1]][f[2]].movements);let A;for(A=0;A<$.length;A+=1){const M=We(f,$,A);v[A]?(v[A].p(M,d),b(v[A],1)):(v[A]=Ye(M),v[A].c(),b(v[A],1),v[A].m(a.parentNode,a))}for(ue(),A=$.length;A<v.length;A+=1)T(A);me()}const Y={};d[0]&64&&(Y.data=f[12](f[6])),d[1]&1024&&(Y.$$scope={dirty:d,ctx:f}),s.$set(Y);const K={};d[0]&256&&(K.data=f[8]),d[1]&1024&&(K.$$scope={dirty:d,ctx:f}),c.$set(K);const ne={};d[0]&128&&(ne.map=f[7]),_.$set(ne)},i(f){if(!w){b(e.$$.fragment,f),b(E),b(o.$$.fragment,f);for(let d=0;d<N.length;d+=1)b(L[d]);for(let d=0;d<$.length;d+=1)b(v[d]);b(s.$$.fragment,f),b(c.$$.fragment,f),b(_.$$.fragment,f),w=!0}},o(f){j(e.$$.fragment,f),j(E),j(o.$$.fragment,f),L=L.filter(Boolean);for(let d=0;d<L.length;d+=1)j(L[d]);v=v.filter(Boolean);for(let d=0;d<v.length;d+=1)j(v[d]);j(s.$$.fragment,f),j(c.$$.fragment,f),j(_.$$.fragment,f),w=!1},d(f){f&&(p(l),p(n),p(i),p(r),p(a),p(u),p(g)),B(e,f),E&&E.d(f),B(o,f),je(L,f),je(v,f),B(s,f),B(c,f),B(_,f)}}}function $n(t){let e,l,n;function o(r){t[31](r)}let i={$$slots:{default:[pn]},$$scope:{ctx:t}};return t[7]!==void 0&&(i.map=t[7]),e=new yt({props:i}),oe.push(()=>se(e,"map",o)),{c(){P(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,a){U(e,r,a),n=!0},p(r,a){const s={};a[0]&511|a[1]&1024&&(s.$$scope={dirty:a,ctx:r}),!l&&a[0]&128&&(l=!0,s.map=r[7],ae(()=>l=!1)),e.$set(s)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){j(e.$$.fragment,r),n=!1},d(r){B(e,r)}}}function xe(t,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:t.point}}}function hn(t){return String.fromCharCode(t+65)}function vn(t,e,l){let n,o;ye(t,ee,h=>l(6,o=h));let{junctionIdx:i}=e,{stage:r}=e,{mode:a}=e,{hoveringSidebar:s}=e,{streetviewOn:u}=e,{showRoute:c}=e,{select:g}=e,{stopEditing:_}=e,w,E={0:ge.red.background,1:ge.amber.background,2:ge.green.background,X:ge.critical.background};function N(h,C,le){let pe={type:"FeatureCollection",features:[]},he=C.mode=="editing"?C.id:le;return he!=null&&(he.kind=="arm"?pe.features.push(xe(h.jat[i][r].arms[he.idx],he.idx)):pe.features.push(v(h.jat[i][r].movements[he.idx],he.idx))),pe}async function L(h){if(!u){for(let C of w.queryRenderedFeatures(h.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(a.mode!="select"){if(a.mode=="editing"){await _();return}a.mode=="new-arm"?(we(ee,o.jat[i][r].arms=[...o.jat[i][r].arms,{point:h.detail.lngLat.toArray(),name:""}],o),await g({kind:"arm",idx:o.jat[i][r].arms.length-1})):(we(ee,o.jat[i][r].movements=[...o.jat[i][r].movements,{point1:h.detail.lngLat.toArray(),point2:Xe(h.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Xe(h.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),await g({kind:"movement",idx:o.jat[i][r].movements.length-1}))}}}async function y(h){await g({kind:"movement",idx:h.detail.features[0].id})}bt(()=>{f(!1)});function $(h){let C={type:"FeatureCollection",features:h.jat[i][r].movements.map((le,pe)=>v(le,pe))};for(let le of h.jat[i][r].movements)if(C.features.push(T(le,C.features.length)),le.kind=="walking & wheeling"){let pe={...le,point1:le.point3,point3:le.point1};C.features.push(T(pe,C.features.length))}return C}function v(h,C){return{type:"Feature",id:C,properties:{name:h.name,kind:h.kind,color:E[h.score]},geometry:{type:"LineString",coordinates:[h.point1,h.point2,h.point3]}}}function T(h,C){return{type:"Feature",id:C,properties:{kind:h.kind,color:E[h.score],angle:Wt(h.point2,h.point3)},geometry:{type:"Point",coordinates:h.point3}}}function f(h){let C=$(o);for(let le of o.jat[i][r].arms)C.features.push(xe(le,C.features.length));for(let le of o.summary.networkMap.features)C.features.push(le);C.features.length>0&&w.fitBounds(It(C),{padding:20,animate:h})}function d(){return w}const I=()=>l(0,a={mode:"new-arm"}),Y=()=>l(0,a={mode:"new-movement"});function K(h,C){t.$$.not_equal(C.point,h)&&(C.point=h,ee.set(o))}const ne=h=>g({kind:"arm",idx:h}),A=h=>g({kind:"arm",idx:h});function M(h,C){t.$$.not_equal(C.point1,h)&&(C.point1=h,ee.set(o))}const J=h=>g({kind:"movement",idx:h}),de=h=>g({kind:"movement",idx:h});function x(h,C){t.$$.not_equal(C.point2,h)&&(C.point2=h,ee.set(o))}const z=h=>g({kind:"movement",idx:h}),F=h=>g({kind:"movement",idx:h});function re(h,C){t.$$.not_equal(C.point3,h)&&(C.point3=h,ee.set(o))}const Z=h=>g({kind:"movement",idx:h}),m=h=>g({kind:"movement",idx:h});function S(h){w=h,l(7,w)}return t.$$set=h=>{"junctionIdx"in h&&l(1,i=h.junctionIdx),"stage"in h&&l(2,r=h.stage),"mode"in h&&l(0,a=h.mode),"hoveringSidebar"in h&&l(13,s=h.hoveringSidebar),"streetviewOn"in h&&l(14,u=h.streetviewOn),"showRoute"in h&&l(3,c=h.showRoute),"select"in h&&l(4,g=h.select),"stopEditing"in h&&l(5,_=h.stopEditing)},t.$$.update=()=>{t.$$.dirty[0]&8257&&l(8,n=N(o,a,s))},[a,i,r,c,g,_,o,w,n,E,L,y,$,s,u,f,d,I,Y,K,ne,A,M,J,de,x,z,F,re,Z,m,S]}class bn extends Me{constructor(e){super(),Se(this,e,vn,$n,be,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:13,streetviewOn:14,showRoute:3,select:4,stopEditing:5,zoom:15,getMap:16},null,[-1,-1])}get zoom(){return this.$$.ctx[15]}get getMap(){return this.$$.ctx[16]}}function kn(t){let e,l,n,o,i,r,a,s,u,c,g,_;function w(f){t[5](f)}let E={label:"Name"};t[3].jat[t[0]][t[1]].movements[t[2]].name!==void 0&&(E.value=t[3].jat[t[0]][t[1]].movements[t[2]].name),e=new Fe({props:E}),oe.push(()=>se(e,"value",w));function N(f){t[6](f)}let L={legend:"Movement",choices:[["cycling","Cycling"],["walking & wheeling","Walking & Wheeling"]]};t[3].jat[t[0]][t[1]].movements[t[2]].kind!==void 0&&(L.value=t[3].jat[t[0]][t[1]].movements[t[2]].kind),o=new Ve({props:L}),oe.push(()=>se(o,"value",N));function y(f){t[7](f)}let $={legend:"Score",choices:t[4]};t[3].jat[t[0]][t[1]].movements[t[2]].score!==void 0&&($.value=t[3].jat[t[0]][t[1]].movements[t[2]].score),a=new Ve({props:$}),oe.push(()=>se(a,"value",y));function v(f){t[8](f)}let T={label:"Comments"};return t[3].jat[t[0]][t[1]].movements[t[2]].notes!==void 0&&(T.value=t[3].jat[t[0]][t[1]].movements[t[2]].notes),c=new pt({props:T}),oe.push(()=>se(c,"value",v)),{c(){P(e.$$.fragment),n=O(),P(o.$$.fragment),r=O(),P(a.$$.fragment),u=O(),P(c.$$.fragment)},l(f){D(e.$$.fragment,f),n=R(f),D(o.$$.fragment,f),r=R(f),D(a.$$.fragment,f),u=R(f),D(c.$$.fragment,f)},m(f,d){U(e,f,d),k(f,n,d),U(o,f,d),k(f,r,d),U(a,f,d),k(f,u,d),U(c,f,d),_=!0},p(f,[d]){const I={};!l&&d&15&&(l=!0,I.value=f[3].jat[f[0]][f[1]].movements[f[2]].name,ae(()=>l=!1)),e.$set(I);const Y={};!i&&d&15&&(i=!0,Y.value=f[3].jat[f[0]][f[1]].movements[f[2]].kind,ae(()=>i=!1)),o.$set(Y);const K={};!s&&d&15&&(s=!0,K.value=f[3].jat[f[0]][f[1]].movements[f[2]].score,ae(()=>s=!1)),a.$set(K);const ne={};!g&&d&15&&(g=!0,ne.value=f[3].jat[f[0]][f[1]].movements[f[2]].notes,ae(()=>g=!1)),c.$set(ne)},i(f){_||(b(e.$$.fragment,f),b(o.$$.fragment,f),b(a.$$.fragment,f),b(c.$$.fragment,f),_=!0)},o(f){j(e.$$.fragment,f),j(o.$$.fragment,f),j(a.$$.fragment,f),j(c.$$.fragment,f),_=!1},d(f){f&&(p(n),p(r),p(u)),B(e,f),B(o,f),B(a,f),B(c,f)}}}function wn(t,e,l){let n;ye(t,ee,_=>l(3,n=_));let{junctionIdx:o}=e,{stage:i}=e,{idx:r}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(_){t.$$.not_equal(n.jat[o][i].movements[r].name,_)&&(n.jat[o][i].movements[r].name=_,ee.set(n))}function u(_){t.$$.not_equal(n.jat[o][i].movements[r].kind,_)&&(n.jat[o][i].movements[r].kind=_,ee.set(n))}function c(_){t.$$.not_equal(n.jat[o][i].movements[r].score,_)&&(n.jat[o][i].movements[r].score=_,ee.set(n))}function g(_){t.$$.not_equal(n.jat[o][i].movements[r].notes,_)&&(n.jat[o][i].movements[r].notes=_,ee.set(n))}return t.$$set=_=>{"junctionIdx"in _&&l(0,o=_.junctionIdx),"stage"in _&&l(1,i=_.stage),"idx"in _&&l(2,r=_.idx)},[o,i,r,n,a,s,u,c,g]}class jn extends Me{constructor(e){super(),Se(this,e,wn,kn,be,{junctionIdx:0,stage:1,idx:2})}}function _e(t){if(t.movements.length==0)return"No movements added";let e=0,l=0;for(let o of t.movements)e+={0:0,1:1,2:2,X:0}[o.score],l+=2;let n=e/l*100;return`${Math.round(n)}%`}const{window:Cn}=Ct;function et(t,e,l){const n=t.slice();n[33]=e[l],n[36]=l;const o=n[16][n[33].score];return n[34]=o,n}function tt(t,e,l){const n=t.slice();return n[37]=e[l],n[36]=l,n}function Ln(t){let e,l,n,o,i,r,a,s;e=new Be({props:{$$slots:{default:[Sn]},$$scope:{ctx:t}}}),e.$on("click",t[11]),n=new ze({props:{$$slots:{default:[En]},$$scope:{ctx:t}}}),n.$on("click",t[12]);const u=[In,yn],c=[];function g(_,w){return _[2].id.kind=="movement"?0:1}return i=g(t),r=c[i]=u[i](t),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment),o=O(),r.c(),a=ie()},l(_){D(e.$$.fragment,_),l=R(_),D(n.$$.fragment,_),o=R(_),r.l(_),a=ie()},m(_,w){U(e,_,w),k(_,l,w),U(n,_,w),k(_,o,w),c[i].m(_,w),k(_,a,w),s=!0},p(_,w){const E={};w[1]&1&&(E.$$scope={dirty:w,ctx:_}),e.$set(E);const N={};w[1]&1&&(N.$$scope={dirty:w,ctx:_}),n.$set(N);let L=i;i=g(_),i===L?c[i].p(_,w):(ue(),j(c[L],1,1,()=>{c[L]=null}),me(),r=c[i],r?r.p(_,w):(r=c[i]=u[i](_),r.c()),b(r,1),r.m(a.parentNode,a))},i(_){s||(b(e.$$.fragment,_),b(n.$$.fragment,_),b(r),s=!0)},o(_){j(e.$$.fragment,_),j(n.$$.fragment,_),j(r),s=!1},d(_){_&&(p(l),p(o),p(a)),B(e,_),B(n,_),c[i].d(_)}}}function Mn(t){let e,l,n,o,i="Arms",r,a,s,u,c="Movements",g,_,w,E,N,L,y=(t[8].jat[t[0]].name||"Untitled junction")+"",$,v,T=_e(t[8].jat[t[0]][t[1]])+"",f,d,I,Y,K;const ne=t[17].default,A=ut(ne,t,t[31],null);l=new qt({props:{label:"Tools",$$slots:{default:[Dn]},$$scope:{ctx:t}}});let M=ce(t[8].jat[t[0]][t[1]].arms),J=[];for(let m=0;m<M.length;m+=1)J[m]=nt(tt(t,M,m));const de=m=>j(J[m],1,1,()=>{J[m]=null});let x=t[8].jat[t[0]][t[9]].arms.length>0&&lt(t),z=ce(t[8].jat[t[0]][t[1]].movements),F=[];for(let m=0;m<z.length;m+=1)F[m]=ot(et(t,z,m));const re=m=>j(F[m],1,1,()=>{F[m]=null});let Z=t[8].jat[t[0]][t[9]].movements.length>0&&rt(t);return{c(){A&&A.c(),e=O(),P(l.$$.fragment),n=O(),o=X("h3"),o.textContent=i,r=O();for(let m=0;m<J.length;m+=1)J[m].c();a=O(),x&&x.c(),s=O(),u=X("h3"),u.textContent=c,g=O(),_=X("p"),w=H("Total JAT score for "),E=H(t[1]),N=O(),L=X("u"),$=H(y),v=H(`
        : `),f=H(T),d=O();for(let m=0;m<F.length;m+=1)F[m].c();I=O(),Z&&Z.c(),Y=ie()},l(m){A&&A.l(m),e=R(m),D(l.$$.fragment,m),n=R(m),o=W(m,"H3",{"data-svelte-h":!0}),Ce(o)!=="svelte-ld74qb"&&(o.textContent=i),r=R(m);for(let C=0;C<J.length;C+=1)J[C].l(m);a=R(m),x&&x.l(m),s=R(m),u=W(m,"H3",{"data-svelte-h":!0}),Ce(u)!=="svelte-1dc52s8"&&(u.textContent=c),g=R(m),_=W(m,"P",{});var S=Q(_);w=G(S,"Total JAT score for "),E=G(S,t[1]),N=R(S),L=W(S,"U",{});var h=Q(L);$=G(h,y),h.forEach(p),v=G(S,`
        : `),f=G(S,T),S.forEach(p),d=R(m);for(let C=0;C<F.length;C+=1)F[C].l(m);I=R(m),Z&&Z.l(m),Y=ie()},m(m,S){A&&A.m(m,S),k(m,e,S),U(l,m,S),k(m,n,S),k(m,o,S),k(m,r,S);for(let h=0;h<J.length;h+=1)J[h]&&J[h].m(m,S);k(m,a,S),x&&x.m(m,S),k(m,s,S),k(m,u,S),k(m,g,S),k(m,_,S),q(_,w),q(_,E),q(_,N),q(_,L),q(L,$),q(_,v),q(_,f),k(m,d,S);for(let h=0;h<F.length;h+=1)F[h]&&F[h].m(m,S);k(m,I,S),Z&&Z.m(m,S),k(m,Y,S),K=!0},p(m,S){A&&A.p&&(!K||S[1]&1)&&mt(A,ne,m,m[31],K?_t(ne,m[31],S,null):ct(m[31]),null);const h={};if(S[0]&112|S[1]&1&&(h.$$scope={dirty:S,ctx:m}),l.$set(h),S[0]&1291){M=ce(m[8].jat[m[0]][m[1]].arms);let C;for(C=0;C<M.length;C+=1){const le=tt(m,M,C);J[C]?(J[C].p(le,S),b(J[C],1)):(J[C]=nt(le),J[C].c(),b(J[C],1),J[C].m(a.parentNode,a))}for(ue(),C=M.length;C<J.length;C+=1)de(C);me()}if(m[8].jat[m[0]][m[9]].arms.length>0?x?(x.p(m,S),S[0]&257&&b(x,1)):(x=lt(m),x.c(),b(x,1),x.m(s.parentNode,s)):x&&(ue(),j(x,1,1,()=>{x=null}),me()),(!K||S[0]&2)&&fe(E,m[1]),(!K||S[0]&257)&&y!==(y=(m[8].jat[m[0]].name||"Untitled junction")+"")&&fe($,y),(!K||S[0]&259)&&T!==(T=_e(m[8].jat[m[0]][m[1]])+"")&&fe(f,T),S[0]&66827){z=ce(m[8].jat[m[0]][m[1]].movements);let C;for(C=0;C<z.length;C+=1){const le=et(m,z,C);F[C]?(F[C].p(le,S),b(F[C],1)):(F[C]=ot(le),F[C].c(),b(F[C],1),F[C].m(I.parentNode,I))}for(ue(),C=z.length;C<F.length;C+=1)re(C);me()}m[8].jat[m[0]][m[9]].movements.length>0?Z?(Z.p(m,S),S[0]&257&&b(Z,1)):(Z=rt(m),Z.c(),b(Z,1),Z.m(Y.parentNode,Y)):Z&&(ue(),j(Z,1,1,()=>{Z=null}),me())},i(m){if(!K){b(A,m),b(l.$$.fragment,m);for(let S=0;S<M.length;S+=1)b(J[S]);b(x);for(let S=0;S<z.length;S+=1)b(F[S]);b(Z),K=!0}},o(m){j(A,m),j(l.$$.fragment,m),J=J.filter(Boolean);for(let S=0;S<J.length;S+=1)j(J[S]);j(x),F=F.filter(Boolean);for(let S=0;S<F.length;S+=1)j(F[S]);j(Z),K=!1},d(m){m&&(p(e),p(n),p(o),p(r),p(a),p(s),p(u),p(g),p(_),p(d),p(I),p(Y)),A&&A.d(m),B(l,m),je(J,m),x&&x.d(m),je(F,m),Z&&Z.d(m)}}}function Sn(t){let e;return{c(){e=H("Save")},l(l){e=G(l,"Save")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function En(t){let e;return{c(){e=H("Delete")},l(l){e=G(l,"Delete")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function yn(t){let e,l,n;function o(r){t[28](r)}let i={label:"Arm Name"};return t[8].jat[t[0]][t[1]].arms[t[2].id.idx].name!==void 0&&(i.value=t[8].jat[t[0]][t[1]].arms[t[2].id.idx].name),e=new Fe({props:i}),oe.push(()=>se(e,"value",o)),{c(){P(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,a){U(e,r,a),n=!0},p(r,a){const s={};!l&&a[0]&263&&(l=!0,s.value=r[8].jat[r[0]][r[1]].arms[r[2].id.idx].name,ae(()=>l=!1)),e.$set(s)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){j(e.$$.fragment,r),n=!1},d(r){B(e,r)}}}function In(t){let e,l,n,o,i,r;return e=new jn({props:{junctionIdx:t[0],stage:t[1],idx:t[2].id.idx}}),n=new Be({props:{$$slots:{default:[Nn]},$$scope:{ctx:t}}}),n.$on("click",t[11]),i=new ze({props:{$$slots:{default:[Tn]},$$scope:{ctx:t}}}),i.$on("click",t[12]),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment),o=O(),P(i.$$.fragment)},l(a){D(e.$$.fragment,a),l=R(a),D(n.$$.fragment,a),o=R(a),D(i.$$.fragment,a)},m(a,s){U(e,a,s),k(a,l,s),U(n,a,s),k(a,o,s),U(i,a,s),r=!0},p(a,s){const u={};s[0]&1&&(u.junctionIdx=a[0]),s[0]&2&&(u.stage=a[1]),s[0]&4&&(u.idx=a[2].id.idx),e.$set(u);const c={};s[1]&1&&(c.$$scope={dirty:s,ctx:a}),n.$set(c);const g={};s[1]&1&&(g.$$scope={dirty:s,ctx:a}),i.$set(g)},i(a){r||(b(e.$$.fragment,a),b(n.$$.fragment,a),b(i.$$.fragment,a),r=!0)},o(a){j(e.$$.fragment,a),j(n.$$.fragment,a),j(i.$$.fragment,a),r=!1},d(a){a&&(p(l),p(o)),B(e,a),B(n,a),B(i,a)}}}function Nn(t){let e;return{c(){e=H("Save")},l(l){e=G(l,"Save")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Tn(t){let e;return{c(){e=H("Delete")},l(l){e=G(l,"Delete")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function An(t){let e;return{c(){e=H("Zoom to fit")},l(l){e=G(l,"Zoom to fit")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Pn(t){let e;return{c(){e=H("Show route")},l(l){e=G(l,"Show route")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Dn(t){var y;let e,l,n,o,i,r,a,s,u,c,g,_;e=new ke({props:{$$slots:{default:[An]},$$scope:{ctx:t}}}),e.$on("click",t[19]),n=new Bt({}),i=new Dt({});function w($){t[20]($)}let E={map:(y=t[6])==null?void 0:y.getMap()};t[4]!==void 0&&(E.enabled=t[4]),a=new Ut({props:E}),oe.push(()=>se(a,"enabled",w));function N($){t[21]($)}let L={$$slots:{default:[Pn]},$$scope:{ctx:t}};return t[5]!==void 0&&(L.checked=t[5]),c=new Ft({props:L}),oe.push(()=>se(c,"checked",N)),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment),o=O(),P(i.$$.fragment),r=O(),P(a.$$.fragment),u=O(),P(c.$$.fragment)},l($){D(e.$$.fragment,$),l=R($),D(n.$$.fragment,$),o=R($),D(i.$$.fragment,$),r=R($),D(a.$$.fragment,$),u=R($),D(c.$$.fragment,$)},m($,v){U(e,$,v),k($,l,v),U(n,$,v),k($,o,v),U(i,$,v),k($,r,v),U(a,$,v),k($,u,v),U(c,$,v),_=!0},p($,v){var I;const T={};v[1]&1&&(T.$$scope={dirty:v,ctx:$}),e.$set(T);const f={};v[0]&64&&(f.map=(I=$[6])==null?void 0:I.getMap()),!s&&v[0]&16&&(s=!0,f.enabled=$[4],ae(()=>s=!1)),a.$set(f);const d={};v[1]&1&&(d.$$scope={dirty:v,ctx:$}),!g&&v[0]&32&&(g=!0,d.checked=$[5],ae(()=>g=!1)),c.$set(d)},i($){_||(b(e.$$.fragment,$),b(n.$$.fragment,$),b(i.$$.fragment,$),b(a.$$.fragment,$),b(c.$$.fragment,$),_=!0)},o($){j(e.$$.fragment,$),j(n.$$.fragment,$),j(i.$$.fragment,$),j(a.$$.fragment,$),j(c.$$.fragment,$),_=!1},d($){$&&(p(l),p(o),p(r),p(u)),B(e,$),B(n,$),B(i,$),B(a,$),B(c,$)}}}function nt(t){let e,l;function n(){return t[22](t[36])}function o(){return t[23](t[36])}return e=new qe({props:{name:`${it(t[36])} - ${t[37].name||"Unnamed arm"}`}}),e.$on("click",n),e.$on("mouseenter",o),e.$on("mouseleave",t[24]),{c(){P(e.$$.fragment)},l(i){D(e.$$.fragment,i)},m(i,r){U(e,i,r),l=!0},p(i,r){t=i;const a={};r[0]&259&&(a.name=`${it(t[36])} - ${t[37].name||"Unnamed arm"}`),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){j(e.$$.fragment,i),l=!1},d(i){B(e,i)}}}function lt(t){let e,l;return e=new ke({props:{$$slots:{default:[Un]},$$scope:{ctx:t}}}),e.$on("click",t[14]),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o[1]&1&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function Un(t){let e,l;return{c(){e=H("Copy arms from "),l=H(t[9])},l(n){e=G(n,"Copy arms from "),l=G(n,t[9])},m(n,o){k(n,e,o),k(n,l,o)},p:Le,d(n){n&&(p(e),p(l))}}}function Bn(t){let e,l,n,o=t[33].score+"",i,r,a,s=He(t[33].kind)+"",u;return{c(){e=X("div"),l=X("span"),n=H("Score: "),i=H(o),r=O(),a=X("span"),u=H(s),this.h()},l(c){e=W(c,"DIV",{style:!0});var g=Q(e);l=W(g,"SPAN",{style:!0});var _=Q(l);n=G(_,"Score: "),i=G(_,o),_.forEach(p),r=R(g),a=W(g,"SPAN",{});var w=Q(a);u=G(w,s),w.forEach(p),g.forEach(p),this.h()},h(){V(l,"padding","4px"),V(l,"color",t[34].font),V(l,"background-color",t[34].background),V(e,"width","100%"),V(e,"display","flex"),V(e,"justify-content","space-between")},m(c,g){k(c,e,g),q(e,l),q(l,n),q(l,i),q(e,r),q(e,a),q(a,u)},p(c,g){g[0]&259&&o!==(o=c[33].score+"")&&fe(i,o),g[0]&259&&V(l,"color",c[34].font),g[0]&259&&V(l,"background-color",c[34].background),g[0]&259&&s!==(s=He(c[33].kind)+"")&&fe(u,s)},d(c){c&&p(e)}}}function ot(t){let e,l;function n(){return t[25](t[36])}function o(){return t[26](t[36])}return e=new qe({props:{name:t[33].name||"Unnamed movement",$$slots:{default:[Bn]},$$scope:{ctx:t}}}),e.$on("click",n),e.$on("mouseenter",o),e.$on("mouseleave",t[27]),{c(){P(e.$$.fragment)},l(i){D(e.$$.fragment,i)},m(i,r){U(e,i,r),l=!0},p(i,r){t=i;const a={};r[0]&259&&(a.name=t[33].name||"Unnamed movement"),r[0]&259|r[1]&1&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){j(e.$$.fragment,i),l=!1},d(i){B(e,i)}}}function rt(t){let e,l;return e=new ke({props:{$$slots:{default:[Fn]},$$scope:{ctx:t}}}),e.$on("click",t[15]),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o[1]&1&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function Fn(t){let e,l;return{c(){e=H("Copy movements from "),l=H(t[9])},l(n){e=G(n,"Copy movements from "),l=G(n,t[9])},m(n,o){k(n,e,o),k(n,l,o)},p:Le,d(n){n&&(p(e),p(l))}}}function zn(t){let e,l,n,o,i,r,a,s=_e(t[8].jat[t[0]].existing)+"",u,c,g,_=_e(t[8].jat[t[0]].proposed)+"",w,E,N,L,y,$,v,T,f,d,I,Y,K;function ne(z){t[18](z)}let A={label:"Commentary / Notes about "+t[1]+" junction"};t[8].jat[t[0]][t[1]].notes!==void 0&&(A.value=t[8].jat[t[0]][t[1]].notes),l=new pt({props:A}),oe.push(()=>se(l,"value",ne));const M=[Mn,Ln],J=[];function de(z,F){return z[2].mode!="editing"?0:1}$=de(t),v=J[$]=M[$](t);let x={junctionIdx:t[0],stage:t[1],mode:t[2],hoveringSidebar:t[3],streetviewOn:t[4],showRoute:t[5],select:t[10],stopEditing:t[11]};return d=new bn({props:x}),t[30](d),{c(){e=X("div"),P(l.$$.fragment),o=O(),i=X("p"),r=H("Total JAT score: "),a=X("b"),u=H(s),c=H(`
    existing,
    `),g=X("b"),w=H(_),E=H(`
    proposed`),N=O(),L=X("div"),y=X("div"),v.c(),T=O(),f=X("div"),P(d.$$.fragment),this.h()},l(z){e=W(z,"DIV",{class:!0});var F=Q(e);D(l.$$.fragment,F),o=R(F),i=W(F,"P",{});var re=Q(i);r=G(re,"Total JAT score: "),a=W(re,"B",{});var Z=Q(a);u=G(Z,s),Z.forEach(p),c=G(re,`
    existing,
    `),g=W(re,"B",{});var m=Q(g);w=G(m,_),m.forEach(p),E=G(re,`
    proposed`),re.forEach(p),F.forEach(p),N=R(z),L=W(z,"DIV",{style:!0});var S=Q(L);y=W(S,"DIV",{style:!0});var h=Q(y);v.l(h),h.forEach(p),T=R(S),f=W(S,"DIV",{style:!0});var C=Q(f);D(d.$$.fragment,C),C.forEach(p),S.forEach(p),this.h()},h(){te(e,"class","govuk-width-container"),V(y,"width","30%"),V(y,"overflow-y","scroll"),V(y,"padding","10px"),V(y,"border","1px solid black"),V(f,"position","relative"),V(f,"width","100%"),V(L,"display","flex"),V(L,"height","80vh")},m(z,F){k(z,e,F),U(l,e,null),q(e,o),q(e,i),q(i,r),q(i,a),q(a,u),q(i,c),q(i,g),q(g,w),q(i,E),k(z,N,F),k(z,L,F),q(L,y),J[$].m(y,null),t[29](y),q(L,T),q(L,f),U(d,f,null),I=!0,Y||(K=wt(Cn,"keydown",t[13]),Y=!0)},p(z,F){const re={};F[0]&2&&(re.label="Commentary / Notes about "+z[1]+" junction"),!n&&F[0]&259&&(n=!0,re.value=z[8].jat[z[0]][z[1]].notes,ae(()=>n=!1)),l.$set(re),(!I||F[0]&257)&&s!==(s=_e(z[8].jat[z[0]].existing)+"")&&fe(u,s),(!I||F[0]&257)&&_!==(_=_e(z[8].jat[z[0]].proposed)+"")&&fe(w,_);let Z=$;$=de(z),$===Z?J[$].p(z,F):(ue(),j(J[Z],1,1,()=>{J[Z]=null}),me(),v=J[$],v?v.p(z,F):(v=J[$]=M[$](z),v.c()),b(v,1),v.m(y,null));const m={};F[0]&1&&(m.junctionIdx=z[0]),F[0]&2&&(m.stage=z[1]),F[0]&4&&(m.mode=z[2]),F[0]&8&&(m.hoveringSidebar=z[3]),F[0]&16&&(m.streetviewOn=z[4]),F[0]&32&&(m.showRoute=z[5]),d.$set(m)},i(z){I||(b(l.$$.fragment,z),b(v),b(d.$$.fragment,z),I=!0)},o(z){j(l.$$.fragment,z),j(v),j(d.$$.fragment,z),I=!1},d(z){z&&(p(e),p(N),p(L)),B(l),J[$].d(),t[29](null),t[30](null),B(d),Y=!1,K()}}}function it(t){return String.fromCharCode(t+65)}function qn(t,e,l){let n;ye(t,ee,m=>l(8,n=m));let{$$slots:o={},$$scope:i}=e,{junctionIdx:r}=e,{stage:a}=e,s=a=="existing"?"proposed":"existing",u={mode:"select"},c=null,g=null,_=!1,w=!0,E=null,N;async function L(m){c=N.scrollTop,l(2,u={mode:"editing",id:m}),l(3,g=null),await Re(),l(7,N.scrollTop=0,N)}async function y(){l(2,u={mode:"select"}),c!=null&&(await Re(),l(7,N.scrollTop=c,N),c=null)}function $(){u.mode=="editing"&&window.confirm(`Delete this ${u.id.kind}?`)&&(u.id.kind=="movement"?(n.jat[r][a].movements.splice(u.id.idx,1),ee.set(n)):(n.jat[r][a].arms.splice(u.id.idx,1),ee.set(n)),y())}function v(m){if(u.mode!="editing")return;let S=m.target.tagName,h=S=="INPUT"||S=="TEXTAREA";m.key=="Escape"||m.key=="Enter"&&!h?(m.stopPropagation(),y()):m.key=="Delete"&&!h&&(m.stopPropagation(),$())}function T(){n.jat[r][a].arms.length>0&&!window.confirm("Overwrite arms?")||(we(ee,n.jat[r][a].arms=JSON.parse(JSON.stringify(n.jat[r][s].arms)),n),ee.set(n))}function f(){n.jat[r][a].movements.length>0&&!window.confirm("Overwrite movements?")||(we(ee,n.jat[r][a].movements=JSON.parse(JSON.stringify(n.jat[r][s].movements)),n),ee.set(n))}let d={0:ge.red,1:ge.amber,2:ge.green,X:ge.critical};function I(m){t.$$.not_equal(n.jat[r][a].notes,m)&&(n.jat[r][a].notes=m,ee.set(n))}const Y=()=>E==null?void 0:E.zoom(!0);function K(m){_=m,l(4,_)}function ne(m){w=m,l(5,w)}const A=m=>L({kind:"arm",idx:m}),M=m=>l(3,g={kind:"arm",idx:m}),J=()=>l(3,g=null),de=m=>L({kind:"movement",idx:m}),x=m=>l(3,g={kind:"movement",idx:m}),z=()=>l(3,g=null);function F(m){t.$$.not_equal(n.jat[r][a].arms[u.id.idx].name,m)&&(n.jat[r][a].arms[u.id.idx].name=m,ee.set(n))}function re(m){oe[m?"unshift":"push"](()=>{N=m,l(7,N)})}function Z(m){oe[m?"unshift":"push"](()=>{E=m,l(6,E)})}return t.$$set=m=>{"junctionIdx"in m&&l(0,r=m.junctionIdx),"stage"in m&&l(1,a=m.stage),"$$scope"in m&&l(31,i=m.$$scope)},[r,a,u,g,_,w,E,N,n,s,L,y,$,v,T,f,d,o,I,Y,K,ne,A,M,J,de,x,z,F,re,Z,i]}class On extends Me{constructor(e){super(),Se(this,e,qn,zn,be,{junctionIdx:0,stage:1},null,[-1,-1])}}function at(t,e,l){const n=t.slice();return n[10]=e[l],n[12]=l,n}function Rn(t){let e,l,n=(t[1].jat[t[0].idx].name||"Untitled junction")+"",o,i,r=t[0].stage+"",a,s,u,c,g,_,w,E=t[0].stage,N,L;u=new jt({props:{$$slots:{default:[Vn]},$$scope:{ctx:t}}});function y(T){t[7](T)}let $={label:"Junction Name"};t[1].jat[t[0].idx].name!==void 0&&($.value=t[1].jat[t[0].idx].name),g=new Fe({props:$}),oe.push(()=>se(g,"value",y));let v=st(t);return{c(){e=X("div"),l=X("h2"),o=H(n),i=H(" - "),a=H(r),s=O(),P(u.$$.fragment),c=O(),P(g.$$.fragment),w=O(),v.c(),N=ie(),this.h()},l(T){e=W(T,"DIV",{class:!0});var f=Q(e);l=W(f,"H2",{});var d=Q(l);o=G(d,n),i=G(d," - "),a=G(d,r),d.forEach(p),s=R(f),D(u.$$.fragment,f),c=R(f),D(g.$$.fragment,f),f.forEach(p),w=R(T),v.l(T),N=ie(),this.h()},h(){te(e,"class","govuk-width-container")},m(T,f){k(T,e,f),q(e,l),q(l,o),q(l,i),q(l,a),q(e,s),U(u,e,null),q(e,c),U(g,e,null),k(T,w,f),v.m(T,f),k(T,N,f),L=!0},p(T,f){(!L||f&3)&&n!==(n=(T[1].jat[T[0].idx].name||"Untitled junction")+"")&&fe(o,n),(!L||f&1)&&r!==(r=T[0].stage+"")&&fe(a,r);const d={};f&8193&&(d.$$scope={dirty:f,ctx:T}),u.$set(d);const I={};!_&&f&3&&(_=!0,I.value=T[1].jat[T[0].idx].name,ae(()=>_=!1)),g.$set(I),f&1&&be(E,E=T[0].stage)?(ue(),j(v,1,1,Le),me(),v=st(T),v.c(),b(v,1),v.m(N.parentNode,N)):v.p(T,f)},i(T){L||(b(u.$$.fragment,T),b(g.$$.fragment,T),b(v),L=!0)},o(T){j(u.$$.fragment,T),j(g.$$.fragment,T),j(v),L=!1},d(T){T&&(p(e),p(w),p(N)),B(u),B(g),v.d(T)}}}function Hn(t){let e,l,n,o;l=new Be({props:{$$slots:{default:[Yn]},$$scope:{ctx:t}}}),l.$on("click",t[2]);let i=ce(t[1].jat),r=[];for(let s=0;s<i.length;s+=1)r[s]=ft(at(t,i,s));const a=s=>j(r[s],1,1,()=>{r[s]=null});return{c(){e=X("div"),P(l.$$.fragment),n=O();for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=W(s,"DIV",{class:!0});var u=Q(e);D(l.$$.fragment,u),n=R(u);for(let c=0;c<r.length;c+=1)r[c].l(u);u.forEach(p),this.h()},h(){te(e,"class","govuk-width-container")},m(s,u){k(s,e,u),U(l,e,null),q(e,n);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);o=!0},p(s,u){const c={};if(u&8192&&(c.$$scope={dirty:u,ctx:s}),l.$set(c),u&3){i=ce(s[1].jat);let g;for(g=0;g<i.length;g+=1){const _=at(s,i,g);r[g]?(r[g].p(_,u),b(r[g],1)):(r[g]=ft(_),r[g].c(),b(r[g],1),r[g].m(e,null))}for(ue(),g=i.length;g<r.length;g+=1)a(g);me()}},i(s){if(!o){b(l.$$.fragment,s);for(let u=0;u<i.length;u+=1)b(r[u]);o=!0}},o(s){j(l.$$.fragment,s),r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)j(r[u]);o=!1},d(s){s&&p(e),B(l),je(r,s)}}}function Gn(t){let e;return{c(){e=H("Back to all junctions")},l(l){e=G(l,"Back to all junctions")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Jn(t){let e;return{c(){e=H("Delete junction")},l(l){e=G(l,"Delete junction")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Vn(t){let e,l,n,o;return e=new ke({props:{$$slots:{default:[Gn]},$$scope:{ctx:t}}}),e.$on("click",t[5]),n=new ze({props:{$$slots:{default:[Jn]},$$scope:{ctx:t}}}),n.$on("click",t[6]),{c(){P(e.$$.fragment),l=O(),P(n.$$.fragment)},l(i){D(e.$$.fragment,i),l=R(i),D(n.$$.fragment,i)},m(i,r){U(e,i,r),k(i,l,r),U(n,i,r),o=!0},p(i,r){const a={};r&8192&&(a.$$scope={dirty:r,ctx:i}),e.$set(a);const s={};r&8192&&(s.$$scope={dirty:r,ctx:i}),n.$set(s)},i(i){o||(b(e.$$.fragment,i),b(n.$$.fragment,i),o=!0)},o(i){j(e.$$.fragment,i),j(n.$$.fragment,i),o=!1},d(i){i&&p(l),B(e,i),B(n,i)}}}function Xn(t){let e,l;return e=new ke({props:{$$slots:{default:[Zn]},$$scope:{ctx:t}}}),e.$on("click",t[9]),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o&8192&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function Wn(t){let e,l;return e=new ke({props:{$$slots:{default:[Kn]},$$scope:{ctx:t}}}),e.$on("click",t[8]),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o&8192&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function Zn(t){let e;return{c(){e=H("Edit Proposed")},l(l){e=G(l,"Edit Proposed")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Kn(t){let e;return{c(){e=H("Edit Existing")},l(l){e=G(l,"Edit Existing")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function Qn(t){let e,l,n=t[0].stage+"",o,i,r,a=t[1].jat[t[0].idx].name+"",s,u,c,g,_,w;const E=[Wn,Xn],N=[];function L(y,$){return y[0].stage=="proposed"?0:1}return c=L(t),g=N[c]=E[c](t),{c(){e=X("p"),l=H("Currently editing "),o=H(n),i=H(` junction
        `),r=X("u"),s=H(a),u=O(),g.c(),_=ie()},l(y){e=W(y,"P",{});var $=Q(e);l=G($,"Currently editing "),o=G($,n),i=G($,` junction
        `),r=W($,"U",{});var v=Q(r);s=G(v,a),v.forEach(p),$.forEach(p),u=R(y),g.l(y),_=ie()},m(y,$){k(y,e,$),q(e,l),q(e,o),q(e,i),q(e,r),q(r,s),k(y,u,$),N[c].m(y,$),k(y,_,$),w=!0},p(y,$){(!w||$&1)&&n!==(n=y[0].stage+"")&&fe(o,n),(!w||$&3)&&a!==(a=y[1].jat[y[0].idx].name+"")&&fe(s,a);let v=c;c=L(y),c===v?N[c].p(y,$):(ue(),j(N[v],1,1,()=>{N[v]=null}),me(),g=N[c],g?g.p(y,$):(g=N[c]=E[c](y),g.c()),b(g,1),g.m(_.parentNode,_))},i(y){w||(b(g),w=!0)},o(y){j(g),w=!1},d(y){y&&(p(e),p(u),p(_)),N[c].d(y)}}}function st(t){let e,l;return e=new On({props:{junctionIdx:t[0].idx,stage:t[0].stage,$$slots:{default:[Qn]},$$scope:{ctx:t}}}),{c(){P(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){U(e,n,o),l=!0},p(n,o){const i={};o&1&&(i.junctionIdx=n[0].idx),o&1&&(i.stage=n[0].stage),o&8195&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){j(e.$$.fragment,n),l=!1},d(n){B(e,n)}}}function Yn(t){let e;return{c(){e=H("Add new junction")},l(l){e=G(l,"Add new junction")},m(l,n){k(l,e,n)},d(l){l&&p(e)}}}function xn(t){let e,l,n,o=_e(t[10].existing)+"",i,r,a,s,u=_e(t[10].proposed)+"",c,g;return{c(){e=X("div"),l=X("span"),n=H("Existing: "),i=H(o),r=O(),a=X("span"),s=H("Proposed: "),c=H(u),g=O(),this.h()},l(_){e=W(_,"DIV",{style:!0});var w=Q(e);l=W(w,"SPAN",{});var E=Q(l);n=G(E,"Existing: "),i=G(E,o),E.forEach(p),r=R(w),a=W(w,"SPAN",{});var N=Q(a);s=G(N,"Proposed: "),c=G(N,u),N.forEach(p),w.forEach(p),g=R(_),this.h()},h(){V(e,"width","100%"),V(e,"display","flex"),V(e,"justify-content","space-between")},m(_,w){k(_,e,w),q(e,l),q(l,n),q(l,i),q(e,r),q(e,a),q(a,s),q(a,c),k(_,g,w)},p(_,w){w&2&&o!==(o=_e(_[10].existing)+"")&&fe(i,o),w&2&&u!==(u=_e(_[10].proposed)+"")&&fe(c,u)},d(_){_&&(p(e),p(g))}}}function ft(t){let e,l;function n(){return t[4](t[12])}return e=new qe({props:{name:t[10].name||"Untitled junction",$$slots:{default:[xn]},$$scope:{ctx:t}}}),e.$on("click",n),{c(){P(e.$$.fragment)},l(o){D(e.$$.fragment,o)},m(o,i){U(e,o,i),l=!0},p(o,i){t=o;const r={};i&2&&(r.name=t[10].name||"Untitled junction"),i&8194&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){j(e.$$.fragment,o),l=!1},d(o){B(e,o)}}}function el(t){let e,l,n,o;const i=[Hn,Rn],r=[];function a(s,u){return s[0].kind=="list"?0:s[0].kind=="edit"?1:-1}return~(e=a(t))&&(l=r[e]=i[e](t)),{c(){l&&l.c(),n=ie()},l(s){l&&l.l(s),n=ie()},m(s,u){~e&&r[e].m(s,u),k(s,n,u),o=!0},p(s,[u]){let c=e;e=a(s),e===c?~e&&r[e].p(s,u):(l&&(ue(),j(r[c],1,1,()=>{r[c]=null}),me()),~e?(l=r[e],l?l.p(s,u):(l=r[e]=i[e](s),l.c()),b(l,1),l.m(n.parentNode,n)):l=null)},i(s){o||(b(l),o=!0)},o(s){j(l),o=!1},d(s){s&&p(n),~e&&r[e].d(s)}}}function Ae(t){if(t.kind=="list")throw new Error("Unreachable case");return t.idx}function tl(t,e,l){let n;ye(t,ee,w=>l(1,n=w));let o={kind:"list"};function i(){we(ee,n.jat=[...n.jat,{name:"",existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}],n),l(0,o={kind:"edit",idx:n.jat.length-1,stage:"existing"})}function r(w){window.confirm("Delete this junction?")&&(n.jat.splice(w,1),ee.set(n),l(0,o={kind:"list"}))}const a=w=>l(0,o={kind:"edit",idx:w,stage:"existing"}),s=()=>l(0,o={kind:"list"}),u=()=>r(Ae(o));function c(w){t.$$.not_equal(n.jat[o.idx].name,w)&&(n.jat[o.idx].name=w,ee.set(n))}return[o,n,i,r,a,s,u,c,()=>l(0,o={kind:"edit",idx:Ae(o),stage:"existing"}),()=>l(0,o={kind:"edit",idx:Ae(o),stage:"proposed"})]}class Sl extends Me{constructor(e){super(),Se(this,e,tl,el,be,{})}}export{Sl as component};
