import{s as S,e as m,a as y,t as v,c as h,p as L,g as P,b as $,d as k,f as p,i as f,h as R,j as A,n as d,k as x}from"../chunks/scheduler.Bsni_e59.js";import{S as O,i as I}from"../chunks/index.CCfAUppz.js";import{s as T}from"../chunks/data.DbSXO9_u.js";import{g as D}from"../chunks/results.SzPBSsp-.js";function C(t){let e=D(t),o=t.summary.checkType=="street",l=t.summary.checkType=="path",i={Safety:"Sa",Accessibility:"Ac",Comfort:"Cf",Directness:"Di",Attractiveness:"At",Cohesion:"Co",overall:"To"},n={"Social activity":"SA","Personal security":"PS","Character and legibility":"CL",Environment:"En",overall:"To"};return[..._(t),...j(t),...g("SA",0,t.safetyCheck),...g("ST",16,t.streetCheck),...g("SP",0,t.streetPlacemakingCheck),...g("PA",16,t.pathCheck),...g("PP",16,t.pathPlacemakingCheck),...E(t),...b(t),...a("ST-LOS",[...e.levelOfService,e.overall],o,i),...a("ST-LOS",e.byMode,o,{walking:"Wa",wheeling:"Wh",cycling:"Cy"}),...a("SP-LOS",[...e.placemakingCategories,e.placemakingOverall],o,n),...a("PA-LOS",[...e.levelOfService,e.overall],l,i),...a("PA-LOS",e.byMode,l,{walking:"Wa",wheeling:"Wh",cycling:"Cy",horse:"HR"}),...a("PP-LOS",[...e.placemakingCategories,e.placemakingOverall],l,n),...w(t,e),...N(t),...M(t)]}function _(t){let e=t.summary;return[["Scheme Ref",e.schemeReference],["Date of Design Review",e.dateDesignReview],["Scheme Name",e.schemeName],["Authority",e.authority],["Transport/ Combined Authority",e.transportOrCombinedAuthority],["Region",e.region],["Funding Programme",e.fundingProgramme],["Design Stage",e.designStage],["Funding Conditions",e.fundingConditions],["Inspector",e.inspectorEmail],["RouteLength",e.totalRouteLengthKm],["RouteFileLength",e.assessedRouteLengthKm],["Notes",e.notes],["Tool","Route Check online-alpha"],["Sub-tool",e.checkType=="street"?"Street Check":"Path Check"]]}function j(t){let e=[];for(let[o,l]of t.policyCheck.entries())e.push([`PC${u(o)}-E`,l.existing]),e.push([`PC${u(o)}-D`,l.proposed]);return e}function g(t,e,o){let l=[];for(let i=0;i<o.existingScores.length;i++)l.push([`${t}${u(i+e)}-E`,o.existingScores[i]]),l.push([`${t}${u(i+e)}-D`,o.proposedScores[i]]);return l}function u(t){return(t+1).toString().padStart(2,"0")}function E(t){let e={existing:t.policyConflictLog.filter(o=>o.stage=="Existing").length,designed:t.policyConflictLog.filter(o=>o.stage=="Design").length,removed:t.policyConflictLog.filter(o=>o.resolved=="Yes").length};return[["PC-E",e.existing],["PC-D",e.designed],["PC-Rem",e.removed],["PC-Int",e.designed],["PC-Tot",e.designed+e.existing-e.removed]]}function b(t){let e={existing:t.criticalIssues.filter(o=>o.stage=="Existing").length,designed:t.criticalIssues.filter(o=>o.stage=="Design").length,removed:t.criticalIssues.filter(o=>o.resolved=="Yes").length};return[["SA-E",e.existing],["SA-D",e.designed],["SA-Rem",e.removed],["SA-Int",e.designed],["SA-Tot",e.designed+e.existing-e.removed]]}function a(t,e,o,l){let i=[];for(let n of e){let s=l[n.category];i.push([`${t}-${s}-E`,o?"":`${Math.round(n.existing.scorePercent)}%`]),i.push([`${t}-${s}-D`,o?"":`${Math.round(n.proposed.scorePercent)}%`])}return i}function w(t,e){let o=[],l=12;for(let i=1;i<=l;i++)for(let[n,s]of[["walkingWheeling","WW"],["cycling","Cy"],["total","To"]])o.push([`J${i}-LOS-${s}-E`,i<=e.jat.length?e.jat[i-1][n].existing:""]),o.push([`J${i}-LOS-${s}-D`,i<=e.jat.length?e.jat[i-1][n].proposed:""]);for(let i=1;i<=l;i++)i<=e.jat.length?o.push([`J${i}-Arms`,t.jat[i-1].proposed.movements.filter(n=>n.kind=="pedestrian").length]):o.push([`J${i}-Arms`,0]);return o}function J(t,e){let o=t.policyConflictLog[e],l=0;for(let n=0;n<=e;n++)t.policyConflictLog[n].conflict==o.conflict&&l++;return[t.summary.schemeReference,`P${o.conflict.padStart(3,"0")}`,`${l.toString().padStart(2,"0")}P`].join("_")}function N(t){let e=[],o=35;for(let l=0;l<o;l++){let i;if(l<t.policyConflictLog.length){let n=t.policyConflictLog[l];i={Ref:J(t,l),Typ:n.conflict,Sta:n.stage,LaL:`${n.point[1]}, ${n.point[0]}`,Loc:n.locationName,Res:n.resolved,Com:n.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[n,s]of Object.entries(i))e.push([`${u(l)}PC${n}`,s])}return e}function W(t,e){let o=t.criticalIssues[e],l=0;for(let n=0;n<=e;n++)t.criticalIssues[n].criticalIssue==o.criticalIssue&&l++;return[t.summary.schemeReference,`SA${o.criticalIssue.padStart(2,"0")}`,`${l.toString().padStart(2,"0")}P`].join("_")}function M(t){let e=[],o=35;for(let l=0;l<o;l++){let i;if(l<t.criticalIssues.length){let n=t.criticalIssues[l];i={Ref:W(t,l),Typ:n.criticalIssue,Sta:n.stage,LaL:`${n.point[1]}, ${n.point[0]}`,Loc:n.locationName,Res:n.resolved,Com:n.notes}}else i={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[n,s]of Object.entries(i))e.push([`${u(l)}SA${n}`,s])}return e}function F(t){let e,o="TODO. Below is the start to the DALOG output.",l,i,n=JSON.stringify(C(t[0]),null,"  ")+"",s;return{c(){e=m("p"),e.textContent=o,l=y(),i=m("pre"),s=v(n)},l(r){e=h(r,"P",{"data-svelte-h":!0}),L(e)!=="svelte-10g90aq"&&(e.textContent=o),l=P(r),i=h(r,"PRE",{});var c=$(i);s=k(c,n),c.forEach(p)},m(r,c){f(r,e,c),f(r,l,c),f(r,i,c),R(i,s)},p(r,[c]){c&1&&n!==(n=JSON.stringify(C(r[0]),null,"  ")+"")&&A(s,n)},i:d,o:d,d(r){r&&(p(e),p(l),p(i))}}}function q(t,e,o){let l;return x(t,T,i=>o(0,l=i)),[l]}class H extends O{constructor(e){super(),I(this,e,q,F,S,{})}}export{H as component};
