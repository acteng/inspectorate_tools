import{s as Ie,r as W,e as F,t as H,a as A,c as O,b as j,d as J,f as $,g as M,q as B,v as U,i as h,h as D,w as Y,k as he,y as at,T as ft,G as we,V as me,D as ee,p as de,K as ve,j as re,I as ct,O as pe,P as _e,n as ut}from"../chunks/scheduler.4ZNDCSWA.js";import{S as Le,i as Ne,e as X,c as R,a as V,m as T,t as b,g as ne,b as C,f as ie,d as G}from"../chunks/index.xRKM1n3P.js";import{g as pt}from"../chunks/globals.D0QH3NT1.js";import{e as oe}from"../chunks/each.DpHudclE.js";import{p as Se,c as He}from"../chunks/colors.DaC397qr.js";import{p as Je}from"../chunks/index.D5QGEC0w.js";import{R as Ke}from"../chunks/Radio.DRsEZ7t-.js";import"../chunks/index.Ba3nR5S2.js";import{S as We}from"../chunks/Select.DH_Wl3M5.js";import{T as Ze}from"../chunks/TextArea.vUkAgpTL.js";import{T as Ye}from"../chunks/TextInput.Dtdw2tyg.js";import{s as K}from"../chunks/data.BqitZwvK.js";import{l as be,n as ke,M as _t,b as mt,G as gt,C as $t}from"../chunks/index.DBhkPdyH.js";import{c as dt,p as ht,b as De,e as Be,f as vt,g as bt}from"../chunks/lists.Bn2sGx3F.js";import{Y as Xe}from"../chunks/YesNo.Bnk7R1sE.js";import{B as kt,C as wt,M as Qe}from"../chunks/Marker.Ko070Dzz.js";import{D as yt,C as Ct}from"../chunks/DefaultButton.CEkMkJr5.js";import{S as xe}from"../chunks/SecondaryButton.yCPBUDia.js";import{W as It}from"../chunks/WarningButton.DAgnty13.js";import{G as Lt,S as Nt,C as et,M as St}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.C2u1KL08.js";import{G as Et,I as ye,p as Dt}from"../chunks/pan.JFF2mBTV.js";import"../chunks/index.BjKPyrLc.js";import"../chunks/paths.D53XioAY.js";import{p as Bt}from"../chunks/stores.B0n0iHpr.js";import"../chunks/entry.CbZ68YzH.js";import{R as Pt}from"../chunks/RouteMapLayer.COvY3b8K.js";function Pe(n){let e,l,t;function i(r){n[5](r)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].criticalIssues[n[0]].resolved!==void 0&&(s.value=n[1].criticalIssues[n[0]].resolved),e=new Xe({props:s}),W.push(()=>X(e,"value",i)),{c(){R(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,f){T(e,r,f),t=!0},p(r,f){const o={};!l&&f&3&&(l=!0,o.value=r[1].criticalIssues[r[0]].resolved,Y(()=>l=!1)),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){G(e,r)}}}function qt(n){let e,l,t,i,s,r,f,o,u,_,L,v,w,g,P,N,c,I,a,m,S,k;function Z(p){n[2](p)}let q={label:"Critical Issue",emptyOption:!0,choices:dt};n[1].criticalIssues[n[0]].criticalIssue!==void 0&&(q.value=n[1].criticalIssues[n[0]].criticalIssue),_=new We({props:q}),W.push(()=>X(_,"value",Z));function te(p){n[3](p)}let se={label:"Stage",choices:Je(["Existing","Design"]),inlineSmall:!0};n[1].criticalIssues[n[0]].stage!==void 0&&(se.value=n[1].criticalIssues[n[0]].stage),w=new Ke({props:se}),W.push(()=>X(w,"value",te));function ge(p){n[4](p)}let ae={label:"Location Name"};n[1].criticalIssues[n[0]].locationName!==void 0&&(ae.value=n[1].criticalIssues[n[0]].locationName),N=new Ye({props:ae}),W.push(()=>X(N,"value",ge));let E=n[1].criticalIssues[n[0]].stage!="Design"&&Pe(n);function $e(p){n[6](p)}let fe={label:"Commentary & Feedback"};return n[1].criticalIssues[n[0]].notes!==void 0&&(fe.value=n[1].criticalIssues[n[0]].notes),m=new Ze({props:fe}),W.push(()=>X(m,"value",$e)),{c(){e=F("div"),l=F("a"),t=H("Google StreetView"),s=A(),r=F("a"),f=H("Bing Streetside"),u=A(),R(_.$$.fragment),v=A(),R(w.$$.fragment),P=A(),R(N.$$.fragment),I=A(),E&&E.c(),a=A(),R(m.$$.fragment),this.h()},l(p){e=O(p,"DIV",{style:!0});var y=j(e);l=O(y,"A",{href:!0,target:!0});var Q=j(l);t=J(Q,"Google StreetView"),Q.forEach($),s=M(y),r=O(y,"A",{href:!0,target:!0});var x=j(r);f=J(x,"Bing Streetside"),x.forEach($),y.forEach($),u=M(p),V(_.$$.fragment,p),v=M(p),V(w.$$.fragment,p),P=M(p),V(N.$$.fragment,p),I=M(p),E&&E.l(p),a=M(p),V(m.$$.fragment,p),this.h()},h(){B(l,"href",i=be(n[1].criticalIssues[n[0]].point)),B(l,"target","_blank"),B(r,"href",o=ke(n[1].criticalIssues[n[0]].point)),B(r,"target","_blank"),U(e,"display","flex"),U(e,"justify-content","space-evenly")},m(p,y){h(p,e,y),D(e,l),D(l,t),D(e,s),D(e,r),D(r,f),h(p,u,y),T(_,p,y),h(p,v,y),T(w,p,y),h(p,P,y),T(N,p,y),h(p,I,y),E&&E.m(p,y),h(p,a,y),T(m,p,y),k=!0},p(p,[y]){(!k||y&3&&i!==(i=be(p[1].criticalIssues[p[0]].point)))&&B(l,"href",i),(!k||y&3&&o!==(o=ke(p[1].criticalIssues[p[0]].point)))&&B(r,"href",o);const Q={};!L&&y&3&&(L=!0,Q.value=p[1].criticalIssues[p[0]].criticalIssue,Y(()=>L=!1)),_.$set(Q);const x={};!g&&y&3&&(g=!0,x.value=p[1].criticalIssues[p[0]].stage,Y(()=>g=!1)),w.$set(x);const ce={};!c&&y&3&&(c=!0,ce.value=p[1].criticalIssues[p[0]].locationName,Y(()=>c=!1)),N.$set(ce),p[1].criticalIssues[p[0]].stage!="Design"?E?(E.p(p,y),y&3&&b(E,1)):(E=Pe(p),E.c(),b(E,1),E.m(a.parentNode,a)):E&&(ne(),C(E,1,1,()=>{E=null}),ie());const ue={};!S&&y&3&&(S=!0,ue.value=p[1].criticalIssues[p[0]].notes,Y(()=>S=!1)),m.$set(ue)},i(p){k||(b(_.$$.fragment,p),b(w.$$.fragment,p),b(N.$$.fragment,p),b(E),b(m.$$.fragment,p),k=!0)},o(p){C(_.$$.fragment,p),C(w.$$.fragment,p),C(N.$$.fragment,p),C(E),C(m.$$.fragment,p),k=!1},d(p){p&&($(e),$(u),$(v),$(P),$(I),$(a)),G(_,p),G(w,p),G(N,p),E&&E.d(p),G(m,p)}}}function At(n,e,l){let t;he(n,K,_=>l(1,t=_));let{idx:i}=e;function s(_){n.$$.not_equal(t.criticalIssues[i].criticalIssue,_)&&(t.criticalIssues[i].criticalIssue=_,K.set(t))}function r(_){n.$$.not_equal(t.criticalIssues[i].stage,_)&&(t.criticalIssues[i].stage=_,K.set(t))}function f(_){n.$$.not_equal(t.criticalIssues[i].locationName,_)&&(t.criticalIssues[i].locationName=_,K.set(t))}function o(_){n.$$.not_equal(t.criticalIssues[i].resolved,_)&&(t.criticalIssues[i].resolved=_,K.set(t))}function u(_){n.$$.not_equal(t.criticalIssues[i].notes,_)&&(t.criticalIssues[i].notes=_,K.set(t))}return n.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,t,s,r,f,o,u]}class Mt extends Le{constructor(e){super(),Ne(this,e,At,qt,Ie,{idx:0})}}function qe(n){let e,l,t;function i(r){n[5](r)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].policyConflictLog[n[0]].resolved!==void 0&&(s.value=n[1].policyConflictLog[n[0]].resolved),e=new Xe({props:s}),W.push(()=>X(e,"value",i)),{c(){R(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,f){T(e,r,f),t=!0},p(r,f){const o={};!l&&f&3&&(l=!0,o.value=r[1].policyConflictLog[r[0]].resolved,Y(()=>l=!1)),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){G(e,r)}}}function Rt(n){let e,l,t,i,s,r,f,o,u,_,L,v,w,g,P,N,c,I,a,m,S,k;function Z(p){n[2](p)}let q={label:"Policy Conflict",emptyOption:!0,choices:ht};n[1].policyConflictLog[n[0]].conflict!==void 0&&(q.value=n[1].policyConflictLog[n[0]].conflict),_=new We({props:q}),W.push(()=>X(_,"value",Z));function te(p){n[3](p)}let se={label:"Stage",choices:Je(["Existing","Design"]),inlineSmall:!0};n[1].policyConflictLog[n[0]].stage!==void 0&&(se.value=n[1].policyConflictLog[n[0]].stage),w=new Ke({props:se}),W.push(()=>X(w,"value",te));function ge(p){n[4](p)}let ae={label:"Location Name"};n[1].policyConflictLog[n[0]].locationName!==void 0&&(ae.value=n[1].policyConflictLog[n[0]].locationName),N=new Ye({props:ae}),W.push(()=>X(N,"value",ge));let E=n[1].policyConflictLog[n[0]].stage!="Design"&&qe(n);function $e(p){n[6](p)}let fe={label:"Commentary & Feedback"};return n[1].policyConflictLog[n[0]].notes!==void 0&&(fe.value=n[1].policyConflictLog[n[0]].notes),m=new Ze({props:fe}),W.push(()=>X(m,"value",$e)),{c(){e=F("div"),l=F("a"),t=H("Google StreetView"),s=A(),r=F("a"),f=H("Bing Streetside"),u=A(),R(_.$$.fragment),v=A(),R(w.$$.fragment),P=A(),R(N.$$.fragment),I=A(),E&&E.c(),a=A(),R(m.$$.fragment),this.h()},l(p){e=O(p,"DIV",{style:!0});var y=j(e);l=O(y,"A",{href:!0,target:!0});var Q=j(l);t=J(Q,"Google StreetView"),Q.forEach($),s=M(y),r=O(y,"A",{href:!0,target:!0});var x=j(r);f=J(x,"Bing Streetside"),x.forEach($),y.forEach($),u=M(p),V(_.$$.fragment,p),v=M(p),V(w.$$.fragment,p),P=M(p),V(N.$$.fragment,p),I=M(p),E&&E.l(p),a=M(p),V(m.$$.fragment,p),this.h()},h(){B(l,"href",i=be(n[1].policyConflictLog[n[0]].point)),B(l,"target","_blank"),B(r,"href",o=ke(n[1].policyConflictLog[n[0]].point)),B(r,"target","_blank"),U(e,"display","flex"),U(e,"justify-content","space-evenly")},m(p,y){h(p,e,y),D(e,l),D(l,t),D(e,s),D(e,r),D(r,f),h(p,u,y),T(_,p,y),h(p,v,y),T(w,p,y),h(p,P,y),T(N,p,y),h(p,I,y),E&&E.m(p,y),h(p,a,y),T(m,p,y),k=!0},p(p,[y]){(!k||y&3&&i!==(i=be(p[1].policyConflictLog[p[0]].point)))&&B(l,"href",i),(!k||y&3&&o!==(o=ke(p[1].policyConflictLog[p[0]].point)))&&B(r,"href",o);const Q={};!L&&y&3&&(L=!0,Q.value=p[1].policyConflictLog[p[0]].conflict,Y(()=>L=!1)),_.$set(Q);const x={};!g&&y&3&&(g=!0,x.value=p[1].policyConflictLog[p[0]].stage,Y(()=>g=!1)),w.$set(x);const ce={};!c&&y&3&&(c=!0,ce.value=p[1].policyConflictLog[p[0]].locationName,Y(()=>c=!1)),N.$set(ce),p[1].policyConflictLog[p[0]].stage!="Design"?E?(E.p(p,y),y&3&&b(E,1)):(E=qe(p),E.c(),b(E,1),E.m(a.parentNode,a)):E&&(ne(),C(E,1,1,()=>{E=null}),ie());const ue={};!S&&y&3&&(S=!0,ue.value=p[1].policyConflictLog[p[0]].notes,Y(()=>S=!1)),m.$set(ue)},i(p){k||(b(_.$$.fragment,p),b(w.$$.fragment,p),b(N.$$.fragment,p),b(E),b(m.$$.fragment,p),k=!0)},o(p){C(_.$$.fragment,p),C(w.$$.fragment,p),C(N.$$.fragment,p),C(E),C(m.$$.fragment,p),k=!1},d(p){p&&($(e),$(u),$(v),$(P),$(I),$(a)),G(_,p),G(w,p),G(N,p),E&&E.d(p),G(m,p)}}}function Vt(n,e,l){let t;he(n,K,_=>l(1,t=_));let{idx:i}=e;function s(_){n.$$.not_equal(t.policyConflictLog[i].conflict,_)&&(t.policyConflictLog[i].conflict=_,K.set(t))}function r(_){n.$$.not_equal(t.policyConflictLog[i].stage,_)&&(t.policyConflictLog[i].stage=_,K.set(t))}function f(_){n.$$.not_equal(t.policyConflictLog[i].locationName,_)&&(t.policyConflictLog[i].locationName=_,K.set(t))}function o(_){n.$$.not_equal(t.policyConflictLog[i].resolved,_)&&(t.policyConflictLog[i].resolved=_,K.set(t))}function u(_){n.$$.not_equal(t.policyConflictLog[i].notes,_)&&(t.policyConflictLog[i].notes=_,K.set(t))}return n.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,t,s,r,f,o,u]}class Tt extends Le{constructor(e){super(),Ne(this,e,Vt,Rt,Ie,{idx:0})}}const{window:Gt}=pt;function Ae(n,e,l){const t=n.slice();return t[40]=e[l],t[41]=e,t[42]=l,t}function Me(n,e,l){const t=n.slice();return t[43]=e[l],t[44]=e,t[42]=l,t}function Re(n,e,l){const t=n.slice();return t[40]=e[l],t[42]=l,t}function Ve(n,e,l){const t=n.slice();return t[43]=e[l],t[42]=l,t}function jt(n){let e,l,t,i,s,r,f,o,u,_;e=new yt({props:{$$slots:{default:[Ot]},$$scope:{ctx:n}}}),e.$on("click",n[11]),t=new It({props:{$$slots:{default:[Ut]},$$scope:{ctx:n}}}),t.$on("click",n[13]),s=new xe({props:{$$slots:{default:[zt]},$$scope:{ctx:n}}}),s.$on("click",n[10]);const L=[Jt,Ht],v=[];function w(g,P){return g[1].id.kind=="critical"?0:1}return f=w(n),o=v[f]=L[f](n),{c(){R(e.$$.fragment),l=A(),R(t.$$.fragment),i=A(),R(s.$$.fragment),r=A(),o.c(),u=ee()},l(g){V(e.$$.fragment,g),l=M(g),V(t.$$.fragment,g),i=M(g),V(s.$$.fragment,g),r=M(g),o.l(g),u=ee()},m(g,P){T(e,g,P),h(g,l,P),T(t,g,P),h(g,i,P),T(s,g,P),h(g,r,P),v[f].m(g,P),h(g,u,P),_=!0},p(g,P){const N={};P[1]&65536&&(N.$$scope={dirty:P,ctx:g}),e.$set(N);const c={};P[1]&65536&&(c.$$scope={dirty:P,ctx:g}),t.$set(c);const I={};P[1]&65536&&(I.$$scope={dirty:P,ctx:g}),s.$set(I);let a=f;f=w(g),f===a?v[f].p(g,P):(ne(),C(v[a],1,1,()=>{v[a]=null}),ie(),o=v[f],o?o.p(g,P):(o=v[f]=L[f](g),o.c()),b(o,1),o.m(u.parentNode,u))},i(g){_||(b(e.$$.fragment,g),b(t.$$.fragment,g),b(s.$$.fragment,g),b(o),_=!0)},o(g){C(e.$$.fragment,g),C(t.$$.fragment,g),C(s.$$.fragment,g),C(o),_=!1},d(g){g&&($(l),$(i),$(r),$(u)),G(e,g),G(t,g),G(s,g),v[f].d(g)}}}function Ft(n){let e,l,t,i,s="Critical Issue Log",r,f,o,u,_="Policy Conflict Log",L,v;e=new Ct({props:{label:"Map tools",$$slots:{default:[Zt]},$$scope:{ctx:n}}});let w=oe(n[3].criticalIssues),g=[];for(let a=0;a<w.length;a+=1)g[a]=Ge(Ve(n,w,a));const P=a=>C(g[a],1,1,()=>{g[a]=null});let N=oe(n[3].policyConflictLog),c=[];for(let a=0;a<N.length;a+=1)c[a]=Fe(Re(n,N,a));const I=a=>C(c[a],1,1,()=>{c[a]=null});return{c(){R(e.$$.fragment),l=A(),t=F("div"),i=F("h3"),i.textContent=s,r=A();for(let a=0;a<g.length;a+=1)g[a].c();f=A(),o=F("div"),u=F("h3"),u.textContent=_,L=A();for(let a=0;a<c.length;a+=1)c[a].c();this.h()},l(a){V(e.$$.fragment,a),l=M(a),t=O(a,"DIV",{style:!0});var m=j(t);i=O(m,"H3",{"data-svelte-h":!0}),de(i)!=="svelte-e9mkko"&&(i.textContent=s),r=M(m);for(let k=0;k<g.length;k+=1)g[k].l(m);m.forEach($),f=M(a),o=O(a,"DIV",{style:!0});var S=j(o);u=O(S,"H3",{"data-svelte-h":!0}),de(u)!=="svelte-y008oc"&&(u.textContent=_),L=M(S);for(let k=0;k<c.length;k+=1)c[k].l(S);S.forEach($),this.h()},h(){U(t,"background-color","grey"),U(t,"padding","4px"),U(o,"background-color",Se),U(o,"padding","4px")},m(a,m){T(e,a,m),h(a,l,m),h(a,t,m),D(t,i),D(t,r);for(let S=0;S<g.length;S+=1)g[S]&&g[S].m(t,null);h(a,f,m),h(a,o,m),D(o,u),D(o,L);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(o,null);v=!0},p(a,m){const S={};if(m[0]&97|m[1]&65536&&(S.$$scope={dirty:m,ctx:a}),e.$set(S),m[0]&33292){w=oe(a[3].criticalIssues);let k;for(k=0;k<w.length;k+=1){const Z=Ve(a,w,k);g[k]?(g[k].p(Z,m),b(g[k],1)):(g[k]=Ge(Z),g[k].c(),b(g[k],1),g[k].m(t,null))}for(ne(),k=w.length;k<g.length;k+=1)P(k);ie()}if(m[0]&66060){N=oe(a[3].policyConflictLog);let k;for(k=0;k<N.length;k+=1){const Z=Re(a,N,k);c[k]?(c[k].p(Z,m),b(c[k],1)):(c[k]=Fe(Z),c[k].c(),b(c[k],1),c[k].m(o,null))}for(ne(),k=N.length;k<c.length;k+=1)I(k);ie()}},i(a){if(!v){b(e.$$.fragment,a);for(let m=0;m<w.length;m+=1)b(g[m]);for(let m=0;m<N.length;m+=1)b(c[m]);v=!0}},o(a){C(e.$$.fragment,a),g=g.filter(Boolean);for(let m=0;m<g.length;m+=1)C(g[m]);c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)C(c[m]);v=!1},d(a){a&&($(l),$(t),$(f),$(o)),G(e,a),ve(g,a),ve(c,a)}}}function Ot(n){let e;return{c(){e=H("Save")},l(l){e=J(l,"Save")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Ut(n){let e;return{c(){e=H("Delete")},l(l){e=J(l,"Delete")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function zt(n){let e;return{c(){e=H("Copy")},l(l){e=J(l,"Copy")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Ht(n){let e,l;return e=new Tt({props:{idx:n[1].id.idx}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Jt(n){let e,l;return e=new Mt({props:{idx:n[1].id.idx}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Kt(n){let e;return{c(){e=H("Zoom to fit")},l(l){e=J(l,"Zoom to fit")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Wt(n){let e;return{c(){e=H("Show route")},l(l){e=J(l,"Show route")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Zt(n){let e,l,t,i,s,r,f,o,u,_,L,v;e=new xe({props:{$$slots:{default:[Kt]},$$scope:{ctx:n}}}),e.$on("click",n[18]),t=new kt({}),s=new Lt({});function w(c){n[19](c)}let g={map:n[0]};n[5]!==void 0&&(g.enabled=n[5]),f=new Nt({props:g}),W.push(()=>X(f,"enabled",w));function P(c){n[20](c)}let N={$$slots:{default:[Wt]},$$scope:{ctx:n}};return n[6]!==void 0&&(N.checked=n[6]),_=new wt({props:N}),W.push(()=>X(_,"checked",P)),{c(){R(e.$$.fragment),l=A(),R(t.$$.fragment),i=A(),R(s.$$.fragment),r=A(),R(f.$$.fragment),u=A(),R(_.$$.fragment)},l(c){V(e.$$.fragment,c),l=M(c),V(t.$$.fragment,c),i=M(c),V(s.$$.fragment,c),r=M(c),V(f.$$.fragment,c),u=M(c),V(_.$$.fragment,c)},m(c,I){T(e,c,I),h(c,l,I),T(t,c,I),h(c,i,I),T(s,c,I),h(c,r,I),T(f,c,I),h(c,u,I),T(_,c,I),v=!0},p(c,I){const a={};I[1]&65536&&(a.$$scope={dirty:I,ctx:c}),e.$set(a);const m={};I[0]&1&&(m.map=c[0]),!o&&I[0]&32&&(o=!0,m.enabled=c[5],Y(()=>o=!1)),f.$set(m);const S={};I[1]&65536&&(S.$$scope={dirty:I,ctx:c}),!L&&I[0]&64&&(L=!0,S.checked=c[6],Y(()=>L=!1)),_.$set(S)},i(c){v||(b(e.$$.fragment,c),b(t.$$.fragment,c),b(s.$$.fragment,c),b(f.$$.fragment,c),b(_.$$.fragment,c),v=!0)},o(c){C(e.$$.fragment,c),C(t.$$.fragment,c),C(s.$$.fragment,c),C(f.$$.fragment,c),C(_.$$.fragment,c),v=!1},d(c){c&&($(l),$(i),$(r),$(u)),G(e,c),G(t,c),G(s,c),G(f,c),G(_,c)}}}function Te(n){let e;function l(s,r){return s[43].resolved=="No"?Xt:Yt}let t=l(n),i=t(n);return{c(){i.c(),e=ee()},l(s){i.l(s),e=ee()},m(s,r){i.m(s,r),h(s,e,r)},p(s,r){t===(t=l(s))&&i?i.p(s,r):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&$(e),i.d(s)}}}function Yt(n){let e,l,t=n[43].resolved+"",i;return{c(){e=F("span"),l=H("Resolved: "),i=H(t)},l(s){e=O(s,"SPAN",{});var r=j(e);l=J(r,"Resolved: "),i=J(r,t),r.forEach($)},m(s,r){h(s,e,r),D(e,l),D(e,i)},p(s,r){r[0]&8&&t!==(t=s[43].resolved+"")&&re(i,t)},d(s){s&&$(e)}}}function Xt(n){let e,l,t,i=n[43].resolved+"",s;return{c(){e=F("span"),l=F("b"),t=H("Resolved: "),s=H(i)},l(r){e=O(r,"SPAN",{});var f=j(e);l=O(f,"B",{});var o=j(l);t=J(o,"Resolved: "),s=J(o,i),o.forEach($),f.forEach($)},m(r,f){h(r,e,f),D(e,l),D(l,t),D(l,s)},p(r,f){f[0]&8&&i!==(i=r[43].resolved+"")&&re(s,i)},d(r){r&&$(e)}}}function Qt(n){let e,l,t,i=n[43].stage+"",s,r,f,o=n[43].stage!="Design"&&Te(n);return{c(){e=F("div"),l=F("span"),t=H("Stage: "),s=H(i),r=A(),o&&o.c(),f=A(),this.h()},l(u){e=O(u,"DIV",{style:!0});var _=j(e);l=O(_,"SPAN",{});var L=j(l);t=J(L,"Stage: "),s=J(L,i),L.forEach($),r=M(_),o&&o.l(_),_.forEach($),f=M(u),this.h()},h(){U(e,"width","100%"),U(e,"display","flex"),U(e,"justify-content","space-between")},m(u,_){h(u,e,_),D(e,l),D(l,t),D(l,s),D(e,r),o&&o.m(e,null),h(u,f,_)},p(u,_){_[0]&8&&i!==(i=u[43].stage+"")&&re(s,i),u[43].stage!="Design"?o?o.p(u,_):(o=Te(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&($(e),$(f)),o&&o.d()}}}function Ge(n){let e,l;function t(){return n[21](n[42])}function i(){return n[22](n[42])}return e=new et({props:{name:n[15](n[43]),$$slots:{default:[Qt]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[23]),{c(){R(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,r){T(e,s,r),l=!0},p(s,r){n=s;const f={};r[0]&8&&(f.name=n[15](n[43])),r[0]&8|r[1]&65536&&(f.$$scope={dirty:r,ctx:n}),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){C(e.$$.fragment,s),l=!1},d(s){G(e,s)}}}function je(n){let e;function l(s,r){return s[40].resolved=="No"?el:xt}let t=l(n),i=t(n);return{c(){i.c(),e=ee()},l(s){i.l(s),e=ee()},m(s,r){i.m(s,r),h(s,e,r)},p(s,r){t===(t=l(s))&&i?i.p(s,r):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&$(e),i.d(s)}}}function xt(n){let e,l,t=n[40].resolved+"",i;return{c(){e=F("span"),l=H("Resolved: "),i=H(t)},l(s){e=O(s,"SPAN",{});var r=j(e);l=J(r,"Resolved: "),i=J(r,t),r.forEach($)},m(s,r){h(s,e,r),D(e,l),D(e,i)},p(s,r){r[0]&8&&t!==(t=s[40].resolved+"")&&re(i,t)},d(s){s&&$(e)}}}function el(n){let e,l,t,i=n[40].resolved+"",s;return{c(){e=F("span"),l=F("b"),t=H("Resolved: "),s=H(i)},l(r){e=O(r,"SPAN",{});var f=j(e);l=O(f,"B",{});var o=j(l);t=J(o,"Resolved: "),s=J(o,i),o.forEach($),f.forEach($)},m(r,f){h(r,e,f),D(e,l),D(l,t),D(l,s)},p(r,f){f[0]&8&&i!==(i=r[40].resolved+"")&&re(s,i)},d(r){r&&$(e)}}}function tl(n){let e,l,t,i=n[40].stage+"",s,r,f,o=n[40].stage!="Design"&&je(n);return{c(){e=F("div"),l=F("span"),t=H("Stage: "),s=H(i),r=A(),o&&o.c(),f=A(),this.h()},l(u){e=O(u,"DIV",{style:!0});var _=j(e);l=O(_,"SPAN",{});var L=j(l);t=J(L,"Stage: "),s=J(L,i),L.forEach($),r=M(_),o&&o.l(_),_.forEach($),f=M(u),this.h()},h(){U(e,"width","100%"),U(e,"display","flex"),U(e,"justify-content","space-between")},m(u,_){h(u,e,_),D(e,l),D(l,t),D(l,s),D(e,r),o&&o.m(e,null),h(u,f,_)},p(u,_){_[0]&8&&i!==(i=u[40].stage+"")&&re(s,i),u[40].stage!="Design"?o?o.p(u,_):(o=je(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&($(e),$(f)),o&&o.d()}}}function Fe(n){let e,l;function t(){return n[24](n[42])}function i(){return n[25](n[42])}return e=new et({props:{name:n[16](n[40]),$$slots:{default:[tl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[26]),{c(){R(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,r){T(e,s,r),l=!0},p(s,r){n=s;const f={};r[0]&8&&(f.name=n[16](n[40])),r[0]&8|r[1]&65536&&(f.$$scope={dirty:r,ctx:n}),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){C(e.$$.fragment,s),l=!1},d(s){G(e,s)}}}function Oe(n){let e,l,t,i,s,r,f;return l=new ye({props:{$$slots:{default:[il]},$$scope:{ctx:n}}}),l.$on("click",n[11]),i=new ye({props:{$$slots:{default:[sl]},$$scope:{ctx:n}}}),i.$on("click",n[28]),r=new ye({props:{$$slots:{default:[cl]},$$scope:{ctx:n}}}),r.$on("click",n[29]),{c(){e=F("div"),R(l.$$.fragment),t=A(),R(i.$$.fragment),s=A(),R(r.$$.fragment),this.h()},l(o){e=O(o,"DIV",{class:!0});var u=j(e);V(l.$$.fragment,u),t=M(u),V(i.$$.fragment,u),s=M(u),V(r.$$.fragment,u),u.forEach($),this.h()},h(){B(e,"class","control-panel svelte-70vzbr")},m(o,u){h(o,e,u),T(l,e,null),D(e,t),T(i,e,null),D(e,s),T(r,e,null),f=!0},p(o,u){const _={};u[0]&2|u[1]&65536&&(_.$$scope={dirty:u,ctx:o}),l.$set(_);const L={};u[0]&2|u[1]&65536&&(L.$$scope={dirty:u,ctx:o}),i.$set(L);const v={};u[0]&2|u[1]&65536&&(v.$$scope={dirty:u,ctx:o}),r.$set(v)},i(o){f||(b(l.$$.fragment,o),b(i.$$.fragment,o),b(r.$$.fragment,o),f=!0)},o(o){C(l.$$.fragment,o),C(i.$$.fragment,o),C(r.$$.fragment,o),f=!1},d(o){o&&$(e),G(l),G(i),G(r)}}}function ll(n){let e;return{c(){e=H("Move map")},l(l){e=J(l,"Move map")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function nl(n){let e,l="Move map";return{c(){e=F("b"),e.textContent=l},l(t){e=O(t,"B",{"data-svelte-h":!0}),de(e)!=="svelte-ydcbkl"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function il(n){let e,l,t,i;function s(o,u){return o[1].mode=="select"?nl:ll}let r=s(n),f=r(n);return{c(){e=F("img"),t=A(),f.c(),i=ee(),this.h()},l(o){e=O(o,"IMG",{src:!0,alt:!0,style:!0}),t=M(o),f.l(o),i=ee(),this.h()},h(){ct(e.src,l=Dt)||B(e,"src",l),B(e,"alt","Move map"),U(e,"vertical-align","middle")},m(o,u){h(o,e,u),h(o,t,u),f.m(o,u),h(o,i,u)},p(o,u){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function ol(n){let e;return{c(){e=H("New critical issue")},l(l){e=J(l,"New critical issue")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function rl(n){let e,l="New critical issue";return{c(){e=F("b"),e.textContent=l},l(t){e=O(t,"B",{"data-svelte-h":!0}),de(e)!=="svelte-1q9dhgs"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function sl(n){let e,l,t,i;function s(o,u){return o[1].mode=="new-critical"?rl:ol}let r=s(n),f=r(n);return{c(){e=pe("svg"),l=pe("rect"),t=A(),f.c(),i=ee(),this.h()},l(o){e=_e(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=j(e);l=_e(u,"rect",{width:!0,height:!0,fill:!0,class:!0}),j(l).forEach($),u.forEach($),t=M(o),f.l(o),i=ee(),this.h()},h(){B(l,"width","24"),B(l,"height","24"),B(l,"fill",He.critical.background),B(l,"class","svelte-70vzbr"),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),U(e,"vertical-align","middle")},m(o,u){h(o,e,u),D(e,l),h(o,t,u),f.m(o,u),h(o,i,u)},p(o,u){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function al(n){let e;return{c(){e=H("New policy conflict")},l(l){e=J(l,"New policy conflict")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function fl(n){let e,l="New policy conflict";return{c(){e=F("b"),e.textContent=l},l(t){e=O(t,"B",{"data-svelte-h":!0}),de(e)!=="svelte-pf83jq"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function cl(n){let e,l,t,i;function s(o,u){return o[1].mode=="new-conflict"?fl:al}let r=s(n),f=r(n);return{c(){e=pe("svg"),l=pe("circle"),t=A(),f.c(),i=ee(),this.h()},l(o){e=_e(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=j(e);l=_e(u,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),j(l).forEach($),u.forEach($),t=M(o),f.l(o),i=ee(),this.h()},h(){B(l,"cx","12"),B(l,"cy","12"),B(l,"r","12"),B(l,"fill",Se),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),U(e,"vertical-align","middle")},m(o,u){h(o,e,u),D(e,l),h(o,t,u),f.m(o,u),h(o,i,u)},p(o,u){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function ul(n){let e,l,t,i=n[43].criticalIssue+"",s;return{c(){e=pe("svg"),l=pe("rect"),t=pe("text"),s=H(i),this.h()},l(r){e=_e(r,"svg",{width:!0,height:!0,xmlns:!0});var f=j(e);l=_e(f,"rect",{width:!0,height:!0,fill:!0,class:!0}),j(l).forEach($),t=_e(f,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var o=j(t);s=J(o,i),o.forEach($),f.forEach($),this.h()},h(){B(l,"width","40"),B(l,"height","40"),B(l,"fill",He.critical.background),B(l,"class","svelte-70vzbr"),B(t,"x","50%"),B(t,"y","50%"),B(t,"dominant-baseline","middle"),B(t,"text-anchor","middle"),U(t,"fill","white"),U(t,"font","bold 15px sans-serif"),B(e,"width","40"),B(e,"height","40"),B(e,"xmlns","http://www.w3.org/2000/svg")},m(r,f){h(r,e,f),D(e,l),D(e,t),D(t,s)},p(r,f){f[0]&8&&i!==(i=r[43].criticalIssue+"")&&re(s,i)},d(r){r&&$(e)}}}function Ue(n){let e,l,t;function i(o){n[30](o,n[43])}function s(){return n[31](n[42])}function r(){return n[32](n[42])}let f={draggable:!0,$$slots:{default:[ul]},$$scope:{ctx:n}};return n[43].point!==void 0&&(f.lngLat=n[43].point),e=new Qe({props:f}),W.push(()=>X(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",r),{c(){R(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,u){T(e,o,u),t=!0},p(o,u){n=o;const _={};u[0]&8|u[1]&65536&&(_.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,_.lngLat=n[43].point,Y(()=>l=!1)),e.$set(_)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function pl(n){let e,l=n[40].conflict+"",t;return{c(){e=F("span"),t=H(l),this.h()},l(i){e=O(i,"SPAN",{class:!0});var s=j(e);t=J(s,l),s.forEach($),this.h()},h(){B(e,"class","dot svelte-70vzbr"),U(e,"background",Se)},m(i,s){h(i,e,s),D(e,t)},p(i,s){s[0]&8&&l!==(l=i[40].conflict+"")&&re(t,l)},d(i){i&&$(e)}}}function ze(n){let e,l,t;function i(o){n[33](o,n[40])}function s(){return n[34](n[42])}function r(){return n[35](n[42])}let f={draggable:!0,$$slots:{default:[pl]},$$scope:{ctx:n}};return n[40].point!==void 0&&(f.lngLat=n[40].point),e=new Qe({props:f}),W.push(()=>X(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",r),{c(){R(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,u){T(e,o,u),t=!0},p(o,u){n=o;const _={};u[0]&8|u[1]&65536&&(_.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,_.lngLat=n[40].point,Y(()=>l=!1)),e.$set(_)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function _l(n){let e,l;return e=new $t({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){R(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,i){T(e,t,i),l=!0},p:ut,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function ml(n){let e,l,t,i,s,r,f,o,u,_,L;e=new St({}),e.$on("click",n[12]);let v=n[1].mode!="editing"&&Oe(n);i=new Pt({props:{show:n[6],id:"route-map"}}),r=new Et({props:{map:n[0],beforeId:"route-map"}});let w=oe(n[3].criticalIssues),g=[];for(let a=0;a<w.length;a+=1)g[a]=Ue(Me(n,w,a));const P=a=>C(g[a],1,1,()=>{g[a]=null});let N=oe(n[3].policyConflictLog),c=[];for(let a=0;a<N.length;a+=1)c[a]=ze(Ae(n,N,a));const I=a=>C(c[a],1,1,()=>{c[a]=null});return _=new gt({props:{data:n[7],$$slots:{default:[_l]},$$scope:{ctx:n}}}),{c(){R(e.$$.fragment),l=A(),v&&v.c(),t=A(),R(i.$$.fragment),s=A(),R(r.$$.fragment),f=A();for(let a=0;a<g.length;a+=1)g[a].c();o=A();for(let a=0;a<c.length;a+=1)c[a].c();u=A(),R(_.$$.fragment)},l(a){V(e.$$.fragment,a),l=M(a),v&&v.l(a),t=M(a),V(i.$$.fragment,a),s=M(a),V(r.$$.fragment,a),f=M(a);for(let m=0;m<g.length;m+=1)g[m].l(a);o=M(a);for(let m=0;m<c.length;m+=1)c[m].l(a);u=M(a),V(_.$$.fragment,a)},m(a,m){T(e,a,m),h(a,l,m),v&&v.m(a,m),h(a,t,m),T(i,a,m),h(a,s,m),T(r,a,m),h(a,f,m);for(let S=0;S<g.length;S+=1)g[S]&&g[S].m(a,m);h(a,o,m);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(a,m);h(a,u,m),T(_,a,m),L=!0},p(a,m){a[1].mode!="editing"?v?(v.p(a,m),m[0]&2&&b(v,1)):(v=Oe(a),v.c(),b(v,1),v.m(t.parentNode,t)):v&&(ne(),C(v,1,1,()=>{v=null}),ie());const S={};m[0]&64&&(S.show=a[6]),i.$set(S);const k={};if(m[0]&1&&(k.map=a[0]),r.$set(k),m[0]&264){w=oe(a[3].criticalIssues);let q;for(q=0;q<w.length;q+=1){const te=Me(a,w,q);g[q]?(g[q].p(te,m),b(g[q],1)):(g[q]=Ue(te),g[q].c(),b(g[q],1),g[q].m(o.parentNode,o))}for(ne(),q=w.length;q<g.length;q+=1)P(q);ie()}if(m[0]&264){N=oe(a[3].policyConflictLog);let q;for(q=0;q<N.length;q+=1){const te=Ae(a,N,q);c[q]?(c[q].p(te,m),b(c[q],1)):(c[q]=ze(te),c[q].c(),b(c[q],1),c[q].m(u.parentNode,u))}for(ne(),q=N.length;q<c.length;q+=1)I(q);ie()}const Z={};m[0]&128&&(Z.data=a[7]),m[1]&65536&&(Z.$$scope={dirty:m,ctx:a}),_.$set(Z)},i(a){if(!L){b(e.$$.fragment,a),b(v),b(i.$$.fragment,a),b(r.$$.fragment,a);for(let m=0;m<w.length;m+=1)b(g[m]);for(let m=0;m<N.length;m+=1)b(c[m]);b(_.$$.fragment,a),L=!0}},o(a){C(e.$$.fragment,a),C(v),C(i.$$.fragment,a),C(r.$$.fragment,a),g=g.filter(Boolean);for(let m=0;m<g.length;m+=1)C(g[m]);c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)C(c[m]);C(_.$$.fragment,a),L=!1},d(a){a&&($(l),$(t),$(s),$(f),$(o),$(u)),G(e,a),v&&v.d(a),G(i,a),G(r,a),ve(g,a),ve(c,a),G(_,a)}}}function gl(n){let e,l,t,i,s,r,f,o,u,_,L;const v=[Ft,jt],w=[];function g(c,I){return c[1].mode!="editing"?0:1}t=g(n),i=w[t]=v[t](n);function P(c){n[36](c)}let N={$$slots:{default:[ml]},$$scope:{ctx:n}};return n[0]!==void 0&&(N.map=n[0]),f=new _t({props:N}),W.push(()=>X(f,"map",P)),{c(){e=F("div"),l=F("div"),i.c(),s=A(),r=F("div"),R(f.$$.fragment),this.h()},l(c){e=O(c,"DIV",{style:!0});var I=j(e);l=O(I,"DIV",{style:!0});var a=j(l);i.l(a),a.forEach($),s=M(I),r=O(I,"DIV",{style:!0});var m=j(r);V(f.$$.fragment,m),m.forEach($),I.forEach($),this.h()},h(){U(l,"width","30%"),U(l,"overflow-y","scroll"),U(l,"padding","10px"),U(l,"border","1px solid black"),U(r,"position","relative"),U(r,"width","70%"),U(e,"display","flex"),U(e,"height","80vh")},m(c,I){h(c,e,I),D(e,l),w[t].m(l,null),n[27](l),D(e,s),D(e,r),T(f,r,null),u=!0,_||(L=at(Gt,"keydown",n[17]),_=!0)},p(c,I){let a=t;t=g(c),t===a?w[t].p(c,I):(ne(),C(w[a],1,1,()=>{w[a]=null}),ie(),i=w[t],i?i.p(c,I):(i=w[t]=v[t](c),i.c()),b(i,1),i.m(l,null));const m={};I[0]&203|I[1]&65536&&(m.$$scope={dirty:I,ctx:c}),!o&&I[0]&1&&(o=!0,m.map=c[0],Y(()=>o=!1)),f.$set(m)},i(c){u||(b(i),b(f.$$.fragment,c),u=!0)},o(c){C(i),C(f.$$.fragment,c),u=!1},d(c){c&&$(e),w[t].d(),n[27](null),G(f),_=!1,L()}}}function $l(n,e,l){let t={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:l;if(i!=null){let s=i.kind=="critical"?n.criticalIssues:n.policyConflictLog;t.features.push(Ce(s[i.idx].point))}return t}function Ce(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function dl(n,e,l){let t,i,s;he(n,K,d=>l(3,i=d)),he(n,Bt,d=>l(38,s=d));let r,f,o={mode:"select"},u=s.url.searchParams.get("kind")||"";u=="critical"?o={mode:"new-critical"}:u=="conflict"&&(o={mode:"new-conflict"});let _=null,L=null,v=!1,w=!0;async function g(d){_=f.scrollTop,l(1,o={mode:"editing",id:d}),l(2,L=null),await we(),l(4,f.scrollTop=0,f)}async function P(d){_=f.scrollTop,l(1,o={mode:"editing",id:d}),l(2,L=null),await we(),l(4,f.scrollTop=0,f);let z=d.kind=="critical"?i.criticalIssues:i.policyConflictLog;r.flyTo({center:z[d.idx].point,duration:500})}async function N(){if(o.mode!="editing")return;let d=o.id,z=d.kind=="critical"?i.criticalIssues:i.policyConflictLog,le=JSON.parse(JSON.stringify(z[d.idx])),rt=r.getBounds().getWest(),st=r.getBounds().getEast();le.point[0]+=(st-rt)*.05;let Ee=z.toSpliced(d.idx+1,0,le);d.kind=="critical"?me(K,i.criticalIssues=Ee,i):me(K,i.policyConflictLog=Ee,i),await g({kind:d.kind,idx:d.idx+1})}async function c(){l(1,o={mode:"select"}),me(K,i.policyConflictLog=i.policyConflictLog.toSorted((d,z)=>De(d.conflict)-De(z.conflict)),i),me(K,i.criticalIssues=i.criticalIssues.toSorted((d,z)=>Be(d.criticalIssue)-Be(z.criticalIssue)),i),_!=null&&(await we(),l(4,f.scrollTop=_,f),_=null)}function I(d){if(!v&&o.mode!="select"){if(o.mode=="editing"){c();return}o.mode=="new-critical"?(me(K,i.criticalIssues=[...i.criticalIssues,{criticalIssue:s.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),g({kind:"critical",idx:i.criticalIssues.length-1})):o.mode=="new-conflict"&&(me(K,i.policyConflictLog=[...i.policyConflictLog,{conflict:s.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),g({kind:"conflict",idx:i.policyConflictLog.length-1}))}}ft(()=>{m(!1)});function a(){o.mode=="editing"&&window.confirm("Delete this entry?")&&(o.id.kind=="critical"?(i.criticalIssues.splice(o.id.idx,1),K.set(i)):(i.policyConflictLog.splice(o.id.idx,1),K.set(i)),c())}function m(d){let z={type:"FeatureCollection",features:[...i.criticalIssues.map(le=>Ce(le.point)),...i.policyConflictLog.map(le=>Ce(le.point)),...i.summary.networkMap.features]};z.features.length>0&&r.fitBounds(mt(z),{padding:20,animate:d})}function S(d){let z=d.criticalIssue?vt(d.criticalIssue):"Unknown critical";return d.locationName?`${z} (${d.locationName})`:z}function k(d){let z=d.conflict?"P00"+bt(d.conflict):"Unknown conflict";return d.locationName?`${z} (${d.locationName})`:z}function Z(d){if(o.mode=="editing"){let z=d.target.tagName,le=z=="INPUT"||z=="TEXTAREA";d.key=="Escape"||d.key=="Enter"&&!le?(d.stopPropagation(),c()):d.key=="Delete"&&!le&&(d.stopPropagation(),a())}else(o.mode=="new-critical"||o.mode=="new-conflict")&&d.key=="Escape"&&(d.stopPropagation(),l(1,o={mode:"select"}))}const q=()=>m(!0);function te(d){v=d,l(5,v)}function se(d){w=d,l(6,w)}const ge=d=>P({kind:"critical",idx:d}),ae=d=>l(2,L={kind:"critical",idx:d}),E=()=>l(2,L=null),$e=d=>P({kind:"conflict",idx:d}),fe=d=>l(2,L={kind:"conflict",idx:d}),p=()=>l(2,L=null);function y(d){W[d?"unshift":"push"](()=>{f=d,l(4,f)})}const Q=()=>l(1,o={mode:"new-critical"}),x=()=>l(1,o={mode:"new-conflict"});function ce(d,z){n.$$.not_equal(z.point,d)&&(z.point=d,K.set(i))}const ue=d=>g({kind:"critical",idx:d}),tt=d=>g({kind:"critical",idx:d});function lt(d,z){n.$$.not_equal(z.point,d)&&(z.point=d,K.set(i))}const nt=d=>g({kind:"conflict",idx:d}),it=d=>g({kind:"conflict",idx:d});function ot(d){r=d,l(0,r)}return n.$$.update=()=>{n.$$.dirty[0]&3&&r&&(r.getCanvas().style.cursor=o.mode=="new-critical"||o.mode=="new-conflict"?"crosshair":"auto"),n.$$.dirty[0]&14&&l(7,t=$l(i,o,L))},[r,o,L,i,f,v,w,t,g,P,N,c,I,a,m,S,k,Z,q,te,se,ge,ae,E,$e,fe,p,y,Q,x,ce,ue,tt,lt,nt,it,ot]}class zl extends Le{constructor(e){super(),Ne(this,e,dl,gl,Ie,{},null,[-1,-1])}}export{zl as component};
