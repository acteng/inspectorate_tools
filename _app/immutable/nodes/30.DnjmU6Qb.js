import{s as he,v as Y,x as ne,l as Ue,u as Je,m as Ke,o as We,H as de,E as _e,i as C,f as h,a8 as yn,a7 as vn,k as ye,U as Jt,a9 as wn,N as qe,e as x,c as ee,b as oe,r as Ne,a as H,g as R,q as Be,n as Ve,t as W,d as V,w as Q,h as ce,j as ve,z as kn,p as yt}from"../chunks/scheduler.BV_JqZpr.js";import{S as we,i as ke,e as re,c as F,a as q,m as B,t as v,b as $,d as N,g as se,f as ue}from"../chunks/index.DDJL-Wug.js";import{e as pe}from"../chunks/each.Cp9qZMvj.js";import{B as $n}from"../chunks/ButtonGroup.CpPC8Sl4.js";import{W as Kt,S as be}from"../chunks/WarningButton.Ck9VEuu1.js";import{T as lt}from"../chunks/TextInput.Daolq3gG.js";import{s as X}from"../chunks/data.B1AODWVl.js";import{L as Wt,a as Vt,m as jn,e as Pe,i as Ln,f as Xt,M as En,G as vt,h as wt,g as Cn}from"../chunks/MapLibreMap.5T7gk3jZ.js";import{c as Ge}from"../chunks/colors.CYEpEtTL.js";import{a as Mn,M as Pn,c as In,d as De,C as On,R as Zt,B as An,G as Tn,S as Sn}from"../chunks/GeoreferenceLayer.D6gfLq4f.js";import{C as Fn}from"../chunks/CollapsibleCard.UC1DOObh.js";import{D as qn}from"../chunks/DefaultButton.DCHkaEOp.js";import{T as Qt}from"../chunks/TextArea.e-LUVmrn.js";import{p as Yt}from"../chunks/index.fjS_-iy0.js";import{S as Bn}from"../chunks/Select.C1vp33wH.js";function Nn(t){let e;const n=t[15].default,r=Ue(n,t,t[23],null);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l&8388608)&&Je(r,n,o,o[23],e?We(n,o[23],l,null):Ke(o[23]),null)},i(o){e||(v(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function zn(t){let e,n,r;function o(i){t[16](i)}let l={id:t[1],type:"line",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],minzoom:t[9],maxzoom:t[10],hoverCursor:t[11],manageHoverState:t[12],eventsIfTopMost:t[13],interactive:t[14],$$slots:{default:[Nn]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Wt({props:l}),Y.push(()=>re(e,"hovered",o)),e.$on("click",t[17]),e.$on("dblclick",t[18]),e.$on("contextmenu",t[19]),e.$on("mouseenter",t[20]),e.$on("mousemove",t[21]),e.$on("mouseleave",t[22]),{c(){F(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,a){B(e,i,a),r=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&16384&&(s.interactive=i[14]),a&8388608&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],ne(()=>n=!1)),e.$set(s)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){N(e,i)}}}function Gn(t,e,n){let{$$slots:r={},$$scope:o}=e,{id:l=Vt("line")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:d=void 0}=e,{filter:u=void 0}=e,{minzoom:L=void 0}=e,{maxzoom:O=void 0}=e,{hoverCursor:P=void 0}=e,{manageHoverState:D=!1}=e,{hovered:g=null}=e,{eventsIfTopMost:p=!1}=e,{interactive:j=!0}=e;function S(A){g=A,n(0,g)}function b(A){de.call(this,t,A)}function f(A){de.call(this,t,A)}function M(A){de.call(this,t,A)}function z(A){de.call(this,t,A)}function G(A){de.call(this,t,A)}function T(A){de.call(this,t,A)}return t.$$set=A=>{"id"in A&&n(1,l=A.id),"source"in A&&n(2,i=A.source),"sourceLayer"in A&&n(3,a=A.sourceLayer),"beforeId"in A&&n(4,s=A.beforeId),"beforeLayerType"in A&&n(5,m=A.beforeLayerType),"paint"in A&&n(6,c=A.paint),"layout"in A&&n(7,d=A.layout),"filter"in A&&n(8,u=A.filter),"minzoom"in A&&n(9,L=A.minzoom),"maxzoom"in A&&n(10,O=A.maxzoom),"hoverCursor"in A&&n(11,P=A.hoverCursor),"manageHoverState"in A&&n(12,D=A.manageHoverState),"hovered"in A&&n(0,g=A.hovered),"eventsIfTopMost"in A&&n(13,p=A.eventsIfTopMost),"interactive"in A&&n(14,j=A.interactive),"$$scope"in A&&n(23,o=A.$$scope)},[g,l,i,a,s,m,c,d,u,L,O,P,D,p,j,r,S,b,f,M,z,G,T,o]}class nt extends we{constructor(e){super(),ke(this,e,Gn,zn,he,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}const Dn=t=>({features:t[0]&16,data:t[0]&16,map:t[0]&4,close:t[0]&1}),kt=t=>{var e;return{features:t[4],data:(e=t[4])==null?void 0:e[0],map:t[2],close:t[31]}};function $t(t){let e,n,r=(t[4]||t[3]instanceof Pe.Marker)&&jt(t);return{c(){e=x("div"),r&&r.c()},l(o){e=ee(o,"DIV",{});var l=oe(e);r&&r.l(l),l.forEach(h)},m(o,l){C(o,e,l),r&&r.m(e,null),t[32](e),n=!0},p(o,l){o[4]||o[3]instanceof Pe.Marker?r?(r.p(o,l),l[0]&24&&v(r,1)):(r=jt(o),r.c(),v(r,1),r.m(e,null)):r&&(se(),$(r,1,1,()=>{r=null}),ue())},i(o){n||(v(r),n=!0)},o(o){$(r),n=!1},d(o){o&&h(e),r&&r.d(),t[32](null)}}}function jt(t){let e;const n=t[30].default,r=Ue(n,t,t[29],kt);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l[0]&536870933)&&Je(r,n,o,o[29],e?We(n,o[29],l,Dn):Ke(o[29]),kt)},i(o){e||(v(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function Hn(t){let e,n,r=t[9].default&&$t(t);return{c(){r&&r.c(),e=_e()},l(o){r&&r.l(o),e=_e()},m(o,l){r&&r.m(o,l),C(o,e,l),n=!0},p(o,l){o[9].default?r?(r.p(o,l),l[0]&512&&v(r,1)):(r=$t(o),r.c(),v(r,1),r.m(e.parentNode,e)):r&&(se(),$(r,1,1,()=>{r=null}),ue())},i(o){n||(v(r),n=!0)},o(o){$(r),n=!1},d(o){o&&h(e),r&&r.d(o)}}}function Rn(t,e,n){let r,o,l,i,a,s,{$$slots:m={},$$scope:c}=e;const d=yn(m);let{closeButton:u=void 0}=e,{closeOnClickOutside:L=!0}=e,{closeOnClickInside:O=!1}=e,{closeOnMove:P=!1}=e,{openOn:D="click"}=e,{openIfTopMost:g=!0}=e,{focusAfterOpen:p=!0}=e,{anchor:j=void 0}=e,{offset:S=void 0}=e,{popupClass:b=void 0}=e,{maxWidth:f=void 0}=e,{lngLat:M=void 0}=e,{html:z=void 0}=e,{open:G=!1}=e;const T=vn(),{map:A,popupTarget:E,layerEvent:_,layer:y,eventTopMost:Z}=jn();ye(t,A,k=>n(2,l=k)),ye(t,E,k=>n(3,a=k)),ye(t,_,k=>n(28,i=k)),ye(t,y,k=>n(35,s=k));const le=["click","dblclick","contextmenu"];let I,ge=!1,w;function U(){if(!I)return;let k=I.getElement();!k||k===w||(w=k,D==="hover"&&(w.style.pointerEvents="none"),w.addEventListener("mouseenter",()=>{n(24,ge=!0)},{passive:!0}),w.addEventListener("mouseleave",()=>{n(24,ge=!1)},{passive:!0}),w.addEventListener("click",()=>{O&&n(0,G=!1)},{passive:!0}))}Jt(()=>{if(l)return l.on("click",ze),l.on("contextmenu",ze),typeof a=="string"&&(l.on("click",a,Ce),l.on("dblclick",a,Ce),l.on("contextmenu",a,Ce),l.on("mousemove",a,bt),l.on("mouseleave",a,ht),l.on("touchstart",a,_t),l.on("touchend",a,pt)),()=>{l!=null&&l.loaded()&&(I==null||I.remove(),l.off("click",ze),l.off("contextmenu",ze),a instanceof Pe.Marker?a.getPopup()===I&&a.setPopup(void 0):typeof a=="string"&&(l.off("click",a,Ce),l.off("dblclick",a,Ce),l.off("contextmenu",a,Ce),l.off("mousemove",a,bt),l.off("mouseleave",a,ht),l.off("touchstart",a,_t),l.off("touchend",a,pt)))}});function ae(k){return g?!("marker"in k)&&!Ln(k)&&Z(k)!==s:!1}let te=null,ie="normal";function Ce(k){k.type===D&&(ae(k)||("layerType"in k?k.layerType==="deckgl"?(n(10,M=k.coordinate),n(4,te=k.object?[k.object]:null)):(n(10,M=k.lngLat),n(4,te=k.features??[])):(n(10,M=k.lngLat),n(4,te=k.features??[])),setTimeout(()=>n(0,G=!0))))}let Me=null;function _t(k){Me=k.point}function pt(k){if(!Me||D!=="hover")return;let xe=Me.dist(k.point);Me=null,xe<3&&(n(10,M=k.lngLat),n(4,te=k.features??[]),I.isOpen()?n(25,ie="justOpened"):(n(25,ie="opening"),n(0,G=!0)))}function ht(k){D!=="hover"||Me||ie!=="normal"||(n(0,G=!1),n(4,te=null))}function bt(k){if(!(D!=="hover"||Me||ie!=="normal")){if(ae(k)){n(0,G=!1),n(4,te=null);return}n(0,G=!0),n(4,te=k.features??[]),n(10,M=k.lngLat)}}function ze(k){if(ie==="justOpened"){n(25,ie="normal");return}if(!L)return;let xe=[w,a instanceof Pe.Marker?a==null?void 0:a.getElement():null];G&&I.isOpen()&&!xe.some(et=>et==null?void 0:et.contains(k.originalEvent.target))&&(k.type==="contextmenu"&&D==="contextmenu"||k.type!=="contextmenu")&&n(0,G=!1)}wn(()=>{l&&(I!=null&&I.isOpen())&&I.remove()});let Ae;const hn=()=>n(0,G=!1);function bn(k){Y[k?"unshift":"push"](()=>{Ae=k,n(1,Ae)})}return t.$$set=k=>{"closeButton"in k&&n(11,u=k.closeButton),"closeOnClickOutside"in k&&n(12,L=k.closeOnClickOutside),"closeOnClickInside"in k&&n(13,O=k.closeOnClickInside),"closeOnMove"in k&&n(14,P=k.closeOnMove),"openOn"in k&&n(15,D=k.openOn),"openIfTopMost"in k&&n(16,g=k.openIfTopMost),"focusAfterOpen"in k&&n(17,p=k.focusAfterOpen),"anchor"in k&&n(18,j=k.anchor),"offset"in k&&n(19,S=k.offset),"popupClass"in k&&n(20,b=k.popupClass),"maxWidth"in k&&n(21,f=k.maxWidth),"lngLat"in k&&n(10,M=k.lngLat),"html"in k&&n(22,z=k.html),"open"in k&&n(0,G=k.open),"$$scope"in k&&n(29,c=k.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&14336&&n(27,r=u??(!L&&!O)),t.$$.dirty[0]&146685952&&(I||(n(23,I=new Pe.Popup({closeButton:r,closeOnClick:!1,closeOnMove:P,focusAfterOpen:p,maxWidth:f,className:b,anchor:j,offset:S})),w=I.getElement(),I.on("open",()=>{n(0,G=!0),U(),T("open",I)}),I.on("close",()=>{n(0,G=!1),T("close",I)}),I.on("hover",()=>{T("hover",I)}))),t.$$.dirty[0]&8421384&&I&&a instanceof Pe.Marker&&(D==="click"?a.setPopup(I):a.getPopup()===I&&a.setPopup(void 0)),t.$$.dirty[0]&268468224&&le.includes(D)&&(i==null?void 0:i.type)===D&&(Ce(i),qe(_,i=null,i)),t.$$.dirty[0]&268468224&&n(26,o=D==="hover"&&((i==null?void 0:i.type)==="mousemove"||(i==null?void 0:i.type)==="mouseenter")),t.$$.dirty[0]&352354304&&D==="hover"&&_&&(o&&i&&(i.layerType==="deckgl"?(n(10,M=i.coordinate),n(4,te=i.object?[i.object]:null)):(n(10,M=i.lngLat),n(4,te=i.features??[]))),n(0,G=(o||ge)??!1)),t.$$.dirty[0]&12582914&&(Ae?I.setDOMContent(Ae):z&&I.setHTML(z)),t.$$.dirty[0]&8389632&&M&&I.setLngLat(M),t.$$.dirty[0]&41943045&&l){let k=I.isOpen();G&&!k?(I.addTo(l),ie==="opening"&&n(25,ie="justOpened")):!G&&k&&I.remove()}},[G,Ae,l,a,te,A,E,_,y,d,M,u,L,O,P,D,g,p,j,S,b,f,z,I,ge,ie,o,r,i,c,m,hn,bn]}class Un extends we{constructor(e){super(),ke(this,e,Rn,Hn,he,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function Jn(t){let e;const n=t[16].default,r=Ue(n,t,t[24],null);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l&16777216)&&Je(r,n,o,o[24],e?We(n,o[24],l,null):Ke(o[24]),null)},i(o){e||(v(r,o),e=!0)},o(o){$(r,o),e=!1},d(o){r&&r.d(o)}}}function Kn(t){let e,n,r;function o(i){t[17](i)}let l={id:t[1],type:"symbol",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[Jn]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Wt({props:l}),Y.push(()=>re(e,"hovered",o)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){F(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,a){B(e,i,a),r=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&32768&&(s.interactive=i[15]),a&16777216&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],ne(()=>n=!1)),e.$set(s)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){N(e,i)}}}function Wn(t,e,n){let{$$slots:r={},$$scope:o}=e,{id:l=Vt("symbol")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c=void 0}=e,{layout:d=void 0}=e,{filter:u=void 0}=e,{applyToClusters:L=void 0}=e,{minzoom:O=void 0}=e,{maxzoom:P=void 0}=e,{hoverCursor:D=void 0}=e,{manageHoverState:g=!1}=e,{hovered:p=null}=e,{eventsIfTopMost:j=!1}=e,{interactive:S=!0}=e;function b(E){p=E,n(0,p)}function f(E){de.call(this,t,E)}function M(E){de.call(this,t,E)}function z(E){de.call(this,t,E)}function G(E){de.call(this,t,E)}function T(E){de.call(this,t,E)}function A(E){de.call(this,t,E)}return t.$$set=E=>{"id"in E&&n(1,l=E.id),"source"in E&&n(2,i=E.source),"sourceLayer"in E&&n(3,a=E.sourceLayer),"beforeId"in E&&n(4,s=E.beforeId),"beforeLayerType"in E&&n(5,m=E.beforeLayerType),"paint"in E&&n(6,c=E.paint),"layout"in E&&n(7,d=E.layout),"filter"in E&&n(8,u=E.filter),"applyToClusters"in E&&n(9,L=E.applyToClusters),"minzoom"in E&&n(10,O=E.minzoom),"maxzoom"in E&&n(11,P=E.maxzoom),"hoverCursor"in E&&n(12,D=E.hoverCursor),"manageHoverState"in E&&n(13,g=E.manageHoverState),"hovered"in E&&n(0,p=E.hovered),"eventsIfTopMost"in E&&n(14,j=E.eventsIfTopMost),"interactive"in E&&n(15,S=E.interactive),"$$scope"in E&&n(24,o=E.$$scope)},[p,l,i,a,s,m,c,d,u,L,O,P,D,g,j,S,r,b,f,M,z,G,T,A,o]}class Vn extends we{constructor(e){super(),ke(this,e,Wn,Kn,he,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}const Xn=t=>({props:t&8}),Lt=t=>({props:Yn(t[3])});function Zn(t){let e,n;const r=t[1].default,o=Ue(r,t,t[2],Lt);return{c(){e=x("div"),o&&o.c(),this.h()},l(l){e=ee(l,"DIV",{class:!0});var i=oe(e);o&&o.l(i),i.forEach(h),this.h()},h(){Ne(e,"class","govuk-prose")},m(l,i){C(l,e,i),o&&o.m(e,null),n=!0},p(l,i){o&&o.p&&(!n||i&12)&&Je(o,r,l,l[2],n?We(r,l[2],i,Xn):Ke(l[2]),Lt)},i(l){n||(v(o,l),n=!0)},o(l){$(o,l),n=!1},d(l){l&&h(e),o&&o.d(l)}}}function Qn(t){let e,n;return e=new Un({props:{openOn:t[0],$$slots:{default:[Zn,({features:r})=>({3:r}),({features:r})=>r?8:0]},$$scope:{ctx:t}}}),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,[o]){const l={};o&1&&(l.openOn=r[0]),o&12&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function Yn(t){return t?t[0].properties??{}:{}}function xn(t,e,n){let{$$slots:r={},$$scope:o}=e,{openOn:l="hover"}=e;return t.$$set=i=>{"openOn"in i&&n(0,l=i.openOn),"$$scope"in i&&n(2,o=i.$$scope)},[l,r,o]}class xt extends we{constructor(e){super(),ke(this,e,xn,Qn,he,{openOn:0})}}var er=Object.defineProperty,J=(t,e)=>er(t,"name",{value:e,configurable:!0}),tr=class{constructor(e){this.direction=!1,this.compareProperties=!0;var n,r,o;this.precision=10**-((n=e==null?void 0:e.precision)!=null?n:17),this.direction=(r=e==null?void 0:e.direction)!=null?r:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,n){if(e.type!==n.type||!Te(e,n))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,n.coordinates);case"LineString":return this.compareLine(e.coordinates,n.coordinates);case"Polygon":return this.comparePolygon(e,n);case"GeometryCollection":return this.compareGeometryCollection(e,n);case"Feature":return this.compareFeature(e,n);case"FeatureCollection":return this.compareFeatureCollection(e,n);default:if(e.type.startsWith("Multi")){const r=rt(e),o=rt(n);return r.every(l=>o.some(i=>this.compare(l,i)))}}return!1}compareCoord(e,n){return e.length===n.length&&e.every((r,o)=>Math.abs(r-n[o])<this.precision)}compareLine(e,n,r=0,o=!1){if(!Te(e,n))return!1;const l=e;let i=n;if(o&&!this.compareCoord(l[0],i[0])){const s=this.fixStartIndex(i,l);if(s)i=s;else return!1}const a=this.compareCoord(l[r],i[r]);return this.direction||a?this.comparePath(l,i):this.compareCoord(l[r],i[i.length-(1+r)])?this.comparePath(l.slice().reverse(),i):!1}fixStartIndex(e,n){let r,o=-1;for(let l=0;l<e.length;l++)if(this.compareCoord(e[l],n[0])){o=l;break}return o>=0&&(r=[].concat(e.slice(o,e.length),e.slice(1,o+1))),r}comparePath(e,n){return e.every((r,o)=>this.compareCoord(r,n[o]))}comparePolygon(e,n){if(this.compareLine(e.coordinates[0],n.coordinates[0],1,!0)){const r=e.coordinates.slice(1,e.coordinates.length),o=n.coordinates.slice(1,n.coordinates.length);return r.every(l=>o.some(i=>this.compareLine(l,i,1,!0)))}return!1}compareGeometryCollection(e,n){return Te(e.geometries,n.geometries)&&this.compareBBox(e,n)&&e.geometries.every((r,o)=>this.compare(r,n.geometries[o]))}compareFeature(e,n){return e.id===n.id&&(this.compareProperties?Xt(e.properties,n.properties):!0)&&this.compareBBox(e,n)&&this.compare(e.geometry,n.geometry)}compareFeatureCollection(e,n){return Te(e.features,n.features)&&this.compareBBox(e,n)&&e.features.every((r,o)=>this.compare(r,n.features[o]))}compareBBox(e,n){return!e.bbox&&!n.bbox||(e.bbox&&n.bbox?this.compareCoord(e.bbox,n.bbox):!1)}};J(tr,"GeojsonEquality");function Te(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}J(Te,"sameLength");function rt(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}J(rt,"explode");var fe=63710088e-1,en={centimeters:fe*100,centimetres:fe*100,degrees:360/(2*Math.PI),feet:fe*3.28084,inches:fe*39.37,kilometers:fe/1e3,kilometres:fe/1e3,meters:fe,metres:fe,miles:fe/1609.344,millimeters:fe*1e3,millimetres:fe*1e3,nauticalmiles:fe/1852,radians:1,yards:fe*1.0936},Et={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function $e(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}J($e,"feature");function nr(t,e,n={}){switch(t){case"Point":return Xe(e).geometry;case"LineString":return st(e).geometry;case"Polygon":return at(e).geometry;case"MultiPoint":return nn(e).geometry;case"MultiLineString":return tn(e).geometry;case"MultiPolygon":return rn(e).geometry;default:throw new Error(t+" is invalid")}}J(nr,"geometry");function Xe(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ie(t[0])||!Ie(t[1]))throw new Error("coordinates must contain numbers");return $e({type:"Point",coordinates:t},e,n)}J(Xe,"point");function rr(t,e,n={}){return Ze(t.map(r=>Xe(r,e)),n)}J(rr,"points");function at(t,e,n={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}return $e({type:"Polygon",coordinates:t},e,n)}J(at,"polygon");function or(t,e,n={}){return Ze(t.map(r=>at(r,e)),n)}J(or,"polygons");function st(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return $e({type:"LineString",coordinates:t},e,n)}J(st,"lineString");function ir(t,e,n={}){return Ze(t.map(r=>st(r,e)),n)}J(ir,"lineStrings");function Ze(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}J(Ze,"featureCollection");function tn(t,e,n={}){return $e({type:"MultiLineString",coordinates:t},e,n)}J(tn,"multiLineString");function nn(t,e,n={}){return $e({type:"MultiPoint",coordinates:t},e,n)}J(nn,"multiPoint");function rn(t,e,n={}){return $e({type:"MultiPolygon",coordinates:t},e,n)}J(rn,"multiPolygon");function lr(t,e,n={}){return $e({type:"GeometryCollection",geometries:t},e,n)}J(lr,"geometryCollection");function ar(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n}J(ar,"round");function on(t,e="kilometers"){const n=en[e];if(!n)throw new Error(e+" units is invalid");return t*n}J(on,"radiansToLength");function Qe(t,e="kilometers"){const n=en[e];if(!n)throw new Error(e+" units is invalid");return t/n}J(Qe,"lengthToRadians");function sr(t,e){return Re(Qe(t,e))}J(sr,"lengthToDegrees");function ur(t){let e=t%360;return e<0&&(e+=360),e}J(ur,"bearingToAzimuth");function Re(t){return t%(2*Math.PI)*180/Math.PI}J(Re,"radiansToDegrees");function He(t){return t%360*Math.PI/180}J(He,"degreesToRadians");function fr(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return on(Qe(t,e),n)}J(fr,"convertLength");function mr(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const r=Et[e];if(!r)throw new Error("invalid original units");const o=Et[n];if(!o)throw new Error("invalid final units");return t/r*o}J(mr,"convertArea");function Ie(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}J(Ie,"isNumber");function cr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}J(cr,"isObject");function gr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!Ie(e))throw new Error("bbox must only contain numbers")})}J(gr,"validateBBox");function dr(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}J(dr,"validateId");var _r=Object.defineProperty,je=(t,e)=>_r(t,"name",{value:e,configurable:!0});function ln(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}je(ln,"getCoord");function pr(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}je(pr,"getCoords");function an(t){if(t.length>1&&Ie(t[0])&&Ie(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return an(t[0]);throw new Error("coordinates must only contain numbers")}je(an,"containsNumber");function hr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}je(hr,"geojsonType");function br(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}je(br,"featureOf");function yr(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const r of t.features){if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}je(yr,"collectionOf");function vr(t){return t.type==="Feature"?t.geometry:t}je(vr,"getGeom");function wr(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}je(wr,"getType");var kr=Object.defineProperty,$r=(t,e)=>kr(t,"name",{value:e,configurable:!0});function sn(t,e,n,r={}){const o=ln(t),l=He(o[0]),i=He(o[1]),a=He(n),s=Qe(e,r.units),m=Math.asin(Math.sin(i)*Math.cos(s)+Math.cos(i)*Math.sin(s)*Math.cos(a)),c=l+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(i),Math.cos(s)-Math.sin(i)*Math.sin(m)),d=Re(c),u=Re(m);return Xe([d,u],r.properties)}$r(sn,"destination");var Ct=sn,jr=Object.defineProperty,K=(t,e)=>jr(t,"name",{value:e,configurable:!0}),Lr=class{constructor(e){this.direction=!1,this.compareProperties=!0;var n,r,o;this.precision=10**-((n=e==null?void 0:e.precision)!=null?n:17),this.direction=(r=e==null?void 0:e.direction)!=null?r:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,n){if(e.type!==n.type||!Se(e,n))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,n.coordinates);case"LineString":return this.compareLine(e.coordinates,n.coordinates);case"Polygon":return this.comparePolygon(e,n);case"GeometryCollection":return this.compareGeometryCollection(e,n);case"Feature":return this.compareFeature(e,n);case"FeatureCollection":return this.compareFeatureCollection(e,n);default:if(e.type.startsWith("Multi")){const r=ot(e),o=ot(n);return r.every(l=>o.some(i=>this.compare(l,i)))}}return!1}compareCoord(e,n){return e.length===n.length&&e.every((r,o)=>Math.abs(r-n[o])<this.precision)}compareLine(e,n,r=0,o=!1){if(!Se(e,n))return!1;const l=e;let i=n;if(o&&!this.compareCoord(l[0],i[0])){const s=this.fixStartIndex(i,l);if(s)i=s;else return!1}const a=this.compareCoord(l[r],i[r]);return this.direction||a?this.comparePath(l,i):this.compareCoord(l[r],i[i.length-(1+r)])?this.comparePath(l.slice().reverse(),i):!1}fixStartIndex(e,n){let r,o=-1;for(let l=0;l<e.length;l++)if(this.compareCoord(e[l],n[0])){o=l;break}return o>=0&&(r=[].concat(e.slice(o,e.length),e.slice(1,o+1))),r}comparePath(e,n){return e.every((r,o)=>this.compareCoord(r,n[o]))}comparePolygon(e,n){if(this.compareLine(e.coordinates[0],n.coordinates[0],1,!0)){const r=e.coordinates.slice(1,e.coordinates.length),o=n.coordinates.slice(1,n.coordinates.length);return r.every(l=>o.some(i=>this.compareLine(l,i,1,!0)))}return!1}compareGeometryCollection(e,n){return Se(e.geometries,n.geometries)&&this.compareBBox(e,n)&&e.geometries.every((r,o)=>this.compare(r,n.geometries[o]))}compareFeature(e,n){return e.id===n.id&&(this.compareProperties?Xt(e.properties,n.properties):!0)&&this.compareBBox(e,n)&&this.compare(e.geometry,n.geometry)}compareFeatureCollection(e,n){return Se(e.features,n.features)&&this.compareBBox(e,n)&&e.features.every((r,o)=>this.compare(r,n.features[o]))}compareBBox(e,n){return!e.bbox&&!n.bbox||(e.bbox&&n.bbox?this.compareCoord(e.bbox,n.bbox):!1)}};K(Lr,"GeojsonEquality");function Se(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}K(Se,"sameLength");function ot(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}K(ot,"explode");var me=63710088e-1,un={centimeters:me*100,centimetres:me*100,degrees:360/(2*Math.PI),feet:me*3.28084,inches:me*39.37,kilometers:me/1e3,kilometres:me/1e3,meters:me,metres:me,miles:me/1609.344,millimeters:me*1e3,millimetres:me*1e3,nauticalmiles:me/1852,radians:1,yards:me*1.0936},Mt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Le(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}K(Le,"feature");function Er(t,e,n={}){switch(t){case"Point":return ut(e).geometry;case"LineString":return mt(e).geometry;case"Polygon":return ft(e).geometry;case"MultiPoint":return mn(e).geometry;case"MultiLineString":return fn(e).geometry;case"MultiPolygon":return cn(e).geometry;default:throw new Error(t+" is invalid")}}K(Er,"geometry");function ut(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Oe(t[0])||!Oe(t[1]))throw new Error("coordinates must contain numbers");return Le({type:"Point",coordinates:t},e,n)}K(ut,"point");function Cr(t,e,n={}){return Ye(t.map(r=>ut(r,e)),n)}K(Cr,"points");function ft(t,e,n={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}return Le({type:"Polygon",coordinates:t},e,n)}K(ft,"polygon");function Mr(t,e,n={}){return Ye(t.map(r=>ft(r,e)),n)}K(Mr,"polygons");function mt(t,e,n={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return Le({type:"LineString",coordinates:t},e,n)}K(mt,"lineString");function Pr(t,e,n={}){return Ye(t.map(r=>mt(r,e)),n)}K(Pr,"lineStrings");function Ye(t,e={}){const n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}K(Ye,"featureCollection");function fn(t,e,n={}){return Le({type:"MultiLineString",coordinates:t},e,n)}K(fn,"multiLineString");function mn(t,e,n={}){return Le({type:"MultiPoint",coordinates:t},e,n)}K(mn,"multiPoint");function cn(t,e,n={}){return Le({type:"MultiPolygon",coordinates:t},e,n)}K(cn,"multiPolygon");function Ir(t,e,n={}){return Le({type:"GeometryCollection",geometries:t},e,n)}K(Ir,"geometryCollection");function Or(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,e||0);return Math.round(t*n)/n}K(Or,"round");function gn(t,e="kilometers"){const n=un[e];if(!n)throw new Error(e+" units is invalid");return t*n}K(gn,"radiansToLength");function ct(t,e="kilometers"){const n=un[e];if(!n)throw new Error(e+" units is invalid");return t/n}K(ct,"lengthToRadians");function Ar(t,e){return gt(ct(t,e))}K(Ar,"lengthToDegrees");function Tr(t){let e=t%360;return e<0&&(e+=360),e}K(Tr,"bearingToAzimuth");function gt(t){return t%(2*Math.PI)*180/Math.PI}K(gt,"radiansToDegrees");function Fe(t){return t%360*Math.PI/180}K(Fe,"degreesToRadians");function Sr(t,e="kilometers",n="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return gn(ct(t,e),n)}K(Sr,"convertLength");function Fr(t,e="meters",n="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const r=Mt[e];if(!r)throw new Error("invalid original units");const o=Mt[n];if(!o)throw new Error("invalid final units");return t/r*o}K(Fr,"convertArea");function Oe(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}K(Oe,"isNumber");function qr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}K(qr,"isObject");function Br(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!Oe(e))throw new Error("bbox must only contain numbers")})}K(Br,"validateBBox");function Nr(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}K(Nr,"validateId");var zr=Object.defineProperty,Ee=(t,e)=>zr(t,"name",{value:e,configurable:!0});function it(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}Ee(it,"getCoord");function Gr(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}Ee(Gr,"getCoords");function dn(t){if(t.length>1&&Oe(t[0])&&Oe(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return dn(t[0]);throw new Error("coordinates must only contain numbers")}Ee(dn,"containsNumber");function Dr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}Ee(Dr,"geojsonType");function Hr(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}Ee(Hr,"featureOf");function Rr(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(const r of t.features){if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}Ee(Rr,"collectionOf");function Ur(t){return t.type==="Feature"?t.geometry:t}Ee(Ur,"getGeom");function Jr(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}Ee(Jr,"getType");var Kr=Object.defineProperty,_n=(t,e)=>Kr(t,"name",{value:e,configurable:!0});function dt(t,e,n={}){if(n.final===!0)return pn(t,e);const r=it(t),o=it(e),l=Fe(r[0]),i=Fe(o[0]),a=Fe(r[1]),s=Fe(o[1]),m=Math.sin(i-l)*Math.cos(s),c=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(i-l);return gt(Math.atan2(m,c))}_n(dt,"bearing");function pn(t,e){let n=dt(e,t);return n=(n+180)%360,n}_n(pn,"calculateFinalBearing");var Wr=dt;function Pt(t,e,n){const r=t.slice();return r[33]=e[n],r[34]=e,r[35]=n,r}function It(t,e,n){const r=t.slice();return r[36]=e[n],r[37]=e,r[35]=n,r}function Vr(t){let e,n=lo(t[35])+"",r;return{c(){e=x("span"),r=W(n),this.h()},l(o){e=ee(o,"SPAN",{class:!0});var l=oe(e);r=V(l,n),l.forEach(h),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"color","#4472c4"),Q(e,"background-color","white")},m(o,l){C(o,e,l),ce(e,r)},p:Ve,d(o){o&&h(e)}}}function Ot(t){let e,n,r;function o(s){t[16](s,t[36])}function l(){return t[17](t[35])}function i(){return t[18](t[35])}let a={draggable:!0,$$slots:{default:[Vr]},$$scope:{ctx:t}};return t[36].point!==void 0&&(a.lngLat=t[36].point),e=new De({props:a}),Y.push(()=>re(e,"lngLat",o)),e.$on("dragend",l),e.$on("click",i),{c(){F(e.$$.fragment)},l(s){q(e.$$.fragment,s)},m(s,m){B(e,s,m),r=!0},p(s,m){t=s;const c={};m[1]&128&&(c.$$scope={dirty:m,ctx:t}),!n&&m[0]&7&&(n=!0,c.lngLat=t[36].point,ne(()=>n=!1)),e.$set(c)},i(s){r||(v(e.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),r=!1},d(s){N(e,s)}}}function Xr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(h),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score]),Q(e,"opacity",t[33].kind=="walking & wheeling"?"0%":"100%")},m(n,r){C(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score]),r[0]&7&&Q(e,"opacity",n[33].kind=="walking & wheeling"?"0%":"100%")},d(n){n&&h(e)}}}function Zr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(h),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score])},m(n,r){C(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score])},d(n){n&&h(e)}}}function Qr(t){let e;return{c(){e=x("span"),this.h()},l(n){e=ee(n,"SPAN",{class:!0}),oe(e).forEach(h),this.h()},h(){Ne(e,"class","dot svelte-1qktznf"),Q(e,"background-color",t[5][t[33].score]),Q(e,"opacity","0%")},m(n,r){C(n,e,r)},p(n,r){r[0]&7&&Q(e,"background-color",n[5][n[33].score])},d(n){n&&h(e)}}}function At(t){let e,n,r,o,l,i,a,s,m;function c(f){t[19](f,t[33])}function d(){return t[20](t[35])}function u(){return t[21](t[35])}let L={draggable:!0,$$slots:{default:[Xr]},$$scope:{ctx:t}};t[33].point1!==void 0&&(L.lngLat=t[33].point1),e=new De({props:L}),Y.push(()=>re(e,"lngLat",c)),e.$on("dragend",d),e.$on("click",u);function O(f){t[22](f,t[33])}function P(){return t[23](t[35])}function D(){return t[24](t[35])}let g={draggable:!0,$$slots:{default:[Zr]},$$scope:{ctx:t}};t[33].point2!==void 0&&(g.lngLat=t[33].point2),o=new De({props:g}),Y.push(()=>re(o,"lngLat",O)),o.$on("dragend",P),o.$on("click",D);function p(f){t[25](f,t[33])}function j(){return t[26](t[35])}function S(){return t[27](t[35])}let b={draggable:!0,$$slots:{default:[Qr]},$$scope:{ctx:t}};return t[33].point3!==void 0&&(b.lngLat=t[33].point3),a=new De({props:b}),Y.push(()=>re(a,"lngLat",p)),a.$on("dragend",j),a.$on("click",S),{c(){F(e.$$.fragment),r=H(),F(o.$$.fragment),i=H(),F(a.$$.fragment)},l(f){q(e.$$.fragment,f),r=R(f),q(o.$$.fragment,f),i=R(f),q(a.$$.fragment,f)},m(f,M){B(e,f,M),C(f,r,M),B(o,f,M),C(f,i,M),B(a,f,M),m=!0},p(f,M){t=f;const z={};M[0]&7|M[1]&128&&(z.$$scope={dirty:M,ctx:t}),!n&&M[0]&7&&(n=!0,z.lngLat=t[33].point1,ne(()=>n=!1)),e.$set(z);const G={};M[0]&7|M[1]&128&&(G.$$scope={dirty:M,ctx:t}),!l&&M[0]&7&&(l=!0,G.lngLat=t[33].point2,ne(()=>l=!1)),o.$set(G);const T={};M[0]&7|M[1]&128&&(T.$$scope={dirty:M,ctx:t}),!s&&M[0]&7&&(s=!0,T.lngLat=t[33].point3,ne(()=>s=!1)),a.$set(T)},i(f){m||(v(e.$$.fragment,f),v(o.$$.fragment,f),v(a.$$.fragment,f),m=!0)},o(f){$(e.$$.fragment,f),$(o.$$.fragment,f),$(a.$$.fragment,f),m=!1},d(f){f&&(h(r),h(i)),N(e,f),N(o,f),N(a,f)}}}function Yr(t){let e=(t[32].name||"Untitled movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){C(r,n,o)},p(r,o){o[1]&2&&e!==(e=(r[32].name||"Untitled movement")+"")&&ve(n,e)},d(r){r&&h(n)}}}function xr(t){let e,n;return e=new xt({props:{$$slots:{default:[Yr,({props:r})=>({32:r}),({props:r})=>[0,r?2:0]]},$$scope:{ctx:t}}}),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o[1]&130&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function eo(t){let e=(t[32].name||"Untitled movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){C(r,n,o)},p(r,o){o[1]&2&&e!==(e=(r[32].name||"Untitled movement")+"")&&ve(n,e)},d(r){r&&h(n)}}}function to(t){let e,n;return e=new xt({props:{$$slots:{default:[eo,({props:r})=>({32:r}),({props:r})=>[0,r?2:0]]},$$scope:{ctx:t}}}),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o[1]&130&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function no(t){let e,n,r,o,l,i;return e=new nt({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":wt(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[xr]},$$scope:{ctx:t}}}),e.$on("click",t[8]),r=new nt({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":wt(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[to]},$$scope:{ctx:t}}}),r.$on("click",t[8]),l=new Vn({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"â¬†","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){F(e.$$.fragment),n=H(),F(r.$$.fragment),o=H(),F(l.$$.fragment)},l(a){q(e.$$.fragment,a),n=R(a),q(r.$$.fragment,a),o=R(a),q(l.$$.fragment,a)},m(a,s){B(e,a,s),C(a,n,s),B(r,a,s),C(a,o,s),B(l,a,s),i=!0},p(a,s){const m={};s[1]&128&&(m.$$scope={dirty:s,ctx:a}),e.$set(m);const c={};s[1]&128&&(c.$$scope={dirty:s,ctx:a}),r.$set(c)},i(a){i||(v(e.$$.fragment,a),v(r.$$.fragment,a),v(l.$$.fragment,a),i=!0)},o(a){$(e.$$.fragment,a),$(r.$$.fragment,a),$(l.$$.fragment,a),i=!1},d(a){a&&(h(n),h(o)),N(e,a),N(r,a),N(l,a)}}}function ro(t){let e,n,r,o;return e=new nt({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),r=new On({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){F(e.$$.fragment),n=H(),F(r.$$.fragment)},l(l){q(e.$$.fragment,l),n=R(l),q(r.$$.fragment,l)},m(l,i){B(e,l,i),C(l,n,i),B(r,l,i),o=!0},p:Ve,i(l){o||(v(e.$$.fragment,l),v(r.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),o=!1},d(l){l&&h(n),N(e,l),N(r,l)}}}function oo(t){let e,n,r,o,l,i,a,s,m,c;e=new Pn({}),e.$on("click",t[7]);let d=pe(t[2].jat[t[0]][t[1]].arms),u=[];for(let g=0;g<d.length;g+=1)u[g]=Ot(It(t,d,g));const L=g=>$(u[g],1,1,()=>{u[g]=null});let O=pe(t[2].jat[t[0]][t[1]].movements),P=[];for(let g=0;g<O.length;g+=1)P[g]=At(Pt(t,O,g));const D=g=>$(P[g],1,1,()=>{P[g]=null});return l=new vt({props:{data:t[9](t[2]),$$slots:{default:[no]},$$scope:{ctx:t}}}),a=new vt({props:{data:t[4],$$slots:{default:[ro]},$$scope:{ctx:t}}}),m=new In({props:{map:t[3]}}),{c(){F(e.$$.fragment),n=H();for(let g=0;g<u.length;g+=1)u[g].c();r=H();for(let g=0;g<P.length;g+=1)P[g].c();o=H(),F(l.$$.fragment),i=H(),F(a.$$.fragment),s=H(),F(m.$$.fragment)},l(g){q(e.$$.fragment,g),n=R(g);for(let p=0;p<u.length;p+=1)u[p].l(g);r=R(g);for(let p=0;p<P.length;p+=1)P[p].l(g);o=R(g),q(l.$$.fragment,g),i=R(g),q(a.$$.fragment,g),s=R(g),q(m.$$.fragment,g)},m(g,p){B(e,g,p),C(g,n,p);for(let j=0;j<u.length;j+=1)u[j]&&u[j].m(g,p);C(g,r,p);for(let j=0;j<P.length;j+=1)P[j]&&P[j].m(g,p);C(g,o,p),B(l,g,p),C(g,i,p),B(a,g,p),C(g,s,p),B(m,g,p),c=!0},p(g,p){if(p[0]&71){d=pe(g[2].jat[g[0]][g[1]].arms);let f;for(f=0;f<d.length;f+=1){const M=It(g,d,f);u[f]?(u[f].p(M,p),v(u[f],1)):(u[f]=Ot(M),u[f].c(),v(u[f],1),u[f].m(r.parentNode,r))}for(se(),f=d.length;f<u.length;f+=1)L(f);ue()}if(p[0]&103){O=pe(g[2].jat[g[0]][g[1]].movements);let f;for(f=0;f<O.length;f+=1){const M=Pt(g,O,f);P[f]?(P[f].p(M,p),v(P[f],1)):(P[f]=At(M),P[f].c(),v(P[f],1),P[f].m(o.parentNode,o))}for(se(),f=O.length;f<P.length;f+=1)D(f);ue()}const j={};p[0]&4&&(j.data=g[9](g[2])),p[1]&128&&(j.$$scope={dirty:p,ctx:g}),l.$set(j);const S={};p[0]&16&&(S.data=g[4]),p[1]&128&&(S.$$scope={dirty:p,ctx:g}),a.$set(S);const b={};p[0]&8&&(b.map=g[3]),m.$set(b)},i(g){if(!c){v(e.$$.fragment,g);for(let p=0;p<d.length;p+=1)v(u[p]);for(let p=0;p<O.length;p+=1)v(P[p]);v(l.$$.fragment,g),v(a.$$.fragment,g),v(m.$$.fragment,g),c=!0}},o(g){$(e.$$.fragment,g),u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)$(u[p]);P=P.filter(Boolean);for(let p=0;p<P.length;p+=1)$(P[p]);$(l.$$.fragment,g),$(a.$$.fragment,g),$(m.$$.fragment,g),c=!1},d(g){g&&(h(n),h(r),h(o),h(i),h(s)),N(e,g),Be(u,g),Be(P,g),N(l,g),N(a,g),N(m,g)}}}function io(t){let e,n,r;function o(i){t[28](i)}let l={$$slots:{default:[oo]},$$scope:{ctx:t}};return t[3]!==void 0&&(l.map=t[3]),e=new En({props:l}),Y.push(()=>re(e,"map",o)),{c(){F(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,a){B(e,i,a),r=!0},p(i,a){const s={};a[0]&31|a[1]&128&&(s.$$scope={dirty:a,ctx:i}),!n&&a[0]&8&&(n=!0,s.map=i[3],ne(()=>n=!1)),e.$set(s)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){N(e,i)}}}function Tt(t,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:t.point}}}function lo(t){return String.fromCharCode(t+65)}function ao(t,e,n){let r,o;ye(t,X,w=>n(2,o=w));let{junctionIdx:l}=e,{stage:i}=e,{newKind:a}=e,{editing:s}=e,{hoveringSidebar:m}=e,{streetviewOn:c}=e,d,u={0:Ge.red.background,1:Ge.amber.background,2:Ge.green.background,X:Ge.critical.background};function L(w,U,ae){let te={type:"FeatureCollection",features:[]},ie=U??ae;return ie!=null&&(ie.kind=="arm"?te.features.push(Tt(w.jat[l][i].arms[ie.idx],ie.idx)):te.features.push(p(w.jat[l][i].movements[ie.idx],ie.idx))),te}function O(w){n(10,s=w),n(11,m=null)}function P(w){if(!c){for(let U of d.queryRenderedFeatures(w.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(s!=null){n(10,s=null);return}a=="arm"?(qe(X,o.jat[l][i].arms=[...o.jat[l][i].arms,{point:w.detail.lngLat.toArray(),name:""}],o),n(10,s={kind:"arm",idx:o.jat[l][i].arms.length-1})):(qe(X,o.jat[l][i].movements=[...o.jat[l][i].movements,{point1:w.detail.lngLat.toArray(),point2:Ct(w.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Ct(w.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],o),n(10,s={kind:"movement",idx:o.jat[l][i].movements.length-1})),n(11,m=null)}}function D(w){O({kind:"movement",idx:w.detail.features[0].id})}Jt(()=>{S(!1)});function g(w){let U={type:"FeatureCollection",features:w.jat[l][i].movements.map((ae,te)=>p(ae,te))};for(let ae of w.jat[l][i].movements)if(U.features.push(j(ae,U.features.length)),ae.kind=="walking & wheeling"){let te={...ae,point1:ae.point3,point3:ae.point1};U.features.push(j(te,U.features.length))}for(let ae of w.jat[l][i].arms)U.features.push(Tt(ae,U.features.length));return U}function p(w,U){return{type:"Feature",id:U,properties:{name:w.name,kind:w.kind,color:u[w.score]},geometry:{type:"LineString",coordinates:[w.point1,w.point2,w.point3]}}}function j(w,U){return{type:"Feature",id:U,properties:{kind:w.kind,color:u[w.score],angle:Wr(w.point2,w.point3)},geometry:{type:"Point",coordinates:w.point3}}}function S(w){let U=g(o);U.features.length>0&&d.fitBounds(Mn(U),{padding:20,animate:w})}function b(){return d}function f(w,U){t.$$.not_equal(U.point,w)&&(U.point=w,X.set(o))}const M=w=>O({kind:"arm",idx:w}),z=w=>O({kind:"arm",idx:w});function G(w,U){t.$$.not_equal(U.point1,w)&&(U.point1=w,X.set(o))}const T=w=>O({kind:"movement",idx:w}),A=w=>O({kind:"movement",idx:w});function E(w,U){t.$$.not_equal(U.point2,w)&&(U.point2=w,X.set(o))}const _=w=>O({kind:"movement",idx:w}),y=w=>O({kind:"movement",idx:w});function Z(w,U){t.$$.not_equal(U.point3,w)&&(U.point3=w,X.set(o))}const le=w=>O({kind:"movement",idx:w}),I=w=>O({kind:"movement",idx:w});function ge(w){d=w,n(3,d)}return t.$$set=w=>{"junctionIdx"in w&&n(0,l=w.junctionIdx),"stage"in w&&n(1,i=w.stage),"newKind"in w&&n(12,a=w.newKind),"editing"in w&&n(10,s=w.editing),"hoveringSidebar"in w&&n(11,m=w.hoveringSidebar),"streetviewOn"in w&&n(13,c=w.streetviewOn)},t.$$.update=()=>{t.$$.dirty[0]&3076&&n(4,r=L(o,s,m))},[l,i,o,d,r,u,O,P,D,g,s,m,a,c,S,b,f,M,z,G,T,A,E,_,y,Z,le,I,ge]}class so extends we{constructor(e){super(),ke(this,e,ao,io,he,{junctionIdx:0,stage:1,newKind:12,editing:10,hoveringSidebar:11,streetviewOn:13,zoom:14,getMap:15},null,[-1,-1])}get zoom(){return this.$$.ctx[14]}get getMap(){return this.$$.ctx[15]}}function uo(t){let e,n,r,o,l,i,a,s,m,c,d,u;function L(b){t[5](b)}let O={label:"Name"};t[3].jat[t[0]][t[1]].movements[t[2]].name!==void 0&&(O.value=t[3].jat[t[0]][t[1]].movements[t[2]].name),e=new lt({props:O}),Y.push(()=>re(e,"value",L));function P(b){t[6](b)}let D={legend:"Movement",choices:Yt(["cycling","walking & wheeling"]),inlineSmall:!0};t[3].jat[t[0]][t[1]].movements[t[2]].kind!==void 0&&(D.value=t[3].jat[t[0]][t[1]].movements[t[2]].kind),o=new Zt({props:D}),Y.push(()=>re(o,"value",P));function g(b){t[7](b)}let p={label:"Score",choices:t[4]};t[3].jat[t[0]][t[1]].movements[t[2]].score!==void 0&&(p.value=t[3].jat[t[0]][t[1]].movements[t[2]].score),a=new Bn({props:p}),Y.push(()=>re(a,"value",g));function j(b){t[8](b)}let S={label:"Comments"};return t[3].jat[t[0]][t[1]].movements[t[2]].notes!==void 0&&(S.value=t[3].jat[t[0]][t[1]].movements[t[2]].notes),c=new Qt({props:S}),Y.push(()=>re(c,"value",j)),{c(){F(e.$$.fragment),r=H(),F(o.$$.fragment),i=H(),F(a.$$.fragment),m=H(),F(c.$$.fragment)},l(b){q(e.$$.fragment,b),r=R(b),q(o.$$.fragment,b),i=R(b),q(a.$$.fragment,b),m=R(b),q(c.$$.fragment,b)},m(b,f){B(e,b,f),C(b,r,f),B(o,b,f),C(b,i,f),B(a,b,f),C(b,m,f),B(c,b,f),u=!0},p(b,[f]){const M={};!n&&f&15&&(n=!0,M.value=b[3].jat[b[0]][b[1]].movements[b[2]].name,ne(()=>n=!1)),e.$set(M);const z={};!l&&f&15&&(l=!0,z.value=b[3].jat[b[0]][b[1]].movements[b[2]].kind,ne(()=>l=!1)),o.$set(z);const G={};!s&&f&15&&(s=!0,G.value=b[3].jat[b[0]][b[1]].movements[b[2]].score,ne(()=>s=!1)),a.$set(G);const T={};!d&&f&15&&(d=!0,T.value=b[3].jat[b[0]][b[1]].movements[b[2]].notes,ne(()=>d=!1)),c.$set(T)},i(b){u||(v(e.$$.fragment,b),v(o.$$.fragment,b),v(a.$$.fragment,b),v(c.$$.fragment,b),u=!0)},o(b){$(e.$$.fragment,b),$(o.$$.fragment,b),$(a.$$.fragment,b),$(c.$$.fragment,b),u=!1},d(b){b&&(h(r),h(i),h(m)),N(e,b),N(o,b),N(a,b),N(c,b)}}}function fo(t,e,n){let r;ye(t,X,u=>n(3,r=u));let{junctionIdx:o}=e,{stage:l}=e,{idx:i}=e;Yt(["cycling","walking & wheeling"]);let a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(u){t.$$.not_equal(r.jat[o][l].movements[i].name,u)&&(r.jat[o][l].movements[i].name=u,X.set(r))}function m(u){t.$$.not_equal(r.jat[o][l].movements[i].kind,u)&&(r.jat[o][l].movements[i].kind=u,X.set(r))}function c(u){t.$$.not_equal(r.jat[o][l].movements[i].score,u)&&(r.jat[o][l].movements[i].score=u,X.set(r))}function d(u){t.$$.not_equal(r.jat[o][l].movements[i].notes,u)&&(r.jat[o][l].movements[i].notes=u,X.set(r))}return t.$$set=u=>{"junctionIdx"in u&&n(0,o=u.junctionIdx),"stage"in u&&n(1,l=u.stage),"idx"in u&&n(2,i=u.idx)},[o,l,i,r,a,s,m,c,d]}class mo extends we{constructor(e){super(),ke(this,e,fo,uo,he,{junctionIdx:0,stage:1,idx:2})}}const{window:co}=Cn;function St(t,e,n){const r=t.slice();return r[27]=e[n],r[29]=n,r}function Ft(t,e,n){const r=t.slice();return r[30]=e[n],r[29]=n,r}function go(t){let e,n,r,o,l,i,a,s;e=new qn({props:{$$slots:{default:[po]},$$scope:{ctx:t}}}),e.$on("click",t[23]),r=new Kt({props:{$$slots:{default:[ho]},$$scope:{ctx:t}}}),r.$on("click",t[10]);const m=[yo,bo],c=[];function d(u,L){return u[3].kind=="movement"?0:1}return l=d(t),i=c[l]=m[l](t),{c(){F(e.$$.fragment),n=H(),F(r.$$.fragment),o=H(),i.c(),a=_e()},l(u){q(e.$$.fragment,u),n=R(u),q(r.$$.fragment,u),o=R(u),i.l(u),a=_e()},m(u,L){B(e,u,L),C(u,n,L),B(r,u,L),C(u,o,L),c[l].m(u,L),C(u,a,L),s=!0},p(u,L){const O={};L[1]&2&&(O.$$scope={dirty:L,ctx:u}),e.$set(O);const P={};L[1]&2&&(P.$$scope={dirty:L,ctx:u}),r.$set(P);let D=l;l=d(u),l===D?c[l].p(u,L):(se(),$(c[D],1,1,()=>{c[D]=null}),ue(),i=c[l],i?i.p(u,L):(i=c[l]=m[l](u),i.c()),v(i,1),i.m(a.parentNode,a))},i(u){s||(v(e.$$.fragment,u),v(r.$$.fragment,u),v(i),s=!0)},o(u){$(e.$$.fragment,u),$(r.$$.fragment,u),$(i),s=!1},d(u){u&&(h(n),h(o),h(a)),N(e,u),N(r,u),c[l].d(u)}}}function _o(t){let e,n,r,o,l,i,a="Arms",s,m,c,d,u,L="Movements",O,P,D,g,p;e=new Fn({props:{label:"Tools",$$slots:{default:[wo]},$$scope:{ctx:t}}});function j(_){t[16](_)}let S={legend:"Add to map",choices:[["arm","Arm"],["movement","Movement"]],inlineSmall:!0};t[2]!==void 0&&(S.value=t[2]),r=new Zt({props:S}),Y.push(()=>re(r,"value",j));let b=pe(t[7].jat[t[0]][t[1]].arms),f=[];for(let _=0;_<b.length;_+=1)f[_]=Bt(Ft(t,b,_));const M=_=>$(f[_],1,1,()=>{f[_]=null});let z=t[7].jat[t[0]][t[8]].arms.length>0&&Nt(t),G=pe(t[7].jat[t[0]][t[1]].movements),T=[];for(let _=0;_<G.length;_+=1)T[_]=zt(St(t,G,_));const A=_=>$(T[_],1,1,()=>{T[_]=null});let E=t[7].jat[t[0]][t[1]].movements.length>0&&Gt(t);return{c(){F(e.$$.fragment),n=H(),F(r.$$.fragment),l=H(),i=x("h3"),i.textContent=a,s=H(),m=x("ul");for(let _=0;_<f.length;_+=1)f[_].c();c=H(),z&&z.c(),d=H(),u=x("h3"),u.textContent=L,O=H(),P=x("ol");for(let _=0;_<T.length;_+=1)T[_].c();D=H(),E&&E.c(),g=_e()},l(_){q(e.$$.fragment,_),n=R(_),q(r.$$.fragment,_),l=R(_),i=ee(_,"H3",{"data-svelte-h":!0}),yt(i)!=="svelte-ld74qb"&&(i.textContent=a),s=R(_),m=ee(_,"UL",{});var y=oe(m);for(let le=0;le<f.length;le+=1)f[le].l(y);y.forEach(h),c=R(_),z&&z.l(_),d=R(_),u=ee(_,"H3",{"data-svelte-h":!0}),yt(u)!=="svelte-1dc52s8"&&(u.textContent=L),O=R(_),P=ee(_,"OL",{});var Z=oe(P);for(let le=0;le<T.length;le+=1)T[le].l(Z);Z.forEach(h),D=R(_),E&&E.l(_),g=_e()},m(_,y){B(e,_,y),C(_,n,y),B(r,_,y),C(_,l,y),C(_,i,y),C(_,s,y),C(_,m,y);for(let Z=0;Z<f.length;Z+=1)f[Z]&&f[Z].m(m,null);C(_,c,y),z&&z.m(_,y),C(_,d,y),C(_,u,y),C(_,O,y),C(_,P,y);for(let Z=0;Z<T.length;Z+=1)T[Z]&&T[Z].m(P,null);C(_,D,y),E&&E.m(_,y),C(_,g,y),p=!0},p(_,y){const Z={};y[0]&96|y[1]&2&&(Z.$$scope={dirty:y,ctx:_}),e.$set(Z);const le={};if(!o&&y[0]&4&&(o=!0,le.value=_[2],ne(()=>o=!1)),r.$set(le),y[0]&659){b=pe(_[7].jat[_[0]][_[1]].arms);let I;for(I=0;I<b.length;I+=1){const ge=Ft(_,b,I);f[I]?(f[I].p(ge,y),v(f[I],1)):(f[I]=Bt(ge),f[I].c(),v(f[I],1),f[I].m(m,null))}for(se(),I=b.length;I<f.length;I+=1)M(I);ue()}if(_[7].jat[_[0]][_[8]].arms.length>0?z?(z.p(_,y),y[0]&129&&v(z,1)):(z=Nt(_),z.c(),v(z,1),z.m(d.parentNode,d)):z&&(se(),$(z,1,1,()=>{z=null}),ue()),y[0]&659){G=pe(_[7].jat[_[0]][_[1]].movements);let I;for(I=0;I<G.length;I+=1){const ge=St(_,G,I);T[I]?(T[I].p(ge,y),v(T[I],1)):(T[I]=zt(ge),T[I].c(),v(T[I],1),T[I].m(P,null))}for(se(),I=G.length;I<T.length;I+=1)A(I);ue()}_[7].jat[_[0]][_[1]].movements.length>0?E?E.p(_,y):(E=Gt(_),E.c(),E.m(g.parentNode,g)):E&&(E.d(1),E=null)},i(_){if(!p){v(e.$$.fragment,_),v(r.$$.fragment,_);for(let y=0;y<b.length;y+=1)v(f[y]);v(z);for(let y=0;y<G.length;y+=1)v(T[y]);p=!0}},o(_){$(e.$$.fragment,_),$(r.$$.fragment,_),f=f.filter(Boolean);for(let y=0;y<f.length;y+=1)$(f[y]);$(z),T=T.filter(Boolean);for(let y=0;y<T.length;y+=1)$(T[y]);p=!1},d(_){_&&(h(n),h(l),h(i),h(s),h(m),h(c),h(d),h(u),h(O),h(P),h(D),h(g)),N(e,_),N(r,_),Be(f,_),z&&z.d(_),Be(T,_),E&&E.d(_)}}}function po(t){let e;return{c(){e=W("Save")},l(n){e=V(n,"Save")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function ho(t){let e;return{c(){e=W("Delete")},l(n){e=V(n,"Delete")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function bo(t){let e,n,r;function o(i){t[24](i)}let l={label:"Arm Name"};return t[7].jat[t[0]][t[1]].arms[t[3].idx].name!==void 0&&(l.value=t[7].jat[t[0]][t[1]].arms[t[3].idx].name),e=new lt({props:l}),Y.push(()=>re(e,"value",o)),{c(){F(e.$$.fragment)},l(i){q(e.$$.fragment,i)},m(i,a){B(e,i,a),r=!0},p(i,a){const s={};!n&&a[0]&139&&(n=!0,s.value=i[7].jat[i[0]][i[1]].arms[i[3].idx].name,ne(()=>n=!1)),e.$set(s)},i(i){r||(v(e.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),r=!1},d(i){N(e,i)}}}function yo(t){let e,n;return e=new mo({props:{junctionIdx:t[0],stage:t[1],idx:t[3].idx}}),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o[0]&1&&(l.junctionIdx=r[0]),o[0]&2&&(l.stage=r[1]),o[0]&8&&(l.idx=r[3].idx),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function vo(t){let e;return{c(){e=W("Zoom to fit")},l(n){e=V(n,"Zoom to fit")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function qt(t){var i;let e,n,r;function o(a){t[15](a)}let l={map:(i=t[6])==null?void 0:i.getMap()};return t[5]!==void 0&&(l.enabled=t[5]),e=new Sn({props:l}),Y.push(()=>re(e,"enabled",o)),{c(){F(e.$$.fragment)},l(a){q(e.$$.fragment,a)},m(a,s){B(e,a,s),r=!0},p(a,s){var c;const m={};s[0]&64&&(m.map=(c=a[6])==null?void 0:c.getMap()),!n&&s[0]&32&&(n=!0,m.enabled=a[5],ne(()=>n=!1)),e.$set(m)},i(a){r||(v(e.$$.fragment,a),r=!0)},o(a){$(e.$$.fragment,a),r=!1},d(a){N(e,a)}}}function wo(t){var d;let e,n,r,o,l,i,a=(d=t[6])==null?void 0:d.getMap(),s,m;e=new be({props:{$$slots:{default:[vo]},$$scope:{ctx:t}}}),e.$on("click",t[14]),r=new An({}),l=new Tn({});let c=a&&qt(t);return{c(){F(e.$$.fragment),n=H(),F(r.$$.fragment),o=H(),F(l.$$.fragment),i=H(),c&&c.c(),s=_e()},l(u){q(e.$$.fragment,u),n=R(u),q(r.$$.fragment,u),o=R(u),q(l.$$.fragment,u),i=R(u),c&&c.l(u),s=_e()},m(u,L){B(e,u,L),C(u,n,L),B(r,u,L),C(u,o,L),B(l,u,L),C(u,i,L),c&&c.m(u,L),C(u,s,L),m=!0},p(u,L){var P;const O={};L[1]&2&&(O.$$scope={dirty:L,ctx:u}),e.$set(O),L[0]&64&&(a=(P=u[6])==null?void 0:P.getMap()),a?c?(c.p(u,L),L[0]&64&&v(c,1)):(c=qt(u),c.c(),v(c,1),c.m(s.parentNode,s)):c&&(se(),$(c,1,1,()=>{c=null}),ue())},i(u){m||(v(e.$$.fragment,u),v(r.$$.fragment,u),v(l.$$.fragment,u),v(c),m=!0)},o(u){$(e.$$.fragment,u),$(r.$$.fragment,u),$(l.$$.fragment,u),$(c),m=!1},d(u){u&&(h(n),h(o),h(i),h(s)),N(e,u),N(r,u),N(l,u),c&&c.d(u)}}}function ko(t){let e=Eo(t[29])+"",n,r,o=(t[30].name||"Unnamed arm")+"",l;return{c(){n=W(e),r=W(" - "),l=W(o)},l(i){n=V(i,e),r=V(i," - "),l=V(i,o)},m(i,a){C(i,n,a),C(i,r,a),C(i,l,a)},p(i,a){a[0]&131&&o!==(o=(i[30].name||"Unnamed arm")+"")&&ve(l,o)},d(i){i&&(h(n),h(r),h(l))}}}function Bt(t){let e,n,r,o;function l(){return t[17](t[29])}function i(){return t[18](t[29])}return n=new be({props:{$$slots:{default:[ko]},$$scope:{ctx:t}}}),n.$on("click",l),n.$on("mouseenter",i),n.$on("mouseleave",t[19]),{c(){e=x("li"),F(n.$$.fragment),r=H()},l(a){e=ee(a,"LI",{});var s=oe(e);q(n.$$.fragment,s),r=R(s),s.forEach(h)},m(a,s){C(a,e,s),B(n,e,null),ce(e,r),o=!0},p(a,s){t=a;const m={};s[0]&131|s[1]&2&&(m.$$scope={dirty:s,ctx:t}),n.$set(m)},i(a){o||(v(n.$$.fragment,a),o=!0)},o(a){$(n.$$.fragment,a),o=!1},d(a){a&&h(e),N(n)}}}function Nt(t){let e,n;return e=new be({props:{$$slots:{default:[$o]},$$scope:{ctx:t}}}),e.$on("click",t[12]),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o[1]&2&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function $o(t){let e,n;return{c(){e=W("Copy arms from "),n=W(t[8])},l(r){e=V(r,"Copy arms from "),n=V(r,t[8])},m(r,o){C(r,e,o),C(r,n,o)},p:Ve,d(r){r&&(h(e),h(n))}}}function jo(t){let e=(t[27].name||"Unnamed movement")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){C(r,n,o)},p(r,o){o[0]&131&&e!==(e=(r[27].name||"Unnamed movement")+"")&&ve(n,e)},d(r){r&&h(n)}}}function zt(t){let e,n,r,o;function l(){return t[20](t[29])}function i(){return t[21](t[29])}return n=new be({props:{$$slots:{default:[jo]},$$scope:{ctx:t}}}),n.$on("click",l),n.$on("mouseenter",i),n.$on("mouseleave",t[22]),{c(){e=x("li"),F(n.$$.fragment),r=H()},l(a){e=ee(a,"LI",{});var s=oe(e);q(n.$$.fragment,s),r=R(s),s.forEach(h)},m(a,s){C(a,e,s),B(n,e,null),ce(e,r),o=!0},p(a,s){t=a;const m={};s[0]&131|s[1]&2&&(m.$$scope={dirty:s,ctx:t}),n.$set(m)},i(a){o||(v(n.$$.fragment,a),o=!0)},o(a){$(n.$$.fragment,a),o=!1},d(a){a&&h(e),N(n)}}}function Gt(t){let e,n,r=Dt(t[7].jat[t[0]][t[1]])+"",o,l;return{c(){e=x("p"),n=W("Total JAT score: "),o=W(r),l=W("%")},l(i){e=ee(i,"P",{});var a=oe(e);n=V(a,"Total JAT score: "),o=V(a,r),l=V(a,"%"),a.forEach(h)},m(i,a){C(i,e,a),ce(e,n),ce(e,o),ce(e,l)},p(i,a){a[0]&131&&r!==(r=Dt(i[7].jat[i[0]][i[1]])+"")&&ve(o,r)},d(i){i&&h(e)}}}function Lo(t){let e,n,r,o,l,i,a,s,m,c,d,u,L,O;function P(f){t[13](f)}let D={label:"Commentary / Notes"};t[7].jat[t[0]][t[1]].notes!==void 0&&(D.value=t[7].jat[t[0]][t[1]].notes),e=new Qt({props:D}),Y.push(()=>re(e,"value",P));const g=[_o,go],p=[];function j(f,M){return f[3]==null?0:1}i=j(t),a=p[i]=g[i](t);function S(f){t[26](f)}let b={junctionIdx:t[0],stage:t[1],newKind:t[2],hoveringSidebar:t[4],streetviewOn:t[5]};return t[3]!==void 0&&(b.editing=t[3]),c=new so({props:b}),t[25](c),Y.push(()=>re(c,"editing",S)),{c(){F(e.$$.fragment),r=H(),o=x("div"),l=x("div"),a.c(),s=H(),m=x("div"),F(c.$$.fragment),this.h()},l(f){q(e.$$.fragment,f),r=R(f),o=ee(f,"DIV",{style:!0});var M=oe(o);l=ee(M,"DIV",{style:!0});var z=oe(l);a.l(z),z.forEach(h),s=R(M),m=ee(M,"DIV",{style:!0});var G=oe(m);q(c.$$.fragment,G),G.forEach(h),M.forEach(h),this.h()},h(){Q(l,"width","30%"),Q(l,"overflow-y","scroll"),Q(l,"padding","10px"),Q(l,"border","1px solid black"),Q(m,"position","relative"),Q(m,"width","100%"),Q(o,"display","flex"),Q(o,"height","80vh")},m(f,M){B(e,f,M),C(f,r,M),C(f,o,M),ce(o,l),p[i].m(l,null),ce(o,s),ce(o,m),B(c,m,null),u=!0,L||(O=kn(co,"keydown",t[11]),L=!0)},p(f,M){const z={};!n&&M[0]&131&&(n=!0,z.value=f[7].jat[f[0]][f[1]].notes,ne(()=>n=!1)),e.$set(z);let G=i;i=j(f),i===G?p[i].p(f,M):(se(),$(p[G],1,1,()=>{p[G]=null}),ue(),a=p[i],a?a.p(f,M):(a=p[i]=g[i](f),a.c()),v(a,1),a.m(l,null));const T={};M[0]&1&&(T.junctionIdx=f[0]),M[0]&2&&(T.stage=f[1]),M[0]&4&&(T.newKind=f[2]),M[0]&16&&(T.hoveringSidebar=f[4]),M[0]&32&&(T.streetviewOn=f[5]),!d&&M[0]&8&&(d=!0,T.editing=f[3],ne(()=>d=!1)),c.$set(T)},i(f){u||(v(e.$$.fragment,f),v(a),v(c.$$.fragment,f),u=!0)},o(f){$(e.$$.fragment,f),$(a),$(c.$$.fragment,f),u=!1},d(f){f&&(h(r),h(o)),N(e,f),p[i].d(),t[25](null),N(c),L=!1,O()}}}function Eo(t){return String.fromCharCode(t+65)}function Dt(t){let e=0,n=0;for(let r of t.movements)e+={0:0,1:1,2:2,X:0}[r.score],n+=2;return e/n*100}function Co(t,e,n){let r;ye(t,X,y=>n(7,r=y));let{junctionIdx:o}=e,{stage:l}=e,i=l=="existing"?"proposed":"existing",a="arm",s=null,m=null,c=!1,d=null;function u(y){n(3,s=y),n(4,m=null)}function L(){window.confirm(`Delete this ${s.kind}?`)&&(s.kind=="movement"?(r.jat[o][l].movements.splice(s.idx,1),X.set(r)):(r.jat[o][l].arms.splice(s.idx,1),X.set(r)),n(3,s=null))}function O(y){s!=null&&y.key=="Escape"?(y.stopPropagation(),n(3,s=null)):s!=null&&y.key=="Delete"&&L()}function P(){r.jat[o][l].arms.length>0&&!window.confirm("Overwrite arms?")||(qe(X,r.jat[o][l].arms=JSON.parse(JSON.stringify(r.jat[o][i].arms)),r),X.set(r))}function D(y){t.$$.not_equal(r.jat[o][l].notes,y)&&(r.jat[o][l].notes=y,X.set(r))}const g=()=>d==null?void 0:d.zoom(!0);function p(y){c=y,n(5,c)}function j(y){a=y,n(2,a)}const S=y=>u({kind:"arm",idx:y}),b=y=>n(4,m={kind:"arm",idx:y}),f=()=>n(4,m=null),M=y=>u({kind:"movement",idx:y}),z=y=>n(4,m={kind:"movement",idx:y}),G=()=>n(4,m=null),T=()=>n(3,s=null);function A(y){t.$$.not_equal(r.jat[o][l].arms[s.idx].name,y)&&(r.jat[o][l].arms[s.idx].name=y,X.set(r))}function E(y){Y[y?"unshift":"push"](()=>{d=y,n(6,d)})}function _(y){s=y,n(3,s)}return t.$$set=y=>{"junctionIdx"in y&&n(0,o=y.junctionIdx),"stage"in y&&n(1,l=y.stage)},[o,l,a,s,m,c,d,r,i,u,L,O,P,D,g,p,j,S,b,f,M,z,G,T,A,E,_]}class Mo extends we{constructor(e){super(),ke(this,e,Co,Lo,he,{junctionIdx:0,stage:1},null,[-1,-1])}}function Ht(t,e,n){const r=t.slice();return r[10]=e[n],r[12]=n,r}function Po(t){let e,n=(t[1].jat[t[0].idx].name||"Untitled junction")+"",r,o,l=t[0].stage+"",i,a,s,m,c,d,u,L=t[0].stage,O,P;s=new $n({props:{$$slots:{default:[Bo]},$$scope:{ctx:t}}});function D(j){t[9](j)}let g={label:"Junction Name"};t[1].jat[t[0].idx].name!==void 0&&(g.value=t[1].jat[t[0].idx].name),c=new lt({props:g}),Y.push(()=>re(c,"value",D));let p=Rt(t);return{c(){e=x("h2"),r=W(n),o=W(" - "),i=W(l),a=H(),F(s.$$.fragment),m=H(),F(c.$$.fragment),u=H(),p.c(),O=_e()},l(j){e=ee(j,"H2",{});var S=oe(e);r=V(S,n),o=V(S," - "),i=V(S,l),S.forEach(h),a=R(j),q(s.$$.fragment,j),m=R(j),q(c.$$.fragment,j),u=R(j),p.l(j),O=_e()},m(j,S){C(j,e,S),ce(e,r),ce(e,o),ce(e,i),C(j,a,S),B(s,j,S),C(j,m,S),B(c,j,S),C(j,u,S),p.m(j,S),C(j,O,S),P=!0},p(j,S){(!P||S&3)&&n!==(n=(j[1].jat[j[0].idx].name||"Untitled junction")+"")&&ve(r,n),(!P||S&1)&&l!==(l=j[0].stage+"")&&ve(i,l);const b={};S&8193&&(b.$$scope={dirty:S,ctx:j}),s.$set(b);const f={};!d&&S&3&&(d=!0,f.value=j[1].jat[j[0].idx].name,ne(()=>d=!1)),c.$set(f),S&1&&he(L,L=j[0].stage)?(se(),$(p,1,1,Ve),ue(),p=Rt(j),p.c(),v(p,1),p.m(O.parentNode,O)):p.p(j,S)},i(j){P||(v(s.$$.fragment,j),v(c.$$.fragment,j),v(p),P=!0)},o(j){$(s.$$.fragment,j),$(c.$$.fragment,j),$(p),P=!1},d(j){j&&(h(e),h(a),h(m),h(u),h(O)),N(s,j),N(c,j),p.d(j)}}}function Io(t){let e,n,r,o;e=new be({props:{$$slots:{default:[No]},$$scope:{ctx:t}}}),e.$on("click",t[2]);let l=pe(t[1].jat),i=[];for(let s=0;s<l.length;s+=1)i[s]=Ut(Ht(t,l,s));const a=s=>$(i[s],1,1,()=>{i[s]=null});return{c(){F(e.$$.fragment),n=H(),r=x("ol");for(let s=0;s<i.length;s+=1)i[s].c()},l(s){q(e.$$.fragment,s),n=R(s),r=ee(s,"OL",{});var m=oe(r);for(let c=0;c<i.length;c+=1)i[c].l(m);m.forEach(h)},m(s,m){B(e,s,m),C(s,n,m),C(s,r,m);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,null);o=!0},p(s,m){const c={};if(m&8192&&(c.$$scope={dirty:m,ctx:s}),e.$set(c),m&3){l=pe(s[1].jat);let d;for(d=0;d<l.length;d+=1){const u=Ht(s,l,d);i[d]?(i[d].p(u,m),v(i[d],1)):(i[d]=Ut(u),i[d].c(),v(i[d],1),i[d].m(r,null))}for(se(),d=l.length;d<i.length;d+=1)a(d);ue()}},i(s){if(!o){v(e.$$.fragment,s);for(let m=0;m<l.length;m+=1)v(i[m]);o=!0}},o(s){$(e.$$.fragment,s),i=i.filter(Boolean);for(let m=0;m<i.length;m+=1)$(i[m]);o=!1},d(s){s&&(h(n),h(r)),N(e,s),Be(i,s)}}}function Oo(t){let e;return{c(){e=W("Back to all junctions")},l(n){e=V(n,"Back to all junctions")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function Ao(t){let e,n;return e=new be({props:{$$slots:{default:[So]},$$scope:{ctx:t}}}),e.$on("click",t[7]),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o&8192&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function To(t){let e,n;return e=new be({props:{$$slots:{default:[Fo]},$$scope:{ctx:t}}}),e.$on("click",t[6]),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o&8192&&(l.$$scope={dirty:o,ctx:r}),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function So(t){let e;return{c(){e=W("Edit Proposed")},l(n){e=V(n,"Edit Proposed")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function Fo(t){let e;return{c(){e=W("Edit Existing")},l(n){e=V(n,"Edit Existing")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function qo(t){let e;return{c(){e=W("Delete")},l(n){e=V(n,"Delete")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function Bo(t){let e,n,r,o,l,i,a;e=new be({props:{$$slots:{default:[Oo]},$$scope:{ctx:t}}}),e.$on("click",t[5]);const s=[To,Ao],m=[];function c(d,u){return d[0].stage=="proposed"?0:1}return r=c(t),o=m[r]=s[r](t),i=new Kt({props:{$$slots:{default:[qo]},$$scope:{ctx:t}}}),i.$on("click",t[8]),{c(){F(e.$$.fragment),n=H(),o.c(),l=H(),F(i.$$.fragment)},l(d){q(e.$$.fragment,d),n=R(d),o.l(d),l=R(d),q(i.$$.fragment,d)},m(d,u){B(e,d,u),C(d,n,u),m[r].m(d,u),C(d,l,u),B(i,d,u),a=!0},p(d,u){const L={};u&8192&&(L.$$scope={dirty:u,ctx:d}),e.$set(L);let O=r;r=c(d),r===O?m[r].p(d,u):(se(),$(m[O],1,1,()=>{m[O]=null}),ue(),o=m[r],o?o.p(d,u):(o=m[r]=s[r](d),o.c()),v(o,1),o.m(l.parentNode,l));const P={};u&8192&&(P.$$scope={dirty:u,ctx:d}),i.$set(P)},i(d){a||(v(e.$$.fragment,d),v(o),v(i.$$.fragment,d),a=!0)},o(d){$(e.$$.fragment,d),$(o),$(i.$$.fragment,d),a=!1},d(d){d&&(h(n),h(l)),N(e,d),m[r].d(d),N(i,d)}}}function Rt(t){let e,n;return e=new Mo({props:{junctionIdx:t[0].idx,stage:t[0].stage}}),{c(){F(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){B(e,r,o),n=!0},p(r,o){const l={};o&1&&(l.junctionIdx=r[0].idx),o&1&&(l.stage=r[0].stage),e.$set(l)},i(r){n||(v(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){N(e,r)}}}function No(t){let e;return{c(){e=W("Add new junction")},l(n){e=V(n,"Add new junction")},m(n,r){C(n,e,r)},d(n){n&&h(e)}}}function zo(t){let e=(t[10].name||"Untitled junction")+"",n;return{c(){n=W(e)},l(r){n=V(r,e)},m(r,o){C(r,n,o)},p(r,o){o&2&&e!==(e=(r[10].name||"Untitled junction")+"")&&ve(n,e)},d(r){r&&h(n)}}}function Ut(t){let e,n,r,o;function l(){return t[4](t[12])}return n=new be({props:{$$slots:{default:[zo]},$$scope:{ctx:t}}}),n.$on("click",l),{c(){e=x("li"),F(n.$$.fragment),r=H()},l(i){e=ee(i,"LI",{});var a=oe(e);q(n.$$.fragment,a),r=R(a),a.forEach(h)},m(i,a){C(i,e,a),B(n,e,null),ce(e,r),o=!0},p(i,a){t=i;const s={};a&8194&&(s.$$scope={dirty:a,ctx:t}),n.$set(s)},i(i){o||(v(n.$$.fragment,i),o=!0)},o(i){$(n.$$.fragment,i),o=!1},d(i){i&&h(e),N(n)}}}function Go(t){let e,n,r,o;const l=[Io,Po],i=[];function a(s,m){return s[0].kind=="list"?0:s[0].kind=="edit"?1:-1}return~(e=a(t))&&(n=i[e]=l[e](t)),{c(){n&&n.c(),r=_e()},l(s){n&&n.l(s),r=_e()},m(s,m){~e&&i[e].m(s,m),C(s,r,m),o=!0},p(s,[m]){let c=e;e=a(s),e===c?~e&&i[e].p(s,m):(n&&(se(),$(i[c],1,1,()=>{i[c]=null}),ue()),~e?(n=i[e],n?n.p(s,m):(n=i[e]=l[e](s),n.c()),v(n,1),n.m(r.parentNode,r)):n=null)},i(s){o||(v(n),o=!0)},o(s){$(n),o=!1},d(s){s&&h(r),~e&&i[e].d(s)}}}function tt(t){if(t.kind=="list")throw new Error("Unreachable case");return t.idx}function Do(t,e,n){let r;ye(t,X,L=>n(1,r=L));let o={kind:"list"};function l(){qe(X,r.jat=[...r.jat,{name:"",existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}],r),n(0,o={kind:"edit",idx:r.jat.length-1,stage:"existing"})}function i(L){window.confirm("Delete this junction?")&&(r.jat.splice(L,1),X.set(r),n(0,o={kind:"list"}))}const a=L=>n(0,o={kind:"edit",idx:L,stage:"existing"}),s=()=>n(0,o={kind:"list"}),m=()=>n(0,o={kind:"edit",idx:tt(o),stage:"existing"}),c=()=>n(0,o={kind:"edit",idx:tt(o),stage:"proposed"}),d=()=>i(tt(o));function u(L){t.$$.not_equal(r.jat[o.idx].name,L)&&(r.jat[o.idx].name=L,X.set(r))}return[o,r,l,i,a,s,m,c,d,u]}class ii extends we{constructor(e){super(),ke(this,e,Do,Go,he,{})}}export{ii as component};
