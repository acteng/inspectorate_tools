import{s as Re,R as Me,S as Le,b as D,f as k,r as A,i as O,h as I,n as ae,v as Q,e as K,a as G,c as Z,g as T,w as V,x as X,q as ze,k as ft,U as mt,a8 as pt,t as Je,d as We,M as gt,E as Fe}from"../chunks/scheduler.d-ZThAIN.js";import{S as Ve,i as Ke,e as Y,c as C,a as M,m as L,t as w,f as ye,b as E,d as F,g as $e}from"../chunks/index.BKLGIcjh.js";import{e as le}from"../chunks/each.5I2k8VTY.js";import{e as Ze,M as ht,G as dt}from"../chunks/MapLibreMap.DuDvZOOd.js";import{p as Se}from"../chunks/index.BLLpiyps.js";import{c as U}from"../chunks/colors.B_b9C5xD.js";import{S as yt,W as $t}from"../chunks/WarningButton.CXBTrJR0.js";import{S as qe}from"../chunks/Select.DYDTV9Cm.js";import{T as bt}from"../chunks/TextInput.DLFUCrlZ.js";import{B as _t,G as wt,b as vt,a as Et,M as Be}from"../chunks/GeoreferenceLayer.D0DIL4N8.js";import{L as Ie}from"../chunks/LineLayer.DEzB09ds.js";import{s as x}from"../chunks/data.BqZIXh0k.js";var kt=Object.defineProperty,$=(t,e)=>kt(t,"name",{value:e,configurable:!0}),Pt=class{constructor(e){this.direction=!1,this.compareProperties=!0;var r,n,o;this.precision=10**-((r=e==null?void 0:e.precision)!=null?r:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,r){if(e.type!==r.type||!ne(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(e,r);case"GeometryCollection":return this.compareGeometryCollection(e,r);case"Feature":return this.compareFeature(e,r);case"FeatureCollection":return this.compareFeatureCollection(e,r);default:if(e.type.startsWith("Multi")){const n=ge(e),o=ge(r);return n.every(i=>o.some(a=>this.compare(i,a)))}}return!1}compareCoord(e,r){return e.length===r.length&&e.every((n,o)=>Math.abs(n-r[o])<this.precision)}compareLine(e,r,n=0,o=!1){if(!ne(e,r))return!1;const i=e;let a=r;if(o&&!this.compareCoord(i[0],a[0])){const f=this.fixStartIndex(a,i);if(f)a=f;else return!1}const u=this.compareCoord(i[n],a[n]);return this.direction||u?this.comparePath(i,a):this.compareCoord(i[n],a[a.length-(1+n)])?this.comparePath(i.slice().reverse(),a):!1}fixStartIndex(e,r){let n,o=-1;for(let i=0;i<e.length;i++)if(this.compareCoord(e[i],r[0])){o=i;break}return o>=0&&(n=[].concat(e.slice(o,e.length),e.slice(1,o+1))),n}comparePath(e,r){return e.every((n,o)=>this.compareCoord(n,r[o]))}comparePolygon(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),o=r.coordinates.slice(1,r.coordinates.length);return n.every(i=>o.some(a=>this.compareLine(i,a,1,!0)))}return!1}compareGeometryCollection(e,r){return ne(e.geometries,r.geometries)&&this.compareBBox(e,r)&&e.geometries.every((n,o)=>this.compare(n,r.geometries[o]))}compareFeature(e,r){return e.id===r.id&&(this.compareProperties?Ze(e.properties,r.properties):!0)&&this.compareBBox(e,r)&&this.compare(e.geometry,r.geometry)}compareFeatureCollection(e,r){return ne(e.features,r.features)&&this.compareBBox(e,r)&&e.features.every((n,o)=>this.compare(n,r.features[o]))}compareBBox(e,r){return!e.bbox&&!r.bbox||(e.bbox&&r.bbox?this.compareCoord(e.bbox,r.bbox):!1)}};$(Pt,"GeojsonEquality");function ne(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}$(ne,"sameLength");function ge(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}$(ge,"explode");var S=63710088e-1,Ue={centimeters:S*100,centimetres:S*100,degrees:360/(2*Math.PI),feet:S*3.28084,inches:S*39.37,kilometers:S/1e3,kilometres:S/1e3,meters:S,metres:S,miles:S/1609.344,millimeters:S*1e3,millimetres:S*1e3,nauticalmiles:S/1852,radians:1,yards:S*1.0936},Ge={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function R(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}$(R,"feature");function At(t,e,r={}){switch(t){case"Point":return ce(e).geometry;case"LineString":return _e(e).geometry;case"Polygon":return be(e).geometry;case"MultiPoint":return Qe(e).geometry;case"MultiLineString":return He(e).geometry;case"MultiPolygon":return Xe(e).geometry;default:throw new Error(t+" is invalid")}}$(At,"geometry");function ce(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ee(t[0])||!ee(t[1]))throw new Error("coordinates must contain numbers");return R({type:"Point",coordinates:t},e,r)}$(ce,"point");function Ct(t,e,r={}){return fe(t.map(n=>ce(n,e)),r)}$(Ct,"points");function be(t,e,r={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<o[o.length-1].length;i++)if(o[o.length-1][i]!==o[0][i])throw new Error("First and last Position are not equivalent.")}return R({type:"Polygon",coordinates:t},e,r)}$(be,"polygon");function Mt(t,e,r={}){return fe(t.map(n=>be(n,e)),r)}$(Mt,"polygons");function _e(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return R({type:"LineString",coordinates:t},e,r)}$(_e,"lineString");function Lt(t,e,r={}){return fe(t.map(n=>_e(n,e)),r)}$(Lt,"lineStrings");function fe(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}$(fe,"featureCollection");function He(t,e,r={}){return R({type:"MultiLineString",coordinates:t},e,r)}$(He,"multiLineString");function Qe(t,e,r={}){return R({type:"MultiPoint",coordinates:t},e,r)}$(Qe,"multiPoint");function Xe(t,e,r={}){return R({type:"MultiPolygon",coordinates:t},e,r)}$(Xe,"multiPolygon");function Ft(t,e,r={}){return R({type:"GeometryCollection",geometries:t},e,r)}$(Ft,"geometryCollection");function St(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,e||0);return Math.round(t*r)/r}$(St,"round");function Ye(t,e="kilometers"){const r=Ue[e];if(!r)throw new Error(e+" units is invalid");return t*r}$(Ye,"radiansToLength");function me(t,e="kilometers"){const r=Ue[e];if(!r)throw new Error(e+" units is invalid");return t/r}$(me,"lengthToRadians");function qt(t,e){return ue(me(t,e))}$(qt,"lengthToDegrees");function Bt(t){let e=t%360;return e<0&&(e+=360),e}$(Bt,"bearingToAzimuth");function ue(t){return t%(2*Math.PI)*180/Math.PI}$(ue,"radiansToDegrees");function se(t){return t%360*Math.PI/180}$(se,"degreesToRadians");function It(t,e="kilometers",r="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return Ye(me(t,e),r)}$(It,"convertLength");function Gt(t,e="meters",r="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const n=Ge[e];if(!n)throw new Error("invalid original units");const o=Ge[r];if(!o)throw new Error("invalid final units");return t/n*o}$(Gt,"convertArea");function ee(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}$(ee,"isNumber");function Tt(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}$(Tt,"isObject");function Ot(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!ee(e))throw new Error("bbox must only contain numbers")})}$(Ot,"validateBBox");function jt(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}$(jt,"validateId");var Nt=Object.defineProperty,z=(t,e)=>Nt(t,"name",{value:e,configurable:!0});function et(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}z(et,"getCoord");function Dt(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}z(Dt,"getCoords");function tt(t){if(t.length>1&&ee(t[0])&&ee(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return tt(t[0]);throw new Error("coordinates must only contain numbers")}z(tt,"containsNumber");function xt(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)}z(xt,"geojsonType");function Rt(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}z(Rt,"featureOf");function zt(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of t.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+n.geometry.type)}}z(zt,"collectionOf");function Jt(t){return t.type==="Feature"?t.geometry:t}z(Jt,"getGeom");function Wt(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}z(Wt,"getType");var Vt=Object.defineProperty,Kt=(t,e)=>Vt(t,"name",{value:e,configurable:!0});function rt(t,e,r,n={}){const o=et(t),i=se(o[0]),a=se(o[1]),u=se(r),f=me(e,n.units),s=Math.asin(Math.sin(a)*Math.cos(f)+Math.cos(a)*Math.sin(f)*Math.cos(u)),m=i+Math.atan2(Math.sin(u)*Math.sin(f)*Math.cos(a),Math.cos(f)-Math.sin(a)*Math.sin(s)),c=ue(m),d=ue(s);return ce([c,d],n.properties)}Kt(rt,"destination");var Zt=rt,Ut=Object.defineProperty,b=(t,e)=>Ut(t,"name",{value:e,configurable:!0}),Ht=class{constructor(e){this.direction=!1,this.compareProperties=!0;var r,n,o;this.precision=10**-((r=e==null?void 0:e.precision)!=null?r:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(o=e==null?void 0:e.compareProperties)!=null?o:!0}compare(e,r){if(e.type!==r.type||!oe(e,r))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,r.coordinates);case"LineString":return this.compareLine(e.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(e,r);case"GeometryCollection":return this.compareGeometryCollection(e,r);case"Feature":return this.compareFeature(e,r);case"FeatureCollection":return this.compareFeatureCollection(e,r);default:if(e.type.startsWith("Multi")){const n=he(e),o=he(r);return n.every(i=>o.some(a=>this.compare(i,a)))}}return!1}compareCoord(e,r){return e.length===r.length&&e.every((n,o)=>Math.abs(n-r[o])<this.precision)}compareLine(e,r,n=0,o=!1){if(!oe(e,r))return!1;const i=e;let a=r;if(o&&!this.compareCoord(i[0],a[0])){const f=this.fixStartIndex(a,i);if(f)a=f;else return!1}const u=this.compareCoord(i[n],a[n]);return this.direction||u?this.comparePath(i,a):this.compareCoord(i[n],a[a.length-(1+n)])?this.comparePath(i.slice().reverse(),a):!1}fixStartIndex(e,r){let n,o=-1;for(let i=0;i<e.length;i++)if(this.compareCoord(e[i],r[0])){o=i;break}return o>=0&&(n=[].concat(e.slice(o,e.length),e.slice(1,o+1))),n}comparePath(e,r){return e.every((n,o)=>this.compareCoord(n,r[o]))}comparePolygon(e,r){if(this.compareLine(e.coordinates[0],r.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),o=r.coordinates.slice(1,r.coordinates.length);return n.every(i=>o.some(a=>this.compareLine(i,a,1,!0)))}return!1}compareGeometryCollection(e,r){return oe(e.geometries,r.geometries)&&this.compareBBox(e,r)&&e.geometries.every((n,o)=>this.compare(n,r.geometries[o]))}compareFeature(e,r){return e.id===r.id&&(this.compareProperties?Ze(e.properties,r.properties):!0)&&this.compareBBox(e,r)&&this.compare(e.geometry,r.geometry)}compareFeatureCollection(e,r){return oe(e.features,r.features)&&this.compareBBox(e,r)&&e.features.every((n,o)=>this.compare(n,r.features[o]))}compareBBox(e,r){return!e.bbox&&!r.bbox||(e.bbox&&r.bbox?this.compareCoord(e.bbox,r.bbox):!1)}};b(Ht,"GeojsonEquality");function oe(t,e){return t.coordinates?t.coordinates.length===e.coordinates.length:t.length===e.length}b(oe,"sameLength");function he(t){return t.coordinates.map(e=>({type:t.type.replace("Multi",""),coordinates:e}))}b(he,"explode");var q=63710088e-1,nt={centimeters:q*100,centimetres:q*100,degrees:360/(2*Math.PI),feet:q*3.28084,inches:q*39.37,kilometers:q/1e3,kilometres:q/1e3,meters:q,metres:q,miles:q/1609.344,millimeters:q*1e3,millimetres:q*1e3,nauticalmiles:q/1852,radians:1,yards:q*1.0936},Te={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function J(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}b(J,"feature");function Qt(t,e,r={}){switch(t){case"Point":return we(e).geometry;case"LineString":return Ee(e).geometry;case"Polygon":return ve(e).geometry;case"MultiPoint":return it(e).geometry;case"MultiLineString":return ot(e).geometry;case"MultiPolygon":return at(e).geometry;default:throw new Error(t+" is invalid")}}b(Qt,"geometry");function we(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!te(t[0])||!te(t[1]))throw new Error("coordinates must contain numbers");return J({type:"Point",coordinates:t},e,r)}b(we,"point");function Xt(t,e,r={}){return pe(t.map(n=>we(n,e)),r)}b(Xt,"points");function ve(t,e,r={}){for(const o of t){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<o[o.length-1].length;i++)if(o[o.length-1][i]!==o[0][i])throw new Error("First and last Position are not equivalent.")}return J({type:"Polygon",coordinates:t},e,r)}b(ve,"polygon");function Yt(t,e,r={}){return pe(t.map(n=>ve(n,e)),r)}b(Yt,"polygons");function Ee(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return J({type:"LineString",coordinates:t},e,r)}b(Ee,"lineString");function er(t,e,r={}){return pe(t.map(n=>Ee(n,e)),r)}b(er,"lineStrings");function pe(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}b(pe,"featureCollection");function ot(t,e,r={}){return J({type:"MultiLineString",coordinates:t},e,r)}b(ot,"multiLineString");function it(t,e,r={}){return J({type:"MultiPoint",coordinates:t},e,r)}b(it,"multiPoint");function at(t,e,r={}){return J({type:"MultiPolygon",coordinates:t},e,r)}b(at,"multiPolygon");function tr(t,e,r={}){return J({type:"GeometryCollection",geometries:t},e,r)}b(tr,"geometryCollection");function rr(t,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const r=Math.pow(10,e||0);return Math.round(t*r)/r}b(rr,"round");function st(t,e="kilometers"){const r=nt[e];if(!r)throw new Error(e+" units is invalid");return t*r}b(st,"radiansToLength");function ke(t,e="kilometers"){const r=nt[e];if(!r)throw new Error(e+" units is invalid");return t/r}b(ke,"lengthToRadians");function nr(t,e){return Pe(ke(t,e))}b(nr,"lengthToDegrees");function or(t){let e=t%360;return e<0&&(e+=360),e}b(or,"bearingToAzimuth");function Pe(t){return t%(2*Math.PI)*180/Math.PI}b(Pe,"radiansToDegrees");function ie(t){return t%360*Math.PI/180}b(ie,"degreesToRadians");function ir(t,e="kilometers",r="kilometers"){if(!(t>=0))throw new Error("length must be a positive number");return st(ke(t,e),r)}b(ir,"convertLength");function ar(t,e="meters",r="kilometers"){if(!(t>=0))throw new Error("area must be a positive number");const n=Te[e];if(!n)throw new Error("invalid original units");const o=Te[r];if(!o)throw new Error("invalid final units");return t/n*o}b(ar,"convertArea");function te(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}b(te,"isNumber");function sr(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}b(sr,"isObject");function lr(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(e=>{if(!te(e))throw new Error("bbox must only contain numbers")})}b(lr,"validateBBox");function ur(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}b(ur,"validateId");var cr=Object.defineProperty,W=(t,e)=>cr(t,"name",{value:e,configurable:!0});function de(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}W(de,"getCoord");function fr(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}W(fr,"getCoords");function lt(t){if(t.length>1&&te(t[0])&&te(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return lt(t[0]);throw new Error("coordinates must only contain numbers")}W(lt,"containsNumber");function mr(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)}W(mr,"geojsonType");function pr(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}W(pr,"featureOf");function gr(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of t.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+n.geometry.type)}}W(gr,"collectionOf");function hr(t){return t.type==="Feature"?t.geometry:t}W(hr,"getGeom");function dr(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}W(dr,"getType");var yr=Object.defineProperty,ut=(t,e)=>yr(t,"name",{value:e,configurable:!0});function Ae(t,e,r={}){if(r.final===!0)return ct(t,e);const n=de(t),o=de(e),i=ie(n[0]),a=ie(o[0]),u=ie(n[1]),f=ie(o[1]),s=Math.sin(a-i)*Math.cos(f),m=Math.cos(u)*Math.sin(f)-Math.sin(u)*Math.cos(f)*Math.cos(a-i);return Pe(Math.atan2(s,m))}ut(Ae,"bearing");function ct(t,e){let r=Ae(e,t);return r=(r+180)%360,r}ut(ct,"calculateFinalBearing");var Oe=Ae;function $r(t){let e,r,n;return{c(){e=Me("svg"),r=Me("polygon"),this.h()},l(o){e=Le(o,"svg",{width:!0,height:!0,xmlns:!0});var i=D(e);r=Le(i,"polygon",{points:!0,fill:!0,transform:!0,class:!0}),D(r).forEach(k),i.forEach(k),this.h()},h(){A(r,"points","15,0 0,30 30,30"),A(r,"fill",t[0]),A(r,"transform",n="rotate("+t[1]+", 15, 15)"),A(r,"class","svelte-vih5bq"),A(e,"width","30"),A(e,"height","30"),A(e,"xmlns","http://www.w3.org/2000/svg")},m(o,i){O(o,e,i),I(e,r)},p(o,[i]){i&1&&A(r,"fill",o[0]),i&2&&n!==(n="rotate("+o[1]+", 15, 15)")&&A(r,"transform",n)},i:ae,o:ae,d(o){o&&k(e)}}}function br(t,e,r){let{color:n}=e,{angle:o}=e;return t.$$set=i=>{"color"in i&&r(0,n=i.color),"angle"in i&&r(1,o=i.angle)},[n,o]}class _r extends Ve{constructor(e){super(),Ke(this,e,br,$r,Re,{color:0,angle:1})}}function je(t,e,r){const n=t.slice();return n[16]=e[r],n[17]=e,n[18]=r,n}function Ne(t,e,r){const n=t.slice();return n[16]=e[r],n[19]=e,n[20]=r,n}function wr(t){let e;return{c(){e=Je("Zoom to fit")},l(r){e=We(r,"Zoom to fit")},m(r,n){O(r,e,n)},d(r){r&&k(e)}}}function vr(t){let e;return{c(){e=Je("Delete")},l(r){e=We(r,"Delete")},m(r,n){O(r,e,n)},d(r){r&&k(e)}}}function De(t){let e,r,n,o,i,a,u,f,s,m,c,d,y;function P(p){t[8](p,t[16])}let B={label:"Name"};t[16].name!==void 0&&(B.value=t[16].name),r=new bt({props:B}),Q.push(()=>Y(r,"value",P));function _(p){t[9](p,t[16])}let H={label:"Kind",choices:t[2]};t[16].kind!==void 0&&(H.value=t[16].kind),i=new qe({props:H}),Q.push(()=>Y(i,"value",_));function re(p){t[10](p,t[16])}let g={label:"Color",choices:t[3]};t[16].color!==void 0&&(g.value=t[16].color),f=new qe({props:g}),Q.push(()=>Y(f,"value",re));function l(){return t[11](t[20])}return c=new $t({props:{$$slots:{default:[vr]},$$scope:{ctx:t}}}),c.$on("click",l),{c(){e=K("li"),C(r.$$.fragment),o=G(),C(i.$$.fragment),u=G(),C(f.$$.fragment),m=G(),C(c.$$.fragment),d=G()},l(p){e=Z(p,"LI",{});var h=D(e);M(r.$$.fragment,h),o=T(h),M(i.$$.fragment,h),u=T(h),M(f.$$.fragment,h),m=T(h),M(c.$$.fragment,h),d=T(h),h.forEach(k)},m(p,h){O(p,e,h),L(r,e,null),I(e,o),L(i,e,null),I(e,u),L(f,e,null),I(e,m),L(c,e,null),I(e,d),y=!0},p(p,h){t=p;const j={};!n&&h&2&&(n=!0,j.value=t[16].name,X(()=>n=!1)),r.$set(j);const v={};!a&&h&2&&(a=!0,v.value=t[16].kind,X(()=>a=!1)),i.$set(v);const N={};!s&&h&2&&(s=!0,N.value=t[16].color,X(()=>s=!1)),f.$set(N);const Ce={};h&2097152&&(Ce.$$scope={dirty:h,ctx:t}),c.$set(Ce)},i(p){y||(w(r.$$.fragment,p),w(i.$$.fragment,p),w(f.$$.fragment,p),w(c.$$.fragment,p),y=!0)},o(p){E(r.$$.fragment,p),E(i.$$.fragment,p),E(f.$$.fragment,p),E(c.$$.fragment,p),y=!1},d(p){p&&k(e),F(r),F(i),F(f),F(c)}}}function Er(t){let e,r;return{c(){e=K("span"),this.h()},l(n){e=Z(n,"SPAN",{class:!0,style:!0}),D(e).forEach(k),this.h()},h(){A(e,"class","dot svelte-1kvjd2"),A(e,"style",r=`background-color: ${U[t[16].color].background}`)},m(n,o){O(n,e,o)},p(n,o){o&2&&r!==(r=`background-color: ${U[n[16].color].background}`)&&A(e,"style",r)},d(n){n&&k(e)}}}function kr(t){let e,r;return e=new _r({props:{color:U[t[16].color].background,angle:Oe(t[16].point1,t[16].point2)}}),{c(){C(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,o){L(e,n,o),r=!0},p(n,o){const i={};o&2&&(i.color=U[n[16].color].background),o&2&&(i.angle=Oe(n[16].point1,n[16].point2)),e.$set(i)},i(n){r||(w(e.$$.fragment,n),r=!0)},o(n){E(e.$$.fragment,n),r=!1},d(n){F(e,n)}}}function Pr(t){let e,r;return{c(){e=K("span"),this.h()},l(n){e=Z(n,"SPAN",{class:!0,style:!0}),D(e).forEach(k),this.h()},h(){A(e,"class","dot svelte-1kvjd2"),A(e,"style",r=`background-color: ${U[t[16].color].background}`)},m(n,o){O(n,e,o)},p(n,o){o&2&&r!==(r=`background-color: ${U[n[16].color].background}`)&&A(e,"style",r)},i:ae,o:ae,d(n){n&&k(e)}}}function Ar(t){let e,r,n,o;const i=[Pr,kr],a=[];function u(f,s){return f[16].kind=="pedestrian"?0:1}return e=u(t),r=a[e]=i[e](t),{c(){r.c(),n=Fe()},l(f){r.l(f),n=Fe()},m(f,s){a[e].m(f,s),O(f,n,s),o=!0},p(f,s){let m=e;e=u(f),e===m?a[e].p(f,s):($e(),E(a[m],1,1,()=>{a[m]=null}),ye(),r=a[e],r?r.p(f,s):(r=a[e]=i[e](f),r.c()),w(r,1),r.m(n.parentNode,n))},i(f){o||(w(r),o=!0)},o(f){E(r),o=!1},d(f){f&&k(n),a[e].d(f)}}}function xe(t){let e,r,n,o,i,a;function u(c){t[12](c,t[16])}let f={draggable:!0,$$slots:{default:[Er]},$$scope:{ctx:t}};t[16].point1!==void 0&&(f.lngLat=t[16].point1),e=new Be({props:f}),Q.push(()=>Y(e,"lngLat",u));function s(c){t[13](c,t[16])}let m={draggable:!0,$$slots:{default:[Ar]},$$scope:{ctx:t}};return t[16].point2!==void 0&&(m.lngLat=t[16].point2),o=new Be({props:m}),Q.push(()=>Y(o,"lngLat",s)),{c(){C(e.$$.fragment),n=G(),C(o.$$.fragment)},l(c){M(e.$$.fragment,c),n=T(c),M(o.$$.fragment,c)},m(c,d){L(e,c,d),O(c,n,d),L(o,c,d),a=!0},p(c,d){t=c;const y={};d&2097154&&(y.$$scope={dirty:d,ctx:t}),!r&&d&2&&(r=!0,y.lngLat=t[16].point1,X(()=>r=!1)),e.$set(y);const P={};d&2097154&&(P.$$scope={dirty:d,ctx:t}),!i&&d&2&&(i=!0,P.lngLat=t[16].point2,X(()=>i=!1)),o.$set(P)},i(c){a||(w(e.$$.fragment,c),w(o.$$.fragment,c),a=!0)},o(c){E(e.$$.fragment,c),E(o.$$.fragment,c),a=!1},d(c){c&&k(n),F(e,c),F(o,c)}}}function Cr(t){let e,r,n,o;return e=new Ie({props:{paint:{"line-width":6,"line-color":["get","color"]},filter:["!=",["get","kind"],"pedestrian"]}}),n=new Ie({props:{paint:{"line-width":6,"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"pedestrian"]}}),{c(){C(e.$$.fragment),r=G(),C(n.$$.fragment)},l(i){M(e.$$.fragment,i),r=T(i),M(n.$$.fragment,i)},m(i,a){L(e,i,a),O(i,r,a),L(n,i,a),o=!0},p:ae,i(i){o||(w(e.$$.fragment,i),w(n.$$.fragment,i),o=!0)},o(i){E(e.$$.fragment,i),E(n.$$.fragment,i),o=!1},d(i){i&&k(r),F(e,i),F(n,i)}}}function Mr(t){let e,r,n,o,i,a=le(t[1].jat.movements),u=[];for(let s=0;s<a.length;s+=1)u[s]=xe(je(t,a,s));const f=s=>E(u[s],1,1,()=>{u[s]=null});return r=new dt({props:{data:t[4](t[1].jat.movements),$$slots:{default:[Cr]},$$scope:{ctx:t}}}),o=new Et({props:{map:t[0]}}),{c(){for(let s=0;s<u.length;s+=1)u[s].c();e=G(),C(r.$$.fragment),n=G(),C(o.$$.fragment)},l(s){for(let m=0;m<u.length;m+=1)u[m].l(s);e=T(s),M(r.$$.fragment,s),n=T(s),M(o.$$.fragment,s)},m(s,m){for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(s,m);O(s,e,m),L(r,s,m),O(s,n,m),L(o,s,m),i=!0},p(s,m){if(m&2){a=le(s[1].jat.movements);let y;for(y=0;y<a.length;y+=1){const P=je(s,a,y);u[y]?(u[y].p(P,m),w(u[y],1)):(u[y]=xe(P),u[y].c(),w(u[y],1),u[y].m(e.parentNode,e))}for($e(),y=a.length;y<u.length;y+=1)f(y);ye()}const c={};m&2&&(c.data=s[4](s[1].jat.movements)),m&2097152&&(c.$$scope={dirty:m,ctx:s}),r.$set(c);const d={};m&1&&(d.map=s[0]),o.$set(d)},i(s){if(!i){for(let m=0;m<a.length;m+=1)w(u[m]);w(r.$$.fragment,s),w(o.$$.fragment,s),i=!0}},o(s){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)E(u[m]);E(r.$$.fragment,s),E(o.$$.fragment,s),i=!1},d(s){s&&(k(e),k(n)),ze(u,s),F(r,s),F(o,s)}}}function Lr(t){let e,r,n,o,i,a,u,f,s,m,c,d,y,P;n=new yt({props:{$$slots:{default:[wr]},$$scope:{ctx:t}}}),n.$on("click",t[7]),i=new _t({}),u=new wt({});let B=le(t[1].jat.movements),_=[];for(let l=0;l<B.length;l+=1)_[l]=De(Ne(t,B,l));const H=l=>E(_[l],1,1,()=>{_[l]=null});function re(l){t[14](l)}let g={$$slots:{default:[Mr]},$$scope:{ctx:t}};return t[0]!==void 0&&(g.map=t[0]),d=new ht({props:g}),Q.push(()=>Y(d,"map",re)),{c(){e=K("div"),r=K("div"),C(n.$$.fragment),o=G(),C(i.$$.fragment),a=G(),C(u.$$.fragment),f=G(),s=K("ol");for(let l=0;l<_.length;l+=1)_[l].c();m=G(),c=K("div"),C(d.$$.fragment),this.h()},l(l){e=Z(l,"DIV",{style:!0});var p=D(e);r=Z(p,"DIV",{style:!0});var h=D(r);M(n.$$.fragment,h),o=T(h),M(i.$$.fragment,h),a=T(h),M(u.$$.fragment,h),f=T(h),s=Z(h,"OL",{});var j=D(s);for(let N=0;N<_.length;N+=1)_[N].l(j);j.forEach(k),h.forEach(k),m=T(p),c=Z(p,"DIV",{style:!0});var v=D(c);M(d.$$.fragment,v),v.forEach(k),p.forEach(k),this.h()},h(){V(r,"width","30%"),V(r,"overflow-y","scroll"),V(r,"padding","10px"),V(c,"position","relative"),V(c,"width","100%"),V(e,"display","flex"),V(e,"height","600px")},m(l,p){O(l,e,p),I(e,r),L(n,r,null),I(r,o),L(i,r,null),I(r,a),L(u,r,null),I(r,f),I(r,s);for(let h=0;h<_.length;h+=1)_[h]&&_[h].m(s,null);I(e,m),I(e,c),L(d,c,null),P=!0},p(l,[p]){const h={};if(p&2097152&&(h.$$scope={dirty:p,ctx:l}),n.$set(h),p&46){B=le(l[1].jat.movements);let v;for(v=0;v<B.length;v+=1){const N=Ne(l,B,v);_[v]?(_[v].p(N,p),w(_[v],1)):(_[v]=De(N),_[v].c(),w(_[v],1),_[v].m(s,null))}for($e(),v=B.length;v<_.length;v+=1)H(v);ye()}const j={};p&2097155&&(j.$$scope={dirty:p,ctx:l}),!y&&p&1&&(y=!0,j.map=l[0],X(()=>y=!1)),d.$set(j)},i(l){if(!P){w(n.$$.fragment,l),w(i.$$.fragment,l),w(u.$$.fragment,l);for(let p=0;p<B.length;p+=1)w(_[p]);w(d.$$.fragment,l),P=!0}},o(l){E(n.$$.fragment,l),E(i.$$.fragment,l),E(u.$$.fragment,l),_=_.filter(Boolean);for(let p=0;p<_.length;p+=1)E(_[p]);E(d.$$.fragment,l),P=!1},d(l){l&&k(e),F(n),F(i),F(u),ze(_,l),F(d)}}}function Fr(t,e,r){let n;ft(t,x,g=>r(1,n=g));let o,i=Se(["cycling-straight","cycling-turn","pedestrian"]),a=Se(["green","amber","red","critical"]);function u(g){gt(x,n.jat.movements=[...n.jat.movements,{point1:g.lngLat.toArray(),point2:Zt(g.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling-straight",color:"green",name:"",notes:""}],n)}mt(()=>{o.on("click",u),m(!1)}),pt(()=>{o.off("click",u)});function f(g){return{type:"FeatureCollection",features:g.map(l=>({type:"Feature",properties:{kind:l.kind,color:U[l.color].background},geometry:{type:"LineString",coordinates:[l.point1,l.point2]}}))}}function s(g){n.jat.movements.splice(g,1),x.set(n)}function m(g){n.jat.movements.length>0&&o.fitBounds(vt(f(n.jat.movements)),{padding:20,animate:g})}const c=()=>m(!0);function d(g,l){t.$$.not_equal(l.name,g)&&(l.name=g,x.set(n))}function y(g,l){t.$$.not_equal(l.kind,g)&&(l.kind=g,x.set(n))}function P(g,l){t.$$.not_equal(l.color,g)&&(l.color=g,x.set(n))}const B=g=>s(g);function _(g,l){t.$$.not_equal(l.point1,g)&&(l.point1=g,x.set(n))}function H(g,l){t.$$.not_equal(l.point2,g)&&(l.point2=g,x.set(n))}function re(g){o=g,r(0,o)}return[o,n,i,a,f,s,m,c,d,y,P,B,_,H,re]}class Wr extends Ve{constructor(e){super(),Ke(this,e,Fr,Lr,Re,{})}}export{Wr as component};
