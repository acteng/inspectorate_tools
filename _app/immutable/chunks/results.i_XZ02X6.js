import{s as C}from"./index.BjDwPema.js";import{n as x}from"./data.DDFX3LQs.js";let S={Walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],"Horse Riding":[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},b={Walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},v={Walking:[0,1,3,5,6,7,8,9,10,14,15],Wheeling:[0,1,3,5,6,7,8,9,10,14,15],Cycling:[0,1,2,4,7,8,11,12,13,15]};function A(e){let t=e.summary.checkType,s=t=="street",l=t=="path",o=r("Safety",t,e.safetyCheck,null),i=[o];s?(i.push(r("Accessibility",t,e.streetCheck,[0,6])),i.push(r("Comfort",t,e.streetCheck,[7,9])),i.push(r("Directness",t,e.streetCheck,[10,15])),i.push(r("Attractiveness",t,e.streetCheck,[16,21])),i.push(r("Cohesion",t,e.streetCheck,[22,25]))):l&&(i.push(r("Accessibility",t,e.pathCheck,[0,4])),i.push(r("Comfort",t,e.pathCheck,[5,15])),i.push(r("Directness",t,e.pathCheck,[16,19])),i.push(r("Attractiveness",t,e.pathCheck,[20,24])),i.push(r("Cohesion",t,e.pathCheck,[25,29])));let c={category:"overall",existing:g(i.map(p=>p.existing)),proposed:g(i.map(p=>p.proposed))},n=[];s?(n.push(r("Social activity",t,e.streetPlacemakingCheck,[0,2])),n.push(r("Personal security",t,e.streetPlacemakingCheck,[3,5])),n.push(r("Character and legibility",t,e.streetPlacemakingCheck,[6,15])),n.push(r("Environment",t,e.streetPlacemakingCheck,[16,25]))):l&&n.push(r("Social activity",t,e.pathPlacemakingCheck,[0,2]),r("Personal security",t,e.pathPlacemakingCheck,[3,5]),r("Character and legibility",t,e.pathPlacemakingCheck,[6,9]),r("Environment",t,e.pathPlacemakingCheck,[10,18]));let h={category:"overall",existing:g(n.map(p=>p.existing)),proposed:g(n.map(p=>p.proposed))},a=[];s?a=P(e.safetyCheck,e.streetCheck,b,e.summary.checkType):l&&(a=P(e.safetyCheck,e.pathCheck,S,e.summary.checkType));let u=W(e);return{safetyCheck:o,streetCheck:s?d(o,r("",t,e.streetCheck,null)):null,pathCheck:l?d(o,r("",t,e.pathCheck,null)):null,levelOfService:i,overall:c,placemakingCategories:n,placemakingOverall:h,byMode:a,jat:u}}function r(e,t,s,l){return{category:e,existing:y(s.existingScores,e,t,l),proposed:y(s.proposedScores,e,t,l)}}function y(e,t,s,l){let o=l||[0,e.length-1],i=o[0],c=o[1]+1;return m(e.slice(i,c),t,s)}function m(e,t,s){let l=e.filter(h=>h!="N/A").length,o=1;t=="Safety"?o=3:s=="path"&&t=="Personal security"&&(o=2);let i=l*2*o,c=o*C(e.map(x)),n=c/i*100;return{numberMetrics:l,totalPossibleScore:i,score:c,scorePercent:n}}function g(e){let t=C(e.map(i=>i.numberMetrics)),s=C(e.map(i=>i.totalPossibleScore)),l=C(e.map(i=>i.score)),o=l/s*100;return{numberMetrics:t,totalPossibleScore:s,score:l,scorePercent:o}}function d(e,t){return{category:"",existing:g([e.existing,t.existing]),proposed:g([e.proposed,t.proposed])}}function I(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function P(e,t,s,l){let o=[];for(let[i,c]of Object.entries(s)){let n=v[i]||[],h={category:"Safety",existing:m(k(e.existingScores,n),"Safety",l),proposed:m(k(e.proposedScores,n),"Safety",l)},a={category:"",existing:m(k(t.existingScores,c),"",l),proposed:m(k(t.proposedScores,c),"",l)},u=d(h,a);u.category=i,o.push(u)}return o}function k(e,t){return t.map(s=>e[s])}function W(e){let t={0:0,1:1,2:2,X:0},s=[];for(let l of e.jat){let o={walkingWheeling:{existing:"",proposed:""},cycling:{existing:"",proposed:""},total:{existing:"",proposed:""}};for(let i of["existing","proposed"]){let c=0,n=0,h=0,a=0,u=0,p=0;for(let f of l[i].movements)f.kind=="walking & wheeling"?(c+=t[f.score],n+=2):(h+=t[f.score],a+=2),u+=t[f.score],p+=2;o.walkingWheeling[i]=n>0?`${c/n*100}%`:"Not Completed",o.cycling[i]=a>0?`${h/a*100}%`:"Not Comleted",o.total[i]=p>0?`${u/p*100}%`:"Not Completed"}s.push(o)}return s}export{A as g,I as n};
