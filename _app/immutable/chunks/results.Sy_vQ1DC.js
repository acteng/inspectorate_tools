import{s as f}from"./index.BBth3zyx.js";import{n as x}from"./data.CVzKtsTM.js";let S={walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],horse:[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},b={walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},v={walking:[0,1,3,5,6,7,8,9,10,14,15],wheeling:[0,1,3,5,6,7,8,9,10,14,15],cycling:[0,1,2,4,7,8,11,12,13,15]};function W(e){let i=e.summary.checkType=="street",l=e.summary.checkType=="path",n=o("Safety",e.safetyCheck,null),t=[n];i?(t.push(o("Accessibility",e.streetCheck,[0,6])),t.push(o("Comfort",e.streetCheck,[7,9])),t.push(o("Directness",e.streetCheck,[10,15])),t.push(o("Attractiveness",e.streetCheck,[16,21])),t.push(o("Cohesion",e.streetCheck,[22,25]))):l&&(t.push(o("Accessibility",e.pathCheck,[0,4])),t.push(o("Comfort",e.pathCheck,[5,15])),t.push(o("Directness",e.pathCheck,[16,19])),t.push(o("Attractiveness",e.pathCheck,[20,24])),t.push(o("Cohesion",e.pathCheck,[25,29])));let s={category:"overall",existing:u(t.map(c=>c.existing)),proposed:u(t.map(c=>c.proposed))},r=[];i?(r.push(o("Social activity",e.streetPlacemakingCheck,[0,2])),r.push(o("Personal security",e.streetPlacemakingCheck,[3,5])),r.push(o("Character and legibility",e.streetPlacemakingCheck,[6,15])),r.push(o("Environment",e.streetPlacemakingCheck,[16,25]))):l&&r.push(o("Social activity",e.pathPlacemakingCheck,[0,2]),o("Personal security",e.pathPlacemakingCheck,[3,5]),o("Character and legibility",e.pathPlacemakingCheck,[6,9]),o("Environment",e.pathPlacemakingCheck,[10,18]));let p={category:"overall",existing:u(r.map(c=>c.existing)),proposed:u(r.map(c=>c.proposed))},a=[];i?a=P(e.safetyCheck,e.streetCheck,b):l&&(a=P(e.safetyCheck,e.pathCheck,S));let h=M(e);return{safetyCheck:n,streetCheck:i?C(n,o("",e.streetCheck,null)):null,streetPlacemaking:i?o("",e.streetPlacemakingCheck,null):null,pathCheck:l?C(n,o("",e.pathCheck,null)):null,pathPlacemaking:l?o("",e.pathPlacemakingCheck,null):null,levelOfService:t,overall:s,placemakingCategories:r,placemakingOverall:p,byMode:a,jat:h}}function o(e,i,l){return{category:e,existing:d(i.existingScores,e,l),proposed:d(i.proposedScores,e,l)}}function d(e,i,l){let n=l||[0,e.length-1],t=n[0],s=n[1]+1;return g(e.slice(t,s),i)}function g(e,i){let l=e.filter(p=>p!="N/A").length,n=i=="Safety"?3:1,t=l*2*n,s=n*f(e.map(x)),r=s/t*100;return{numberMetrics:l,totalPossibleScore:t,score:s,scorePercent:r}}function u(e){let i=f(e.map(s=>s.numberMetrics)),l=f(e.map(s=>s.totalPossibleScore)),n=f(e.map(s=>s.score)),t=n/l*100;return{numberMetrics:i,totalPossibleScore:l,score:n,scorePercent:t}}function C(e,i){return{category:"",existing:u([e.existing,i.existing]),proposed:u([e.proposed,i.proposed])}}function A(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function P(e,i,l){let n=[];for(let[t,s]of Object.entries(l)){let r=v[t]||[],p={category:"Safety",existing:g(m(e.existingScores,r),"Safety"),proposed:g(m(e.proposedScores,r),"Safety")},a={category:"",existing:g(m(i.existingScores,s),""),proposed:g(m(i.proposedScores,s),"")},h=C(p,a);h.category=t,n.push(h)}return n}function m(e,i){return i.map(l=>e[l])}function M(e){let i={0:0,1:1,2:2,X:0},l=[];for(let n of e.jat){let t={walkingWheeling:{existing:"",proposed:""},cycling:{existing:"",proposed:""},total:{existing:"",proposed:""}};for(let s of["existing","proposed"]){let r=0,p=0,a=0,h=0,c=0,y=0;for(let k of n[s].movements)k.kind=="pedestrian"?(r+=i[k.score],p+=2):(a+=i[k.score],h+=2),c+=i[k.score],y+=2;t.walkingWheeling[s]=`${r/p*100}%`,t.cycling[s]=`${a/h*100}%`,t.total[s]=`${c/y*100}%`}l.push(t)}return l}export{W as g,A as n};
