import{s as C}from"./index.CQ8PTs6S.js";import{n as x}from"./data.CurHAl0u.js";let S={Walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],"Horse Riding":[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},b={Walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},v={Walking:[0,1,3,5,6,7,8,9,10,14,15],Wheeling:[0,1,3,5,6,7,8,9,10,14,15],Cycling:[0,1,2,4,7,8,11,12,13,15]};function A(e){let l=e.summary.checkType=="street",i=e.summary.checkType=="path",s=o("Safety",e.safetyCheck,null),t=[s];l?(t.push(o("Accessibility",e.streetCheck,[0,6])),t.push(o("Comfort",e.streetCheck,[7,9])),t.push(o("Directness",e.streetCheck,[10,15])),t.push(o("Attractiveness",e.streetCheck,[16,21])),t.push(o("Cohesion",e.streetCheck,[22,25]))):i&&(t.push(o("Accessibility",e.pathCheck,[0,4])),t.push(o("Comfort",e.pathCheck,[5,15])),t.push(o("Directness",e.pathCheck,[16,19])),t.push(o("Attractiveness",e.pathCheck,[20,24])),t.push(o("Cohesion",e.pathCheck,[25,29])));let n={category:"overall",existing:g(t.map(c=>c.existing)),proposed:g(t.map(c=>c.proposed))},r=[];l?(r.push(o("Social activity",e.streetPlacemakingCheck,[0,2])),r.push(o("Personal security",e.streetPlacemakingCheck,[3,5])),r.push(o("Character and legibility",e.streetPlacemakingCheck,[6,15])),r.push(o("Environment",e.streetPlacemakingCheck,[16,25]))):i&&r.push(o("Social activity",e.pathPlacemakingCheck,[0,2]),o("Personal security",e.pathPlacemakingCheck,[3,5]),o("Character and legibility",e.pathPlacemakingCheck,[6,9]),o("Environment",e.pathPlacemakingCheck,[10,18]));let p={category:"overall",existing:g(r.map(c=>c.existing)),proposed:g(r.map(c=>c.proposed))},a=[];l?a=P(e.safetyCheck,e.streetCheck,b):i&&(a=P(e.safetyCheck,e.pathCheck,S));let h=W(e);return{safetyCheck:s,streetCheck:l?d(s,o("",e.streetCheck,null)):null,streetPlacemaking:l?o("",e.streetPlacemakingCheck,null):null,pathCheck:i?d(s,o("",e.pathCheck,null)):null,pathPlacemaking:i?o("",e.pathPlacemakingCheck,null):null,levelOfService:t,overall:n,placemakingCategories:r,placemakingOverall:p,byMode:a,jat:h}}function o(e,l,i){return{category:e,existing:y(l.existingScores,e,i),proposed:y(l.proposedScores,e,i)}}function y(e,l,i){let s=i||[0,e.length-1],t=s[0],n=s[1]+1;return u(e.slice(t,n),l)}function u(e,l){let i=e.filter(p=>p!="N/A").length,s=l=="Safety"?3:1,t=i*2*s,n=s*C(e.map(x)),r=n/t*100;return{numberMetrics:i,totalPossibleScore:t,score:n,scorePercent:r}}function g(e){let l=C(e.map(n=>n.numberMetrics)),i=C(e.map(n=>n.totalPossibleScore)),s=C(e.map(n=>n.score)),t=s/i*100;return{numberMetrics:l,totalPossibleScore:i,score:s,scorePercent:t}}function d(e,l){return{category:"",existing:g([e.existing,l.existing]),proposed:g([e.proposed,l.proposed])}}function I(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function P(e,l,i){let s=[];for(let[t,n]of Object.entries(i)){let r=v[t]||[],p={category:"Safety",existing:u(m(e.existingScores,r),"Safety"),proposed:u(m(e.proposedScores,r),"Safety")},a={category:"",existing:u(m(l.existingScores,n),""),proposed:u(m(l.proposedScores,n),"")},h=d(p,a);h.category=t,s.push(h)}return s}function m(e,l){return l.map(i=>e[i])}function W(e){let l={0:0,1:1,2:2,X:0},i=[];for(let s of e.jat){let t={walkingWheeling:{existing:"",proposed:""},cycling:{existing:"",proposed:""},total:{existing:"",proposed:""}};for(let n of["existing","proposed"]){let r=0,p=0,a=0,h=0,c=0,f=0;for(let k of s[n].movements)k.kind=="walking & wheeling"?(r+=l[k.score],p+=2):(a+=l[k.score],h+=2),c+=l[k.score],f+=2;t.walkingWheeling[n]=p>0?`${r/p*100}%`:"Not Completed",t.cycling[n]=h>0?`${a/h*100}%`:"Not Comleted",t.total[n]=f>0?`${c/f*100}%`:"Not Completed"}i.push(t)}return i}export{A as g,I as n};
