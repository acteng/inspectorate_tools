import{s as K,l as x,e as E,a as D,c as z,b as H,g as P,f as v,r as L,w as Z,i as S,h as I,z as N,u as $,m as ee,o as te,B as ye,H as q,a8 as Xe,t as j,d as F,y as he,j as Ee,q as xe,O as $e,C as ve,p as ce,v as ne,x as me,E as Y,k as B,a9 as ze,N as T,n as pe,a7 as Oe,aa as Ne,A as Ie,Z as et,ab as tt}from"./scheduler.BV_JqZpr.js";import{S as O,i as W,t as y,b as w,c as M,a as A,m as R,d as V,e as de,g as le,f as oe}from"./index.DDJL-Wug.js";import{C as nt}from"./CollapsibleCard.UC1DOObh.js";import{S as We,W as lt}from"./WarningButton.Ck9VEuu1.js";import{L as je,a as Te,u as ot,r as at,b as it,c as rt,m as st,d as ut,e as ft,g as ct,t as mt}from"./MapLibreMap.Dv9o_FLb.js";import{v as Fe,E as dt}from"./ErrorMessage.4z_VF7LJ.js";import{e as Be}from"./each.Cp9qZMvj.js";import{B as gt}from"./ButtonGroup.CpPC8Sl4.js";import{D as _t}from"./DefaultButton.DCHkaEOp.js";import{F as ht}from"./FormElement.BCOhxKPP.js";import{w as ge}from"./entry.CUGOHFlb.js";const bt=o=>({}),De=o=>({});function kt(o){let e,n,t,l,a,r,u,f,g;const s=o[5].default,i=x(s,o,o[4],null),c=o[5].right,m=x(c,o,o[4],De);return{c(){e=E("div"),n=E("input"),t=D(),l=E("label"),i&&i.c(),a=D(),r=E("span"),m&&m.c(),this.h()},l(d){e=z(d,"DIV",{class:!0,style:!0});var _=H(e);n=z(_,"INPUT",{type:!0,class:!0,id:!0}),t=P(_),l=z(_,"LABEL",{class:!0,for:!0,title:!0});var h=H(l);i&&i.l(h),h.forEach(v),a=P(_),r=z(_,"SPAN",{style:!0});var C=H(r);m&&m.l(C),C.forEach(v),_.forEach(v),this.h()},h(){L(n,"type","checkbox"),L(n,"class","govuk-checkboxes__input"),L(n,"id",o[3]),L(l,"class","govuk-label govuk-checkboxes__label"),L(l,"for",o[3]),L(l,"title",o[1]),Z(r,"float","right"),L(e,"class","govuk-checkboxes__item"),L(e,"style",o[2])},m(d,_){S(d,e,_),I(e,n),n.checked=o[0],I(e,t),I(e,l),i&&i.m(l,null),I(e,a),I(e,r),m&&m.m(r,null),u=!0,f||(g=[N(n,"change",o[7]),N(n,"change",o[6])],f=!0)},p(d,[_]){_&1&&(n.checked=d[0]),i&&i.p&&(!u||_&16)&&$(i,s,d,d[4],u?te(s,d[4],_,null):ee(d[4]),null),(!u||_&2)&&L(l,"title",d[1]),m&&m.p&&(!u||_&16)&&$(m,c,d,d[4],u?te(c,d[4],_,bt):ee(d[4]),De)},i(d){u||(y(i,d),y(m,d),u=!0)},o(d){w(i,d),w(m,d),u=!1},d(d){d&&v(e),i&&i.d(d),m&&m.d(d),f=!1,ye(g)}}}function vt(o,e,n){let{$$slots:t={},$$scope:l}=e;const a=Xe(t);let{checked:r}=e,{hint:u=null}=e,g=a.right!==void 0?"float: none":"",s=Fe();function i(m){q.call(this,o,m)}function c(){r=this.checked,n(0,r)}return o.$$set=m=>{"checked"in m&&n(0,r=m.checked),"hint"in m&&n(1,u=m.hint),"$$scope"in m&&n(4,l=m.$$scope)},[r,u,g,s,l,t,i,c]}class yt extends O{constructor(e){super(),W(this,e,vt,kt,K,{checked:0,hint:1})}}function Pe(o,e,n){const t=o.slice();return t[10]=e[n][0],t[11]=e[n][1],t}function Me(o){let e,n,t,l,a=!1,r,u,f=o[11]+"",g,s,i,c,m,d;return c=$e(o[9][0]),{c(){e=E("div"),n=E("input"),r=D(),u=E("label"),g=j(f),i=D(),this.h()},l(_){e=z(_,"DIV",{class:!0});var h=H(e);n=z(h,"INPUT",{class:!0,id:!0,type:!0}),r=P(h),u=z(h,"LABEL",{class:!0,for:!0});var C=H(u);g=F(C,f),C.forEach(v),i=P(h),h.forEach(v),this.h()},h(){L(n,"class","govuk-radios__input"),L(n,"id",t=o[5]+o[10]),L(n,"type","radio"),n.__value=l=o[10],ve(n,n.__value),L(u,"class","govuk-label govuk-radios__label"),L(u,"for",s=o[5]+o[10]),L(e,"class","govuk-radios__item"),c.p(n)},m(_,h){S(_,e,h),I(e,n),n.checked=n.__value===o[0],I(e,r),I(e,u),I(u,g),I(e,i),m||(d=[N(n,"change",o[8]),N(n,"change",o[7])],m=!0)},p(_,h){h&4&&t!==(t=_[5]+_[10])&&L(n,"id",t),h&4&&l!==(l=_[10])&&(n.__value=l,ve(n,n.__value),a=!0),(a||h&5)&&(n.checked=n.__value===_[0]),h&4&&f!==(f=_[11]+"")&&Ee(g,f),h&4&&s!==(s=_[5]+_[10])&&L(u,"for",s)},d(_){_&&v(e),c.r(),m=!1,ye(d)}}}function pt(o){let e,n,t,l,a,r,u,f,g;r=new dt({props:{errorMessage:o[4]}});let s=Be(o[2]),i=[];for(let c=0;c<s.length;c+=1)i[c]=Me(Pe(o,s,c));return{c(){e=E("div"),n=E("fieldset"),t=E("legend"),l=j(o[1]),a=D(),M(r.$$.fragment),u=D(),f=E("div");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=z(c,"DIV",{class:!0});var m=H(e);n=z(m,"FIELDSET",{class:!0});var d=H(n);t=z(d,"LEGEND",{class:!0});var _=H(t);l=F(_,o[1]),_.forEach(v),a=P(d),A(r.$$.fragment,d),u=P(d),f=z(d,"DIV",{class:!0,"data-module":!0});var h=H(f);for(let C=0;C<i.length;C+=1)i[C].l(h);h.forEach(v),d.forEach(v),m.forEach(v),this.h()},h(){L(t,"class","govuk-fieldset__legend govuk-label--s"),L(f,"class","govuk-radios"),L(f,"data-module","govuk-radios"),he(f,"govuk-radios--inline",o[3]),he(f,"govuk-radios--small",o[3]),L(n,"class","govuk-fieldset"),L(e,"class","govuk-form-group")},m(c,m){S(c,e,m),I(e,n),I(n,t),I(t,l),I(n,a),R(r,n,null),I(n,u),I(n,f);for(let d=0;d<i.length;d+=1)i[d]&&i[d].m(f,null);g=!0},p(c,[m]){(!g||m&2)&&Ee(l,c[1]);const d={};if(m&16&&(d.errorMessage=c[4]),r.$set(d),m&37){s=Be(c[2]);let _;for(_=0;_<s.length;_+=1){const h=Pe(c,s,_);i[_]?i[_].p(h,m):(i[_]=Me(h),i[_].c(),i[_].m(f,null))}for(;_<i.length;_+=1)i[_].d(1);i.length=s.length}(!g||m&8)&&he(f,"govuk-radios--inline",c[3]),(!g||m&8)&&he(f,"govuk-radios--small",c[3])},i(c){g||(y(r.$$.fragment,c),g=!0)},o(c){w(r.$$.fragment,c),g=!1},d(c){c&&v(e),V(r),xe(i,c)}}}function Lt(o,e,n){let t,{legend:l}=e,{choices:a}=e,{inlineSmall:r=!1}=e,{required:u=!1}=e,{value:f}=e,g=Fe();const s=[[]];function i(m){q.call(this,o,m)}function c(){f=this.__value,n(0,f)}return o.$$set=m=>{"legend"in m&&n(1,l=m.legend),"choices"in m&&n(2,a=m.choices),"inlineSmall"in m&&n(3,r=m.inlineSmall),"required"in m&&n(6,u=m.required),"value"in m&&n(0,f=m.value)},o.$$.update=()=>{o.$$.dirty&65&&n(4,t=u&&f==""?"Required":"")},[f,l,a,r,t,g,u,i,c,s]}class wt extends O{constructor(e){super(),W(this,e,Lt,pt,K,{legend:1,choices:2,inlineSmall:3,required:6,value:0})}}function St(o){let e,n="You can manually use high-quality Bluesky imagery if you have a valid key.";return{c(){e=E("p"),e.textContent=n},l(t){e=z(t,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-1e80rhw"&&(e.textContent=n)},m(t,l){S(t,e,l)},d(t){t&&v(e)}}}function It(o){let e,n="The map should be showing Bluesky imagery.";return{c(){e=E("p"),e.textContent=n},l(t){e=z(t,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-13v9ac9"&&(e.textContent=n)},m(t,l){S(t,e,l)},d(t){t&&v(e)}}}function Ct(o){let e;return{c(){e=j("Set Bluesky API key")},l(n){e=F(n,"Set Bluesky API key")},m(n,t){S(n,e,t)},d(n){n&&v(e)}}}function Et(o){let e,n,t=`<i>Note this feature is temporary -- in the future, you will login and
      automatically have access to this imagery.</i>`,l,a,r;function u(s,i){return Tt()?It:St}let g=u()(o);return a=new We({props:{$$slots:{default:[Ct]},$$scope:{ctx:o}}}),a.$on("click",Nt),{c(){g.c(),e=D(),n=E("p"),n.innerHTML=t,l=D(),M(a.$$.fragment)},l(s){g.l(s),e=P(s),n=z(s,"P",{"data-svelte-h":!0}),ce(n)!=="svelte-jc29jc"&&(n.innerHTML=t),l=P(s),A(a.$$.fragment,s)},m(s,i){g.m(s,i),S(s,e,i),S(s,n,i),S(s,l,i),R(a,s,i),r=!0},p(s,i){const c={};i&1&&(c.$$scope={dirty:i,ctx:s}),a.$set(c)},i(s){r||(y(a.$$.fragment,s),r=!0)},o(s){w(a.$$.fragment,s),r=!1},d(s){s&&(v(e),v(n),v(l)),g.d(s),V(a,s)}}}function zt(o){let e,n;return e=new nt({props:{label:"Bluesky imagery",$$slots:{default:[Et]},$$scope:{ctx:o}}}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}let Ce="bluesky-api-key";function Tt(){let o=window.localStorage.getItem(Ce);return o!=null&&o.length>0}function Nt(){let o=window.prompt("Enter the API key provided to you",window.localStorage.getItem(Ce)||"");window.localStorage.setItem(Ce,o||""),window.location.reload()}class Sn extends O{constructor(e){super(),W(this,e,null,zt,K,{})}}function Bt(o){let e;const n=o[16].default,t=x(n,o,o[24],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&16777216)&&$(t,n,l,l[24],e?te(n,l[24],a,null):ee(l[24]),null)},i(l){e||(y(t,l),e=!0)},o(l){w(t,l),e=!1},d(l){t&&t.d(l)}}}function Dt(o){let e,n,t;function l(r){o[17](r)}let a={id:o[1],type:"circle",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],applyToClusters:o[9],minzoom:o[10],maxzoom:o[11],hoverCursor:o[12],manageHoverState:o[13],eventsIfTopMost:o[14],interactive:o[15],$$slots:{default:[Bt]},$$scope:{ctx:o}};return o[0]!==void 0&&(a.hovered=o[0]),e=new je({props:a}),ne.push(()=>de(e,"hovered",l)),e.$on("click",o[18]),e.$on("dblclick",o[19]),e.$on("contextmenu",o[20]),e.$on("mouseenter",o[21]),e.$on("mousemove",o[22]),e.$on("mouseleave",o[23]),{c(){M(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){R(e,r,u),t=!0},p(r,[u]){const f={};u&2&&(f.id=r[1]),u&4&&(f.source=r[2]),u&8&&(f.sourceLayer=r[3]),u&16&&(f.beforeId=r[4]),u&32&&(f.beforeLayerType=r[5]),u&64&&(f.paint=r[6]),u&128&&(f.layout=r[7]),u&256&&(f.filter=r[8]),u&512&&(f.applyToClusters=r[9]),u&1024&&(f.minzoom=r[10]),u&2048&&(f.maxzoom=r[11]),u&4096&&(f.hoverCursor=r[12]),u&8192&&(f.manageHoverState=r[13]),u&16384&&(f.eventsIfTopMost=r[14]),u&32768&&(f.interactive=r[15]),u&16777216&&(f.$$scope={dirty:u,ctx:r}),!n&&u&1&&(n=!0,f.hovered=r[0],me(()=>n=!1)),e.$set(f)},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function Pt(o,e,n){let{$$slots:t={},$$scope:l}=e,{id:a=Te("circle")}=e,{source:r=void 0}=e,{sourceLayer:u=void 0}=e,{beforeId:f=void 0}=e,{beforeLayerType:g=void 0}=e,{paint:s}=e,{layout:i=void 0}=e,{filter:c=void 0}=e,{applyToClusters:m=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:h=void 0}=e,{manageHoverState:C=!1}=e,{hovered:G=null}=e,{eventsIfTopMost:p=!1}=e,{interactive:ae=!0}=e;function ie(b){G=b,n(0,G)}function re(b){q.call(this,o,b)}function Le(b){q.call(this,o,b)}function _e(b){q.call(this,o,b)}function we(b){q.call(this,o,b)}function U(b){q.call(this,o,b)}function Se(b){q.call(this,o,b)}return o.$$set=b=>{"id"in b&&n(1,a=b.id),"source"in b&&n(2,r=b.source),"sourceLayer"in b&&n(3,u=b.sourceLayer),"beforeId"in b&&n(4,f=b.beforeId),"beforeLayerType"in b&&n(5,g=b.beforeLayerType),"paint"in b&&n(6,s=b.paint),"layout"in b&&n(7,i=b.layout),"filter"in b&&n(8,c=b.filter),"applyToClusters"in b&&n(9,m=b.applyToClusters),"minzoom"in b&&n(10,d=b.minzoom),"maxzoom"in b&&n(11,_=b.maxzoom),"hoverCursor"in b&&n(12,h=b.hoverCursor),"manageHoverState"in b&&n(13,C=b.manageHoverState),"hovered"in b&&n(0,G=b.hovered),"eventsIfTopMost"in b&&n(14,p=b.eventsIfTopMost),"interactive"in b&&n(15,ae=b.interactive),"$$scope"in b&&n(24,l=b.$$scope)},[G,a,r,u,f,g,s,i,c,m,d,_,h,C,p,ae,t,ie,re,Le,_e,we,U,Se,l]}class In extends O{constructor(e){super(),W(this,e,Pt,Dt,K,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function Ae(o){let e=o[0],n,t,l=Re(o);return{c(){l.c(),n=Y()},l(a){l.l(a),n=Y()},m(a,r){l.m(a,r),S(a,n,r),t=!0},p(a,r){r&1&&K(e,e=a[0])?(le(),w(l,1,1,pe),oe(),l=Re(a),l.c(),y(l,1),l.m(n.parentNode,n)):l.p(a,r)},i(a){t||(y(l),t=!0)},o(a){w(l),t=!1},d(a){a&&v(n),l.d(a)}}}function Re(o){let e;const n=o[10].default,t=x(n,o,o[9],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&512)&&$(t,n,l,l[9],e?te(n,l[9],a,null):ee(l[9]),null)},i(l){e||(y(t,l),e=!0)},o(l){w(t,l),e=!1},d(l){t&&t.d(l)}}}function Mt(o){let e,n,t=o[0]&&Ae(o);return{c(){t&&t.c(),e=Y()},l(l){t&&t.l(l),e=Y()},m(l,a){t&&t.m(l,a),S(l,e,a),n=!0},p(l,[a]){l[0]?t?(t.p(l,a),a&1&&y(t,1)):(t=Ae(l),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(le(),w(t,1,1,()=>{t=null}),oe())},i(l){n||(y(t),n=!0)},o(l){w(t),n=!1},d(l){l&&v(e),t&&t.d(l)}}}function At(o,e,n){let t,l,{$$slots:a={},$$scope:r}=e,{id:u=Te("image")}=e,{url:f}=e,{coordinates:g}=e;const{map:s,self:i}=ot();B(o,s,d=>n(8,l=d)),B(o,i,d=>n(0,t=d));let c,m=!0;return ze(()=>{t&&l&&(at(s,t,c),T(i,t=null,t),n(6,c=void 0))}),o.$$set=d=>{"id"in d&&n(3,u=d.id),"url"in d&&n(4,f=d.url),"coordinates"in d&&n(5,g=d.coordinates),"$$scope"in d&&n(9,r=d.$$scope)},o.$$.update=()=>{o.$$.dirty&313&&l&&t!==u&&(T(i,t=u,t),it(l,t,rt({type:"image",url:f,coordinates:g}),d=>l&&d===t,()=>{t&&(n(6,c=l==null?void 0:l.getSource(t)),n(7,m=!0))})),o.$$.dirty&264&&(l==null||l.on("style.load",()=>{n(6,c=l==null?void 0:l.getSource(u))})),o.$$.dirty&224&&c&&(m?n(7,m=!1):c.setCoordinates(g))},[t,s,i,u,f,g,c,m,l,r,a]}class Rt extends O{constructor(e){super(),W(this,e,At,Mt,K,{id:3,url:4,coordinates:5})}}function Vt(o,e,n){let t;const l=Oe();let{layer:a=void 0}=e;const{map:r}=st();B(o,r,s=>n(2,t=s));function u(s){l(s.type,{...s,map:r})}const f=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],g=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return ze(()=>{if(t)if(a)for(const s of f)t.off(s,a,u);else for(const s of g)t.off(s,u)}),o.$$set=s=>{"layer"in s&&n(1,a=s.layer)},o.$$.update=()=>{if(o.$$.dirty&6&&t)if(a)for(const s of f)t.on(s,a,u);else for(const s of g)t.on(s,u)},[r,a,t]}class Cn extends O{constructor(e){super(),W(this,e,Vt,null,K,{layer:1})}}const Ht=o=>({marker:o&8}),Ve=o=>({marker:o[3]});function qt(o){let e,n,t,l,a,r,u;const f=o[19].default,g=x(f,o,o[18],Ve);return{c(){e=E("div"),g&&g.c(),this.h()},l(s){e=z(s,"DIV",{tabindex:!0,role:!0});var i=H(e);g&&g.l(i),i.forEach(v),this.h()},h(){L(e,"tabindex",n=o[1]?0:void 0),L(e,"role",t=o[1]?"button":void 0),Z(e,"z-index",o[2])},m(s,i){S(s,e,i),g&&g.m(e,null),a=!0,r||(u=[Ne(o[7].call(null,e)),Ne(l=Gt.call(null,e,o[0])),N(e,"click",Ie(o[20])),N(e,"dblclick",Ie(o[21])),N(e,"contextmenu",Ie(o[22])),N(e,"mouseenter",o[23]),N(e,"mouseleave",o[24]),N(e,"mousemove",o[25]),N(e,"keydown",o[8])],r=!0)},p(s,[i]){g&&g.p&&(!a||i&262152)&&$(g,f,s,s[18],a?te(f,s[18],i,Ht):ee(s[18]),Ve),(!a||i&2&&n!==(n=s[1]?0:void 0))&&L(e,"tabindex",n),(!a||i&2&&t!==(t=s[1]?"button":void 0))&&L(e,"role",t),l&&et(l.update)&&i&1&&l.update.call(null,s[0]),i&4&&Z(e,"z-index",s[2])},i(s){a||(y(g,s),a=!0)},o(s){w(g,s),a=!1},d(s){s&&v(e),g&&g.d(s),r=!1,ye(u)}}}function Gt(o,e){const n=o.className;function t(l){l?o.className=`${n} ${l}`:o.className=n}return t(e),{update:t}}function Ut(o,e,n){let t,l,a,{$$slots:r={},$$scope:u}=e,{marker:f=void 0}=e,{lngLat:g}=e,{class:s=void 0}=e,{interactive:i=!0}=e,{asButton:c=!1}=e,{draggable:m=!1}=e,{feature:d=null}=e,{offset:_=void 0}=e,{zIndex:h=void 0}=e,{rotation:C=0}=e,{opacity:G=1}=e;const p=Oe(),{map:ae,layerEvent:ie,self:re}=ut();B(o,ae,k=>n(27,a=k)),B(o,ie,k=>n(26,t=k)),B(o,re,k=>n(3,l=k));function Le(k){T(re,l=new ft.Marker({element:k,rotation:C,draggable:m,offset:_,opacity:G.toString()}).setLngLat(g).addTo(a),l),n(11,f=l);const J=()=>U("dragstart"),se=()=>{_e(),U("drag")},ue=()=>{_e(),U("dragend")};return m&&(l.on("dragstart",J),l.on("drag",se),l.on("dragend",ue)),{destroy(){m&&(l==null||l.off("dragstart",J),l==null||l.off("drag",se),l==null||l.off("dragend",ue)),n(11,f=void 0),l==null||l.remove()}}}function _e(){let k=l==null?void 0:l.getLngLat();k&&(Array.isArray(g)?n(10,g=[k.lng,k.lat]):g&&"lon"in g?n(10,g={lon:k.lng,lat:k.lat}):n(10,g=k))}function we(k){k.key===" "&&(k.preventDefault(),k.stopPropagation(),U("click"))}function U(k){if(!i)return;let J=l==null?void 0:l.getLngLat();if(!J)return;const se=[J.lng,J.lat];let ue={map:a,marker:l,lngLat:se,features:[{type:"Feature",properties:(d==null?void 0:d.properties)??{},geometry:{type:"Point",coordinates:se}}]};T(ie,t={...ue,layerType:"marker",type:k},t),p(k,ue)}const Se=()=>U("click"),b=()=>U("dblclick"),Ye=()=>U("contextmenu"),Ze=k=>{U("mouseenter")},Je=()=>{U("mouseleave")},Qe=()=>U("mousemove");return o.$$set=k=>{"marker"in k&&n(11,f=k.marker),"lngLat"in k&&n(10,g=k.lngLat),"class"in k&&n(0,s=k.class),"interactive"in k&&n(12,i=k.interactive),"asButton"in k&&n(1,c=k.asButton),"draggable"in k&&n(13,m=k.draggable),"feature"in k&&n(14,d=k.feature),"offset"in k&&n(15,_=k.offset),"zIndex"in k&&n(2,h=k.zIndex),"rotation"in k&&n(16,C=k.rotation),"opacity"in k&&n(17,G=k.opacity),"$$scope"in k&&n(18,u=k.$$scope)},o.$$.update=()=>{o.$$.dirty&1032&&(l==null||l.setLngLat(g)),o.$$.dirty&32776&&(l==null||l.setOffset(_??[0,0])),o.$$.dirty&65544&&(l==null||l.setRotation(C)),o.$$.dirty&131080&&(l==null||l.setOpacity(G.toString()))},[s,c,h,l,ae,ie,re,Le,we,U,g,f,i,m,d,_,C,G,u,r,Se,b,Ye,Ze,Je,Qe]}class He extends O{constructor(e){super(),W(this,e,Ut,qt,K,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}function Kt(o){let e;const n=o[8].default,t=x(n,o,o[15],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&32768)&&$(t,n,l,l[15],e?te(n,l[15],a,null):ee(l[15]),null)},i(l){e||(y(t,l),e=!0)},o(l){w(t,l),e=!1},d(l){t&&t.d(l)}}}function Ot(o){let e,n;return e=new je({props:{id:o[0],type:"raster",source:o[1],beforeId:o[2],beforeLayerType:o[3],paint:o[4],layout:o[5],minzoom:o[6],maxzoom:o[7],$$slots:{default:[Kt]},$$scope:{ctx:o}}}),e.$on("click",o[9]),e.$on("dblclick",o[10]),e.$on("contextmenu",o[11]),e.$on("mouseenter",o[12]),e.$on("mousemove",o[13]),e.$on("mouseleave",o[14]),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.id=t[0]),l&2&&(a.source=t[1]),l&4&&(a.beforeId=t[2]),l&8&&(a.beforeLayerType=t[3]),l&16&&(a.paint=t[4]),l&32&&(a.layout=t[5]),l&64&&(a.minzoom=t[6]),l&128&&(a.maxzoom=t[7]),l&32768&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Wt(o,e,n){let{$$slots:t={},$$scope:l}=e,{id:a=Te("raster-layer")}=e,{source:r=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:g}=e,{layout:s=void 0}=e,{minzoom:i=void 0}=e,{maxzoom:c=void 0}=e;function m(p){q.call(this,o,p)}function d(p){q.call(this,o,p)}function _(p){q.call(this,o,p)}function h(p){q.call(this,o,p)}function C(p){q.call(this,o,p)}function G(p){q.call(this,o,p)}return o.$$set=p=>{"id"in p&&n(0,a=p.id),"source"in p&&n(1,r=p.source),"beforeId"in p&&n(2,u=p.beforeId),"beforeLayerType"in p&&n(3,f=p.beforeLayerType),"paint"in p&&n(4,g=p.paint),"layout"in p&&n(5,s=p.layout),"minzoom"in p&&n(6,i=p.minzoom),"maxzoom"in p&&n(7,c=p.maxzoom),"$$scope"in p&&n(15,l=p.$$scope)},[a,r,u,f,g,s,i,c,t,m,d,_,h,C,G,l]}class jt extends O{constructor(e){super(),W(this,e,Wt,Ot,K,{id:0,source:1,beforeId:2,beforeLayerType:3,paint:4,layout:5,minzoom:6,maxzoom:7})}}const{window:Ft}=ct;function Yt(o){let e;return{c(){e=j("StreetView")},l(n){e=F(n,"StreetView")},m(n,t){S(n,e,t)},d(n){n&&v(e)}}}function qe(o){let e,n,t;function l(r){o[5](r)}let a={legend:"Source",choices:[["google","Google StreetView"],["bing","Bing Streetside"]],inlineSmall:!0};return o[1]!==void 0&&(a.value=o[1]),e=new wt({props:a}),ne.push(()=>de(e,"value",l)),{c(){M(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){R(e,r,u),t=!0},p(r,u){const f={};!n&&u&2&&(n=!0,f.value=r[1],me(()=>n=!1)),e.$set(f)},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function Zt(o){let e,n,t,l,a,r,u;function f(i){o[4](i)}let g={$$slots:{default:[Yt]},$$scope:{ctx:o}};o[0]!==void 0&&(g.checked=o[0]),e=new yt({props:g}),ne.push(()=>de(e,"checked",f));let s=o[0]&&qe(o);return{c(){M(e.$$.fragment),t=D(),s&&s.c(),l=Y()},l(i){A(e.$$.fragment,i),t=P(i),s&&s.l(i),l=Y()},m(i,c){R(e,i,c),S(i,t,c),s&&s.m(i,c),S(i,l,c),a=!0,r||(u=N(Ft,"keydown",o[2]),r=!0)},p(i,[c]){const m={};c&512&&(m.$$scope={dirty:c,ctx:i}),!n&&c&1&&(n=!0,m.checked=i[0],me(()=>n=!1)),e.$set(m),i[0]?s?(s.p(i,c),c&1&&y(s,1)):(s=qe(i),s.c(),y(s,1),s.m(l.parentNode,l)):s&&(le(),w(s,1,1,()=>{s=null}),oe())},i(i){a||(y(e.$$.fragment,i),y(s),a=!0)},o(i){w(e.$$.fragment,i),w(s),a=!1},d(i){i&&(v(t),v(l)),V(e,i),s&&s.d(i),r=!1,u()}}}function Jt(o,e,n){let{map:t}=e,{enabled:l=!1}=e,a="google";function r(){t.on("click",f),t.getCanvas().style.cursor="zoom-in"}function u(){t.off("click",f),t.getCanvas().style.cursor="auto"}ze(u);function f(c){window.open(a=="google"?Qt(c.lngLat.toArray()):Xt(c.lngLat.toArray()),"_blank"),n(0,l=!1)}function g(c){l&&c.key=="Escape"&&n(0,l=!1)}function s(c){l=c,n(0,l)}function i(c){a=c,n(1,a)}return o.$$set=c=>{"map"in c&&n(3,t=c.map),"enabled"in c&&n(0,l=c.enabled)},o.$$.update=()=>{o.$$.dirty&1&&(l?r():u())},[l,a,g,t,s,i]}class En extends O{constructor(e){super(),W(this,e,Jt,Zt,K,{map:3,enabled:0})}}function zn(o){return mt(o)}function Qt(o){return`http://maps.google.com/maps?q=&layer=c&cbll=${o[1]},${o[0]}&cbp=11,0,0,0,0`}function Xt(o){return`https://www.bing.com/maps?cp=${o[1]}~${o[0]}&style=x`}const fe=ge(!1),be=ge(null),ke=ge(100),Q=ge({lng:0,lat:0}),X=ge({lng:0,lat:0});function xt(o){let e,n;return e=new We({props:{$$slots:{default:[en]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,l){const a={};l&8192&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function $t(o){let e,n,t="Georeference an image",l,a,r,u,f,g,s,i=`Note this image isn't saved as part of this scheme. When you close this
      page, it'll be lost.`,c;a=new gt({props:{$$slots:{default:[ln]},$$scope:{ctx:o}}}),u=new ht({props:{label:"Load an image",id:"load-image",$$slots:{default:[on]},$$scope:{ctx:o}}});let m=o[3]&&Ge(o);return{c(){e=E("div"),n=E("h2"),n.textContent=t,l=D(),M(a.$$.fragment),r=D(),M(u.$$.fragment),f=D(),m&&m.c(),g=D(),s=E("p"),s.textContent=i,this.h()},l(d){e=z(d,"DIV",{style:!0});var _=H(e);n=z(_,"H2",{"data-svelte-h":!0}),ce(n)!=="svelte-fociiu"&&(n.textContent=t),l=P(_),A(a.$$.fragment,_),r=P(_),A(u.$$.fragment,_),f=P(_),m&&m.l(_),g=P(_),s=z(_,"P",{"data-svelte-h":!0}),ce(s)!=="svelte-d8uklv"&&(s.textContent=i),_.forEach(v),this.h()},h(){Z(e,"border","1px solid black"),Z(e,"padding","4px")},m(d,_){S(d,e,_),I(e,n),I(e,l),R(a,e,null),I(e,r),R(u,e,null),I(e,f),m&&m.m(e,null),I(e,g),I(e,s),c=!0},p(d,_){const h={};_&8202&&(h.$$scope={dirty:_,ctx:d}),a.$set(h);const C={};_&8193&&(C.$$scope={dirty:_,ctx:d}),u.$set(C),d[3]?m?m.p(d,_):(m=Ge(d),m.c(),m.m(e,g)):m&&(m.d(1),m=null)},i(d){c||(y(a.$$.fragment,d),y(u.$$.fragment,d),c=!0)},o(d){w(a.$$.fragment,d),w(u.$$.fragment,d),c=!1},d(d){d&&v(e),V(a),V(u),m&&m.d()}}}function en(o){let e;return{c(){e=j("Georeference an image")},l(n){e=F(n,"Georeference an image")},m(n,t){S(n,e,t)},d(n){n&&v(e)}}}function tn(o){let e;return{c(){e=j("Save")},l(n){e=F(n,"Save")},m(n,t){S(n,e,t)},d(n){n&&v(e)}}}function nn(o){let e;return{c(){e=j("Delete")},l(n){e=F(n,"Delete")},m(n,t){S(n,e,t)},d(n){n&&v(e)}}}function ln(o){let e,n,t,l;return e=new _t({props:{$$slots:{default:[tn]},$$scope:{ctx:o}}}),e.$on("click",o[7]),t=new lt({props:{disabled:!o[3],$$slots:{default:[nn]},$$scope:{ctx:o}}}),t.$on("click",o[5]),{c(){M(e.$$.fragment),n=D(),M(t.$$.fragment)},l(a){A(e.$$.fragment,a),n=P(a),A(t.$$.fragment,a)},m(a,r){R(e,a,r),S(a,n,r),R(t,a,r),l=!0},p(a,r){const u={};r&8192&&(u.$$scope={dirty:r,ctx:a}),e.$set(u);const f={};r&8&&(f.disabled=!a[3]),r&8192&&(f.$$scope={dirty:r,ctx:a}),t.$set(f)},i(a){l||(y(e.$$.fragment,a),y(t.$$.fragment,a),l=!0)},o(a){w(e.$$.fragment,a),w(t.$$.fragment,a),l=!1},d(a){a&&v(n),V(e,a),V(t,a)}}}function on(o){let e,n,t;return{c(){e=E("input"),this.h()},l(l){e=z(l,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){L(e,"class","govuk-file-upload"),L(e,"id","load-image"),L(e,"type","file")},m(l,a){S(l,e,a),o[8](e),n||(t=N(e,"change",o[4]),n=!0)},p:pe,d(l){l&&v(e),o[8](null),n=!1,t()}}}function Ge(o){let e,n,t,l,a,r,u,f;return{c(){e=E("div"),n=E("label"),t=E("input"),l=j(`
          Opacity: `),a=j(o[2]),r=j("%"),this.h()},l(g){e=z(g,"DIV",{});var s=H(e);n=z(s,"LABEL",{});var i=H(n);t=z(i,"INPUT",{type:!0,min:!0,max:!0}),l=F(i,`
          Opacity: `),a=F(i,o[2]),r=F(i,"%"),i.forEach(v),s.forEach(v),this.h()},h(){L(t,"type","range"),L(t,"min","0"),L(t,"max","100")},m(g,s){S(g,e,s),I(e,n),I(n,t),ve(t,o[2]),I(n,l),I(n,a),I(n,r),u||(f=[N(t,"change",o[9]),N(t,"input",o[9])],u=!0)},p(g,s){s&4&&ve(t,g[2]),s&4&&Ee(a,g[2])},d(g){g&&v(e),u=!1,ye(f)}}}function an(o){let e,n,t,l,a,r;const u=[$t,xt],f=[];function g(s,i){return s[1]?0:1}return e=g(o),n=f[e]=u[e](o),{c(){n.c(),t=Y()},l(s){n.l(s),t=Y()},m(s,i){f[e].m(s,i),S(s,t,i),l=!0,a||(r=N(window,"keydown",o[6]),a=!0)},p(s,[i]){let c=e;e=g(s),e===c?f[e].p(s,i):(le(),w(f[c],1,1,()=>{f[c]=null}),oe(),n=f[e],n?n.p(s,i):(n=f[e]=u[e](s),n.c()),y(n,1),n.m(t.parentNode,t))},i(s){l||(y(n),l=!0)},o(s){w(n),l=!1},d(s){s&&v(t),f[e].d(s),a=!1,r()}}}function rn(o,e,n){let t,l,a,r,u;B(o,fe,h=>n(1,t=h)),B(o,ke,h=>n(2,l=h)),B(o,be,h=>n(3,a=h)),B(o,X,h=>n(11,r=h)),B(o,Q,h=>n(12,u=h));let f;async function g(h){let C=await f.files[0].arrayBuffer(),G=new Blob([new Uint8Array(C)]);T(be,a=URL.createObjectURL(G),a),T(Q,u={lng:0,lat:0},u),T(X,r={lng:0,lat:0},r)}function s(){T(be,a=null,a),T(ke,l=100,l)}function i(h){t&&h.key=="Escape"&&(h.stopPropagation(),T(fe,t=!1,t))}const c=()=>T(fe,t=!1,t);function m(h){ne[h?"unshift":"push"](()=>{f=h,n(0,f)})}function d(){l=tt(this.value),ke.set(l)}return[f,t,l,a,g,s,i,c,m,d,()=>T(fe,t=!0,t)]}class Tn extends O{constructor(e){super(),W(this,e,rn,an,K,{})}}function Ue(o){let e,n;return e=new Rt({props:{url:o[2],coordinates:[[o[0].lng,o[0].lat],[o[3].lng,o[0].lat],[o[3].lng,o[3].lat],[o[0].lng,o[3].lat]],$$slots:{default:[sn]},$$scope:{ctx:o}}}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.url=t[2]),l&9&&(a.coordinates=[[t[0].lng,t[0].lat],[t[3].lng,t[0].lat],[t[3].lng,t[3].lat],[t[0].lng,t[3].lat]]),l&272&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function sn(o){let e,n;return e=new jt({props:{paint:{"raster-fade-duration":0,"raster-opacity":o[4]/100}}}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){R(e,t,l),n=!0},p(t,l){const a={};l&16&&(a.paint={"raster-fade-duration":0,"raster-opacity":t[4]/100}),e.$set(a)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Ke(o){let e,n,t,l,a,r;function u(i){o[6](i)}let f={draggable:!0,$$slots:{default:[un]},$$scope:{ctx:o}};o[0]!==void 0&&(f.lngLat=o[0]),e=new He({props:f}),ne.push(()=>de(e,"lngLat",u));function g(i){o[7](i)}let s={draggable:!0,$$slots:{default:[fn]},$$scope:{ctx:o}};return o[3]!==void 0&&(s.lngLat=o[3]),l=new He({props:s}),ne.push(()=>de(l,"lngLat",g)),{c(){M(e.$$.fragment),t=D(),M(l.$$.fragment)},l(i){A(e.$$.fragment,i),t=P(i),A(l.$$.fragment,i)},m(i,c){R(e,i,c),S(i,t,c),R(l,i,c),r=!0},p(i,c){const m={};c&256&&(m.$$scope={dirty:c,ctx:i}),!n&&c&1&&(n=!0,m.lngLat=i[0],me(()=>n=!1)),e.$set(m);const d={};c&256&&(d.$$scope={dirty:c,ctx:i}),!a&&c&8&&(a=!0,d.lngLat=i[3],me(()=>a=!1)),l.$set(d)},i(i){r||(y(e.$$.fragment,i),y(l.$$.fragment,i),r=!0)},o(i){w(e.$$.fragment,i),w(l.$$.fragment,i),r=!1},d(i){i&&v(t),V(e,i),V(l,i)}}}function un(o){let e;return{c(){e=E("span"),this.h()},l(n){e=z(n,"SPAN",{class:!0,style:!0}),H(e).forEach(v),this.h()},h(){L(e,"class","dot svelte-1tmbx1c"),Z(e,"background-color","red")},m(n,t){S(n,e,t)},p:pe,d(n){n&&v(e)}}}function fn(o){let e;return{c(){e=E("span"),this.h()},l(n){e=z(n,"SPAN",{class:!0,style:!0}),H(e).forEach(v),this.h()},h(){L(e,"class","dot svelte-1tmbx1c"),Z(e,"background-color","blue")},m(n,t){S(n,e,t)},p:pe,d(n){n&&v(e)}}}function cn(o){let e,n,t,l=o[2]&&o[0].lng!=o[3].lng&&Ue(o),a=o[2]&&o[1]&&Ke(o);return{c(){l&&l.c(),e=D(),a&&a.c(),n=Y()},l(r){l&&l.l(r),e=P(r),a&&a.l(r),n=Y()},m(r,u){l&&l.m(r,u),S(r,e,u),a&&a.m(r,u),S(r,n,u),t=!0},p(r,[u]){r[2]&&r[0].lng!=r[3].lng?l?(l.p(r,u),u&13&&y(l,1)):(l=Ue(r),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(le(),w(l,1,1,()=>{l=null}),oe()),r[2]&&r[1]?a?(a.p(r,u),u&6&&y(a,1)):(a=Ke(r),a.c(),y(a,1),a.m(n.parentNode,n)):a&&(le(),w(a,1,1,()=>{a=null}),oe())},i(r){t||(y(l),y(a),t=!0)},o(r){w(l),w(a),t=!1},d(r){r&&(v(e),v(n)),l&&l.d(r),a&&a.d(r)}}}function mn(o,e,n){let t,l,a,r,u;B(o,X,i=>n(3,t=i)),B(o,Q,i=>n(0,l=i)),B(o,fe,i=>n(1,a=i)),B(o,be,i=>n(2,r=i)),B(o,ke,i=>n(4,u=i));let{map:f}=e;function g(i){l=i,Q.set(l)}function s(i){t=i,X.set(t)}return o.$$set=i=>{"map"in i&&n(5,f=i.map)},o.$$.update=()=>{if(o.$$.dirty&39&&r&&a&&l.lng==0&&l.lat==0){let i=f.getBounds();T(Q,l.lng=i.getWest()+.4*(i.getEast()-i.getWest()),l),T(X,t.lng=i.getWest()+.6*(i.getEast()-i.getWest()),t),T(Q,l.lat=i.getNorth()+.4*(i.getSouth()-i.getNorth()),l),T(X,t.lat=i.getNorth()+.6*(i.getSouth()-i.getNorth()),t)}},[l,a,r,t,u,f,g,s]}class Nn extends O{constructor(e){super(),W(this,e,mn,cn,K,{map:5})}}export{Sn as B,In as C,Tn as G,Cn as M,wt as R,En as S,zn as a,Xt as b,Nn as c,He as d,Qt as s};
