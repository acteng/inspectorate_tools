import{s as O,l as ne,e as E,a as z,c as I,b as T,g as D,f as p,r as v,w as Y,i as w,h as S,z as N,u as le,m as oe,o as ae,B as me,H,a9 as Je,t as G,d as U,y as ue,j as ye,q as Qe,O as Xe,C as de,p as re,E as K,k as P,a7 as Ve,N as B,n as he,aa as Se,A as ke,Z as $e,a8 as xe,v as se,x as ge,ab as et}from"./scheduler.Bsni_e59.js";import{S as W,i as j,t as k,b as L,c as A,a as R,m as M,d as V,g as X,f as $,e as _e}from"./index.CCfAUppz.js";import{C as tt}from"./CollapsibleCard.DoOZ0Bze.js";import{S as qe,W as nt}from"./WarningButton.D9QeV9gM.js";import{g as Ge,u as lt,r as ot,b as at,c as rt,d as st,m as it,L as ut,a as ft,t as ct}from"./MapLibreMap.CIxOOdlx.js";import{v as Ue,E as dt,F as gt}from"./FormElement.CamEvjvl.js";import{e as Ee}from"./each.BmgwAlbi.js";import{B as _t}from"./ButtonGroup.hr9f_7ak.js";import{D as mt}from"./DefaultButton.DyQsHGbh.js";import{w as ie}from"./entry.CfgHIoAr.js";const ht=o=>({}),Ie=o=>({});function bt(o){let e,n,t,l,a,i,f,g,_;const s=o[5].default,r=ne(s,o,o[4],null),u=o[5].right,c=ne(u,o,o[4],Ie);return{c(){e=E("div"),n=E("input"),t=z(),l=E("label"),r&&r.c(),a=z(),i=E("span"),c&&c.c(),this.h()},l(d){e=I(d,"DIV",{class:!0,style:!0});var m=T(e);n=I(m,"INPUT",{type:!0,class:!0,id:!0}),t=D(m),l=I(m,"LABEL",{class:!0,for:!0,title:!0});var h=T(l);r&&r.l(h),h.forEach(p),a=D(m),i=I(m,"SPAN",{style:!0});var C=T(i);c&&c.l(C),C.forEach(p),m.forEach(p),this.h()},h(){v(n,"type","checkbox"),v(n,"class","govuk-checkboxes__input"),v(n,"id",o[3]),v(l,"class","govuk-label govuk-checkboxes__label"),v(l,"for",o[3]),v(l,"title",o[1]),Y(i,"float","right"),v(e,"class","govuk-checkboxes__item"),v(e,"style",o[2])},m(d,m){w(d,e,m),S(e,n),n.checked=o[0],S(e,t),S(e,l),r&&r.m(l,null),S(e,a),S(e,i),c&&c.m(i,null),f=!0,g||(_=[N(n,"change",o[7]),N(n,"change",o[6])],g=!0)},p(d,[m]){m&1&&(n.checked=d[0]),r&&r.p&&(!f||m&16)&&le(r,s,d,d[4],f?ae(s,d[4],m,null):oe(d[4]),null),(!f||m&2)&&v(l,"title",d[1]),c&&c.p&&(!f||m&16)&&le(c,u,d,d[4],f?ae(u,d[4],m,ht):oe(d[4]),Ie)},i(d){f||(k(r,d),k(c,d),f=!0)},o(d){L(r,d),L(c,d),f=!1},d(d){d&&p(e),r&&r.d(d),c&&c.d(d),g=!1,me(_)}}}function pt(o,e,n){let{$$slots:t={},$$scope:l}=e;const a=Je(t);let{checked:i}=e,{hint:f=null}=e,_=a.right!==void 0?"float: none":"",s=Ue();function r(c){H.call(this,o,c)}function u(){i=this.checked,n(0,i)}return o.$$set=c=>{"checked"in c&&n(0,i=c.checked),"hint"in c&&n(1,f=c.hint),"$$scope"in c&&n(4,l=c.$$scope)},[i,f,_,s,l,t,r,u]}class kt extends W{constructor(e){super(),j(this,e,pt,bt,O,{checked:0,hint:1})}}function Ce(o,e,n){const t=o.slice();return t[10]=e[n][0],t[11]=e[n][1],t}function Be(o){let e,n,t,l,a=!1,i,f,g=o[11]+"",_,s,r,u,c,d;return u=Xe(o[9][0]),{c(){e=E("div"),n=E("input"),i=z(),f=E("label"),_=G(g),r=z(),this.h()},l(m){e=I(m,"DIV",{class:!0});var h=T(e);n=I(h,"INPUT",{class:!0,id:!0,type:!0}),i=D(h),f=I(h,"LABEL",{class:!0,for:!0});var C=T(f);_=U(C,g),C.forEach(p),r=D(h),h.forEach(p),this.h()},h(){v(n,"class","govuk-radios__input"),v(n,"id",t=o[5]+o[10]),v(n,"type","radio"),n.__value=l=o[10],de(n,n.__value),v(f,"class","govuk-label govuk-radios__label"),v(f,"for",s=o[5]+o[10]),v(e,"class","govuk-radios__item"),u.p(n)},m(m,h){w(m,e,h),S(e,n),n.checked=n.__value===o[0],S(e,i),S(e,f),S(f,_),S(e,r),c||(d=[N(n,"change",o[8]),N(n,"change",o[7])],c=!0)},p(m,h){h&4&&t!==(t=m[5]+m[10])&&v(n,"id",t),h&4&&l!==(l=m[10])&&(n.__value=l,de(n,n.__value),a=!0),(a||h&5)&&(n.checked=n.__value===m[0]),h&4&&g!==(g=m[11]+"")&&ye(_,g),h&4&&s!==(s=m[5]+m[10])&&v(f,"for",s)},d(m){m&&p(e),u.r(),c=!1,me(d)}}}function vt(o){let e,n,t,l,a,i,f,g,_;i=new dt({props:{errorMessage:o[4]}});let s=Ee(o[2]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Be(Ce(o,s,u));return{c(){e=E("div"),n=E("fieldset"),t=E("legend"),l=G(o[1]),a=z(),A(i.$$.fragment),f=z(),g=E("div");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=I(u,"DIV",{class:!0});var c=T(e);n=I(c,"FIELDSET",{class:!0});var d=T(n);t=I(d,"LEGEND",{class:!0});var m=T(t);l=U(m,o[1]),m.forEach(p),a=D(d),R(i.$$.fragment,d),f=D(d),g=I(d,"DIV",{class:!0,"data-module":!0});var h=T(g);for(let C=0;C<r.length;C+=1)r[C].l(h);h.forEach(p),d.forEach(p),c.forEach(p),this.h()},h(){v(t,"class","govuk-fieldset__legend govuk-label--s"),v(g,"class","govuk-radios"),v(g,"data-module","govuk-radios"),ue(g,"govuk-radios--inline",o[3]),ue(g,"govuk-radios--small",o[3]),v(n,"class","govuk-fieldset"),v(e,"class","govuk-form-group")},m(u,c){w(u,e,c),S(e,n),S(n,t),S(t,l),S(n,a),M(i,n,null),S(n,f),S(n,g);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(g,null);_=!0},p(u,[c]){(!_||c&2)&&ye(l,u[1]);const d={};if(c&16&&(d.errorMessage=u[4]),i.$set(d),c&37){s=Ee(u[2]);let m;for(m=0;m<s.length;m+=1){const h=Ce(u,s,m);r[m]?r[m].p(h,c):(r[m]=Be(h),r[m].c(),r[m].m(g,null))}for(;m<r.length;m+=1)r[m].d(1);r.length=s.length}(!_||c&8)&&ue(g,"govuk-radios--inline",u[3]),(!_||c&8)&&ue(g,"govuk-radios--small",u[3])},i(u){_||(k(i.$$.fragment,u),_=!0)},o(u){L(i.$$.fragment,u),_=!1},d(u){u&&p(e),V(i),Qe(r,u)}}}function yt(o,e,n){let t,{legend:l}=e,{choices:a}=e,{inlineSmall:i=!1}=e,{required:f=!1}=e,{value:g}=e,_=Ue();const s=[[]];function r(c){H.call(this,o,c)}function u(){g=this.__value,n(0,g)}return o.$$set=c=>{"legend"in c&&n(1,l=c.legend),"choices"in c&&n(2,a=c.choices),"inlineSmall"in c&&n(3,i=c.inlineSmall),"required"in c&&n(6,f=c.required),"value"in c&&n(0,g=c.value)},o.$$.update=()=>{o.$$.dirty&65&&n(4,t=f&&g==""?"Required":"")},[g,l,a,i,t,_,f,r,u,s]}class Lt extends W{constructor(e){super(),j(this,e,yt,vt,O,{legend:1,choices:2,inlineSmall:3,required:6,value:0})}}function wt(o){let e,n="You can manually use high-quality Bluesky imagery if you have a valid key.";return{c(){e=E("p"),e.textContent=n},l(t){e=I(t,"P",{"data-svelte-h":!0}),re(e)!=="svelte-1e80rhw"&&(e.textContent=n)},m(t,l){w(t,e,l)},d(t){t&&p(e)}}}function St(o){let e,n="The map should be showing Bluesky imagery.";return{c(){e=E("p"),e.textContent=n},l(t){e=I(t,"P",{"data-svelte-h":!0}),re(e)!=="svelte-13v9ac9"&&(e.textContent=n)},m(t,l){w(t,e,l)},d(t){t&&p(e)}}}function Et(o){let e;return{c(){e=G("Set Bluesky API key")},l(n){e=U(n,"Set Bluesky API key")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function It(o){let e,n,t=`<i>Note this feature is temporary -- in the future, you will login and
      automatically have access to this imagery.</i>`,l,a,i;function f(s,r){return Bt()?St:wt}let _=f()(o);return a=new qe({props:{$$slots:{default:[Et]},$$scope:{ctx:o}}}),a.$on("click",Nt),{c(){_.c(),e=z(),n=E("p"),n.innerHTML=t,l=z(),A(a.$$.fragment)},l(s){_.l(s),e=D(s),n=I(s,"P",{"data-svelte-h":!0}),re(n)!=="svelte-jc29jc"&&(n.innerHTML=t),l=D(s),R(a.$$.fragment,s)},m(s,r){_.m(s,r),w(s,e,r),w(s,n,r),w(s,l,r),M(a,s,r),i=!0},p(s,r){const u={};r&1&&(u.$$scope={dirty:r,ctx:s}),a.$set(u)},i(s){i||(k(a.$$.fragment,s),i=!0)},o(s){L(a.$$.fragment,s),i=!1},d(s){s&&(p(e),p(n),p(l)),_.d(s),V(a,s)}}}function Ct(o){let e,n;return e=new tt({props:{label:"Bluesky imagery",$$slots:{default:[It]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}let ve="bluesky-api-key";function Bt(){let o=window.localStorage.getItem(ve);return o!=null&&o.length>0}function Nt(){let o=window.prompt("Enter the API key provided to you",window.localStorage.getItem(ve)||"");window.localStorage.setItem(ve,o||""),window.location.reload()}class pn extends W{constructor(e){super(),j(this,e,null,Ct,O,{})}}function Ne(o){let e=o[0],n,t,l=ze(o);return{c(){l.c(),n=K()},l(a){l.l(a),n=K()},m(a,i){l.m(a,i),w(a,n,i),t=!0},p(a,i){i&1&&O(e,e=a[0])?(X(),L(l,1,1,he),$(),l=ze(a),l.c(),k(l,1),l.m(n.parentNode,n)):l.p(a,i)},i(a){t||(k(l),t=!0)},o(a){L(l),t=!1},d(a){a&&p(n),l.d(a)}}}function ze(o){let e;const n=o[10].default,t=ne(n,o,o[9],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&512)&&le(t,n,l,l[9],e?ae(n,l[9],a,null):oe(l[9]),null)},i(l){e||(k(t,l),e=!0)},o(l){L(t,l),e=!1},d(l){t&&t.d(l)}}}function zt(o){let e,n,t=o[0]&&Ne(o);return{c(){t&&t.c(),e=K()},l(l){t&&t.l(l),e=K()},m(l,a){t&&t.m(l,a),w(l,e,a),n=!0},p(l,[a]){l[0]?t?(t.p(l,a),a&1&&k(t,1)):(t=Ne(l),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(X(),L(t,1,1,()=>{t=null}),$())},i(l){n||(k(t),n=!0)},o(l){L(t),n=!1},d(l){l&&p(e),t&&t.d(l)}}}function Dt(o,e,n){let t,l,{$$slots:a={},$$scope:i}=e,{id:f=Ge("image")}=e,{url:g}=e,{coordinates:_}=e;const{map:s,self:r}=lt();P(o,s,d=>n(8,l=d)),P(o,r,d=>n(0,t=d));let u,c=!0;return Ve(()=>{t&&l&&(ot(s,t,u),B(r,t=null,t),n(6,u=void 0))}),o.$$set=d=>{"id"in d&&n(3,f=d.id),"url"in d&&n(4,g=d.url),"coordinates"in d&&n(5,_=d.coordinates),"$$scope"in d&&n(9,i=d.$$scope)},o.$$.update=()=>{o.$$.dirty&313&&l&&t!==f&&(B(r,t=f,t),at(l,t,rt({type:"image",url:g,coordinates:_}),d=>l&&d===t,()=>{t&&(n(6,u=l==null?void 0:l.getSource(t)),n(7,c=!0))})),o.$$.dirty&264&&(l==null||l.on("style.load",()=>{n(6,u=l==null?void 0:l.getSource(f))})),o.$$.dirty&224&&u&&(c?n(7,c=!1):u.setCoordinates(_))},[t,s,r,f,g,_,u,c,l,i,a]}class Pt extends W{constructor(e){super(),j(this,e,Dt,zt,O,{id:3,url:4,coordinates:5})}}const Tt=o=>({marker:o&8}),De=o=>({marker:o[3]});function At(o){let e,n,t,l,a,i,f;const g=o[19].default,_=ne(g,o,o[18],De);return{c(){e=E("div"),_&&_.c(),this.h()},l(s){e=I(s,"DIV",{tabindex:!0,role:!0});var r=T(e);_&&_.l(r),r.forEach(p),this.h()},h(){v(e,"tabindex",n=o[1]?0:void 0),v(e,"role",t=o[1]?"button":void 0),Y(e,"z-index",o[2])},m(s,r){w(s,e,r),_&&_.m(e,null),a=!0,i||(f=[Se(o[7].call(null,e)),Se(l=Rt.call(null,e,o[0])),N(e,"click",ke(o[20])),N(e,"dblclick",ke(o[21])),N(e,"contextmenu",ke(o[22])),N(e,"mouseenter",o[23]),N(e,"mouseleave",o[24]),N(e,"mousemove",o[25]),N(e,"keydown",o[8])],i=!0)},p(s,[r]){_&&_.p&&(!a||r&262152)&&le(_,g,s,s[18],a?ae(g,s[18],r,Tt):oe(s[18]),De),(!a||r&2&&n!==(n=s[1]?0:void 0))&&v(e,"tabindex",n),(!a||r&2&&t!==(t=s[1]?"button":void 0))&&v(e,"role",t),l&&$e(l.update)&&r&1&&l.update.call(null,s[0]),r&4&&Y(e,"z-index",s[2])},i(s){a||(k(_,s),a=!0)},o(s){L(_,s),a=!1},d(s){s&&p(e),_&&_.d(s),i=!1,me(f)}}}function Rt(o,e){const n=o.className;function t(l){l?o.className=`${n} ${l}`:o.className=n}return t(e),{update:t}}function Mt(o,e,n){let t,l,a,{$$slots:i={},$$scope:f}=e,{marker:g=void 0}=e,{lngLat:_}=e,{class:s=void 0}=e,{interactive:r=!0}=e,{asButton:u=!1}=e,{draggable:c=!1}=e,{feature:d=null}=e,{offset:m=void 0}=e,{zIndex:h=void 0}=e,{rotation:C=0}=e,{opacity:F=1}=e;const y=xe(),{map:Le,layerEvent:be,self:pe}=st();P(o,Le,b=>n(27,a=b)),P(o,be,b=>n(26,t=b)),P(o,pe,b=>n(3,l=b));function Ke(b){B(pe,l=new it.Marker({element:b,rotation:C,draggable:c,offset:m,opacity:F.toString()}).setLngLat(_).addTo(a),l),n(11,g=l);const Z=()=>q("dragstart"),x=()=>{we(),q("drag")},ee=()=>{we(),q("dragend")};return c&&(l.on("dragstart",Z),l.on("drag",x),l.on("dragend",ee)),{destroy(){c&&(l==null||l.off("dragstart",Z),l==null||l.off("drag",x),l==null||l.off("dragend",ee)),n(11,g=void 0),l==null||l.remove()}}}function we(){let b=l==null?void 0:l.getLngLat();b&&(Array.isArray(_)?n(10,_=[b.lng,b.lat]):_&&"lon"in _?n(10,_={lon:b.lng,lat:b.lat}):n(10,_=b))}function Oe(b){b.key===" "&&(b.preventDefault(),b.stopPropagation(),q("click"))}function q(b){if(!r)return;let Z=l==null?void 0:l.getLngLat();if(!Z)return;const x=[Z.lng,Z.lat];let ee={map:a,marker:l,lngLat:x,features:[{type:"Feature",properties:(d==null?void 0:d.properties)??{},geometry:{type:"Point",coordinates:x}}]};B(be,t={...ee,layerType:"marker",type:b},t),y(b,ee)}const We=()=>q("click"),je=()=>q("dblclick"),Fe=()=>q("contextmenu"),He=b=>{q("mouseenter")},Ye=()=>{q("mouseleave")},Ze=()=>q("mousemove");return o.$$set=b=>{"marker"in b&&n(11,g=b.marker),"lngLat"in b&&n(10,_=b.lngLat),"class"in b&&n(0,s=b.class),"interactive"in b&&n(12,r=b.interactive),"asButton"in b&&n(1,u=b.asButton),"draggable"in b&&n(13,c=b.draggable),"feature"in b&&n(14,d=b.feature),"offset"in b&&n(15,m=b.offset),"zIndex"in b&&n(2,h=b.zIndex),"rotation"in b&&n(16,C=b.rotation),"opacity"in b&&n(17,F=b.opacity),"$$scope"in b&&n(18,f=b.$$scope)},o.$$.update=()=>{o.$$.dirty&1032&&(l==null||l.setLngLat(_)),o.$$.dirty&32776&&(l==null||l.setOffset(m??[0,0])),o.$$.dirty&65544&&(l==null||l.setRotation(C)),o.$$.dirty&131080&&(l==null||l.setOpacity(F.toString()))},[s,u,h,l,Le,be,pe,Ke,Oe,q,_,g,r,c,d,m,C,F,f,i,We,je,Fe,He,Ye,Ze]}class Pe extends W{constructor(e){super(),j(this,e,Mt,At,O,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}function Vt(o){let e;const n=o[8].default,t=ne(n,o,o[15],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&32768)&&le(t,n,l,l[15],e?ae(n,l[15],a,null):oe(l[15]),null)},i(l){e||(k(t,l),e=!0)},o(l){L(t,l),e=!1},d(l){t&&t.d(l)}}}function qt(o){let e,n;return e=new ut({props:{id:o[0],type:"raster",source:o[1],beforeId:o[2],beforeLayerType:o[3],paint:o[4],layout:o[5],minzoom:o[6],maxzoom:o[7],$$slots:{default:[Vt]},$$scope:{ctx:o}}}),e.$on("click",o[9]),e.$on("dblclick",o[10]),e.$on("contextmenu",o[11]),e.$on("mouseenter",o[12]),e.$on("mousemove",o[13]),e.$on("mouseleave",o[14]),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.id=t[0]),l&2&&(a.source=t[1]),l&4&&(a.beforeId=t[2]),l&8&&(a.beforeLayerType=t[3]),l&16&&(a.paint=t[4]),l&32&&(a.layout=t[5]),l&64&&(a.minzoom=t[6]),l&128&&(a.maxzoom=t[7]),l&32768&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Gt(o,e,n){let{$$slots:t={},$$scope:l}=e,{id:a=Ge("raster-layer")}=e,{source:i=void 0}=e,{beforeId:f=void 0}=e,{beforeLayerType:g=void 0}=e,{paint:_}=e,{layout:s=void 0}=e,{minzoom:r=void 0}=e,{maxzoom:u=void 0}=e;function c(y){H.call(this,o,y)}function d(y){H.call(this,o,y)}function m(y){H.call(this,o,y)}function h(y){H.call(this,o,y)}function C(y){H.call(this,o,y)}function F(y){H.call(this,o,y)}return o.$$set=y=>{"id"in y&&n(0,a=y.id),"source"in y&&n(1,i=y.source),"beforeId"in y&&n(2,f=y.beforeId),"beforeLayerType"in y&&n(3,g=y.beforeLayerType),"paint"in y&&n(4,_=y.paint),"layout"in y&&n(5,s=y.layout),"minzoom"in y&&n(6,r=y.minzoom),"maxzoom"in y&&n(7,u=y.maxzoom),"$$scope"in y&&n(15,l=y.$$scope)},[a,i,f,g,_,s,r,u,t,c,d,m,h,C,F,l]}class Ut extends W{constructor(e){super(),j(this,e,Gt,qt,O,{id:0,source:1,beforeId:2,beforeLayerType:3,paint:4,layout:5,minzoom:6,maxzoom:7})}}const{window:Kt}=ft;function Ot(o){let e;return{c(){e=G("StreetView")},l(n){e=U(n,"StreetView")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Te(o){let e,n,t;function l(i){o[5](i)}let a={legend:"Source",choices:[["google","Google StreetView"],["bing","Bing Streetside"]],inlineSmall:!0};return o[1]!==void 0&&(a.value=o[1]),e=new Lt({props:a}),se.push(()=>_e(e,"value",l)),{c(){A(e.$$.fragment)},l(i){R(e.$$.fragment,i)},m(i,f){M(e,i,f),t=!0},p(i,f){const g={};!n&&f&2&&(n=!0,g.value=i[1],ge(()=>n=!1)),e.$set(g)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){L(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Wt(o){let e,n,t,l,a,i,f;function g(r){o[4](r)}let _={$$slots:{default:[Ot]},$$scope:{ctx:o}};o[0]!==void 0&&(_.checked=o[0]),e=new kt({props:_}),se.push(()=>_e(e,"checked",g));let s=o[0]&&Te(o);return{c(){A(e.$$.fragment),t=z(),s&&s.c(),l=K()},l(r){R(e.$$.fragment,r),t=D(r),s&&s.l(r),l=K()},m(r,u){M(e,r,u),w(r,t,u),s&&s.m(r,u),w(r,l,u),a=!0,i||(f=N(Kt,"keydown",o[2]),i=!0)},p(r,[u]){const c={};u&512&&(c.$$scope={dirty:u,ctx:r}),!n&&u&1&&(n=!0,c.checked=r[0],ge(()=>n=!1)),e.$set(c),r[0]?s?(s.p(r,u),u&1&&k(s,1)):(s=Te(r),s.c(),k(s,1),s.m(l.parentNode,l)):s&&(X(),L(s,1,1,()=>{s=null}),$())},i(r){a||(k(e.$$.fragment,r),k(s),a=!0)},o(r){L(e.$$.fragment,r),L(s),a=!1},d(r){r&&(p(t),p(l)),V(e,r),s&&s.d(r),i=!1,f()}}}function jt(o,e,n){let{map:t}=e,{enabled:l=!1}=e,a="google";function i(){t.on("click",g),t.getCanvas().style.cursor="zoom-in"}function f(){t.off("click",g),t.getCanvas().style.cursor="auto"}Ve(f);function g(u){window.open(a=="google"?Ft(u.lngLat.toArray()):Ht(u.lngLat.toArray()),"_blank"),n(0,l=!1)}function _(u){l&&u.key=="Escape"&&n(0,l=!1)}function s(u){l=u,n(0,l)}function r(u){a=u,n(1,a)}return o.$$set=u=>{"map"in u&&n(3,t=u.map),"enabled"in u&&n(0,l=u.enabled)},o.$$.update=()=>{o.$$.dirty&1&&(l?i():f())},[l,a,_,t,s,r]}class kn extends W{constructor(e){super(),j(this,e,jt,Wt,O,{map:3,enabled:0})}}function vn(o){return ct(o)}function Ft(o){return`http://maps.google.com/maps?q=&layer=c&cbll=${o[1]},${o[0]}&cbp=11,0,0,0,0`}function Ht(o){return`https://www.bing.com/maps?cp=${o[1]}~${o[0]}&style=x`}const te=ie(!1),fe=ie(null),ce=ie(100),J=ie({lng:0,lat:0}),Q=ie({lng:0,lat:0});function Yt(o){let e,n;return e=new qe({props:{$$slots:{default:[Jt]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&8192&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Zt(o){let e,n,t="Georeference an image",l,a,i,f,g,_,s,r=`Note this image isn't saved as part of this scheme. When you close this
      page, it'll be lost.`,u;a=new _t({props:{$$slots:{default:[$t]},$$scope:{ctx:o}}}),f=new gt({props:{label:"Load an image",id:"load-image",$$slots:{default:[xt]},$$scope:{ctx:o}}});let c=o[3]&&Ae(o);return{c(){e=E("div"),n=E("h2"),n.textContent=t,l=z(),A(a.$$.fragment),i=z(),A(f.$$.fragment),g=z(),c&&c.c(),_=z(),s=E("p"),s.textContent=r,this.h()},l(d){e=I(d,"DIV",{style:!0});var m=T(e);n=I(m,"H2",{"data-svelte-h":!0}),re(n)!=="svelte-fociiu"&&(n.textContent=t),l=D(m),R(a.$$.fragment,m),i=D(m),R(f.$$.fragment,m),g=D(m),c&&c.l(m),_=D(m),s=I(m,"P",{"data-svelte-h":!0}),re(s)!=="svelte-d8uklv"&&(s.textContent=r),m.forEach(p),this.h()},h(){Y(e,"border","1px solid black"),Y(e,"padding","4px")},m(d,m){w(d,e,m),S(e,n),S(e,l),M(a,e,null),S(e,i),M(f,e,null),S(e,g),c&&c.m(e,null),S(e,_),S(e,s),u=!0},p(d,m){const h={};m&8202&&(h.$$scope={dirty:m,ctx:d}),a.$set(h);const C={};m&8193&&(C.$$scope={dirty:m,ctx:d}),f.$set(C),d[3]?c?c.p(d,m):(c=Ae(d),c.c(),c.m(e,_)):c&&(c.d(1),c=null)},i(d){u||(k(a.$$.fragment,d),k(f.$$.fragment,d),u=!0)},o(d){L(a.$$.fragment,d),L(f.$$.fragment,d),u=!1},d(d){d&&p(e),V(a),V(f),c&&c.d()}}}function Jt(o){let e;return{c(){e=G("Georeference an image")},l(n){e=U(n,"Georeference an image")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Qt(o){let e;return{c(){e=G("Save")},l(n){e=U(n,"Save")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Xt(o){let e;return{c(){e=G("Delete")},l(n){e=U(n,"Delete")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function $t(o){let e,n,t,l;return e=new mt({props:{$$slots:{default:[Qt]},$$scope:{ctx:o}}}),e.$on("click",o[7]),t=new nt({props:{disabled:!o[3],$$slots:{default:[Xt]},$$scope:{ctx:o}}}),t.$on("click",o[5]),{c(){A(e.$$.fragment),n=z(),A(t.$$.fragment)},l(a){R(e.$$.fragment,a),n=D(a),R(t.$$.fragment,a)},m(a,i){M(e,a,i),w(a,n,i),M(t,a,i),l=!0},p(a,i){const f={};i&8192&&(f.$$scope={dirty:i,ctx:a}),e.$set(f);const g={};i&8&&(g.disabled=!a[3]),i&8192&&(g.$$scope={dirty:i,ctx:a}),t.$set(g)},i(a){l||(k(e.$$.fragment,a),k(t.$$.fragment,a),l=!0)},o(a){L(e.$$.fragment,a),L(t.$$.fragment,a),l=!1},d(a){a&&p(n),V(e,a),V(t,a)}}}function xt(o){let e,n,t;return{c(){e=E("input"),this.h()},l(l){e=I(l,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){v(e,"class","govuk-file-upload"),v(e,"id","load-image"),v(e,"type","file")},m(l,a){w(l,e,a),o[8](e),n||(t=N(e,"change",o[4]),n=!0)},p:he,d(l){l&&p(e),o[8](null),n=!1,t()}}}function Ae(o){let e,n,t,l,a,i,f,g;return{c(){e=E("div"),n=E("label"),t=E("input"),l=G(`
          Opacity: `),a=G(o[2]),i=G("%"),this.h()},l(_){e=I(_,"DIV",{});var s=T(e);n=I(s,"LABEL",{});var r=T(n);t=I(r,"INPUT",{type:!0,min:!0,max:!0}),l=U(r,`
          Opacity: `),a=U(r,o[2]),i=U(r,"%"),r.forEach(p),s.forEach(p),this.h()},h(){v(t,"type","range"),v(t,"min","0"),v(t,"max","100")},m(_,s){w(_,e,s),S(e,n),S(n,t),de(t,o[2]),S(n,l),S(n,a),S(n,i),f||(g=[N(t,"change",o[9]),N(t,"input",o[9])],f=!0)},p(_,s){s&4&&de(t,_[2]),s&4&&ye(a,_[2])},d(_){_&&p(e),f=!1,me(g)}}}function en(o){let e,n,t,l,a,i;const f=[Zt,Yt],g=[];function _(s,r){return s[1]?0:1}return e=_(o),n=g[e]=f[e](o),{c(){n.c(),t=K()},l(s){n.l(s),t=K()},m(s,r){g[e].m(s,r),w(s,t,r),l=!0,a||(i=N(window,"keydown",o[6]),a=!0)},p(s,[r]){let u=e;e=_(s),e===u?g[e].p(s,r):(X(),L(g[u],1,1,()=>{g[u]=null}),$(),n=g[e],n?n.p(s,r):(n=g[e]=f[e](s),n.c()),k(n,1),n.m(t.parentNode,t))},i(s){l||(k(n),l=!0)},o(s){L(n),l=!1},d(s){s&&p(t),g[e].d(s),a=!1,i()}}}function tn(o,e,n){let t,l,a,i,f;P(o,te,h=>n(1,t=h)),P(o,ce,h=>n(2,l=h)),P(o,fe,h=>n(3,a=h)),P(o,Q,h=>n(11,i=h)),P(o,J,h=>n(12,f=h));let g;async function _(h){let C=await g.files[0].arrayBuffer(),F=new Blob([new Uint8Array(C)]);B(fe,a=URL.createObjectURL(F),a),B(J,f={lng:0,lat:0},f),B(Q,i={lng:0,lat:0},i)}function s(){B(fe,a=null,a),B(ce,l=100,l)}function r(h){t&&h.key=="Escape"&&(h.stopPropagation(),B(te,t=!1,t))}const u=()=>B(te,t=!1,t);function c(h){se[h?"unshift":"push"](()=>{g=h,n(0,g)})}function d(){l=et(this.value),ce.set(l)}return[g,t,l,a,_,s,r,u,c,d,()=>B(te,t=!0,t)]}class yn extends W{constructor(e){super(),j(this,e,tn,en,O,{})}}function Re(o){let e,n;return e=new Pt({props:{url:o[2],coordinates:[[o[0].lng,o[0].lat],[o[3].lng,o[0].lat],[o[3].lng,o[3].lat],[o[0].lng,o[3].lat]],$$slots:{default:[nn]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.url=t[2]),l&9&&(a.coordinates=[[t[0].lng,t[0].lat],[t[3].lng,t[0].lat],[t[3].lng,t[3].lat],[t[0].lng,t[3].lat]]),l&272&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function nn(o){let e,n;return e=new Ut({props:{paint:{"raster-fade-duration":0,"raster-opacity":o[4]/100}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&16&&(a.paint={"raster-fade-duration":0,"raster-opacity":t[4]/100}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Me(o){let e,n,t,l,a,i;function f(r){o[6](r)}let g={draggable:!0,$$slots:{default:[ln]},$$scope:{ctx:o}};o[0]!==void 0&&(g.lngLat=o[0]),e=new Pe({props:g}),se.push(()=>_e(e,"lngLat",f));function _(r){o[7](r)}let s={draggable:!0,$$slots:{default:[on]},$$scope:{ctx:o}};return o[3]!==void 0&&(s.lngLat=o[3]),l=new Pe({props:s}),se.push(()=>_e(l,"lngLat",_)),{c(){A(e.$$.fragment),t=z(),A(l.$$.fragment)},l(r){R(e.$$.fragment,r),t=D(r),R(l.$$.fragment,r)},m(r,u){M(e,r,u),w(r,t,u),M(l,r,u),i=!0},p(r,u){const c={};u&256&&(c.$$scope={dirty:u,ctx:r}),!n&&u&1&&(n=!0,c.lngLat=r[0],ge(()=>n=!1)),e.$set(c);const d={};u&256&&(d.$$scope={dirty:u,ctx:r}),!a&&u&8&&(a=!0,d.lngLat=r[3],ge(()=>a=!1)),l.$set(d)},i(r){i||(k(e.$$.fragment,r),k(l.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),L(l.$$.fragment,r),i=!1},d(r){r&&p(t),V(e,r),V(l,r)}}}function ln(o){let e;return{c(){e=E("span"),this.h()},l(n){e=I(n,"SPAN",{class:!0,style:!0}),T(e).forEach(p),this.h()},h(){v(e,"class","dot svelte-1tmbx1c"),Y(e,"background-color","red")},m(n,t){w(n,e,t)},p:he,d(n){n&&p(e)}}}function on(o){let e;return{c(){e=E("span"),this.h()},l(n){e=I(n,"SPAN",{class:!0,style:!0}),T(e).forEach(p),this.h()},h(){v(e,"class","dot svelte-1tmbx1c"),Y(e,"background-color","blue")},m(n,t){w(n,e,t)},p:he,d(n){n&&p(e)}}}function an(o){let e,n,t,l=o[2]&&o[0].lng!=o[3].lng&&Re(o),a=o[2]&&o[1]&&Me(o);return{c(){l&&l.c(),e=z(),a&&a.c(),n=K()},l(i){l&&l.l(i),e=D(i),a&&a.l(i),n=K()},m(i,f){l&&l.m(i,f),w(i,e,f),a&&a.m(i,f),w(i,n,f),t=!0},p(i,[f]){i[2]&&i[0].lng!=i[3].lng?l?(l.p(i,f),f&13&&k(l,1)):(l=Re(i),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(X(),L(l,1,1,()=>{l=null}),$()),i[2]&&i[1]?a?(a.p(i,f),f&6&&k(a,1)):(a=Me(i),a.c(),k(a,1),a.m(n.parentNode,n)):a&&(X(),L(a,1,1,()=>{a=null}),$())},i(i){t||(k(l),k(a),t=!0)},o(i){L(l),L(a),t=!1},d(i){i&&(p(e),p(n)),l&&l.d(i),a&&a.d(i)}}}function rn(o,e,n){let t,l,a,i,f;P(o,Q,r=>n(3,t=r)),P(o,J,r=>n(0,l=r)),P(o,te,r=>n(1,a=r)),P(o,fe,r=>n(2,i=r)),P(o,ce,r=>n(4,f=r));let{map:g}=e;function _(r){l=r,J.set(l)}function s(r){t=r,Q.set(t)}return o.$$set=r=>{"map"in r&&n(5,g=r.map)},o.$$.update=()=>{if(o.$$.dirty&39&&i&&a&&l.lng==0&&l.lat==0){let r=g.getBounds();B(J,l.lng=r.getWest()+.4*(r.getEast()-r.getWest()),l),B(Q,t.lng=r.getWest()+.6*(r.getEast()-r.getWest()),t),B(J,l.lat=r.getNorth()+.4*(r.getSouth()-r.getNorth()),l),B(Q,t.lat=r.getNorth()+.6*(r.getSouth()-r.getNorth()),t)}},[l,a,i,t,f,g,_,s]}class Ln extends W{constructor(e){super(),j(this,e,rn,an,O,{map:5})}}export{pn as B,yn as G,Pe as M,Lt as R,kn as S,vn as a,Ht as b,Ln as c,Ft as s};
