import{s as C}from"./index.C9YNc8kA.js";import{n as x}from"./data.DEry3m_x.js";let S={Walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],"Horse Riding":[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},b={Walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},v={Walking:[0,1,3,5,6,7,8,9,10,14,15],Wheeling:[0,1,3,5,6,7,8,9,10,14,15],Cycling:[0,1,2,4,7,8,11,12,13,15]};function A(e){let i=e.summary.checkType=="street",l=e.summary.checkType=="path",s=o("Safety",e.safetyCheck,null),t=[s];i?(t.push(o("Accessibility",e.streetCheck,[0,6])),t.push(o("Comfort",e.streetCheck,[7,9])),t.push(o("Directness",e.streetCheck,[10,15])),t.push(o("Attractiveness",e.streetCheck,[16,21])),t.push(o("Cohesion",e.streetCheck,[22,25]))):l&&(t.push(o("Accessibility",e.pathCheck,[0,4])),t.push(o("Comfort",e.pathCheck,[5,15])),t.push(o("Directness",e.pathCheck,[16,19])),t.push(o("Attractiveness",e.pathCheck,[20,24])),t.push(o("Cohesion",e.pathCheck,[25,29])));let n={category:"overall",existing:u(t.map(c=>c.existing)),proposed:u(t.map(c=>c.proposed))},r=[];i?(r.push(o("Social activity",e.streetPlacemakingCheck,[0,2])),r.push(o("Personal security",e.streetPlacemakingCheck,[3,5])),r.push(o("Character and legibility",e.streetPlacemakingCheck,[6,15])),r.push(o("Environment",e.streetPlacemakingCheck,[16,25]))):l&&r.push(o("Social activity",e.pathPlacemakingCheck,[0,2]),o("Personal security",e.pathPlacemakingCheck,[3,5]),o("Character and legibility",e.pathPlacemakingCheck,[6,9]),o("Environment",e.pathPlacemakingCheck,[10,18]));let p={category:"overall",existing:u(r.map(c=>c.existing)),proposed:u(r.map(c=>c.proposed))},a=[];i?a=P(e.safetyCheck,e.streetCheck,b):l&&(a=P(e.safetyCheck,e.pathCheck,S));let h=W(e);return{safetyCheck:s,streetCheck:i?d(s,o("",e.streetCheck,null)):null,streetPlacemaking:i?o("",e.streetPlacemakingCheck,null):null,pathCheck:l?d(s,o("",e.pathCheck,null)):null,pathPlacemaking:l?o("",e.pathPlacemakingCheck,null):null,levelOfService:t,overall:n,placemakingCategories:r,placemakingOverall:p,byMode:a,jat:h}}function o(e,i,l){return{category:e,existing:y(i.existingScores,e,l),proposed:y(i.proposedScores,e,l)}}function y(e,i,l){let s=l||[0,e.length-1],t=s[0],n=s[1]+1;return g(e.slice(t,n),i)}function g(e,i){let l=e.filter(p=>p!="N/A").length,s=i=="Safety"?3:1,t=l*2*s,n=s*C(e.map(x)),r=n/t*100;return{numberMetrics:l,totalPossibleScore:t,score:n,scorePercent:r}}function u(e){let i=C(e.map(n=>n.numberMetrics)),l=C(e.map(n=>n.totalPossibleScore)),s=C(e.map(n=>n.score)),t=s/l*100;return{numberMetrics:i,totalPossibleScore:l,score:s,scorePercent:t}}function d(e,i){return{category:"",existing:u([e.existing,i.existing]),proposed:u([e.proposed,i.proposed])}}function I(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function P(e,i,l){let s=[];for(let[t,n]of Object.entries(l)){let r=v[t]||[],p={category:"Safety",existing:g(m(e.existingScores,r),"Safety"),proposed:g(m(e.proposedScores,r),"Safety")},a={category:"",existing:g(m(i.existingScores,n),""),proposed:g(m(i.proposedScores,n),"")},h=d(p,a);h.category=t,s.push(h)}return s}function m(e,i){return i.map(l=>e[l])}function W(e){let i={0:0,1:1,2:2,X:0},l=[];for(let s of e.jat){let t={walkingWheeling:{existing:"",proposed:""},cycling:{existing:"",proposed:""},total:{existing:"",proposed:""}};for(let n of["existing","proposed"]){let r=0,p=0,a=0,h=0,c=0,f=0;for(let k of s[n].movements)k.kind=="pedestrian"?(r+=i[k.score],p+=2):(a+=i[k.score],h+=2),c+=i[k.score],f+=2;t.walkingWheeling[n]=p>0?`${r/p*100}%`:"Not Completed",t.cycling[n]=h>0?`${a/h*100}%`:"Not Comleted",t.total[n]=f>0?`${c/f*100}%`:"Not Completed"}l.push(t)}return l}export{A as g,I as n};
