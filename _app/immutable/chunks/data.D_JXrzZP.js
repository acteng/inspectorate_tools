import{w as n}from"./index.De--Vkkd.js";import{r as a}from"./index.BOI6urGX.js";import{I as c}from"./scheduler.HrLheCwp.js";let r="route-check/",s=n(p()),l=n("");f();function f(){console.log("Initial load; trying to open last opened file");let e=window.localStorage.getItem(`${r}last-opened-file`);if(e)try{let o=g(e);l.set(e),s.set(o);return}catch(o){window.alert(`The last opened file ${e} has a problem: ${o}`)}console.log("Starting with a new file");let t=m();l.set(t)}s.subscribe(e=>{let t=c(l);t&&window.localStorage.setItem(`${r}${t}`,JSON.stringify(e))});l.subscribe(e=>{e&&window.localStorage.setItem(`${r}last-opened-file`,e)});function g(e){console.log(`Loading ${e}`);let t=window.localStorage.getItem(`${r}${e}`);if(!t)throw new Error(`Key not in local storage: ${e}`);let o=JSON.parse(t);if(!o.criticalIssues)throw new Error("File format appears outdated");return o}function m(){let e=d();for(let t=1;t<=e.length+1;t++){let o=`untitled${t}`;if(!e.includes(o))return o}throw new Error("Couldn't make a new filename; this shouldn't be possible")}function d(){let e=[];for(let t=0;t<window.localStorage.length;t++){let o=window.localStorage.key(t);o.startsWith(r)&&o!=`${r}last-opened-file`&&e.push(o.slice(r.length))}return e.sort(),e}function p(){return{summary:{dateDesignReview:"",schemeReference:"",schemeName:"",schemeSummary:"",schemeInfoReviewed:"",authority:"",transportOrCombinedAuthority:"",region:"",fundingProgramme:"",designStage:"",fundingConditions:"",inspectorEmail:"",assessedRouteLengthKm:"",totalRouteLengthKm:"",notes:"",checkType:""},policyCheck:a(6,{existing:"",proposed:"",commentary:""}),policyConflictLog:[],safetyCheck:i(16),criticalIssues:[],streetCheck:i(26),streetPlacemakingCheck:i(26),pathCheck:i(30),pathPlacemakingCheck:i(19)}}function i(e){return{existingScores:Array(e).fill(""),proposedScores:Array(e).fill(""),existingScoreNotes:Array(e).fill(""),proposedScoreNotes:Array(e).fill("")}}export{l as c,p as e,d as g,g as l,m as n,s};
