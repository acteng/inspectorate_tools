import{s as _e,B as Fe,i as B,n as oe,f as p,e as b,a as I,t as D,c as k,b as L,g as y,d as R,o as C,h as c,j as ge,Q as Re,z as Ne,v as Ve,m as $e,r as Ge,R as Ie,S as re}from"./scheduler.BJ06nkRu.js";import{S as ve,i as we,c as j,a as Y,m as H,t as E,b as S,d as P,g as ye,f as Ce}from"./index.Dmc4uC9p.js";import{e as Ee}from"./each.Bf3jp4ps.js";import{b as ie}from"./paths.CSQHXeWQ.js";import{B as je,C as Ye}from"./ClickableCard.DfItUd2y.js";import{F as He}from"./FileInput.DbvGerB6.js";import{S as he,W as Pe}from"./WarningButton.DB4trw2r.js";/* empty css                                                       */import{a as Ae}from"./index.Cid8Gt9s.js";import{F as Xe}from"./FormElement.qqY4z03n.js";import"./index.WegncNJ8.js";function xe(l){let e,t,n,r,o,s,a;return{c(){e=b("div"),t=b("div"),n=b("progress"),r=I(),o=b("div"),s=b("h3"),a=D(l[0]),this.h()},l(m){e=k(m,"DIV",{class:!0});var i=L(e);t=k(i,"DIV",{class:!0});var h=L(t);n=k(h,"PROGRESS",{}),L(n).forEach(p),r=y(h),o=k(h,"DIV",{class:!0});var _=L(o);s=k(_,"H3",{});var A=L(s);a=R(A,l[0]),A.forEach(p),_.forEach(p),h.forEach(p),i.forEach(p),this.h()},h(){C(o,"class","govuk-prose"),C(t,"class","inner svelte-ho9d42"),C(e,"class","outer svelte-ho9d42")},m(m,i){B(m,e,i),c(e,t),c(t,n),c(t,r),c(t,o),c(o,s),c(s,a)},p(m,i){i&1&&ge(a,m[0])},d(m){m&&p(e)}}}function Je(l){let e,t=l[0]&&xe(l);return{c(){t&&t.c(),e=Fe()},l(n){t&&t.l(n),e=Fe()},m(n,r){t&&t.m(n,r),B(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=xe(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:oe,o:oe,d(n){n&&p(e),t&&t.d(n)}}}function Oe(l,e,t){let{loading:n}=e;return l.$$set=r=>{"loading"in r&&t(0,n=r.loading)},[n]}class Ue extends ve{constructor(e){super(),we(this,e,Oe,Je,_e,{loading:0})}}function qe(l){let e,t,n;return{c(){e=b("input"),this.h()},l(r){e=k(r,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){C(e,"class","govuk-file-upload"),C(e,"id","import-xlsx"),C(e,"type","file")},m(r,o){B(r,e,o),l[4](e),t||(n=Ne(e,"change",l[2]),t=!0)},p:oe,d(r){r&&p(e),l[4](null),t=!1,n()}}}function ze(l){let e,t,n,r;return e=new Xe({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[qe]},$$scope:{ctx:l}}}),n=new Ue({props:{loading:l[0]}}),{c(){j(e.$$.fragment),t=I(),j(n.$$.fragment)},l(o){Y(e.$$.fragment,o),t=y(o),Y(n.$$.fragment,o)},m(o,s){H(e,o,s),B(o,t,s),H(n,o,s),r=!0},p(o,[s]){const a={};s&66&&(a.$$scope={dirty:s,ctx:o}),e.$set(a);const m={};s&1&&(m.loading=o[0]),n.$set(m)},i(o){r||(E(e.$$.fragment,o),E(n.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),r=!1},d(o){o&&p(t),P(e,o),P(n,o)}}}function We(l,e,t){let n=Re(),{xlsxImporter:r}=e,o="",s;async function a(i){let h=s.files[0].name;try{t(0,o=`Loading ${h}`);let _=await s.files[0].arrayBuffer(),A=await r(_);t(0,o=""),n("imported",{filename:Ae(h,".xlsx"),data:A})}catch(_){window.alert(`Couldn't import ${h}: ${_}`),t(0,o="")}}function m(i){Ve[i?"unshift":"push"](()=>{s=i,t(1,s)})}return l.$$set=i=>{"xlsxImporter"in i&&t(3,r=i.xlsxImporter)},[o,s,a,r,m]}class Ke extends ve{constructor(e){super(),we(this,e,We,ze,_e,{xlsxImporter:3})}}function Se(l,e,t){const n=l.slice();return n[15]=e[t],n}function Me(l){let e;return{c(){e=D("Rename this file")},l(t){e=R(t,"Rename this file")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function Qe(l){let e;return{c(){e=D("Export this file")},l(t){e=R(t,"Export this file")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function Te(l){let e;return{c(){e=D("Delete this file")},l(t){e=R(t,"Delete this file")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function Ze(l){let e,t,n,r,o,s;return e=new he({props:{$$slots:{default:[Me]},$$scope:{ctx:l}}}),e.$on("click",l[6]),n=new he({props:{$$slots:{default:[Qe]},$$scope:{ctx:l}}}),n.$on("click",l[7]),o=new Pe({props:{$$slots:{default:[Te]},$$scope:{ctx:l}}}),o.$on("click",l[8]),{c(){j(e.$$.fragment),t=I(),j(n.$$.fragment),r=I(),j(o.$$.fragment)},l(a){Y(e.$$.fragment,a),t=y(a),Y(n.$$.fragment,a),r=y(a),Y(o.$$.fragment,a)},m(a,m){H(e,a,m),B(a,t,m),H(n,a,m),B(a,r,m),H(o,a,m),s=!0},p(a,m){const i={};m&262144&&(i.$$scope={dirty:m,ctx:a}),e.$set(i);const h={};m&262144&&(h.$$scope={dirty:m,ctx:a}),n.$set(h);const _={};m&262144&&(_.$$scope={dirty:m,ctx:a}),o.$set(_)},i(a){s||(E(e.$$.fragment,a),E(n.$$.fragment,a),E(o.$$.fragment,a),s=!0)},o(a){S(e.$$.fragment,a),S(n.$$.fragment,a),S(o.$$.fragment,a),s=!1},d(a){a&&(p(t),p(r)),P(e,a),P(n,a),P(o,a)}}}function et(l){let e;return{c(){e=D("New blank file")},l(t){e=R(t,"New blank file")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function Le(l){let e,t;return e=new Ke({props:{xlsxImporter:l[3]}}),e.$on("imported",l[11]),{c(){j(e.$$.fragment)},l(n){Y(e.$$.fragment,n)},m(n,r){H(e,n,r),t=!0},p(n,r){const o={};r&8&&(o.xlsxImporter=n[3]),e.$set(o)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){P(e,n)}}}function tt(l){let e=l[15]===l[5]?"Already selected":"",t,n;return{c(){t=D(e),n=I()},l(r){t=R(r,e),n=y(r)},m(r,o){B(r,t,o),B(r,n,o)},p(r,o){o&48&&e!==(e=r[15]===r[5]?"Already selected":"")&&ge(t,e)},d(r){r&&(p(t),p(n))}}}function Be(l){let e,t;function n(){return l[13](l[15])}return e=new Ye({props:{name:`File name: ${l[15]}`,disabled:l[15]===l[5],$$slots:{default:[tt]},$$scope:{ctx:l}}}),e.$on("click",n),{c(){j(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,o){H(e,r,o),t=!0},p(r,o){l=r;const s={};o&16&&(s.name=`File name: ${l[15]}`),o&48&&(s.disabled=l[15]===l[5]),o&262192&&(s.$$scope={dirty:o,ctx:l}),e.$set(s)},i(r){t||(E(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function nt(l){let e,t,n,r,o,s,a=`All files are auto-saved in your browser's local storage. You can close your
    browser and resume later. You can export the file to your computer to share
    with someone else, and import from a file below.`,m,i,h,_,A,X,te,N,ne,Z,le,V,v,O,d="Create or import a file",x,F,U,W,fe,ue,J,ee,be="Load a saved file",ce,me,q,de,se,K;N=new je({props:{$$slots:{default:[Ze]},$$scope:{ctx:l}}}),F=new he({props:{$$slots:{default:[et]},$$scope:{ctx:l}}}),F.$on("click",l[9]),W=new He({props:{label:"Import from a .json file",onLoad:l[10]}});let g=l[3]!=null&&Le(l),M=Ee(l[4]),$=[];for(let f=0;f<M.length;f+=1)$[f]=Be(Se(l,M,f));const De=f=>S($[f],1,1,()=>{$[f]=null});return{c(){e=b("div"),t=b("a"),n=D("Back to overview"),o=I(),s=b("p"),s.textContent=a,m=I(),i=b("p"),h=D("You're currently editing "),_=b("u"),A=D(l[5]),X=D(`
    .`),te=I(),j(N.$$.fragment),ne=I(),Z=b("hr"),le=I(),V=b("div"),v=b("div"),O=b("h2"),O.textContent=d,x=I(),j(F.$$.fragment),U=I(),j(W.$$.fragment),fe=I(),g&&g.c(),ue=I(),J=b("div"),ee=b("h2"),ee.textContent=be,ce=I();for(let f=0;f<$.length;f+=1)$[f].c();me=I(),q=b("a"),de=D("Back to overview"),this.h()},l(f){e=k(f,"DIV",{class:!0});var u=L(e);t=k(u,"A",{href:!0,class:!0});var G=L(t);n=R(G,"Back to overview"),G.forEach(p),o=y(u),s=k(u,"P",{"data-svelte-h":!0}),$e(s)!=="svelte-1yvzirp"&&(s.textContent=a),m=y(u),i=k(u,"P",{});var Q=L(i);h=R(Q,"You're currently editing "),_=k(Q,"U",{});var w=L(_);A=R(w,l[5]),w.forEach(p),X=R(Q,`
    .`),Q.forEach(p),te=y(u),Y(N.$$.fragment,u),ne=y(u),Z=k(u,"HR",{}),le=y(u),V=k(u,"DIV",{class:!0});var T=L(V);v=k(T,"DIV",{class:!0});var z=L(v);O=k(z,"H2",{"data-svelte-h":!0}),$e(O)!=="svelte-1yqhw3l"&&(O.textContent=d),x=y(z),Y(F.$$.fragment,z),U=y(z),Y(W.$$.fragment,z),fe=y(z),g&&g.l(z),z.forEach(p),ue=y(T),J=k(T,"DIV",{class:!0});var ae=L(J);ee=k(ae,"H2",{"data-svelte-h":!0}),$e(ee)!=="svelte-oj70x0"&&(ee.textContent=be),ce=y(ae);for(let pe=0;pe<$.length;pe+=1)$[pe].l(ae);ae.forEach(p),T.forEach(p),me=y(u),q=k(u,"A",{href:!0,class:!0});var ke=L(q);de=R(ke,"Back to overview"),ke.forEach(p),u.forEach(p),this.h()},h(){C(t,"href",r=ie+"/"+l[0].prefix),C(t,"class","govuk-back-link"),C(v,"class","govuk-grid-column-one-half"),C(J,"class","govuk-grid-column-one-half"),C(V,"class","govuk-grid-row"),C(q,"href",se=ie+"/"+l[0].prefix),C(q,"class","govuk-back-link"),C(e,"class","govuk-width-container")},m(f,u){B(f,e,u),c(e,t),c(t,n),c(e,o),c(e,s),c(e,m),c(e,i),c(i,h),c(i,_),c(_,A),c(i,X),c(e,te),H(N,e,null),c(e,ne),c(e,Z),c(e,le),c(e,V),c(V,v),c(v,O),c(v,x),H(F,v,null),c(v,U),H(W,v,null),c(v,fe),g&&g.m(v,null),c(V,ue),c(V,J),c(J,ee),c(J,ce);for(let G=0;G<$.length;G+=1)$[G]&&$[G].m(J,null);c(e,me),c(e,q),c(q,de),K=!0},p(f,[u]){(!K||u&1&&r!==(r=ie+"/"+f[0].prefix))&&C(t,"href",r),(!K||u&32)&&ge(A,f[5]);const G={};u&262144&&(G.$$scope={dirty:u,ctx:f}),N.$set(G);const Q={};if(u&262144&&(Q.$$scope={dirty:u,ctx:f}),F.$set(Q),f[3]!=null?g?(g.p(f,u),u&8&&E(g,1)):(g=Le(f),g.c(),E(g,1),g.m(v,null)):g&&(ye(),S(g,1,1,()=>{g=null}),Ce()),u&4144){M=Ee(f[4]);let w;for(w=0;w<M.length;w+=1){const T=Se(f,M,w);$[w]?($[w].p(T,u),E($[w],1)):($[w]=Be(T),$[w].c(),E($[w],1),$[w].m(J,null))}for(ye(),w=M.length;w<$.length;w+=1)De(w);Ce()}(!K||u&1&&se!==(se=ie+"/"+f[0].prefix))&&C(q,"href",se)},i(f){if(!K){E(N.$$.fragment,f),E(F.$$.fragment,f),E(W.$$.fragment,f),E(g);for(let u=0;u<M.length;u+=1)E($[u]);K=!0}},o(f){S(N.$$.fragment,f),S(F.$$.fragment,f),S(W.$$.fragment,f),S(g),$=$.filter(Boolean);for(let u=0;u<$.length;u+=1)S($[u]);K=!1},d(f){f&&p(e),P(N),P(F),P(W),g&&g.d(),Ge($,f)}}}function lt(l,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",l),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function rt(l,e,t){let n,r=oe,o=()=>(r(),r=Ie(_,d=>t(14,n=d)),_),s,a=oe,m=()=>(a(),a=Ie(h,d=>t(5,s=d)),h);l.$$.on_destroy.push(()=>r()),l.$$.on_destroy.push(()=>a());let{files:i}=e,{currentFile:h}=e;m();let{state:_}=e;o();let{xlsxImporter:A=null}=e,X=i.getFileList();function te(){let d=window.prompt(`Rename file ${s} to what?`,s);if(d){let x=i.key(s),F=window.localStorage.getItem(x);window.localStorage.setItem(i.key(d),F),window.localStorage.removeItem(x),re(h,s=d,s),t(4,X=i.getFileList())}}function N(){lt(s+".json",JSON.stringify(n))}async function ne(){window.confirm(`Really delete file ${s}? You can't undo this.`)&&(window.localStorage.removeItem(i.key(s)),await Z())}async function Z(){re(h,s=i.newFilename(),s),re(_,n=i.emptyState(),n),t(4,X=i.saveAndGetFileList(s,n))}async function le(d,x){let F=Ae(d,".json");try{let U=JSON.parse(x);i.validate(U),t(4,X=i.saveAndGetFileList(F,U)),await v(F)}catch(U){window.alert(`Couldn't load ${F}: ${U}`)}}async function V(d){let{filename:x,data:F}=d.detail;t(4,X=i.saveAndGetFileList(x,F)),await v(x)}async function v(d){try{let x=i.loadFile(d);re(h,s=d,s),re(_,n=x,n)}catch(x){window.alert(`Couldn't load ${d}: ${x}`)}}const O=d=>v(d);return l.$$set=d=>{"files"in d&&t(0,i=d.files),"currentFile"in d&&m(t(1,h=d.currentFile)),"state"in d&&o(t(2,_=d.state)),"xlsxImporter"in d&&t(3,A=d.xlsxImporter)},[i,h,_,A,X,s,te,N,ne,Z,le,V,v,O]}class ht extends ve{constructor(e){super(),we(this,e,rt,nt,_e,{files:0,currentFile:1,state:2,xlsxImporter:3})}}export{ht as F};
