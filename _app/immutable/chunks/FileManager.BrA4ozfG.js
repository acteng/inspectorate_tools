import{s as ce,e as F,t as te,L as he,c as y,b as X,d as le,M as ve,f as p,q as $,i as v,h as b,n as z,a as x,g as I,T as Te,z as qe,r as Le,p as Z,l as Se,u as Me,m as He,o as Ee,ab as we,V as Q,Y as pe,w as Be}from"./scheduler.Bxdx0f0B.js";import{S as de,i as $e,c as A,a as T,m as q,t as w,b as C,d as B,g as ue,f as me,e as De}from"./index.itOPPQ0R.js";import{L as je,d as Re}from"./Loading.BCGgETkD.js";import{b as be}from"./paths.CDCLTiou.js";import{S as Ge,A as Ve}from"./ServiceHeader.BgGAq9B-.js";import{B as Ne}from"./ButtonGroup.CFC5gCUN.js";import{F as Ue}from"./FileInput.DNkHMt8o.js";import{R as Ye}from"./Radio.EiFTWAO_.js";import"./index.DB-0eukz.js";import{S as ae}from"./SecondaryButton.C3WEK5d3.js";import{W as ze}from"./WarningButton.DE8BQTXW.js";import{b as Ae,p as ke}from"./index.CovUfg5v.js";import{F as Pe}from"./FormElement.Jlp14U3V.js";import{W as Je}from"./WarningText.5NwKqynh.js";/* empty css                                                  */function We(o){let e,n,t,r;return{c(){e=F("a"),n=te(`Start
  `),t=he("svg"),r=he("path"),this.h()},l(l){e=y(l,"A",{href:!0,role:!0,draggable:!0,class:!0,"data-module":!0});var s=X(e);n=le(s,`Start
  `),t=ve(s,"svg",{class:!0,xmlns:!0,width:!0,height:!0,viewBox:!0,"aria-hidden":!0,focusable:!0});var a=X(t);r=ve(a,"path",{fill:!0,d:!0}),X(r).forEach(p),a.forEach(p),s.forEach(p),this.h()},h(){$(r,"fill","currentColor"),$(r,"d","M0 0h13l20 20-20 20H0l20-20z"),$(t,"class","govuk-button__start-icon"),$(t,"xmlns","http://www.w3.org/2000/svg"),$(t,"width","17.5"),$(t,"height","19"),$(t,"viewBox","0 0 33 40"),$(t,"aria-hidden","true"),$(t,"focusable","false"),$(e,"href",o[0]),$(e,"role","button"),$(e,"draggable","false"),$(e,"class","govuk-button govuk-button--start"),$(e,"data-module","govuk-button")},m(l,s){v(l,e,s),b(e,n),b(e,t),b(t,r)},p(l,[s]){s&1&&$(e,"href",l[0])},i:z,o:z,d(l){l&&p(e)}}}function Xe(o,e,n){let{href:t}=e;return o.$$set=r=>{"href"in r&&n(0,t=r.href)},[t]}class Ze extends de{constructor(e){super(),$e(this,e,Xe,We,ce,{href:0})}}const Oe="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000000'%3e%3cpath%20d='M200-200h57l391-391-57-57-391%20391v57Zm-80%2080v-170l528-527q12-11%2026.5-17t30.5-6q16%200%2031%206t26%2018l55%2056q12%2011%2017.5%2026t5.5%2030q0%2016-5.5%2030.5T817-647L290-120H120Zm640-584-56-56%2056%2056Zm-141%2085-28-29%2057%2057-29-28Z'/%3e%3c/svg%3e",Ke="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='white'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M6%2019c0%201.1.9%202%202%202h8c1.1%200%202-.9%202-2V7H6v12zM19%204h-3.5l-1-1h-5l-1%201H5v2h14V4z'/%3e%3c/svg%3e";function Qe(o){let e,n=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,t,r,l=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=F("p"),e.innerHTML=n,t=x(),r=F("ul"),r.innerHTML=l},l(s){e=y(s,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-1ykh4hv"&&(e.innerHTML=n),t=I(s),r=y(s,"UL",{"data-svelte-h":!0}),Z(r)!=="svelte-1tt4pqo"&&(r.innerHTML=l)},m(s,a){v(s,e,a),v(s,t,a),v(s,r,a)},p:z,d(s){s&&(p(e),p(t),p(r))}}}function et(o){let e,n,t,r,l,s;return t=new Je({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),{c(){e=F("input"),n=x(),A(t.$$.fragment),this.h()},l(a){e=y(a,"INPUT",{class:!0,id:!0,type:!0}),n=I(a),T(t.$$.fragment,a),this.h()},h(){$(e,"class","govuk-file-upload"),$(e,"id","import-xlsx"),$(e,"type","file")},m(a,_){v(a,e,_),o[4](e),v(a,n,_),q(t,a,_),r=!0,l||(s=qe(e,"change",o[2]),l=!0)},p(a,_){const d={};_&64&&(d.$$scope={dirty:_,ctx:a}),t.$set(d)},i(a){r||(w(t.$$.fragment,a),r=!0)},o(a){C(t.$$.fragment,a),r=!1},d(a){a&&(p(e),p(n)),o[4](null),B(t,a),l=!1,s()}}}function tt(o){let e,n,t,r;return e=new Pe({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[et]},$$scope:{ctx:o}}}),t=new je({props:{loading:o[0]}}),{c(){A(e.$$.fragment),n=x(),A(t.$$.fragment)},l(l){T(e.$$.fragment,l),n=I(l),T(t.$$.fragment,l)},m(l,s){q(e,l,s),v(l,n,s),q(t,l,s),r=!0},p(l,[s]){const a={};s&66&&(a.$$scope={dirty:s,ctx:l}),e.$set(a);const _={};s&1&&(_.loading=l[0]),t.$set(_)},i(l){r||(w(e.$$.fragment,l),w(t.$$.fragment,l),r=!0)},o(l){C(e.$$.fragment,l),C(t.$$.fragment,l),r=!1},d(l){l&&p(n),B(e,l),B(t,l)}}}function lt(o,e,n){let t=Te(),{xlsxImporter:r}=e,l="",s;async function a(d){let c=s.files[0].name;try{n(0,l=`Loading ${c}`);let f=await s.files[0].arrayBuffer(),i=await r(f);n(0,l=""),t("imported",{filename:Ae(c,".xlsx"),data:i})}catch(f){window.alert(`Couldn't import ${c}: ${f}`),n(0,l="")}}function _(d){Le[d?"unshift":"push"](()=>{s=d,n(1,s)})}return o.$$set=d=>{"xlsxImporter"in d&&n(3,r=d.xlsxImporter)},[l,s,a,r,_]}class st extends de{constructor(e){super(),$e(this,e,lt,tt,ce,{xlsxImporter:3})}}const nt=o=>({}),xe=o=>({}),rt=o=>({}),Ie=o=>({});function Ce(o){let e,n="<b>You are editing:</b>",t,r,l,s,a,_,d,c;return a=new Ze({props:{href:`${be}/${o[0].prefix}overview`}}),d=new Ne({props:{$$slots:{default:[ot]},$$scope:{ctx:o}}}),{c(){e=F("p"),e.innerHTML=n,t=x(),r=F("div"),l=F("input"),s=x(),A(a.$$.fragment),_=x(),A(d.$$.fragment),this.h()},l(f){e=y(f,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-st3pjg"&&(e.innerHTML=n),t=I(f),r=y(f,"DIV",{});var i=X(r);l=y(i,"INPUT",{class:!0}),s=I(i),T(a.$$.fragment,i),i.forEach(p),_=I(f),T(d.$$.fragment,f),this.h()},h(){$(l,"class","govuk-input govuk-!-width-three-quarters"),l.value=o[7],l.disabled=!0},m(f,i){v(f,e,i),v(f,t,i),v(f,r,i),b(r,l),b(r,s),q(a,r,null),v(f,_,i),q(d,f,i),c=!0},p(f,i){(!c||i&128&&l.value!==f[7])&&(l.value=f[7]);const g={};i&1&&(g.href=`${be}/${f[0].prefix}overview`),a.$set(g);const D={};i&131072&&(D.$$scope={dirty:i,ctx:f}),d.$set(D)},i(f){c||(w(a.$$.fragment,f),w(d.$$.fragment,f),c=!0)},o(f){C(a.$$.fragment,f),C(d.$$.fragment,f),c=!1},d(f){f&&(p(e),p(t),p(r),p(_)),B(a),B(d,f)}}}function it(o){let e,n,t;return{c(){e=F("img"),t=te(`
            Export .json`),this.h()},l(r){e=y(r,"IMG",{src:!0,alt:!0,class:!0}),t=le(r,`
            Export .json`),this.h()},h(){pe(e.src,n=Re)||$(e,"src",n),$(e,"alt","Export .json"),$(e,"class","svelte-1f2msch")},m(r,l){v(r,e,l),v(r,t,l)},p:z,d(r){r&&(p(e),p(t))}}}function ot(o){let e,n,t;e=new ae({props:{$$slots:{default:[it]},$$scope:{ctx:o}}}),e.$on("click",o[11]);const r=o[15].export,l=Se(r,o,o[17],xe);return{c(){A(e.$$.fragment),n=x(),l&&l.c()},l(s){T(e.$$.fragment,s),n=I(s),l&&l.l(s)},m(s,a){q(e,s,a),v(s,n,a),l&&l.m(s,a),t=!0},p(s,a){const _={};a&131072&&(_.$$scope={dirty:a,ctx:s}),e.$set(_),l&&l.p&&(!t||a&131072)&&Me(l,r,s,s[17],t?Ee(r,s[17],a,nt):He(s[17]),xe)},i(s){t||(w(e.$$.fragment,s),w(l,s),t=!0)},o(s){C(e.$$.fragment,s),C(l,s),t=!1},d(s){s&&p(n),B(e,s),l&&l.d(s)}}}function at(o){let e;return{c(){e=te("New blank file")},l(n){e=le(n,"New blank file")},m(n,t){v(n,e,t)},d(n){n&&p(e)}}}function Fe(o){let e,n,t,r;return t=new st({props:{xlsxImporter:o[4]}}),t.$on("imported",o[14]),{c(){e=F("hr"),n=x(),A(t.$$.fragment)},l(l){e=y(l,"HR",{}),n=I(l),T(t.$$.fragment,l)},m(l,s){v(l,e,s),v(l,n,s),q(t,l,s),r=!0},p(l,s){const a={};s&16&&(a.xlsxImporter=l[4]),t.$set(a)},i(l){r||(w(t.$$.fragment,l),r=!0)},o(l){C(t.$$.fragment,l),r=!1},d(l){l&&(p(e),p(n)),B(t,l)}}}function ft(o){let e,n="No saved files";return{c(){e=F("p"),e.textContent=n},l(t){e=y(t,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-yojds1"&&(e.textContent=n)},m(t,r){v(t,e,r)},p:z,i:z,o:z,d(t){t&&p(e)}}}function ut(o){let e,n,t,r,l,s,a,_,d;e=new ae({props:{disabled:o[5]=="",$$slots:{default:[mt]},$$scope:{ctx:o}}}),e.$on("click",o[8]),t=new ae({props:{disabled:o[5]=="",$$slots:{default:[ct]},$$scope:{ctx:o}}}),t.$on("click",o[9]),l=new ze({props:{disabled:o[5]=="",$$slots:{default:[pt]},$$scope:{ctx:o}}}),l.$on("click",o[10]);function c(i){o[16](i)}let f={label:"Manage existing file",choices:ke(o[6])};return o[5]!==void 0&&(f.value=o[5]),a=new Ye({props:f}),Le.push(()=>De(a,"value",c)),{c(){A(e.$$.fragment),n=x(),A(t.$$.fragment),r=x(),A(l.$$.fragment),s=x(),A(a.$$.fragment)},l(i){T(e.$$.fragment,i),n=I(i),T(t.$$.fragment,i),r=I(i),T(l.$$.fragment,i),s=I(i),T(a.$$.fragment,i)},m(i,g){q(e,i,g),v(i,n,g),q(t,i,g),v(i,r,g),q(l,i,g),v(i,s,g),q(a,i,g),d=!0},p(i,g){const D={};g&32&&(D.disabled=i[5]==""),g&131072&&(D.$$scope={dirty:g,ctx:i}),e.$set(D);const N={};g&32&&(N.disabled=i[5]==""),g&131072&&(N.$$scope={dirty:g,ctx:i}),t.$set(N);const h={};g&32&&(h.disabled=i[5]==""),g&131072&&(h.$$scope={dirty:g,ctx:i}),l.$set(h);const j={};g&64&&(j.choices=ke(i[6])),!_&&g&32&&(_=!0,j.value=i[5],Be(()=>_=!1)),a.$set(j)},i(i){d||(w(e.$$.fragment,i),w(t.$$.fragment,i),w(l.$$.fragment,i),w(a.$$.fragment,i),d=!0)},o(i){C(e.$$.fragment,i),C(t.$$.fragment,i),C(l.$$.fragment,i),C(a.$$.fragment,i),d=!1},d(i){i&&(p(n),p(r),p(s)),B(e,i),B(t,i),B(l,i),B(a,i)}}}function mt(o){let e;return{c(){e=te("Load saved file")},l(n){e=le(n,"Load saved file")},m(n,t){v(n,e,t)},d(n){n&&p(e)}}}function ct(o){let e,n,t;return{c(){e=F("img"),t=te(`
          Rename saved file`),this.h()},l(r){e=y(r,"IMG",{src:!0,alt:!0,class:!0}),t=le(r,`
          Rename saved file`),this.h()},h(){pe(e.src,n=Oe)||$(e,"src",n),$(e,"alt","Rename saved file"),$(e,"class","svelte-1f2msch")},m(r,l){v(r,e,l),v(r,t,l)},p:z,d(r){r&&(p(e),p(t))}}}function pt(o){let e,n,t;return{c(){e=F("img"),t=te(`
          Delete saved file`),this.h()},l(r){e=y(r,"IMG",{src:!0,alt:!0,class:!0}),t=le(r,`
          Delete saved file`),this.h()},h(){pe(e.src,n=Ke)||$(e,"src",n),$(e,"alt","Delete saved file"),$(e,"class","svelte-1f2msch")},m(r,l){v(r,e,l),v(r,t,l)},p:z,d(r){r&&(p(e),p(t))}}}function dt(o){let e,n,t,r,l,s,a="Manage my schemes",_,d,c,f,i,g=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,D,N,h,j="Create or import a file",se,U,ne,re,ie,P,oe,O,Y,u,E="Manage existing files",G,M,V,ee;e=new Ge({props:{service:o[3]}}),r=new Ve({});const fe=o[15].description,R=Se(fe,o,o[17],Ie);let L=o[7]&&Ce(o);U=new ae({props:{$$slots:{default:[at]},$$scope:{ctx:o}}}),U.$on("click",o[12]),P=new Ue({props:{label:"Import from a .json file",onLoad:o[13]}});let S=o[4]!=null&&Fe(o);const ge=[ut,ft],J=[];function _e(m,k){return m[6].length>0?0:1}return M=_e(o),V=J[M]=ge[M](o),{c(){A(e.$$.fragment),n=x(),t=F("div"),A(r.$$.fragment),l=x(),s=F("div"),s.textContent=a,_=x(),d=F("div"),c=F("div"),R&&R.c(),f=x(),i=F("p"),i.textContent=g,D=x(),L&&L.c(),N=x(),h=F("h2"),h.textContent=j,se=x(),A(U.$$.fragment),ne=x(),re=F("hr"),ie=x(),A(P.$$.fragment),oe=x(),S&&S.c(),O=x(),Y=F("div"),u=F("h2"),u.textContent=E,G=x(),V.c(),this.h()},l(m){T(e.$$.fragment,m),n=I(m),t=y(m,"DIV",{class:!0});var k=X(t);T(r.$$.fragment,k),l=I(k),s=y(k,"DIV",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1qslbyq"&&(s.textContent=a),_=I(k),d=y(k,"DIV",{class:!0});var K=X(d);c=y(K,"DIV",{class:!0});var H=X(c);R&&R.l(H),f=I(H),i=y(H,"P",{"data-svelte-h":!0}),Z(i)!=="svelte-wkz669"&&(i.textContent=g),D=I(H),L&&L.l(H),N=I(H),h=y(H,"H2",{"data-svelte-h":!0}),Z(h)!=="svelte-1yqhw3l"&&(h.textContent=j),se=I(H),T(U.$$.fragment,H),ne=I(H),re=y(H,"HR",{}),ie=I(H),T(P.$$.fragment,H),oe=I(H),S&&S.l(H),H.forEach(p),O=I(K),Y=y(K,"DIV",{class:!0});var W=X(Y);u=y(W,"H2",{class:!0,"data-svelte-h":!0}),Z(u)!=="svelte-7j9603"&&(u.textContent=E),G=I(W),V.l(W),W.forEach(p),K.forEach(p),k.forEach(p),this.h()},h(){$(s,"class","govuk-heading-l"),$(c,"class","govuk-grid-column-two-thirds"),$(u,"class","green-bar svelte-1f2msch"),$(Y,"class","govuk-grid-column-one-third"),$(d,"class","govuk-grid-row"),$(t,"class","govuk-width-container")},m(m,k){q(e,m,k),v(m,n,k),v(m,t,k),q(r,t,null),b(t,l),b(t,s),b(t,_),b(t,d),b(d,c),R&&R.m(c,null),b(c,f),b(c,i),b(c,D),L&&L.m(c,null),b(c,N),b(c,h),b(c,se),q(U,c,null),b(c,ne),b(c,re),b(c,ie),q(P,c,null),b(c,oe),S&&S.m(c,null),b(d,O),b(d,Y),b(Y,u),b(Y,G),J[M].m(Y,null),ee=!0},p(m,[k]){const K={};k&8&&(K.service=m[3]),e.$set(K),R&&R.p&&(!ee||k&131072)&&Me(R,fe,m,m[17],ee?Ee(fe,m[17],k,rt):He(m[17]),Ie),m[7]?L?(L.p(m,k),k&128&&w(L,1)):(L=Ce(m),L.c(),w(L,1),L.m(c,N)):L&&(ue(),C(L,1,1,()=>{L=null}),me());const H={};k&131072&&(H.$$scope={dirty:k,ctx:m}),U.$set(H),m[4]!=null?S?(S.p(m,k),k&16&&w(S,1)):(S=Fe(m),S.c(),w(S,1),S.m(c,null)):S&&(ue(),C(S,1,1,()=>{S=null}),me());let W=M;M=_e(m),M===W?J[M].p(m,k):(ue(),C(J[W],1,1,()=>{J[W]=null}),me(),V=J[M],V?V.p(m,k):(V=J[M]=ge[M](m),V.c()),w(V,1),V.m(Y,null))},i(m){ee||(w(e.$$.fragment,m),w(r.$$.fragment,m),w(R,m),w(L),w(U.$$.fragment,m),w(P.$$.fragment,m),w(S),w(V),ee=!0)},o(m){C(e.$$.fragment,m),C(r.$$.fragment,m),C(R,m),C(L),C(U.$$.fragment,m),C(P.$$.fragment,m),C(S),C(V),ee=!1},d(m){m&&(p(n),p(t)),B(e,m),B(r),R&&R.d(m),L&&L.d(),B(U),B(P),S&&S.d(),J[M].d()}}}function ye(o,e){let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",o),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function $t(o,e,n){let t,r=z,l=()=>(r(),r=we(g,u=>n(18,t=u)),g),s,a=z,_=()=>(a(),a=we(i,u=>n(7,s=u)),i);o.$$.on_destroy.push(()=>r()),o.$$.on_destroy.push(()=>a());let{$$slots:d={},$$scope:c}=e,{files:f}=e,{currentFile:i}=e;_();let{state:g}=e;l();let{service:D}=e,{xlsxImporter:N=null}=e,h=s,j=f.getFileList();function se(){h&&O(h)}function U(){if(!h)return;let u=h==s,E=window.prompt(`Rename file ${h} to what?`,h);if(E){let G=f.key(h),M=window.localStorage.getItem(G);window.localStorage.setItem(f.key(E),M),window.localStorage.removeItem(G),u&&Q(i,s=E,s),n(5,h=E),n(6,j=f.getFileList())}}function ne(){if(!h||!window.confirm(`Really delete file ${h}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let u=f.key(h);ye(`${h}.json`,window.localStorage.getItem(u)),window.localStorage.removeItem(u),h==s&&(Q(i,s="",s),Q(g,t=f.emptyState(),t)),n(5,h=""),n(6,j=f.getFileList())}function re(){ye(s+".json",JSON.stringify(t))}function ie(){let u=window.prompt("What do you want to name your new file?");u&&(Q(i,s=u,s),Q(g,t=f.emptyState(),t),n(6,j=f.saveAndGetFileList(s,t)))}function P(u,E){let G=Ae(u,".json");try{let M=JSON.parse(E);f.validate(M),n(6,j=f.saveAndGetFileList(G,M)),O(G)}catch(M){window.alert(`Couldn't load ${G}: ${M}`)}}function oe(u){let{filename:E,data:G}=u.detail;n(6,j=f.saveAndGetFileList(E,G)),O(E)}function O(u){try{let E=f.loadFile(u);Q(i,s=u,s),Q(g,t=E,t)}catch(E){window.alert(`Couldn't load ${u}: ${E}`)}}function Y(u){h=u,n(5,h)}return o.$$set=u=>{"files"in u&&n(0,f=u.files),"currentFile"in u&&_(n(1,i=u.currentFile)),"state"in u&&l(n(2,g=u.state)),"service"in u&&n(3,D=u.service),"xlsxImporter"in u&&n(4,N=u.xlsxImporter),"$$scope"in u&&n(17,c=u.$$scope)},[f,i,g,D,N,h,j,s,se,U,ne,re,ie,P,oe,d,Y,c]}class Ht extends de{constructor(e){super(),$e(this,e,$t,dt,ce,{files:0,currentFile:1,state:2,service:3,xlsxImporter:4})}}export{Ht as F};
