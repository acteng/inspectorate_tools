import{s as ce,e as F,c as L,p as J,q as I,i as h,z as Ce,n as G,f as $,E as Te,a as w,g as k,T as qe,r as ye,l as Fe,b as re,h as y,u as Le,m as Se,o as Me,t as ie,d as oe,ab as he,V as K,Y as pe,w as Ae}from"./scheduler.Bxdx0f0B.js";import{S as de,i as $e,c as A,a as E,m as B,t as v,b as x,d as D,g as ue,f as me,e as Ee}from"./index.itOPPQ0R.js";import{L as Be,d as De}from"./Loading.BCGgETkD.js";import{b as je}from"./paths.l4A-v5C7.js";import{S as Re,A as Ge}from"./ServiceHeader.BgGAq9B-.js";import{B as Ne}from"./ButtonGroup.CFC5gCUN.js";import{F as Ve}from"./FileInput.s31uAoCf.js";import{R as Ue}from"./Radio.QaR2KzwA.js";import"./index.CDg2RKFe.js";import{S as ae}from"./SecondaryButton.C3WEK5d3.js";import{W as Ye}from"./WarningButton.DE8BQTXW.js";import{b as He,p as ve}from"./index.mdlVdZ42.js";import{F as ze}from"./FormElement.Jlp14U3V.js";import{W as Pe}from"./WarningText.5NwKqynh.js";import{g as Je}from"./entry.C5yhQ6Et.js";/* empty css                                                  */function We(o){let e,n=`Start
  <svg class="govuk-button__start-icon" xmlns="http://www.w3.org/2000/svg" width="17.5" height="19" viewBox="0 0 33 40" aria-hidden="true" focusable="false"><path fill="currentColor" d="M0 0h13l20 20-20 20H0l20-20z"></path></svg>`,t,r;return{c(){e=F("button"),e.innerHTML=n,this.h()},l(l){e=L(l,"BUTTON",{type:!0,class:!0,"data-module":!0,"data-svelte-h":!0}),J(e)!=="svelte-yfbivp"&&(e.innerHTML=n),this.h()},h(){I(e,"type","button"),I(e,"class","govuk-button govuk-button--start"),I(e,"data-module","govuk-button")},m(l,s){h(l,e,s),t||(r=Ce(e,"click",o[0]),t=!0)},p:G,i:G,o:G,d(l){l&&$(e),t=!1,r()}}}function Oe(o){function e(n){Te.call(this,o,n)}return[e]}class Xe extends de{constructor(e){super(),$e(this,e,Oe,We,ce,{})}}const Ze="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000000'%3e%3cpath%20d='M200-200h57l391-391-57-57-391%20391v57Zm-80%2080v-170l528-527q12-11%2026.5-17t30.5-6q16%200%2031%206t26%2018l55%2056q12%2011%2017.5%2026t5.5%2030q0%2016-5.5%2030.5T817-647L290-120H120Zm640-584-56-56%2056%2056Zm-141%2085-28-29%2057%2057-29-28Z'/%3e%3c/svg%3e",Ke="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='white'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M6%2019c0%201.1.9%202%202%202h8c1.1%200%202-.9%202-2V7H6v12zM19%204h-3.5l-1-1h-5l-1%201H5v2h14V4z'/%3e%3c/svg%3e";function Qe(o){let e,n=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,t,r,l=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=F("p"),e.innerHTML=n,t=w(),r=F("ul"),r.innerHTML=l},l(s){e=L(s,"P",{"data-svelte-h":!0}),J(e)!=="svelte-1ykh4hv"&&(e.innerHTML=n),t=k(s),r=L(s,"UL",{"data-svelte-h":!0}),J(r)!=="svelte-1tt4pqo"&&(r.innerHTML=l)},m(s,a){h(s,e,a),h(s,t,a),h(s,r,a)},p:G,d(s){s&&($(e),$(t),$(r))}}}function et(o){let e,n,t,r,l,s;return t=new Pe({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),{c(){e=F("input"),n=w(),A(t.$$.fragment),this.h()},l(a){e=L(a,"INPUT",{class:!0,id:!0,type:!0}),n=k(a),E(t.$$.fragment,a),this.h()},h(){I(e,"class","govuk-file-upload"),I(e,"id","import-xlsx"),I(e,"type","file")},m(a,_){h(a,e,_),o[4](e),h(a,n,_),B(t,a,_),r=!0,l||(s=Ce(e,"change",o[2]),l=!0)},p(a,_){const p={};_&64&&(p.$$scope={dirty:_,ctx:a}),t.$set(p)},i(a){r||(v(t.$$.fragment,a),r=!0)},o(a){x(t.$$.fragment,a),r=!1},d(a){a&&($(e),$(n)),o[4](null),D(t,a),l=!1,s()}}}function tt(o){let e,n,t,r;return e=new ze({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[et]},$$scope:{ctx:o}}}),t=new Be({props:{loading:o[0]}}),{c(){A(e.$$.fragment),n=w(),A(t.$$.fragment)},l(l){E(e.$$.fragment,l),n=k(l),E(t.$$.fragment,l)},m(l,s){B(e,l,s),h(l,n,s),B(t,l,s),r=!0},p(l,[s]){const a={};s&66&&(a.$$scope={dirty:s,ctx:l}),e.$set(a);const _={};s&1&&(_.loading=l[0]),t.$set(_)},i(l){r||(v(e.$$.fragment,l),v(t.$$.fragment,l),r=!0)},o(l){x(e.$$.fragment,l),x(t.$$.fragment,l),r=!1},d(l){l&&$(n),D(e,l),D(t,l)}}}function lt(o,e,n){let t=qe(),{xlsxImporter:r}=e,l="",s;async function a(p){let m=s.files[0].name;try{n(0,l=`Loading ${m}`);let f=await s.files[0].arrayBuffer(),i=await r(f);n(0,l=""),t("imported",{filename:He(m,".xlsx"),data:i})}catch(f){window.alert(`Couldn't import ${m}: ${f}`),n(0,l="")}}function _(p){ye[p?"unshift":"push"](()=>{s=p,n(1,s)})}return o.$$set=p=>{"xlsxImporter"in p&&n(3,r=p.xlsxImporter)},[l,s,a,r,_]}class nt extends de{constructor(e){super(),$e(this,e,lt,tt,ce,{xlsxImporter:3})}}const st=o=>({}),be=o=>({}),rt=o=>({}),we=o=>({});function ke(o){let e,n="<b>You are editing:</b>",t,r,l,s,a,_,p,m;return a=new Xe({}),a.$on("click",o[16]),p=new Ne({props:{$$slots:{default:[ot]},$$scope:{ctx:o}}}),{c(){e=F("p"),e.innerHTML=n,t=w(),r=F("div"),l=F("input"),s=w(),A(a.$$.fragment),_=w(),A(p.$$.fragment),this.h()},l(f){e=L(f,"P",{"data-svelte-h":!0}),J(e)!=="svelte-st3pjg"&&(e.innerHTML=n),t=k(f),r=L(f,"DIV",{});var i=re(r);l=L(i,"INPUT",{class:!0}),s=k(i),E(a.$$.fragment,i),i.forEach($),_=k(f),E(p.$$.fragment,f),this.h()},h(){I(l,"class","govuk-input govuk-!-width-three-quarters"),l.value=o[7],l.disabled=!0},m(f,i){h(f,e,i),h(f,t,i),h(f,r,i),y(r,l),y(r,s),B(a,r,null),h(f,_,i),B(p,f,i),m=!0},p(f,i){(!m||i&128&&l.value!==f[7])&&(l.value=f[7]);const d={};i&262144&&(d.$$scope={dirty:i,ctx:f}),p.$set(d)},i(f){m||(v(a.$$.fragment,f),v(p.$$.fragment,f),m=!0)},o(f){x(a.$$.fragment,f),x(p.$$.fragment,f),m=!1},d(f){f&&($(e),$(t),$(r),$(_)),D(a),D(p,f)}}}function it(o){let e,n,t;return{c(){e=F("img"),t=ie(`
            Export .json`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),t=oe(r,`
            Export .json`),this.h()},h(){pe(e.src,n=De)||I(e,"src",n),I(e,"alt","Export .json"),I(e,"class","svelte-1f2msch")},m(r,l){h(r,e,l),h(r,t,l)},p:G,d(r){r&&($(e),$(t))}}}function ot(o){let e,n,t;e=new ae({props:{$$slots:{default:[it]},$$scope:{ctx:o}}}),e.$on("click",o[11]);const r=o[15].export,l=Fe(r,o,o[18],be);return{c(){A(e.$$.fragment),n=w(),l&&l.c()},l(s){E(e.$$.fragment,s),n=k(s),l&&l.l(s)},m(s,a){B(e,s,a),h(s,n,a),l&&l.m(s,a),t=!0},p(s,a){const _={};a&262144&&(_.$$scope={dirty:a,ctx:s}),e.$set(_),l&&l.p&&(!t||a&262144)&&Le(l,r,s,s[18],t?Me(r,s[18],a,st):Se(s[18]),be)},i(s){t||(v(e.$$.fragment,s),v(l,s),t=!0)},o(s){x(e.$$.fragment,s),x(l,s),t=!1},d(s){s&&$(n),D(e,s),l&&l.d(s)}}}function at(o){let e;return{c(){e=ie("New blank file")},l(n){e=oe(n,"New blank file")},m(n,t){h(n,e,t)},d(n){n&&$(e)}}}function xe(o){let e,n,t,r;return t=new nt({props:{xlsxImporter:o[4]}}),t.$on("imported",o[14]),{c(){e=F("hr"),n=w(),A(t.$$.fragment)},l(l){e=L(l,"HR",{}),n=k(l),E(t.$$.fragment,l)},m(l,s){h(l,e,s),h(l,n,s),B(t,l,s),r=!0},p(l,s){const a={};s&16&&(a.xlsxImporter=l[4]),t.$set(a)},i(l){r||(v(t.$$.fragment,l),r=!0)},o(l){x(t.$$.fragment,l),r=!1},d(l){l&&($(e),$(n)),D(t,l)}}}function ft(o){let e,n="No saved files";return{c(){e=F("p"),e.textContent=n},l(t){e=L(t,"P",{"data-svelte-h":!0}),J(e)!=="svelte-yojds1"&&(e.textContent=n)},m(t,r){h(t,e,r)},p:G,i:G,o:G,d(t){t&&$(e)}}}function ut(o){let e,n,t,r,l,s,a,_,p;e=new ae({props:{disabled:o[5]=="",$$slots:{default:[mt]},$$scope:{ctx:o}}}),e.$on("click",o[8]),t=new ae({props:{disabled:o[5]=="",$$slots:{default:[ct]},$$scope:{ctx:o}}}),t.$on("click",o[9]),l=new Ye({props:{disabled:o[5]=="",$$slots:{default:[pt]},$$scope:{ctx:o}}}),l.$on("click",o[10]);function m(i){o[17](i)}let f={label:"Manage existing file",choices:ve(o[6])};return o[5]!==void 0&&(f.value=o[5]),a=new Ue({props:f}),ye.push(()=>Ee(a,"value",m)),{c(){A(e.$$.fragment),n=w(),A(t.$$.fragment),r=w(),A(l.$$.fragment),s=w(),A(a.$$.fragment)},l(i){E(e.$$.fragment,i),n=k(i),E(t.$$.fragment,i),r=k(i),E(l.$$.fragment,i),s=k(i),E(a.$$.fragment,i)},m(i,d){B(e,i,d),h(i,n,d),B(t,i,d),h(i,r,d),B(l,i,d),h(i,s,d),B(a,i,d),p=!0},p(i,d){const Y={};d&32&&(Y.disabled=i[5]==""),d&262144&&(Y.$$scope={dirty:d,ctx:i}),e.$set(Y);const N={};d&32&&(N.disabled=i[5]==""),d&262144&&(N.$$scope={dirty:d,ctx:i}),t.$set(N);const g={};d&32&&(g.disabled=i[5]==""),d&262144&&(g.$$scope={dirty:d,ctx:i}),l.$set(g);const j={};d&64&&(j.choices=ve(i[6])),!_&&d&32&&(_=!0,j.value=i[5],Ae(()=>_=!1)),a.$set(j)},i(i){p||(v(e.$$.fragment,i),v(t.$$.fragment,i),v(l.$$.fragment,i),v(a.$$.fragment,i),p=!0)},o(i){x(e.$$.fragment,i),x(t.$$.fragment,i),x(l.$$.fragment,i),x(a.$$.fragment,i),p=!1},d(i){i&&($(n),$(r),$(s)),D(e,i),D(t,i),D(l,i),D(a,i)}}}function mt(o){let e;return{c(){e=ie("Load saved file")},l(n){e=oe(n,"Load saved file")},m(n,t){h(n,e,t)},d(n){n&&$(e)}}}function ct(o){let e,n,t;return{c(){e=F("img"),t=ie(`
          Rename saved file`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),t=oe(r,`
          Rename saved file`),this.h()},h(){pe(e.src,n=Ze)||I(e,"src",n),I(e,"alt","Rename saved file"),I(e,"class","svelte-1f2msch")},m(r,l){h(r,e,l),h(r,t,l)},p:G,d(r){r&&($(e),$(t))}}}function pt(o){let e,n,t;return{c(){e=F("img"),t=ie(`
          Delete saved file`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),t=oe(r,`
          Delete saved file`),this.h()},h(){pe(e.src,n=Ke)||I(e,"src",n),I(e,"alt","Delete saved file"),I(e,"class","svelte-1f2msch")},m(r,l){h(r,e,l),h(r,t,l)},p:G,d(r){r&&($(e),$(t))}}}function dt(o){let e,n,t,r,l,s,a="Manage my schemes",_,p,m,f,i,d=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,Y,N,g,j="Create or import a file",ee,V,te,le,ne,z,se,X,U,P,c="Manage existing files",q,C,H,Q;e=new Re({props:{service:o[3]}}),r=new Ge({});const fe=o[15].description,R=Fe(fe,o,o[18],we);let S=o[7]&&ke(o);V=new ae({props:{$$slots:{default:[at]},$$scope:{ctx:o}}}),V.$on("click",o[12]),z=new Ve({props:{label:"Import from a .json file",onLoad:o[13]}});let M=o[4]!=null&&xe(o);const _e=[ut,ft],W=[];function ge(u,b){return u[6].length>0?0:1}return C=ge(o),H=W[C]=_e[C](o),{c(){A(e.$$.fragment),n=w(),t=F("div"),A(r.$$.fragment),l=w(),s=F("div"),s.textContent=a,_=w(),p=F("div"),m=F("div"),R&&R.c(),f=w(),i=F("p"),i.textContent=d,Y=w(),S&&S.c(),N=w(),g=F("h2"),g.textContent=j,ee=w(),A(V.$$.fragment),te=w(),le=F("hr"),ne=w(),A(z.$$.fragment),se=w(),M&&M.c(),X=w(),U=F("div"),P=F("h2"),P.textContent=c,q=w(),H.c(),this.h()},l(u){E(e.$$.fragment,u),n=k(u),t=L(u,"DIV",{class:!0});var b=re(t);E(r.$$.fragment,b),l=k(b),s=L(b,"DIV",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-1qslbyq"&&(s.textContent=a),_=k(b),p=L(b,"DIV",{class:!0});var Z=re(p);m=L(Z,"DIV",{class:!0});var T=re(m);R&&R.l(T),f=k(T),i=L(T,"P",{"data-svelte-h":!0}),J(i)!=="svelte-wkz669"&&(i.textContent=d),Y=k(T),S&&S.l(T),N=k(T),g=L(T,"H2",{"data-svelte-h":!0}),J(g)!=="svelte-1yqhw3l"&&(g.textContent=j),ee=k(T),E(V.$$.fragment,T),te=k(T),le=L(T,"HR",{}),ne=k(T),E(z.$$.fragment,T),se=k(T),M&&M.l(T),T.forEach($),X=k(Z),U=L(Z,"DIV",{class:!0});var O=re(U);P=L(O,"H2",{class:!0,"data-svelte-h":!0}),J(P)!=="svelte-7j9603"&&(P.textContent=c),q=k(O),H.l(O),O.forEach($),Z.forEach($),b.forEach($),this.h()},h(){I(s,"class","govuk-heading-l"),I(m,"class","govuk-grid-column-two-thirds"),I(P,"class","green-bar svelte-1f2msch"),I(U,"class","govuk-grid-column-one-third"),I(p,"class","govuk-grid-row"),I(t,"class","govuk-width-container")},m(u,b){B(e,u,b),h(u,n,b),h(u,t,b),B(r,t,null),y(t,l),y(t,s),y(t,_),y(t,p),y(p,m),R&&R.m(m,null),y(m,f),y(m,i),y(m,Y),S&&S.m(m,null),y(m,N),y(m,g),y(m,ee),B(V,m,null),y(m,te),y(m,le),y(m,ne),B(z,m,null),y(m,se),M&&M.m(m,null),y(p,X),y(p,U),y(U,P),y(U,q),W[C].m(U,null),Q=!0},p(u,[b]){const Z={};b&8&&(Z.service=u[3]),e.$set(Z),R&&R.p&&(!Q||b&262144)&&Le(R,fe,u,u[18],Q?Me(fe,u[18],b,rt):Se(u[18]),we),u[7]?S?(S.p(u,b),b&128&&v(S,1)):(S=ke(u),S.c(),v(S,1),S.m(m,N)):S&&(ue(),x(S,1,1,()=>{S=null}),me());const T={};b&262144&&(T.$$scope={dirty:b,ctx:u}),V.$set(T),u[4]!=null?M?(M.p(u,b),b&16&&v(M,1)):(M=xe(u),M.c(),v(M,1),M.m(m,null)):M&&(ue(),x(M,1,1,()=>{M=null}),me());let O=C;C=ge(u),C===O?W[C].p(u,b):(ue(),x(W[O],1,1,()=>{W[O]=null}),me(),H=W[C],H?H.p(u,b):(H=W[C]=_e[C](u),H.c()),v(H,1),H.m(U,null))},i(u){Q||(v(e.$$.fragment,u),v(r.$$.fragment,u),v(R,u),v(S),v(V.$$.fragment,u),v(z.$$.fragment,u),v(M),v(H),Q=!0)},o(u){x(e.$$.fragment,u),x(r.$$.fragment,u),x(R,u),x(S),x(V.$$.fragment,u),x(z.$$.fragment,u),x(M),x(H),Q=!1},d(u){u&&($(n),$(t)),D(e,u),D(r),R&&R.d(u),S&&S.d(),D(V),D(z),M&&M.d(),W[C].d()}}}function Ie(o,e){let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",o),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function $t(o,e,n){let t,r=G,l=()=>(r(),r=he(d,c=>n(19,t=c)),d),s,a=G,_=()=>(a(),a=he(i,c=>n(7,s=c)),i);o.$$.on_destroy.push(()=>r()),o.$$.on_destroy.push(()=>a());let{$$slots:p={},$$scope:m}=e,{files:f}=e,{currentFile:i}=e;_();let{state:d}=e;l();let{service:Y}=e,{xlsxImporter:N=null}=e,g=s,j=f.getFileList();function ee(){g&&X(g)}function V(){if(!g)return;let c=g==s,q=window.prompt(`Rename file ${g} to what?`,g);if(q){let C=f.key(g),H=window.localStorage.getItem(C);window.localStorage.setItem(f.key(q),H),window.localStorage.removeItem(C),c&&K(i,s=q,s),n(5,g=q),n(6,j=f.getFileList())}}function te(){if(!g||!window.confirm(`Really delete file ${g}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let c=f.key(g);Ie(`${g}.json`,window.localStorage.getItem(c)),window.localStorage.removeItem(c),g==s&&(K(i,s="",s),K(d,t=f.emptyState(),t)),n(5,g=""),n(6,j=f.getFileList())}function le(){Ie(s+".json",JSON.stringify(t))}function ne(){let c=window.prompt("What do you want to name your new file?");c&&(K(i,s=c,s),K(d,t=f.emptyState(),t),n(6,j=f.saveAndGetFileList(s,t)))}function z(c,q){let C=He(c,".json");try{let H=JSON.parse(q);f.validate(H),n(6,j=f.saveAndGetFileList(C,H)),X(C)}catch(H){window.alert(`Couldn't load ${C}: ${H}`)}}function se(c){let{filename:q,data:C}=c.detail;n(6,j=f.saveAndGetFileList(q,C)),X(q)}function X(c){try{let q=f.loadFile(c);K(i,s=c,s),K(d,t=q,t)}catch(q){window.alert(`Couldn't load ${c}: ${q}`)}}const U=()=>Je(`${je}/${f.prefix}overview`);function P(c){g=c,n(5,g)}return o.$$set=c=>{"files"in c&&n(0,f=c.files),"currentFile"in c&&_(n(1,i=c.currentFile)),"state"in c&&l(n(2,d=c.state)),"service"in c&&n(3,Y=c.service),"xlsxImporter"in c&&n(4,N=c.xlsxImporter),"$$scope"in c&&n(18,m=c.$$scope)},[f,i,d,Y,N,g,j,s,ee,V,te,le,ne,z,se,p,U,P,m]}class Tt extends de{constructor(e){super(),$e(this,e,$t,dt,ce,{files:0,currentFile:1,state:2,service:3,xlsxImporter:4})}}export{Tt as F};
