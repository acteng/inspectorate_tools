import{s as C}from"./index.BaFgF3ph.js";import{n as P}from"./data.ylsfYrtw.js";let x={Walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],"Horse Riding":[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},S={Walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},b={Walking:[0,1,3,5,6,7,8,9,10,14,15],Wheeling:[0,1,3,5,6,7,8,9,10,14,15],Cycling:[0,1,2,4,7,8,11,12,13,15]};function A(e){let t=e.summary.checkType,s=t=="street",o=t=="path",l=r("Safety",t,e.safetyCheck,null),i=[l];s?(i.push(r("Accessibility",t,e.streetCheck,[0,6])),i.push(r("Comfort",t,e.streetCheck,[7,9])),i.push(r("Directness",t,e.streetCheck,[10,15])),i.push(r("Attractiveness",t,e.streetCheck,[16,21])),i.push(r("Cohesion",t,e.streetCheck,[22,25]))):o&&(i.push(r("Accessibility",t,e.pathCheck,[0,4])),i.push(r("Comfort",t,e.pathCheck,[5,15])),i.push(r("Directness",t,e.pathCheck,[16,19])),i.push(r("Attractiveness",t,e.pathCheck,[20,24])),i.push(r("Cohesion",t,e.pathCheck,[25,29])));let c={category:"overall",existing:u(i.map(p=>p.existing)),proposed:u(i.map(p=>p.proposed))},n=[];s?(n.push(r("Social activity",t,e.streetPlacemakingCheck,[0,2])),n.push(r("Personal security",t,e.streetPlacemakingCheck,[3,5])),n.push(r("Character and legibility",t,e.streetPlacemakingCheck,[6,15])),n.push(r("Environment",t,e.streetPlacemakingCheck,[16,25]))):o&&n.push(r("Social activity",t,e.pathPlacemakingCheck,[0,2]),r("Personal security",t,e.pathPlacemakingCheck,[3,5]),r("Character and legibility",t,e.pathPlacemakingCheck,[6,9]),r("Environment",t,e.pathPlacemakingCheck,[10,18]));let h={category:"overall",existing:u(n.map(p=>p.existing)),proposed:u(n.map(p=>p.proposed))},a=[];s?a=y(e.safetyCheck,e.streetCheck,S,e.summary.checkType):o&&(a=y(e.safetyCheck,e.pathCheck,x,e.summary.checkType));let g=W(e);return{safetyCheck:l,levelOfService:i,overall:c,placemakingCategories:n,placemakingOverall:h,byMode:a,jat:g}}function r(e,t,s,o){return{category:e,existing:d(s.existingScores,e,t,o),proposed:d(s.proposedScores,e,t,o)}}function d(e,t,s,o){let l=o||[0,e.length-1],i=l[0],c=l[1]+1;return m(e.slice(i,c),t,s)}function m(e,t,s){let o=e.filter(h=>h!="N/A").length,l=1;t=="Safety"?l=3:s=="path"&&t=="Personal security"&&(l=2);let i=o*2*l,c=l*C(e.map(P)),n=c/i*100;return{numberMetrics:o,totalPossibleScore:i,score:c,scorePercent:n}}function u(e){let t=C(e.map(i=>i.numberMetrics)),s=C(e.map(i=>i.totalPossibleScore)),o=C(e.map(i=>i.score)),l=o/s*100;return{numberMetrics:t,totalPossibleScore:s,score:o,scorePercent:l}}function v(e,t){return{category:"",existing:u([e.existing,t.existing]),proposed:u([e.proposed,t.proposed])}}function I(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function y(e,t,s,o){let l=[];for(let[i,c]of Object.entries(s)){let n=b[i]||[],h={category:"Safety",existing:m(k(e.existingScores,n),"Safety",o),proposed:m(k(e.proposedScores,n),"Safety",o)},a={category:"",existing:m(k(t.existingScores,c),"",o),proposed:m(k(t.proposedScores,c),"",o)},g=v(h,a);g.category=i,l.push(g)}return l}function k(e,t){return t.map(s=>e[s])}function W(e){let t={0:0,1:1,2:2,X:0},s=[];for(let o of e.jat){let l={walkingWheeling:{existing:"",proposed:""},cycling:{existing:"",proposed:""},total:{existing:"",proposed:""}};for(let i of["existing","proposed"]){let c=0,n=0,h=0,a=0,g=0,p=0;for(let f of o[i].movements)f.kind=="walking & wheeling"?(c+=t[f.score],n+=2):(h+=t[f.score],a+=2),g+=t[f.score],p+=2;l.walkingWheeling[i]=n>0?`${c/n*100}%`:"Not Completed",l.cycling[i]=a>0?`${h/a*100}%`:"Not Comleted",l.total[i]=p>0?`${g/p*100}%`:"Not Completed"}s.push(l)}return s}export{A as g,I as n};
