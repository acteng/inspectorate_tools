import{s as O,l as ne,e as E,a as z,c as I,b as T,g as D,f as p,r as y,w as H,i as L,h as S,z as N,u as le,m as oe,o as ae,B as me,H as F,a9 as He,t as G,d as U,y as ue,j as ye,q as Ye,O as Ze,C as de,p as ie,E as K,k as P,a7 as Ae,N as B,n as he,aa as we,A as Je,Z as Qe,a8 as Xe,v as se,x as ge,ab as $e}from"./scheduler.Bsni_e59.js";import{S as W,i as j,t as k,b as w,c as A,a as R,m as M,d as V,g as Q,f as X,e as _e}from"./index.CCfAUppz.js";import{C as xe}from"./CollapsibleCard.DoOZ0Bze.js";import{S as Re,W as et}from"./WarningButton.D9QeV9gM.js";import{v as Me,E as tt,F as nt}from"./FormElement.CamEvjvl.js";import{e as Le}from"./each.BmgwAlbi.js";import{g as Ve,u as lt,r as ot,a as at,c as it,b as st,m as rt,L as ut,t as ft}from"./MapLibreMap.Cx_2xGtm.js";import{B as ct}from"./ButtonGroup.hr9f_7ak.js";import{D as dt}from"./DefaultButton.DyQsHGbh.js";import{w as re}from"./entry.CO2uXwrZ.js";const gt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,_t=o=>({}),Se=o=>({});function mt(o){let e,n,t,l,a,r,f,c,_;const s=o[5].default,i=ne(s,o,o[4],null),u=o[5].right,d=ne(u,o,o[4],Se);return{c(){e=E("div"),n=E("input"),t=z(),l=E("label"),i&&i.c(),a=z(),r=E("span"),d&&d.c(),this.h()},l(g){e=I(g,"DIV",{class:!0,style:!0});var m=T(e);n=I(m,"INPUT",{type:!0,class:!0,id:!0}),t=D(m),l=I(m,"LABEL",{class:!0,for:!0,title:!0});var h=T(l);i&&i.l(h),h.forEach(p),a=D(m),r=I(m,"SPAN",{style:!0});var C=T(r);d&&d.l(C),C.forEach(p),m.forEach(p),this.h()},h(){y(n,"type","checkbox"),y(n,"class","govuk-checkboxes__input"),y(n,"id",o[3]),y(l,"class","govuk-label govuk-checkboxes__label"),y(l,"for",o[3]),y(l,"title",o[1]),H(r,"float","right"),y(e,"class","govuk-checkboxes__item"),y(e,"style",o[2])},m(g,m){L(g,e,m),S(e,n),n.checked=o[0],S(e,t),S(e,l),i&&i.m(l,null),S(e,a),S(e,r),d&&d.m(r,null),f=!0,c||(_=[N(n,"change",o[7]),N(n,"change",o[6])],c=!0)},p(g,[m]){m&1&&(n.checked=g[0]),i&&i.p&&(!f||m&16)&&le(i,s,g,g[4],f?ae(s,g[4],m,null):oe(g[4]),null),(!f||m&2)&&y(l,"title",g[1]),d&&d.p&&(!f||m&16)&&le(d,u,g,g[4],f?ae(u,g[4],m,_t):oe(g[4]),Se)},i(g){f||(k(i,g),k(d,g),f=!0)},o(g){w(i,g),w(d,g),f=!1},d(g){g&&p(e),i&&i.d(g),d&&d.d(g),c=!1,me(_)}}}function ht(o,e,n){let{$$slots:t={},$$scope:l}=e;const a=He(t);let{checked:r}=e,{hint:f=null}=e,_=a.right!==void 0?"float: none":"",s=Me();function i(d){F.call(this,o,d)}function u(){r=this.checked,n(0,r)}return o.$$set=d=>{"checked"in d&&n(0,r=d.checked),"hint"in d&&n(1,f=d.hint),"$$scope"in d&&n(4,l=d.$$scope)},[r,f,_,s,l,t,i,u]}class bt extends W{constructor(e){super(),j(this,e,ht,mt,O,{checked:0,hint:1})}}function Ee(o,e,n){const t=o.slice();return t[10]=e[n][0],t[11]=e[n][1],t}function Ie(o){let e,n,t,l,a=!1,r,f,c=o[11]+"",_,s,i,u,d,g;return u=Ze(o[9][0]),{c(){e=E("div"),n=E("input"),r=z(),f=E("label"),_=G(c),i=z(),this.h()},l(m){e=I(m,"DIV",{class:!0});var h=T(e);n=I(h,"INPUT",{class:!0,id:!0,type:!0}),r=D(h),f=I(h,"LABEL",{class:!0,for:!0});var C=T(f);_=U(C,c),C.forEach(p),i=D(h),h.forEach(p),this.h()},h(){y(n,"class","govuk-radios__input"),y(n,"id",t=o[5]+o[10]),y(n,"type","radio"),n.__value=l=o[10],de(n,n.__value),y(f,"class","govuk-label govuk-radios__label"),y(f,"for",s=o[5]+o[10]),y(e,"class","govuk-radios__item"),u.p(n)},m(m,h){L(m,e,h),S(e,n),n.checked=n.__value===o[0],S(e,r),S(e,f),S(f,_),S(e,i),d||(g=[N(n,"change",o[8]),N(n,"change",o[7])],d=!0)},p(m,h){h&4&&t!==(t=m[5]+m[10])&&y(n,"id",t),h&4&&l!==(l=m[10])&&(n.__value=l,de(n,n.__value),a=!0),(a||h&5)&&(n.checked=n.__value===m[0]),h&4&&c!==(c=m[11]+"")&&ye(_,c),h&4&&s!==(s=m[5]+m[10])&&y(f,"for",s)},d(m){m&&p(e),u.r(),d=!1,me(g)}}}function pt(o){let e,n,t,l,a,r,f,c,_;r=new tt({props:{errorMessage:o[4]}});let s=Le(o[2]),i=[];for(let u=0;u<s.length;u+=1)i[u]=Ie(Ee(o,s,u));return{c(){e=E("div"),n=E("fieldset"),t=E("legend"),l=G(o[1]),a=z(),A(r.$$.fragment),f=z(),c=E("div");for(let u=0;u<i.length;u+=1)i[u].c();this.h()},l(u){e=I(u,"DIV",{class:!0});var d=T(e);n=I(d,"FIELDSET",{class:!0});var g=T(n);t=I(g,"LEGEND",{class:!0});var m=T(t);l=U(m,o[1]),m.forEach(p),a=D(g),R(r.$$.fragment,g),f=D(g),c=I(g,"DIV",{class:!0,"data-module":!0});var h=T(c);for(let C=0;C<i.length;C+=1)i[C].l(h);h.forEach(p),g.forEach(p),d.forEach(p),this.h()},h(){y(t,"class","govuk-fieldset__legend govuk-label--s"),y(c,"class","govuk-radios"),y(c,"data-module","govuk-radios"),ue(c,"govuk-radios--inline",o[3]),ue(c,"govuk-radios--small",o[3]),y(n,"class","govuk-fieldset"),y(e,"class","govuk-form-group")},m(u,d){L(u,e,d),S(e,n),S(n,t),S(t,l),S(n,a),M(r,n,null),S(n,f),S(n,c);for(let g=0;g<i.length;g+=1)i[g]&&i[g].m(c,null);_=!0},p(u,[d]){(!_||d&2)&&ye(l,u[1]);const g={};if(d&16&&(g.errorMessage=u[4]),r.$set(g),d&37){s=Le(u[2]);let m;for(m=0;m<s.length;m+=1){const h=Ee(u,s,m);i[m]?i[m].p(h,d):(i[m]=Ie(h),i[m].c(),i[m].m(c,null))}for(;m<i.length;m+=1)i[m].d(1);i.length=s.length}(!_||d&8)&&ue(c,"govuk-radios--inline",u[3]),(!_||d&8)&&ue(c,"govuk-radios--small",u[3])},i(u){_||(k(r.$$.fragment,u),_=!0)},o(u){w(r.$$.fragment,u),_=!1},d(u){u&&p(e),V(r),Ye(i,u)}}}function kt(o,e,n){let t,{legend:l}=e,{choices:a}=e,{inlineSmall:r=!1}=e,{required:f=!1}=e,{value:c}=e,_=Me();const s=[[]];function i(d){F.call(this,o,d)}function u(){c=this.__value,n(0,c)}return o.$$set=d=>{"legend"in d&&n(1,l=d.legend),"choices"in d&&n(2,a=d.choices),"inlineSmall"in d&&n(3,r=d.inlineSmall),"required"in d&&n(6,f=d.required),"value"in d&&n(0,c=d.value)},o.$$.update=()=>{o.$$.dirty&65&&n(4,t=f&&c==""?"Required":"")},[c,l,a,r,t,_,f,i,u,s]}class yt extends W{constructor(e){super(),j(this,e,kt,pt,O,{legend:1,choices:2,inlineSmall:3,required:6,value:0})}}function vt(o){let e,n="You can manually use high-quality Bluesky imagery if you have a valid key.";return{c(){e=E("p"),e.textContent=n},l(t){e=I(t,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-1e80rhw"&&(e.textContent=n)},m(t,l){L(t,e,l)},d(t){t&&p(e)}}}function wt(o){let e,n="The map should be showing Bluesky imagery.";return{c(){e=E("p"),e.textContent=n},l(t){e=I(t,"P",{"data-svelte-h":!0}),ie(e)!=="svelte-13v9ac9"&&(e.textContent=n)},m(t,l){L(t,e,l)},d(t){t&&p(e)}}}function Lt(o){let e;return{c(){e=G("Set Bluesky API key")},l(n){e=U(n,"Set Bluesky API key")},m(n,t){L(n,e,t)},d(n){n&&p(e)}}}function St(o){let e,n,t=`<i>Note this feature is temporary -- in the future, you will login and
      automatically have access to this imagery.</i>`,l,a,r;function f(s,i){return It()?wt:vt}let _=f()(o);return a=new Re({props:{$$slots:{default:[Lt]},$$scope:{ctx:o}}}),a.$on("click",Ct),{c(){_.c(),e=z(),n=E("p"),n.innerHTML=t,l=z(),A(a.$$.fragment)},l(s){_.l(s),e=D(s),n=I(s,"P",{"data-svelte-h":!0}),ie(n)!=="svelte-jc29jc"&&(n.innerHTML=t),l=D(s),R(a.$$.fragment,s)},m(s,i){_.m(s,i),L(s,e,i),L(s,n,i),L(s,l,i),M(a,s,i),r=!0},p(s,i){const u={};i&1&&(u.$$scope={dirty:i,ctx:s}),a.$set(u)},i(s){r||(k(a.$$.fragment,s),r=!0)},o(s){w(a.$$.fragment,s),r=!1},d(s){s&&(p(e),p(n),p(l)),_.d(s),V(a,s)}}}function Et(o){let e,n;return e=new xe({props:{label:"Bluesky imagery",$$slots:{default:[St]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}let ke="bluesky-api-key";function It(){let o=window.localStorage.getItem(ke);return o!=null&&o.length>0}function Ct(){let o=window.prompt("Enter the API key provided to you",window.localStorage.getItem(ke)||"");window.localStorage.setItem(ke,o||""),window.location.reload()}class mn extends W{constructor(e){super(),j(this,e,null,Et,O,{})}}function Ce(o){let e=o[0],n,t,l=Be(o);return{c(){l.c(),n=K()},l(a){l.l(a),n=K()},m(a,r){l.m(a,r),L(a,n,r),t=!0},p(a,r){r&1&&O(e,e=a[0])?(Q(),w(l,1,1,he),X(),l=Be(a),l.c(),k(l,1),l.m(n.parentNode,n)):l.p(a,r)},i(a){t||(k(l),t=!0)},o(a){w(l),t=!1},d(a){a&&p(n),l.d(a)}}}function Be(o){let e;const n=o[10].default,t=ne(n,o,o[9],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&512)&&le(t,n,l,l[9],e?ae(n,l[9],a,null):oe(l[9]),null)},i(l){e||(k(t,l),e=!0)},o(l){w(t,l),e=!1},d(l){t&&t.d(l)}}}function Bt(o){let e,n,t=o[0]&&Ce(o);return{c(){t&&t.c(),e=K()},l(l){t&&t.l(l),e=K()},m(l,a){t&&t.m(l,a),L(l,e,a),n=!0},p(l,[a]){l[0]?t?(t.p(l,a),a&1&&k(t,1)):(t=Ce(l),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(Q(),w(t,1,1,()=>{t=null}),X())},i(l){n||(k(t),n=!0)},o(l){w(t),n=!1},d(l){l&&p(e),t&&t.d(l)}}}function Nt(o,e,n){let t,l,{$$slots:a={},$$scope:r}=e,{id:f=Ve("image")}=e,{url:c}=e,{coordinates:_}=e;const{map:s,self:i}=lt();P(o,s,g=>n(8,l=g)),P(o,i,g=>n(0,t=g));let u,d=!0;return Ae(()=>{t&&l&&(ot(s,t,u),B(i,t=null,t),n(6,u=void 0))}),o.$$set=g=>{"id"in g&&n(3,f=g.id),"url"in g&&n(4,c=g.url),"coordinates"in g&&n(5,_=g.coordinates),"$$scope"in g&&n(9,r=g.$$scope)},o.$$.update=()=>{o.$$.dirty&313&&l&&t!==f&&(B(i,t=f,t),at(l,t,it({type:"image",url:c,coordinates:_}),g=>l&&g===t,()=>{t&&(n(6,u=l==null?void 0:l.getSource(t)),n(7,d=!0))})),o.$$.dirty&264&&(l==null||l.on("style.load",()=>{n(6,u=l==null?void 0:l.getSource(f))})),o.$$.dirty&224&&u&&(d?n(7,d=!1):u.setCoordinates(_))},[t,s,i,f,c,_,u,d,l,r,a]}class zt extends W{constructor(e){super(),j(this,e,Nt,Bt,O,{id:3,url:4,coordinates:5})}}function Dt(o){let e,n,t,l,a,r,f;const c=o[18].default,_=ne(c,o,o[17],null);return{c(){e=E("div"),_&&_.c(),this.h()},l(s){e=I(s,"DIV",{tabindex:!0,role:!0});var i=T(e);_&&_.l(i),i.forEach(p),this.h()},h(){y(e,"tabindex",n=o[1]?0:void 0),y(e,"role",t=o[1]?"button":void 0),H(e,"z-index",o[2])},m(s,i){L(s,e,i),_&&_.m(e,null),a=!0,r||(f=[we(o[6].call(null,e)),we(l=Pt.call(null,e,o[0])),N(e,"click",Je(o[19])),N(e,"dblclick",o[20]),N(e,"contextmenu",o[21]),N(e,"mouseenter",o[22]),N(e,"mouseleave",o[23]),N(e,"mousemove",o[24]),N(e,"keydown",o[7])],r=!0)},p(s,[i]){_&&_.p&&(!a||i&131072)&&le(_,c,s,s[17],a?ae(c,s[17],i,null):oe(s[17]),null),(!a||i&2&&n!==(n=s[1]?0:void 0))&&y(e,"tabindex",n),(!a||i&2&&t!==(t=s[1]?"button":void 0))&&y(e,"role",t),l&&Qe(l.update)&&i&1&&l.update.call(null,s[0]),i&4&&H(e,"z-index",s[2])},i(s){a||(k(_,s),a=!0)},o(s){w(_,s),a=!1},d(s){s&&p(e),_&&_.d(s),r=!1,me(f)}}}function Pt(o,e){const n=o.className;function t(l){l?o.className=`${n} ${l}`:o.className=n}return t(e),{update:t}}function Tt(o,e,n){let t,l,a,{$$slots:r={},$$scope:f}=e,{lngLat:c}=e,{class:_=void 0}=e,{interactive:s=!0}=e,{asButton:i=!1}=e,{draggable:u=!1}=e,{feature:d=null}=e,{offset:g=void 0}=e,{zIndex:m=void 0}=e,{rotation:h=0}=e,{opacity:C=1}=e;const $=Xe(),{map:v,layerEvent:be,self:pe}=st();P(o,v,b=>n(26,a=b)),P(o,be,b=>n(25,t=b)),P(o,pe,b=>n(16,l=b));function qe(b){B(pe,l=new rt.Marker({element:b,rotation:h,draggable:u,offset:g,opacity:C.toString()}).setLngLat(c).addTo(a),l);const Y=()=>q("dragstart"),x=()=>{ve(),q("drag")},ee=()=>{ve(),q("dragend")};return u&&(l.on("dragstart",Y),l.on("drag",x),l.on("dragend",ee)),{destroy(){u&&(l==null||l.off("dragstart",Y),l==null||l.off("drag",x),l==null||l.off("dragend",ee)),l==null||l.remove()}}}function ve(){let b=l==null?void 0:l.getLngLat();b&&(Array.isArray(c)?n(9,c=[b.lng,b.lat]):c&&"lon"in c?n(9,c={lon:b.lng,lat:b.lat}):n(9,c=b))}function Ge(b){b.key===" "&&(b.preventDefault(),b.stopPropagation(),q("click"))}function q(b){if(!s)return;let Y=l==null?void 0:l.getLngLat();if(!Y)return;const x=[Y.lng,Y.lat];let ee={map:a,marker:l,lngLat:x,features:[{type:"Feature",properties:(d==null?void 0:d.properties)??{},geometry:{type:"Point",coordinates:x}}]};B(be,t={...ee,layerType:"marker",type:b},t),$(b,ee)}const Ue=()=>q("click"),Ke=()=>q("dblclick"),Oe=()=>q("contextmenu"),We=b=>{q("mouseenter")},je=()=>{q("mouseleave")},Fe=()=>q("mousemove");return o.$$set=b=>{"lngLat"in b&&n(9,c=b.lngLat),"class"in b&&n(0,_=b.class),"interactive"in b&&n(10,s=b.interactive),"asButton"in b&&n(1,i=b.asButton),"draggable"in b&&n(11,u=b.draggable),"feature"in b&&n(12,d=b.feature),"offset"in b&&n(13,g=b.offset),"zIndex"in b&&n(2,m=b.zIndex),"rotation"in b&&n(14,h=b.rotation),"opacity"in b&&n(15,C=b.opacity),"$$scope"in b&&n(17,f=b.$$scope)},o.$$.update=()=>{o.$$.dirty&66048&&(l==null||l.setLngLat(c)),o.$$.dirty&73728&&(l==null||l.setOffset(g??[0,0])),o.$$.dirty&81920&&(l==null||l.setRotation(h)),o.$$.dirty&98304&&(l==null||l.setOpacity(C.toString()))},[_,i,m,v,be,pe,qe,Ge,q,c,s,u,d,g,h,C,l,f,r,Ue,Ke,Oe,We,je,Fe]}class Ne extends W{constructor(e){super(),j(this,e,Tt,Dt,O,{lngLat:9,class:0,interactive:10,asButton:1,draggable:11,feature:12,offset:13,zIndex:2,rotation:14,opacity:15})}}function At(o){let e;const n=o[8].default,t=ne(n,o,o[15],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,a){t&&t.m(l,a),e=!0},p(l,a){t&&t.p&&(!e||a&32768)&&le(t,n,l,l[15],e?ae(n,l[15],a,null):oe(l[15]),null)},i(l){e||(k(t,l),e=!0)},o(l){w(t,l),e=!1},d(l){t&&t.d(l)}}}function Rt(o){let e,n;return e=new ut({props:{id:o[0],type:"raster",source:o[1],beforeId:o[2],beforeLayerType:o[3],paint:o[4],layout:o[5],minzoom:o[6],maxzoom:o[7],$$slots:{default:[At]},$$scope:{ctx:o}}}),e.$on("click",o[9]),e.$on("dblclick",o[10]),e.$on("contextmenu",o[11]),e.$on("mouseenter",o[12]),e.$on("mousemove",o[13]),e.$on("mouseleave",o[14]),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,[l]){const a={};l&1&&(a.id=t[0]),l&2&&(a.source=t[1]),l&4&&(a.beforeId=t[2]),l&8&&(a.beforeLayerType=t[3]),l&16&&(a.paint=t[4]),l&32&&(a.layout=t[5]),l&64&&(a.minzoom=t[6]),l&128&&(a.maxzoom=t[7]),l&32768&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Mt(o,e,n){let{$$slots:t={},$$scope:l}=e,{id:a=Ve("raster-layer")}=e,{source:r=void 0}=e,{beforeId:f=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:_}=e,{layout:s=void 0}=e,{minzoom:i=void 0}=e,{maxzoom:u=void 0}=e;function d(v){F.call(this,o,v)}function g(v){F.call(this,o,v)}function m(v){F.call(this,o,v)}function h(v){F.call(this,o,v)}function C(v){F.call(this,o,v)}function $(v){F.call(this,o,v)}return o.$$set=v=>{"id"in v&&n(0,a=v.id),"source"in v&&n(1,r=v.source),"beforeId"in v&&n(2,f=v.beforeId),"beforeLayerType"in v&&n(3,c=v.beforeLayerType),"paint"in v&&n(4,_=v.paint),"layout"in v&&n(5,s=v.layout),"minzoom"in v&&n(6,i=v.minzoom),"maxzoom"in v&&n(7,u=v.maxzoom),"$$scope"in v&&n(15,l=v.$$scope)},[a,r,f,c,_,s,i,u,t,d,g,m,h,C,$,l]}class Vt extends W{constructor(e){super(),j(this,e,Mt,Rt,O,{id:0,source:1,beforeId:2,beforeLayerType:3,paint:4,layout:5,minzoom:6,maxzoom:7})}}const{window:qt}=gt;function Gt(o){let e;return{c(){e=G("StreetView")},l(n){e=U(n,"StreetView")},m(n,t){L(n,e,t)},d(n){n&&p(e)}}}function ze(o){let e,n,t;function l(r){o[5](r)}let a={legend:"Source",choices:[["google","Google StreetView"],["bing","Bing Streetside"]],inlineSmall:!0};return o[1]!==void 0&&(a.value=o[1]),e=new yt({props:a}),se.push(()=>_e(e,"value",l)),{c(){A(e.$$.fragment)},l(r){R(e.$$.fragment,r)},m(r,f){M(e,r,f),t=!0},p(r,f){const c={};!n&&f&2&&(n=!0,c.value=r[1],ge(()=>n=!1)),e.$set(c)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){w(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function Ut(o){let e,n,t,l,a,r,f;function c(i){o[4](i)}let _={$$slots:{default:[Gt]},$$scope:{ctx:o}};o[0]!==void 0&&(_.checked=o[0]),e=new bt({props:_}),se.push(()=>_e(e,"checked",c));let s=o[0]&&ze(o);return{c(){A(e.$$.fragment),t=z(),s&&s.c(),l=K()},l(i){R(e.$$.fragment,i),t=D(i),s&&s.l(i),l=K()},m(i,u){M(e,i,u),L(i,t,u),s&&s.m(i,u),L(i,l,u),a=!0,r||(f=N(qt,"keydown",o[2]),r=!0)},p(i,[u]){const d={};u&512&&(d.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,d.checked=i[0],ge(()=>n=!1)),e.$set(d),i[0]?s?(s.p(i,u),u&1&&k(s,1)):(s=ze(i),s.c(),k(s,1),s.m(l.parentNode,l)):s&&(Q(),w(s,1,1,()=>{s=null}),X())},i(i){a||(k(e.$$.fragment,i),k(s),a=!0)},o(i){w(e.$$.fragment,i),w(s),a=!1},d(i){i&&(p(t),p(l)),V(e,i),s&&s.d(i),r=!1,f()}}}function Kt(o,e,n){let{map:t}=e,{enabled:l=!1}=e,a="google";function r(){t.on("click",c),t.getCanvas().style.cursor="zoom-in"}function f(){t.off("click",c),t.getCanvas().style.cursor="auto"}Ae(f);function c(u){window.open(a=="google"?Ot(u.lngLat.toArray()):Wt(u.lngLat.toArray()),"_blank"),n(0,l=!1)}function _(u){l&&u.key=="Escape"&&n(0,l=!1)}function s(u){l=u,n(0,l)}function i(u){a=u,n(1,a)}return o.$$set=u=>{"map"in u&&n(3,t=u.map),"enabled"in u&&n(0,l=u.enabled)},o.$$.update=()=>{o.$$.dirty&1&&(l?r():f())},[l,a,_,t,s,i]}class hn extends W{constructor(e){super(),j(this,e,Kt,Ut,O,{map:3,enabled:0})}}function bn(o){return ft(o)}function Ot(o){return`http://maps.google.com/maps?q=&layer=c&cbll=${o[1]},${o[0]}&cbp=11,0,0,0,0`}function Wt(o){return`https://www.bing.com/maps?cp=${o[1]}~${o[0]}&style=x`}const te=re(!1),fe=re(null),ce=re(100),Z=re({lng:0,lat:0}),J=re({lng:0,lat:0});function jt(o){let e,n;return e=new Re({props:{$$slots:{default:[Ht]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&8192&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Ft(o){let e,n,t="Georeference an image",l,a,r,f,c,_,s,i=`Note this image isn't saved as part of this scheme. When you close this
      page, it'll be lost.`,u;a=new ct({props:{$$slots:{default:[Jt]},$$scope:{ctx:o}}}),f=new nt({props:{label:"Load an image",id:"load-image",$$slots:{default:[Qt]},$$scope:{ctx:o}}});let d=o[3]&&De(o);return{c(){e=E("div"),n=E("h2"),n.textContent=t,l=z(),A(a.$$.fragment),r=z(),A(f.$$.fragment),c=z(),d&&d.c(),_=z(),s=E("p"),s.textContent=i,this.h()},l(g){e=I(g,"DIV",{style:!0});var m=T(e);n=I(m,"H2",{"data-svelte-h":!0}),ie(n)!=="svelte-fociiu"&&(n.textContent=t),l=D(m),R(a.$$.fragment,m),r=D(m),R(f.$$.fragment,m),c=D(m),d&&d.l(m),_=D(m),s=I(m,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-d8uklv"&&(s.textContent=i),m.forEach(p),this.h()},h(){H(e,"border","1px solid black"),H(e,"padding","4px")},m(g,m){L(g,e,m),S(e,n),S(e,l),M(a,e,null),S(e,r),M(f,e,null),S(e,c),d&&d.m(e,null),S(e,_),S(e,s),u=!0},p(g,m){const h={};m&8202&&(h.$$scope={dirty:m,ctx:g}),a.$set(h);const C={};m&8193&&(C.$$scope={dirty:m,ctx:g}),f.$set(C),g[3]?d?d.p(g,m):(d=De(g),d.c(),d.m(e,_)):d&&(d.d(1),d=null)},i(g){u||(k(a.$$.fragment,g),k(f.$$.fragment,g),u=!0)},o(g){w(a.$$.fragment,g),w(f.$$.fragment,g),u=!1},d(g){g&&p(e),V(a),V(f),d&&d.d()}}}function Ht(o){let e;return{c(){e=G("Georeference an image")},l(n){e=U(n,"Georeference an image")},m(n,t){L(n,e,t)},d(n){n&&p(e)}}}function Yt(o){let e;return{c(){e=G("Save")},l(n){e=U(n,"Save")},m(n,t){L(n,e,t)},d(n){n&&p(e)}}}function Zt(o){let e;return{c(){e=G("Delete")},l(n){e=U(n,"Delete")},m(n,t){L(n,e,t)},d(n){n&&p(e)}}}function Jt(o){let e,n,t,l;return e=new dt({props:{$$slots:{default:[Yt]},$$scope:{ctx:o}}}),e.$on("click",o[7]),t=new et({props:{disabled:!o[3],$$slots:{default:[Zt]},$$scope:{ctx:o}}}),t.$on("click",o[5]),{c(){A(e.$$.fragment),n=z(),A(t.$$.fragment)},l(a){R(e.$$.fragment,a),n=D(a),R(t.$$.fragment,a)},m(a,r){M(e,a,r),L(a,n,r),M(t,a,r),l=!0},p(a,r){const f={};r&8192&&(f.$$scope={dirty:r,ctx:a}),e.$set(f);const c={};r&8&&(c.disabled=!a[3]),r&8192&&(c.$$scope={dirty:r,ctx:a}),t.$set(c)},i(a){l||(k(e.$$.fragment,a),k(t.$$.fragment,a),l=!0)},o(a){w(e.$$.fragment,a),w(t.$$.fragment,a),l=!1},d(a){a&&p(n),V(e,a),V(t,a)}}}function Qt(o){let e,n,t;return{c(){e=E("input"),this.h()},l(l){e=I(l,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){y(e,"class","govuk-file-upload"),y(e,"id","load-image"),y(e,"type","file")},m(l,a){L(l,e,a),o[8](e),n||(t=N(e,"change",o[4]),n=!0)},p:he,d(l){l&&p(e),o[8](null),n=!1,t()}}}function De(o){let e,n,t,l,a,r,f,c;return{c(){e=E("div"),n=E("label"),t=E("input"),l=G(`
          Opacity: `),a=G(o[2]),r=G("%"),this.h()},l(_){e=I(_,"DIV",{});var s=T(e);n=I(s,"LABEL",{});var i=T(n);t=I(i,"INPUT",{type:!0,min:!0,max:!0}),l=U(i,`
          Opacity: `),a=U(i,o[2]),r=U(i,"%"),i.forEach(p),s.forEach(p),this.h()},h(){y(t,"type","range"),y(t,"min","0"),y(t,"max","100")},m(_,s){L(_,e,s),S(e,n),S(n,t),de(t,o[2]),S(n,l),S(n,a),S(n,r),f||(c=[N(t,"change",o[9]),N(t,"input",o[9])],f=!0)},p(_,s){s&4&&de(t,_[2]),s&4&&ye(a,_[2])},d(_){_&&p(e),f=!1,me(c)}}}function Xt(o){let e,n,t,l,a,r;const f=[Ft,jt],c=[];function _(s,i){return s[1]?0:1}return e=_(o),n=c[e]=f[e](o),{c(){n.c(),t=K()},l(s){n.l(s),t=K()},m(s,i){c[e].m(s,i),L(s,t,i),l=!0,a||(r=N(window,"keydown",o[6]),a=!0)},p(s,[i]){let u=e;e=_(s),e===u?c[e].p(s,i):(Q(),w(c[u],1,1,()=>{c[u]=null}),X(),n=c[e],n?n.p(s,i):(n=c[e]=f[e](s),n.c()),k(n,1),n.m(t.parentNode,t))},i(s){l||(k(n),l=!0)},o(s){w(n),l=!1},d(s){s&&p(t),c[e].d(s),a=!1,r()}}}function $t(o,e,n){let t,l,a,r,f;P(o,te,h=>n(1,t=h)),P(o,ce,h=>n(2,l=h)),P(o,fe,h=>n(3,a=h)),P(o,J,h=>n(11,r=h)),P(o,Z,h=>n(12,f=h));let c;async function _(h){let C=await c.files[0].arrayBuffer(),$=new Blob([new Uint8Array(C)]);B(fe,a=URL.createObjectURL($),a),B(Z,f={lng:0,lat:0},f),B(J,r={lng:0,lat:0},r)}function s(){B(fe,a=null,a),B(ce,l=100,l)}function i(h){t&&h.key=="Escape"&&(h.stopPropagation(),B(te,t=!1,t))}const u=()=>B(te,t=!1,t);function d(h){se[h?"unshift":"push"](()=>{c=h,n(0,c)})}function g(){l=$e(this.value),ce.set(l)}return[c,t,l,a,_,s,i,u,d,g,()=>B(te,t=!0,t)]}class pn extends W{constructor(e){super(),j(this,e,$t,Xt,O,{})}}function Pe(o){let e,n;return e=new zt({props:{url:o[2],coordinates:[[o[0].lng,o[0].lat],[o[3].lng,o[0].lat],[o[3].lng,o[3].lat],[o[0].lng,o[3].lat]],$$slots:{default:[xt]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&4&&(a.url=t[2]),l&9&&(a.coordinates=[[t[0].lng,t[0].lat],[t[3].lng,t[0].lat],[t[3].lng,t[3].lat],[t[0].lng,t[3].lat]]),l&272&&(a.$$scope={dirty:l,ctx:t}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function xt(o){let e,n;return e=new Vt({props:{paint:{"raster-fade-duration":0,"raster-opacity":o[4]/100}}}),{c(){A(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){M(e,t,l),n=!0},p(t,l){const a={};l&16&&(a.paint={"raster-fade-duration":0,"raster-opacity":t[4]/100}),e.$set(a)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Te(o){let e,n,t,l,a,r;function f(i){o[6](i)}let c={draggable:!0,$$slots:{default:[en]},$$scope:{ctx:o}};o[0]!==void 0&&(c.lngLat=o[0]),e=new Ne({props:c}),se.push(()=>_e(e,"lngLat",f));function _(i){o[7](i)}let s={draggable:!0,$$slots:{default:[tn]},$$scope:{ctx:o}};return o[3]!==void 0&&(s.lngLat=o[3]),l=new Ne({props:s}),se.push(()=>_e(l,"lngLat",_)),{c(){A(e.$$.fragment),t=z(),A(l.$$.fragment)},l(i){R(e.$$.fragment,i),t=D(i),R(l.$$.fragment,i)},m(i,u){M(e,i,u),L(i,t,u),M(l,i,u),r=!0},p(i,u){const d={};u&256&&(d.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,d.lngLat=i[0],ge(()=>n=!1)),e.$set(d);const g={};u&256&&(g.$$scope={dirty:u,ctx:i}),!a&&u&8&&(a=!0,g.lngLat=i[3],ge(()=>a=!1)),l.$set(g)},i(i){r||(k(e.$$.fragment,i),k(l.$$.fragment,i),r=!0)},o(i){w(e.$$.fragment,i),w(l.$$.fragment,i),r=!1},d(i){i&&p(t),V(e,i),V(l,i)}}}function en(o){let e;return{c(){e=E("span"),this.h()},l(n){e=I(n,"SPAN",{class:!0,style:!0}),T(e).forEach(p),this.h()},h(){y(e,"class","dot svelte-1tmbx1c"),H(e,"background-color","red")},m(n,t){L(n,e,t)},p:he,d(n){n&&p(e)}}}function tn(o){let e;return{c(){e=E("span"),this.h()},l(n){e=I(n,"SPAN",{class:!0,style:!0}),T(e).forEach(p),this.h()},h(){y(e,"class","dot svelte-1tmbx1c"),H(e,"background-color","blue")},m(n,t){L(n,e,t)},p:he,d(n){n&&p(e)}}}function nn(o){let e,n,t,l=o[2]&&o[0].lng!=o[3].lng&&Pe(o),a=o[2]&&o[1]&&Te(o);return{c(){l&&l.c(),e=z(),a&&a.c(),n=K()},l(r){l&&l.l(r),e=D(r),a&&a.l(r),n=K()},m(r,f){l&&l.m(r,f),L(r,e,f),a&&a.m(r,f),L(r,n,f),t=!0},p(r,[f]){r[2]&&r[0].lng!=r[3].lng?l?(l.p(r,f),f&13&&k(l,1)):(l=Pe(r),l.c(),k(l,1),l.m(e.parentNode,e)):l&&(Q(),w(l,1,1,()=>{l=null}),X()),r[2]&&r[1]?a?(a.p(r,f),f&6&&k(a,1)):(a=Te(r),a.c(),k(a,1),a.m(n.parentNode,n)):a&&(Q(),w(a,1,1,()=>{a=null}),X())},i(r){t||(k(l),k(a),t=!0)},o(r){w(l),w(a),t=!1},d(r){r&&(p(e),p(n)),l&&l.d(r),a&&a.d(r)}}}function ln(o,e,n){let t,l,a,r,f;P(o,J,i=>n(3,t=i)),P(o,Z,i=>n(0,l=i)),P(o,te,i=>n(1,a=i)),P(o,fe,i=>n(2,r=i)),P(o,ce,i=>n(4,f=i));let{map:c}=e;function _(i){l=i,Z.set(l)}function s(i){t=i,J.set(t)}return o.$$set=i=>{"map"in i&&n(5,c=i.map)},o.$$.update=()=>{if(o.$$.dirty&39&&r&&a&&l.lng==0&&l.lat==0){let i=c.getBounds();B(Z,l.lng=i.getWest()+.4*(i.getEast()-i.getWest()),l),B(J,t.lng=i.getWest()+.6*(i.getEast()-i.getWest()),t),B(Z,l.lat=i.getNorth()+.4*(i.getSouth()-i.getNorth()),l),B(J,t.lat=i.getNorth()+.6*(i.getSouth()-i.getNorth()),t)}},[l,a,r,t,f,c,_,s]}class kn extends W{constructor(e){super(),j(this,e,ln,nn,O,{map:5})}}export{mn as B,pn as G,Ne as M,yt as R,hn as S,bn as a,Wt as b,kn as c,gt as g,Ot as s};
