import{s as Se,a as k,g as y,i as x,f as $,Q as Re,e as I,c as C,m as fe,o as E,z as je,n as $e,r as Ye,t as D,b as X,d as B,h as p,j as Le,G as He,v as we,R as be,S as re}from"./scheduler.DNnUYlgZ.js";import{S as Ee,i as Ae,c as G,a as R,m as j,t as F,b as L,d as Y,g as ve,f as ke}from"./index.tVBxdTp3.js";import{e as ye}from"./each.BkSaxPTE.js";import{b as ie}from"./paths.D6jcJbAP.js";import{B as Ne,C as Ve}from"./ClickableCard.C-b1L8ER.js";import{F as Je}from"./FileInput.DkO2E3GN.js";import{S as _e}from"./SecondaryButton.CsCq7jjb.js";/* empty css                                                       */import{W as De}from"./WarningButton.BcgE3MAp.js";import{a as Be}from"./index.dACCss-l.js";import{F as Te}from"./FormElement.DE2ZDpks.js";import{L as Xe}from"./Loading.DXym9ja7.js";function Me(n){let e,t,l,i=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
    . After importing, there will still be some problems:
    <ul><li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li></ul>`,r,o;return{c(){e=I("input"),t=k(),l=I("div"),l.innerHTML=i,this.h()},l(s){e=C(s,"INPUT",{class:!0,id:!0,type:!0}),t=y(s),l=C(s,"DIV",{class:!0,"data-svelte-h":!0}),fe(l)!=="svelte-1alapt1"&&(l.innerHTML=i),this.h()},h(){E(e,"class","govuk-file-upload"),E(e,"id","import-xlsx"),E(e,"type","file"),E(l,"class","govuk-hint")},m(s,d){x(s,e,d),n[4](e),x(s,t,d),x(s,l,d),r||(o=je(e,"change",n[2]),r=!0)},p:$e,d(s){s&&($(e),$(t),$(l)),n[4](null),r=!1,o()}}}function Oe(n){let e,t,l,i;return e=new Te({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[Me]},$$scope:{ctx:n}}}),l=new Xe({props:{loading:n[0]}}),{c(){G(e.$$.fragment),t=k(),G(l.$$.fragment)},l(r){R(e.$$.fragment,r),t=y(r),R(l.$$.fragment,r)},m(r,o){j(e,r,o),x(r,t,o),j(l,r,o),i=!0},p(r,[o]){const s={};o&66&&(s.$$scope={dirty:o,ctx:r}),e.$set(s);const d={};o&1&&(d.loading=r[0]),l.$set(d)},i(r){i||(F(e.$$.fragment,r),F(l.$$.fragment,r),i=!0)},o(r){L(e.$$.fragment,r),L(l.$$.fragment,r),i=!1},d(r){r&&$(t),Y(e,r),Y(l,r)}}}function Pe(n,e,t){let l=Re(),{xlsxImporter:i}=e,r="",o;async function s(a){let m=o.files[0].name;try{t(0,r=`Loading ${m}`);let _=await o.files[0].arrayBuffer(),A=await i(_);t(0,r=""),l("imported",{filename:Be(m,".xlsx"),data:A})}catch(_){window.alert(`Couldn't import ${m}: ${_}`),t(0,r="")}}function d(a){Ye[a?"unshift":"push"](()=>{o=a,t(1,o)})}return n.$$set=a=>{"xlsxImporter"in a&&t(3,i=a.xlsxImporter)},[r,o,s,i,d]}class Ue extends Ee{constructor(e){super(),Ae(this,e,Pe,Oe,Se,{xlsxImporter:3})}}function Fe(n,e,t){const l=n.slice();return l[17]=e[t],l}function qe(n){let e;return{c(){e=D("Rename this file")},l(t){e=B(t,"Rename this file")},m(t,l){x(t,e,l)},d(t){t&&$(e)}}}function ze(n){let e;return{c(){e=D("Export this file")},l(t){e=B(t,"Export this file")},m(t,l){x(t,e,l)},d(t){t&&$(e)}}}function We(n){let e;return{c(){e=D("Delete this file")},l(t){e=B(t,"Delete this file")},m(t,l){x(t,e,l)},d(t){t&&$(e)}}}function Ke(n){let e,t,l,i,r,o;return e=new _e({props:{$$slots:{default:[qe]},$$scope:{ctx:n}}}),e.$on("click",n[6]),l=new _e({props:{$$slots:{default:[ze]},$$scope:{ctx:n}}}),l.$on("click",n[7]),r=new De({props:{$$slots:{default:[We]},$$scope:{ctx:n}}}),r.$on("click",n[13]),{c(){G(e.$$.fragment),t=k(),G(l.$$.fragment),i=k(),G(r.$$.fragment)},l(s){R(e.$$.fragment,s),t=y(s),R(l.$$.fragment,s),i=y(s),R(r.$$.fragment,s)},m(s,d){j(e,s,d),x(s,t,d),j(l,s,d),x(s,i,d),j(r,s,d),o=!0},p(s,d){const a={};d&1048576&&(a.$$scope={dirty:d,ctx:s}),e.$set(a);const m={};d&1048576&&(m.$$scope={dirty:d,ctx:s}),l.$set(m);const _={};d&1048576&&(_.$$scope={dirty:d,ctx:s}),r.$set(_)},i(s){o||(F(e.$$.fragment,s),F(l.$$.fragment,s),F(r.$$.fragment,s),o=!0)},o(s){L(e.$$.fragment,s),L(l.$$.fragment,s),L(r.$$.fragment,s),o=!1},d(s){s&&($(t),$(i)),Y(e,s),Y(l,s),Y(r,s)}}}function Qe(n){let e;return{c(){e=D("New blank file")},l(t){e=B(t,"New blank file")},m(t,l){x(t,e,l)},d(t){t&&$(e)}}}function Ie(n){let e,t,l,i;return l=new Ue({props:{xlsxImporter:n[3]}}),l.$on("imported",n[11]),{c(){e=I("hr"),t=k(),G(l.$$.fragment)},l(r){e=C(r,"HR",{}),t=y(r),R(l.$$.fragment,r)},m(r,o){x(r,e,o),x(r,t,o),j(l,r,o),i=!0},p(r,o){const s={};o&8&&(s.xlsxImporter=r[3]),l.$set(s)},i(r){i||(F(l.$$.fragment,r),i=!0)},o(r){L(l.$$.fragment,r),i=!1},d(r){r&&($(e),$(t)),Y(l,r)}}}function Ze(n){let e=(n[17]==n[5]?"Currently open":n[0].describeFile(n[17]))+"",t;return{c(){t=D(e)},l(l){t=B(l,e)},m(l,i){x(l,t,i)},p(l,i){i&49&&e!==(e=(l[17]==l[5]?"Currently open":l[0].describeFile(l[17]))+"")&&Le(t,e)},d(l){l&&$(t)}}}function et(n){let e;return{c(){e=D("Delete")},l(t){e=B(t,"Delete")},m(t,l){x(t,e,l)},d(t){t&&$(e)}}}function Ce(n){let e,t,l,i,r,o;function s(){return n[14](n[17])}t=new Ve({props:{name:`File name: ${n[17]}`,disabled:n[17]===n[5],$$slots:{default:[Ze]},$$scope:{ctx:n}}}),t.$on("click",s);function d(){return n[15](n[17])}return i=new De({props:{$$slots:{default:[et]},$$scope:{ctx:n}}}),i.$on("click",d),{c(){e=I("div"),G(t.$$.fragment),l=k(),G(i.$$.fragment),r=k(),this.h()},l(a){e=C(a,"DIV",{style:!0});var m=X(e);R(t.$$.fragment,m),l=y(m),R(i.$$.fragment,m),r=y(m),m.forEach($),this.h()},h(){we(e,"display","flex"),we(e,"justify-content","space-between")},m(a,m){x(a,e,m),j(t,e,null),p(e,l),j(i,e,null),p(e,r),o=!0},p(a,m){n=a;const _={};m&16&&(_.name=`File name: ${n[17]}`),m&48&&(_.disabled=n[17]===n[5]),m&1048625&&(_.$$scope={dirty:m,ctx:n}),t.$set(_);const A={};m&1048576&&(A.$$scope={dirty:m,ctx:n}),i.$set(A)},i(a){o||(F(t.$$.fragment,a),F(i.$$.fragment,a),o=!0)},o(a){L(t.$$.fragment,a),L(i.$$.fragment,a),o=!1},d(a){a&&$(e),Y(t),Y(i)}}}function tt(n){let e,t,l,i,r,o,s=`All files are auto-saved in your browser's local storage. You can close your
    browser and resume later. You can export the file to your computer to share
    with someone else, and import from a file below.`,d,a,m,_,A,H,te,N,q,Z,le,V,w,M,oe="Create or import a file",ne,f,b,S,O,ue,T,ee,he="Load a saved file",ce,me,P,de,se,z;N=new Ne({props:{$$slots:{default:[Ke]},$$scope:{ctx:n}}}),f=new _e({props:{$$slots:{default:[Qe]},$$scope:{ctx:n}}}),f.$on("click",n[9]),S=new Je({props:{label:"Import from a .json file",onLoad:n[10]}});let g=n[3]!=null&&Ie(n),W=ye(n[4]),h=[];for(let u=0;u<W.length;u+=1)h[u]=Ce(Fe(n,W,u));const Ge=u=>L(h[u],1,1,()=>{h[u]=null});return{c(){e=I("div"),t=I("a"),l=D("Back to overview"),r=k(),o=I("p"),o.textContent=s,d=k(),a=I("p"),m=D("You're currently editing "),_=I("u"),A=D(n[5]),H=D(`
    .`),te=k(),G(N.$$.fragment),q=k(),Z=I("hr"),le=k(),V=I("div"),w=I("div"),M=I("h2"),M.textContent=oe,ne=k(),G(f.$$.fragment),b=k(),G(S.$$.fragment),O=k(),g&&g.c(),ue=k(),T=I("div"),ee=I("h2"),ee.textContent=he,ce=k();for(let u=0;u<h.length;u+=1)h[u].c();me=k(),P=I("a"),de=D("Back to overview"),this.h()},l(u){e=C(u,"DIV",{class:!0});var c=X(e);t=C(c,"A",{href:!0,class:!0});var J=X(t);l=B(J,"Back to overview"),J.forEach($),r=y(c),o=C(c,"P",{"data-svelte-h":!0}),fe(o)!=="svelte-1yvzirp"&&(o.textContent=s),d=y(c),a=C(c,"P",{});var K=X(a);m=B(K,"You're currently editing "),_=C(K,"U",{});var v=X(_);A=B(v,n[5]),v.forEach($),H=B(K,`
    .`),K.forEach($),te=y(c),R(N.$$.fragment,c),q=y(c),Z=C(c,"HR",{}),le=y(c),V=C(c,"DIV",{class:!0});var Q=X(V);w=C(Q,"DIV",{class:!0});var U=X(w);M=C(U,"H2",{"data-svelte-h":!0}),fe(M)!=="svelte-1yqhw3l"&&(M.textContent=oe),ne=y(U),R(f.$$.fragment,U),b=y(U),R(S.$$.fragment,U),O=y(U),g&&g.l(U),U.forEach($),ue=y(Q),T=C(Q,"DIV",{class:!0});var ae=X(T);ee=C(ae,"H2",{"data-svelte-h":!0}),fe(ee)!=="svelte-oj70x0"&&(ee.textContent=he),ce=y(ae);for(let pe=0;pe<h.length;pe+=1)h[pe].l(ae);ae.forEach($),Q.forEach($),me=y(c),P=C(c,"A",{href:!0,class:!0});var ge=X(P);de=B(ge,"Back to overview"),ge.forEach($),c.forEach($),this.h()},h(){E(t,"href",i=ie+"/"+n[0].prefix),E(t,"class","govuk-back-link"),E(w,"class","govuk-grid-column-one-half"),E(T,"class","govuk-grid-column-one-half"),E(V,"class","govuk-grid-row"),E(P,"href",se=ie+"/"+n[0].prefix),E(P,"class","govuk-back-link"),E(e,"class","govuk-width-container")},m(u,c){x(u,e,c),p(e,t),p(t,l),p(e,r),p(e,o),p(e,d),p(e,a),p(a,m),p(a,_),p(_,A),p(a,H),p(e,te),j(N,e,null),p(e,q),p(e,Z),p(e,le),p(e,V),p(V,w),p(w,M),p(w,ne),j(f,w,null),p(w,b),j(S,w,null),p(w,O),g&&g.m(w,null),p(V,ue),p(V,T),p(T,ee),p(T,ce);for(let J=0;J<h.length;J+=1)h[J]&&h[J].m(T,null);p(e,me),p(e,P),p(P,de),z=!0},p(u,[c]){(!z||c&1&&i!==(i=ie+"/"+u[0].prefix))&&E(t,"href",i),(!z||c&32)&&Le(A,u[5]);const J={};c&1048608&&(J.$$scope={dirty:c,ctx:u}),N.$set(J);const K={};if(c&1048576&&(K.$$scope={dirty:c,ctx:u}),f.$set(K),u[3]!=null?g?(g.p(u,c),c&8&&F(g,1)):(g=Ie(u),g.c(),F(g,1),g.m(w,null)):g&&(ve(),L(g,1,1,()=>{g=null}),ke()),c&4401){W=ye(u[4]);let v;for(v=0;v<W.length;v+=1){const Q=Fe(u,W,v);h[v]?(h[v].p(Q,c),F(h[v],1)):(h[v]=Ce(Q),h[v].c(),F(h[v],1),h[v].m(T,null))}for(ve(),v=W.length;v<h.length;v+=1)Ge(v);ke()}(!z||c&1&&se!==(se=ie+"/"+u[0].prefix))&&E(P,"href",se)},i(u){if(!z){F(N.$$.fragment,u),F(f.$$.fragment,u),F(S.$$.fragment,u),F(g);for(let c=0;c<W.length;c+=1)F(h[c]);z=!0}},o(u){L(N.$$.fragment,u),L(f.$$.fragment,u),L(S.$$.fragment,u),L(g),h=h.filter(Boolean);for(let c=0;c<h.length;c+=1)L(h[c]);z=!1},d(u){u&&$(e),Y(N),Y(f),Y(S),g&&g.d(),He(h,u)}}}function xe(n,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function lt(n,e,t){let l,i=$e,r=()=>(i(),i=be(_,f=>t(16,l=f)),_),o,s=$e,d=()=>(s(),s=be(m,f=>t(5,o=f)),m);n.$$.on_destroy.push(()=>i()),n.$$.on_destroy.push(()=>s());let{files:a}=e,{currentFile:m}=e;d();let{state:_}=e;r();let{xlsxImporter:A=null}=e,H=a.getFileList();function te(){let f=window.prompt(`Rename file ${o} to what?`,o);if(f){let b=a.key(o),S=window.localStorage.getItem(b);window.localStorage.setItem(a.key(f),S),window.localStorage.removeItem(b),re(m,o=f,o),t(4,H=a.getFileList())}}function N(){xe(o+".json",JSON.stringify(l))}async function q(f){if(window.confirm(`Really delete file ${f}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let b=a.key(f);xe(`${f}.json`,window.localStorage.getItem(b)),window.localStorage.removeItem(b),f==o?await Z():t(4,H=a.saveAndGetFileList(o,l))}}async function Z(){re(m,o=a.newFilename(),o),re(_,l=a.emptyState(),l),t(4,H=a.saveAndGetFileList(o,l))}async function le(f,b){let S=Be(f,".json");try{let O=JSON.parse(b);a.validate(O),t(4,H=a.saveAndGetFileList(S,O)),await w(S)}catch(O){window.alert(`Couldn't load ${S}: ${O}`)}}async function V(f){let{filename:b,data:S}=f.detail;t(4,H=a.saveAndGetFileList(b,S)),await w(b)}async function w(f){try{let b=a.loadFile(f);re(m,o=f,o),re(_,l=b,l)}catch(b){window.alert(`Couldn't load ${f}: ${b}`)}}const M=()=>q(o),oe=f=>w(f),ne=f=>q(f);return n.$$set=f=>{"files"in f&&t(0,a=f.files),"currentFile"in f&&d(t(1,m=f.currentFile)),"state"in f&&r(t(2,_=f.state)),"xlsxImporter"in f&&t(3,A=f.xlsxImporter)},[a,m,_,A,H,o,te,N,q,Z,le,V,w,M,oe,ne]}class $t extends Ee{constructor(e){super(),Ae(this,e,lt,tt,Se,{files:0,currentFile:1,state:2,xlsxImporter:3})}}export{$t as F};
