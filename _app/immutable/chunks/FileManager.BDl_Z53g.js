import{s as Ce,a as k,g as F,i as S,f as $,Q as Be,e as C,c as x,m as ie,o as L,z as De,n as $e,r as Re,t as R,b as U,d as G,h as p,j as xe,G as Ge,R as we,S as re}from"./scheduler.DNnUYlgZ.js";import{S as Se,i as Le,c as Y,a as H,m as N,t as y,b as E,d as j,g as be,f as ve}from"./index.tVBxdTp3.js";import{e as ke}from"./each.BkSaxPTE.js";import{b as ae}from"./paths.hWLgvDQu.js";import{B as Ye,C as He}from"./ClickableCard.C-b1L8ER.js";import{F as Ne}from"./FileInput.DkO2E3GN.js";import{S as he}from"./SecondaryButton.CsCq7jjb.js";/* empty css                                                       */import{W as je}from"./WarningButton.BcgE3MAp.js";import{a as Ee}from"./index.Au7gs0Dg.js";import{F as Je}from"./FormElement.DE2ZDpks.js";import{L as Te}from"./Loading.DXym9ja7.js";function Ve(r){let e,t,n,o=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
    . After importing, there will still be some problems:
    <ul><li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li></ul>`,l,s;return{c(){e=C("input"),t=k(),n=C("div"),n.innerHTML=o,this.h()},l(a){e=x(a,"INPUT",{class:!0,id:!0,type:!0}),t=F(a),n=x(a,"DIV",{class:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1alapt1"&&(n.innerHTML=o),this.h()},h(){L(e,"class","govuk-file-upload"),L(e,"id","import-xlsx"),L(e,"type","file"),L(n,"class","govuk-hint")},m(a,m){S(a,e,m),r[4](e),S(a,t,m),S(a,n,m),l||(s=De(e,"change",r[2]),l=!0)},p:$e,d(a){a&&($(e),$(t),$(n)),r[4](null),l=!1,s()}}}function Xe(r){let e,t,n,o;return e=new Je({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[Ve]},$$scope:{ctx:r}}}),n=new Te({props:{loading:r[0]}}),{c(){Y(e.$$.fragment),t=k(),Y(n.$$.fragment)},l(l){H(e.$$.fragment,l),t=F(l),H(n.$$.fragment,l)},m(l,s){N(e,l,s),S(l,t,s),N(n,l,s),o=!0},p(l,[s]){const a={};s&66&&(a.$$scope={dirty:s,ctx:l}),e.$set(a);const m={};s&1&&(m.loading=l[0]),n.$set(m)},i(l){o||(y(e.$$.fragment,l),y(n.$$.fragment,l),o=!0)},o(l){E(e.$$.fragment,l),E(n.$$.fragment,l),o=!1},d(l){l&&$(t),j(e,l),j(n,l)}}}function Me(r,e,t){let n=Be(),{xlsxImporter:o}=e,l="",s;async function a(u){let g=s.files[0].name;try{t(0,l=`Loading ${g}`);let _=await s.files[0].arrayBuffer(),J=await o(_);t(0,l=""),n("imported",{filename:Ee(g,".xlsx"),data:J})}catch(_){window.alert(`Couldn't import ${g}: ${_}`),t(0,l="")}}function m(u){Re[u?"unshift":"push"](()=>{s=u,t(1,s)})}return r.$$set=u=>{"xlsxImporter"in u&&t(3,o=u.xlsxImporter)},[l,s,a,o,m]}class Oe extends Se{constructor(e){super(),Le(this,e,Me,Xe,Ce,{xlsxImporter:3})}}function Fe(r,e,t){const n=r.slice();return n[15]=e[t],n}function Pe(r){let e;return{c(){e=R("Rename this file")},l(t){e=G(t,"Rename this file")},m(t,n){S(t,e,n)},d(t){t&&$(e)}}}function Ue(r){let e;return{c(){e=R("Export this file")},l(t){e=G(t,"Export this file")},m(t,n){S(t,e,n)},d(t){t&&$(e)}}}function qe(r){let e;return{c(){e=R("Delete this file")},l(t){e=G(t,"Delete this file")},m(t,n){S(t,e,n)},d(t){t&&$(e)}}}function ze(r){let e,t,n,o,l,s;return e=new he({props:{$$slots:{default:[Pe]},$$scope:{ctx:r}}}),e.$on("click",r[6]),n=new he({props:{$$slots:{default:[Ue]},$$scope:{ctx:r}}}),n.$on("click",r[7]),l=new je({props:{$$slots:{default:[qe]},$$scope:{ctx:r}}}),l.$on("click",r[8]),{c(){Y(e.$$.fragment),t=k(),Y(n.$$.fragment),o=k(),Y(l.$$.fragment)},l(a){H(e.$$.fragment,a),t=F(a),H(n.$$.fragment,a),o=F(a),H(l.$$.fragment,a)},m(a,m){N(e,a,m),S(a,t,m),N(n,a,m),S(a,o,m),N(l,a,m),s=!0},p(a,m){const u={};m&262144&&(u.$$scope={dirty:m,ctx:a}),e.$set(u);const g={};m&262144&&(g.$$scope={dirty:m,ctx:a}),n.$set(g);const _={};m&262144&&(_.$$scope={dirty:m,ctx:a}),l.$set(_)},i(a){s||(y(e.$$.fragment,a),y(n.$$.fragment,a),y(l.$$.fragment,a),s=!0)},o(a){E(e.$$.fragment,a),E(n.$$.fragment,a),E(l.$$.fragment,a),s=!1},d(a){a&&($(t),$(o)),j(e,a),j(n,a),j(l,a)}}}function We(r){let e;return{c(){e=R("New blank file")},l(t){e=G(t,"New blank file")},m(t,n){S(t,e,n)},d(t){t&&$(e)}}}function ye(r){let e,t,n,o;return n=new Oe({props:{xlsxImporter:r[3]}}),n.$on("imported",r[11]),{c(){e=C("hr"),t=k(),Y(n.$$.fragment)},l(l){e=x(l,"HR",{}),t=F(l),H(n.$$.fragment,l)},m(l,s){S(l,e,s),S(l,t,s),N(n,l,s),o=!0},p(l,s){const a={};s&8&&(a.xlsxImporter=l[3]),n.$set(a)},i(l){o||(y(n.$$.fragment,l),o=!0)},o(l){E(n.$$.fragment,l),o=!1},d(l){l&&($(e),$(t)),j(n,l)}}}function Ke(r){let e=(r[15]==r[5]?"Currently open":r[0].describeFile(r[15]))+"",t,n;return{c(){t=R(e),n=k()},l(o){t=G(o,e),n=F(o)},m(o,l){S(o,t,l),S(o,n,l)},p(o,l){l&49&&e!==(e=(o[15]==o[5]?"Currently open":o[0].describeFile(o[15]))+"")&&xe(t,e)},d(o){o&&($(t),$(n))}}}function Ie(r){let e,t;function n(){return r[13](r[15])}return e=new He({props:{name:`File name: ${r[15]}`,disabled:r[15]===r[5],$$slots:{default:[Ke]},$$scope:{ctx:r}}}),e.$on("click",n),{c(){Y(e.$$.fragment)},l(o){H(e.$$.fragment,o)},m(o,l){N(e,o,l),t=!0},p(o,l){r=o;const s={};l&16&&(s.name=`File name: ${r[15]}`),l&48&&(s.disabled=r[15]===r[5]),l&262193&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(o){t||(y(e.$$.fragment,o),t=!0)},o(o){E(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function Qe(r){let e,t,n,o,l,s,a=`All files are auto-saved in your browser's local storage. You can close your
    browser and resume later. You can export the file to your computer to share
    with someone else, and import from a file below.`,m,u,g,_,J,T,te,A,le,Z,ne,B,w,X,c="Create or import a file",I,v,M,q,fe,ue,V,ee,_e="Load a saved file",ce,me,O,pe,oe,z;A=new Ye({props:{$$slots:{default:[ze]},$$scope:{ctx:r}}}),v=new he({props:{$$slots:{default:[We]},$$scope:{ctx:r}}}),v.$on("click",r[9]),q=new Ne({props:{label:"Import from a .json file",onLoad:r[10]}});let h=r[3]!=null&&ye(r),W=ke(r[4]),d=[];for(let i=0;i<W.length;i+=1)d[i]=Ie(Fe(r,W,i));const Ae=i=>E(d[i],1,1,()=>{d[i]=null});return{c(){e=C("div"),t=C("a"),n=R("Back to overview"),l=k(),s=C("p"),s.textContent=a,m=k(),u=C("p"),g=R("You're currently editing "),_=C("u"),J=R(r[5]),T=R(`
    .`),te=k(),Y(A.$$.fragment),le=k(),Z=C("hr"),ne=k(),B=C("div"),w=C("div"),X=C("h2"),X.textContent=c,I=k(),Y(v.$$.fragment),M=k(),Y(q.$$.fragment),fe=k(),h&&h.c(),ue=k(),V=C("div"),ee=C("h2"),ee.textContent=_e,ce=k();for(let i=0;i<d.length;i+=1)d[i].c();me=k(),O=C("a"),pe=R("Back to overview"),this.h()},l(i){e=x(i,"DIV",{class:!0});var f=U(e);t=x(f,"A",{href:!0,class:!0});var D=U(t);n=G(D,"Back to overview"),D.forEach($),l=F(f),s=x(f,"P",{"data-svelte-h":!0}),ie(s)!=="svelte-1yvzirp"&&(s.textContent=a),m=F(f),u=x(f,"P",{});var K=U(u);g=G(K,"You're currently editing "),_=x(K,"U",{});var b=U(_);J=G(b,r[5]),b.forEach($),T=G(K,`
    .`),K.forEach($),te=F(f),H(A.$$.fragment,f),le=F(f),Z=x(f,"HR",{}),ne=F(f),B=x(f,"DIV",{class:!0});var Q=U(B);w=x(Q,"DIV",{class:!0});var P=U(w);X=x(P,"H2",{"data-svelte-h":!0}),ie(X)!=="svelte-1yqhw3l"&&(X.textContent=c),I=F(P),H(v.$$.fragment,P),M=F(P),H(q.$$.fragment,P),fe=F(P),h&&h.l(P),P.forEach($),ue=F(Q),V=x(Q,"DIV",{class:!0});var se=U(V);ee=x(se,"H2",{"data-svelte-h":!0}),ie(ee)!=="svelte-oj70x0"&&(ee.textContent=_e),ce=F(se);for(let de=0;de<d.length;de+=1)d[de].l(se);se.forEach($),Q.forEach($),me=F(f),O=x(f,"A",{href:!0,class:!0});var ge=U(O);pe=G(ge,"Back to overview"),ge.forEach($),f.forEach($),this.h()},h(){L(t,"href",o=ae+"/"+r[0].prefix),L(t,"class","govuk-back-link"),L(w,"class","govuk-grid-column-one-half"),L(V,"class","govuk-grid-column-one-half"),L(B,"class","govuk-grid-row"),L(O,"href",oe=ae+"/"+r[0].prefix),L(O,"class","govuk-back-link"),L(e,"class","govuk-width-container")},m(i,f){S(i,e,f),p(e,t),p(t,n),p(e,l),p(e,s),p(e,m),p(e,u),p(u,g),p(u,_),p(_,J),p(u,T),p(e,te),N(A,e,null),p(e,le),p(e,Z),p(e,ne),p(e,B),p(B,w),p(w,X),p(w,I),N(v,w,null),p(w,M),N(q,w,null),p(w,fe),h&&h.m(w,null),p(B,ue),p(B,V),p(V,ee),p(V,ce);for(let D=0;D<d.length;D+=1)d[D]&&d[D].m(V,null);p(e,me),p(e,O),p(O,pe),z=!0},p(i,[f]){(!z||f&1&&o!==(o=ae+"/"+i[0].prefix))&&L(t,"href",o),(!z||f&32)&&xe(J,i[5]);const D={};f&262144&&(D.$$scope={dirty:f,ctx:i}),A.$set(D);const K={};if(f&262144&&(K.$$scope={dirty:f,ctx:i}),v.$set(K),i[3]!=null?h?(h.p(i,f),f&8&&y(h,1)):(h=ye(i),h.c(),y(h,1),h.m(w,null)):h&&(be(),E(h,1,1,()=>{h=null}),ve()),f&4145){W=ke(i[4]);let b;for(b=0;b<W.length;b+=1){const Q=Fe(i,W,b);d[b]?(d[b].p(Q,f),y(d[b],1)):(d[b]=Ie(Q),d[b].c(),y(d[b],1),d[b].m(V,null))}for(be(),b=W.length;b<d.length;b+=1)Ae(b);ve()}(!z||f&1&&oe!==(oe=ae+"/"+i[0].prefix))&&L(O,"href",oe)},i(i){if(!z){y(A.$$.fragment,i),y(v.$$.fragment,i),y(q.$$.fragment,i),y(h);for(let f=0;f<W.length;f+=1)y(d[f]);z=!0}},o(i){E(A.$$.fragment,i),E(v.$$.fragment,i),E(q.$$.fragment,i),E(h),d=d.filter(Boolean);for(let f=0;f<d.length;f+=1)E(d[f]);z=!1},d(i){i&&$(e),j(A),j(v),j(q),h&&h.d(),Ge(d,i)}}}function Ze(r,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function et(r,e,t){let n,o=$e,l=()=>(o(),o=we(_,c=>t(14,n=c)),_),s,a=$e,m=()=>(a(),a=we(g,c=>t(5,s=c)),g);r.$$.on_destroy.push(()=>o()),r.$$.on_destroy.push(()=>a());let{files:u}=e,{currentFile:g}=e;m();let{state:_}=e;l();let{xlsxImporter:J=null}=e,T=u.getFileList();function te(){let c=window.prompt(`Rename file ${s} to what?`,s);if(c){let I=u.key(s),v=window.localStorage.getItem(I);window.localStorage.setItem(u.key(c),v),window.localStorage.removeItem(I),re(g,s=c,s),t(4,T=u.getFileList())}}function A(){Ze(s+".json",JSON.stringify(n))}async function le(){window.confirm(`Really delete file ${s}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)&&(A(),window.localStorage.removeItem(u.key(s)),await Z())}async function Z(){re(g,s=u.newFilename(),s),re(_,n=u.emptyState(),n),t(4,T=u.saveAndGetFileList(s,n))}async function ne(c,I){let v=Ee(c,".json");try{let M=JSON.parse(I);u.validate(M),t(4,T=u.saveAndGetFileList(v,M)),await w(v)}catch(M){window.alert(`Couldn't load ${v}: ${M}`)}}async function B(c){let{filename:I,data:v}=c.detail;t(4,T=u.saveAndGetFileList(I,v)),await w(I)}async function w(c){try{let I=u.loadFile(c);re(g,s=c,s),re(_,n=I,n)}catch(I){window.alert(`Couldn't load ${c}: ${I}`)}}const X=c=>w(c);return r.$$set=c=>{"files"in c&&t(0,u=c.files),"currentFile"in c&&m(t(1,g=c.currentFile)),"state"in c&&l(t(2,_=c.state)),"xlsxImporter"in c&&t(3,J=c.xlsxImporter)},[u,g,_,J,T,s,te,A,le,Z,ne,B,w,X]}class pt extends Se{constructor(e){super(),Le(this,e,et,Qe,Ce,{files:0,currentFile:1,state:2,xlsxImporter:3})}}export{pt as F};
