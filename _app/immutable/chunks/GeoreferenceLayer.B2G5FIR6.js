import{s as K,l as x,e as E,a as N,c as T,b as H,g as D,f as v,r as L,w as Z,i as S,h as I,z as B,u as $,m as ee,o as te,B as ye,H as q,a9 as Qe,t as O,d as W,y as he,j as Ee,q as Xe,O as xe,C as ve,p as ce,v as ne,x as me,E as j,k as V,a7 as Ke,N as z,n as pe,aa as ze,A as Ie,Z as $e,a8 as et,ab as tt}from"./scheduler.Bsni_e59.js";import{S as F,i as Y,t as y,b as w,c as P,a as M,m as A,d as R,e as de,g as le,f as oe}from"./index.CCfAUppz.js";import{C as nt}from"./CollapsibleCard.DoOZ0Bze.js";import{S as Oe,W as lt}from"./WarningButton.D9QeV9gM.js";import{L as We,a as Te,u as ot,r as at,b as it,c as rt,d as st,m as ut,g as ft,t as ct}from"./MapLibreMap.CYadG6ne.js";import{v as je,E as mt}from"./ErrorMessage.14aTrMcQ.js";import{e as Be}from"./each.ChCadThl.js";import{B as dt}from"./ButtonGroup.hr9f_7ak.js";import{D as gt}from"./DefaultButton.DyQsHGbh.js";import{F as _t}from"./FormElement.BSg02y8j.js";import{w as ge}from"./entry.1kUlYkPS.js";const ht=o=>({}),Ne=o=>({});function bt(o){let e,t,n,l,a,r,u,f,g;const s=o[5].default,i=x(s,o,o[4],null),c=o[5].right,m=x(c,o,o[4],Ne);return{c(){e=E("div"),t=E("input"),n=N(),l=E("label"),i&&i.c(),a=N(),r=E("span"),m&&m.c(),this.h()},l(d){e=T(d,"DIV",{class:!0,style:!0});var _=H(e);t=T(_,"INPUT",{type:!0,class:!0,id:!0}),n=D(_),l=T(_,"LABEL",{class:!0,for:!0,title:!0});var h=H(l);i&&i.l(h),h.forEach(v),a=D(_),r=T(_,"SPAN",{style:!0});var C=H(r);m&&m.l(C),C.forEach(v),_.forEach(v),this.h()},h(){L(t,"type","checkbox"),L(t,"class","govuk-checkboxes__input"),L(t,"id",o[3]),L(l,"class","govuk-label govuk-checkboxes__label"),L(l,"for",o[3]),L(l,"title",o[1]),Z(r,"float","right"),L(e,"class","govuk-checkboxes__item"),L(e,"style",o[2])},m(d,_){S(d,e,_),I(e,t),t.checked=o[0],I(e,n),I(e,l),i&&i.m(l,null),I(e,a),I(e,r),m&&m.m(r,null),u=!0,f||(g=[B(t,"change",o[7]),B(t,"change",o[6])],f=!0)},p(d,[_]){_&1&&(t.checked=d[0]),i&&i.p&&(!u||_&16)&&$(i,s,d,d[4],u?te(s,d[4],_,null):ee(d[4]),null),(!u||_&2)&&L(l,"title",d[1]),m&&m.p&&(!u||_&16)&&$(m,c,d,d[4],u?te(c,d[4],_,ht):ee(d[4]),Ne)},i(d){u||(y(i,d),y(m,d),u=!0)},o(d){w(i,d),w(m,d),u=!1},d(d){d&&v(e),i&&i.d(d),m&&m.d(d),f=!1,ye(g)}}}function kt(o,e,t){let{$$slots:n={},$$scope:l}=e;const a=Qe(n);let{checked:r}=e,{hint:u=null}=e,g=a.right!==void 0?"float: none":"",s=je();function i(m){q.call(this,o,m)}function c(){r=this.checked,t(0,r)}return o.$$set=m=>{"checked"in m&&t(0,r=m.checked),"hint"in m&&t(1,u=m.hint),"$$scope"in m&&t(4,l=m.$$scope)},[r,u,g,s,l,n,i,c]}class vt extends F{constructor(e){super(),Y(this,e,kt,bt,K,{checked:0,hint:1})}}function De(o,e,t){const n=o.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function Pe(o){let e,t,n,l,a=!1,r,u,f=o[11]+"",g,s,i,c,m,d;return c=xe(o[9][0]),{c(){e=E("div"),t=E("input"),r=N(),u=E("label"),g=O(f),i=N(),this.h()},l(_){e=T(_,"DIV",{class:!0});var h=H(e);t=T(h,"INPUT",{class:!0,id:!0,type:!0}),r=D(h),u=T(h,"LABEL",{class:!0,for:!0});var C=H(u);g=W(C,f),C.forEach(v),i=D(h),h.forEach(v),this.h()},h(){L(t,"class","govuk-radios__input"),L(t,"id",n=o[5]+o[10]),L(t,"type","radio"),t.__value=l=o[10],ve(t,t.__value),L(u,"class","govuk-label govuk-radios__label"),L(u,"for",s=o[5]+o[10]),L(e,"class","govuk-radios__item"),c.p(t)},m(_,h){S(_,e,h),I(e,t),t.checked=t.__value===o[0],I(e,r),I(e,u),I(u,g),I(e,i),m||(d=[B(t,"change",o[8]),B(t,"change",o[7])],m=!0)},p(_,h){h&4&&n!==(n=_[5]+_[10])&&L(t,"id",n),h&4&&l!==(l=_[10])&&(t.__value=l,ve(t,t.__value),a=!0),(a||h&5)&&(t.checked=t.__value===_[0]),h&4&&f!==(f=_[11]+"")&&Ee(g,f),h&4&&s!==(s=_[5]+_[10])&&L(u,"for",s)},d(_){_&&v(e),c.r(),m=!1,ye(d)}}}function yt(o){let e,t,n,l,a,r,u,f,g;r=new mt({props:{errorMessage:o[4]}});let s=Be(o[2]),i=[];for(let c=0;c<s.length;c+=1)i[c]=Pe(De(o,s,c));return{c(){e=E("div"),t=E("fieldset"),n=E("legend"),l=O(o[1]),a=N(),P(r.$$.fragment),u=N(),f=E("div");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=T(c,"DIV",{class:!0});var m=H(e);t=T(m,"FIELDSET",{class:!0});var d=H(t);n=T(d,"LEGEND",{class:!0});var _=H(n);l=W(_,o[1]),_.forEach(v),a=D(d),M(r.$$.fragment,d),u=D(d),f=T(d,"DIV",{class:!0,"data-module":!0});var h=H(f);for(let C=0;C<i.length;C+=1)i[C].l(h);h.forEach(v),d.forEach(v),m.forEach(v),this.h()},h(){L(n,"class","govuk-fieldset__legend govuk-label--s"),L(f,"class","govuk-radios"),L(f,"data-module","govuk-radios"),he(f,"govuk-radios--inline",o[3]),he(f,"govuk-radios--small",o[3]),L(t,"class","govuk-fieldset"),L(e,"class","govuk-form-group")},m(c,m){S(c,e,m),I(e,t),I(t,n),I(n,l),I(t,a),A(r,t,null),I(t,u),I(t,f);for(let d=0;d<i.length;d+=1)i[d]&&i[d].m(f,null);g=!0},p(c,[m]){(!g||m&2)&&Ee(l,c[1]);const d={};if(m&16&&(d.errorMessage=c[4]),r.$set(d),m&37){s=Be(c[2]);let _;for(_=0;_<s.length;_+=1){const h=De(c,s,_);i[_]?i[_].p(h,m):(i[_]=Pe(h),i[_].c(),i[_].m(f,null))}for(;_<i.length;_+=1)i[_].d(1);i.length=s.length}(!g||m&8)&&he(f,"govuk-radios--inline",c[3]),(!g||m&8)&&he(f,"govuk-radios--small",c[3])},i(c){g||(y(r.$$.fragment,c),g=!0)},o(c){w(r.$$.fragment,c),g=!1},d(c){c&&v(e),R(r),Xe(i,c)}}}function pt(o,e,t){let n,{legend:l}=e,{choices:a}=e,{inlineSmall:r=!1}=e,{required:u=!1}=e,{value:f}=e,g=je();const s=[[]];function i(m){q.call(this,o,m)}function c(){f=this.__value,t(0,f)}return o.$$set=m=>{"legend"in m&&t(1,l=m.legend),"choices"in m&&t(2,a=m.choices),"inlineSmall"in m&&t(3,r=m.inlineSmall),"required"in m&&t(6,u=m.required),"value"in m&&t(0,f=m.value)},o.$$.update=()=>{o.$$.dirty&65&&t(4,n=u&&f==""?"Required":"")},[f,l,a,r,n,g,u,i,c,s]}class Lt extends F{constructor(e){super(),Y(this,e,pt,yt,K,{legend:1,choices:2,inlineSmall:3,required:6,value:0})}}function wt(o){let e,t="You can manually use high-quality Bluesky imagery if you have a valid key.";return{c(){e=E("p"),e.textContent=t},l(n){e=T(n,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-1e80rhw"&&(e.textContent=t)},m(n,l){S(n,e,l)},d(n){n&&v(e)}}}function St(o){let e,t="The map should be showing Bluesky imagery.";return{c(){e=E("p"),e.textContent=t},l(n){e=T(n,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-13v9ac9"&&(e.textContent=t)},m(n,l){S(n,e,l)},d(n){n&&v(e)}}}function It(o){let e;return{c(){e=O("Set Bluesky API key")},l(t){e=W(t,"Set Bluesky API key")},m(t,n){S(t,e,n)},d(t){t&&v(e)}}}function Ct(o){let e,t,n=`<i>Note this feature is temporary -- in the future, you will login and
      automatically have access to this imagery.</i>`,l,a,r;function u(s,i){return Tt()?St:wt}let g=u()(o);return a=new Oe({props:{$$slots:{default:[It]},$$scope:{ctx:o}}}),a.$on("click",zt),{c(){g.c(),e=N(),t=E("p"),t.innerHTML=n,l=N(),P(a.$$.fragment)},l(s){g.l(s),e=D(s),t=T(s,"P",{"data-svelte-h":!0}),ce(t)!=="svelte-jc29jc"&&(t.innerHTML=n),l=D(s),M(a.$$.fragment,s)},m(s,i){g.m(s,i),S(s,e,i),S(s,t,i),S(s,l,i),A(a,s,i),r=!0},p(s,i){const c={};i&1&&(c.$$scope={dirty:i,ctx:s}),a.$set(c)},i(s){r||(y(a.$$.fragment,s),r=!0)},o(s){w(a.$$.fragment,s),r=!1},d(s){s&&(v(e),v(t),v(l)),g.d(s),R(a,s)}}}function Et(o){let e,t;return e=new nt({props:{label:"Bluesky imagery",$$slots:{default:[Ct]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,l){A(e,n,l),t=!0},p(n,[l]){const a={};l&1&&(a.$$scope={dirty:l,ctx:n}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}let Ce="bluesky-api-key";function Tt(){let o=window.localStorage.getItem(Ce);return o!=null&&o.length>0}function zt(){let o=window.prompt("Enter the API key provided to you",window.localStorage.getItem(Ce)||"");window.localStorage.setItem(Ce,o||""),window.location.reload()}class Ln extends F{constructor(e){super(),Y(this,e,null,Et,K,{})}}function Bt(o){let e;const t=o[16].default,n=x(t,o,o[24],null);return{c(){n&&n.c()},l(l){n&&n.l(l)},m(l,a){n&&n.m(l,a),e=!0},p(l,a){n&&n.p&&(!e||a&16777216)&&$(n,t,l,l[24],e?te(t,l[24],a,null):ee(l[24]),null)},i(l){e||(y(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function Nt(o){let e,t,n;function l(r){o[17](r)}let a={id:o[1],type:"circle",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],applyToClusters:o[9],minzoom:o[10],maxzoom:o[11],hoverCursor:o[12],manageHoverState:o[13],eventsIfTopMost:o[14],interactive:o[15],$$slots:{default:[Bt]},$$scope:{ctx:o}};return o[0]!==void 0&&(a.hovered=o[0]),e=new We({props:a}),ne.push(()=>de(e,"hovered",l)),e.$on("click",o[18]),e.$on("dblclick",o[19]),e.$on("contextmenu",o[20]),e.$on("mouseenter",o[21]),e.$on("mousemove",o[22]),e.$on("mouseleave",o[23]),{c(){P(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,u){A(e,r,u),n=!0},p(r,[u]){const f={};u&2&&(f.id=r[1]),u&4&&(f.source=r[2]),u&8&&(f.sourceLayer=r[3]),u&16&&(f.beforeId=r[4]),u&32&&(f.beforeLayerType=r[5]),u&64&&(f.paint=r[6]),u&128&&(f.layout=r[7]),u&256&&(f.filter=r[8]),u&512&&(f.applyToClusters=r[9]),u&1024&&(f.minzoom=r[10]),u&2048&&(f.maxzoom=r[11]),u&4096&&(f.hoverCursor=r[12]),u&8192&&(f.manageHoverState=r[13]),u&16384&&(f.eventsIfTopMost=r[14]),u&32768&&(f.interactive=r[15]),u&16777216&&(f.$$scope={dirty:u,ctx:r}),!t&&u&1&&(t=!0,f.hovered=r[0],me(()=>t=!1)),e.$set(f)},i(r){n||(y(e.$$.fragment,r),n=!0)},o(r){w(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Dt(o,e,t){let{$$slots:n={},$$scope:l}=e,{id:a=Te("circle")}=e,{source:r=void 0}=e,{sourceLayer:u=void 0}=e,{beforeId:f=void 0}=e,{beforeLayerType:g=void 0}=e,{paint:s}=e,{layout:i=void 0}=e,{filter:c=void 0}=e,{applyToClusters:m=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:h=void 0}=e,{manageHoverState:C=!1}=e,{hovered:G=null}=e,{eventsIfTopMost:p=!1}=e,{interactive:ae=!0}=e;function ie(b){G=b,t(0,G)}function re(b){q.call(this,o,b)}function Le(b){q.call(this,o,b)}function _e(b){q.call(this,o,b)}function we(b){q.call(this,o,b)}function U(b){q.call(this,o,b)}function Se(b){q.call(this,o,b)}return o.$$set=b=>{"id"in b&&t(1,a=b.id),"source"in b&&t(2,r=b.source),"sourceLayer"in b&&t(3,u=b.sourceLayer),"beforeId"in b&&t(4,f=b.beforeId),"beforeLayerType"in b&&t(5,g=b.beforeLayerType),"paint"in b&&t(6,s=b.paint),"layout"in b&&t(7,i=b.layout),"filter"in b&&t(8,c=b.filter),"applyToClusters"in b&&t(9,m=b.applyToClusters),"minzoom"in b&&t(10,d=b.minzoom),"maxzoom"in b&&t(11,_=b.maxzoom),"hoverCursor"in b&&t(12,h=b.hoverCursor),"manageHoverState"in b&&t(13,C=b.manageHoverState),"hovered"in b&&t(0,G=b.hovered),"eventsIfTopMost"in b&&t(14,p=b.eventsIfTopMost),"interactive"in b&&t(15,ae=b.interactive),"$$scope"in b&&t(24,l=b.$$scope)},[G,a,r,u,f,g,s,i,c,m,d,_,h,C,p,ae,n,ie,re,Le,_e,we,U,Se,l]}class wn extends F{constructor(e){super(),Y(this,e,Dt,Nt,K,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function Me(o){let e=o[0],t,n,l=Ae(o);return{c(){l.c(),t=j()},l(a){l.l(a),t=j()},m(a,r){l.m(a,r),S(a,t,r),n=!0},p(a,r){r&1&&K(e,e=a[0])?(le(),w(l,1,1,pe),oe(),l=Ae(a),l.c(),y(l,1),l.m(t.parentNode,t)):l.p(a,r)},i(a){n||(y(l),n=!0)},o(a){w(l),n=!1},d(a){a&&v(t),l.d(a)}}}function Ae(o){let e;const t=o[10].default,n=x(t,o,o[9],null);return{c(){n&&n.c()},l(l){n&&n.l(l)},m(l,a){n&&n.m(l,a),e=!0},p(l,a){n&&n.p&&(!e||a&512)&&$(n,t,l,l[9],e?te(t,l[9],a,null):ee(l[9]),null)},i(l){e||(y(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function Pt(o){let e,t,n=o[0]&&Me(o);return{c(){n&&n.c(),e=j()},l(l){n&&n.l(l),e=j()},m(l,a){n&&n.m(l,a),S(l,e,a),t=!0},p(l,[a]){l[0]?n?(n.p(l,a),a&1&&y(n,1)):(n=Me(l),n.c(),y(n,1),n.m(e.parentNode,e)):n&&(le(),w(n,1,1,()=>{n=null}),oe())},i(l){t||(y(n),t=!0)},o(l){w(n),t=!1},d(l){l&&v(e),n&&n.d(l)}}}function Mt(o,e,t){let n,l,{$$slots:a={},$$scope:r}=e,{id:u=Te("image")}=e,{url:f}=e,{coordinates:g}=e;const{map:s,self:i}=ot();V(o,s,d=>t(8,l=d)),V(o,i,d=>t(0,n=d));let c,m=!0;return Ke(()=>{n&&l&&(at(s,n,c),z(i,n=null,n),t(6,c=void 0))}),o.$$set=d=>{"id"in d&&t(3,u=d.id),"url"in d&&t(4,f=d.url),"coordinates"in d&&t(5,g=d.coordinates),"$$scope"in d&&t(9,r=d.$$scope)},o.$$.update=()=>{o.$$.dirty&313&&l&&n!==u&&(z(i,n=u,n),it(l,n,rt({type:"image",url:f,coordinates:g}),d=>l&&d===n,()=>{n&&(t(6,c=l==null?void 0:l.getSource(n)),t(7,m=!0))})),o.$$.dirty&264&&(l==null||l.on("style.load",()=>{t(6,c=l==null?void 0:l.getSource(u))})),o.$$.dirty&224&&c&&(m?t(7,m=!1):c.setCoordinates(g))},[n,s,i,u,f,g,c,m,l,r,a]}class At extends F{constructor(e){super(),Y(this,e,Mt,Pt,K,{id:3,url:4,coordinates:5})}}const Rt=o=>({marker:o&8}),Re=o=>({marker:o[3]});function Vt(o){let e,t,n,l,a,r,u;const f=o[19].default,g=x(f,o,o[18],Re);return{c(){e=E("div"),g&&g.c(),this.h()},l(s){e=T(s,"DIV",{tabindex:!0,role:!0});var i=H(e);g&&g.l(i),i.forEach(v),this.h()},h(){L(e,"tabindex",t=o[1]?0:void 0),L(e,"role",n=o[1]?"button":void 0),Z(e,"z-index",o[2])},m(s,i){S(s,e,i),g&&g.m(e,null),a=!0,r||(u=[ze(o[7].call(null,e)),ze(l=Ht.call(null,e,o[0])),B(e,"click",Ie(o[20])),B(e,"dblclick",Ie(o[21])),B(e,"contextmenu",Ie(o[22])),B(e,"mouseenter",o[23]),B(e,"mouseleave",o[24]),B(e,"mousemove",o[25]),B(e,"keydown",o[8])],r=!0)},p(s,[i]){g&&g.p&&(!a||i&262152)&&$(g,f,s,s[18],a?te(f,s[18],i,Rt):ee(s[18]),Re),(!a||i&2&&t!==(t=s[1]?0:void 0))&&L(e,"tabindex",t),(!a||i&2&&n!==(n=s[1]?"button":void 0))&&L(e,"role",n),l&&$e(l.update)&&i&1&&l.update.call(null,s[0]),i&4&&Z(e,"z-index",s[2])},i(s){a||(y(g,s),a=!0)},o(s){w(g,s),a=!1},d(s){s&&v(e),g&&g.d(s),r=!1,ye(u)}}}function Ht(o,e){const t=o.className;function n(l){l?o.className=`${t} ${l}`:o.className=t}return n(e),{update:n}}function qt(o,e,t){let n,l,a,{$$slots:r={},$$scope:u}=e,{marker:f=void 0}=e,{lngLat:g}=e,{class:s=void 0}=e,{interactive:i=!0}=e,{asButton:c=!1}=e,{draggable:m=!1}=e,{feature:d=null}=e,{offset:_=void 0}=e,{zIndex:h=void 0}=e,{rotation:C=0}=e,{opacity:G=1}=e;const p=et(),{map:ae,layerEvent:ie,self:re}=st();V(o,ae,k=>t(27,a=k)),V(o,ie,k=>t(26,n=k)),V(o,re,k=>t(3,l=k));function Le(k){z(re,l=new ut.Marker({element:k,rotation:C,draggable:m,offset:_,opacity:G.toString()}).setLngLat(g).addTo(a),l),t(11,f=l);const J=()=>U("dragstart"),se=()=>{_e(),U("drag")},ue=()=>{_e(),U("dragend")};return m&&(l.on("dragstart",J),l.on("drag",se),l.on("dragend",ue)),{destroy(){m&&(l==null||l.off("dragstart",J),l==null||l.off("drag",se),l==null||l.off("dragend",ue)),t(11,f=void 0),l==null||l.remove()}}}function _e(){let k=l==null?void 0:l.getLngLat();k&&(Array.isArray(g)?t(10,g=[k.lng,k.lat]):g&&"lon"in g?t(10,g={lon:k.lng,lat:k.lat}):t(10,g=k))}function we(k){k.key===" "&&(k.preventDefault(),k.stopPropagation(),U("click"))}function U(k){if(!i)return;let J=l==null?void 0:l.getLngLat();if(!J)return;const se=[J.lng,J.lat];let ue={map:a,marker:l,lngLat:se,features:[{type:"Feature",properties:(d==null?void 0:d.properties)??{},geometry:{type:"Point",coordinates:se}}]};z(ie,n={...ue,layerType:"marker",type:k},n),p(k,ue)}const Se=()=>U("click"),b=()=>U("dblclick"),Fe=()=>U("contextmenu"),Ye=k=>{U("mouseenter")},Ze=()=>{U("mouseleave")},Je=()=>U("mousemove");return o.$$set=k=>{"marker"in k&&t(11,f=k.marker),"lngLat"in k&&t(10,g=k.lngLat),"class"in k&&t(0,s=k.class),"interactive"in k&&t(12,i=k.interactive),"asButton"in k&&t(1,c=k.asButton),"draggable"in k&&t(13,m=k.draggable),"feature"in k&&t(14,d=k.feature),"offset"in k&&t(15,_=k.offset),"zIndex"in k&&t(2,h=k.zIndex),"rotation"in k&&t(16,C=k.rotation),"opacity"in k&&t(17,G=k.opacity),"$$scope"in k&&t(18,u=k.$$scope)},o.$$.update=()=>{o.$$.dirty&1032&&(l==null||l.setLngLat(g)),o.$$.dirty&32776&&(l==null||l.setOffset(_??[0,0])),o.$$.dirty&65544&&(l==null||l.setRotation(C)),o.$$.dirty&131080&&(l==null||l.setOpacity(G.toString()))},[s,c,h,l,ae,ie,re,Le,we,U,g,f,i,m,d,_,C,G,u,r,Se,b,Fe,Ye,Ze,Je]}class Ve extends F{constructor(e){super(),Y(this,e,qt,Vt,K,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}function Gt(o){let e;const t=o[8].default,n=x(t,o,o[15],null);return{c(){n&&n.c()},l(l){n&&n.l(l)},m(l,a){n&&n.m(l,a),e=!0},p(l,a){n&&n.p&&(!e||a&32768)&&$(n,t,l,l[15],e?te(t,l[15],a,null):ee(l[15]),null)},i(l){e||(y(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function Ut(o){let e,t;return e=new We({props:{id:o[0],type:"raster",source:o[1],beforeId:o[2],beforeLayerType:o[3],paint:o[4],layout:o[5],minzoom:o[6],maxzoom:o[7],$$slots:{default:[Gt]},$$scope:{ctx:o}}}),e.$on("click",o[9]),e.$on("dblclick",o[10]),e.$on("contextmenu",o[11]),e.$on("mouseenter",o[12]),e.$on("mousemove",o[13]),e.$on("mouseleave",o[14]),{c(){P(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,l){A(e,n,l),t=!0},p(n,[l]){const a={};l&1&&(a.id=n[0]),l&2&&(a.source=n[1]),l&4&&(a.beforeId=n[2]),l&8&&(a.beforeLayerType=n[3]),l&16&&(a.paint=n[4]),l&32&&(a.layout=n[5]),l&64&&(a.minzoom=n[6]),l&128&&(a.maxzoom=n[7]),l&32768&&(a.$$scope={dirty:l,ctx:n}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Kt(o,e,t){let{$$slots:n={},$$scope:l}=e,{id:a=Te("raster-layer")}=e,{source:r=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:g}=e,{layout:s=void 0}=e,{minzoom:i=void 0}=e,{maxzoom:c=void 0}=e;function m(p){q.call(this,o,p)}function d(p){q.call(this,o,p)}function _(p){q.call(this,o,p)}function h(p){q.call(this,o,p)}function C(p){q.call(this,o,p)}function G(p){q.call(this,o,p)}return o.$$set=p=>{"id"in p&&t(0,a=p.id),"source"in p&&t(1,r=p.source),"beforeId"in p&&t(2,u=p.beforeId),"beforeLayerType"in p&&t(3,f=p.beforeLayerType),"paint"in p&&t(4,g=p.paint),"layout"in p&&t(5,s=p.layout),"minzoom"in p&&t(6,i=p.minzoom),"maxzoom"in p&&t(7,c=p.maxzoom),"$$scope"in p&&t(15,l=p.$$scope)},[a,r,u,f,g,s,i,c,n,m,d,_,h,C,G,l]}class Ot extends F{constructor(e){super(),Y(this,e,Kt,Ut,K,{id:0,source:1,beforeId:2,beforeLayerType:3,paint:4,layout:5,minzoom:6,maxzoom:7})}}const{window:Wt}=ft;function jt(o){let e;return{c(){e=O("StreetView")},l(t){e=W(t,"StreetView")},m(t,n){S(t,e,n)},d(t){t&&v(e)}}}function He(o){let e,t,n;function l(r){o[5](r)}let a={legend:"Source",choices:[["google","Google StreetView"],["bing","Bing Streetside"]],inlineSmall:!0};return o[1]!==void 0&&(a.value=o[1]),e=new Lt({props:a}),ne.push(()=>de(e,"value",l)),{c(){P(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,u){A(e,r,u),n=!0},p(r,u){const f={};!t&&u&2&&(t=!0,f.value=r[1],me(()=>t=!1)),e.$set(f)},i(r){n||(y(e.$$.fragment,r),n=!0)},o(r){w(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Ft(o){let e,t,n,l,a,r,u;function f(i){o[4](i)}let g={$$slots:{default:[jt]},$$scope:{ctx:o}};o[0]!==void 0&&(g.checked=o[0]),e=new vt({props:g}),ne.push(()=>de(e,"checked",f));let s=o[0]&&He(o);return{c(){P(e.$$.fragment),n=N(),s&&s.c(),l=j()},l(i){M(e.$$.fragment,i),n=D(i),s&&s.l(i),l=j()},m(i,c){A(e,i,c),S(i,n,c),s&&s.m(i,c),S(i,l,c),a=!0,r||(u=B(Wt,"keydown",o[2]),r=!0)},p(i,[c]){const m={};c&512&&(m.$$scope={dirty:c,ctx:i}),!t&&c&1&&(t=!0,m.checked=i[0],me(()=>t=!1)),e.$set(m),i[0]?s?(s.p(i,c),c&1&&y(s,1)):(s=He(i),s.c(),y(s,1),s.m(l.parentNode,l)):s&&(le(),w(s,1,1,()=>{s=null}),oe())},i(i){a||(y(e.$$.fragment,i),y(s),a=!0)},o(i){w(e.$$.fragment,i),w(s),a=!1},d(i){i&&(v(n),v(l)),R(e,i),s&&s.d(i),r=!1,u()}}}function Yt(o,e,t){let{map:n}=e,{enabled:l=!1}=e,a="google";function r(){n.on("click",f),n.getCanvas().style.cursor="zoom-in"}function u(){n.off("click",f),n.getCanvas().style.cursor="auto"}Ke(u);function f(c){window.open(a=="google"?Zt(c.lngLat.toArray()):Jt(c.lngLat.toArray()),"_blank"),t(0,l=!1)}function g(c){l&&c.key=="Escape"&&t(0,l=!1)}function s(c){l=c,t(0,l)}function i(c){a=c,t(1,a)}return o.$$set=c=>{"map"in c&&t(3,n=c.map),"enabled"in c&&t(0,l=c.enabled)},o.$$.update=()=>{o.$$.dirty&1&&(l?r():u())},[l,a,g,n,s,i]}class Sn extends F{constructor(e){super(),Y(this,e,Yt,Ft,K,{map:3,enabled:0})}}function In(o){return ct(o)}function Zt(o){return`http://maps.google.com/maps?q=&layer=c&cbll=${o[1]},${o[0]}&cbp=11,0,0,0,0`}function Jt(o){return`https://www.bing.com/maps?cp=${o[1]}~${o[0]}&style=x`}const fe=ge(!1),be=ge(null),ke=ge(100),Q=ge({lng:0,lat:0}),X=ge({lng:0,lat:0});function Qt(o){let e,t;return e=new Oe({props:{$$slots:{default:[xt]},$$scope:{ctx:o}}}),e.$on("click",o[10]),{c(){P(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,l){A(e,n,l),t=!0},p(n,l){const a={};l&8192&&(a.$$scope={dirty:l,ctx:n}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Xt(o){let e,t,n="Georeference an image",l,a,r,u,f,g,s,i=`Note this image isn't saved as part of this scheme. When you close this
      page, it'll be lost.`,c;a=new dt({props:{$$slots:{default:[tn]},$$scope:{ctx:o}}}),u=new _t({props:{label:"Load an image",id:"load-image",$$slots:{default:[nn]},$$scope:{ctx:o}}});let m=o[3]&&qe(o);return{c(){e=E("div"),t=E("h2"),t.textContent=n,l=N(),P(a.$$.fragment),r=N(),P(u.$$.fragment),f=N(),m&&m.c(),g=N(),s=E("p"),s.textContent=i,this.h()},l(d){e=T(d,"DIV",{style:!0});var _=H(e);t=T(_,"H2",{"data-svelte-h":!0}),ce(t)!=="svelte-fociiu"&&(t.textContent=n),l=D(_),M(a.$$.fragment,_),r=D(_),M(u.$$.fragment,_),f=D(_),m&&m.l(_),g=D(_),s=T(_,"P",{"data-svelte-h":!0}),ce(s)!=="svelte-d8uklv"&&(s.textContent=i),_.forEach(v),this.h()},h(){Z(e,"border","1px solid black"),Z(e,"padding","4px")},m(d,_){S(d,e,_),I(e,t),I(e,l),A(a,e,null),I(e,r),A(u,e,null),I(e,f),m&&m.m(e,null),I(e,g),I(e,s),c=!0},p(d,_){const h={};_&8202&&(h.$$scope={dirty:_,ctx:d}),a.$set(h);const C={};_&8193&&(C.$$scope={dirty:_,ctx:d}),u.$set(C),d[3]?m?m.p(d,_):(m=qe(d),m.c(),m.m(e,g)):m&&(m.d(1),m=null)},i(d){c||(y(a.$$.fragment,d),y(u.$$.fragment,d),c=!0)},o(d){w(a.$$.fragment,d),w(u.$$.fragment,d),c=!1},d(d){d&&v(e),R(a),R(u),m&&m.d()}}}function xt(o){let e;return{c(){e=O("Georeference an image")},l(t){e=W(t,"Georeference an image")},m(t,n){S(t,e,n)},d(t){t&&v(e)}}}function $t(o){let e;return{c(){e=O("Save")},l(t){e=W(t,"Save")},m(t,n){S(t,e,n)},d(t){t&&v(e)}}}function en(o){let e;return{c(){e=O("Delete")},l(t){e=W(t,"Delete")},m(t,n){S(t,e,n)},d(t){t&&v(e)}}}function tn(o){let e,t,n,l;return e=new gt({props:{$$slots:{default:[$t]},$$scope:{ctx:o}}}),e.$on("click",o[7]),n=new lt({props:{disabled:!o[3],$$slots:{default:[en]},$$scope:{ctx:o}}}),n.$on("click",o[5]),{c(){P(e.$$.fragment),t=N(),P(n.$$.fragment)},l(a){M(e.$$.fragment,a),t=D(a),M(n.$$.fragment,a)},m(a,r){A(e,a,r),S(a,t,r),A(n,a,r),l=!0},p(a,r){const u={};r&8192&&(u.$$scope={dirty:r,ctx:a}),e.$set(u);const f={};r&8&&(f.disabled=!a[3]),r&8192&&(f.$$scope={dirty:r,ctx:a}),n.$set(f)},i(a){l||(y(e.$$.fragment,a),y(n.$$.fragment,a),l=!0)},o(a){w(e.$$.fragment,a),w(n.$$.fragment,a),l=!1},d(a){a&&v(t),R(e,a),R(n,a)}}}function nn(o){let e,t,n;return{c(){e=E("input"),this.h()},l(l){e=T(l,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){L(e,"class","govuk-file-upload"),L(e,"id","load-image"),L(e,"type","file")},m(l,a){S(l,e,a),o[8](e),t||(n=B(e,"change",o[4]),t=!0)},p:pe,d(l){l&&v(e),o[8](null),t=!1,n()}}}function qe(o){let e,t,n,l,a,r,u,f;return{c(){e=E("div"),t=E("label"),n=E("input"),l=O(`
          Opacity: `),a=O(o[2]),r=O("%"),this.h()},l(g){e=T(g,"DIV",{});var s=H(e);t=T(s,"LABEL",{});var i=H(t);n=T(i,"INPUT",{type:!0,min:!0,max:!0}),l=W(i,`
          Opacity: `),a=W(i,o[2]),r=W(i,"%"),i.forEach(v),s.forEach(v),this.h()},h(){L(n,"type","range"),L(n,"min","0"),L(n,"max","100")},m(g,s){S(g,e,s),I(e,t),I(t,n),ve(n,o[2]),I(t,l),I(t,a),I(t,r),u||(f=[B(n,"change",o[9]),B(n,"input",o[9])],u=!0)},p(g,s){s&4&&ve(n,g[2]),s&4&&Ee(a,g[2])},d(g){g&&v(e),u=!1,ye(f)}}}function ln(o){let e,t,n,l,a,r;const u=[Xt,Qt],f=[];function g(s,i){return s[1]?0:1}return e=g(o),t=f[e]=u[e](o),{c(){t.c(),n=j()},l(s){t.l(s),n=j()},m(s,i){f[e].m(s,i),S(s,n,i),l=!0,a||(r=B(window,"keydown",o[6]),a=!0)},p(s,[i]){let c=e;e=g(s),e===c?f[e].p(s,i):(le(),w(f[c],1,1,()=>{f[c]=null}),oe(),t=f[e],t?t.p(s,i):(t=f[e]=u[e](s),t.c()),y(t,1),t.m(n.parentNode,n))},i(s){l||(y(t),l=!0)},o(s){w(t),l=!1},d(s){s&&v(n),f[e].d(s),a=!1,r()}}}function on(o,e,t){let n,l,a,r,u;V(o,fe,h=>t(1,n=h)),V(o,ke,h=>t(2,l=h)),V(o,be,h=>t(3,a=h)),V(o,X,h=>t(11,r=h)),V(o,Q,h=>t(12,u=h));let f;async function g(h){let C=await f.files[0].arrayBuffer(),G=new Blob([new Uint8Array(C)]);z(be,a=URL.createObjectURL(G),a),z(Q,u={lng:0,lat:0},u),z(X,r={lng:0,lat:0},r)}function s(){z(be,a=null,a),z(ke,l=100,l)}function i(h){n&&h.key=="Escape"&&(h.stopPropagation(),z(fe,n=!1,n))}const c=()=>z(fe,n=!1,n);function m(h){ne[h?"unshift":"push"](()=>{f=h,t(0,f)})}function d(){l=tt(this.value),ke.set(l)}return[f,n,l,a,g,s,i,c,m,d,()=>z(fe,n=!0,n)]}class Cn extends F{constructor(e){super(),Y(this,e,on,ln,K,{})}}function Ge(o){let e,t;return e=new At({props:{url:o[2],coordinates:[[o[0].lng,o[0].lat],[o[3].lng,o[0].lat],[o[3].lng,o[3].lat],[o[0].lng,o[3].lat]],$$slots:{default:[an]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,l){A(e,n,l),t=!0},p(n,l){const a={};l&4&&(a.url=n[2]),l&9&&(a.coordinates=[[n[0].lng,n[0].lat],[n[3].lng,n[0].lat],[n[3].lng,n[3].lat],[n[0].lng,n[3].lat]]),l&272&&(a.$$scope={dirty:l,ctx:n}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function an(o){let e,t;return e=new Ot({props:{paint:{"raster-fade-duration":0,"raster-opacity":o[4]/100}}}),{c(){P(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,l){A(e,n,l),t=!0},p(n,l){const a={};l&16&&(a.paint={"raster-fade-duration":0,"raster-opacity":n[4]/100}),e.$set(a)},i(n){t||(y(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){R(e,n)}}}function Ue(o){let e,t,n,l,a,r;function u(i){o[6](i)}let f={draggable:!0,$$slots:{default:[rn]},$$scope:{ctx:o}};o[0]!==void 0&&(f.lngLat=o[0]),e=new Ve({props:f}),ne.push(()=>de(e,"lngLat",u));function g(i){o[7](i)}let s={draggable:!0,$$slots:{default:[sn]},$$scope:{ctx:o}};return o[3]!==void 0&&(s.lngLat=o[3]),l=new Ve({props:s}),ne.push(()=>de(l,"lngLat",g)),{c(){P(e.$$.fragment),n=N(),P(l.$$.fragment)},l(i){M(e.$$.fragment,i),n=D(i),M(l.$$.fragment,i)},m(i,c){A(e,i,c),S(i,n,c),A(l,i,c),r=!0},p(i,c){const m={};c&256&&(m.$$scope={dirty:c,ctx:i}),!t&&c&1&&(t=!0,m.lngLat=i[0],me(()=>t=!1)),e.$set(m);const d={};c&256&&(d.$$scope={dirty:c,ctx:i}),!a&&c&8&&(a=!0,d.lngLat=i[3],me(()=>a=!1)),l.$set(d)},i(i){r||(y(e.$$.fragment,i),y(l.$$.fragment,i),r=!0)},o(i){w(e.$$.fragment,i),w(l.$$.fragment,i),r=!1},d(i){i&&v(n),R(e,i),R(l,i)}}}function rn(o){let e;return{c(){e=E("span"),this.h()},l(t){e=T(t,"SPAN",{class:!0,style:!0}),H(e).forEach(v),this.h()},h(){L(e,"class","dot svelte-1tmbx1c"),Z(e,"background-color","red")},m(t,n){S(t,e,n)},p:pe,d(t){t&&v(e)}}}function sn(o){let e;return{c(){e=E("span"),this.h()},l(t){e=T(t,"SPAN",{class:!0,style:!0}),H(e).forEach(v),this.h()},h(){L(e,"class","dot svelte-1tmbx1c"),Z(e,"background-color","blue")},m(t,n){S(t,e,n)},p:pe,d(t){t&&v(e)}}}function un(o){let e,t,n,l=o[2]&&o[0].lng!=o[3].lng&&Ge(o),a=o[2]&&o[1]&&Ue(o);return{c(){l&&l.c(),e=N(),a&&a.c(),t=j()},l(r){l&&l.l(r),e=D(r),a&&a.l(r),t=j()},m(r,u){l&&l.m(r,u),S(r,e,u),a&&a.m(r,u),S(r,t,u),n=!0},p(r,[u]){r[2]&&r[0].lng!=r[3].lng?l?(l.p(r,u),u&13&&y(l,1)):(l=Ge(r),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(le(),w(l,1,1,()=>{l=null}),oe()),r[2]&&r[1]?a?(a.p(r,u),u&6&&y(a,1)):(a=Ue(r),a.c(),y(a,1),a.m(t.parentNode,t)):a&&(le(),w(a,1,1,()=>{a=null}),oe())},i(r){n||(y(l),y(a),n=!0)},o(r){w(l),w(a),n=!1},d(r){r&&(v(e),v(t)),l&&l.d(r),a&&a.d(r)}}}function fn(o,e,t){let n,l,a,r,u;V(o,X,i=>t(3,n=i)),V(o,Q,i=>t(0,l=i)),V(o,fe,i=>t(1,a=i)),V(o,be,i=>t(2,r=i)),V(o,ke,i=>t(4,u=i));let{map:f}=e;function g(i){l=i,Q.set(l)}function s(i){n=i,X.set(n)}return o.$$set=i=>{"map"in i&&t(5,f=i.map)},o.$$.update=()=>{if(o.$$.dirty&39&&r&&a&&l.lng==0&&l.lat==0){let i=f.getBounds();z(Q,l.lng=i.getWest()+.4*(i.getEast()-i.getWest()),l),z(X,n.lng=i.getWest()+.6*(i.getEast()-i.getWest()),n),z(Q,l.lat=i.getNorth()+.4*(i.getSouth()-i.getNorth()),l),z(X,n.lat=i.getNorth()+.6*(i.getSouth()-i.getNorth()),n)}},[l,a,r,n,u,f,g,s]}class En extends F{constructor(e){super(),Y(this,e,fn,un,K,{map:5})}}export{Ln as B,wn as C,Cn as G,Ve as M,Lt as R,Sn as S,In as a,Jt as b,En as c,Zt as s};
