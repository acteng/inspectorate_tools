import{s as H,e as I,t as R,a as D,c as x,b as N,d as A,f as m,g as C,o as P,i as b,h as y,z as fe,Y as de,j as K,n as O,B as M,r as pe,a6 as $e,v as _e,m as te,a7 as ne,S as J}from"./scheduler.C3Uoshia.js";import{S as W,i as q,t as k,g as ce,f as ue,a as F,c as L,b as S,m as E,d as B}from"./index.CU1a5D4G.js";import{e as le}from"./each.DaV1mrNn.js";import"./index.BXXVHisV.js";import{B as ge}from"./ButtonGroup.C4iWdcGt.js";import{F as be}from"./FileInput.BUQNSR7O.js";import{S as Q,W as he}from"./WarningButton.DlFzrIzP.js";import{a as me}from"./index.CLqgcrGq.js";import{F as we}from"./FormElement.igkxZPqA.js";function ve(r){let e,t,n=r[0].name+"",l,o,i,s=r[0].additionalText+"",f,d,c,_;return{c(){e=I("button"),t=I("div"),l=R(n),o=D(),i=I("div"),f=R(s),this.h()},l(g){e=x(g,"BUTTON",{class:!0});var v=N(e);t=x(v,"DIV",{class:!0});var w=N(t);l=A(w,n),w.forEach(m),o=C(v),i=x(v,"DIV",{class:!0});var G=N(i);f=A(G,s),G.forEach(m),v.forEach(m),this.h()},h(){P(t,"class","top-section section svelte-6vhnst"),P(i,"class","section svelte-6vhnst"),P(e,"class","clickable-card govuk-button govuk-button--secondary svelte-6vhnst"),e.disabled=d=r[0].disabled},m(g,v){b(g,e,v),y(e,t),y(t,l),y(e,o),y(e,i),y(i,f),c||(_=fe(e,"click",function(){de(r[0].disabled?se:r[0].onClick)&&(r[0].disabled?se:r[0].onClick).apply(this,arguments)}),c=!0)},p(g,[v]){r=g,v&1&&n!==(n=r[0].name+"")&&K(l,n),v&1&&s!==(s=r[0].additionalText+"")&&K(f,s),v&1&&d!==(d=r[0].disabled)&&(e.disabled=d)},i:O,o:O,d(g){g&&m(e),c=!1,_()}}}const se=()=>{};function ke(r,e,t){let{cardDetails:n}=e;return r.$$set=l=>{"cardDetails"in l&&t(0,n=l.cardDetails)},[n]}class ye extends W{constructor(e){super(),q(this,e,ke,ve,H,{cardDetails:0})}}function re(r,e,t){const n=r.slice();return n[1]=e[t],n}function ie(r){let e,t;return e=new ye({props:{cardDetails:r[1]}}),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,l){E(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.cardDetails=n[1]),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){B(e,n)}}}function Fe(r){let e,t,n=le(r[0]),l=[];for(let i=0;i<n.length;i+=1)l[i]=ie(re(r,n,i));const o=i=>F(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=M()},l(i){for(let s=0;s<l.length;s+=1)l[s].l(i);e=M()},m(i,s){for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(i,s);b(i,e,s),t=!0},p(i,[s]){if(s&1){n=le(i[0]);let f;for(f=0;f<n.length;f+=1){const d=re(i,n,f);l[f]?(l[f].p(d,s),k(l[f],1)):(l[f]=ie(d),l[f].c(),k(l[f],1),l[f].m(e.parentNode,e))}for(ce(),f=n.length;f<l.length;f+=1)o(f);ue()}},i(i){if(!t){for(let s=0;s<n.length;s+=1)k(l[s]);t=!0}},o(i){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)F(l[s]);t=!1},d(i){i&&m(e),pe(l,i)}}}function Ie(r,e,t){let{cardDetailsList:n=[]}=e;return r.$$set=l=>{"cardDetailsList"in l&&t(0,n=l.cardDetailsList)},[n]}class xe extends W{constructor(e){super(),q(this,e,Ie,Fe,H,{cardDetailsList:0})}}function ae(r){let e,t,n,l,o,i,s;return{c(){e=I("div"),t=I("div"),n=I("progress"),l=D(),o=I("div"),i=I("h3"),s=R(r[0]),this.h()},l(f){e=x(f,"DIV",{class:!0});var d=N(e);t=x(d,"DIV",{class:!0});var c=N(t);n=x(c,"PROGRESS",{}),N(n).forEach(m),l=C(c),o=x(c,"DIV",{class:!0});var _=N(o);i=x(_,"H3",{});var g=N(i);s=A(g,r[0]),g.forEach(m),_.forEach(m),c.forEach(m),d.forEach(m),this.h()},h(){P(o,"class","govuk-prose"),P(t,"class","inner svelte-ho9d42"),P(e,"class","outer svelte-ho9d42")},m(f,d){b(f,e,d),y(e,t),y(t,n),y(t,l),y(t,o),y(o,i),y(i,s)},p(f,d){d&1&&K(s,f[0])},d(f){f&&m(e)}}}function De(r){let e,t=r[0]&&ae(r);return{c(){t&&t.c(),e=M()},l(n){t&&t.l(n),e=M()},m(n,l){t&&t.m(n,l),b(n,e,l)},p(n,[l]){n[0]?t?t.p(n,l):(t=ae(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:O,o:O,d(n){n&&m(e),t&&t.d(n)}}}function Ce(r,e,t){let{loading:n}=e;return r.$$set=l=>{"loading"in l&&t(0,n=l.loading)},[n]}class Le extends W{constructor(e){super(),q(this,e,Ce,De,H,{loading:0})}}function Se(r){let e,t,n;return{c(){e=I("input"),this.h()},l(l){e=x(l,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){P(e,"class","govuk-file-upload"),P(e,"id","import-xlsx"),P(e,"type","file")},m(l,o){b(l,e,o),r[4](e),t||(n=fe(e,"change",r[2]),t=!0)},p:O,d(l){l&&m(e),r[4](null),t=!1,n()}}}function Ee(r){let e,t,n,l;return e=new we({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[Se]},$$scope:{ctx:r}}}),n=new Le({props:{loading:r[0]}}),{c(){L(e.$$.fragment),t=D(),L(n.$$.fragment)},l(o){S(e.$$.fragment,o),t=C(o),S(n.$$.fragment,o)},m(o,i){E(e,o,i),b(o,t,i),E(n,o,i),l=!0},p(o,[i]){const s={};i&66&&(s.$$scope={dirty:i,ctx:o}),e.$set(s);const f={};i&1&&(f.loading=o[0]),n.$set(f)},i(o){l||(k(e.$$.fragment,o),k(n.$$.fragment,o),l=!0)},o(o){F(e.$$.fragment,o),F(n.$$.fragment,o),l=!1},d(o){o&&m(t),B(e,o),B(n,o)}}}function Be(r,e,t){let n=$e(),{xlsxImporter:l}=e,o="",i;async function s(d){let c=i.files[0].name;try{t(0,o=`Loading ${c}`);let _=await i.files[0].arrayBuffer(),g=await l(_);t(0,o=""),n("imported",{filename:me(c,".xlsx"),data:g})}catch(_){window.alert(`Couldn't import ${c}: ${_}`),t(0,o="")}}function f(d){_e[d?"unshift":"push"](()=>{i=d,t(1,i)})}return r.$$set=d=>{"xlsxImporter"in d&&t(3,l=d.xlsxImporter)},[o,i,s,l,f]}class Ne extends W{constructor(e){super(),q(this,e,Be,Ee,H,{xlsxImporter:3})}}function Re(r){let e;return{c(){e=R("Rename")},l(t){e=A(t,"Rename")},m(t,n){b(t,e,n)},d(t){t&&m(e)}}}function Ae(r){let e;return{c(){e=R("Export")},l(t){e=A(t,"Export")},m(t,n){b(t,e,n)},d(t){t&&m(e)}}}function Ge(r){let e;return{c(){e=R("Delete")},l(t){e=A(t,"Delete")},m(t,n){b(t,e,n)},d(t){t&&m(e)}}}function Te(r){let e,t,n,l,o,i;return e=new Q({props:{$$slots:{default:[Re]},$$scope:{ctx:r}}}),e.$on("click",r[5]),n=new Q({props:{$$slots:{default:[Ae]},$$scope:{ctx:r}}}),n.$on("click",r[6]),o=new he({props:{$$slots:{default:[Ge]},$$scope:{ctx:r}}}),o.$on("click",r[7]),{c(){L(e.$$.fragment),t=D(),L(n.$$.fragment),l=D(),L(o.$$.fragment)},l(s){S(e.$$.fragment,s),t=C(s),S(n.$$.fragment,s),l=C(s),S(o.$$.fragment,s)},m(s,f){E(e,s,f),b(s,t,f),E(n,s,f),b(s,l,f),E(o,s,f),i=!0},p(s,f){const d={};f&32768&&(d.$$scope={dirty:f,ctx:s}),e.$set(d);const c={};f&32768&&(c.$$scope={dirty:f,ctx:s}),n.$set(c);const _={};f&32768&&(_.$$scope={dirty:f,ctx:s}),o.$set(_)},i(s){i||(k(e.$$.fragment,s),k(n.$$.fragment,s),k(o.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),F(n.$$.fragment,s),F(o.$$.fragment,s),i=!1},d(s){s&&(m(t),m(l)),B(e,s),B(n,s),B(o,s)}}}function Ye(r){let e;return{c(){e=R("New file")},l(t){e=A(t,"New file")},m(t,n){b(t,e,n)},d(t){t&&m(e)}}}function oe(r){let e,t;return e=new Ne({props:{xlsxImporter:r[2]}}),e.$on("imported",r[10]),{c(){L(e.$$.fragment)},l(n){S(e.$$.fragment,n)},m(n,l){E(e,n,l),t=!0},p(n,l){const o={};l&4&&(o.xlsxImporter=n[2]),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){B(e,n)}}}function je(r){let e,t=`All files are auto-saved in your browser's local storage. You can close your
  browser and resume later. You can export the file to your computer to share
  with someone else, and import from a file below.`,n,l,o,i,s,f,d,c,_,g,v,w,G,T,U,Y,j,z="Load a saved file:",V,u,h;c=new ge({props:{$$slots:{default:[Te]},$$scope:{ctx:r}}}),w=new Q({props:{$$slots:{default:[Ye]},$$scope:{ctx:r}}}),w.$on("click",r[8]),T=new be({props:{label:"Import from a .json file",onLoad:r[9]}});let $=r[2]!=null&&oe(r);return u=new xe({props:{cardDetailsList:r[4]}}),{c(){e=I("p"),e.textContent=t,n=D(),l=I("p"),o=R("You're currently editing "),i=I("u"),s=R(r[3]),f=R(`
  .`),d=D(),L(c.$$.fragment),_=D(),g=I("hr"),v=D(),L(w.$$.fragment),G=D(),L(T.$$.fragment),U=D(),$&&$.c(),Y=D(),j=I("p"),j.textContent=z,V=D(),L(u.$$.fragment)},l(a){e=x(a,"P",{"data-svelte-h":!0}),te(e)!=="svelte-eph3gl"&&(e.textContent=t),n=C(a),l=x(a,"P",{});var p=N(l);o=A(p,"You're currently editing "),i=x(p,"U",{});var X=N(i);s=A(X,r[3]),X.forEach(m),f=A(p,`
  .`),p.forEach(m),d=C(a),S(c.$$.fragment,a),_=C(a),g=x(a,"HR",{}),v=C(a),S(w.$$.fragment,a),G=C(a),S(T.$$.fragment,a),U=C(a),$&&$.l(a),Y=C(a),j=x(a,"P",{"data-svelte-h":!0}),te(j)!=="svelte-1xydj1w"&&(j.textContent=z),V=C(a),S(u.$$.fragment,a)},m(a,p){b(a,e,p),b(a,n,p),b(a,l,p),y(l,o),y(l,i),y(i,s),y(l,f),b(a,d,p),E(c,a,p),b(a,_,p),b(a,g,p),b(a,v,p),E(w,a,p),b(a,G,p),E(T,a,p),b(a,U,p),$&&$.m(a,p),b(a,Y,p),b(a,j,p),b(a,V,p),E(u,a,p),h=!0},p(a,[p]){(!h||p&8)&&K(s,a[3]);const X={};p&32768&&(X.$$scope={dirty:p,ctx:a}),c.$set(X);const Z={};p&32768&&(Z.$$scope={dirty:p,ctx:a}),w.$set(Z),a[2]!=null?$?($.p(a,p),p&4&&k($,1)):($=oe(a),$.c(),k($,1),$.m(Y.parentNode,Y)):$&&(ce(),F($,1,1,()=>{$=null}),ue());const ee={};p&16&&(ee.cardDetailsList=a[4]),u.$set(ee)},i(a){h||(k(c.$$.fragment,a),k(w.$$.fragment,a),k(T.$$.fragment,a),k($),k(u.$$.fragment,a),h=!0)},o(a){F(c.$$.fragment,a),F(w.$$.fragment,a),F(T.$$.fragment,a),F($),F(u.$$.fragment,a),h=!1},d(a){a&&(m(e),m(n),m(l),m(d),m(_),m(g),m(v),m(G),m(U),m(Y),m(j),m(V)),B(c,a),B(w,a),B(T,a),$&&$.d(a),B(u,a)}}}function Pe(r,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ve(r,e,t){let n,l,o=O,i=()=>(o(),o=ne(g,u=>t(13,l=u)),g),s,f=O,d=()=>(f(),f=ne(_,u=>t(3,s=u)),_);r.$$.on_destroy.push(()=>o()),r.$$.on_destroy.push(()=>f());let{files:c}=e,{currentFile:_}=e;d();let{state:g}=e;i();let{xlsxImporter:v=null}=e,w=c.getFileList();function G(){let u=window.prompt(`Rename file ${s} to what?`,s);if(u){let h=c.key(s),$=window.localStorage.getItem(h);window.localStorage.setItem(c.key(u),$),window.localStorage.removeItem(h),J(_,s=u,s),t(12,w=c.getFileList())}}function T(){Pe(s+".json",JSON.stringify(l))}async function U(){window.confirm(`Really delete file ${s}? You can't undo this.`)&&(window.localStorage.removeItem(c.key(s)),await Y())}async function Y(){J(_,s=c.newFilename(),s),J(g,l=c.emptyState(),l),t(12,w=c.saveAndGetFileList(s,l))}async function j(u,h){let $=me(u,".json");try{let a=JSON.parse(h);c.validate(a),t(12,w=c.saveAndGetFileList($,a)),await V($)}catch(a){window.alert(`Couldn't load ${$}: ${a}`)}}async function z(u){let{filename:h,data:$}=u.detail;t(12,w=c.saveAndGetFileList(h,$)),await V(h)}async function V(u){try{let h=c.loadFile(u);J(_,s=u,s),J(g,l=h,l)}catch(h){window.alert(`Couldn't load ${u}: ${h}`)}}return r.$$set=u=>{"files"in u&&t(11,c=u.files),"currentFile"in u&&d(t(0,_=u.currentFile)),"state"in u&&i(t(1,g=u.state)),"xlsxImporter"in u&&t(2,v=u.xlsxImporter)},r.$$.update=()=>{r.$$.dirty&4104&&t(4,n=w.map(u=>{const h=u===s;return{name:`File name: ${u}`,additionalText:h?"Already selected":"",onClick:()=>{V(u)},disabled:h}}))},[_,g,v,s,n,G,T,U,Y,j,z,c,w]}class Me extends W{constructor(e){super(),q(this,e,Ve,je,H,{files:11,currentFile:0,state:1,xlsxImporter:2})}}export{Me as F};
