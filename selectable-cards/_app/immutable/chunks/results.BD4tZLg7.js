import{s as d}from"./index.hKxn9-cp.js";import{n as y}from"./data.C1dlcRIQ.js";let P={Walking:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Wheeling:[0,1,2,3,4,5,6,9,10,13,14,15,16,17,18,19,20,21,22,24,25,26,27,28],Cycling:[0,1,2,3,4,5,7,9,11,13,14,15,16,17,18,19,22,23,24,25,26,27,28],"Horse Riding":[0,1,3,4,5,8,9,12,13,14,15,16,17,18,19,22,24,25,26,29]},x={Walking:[0,1,2,3,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Wheeling:[0,1,2,3,4,5,6,8,11,14,15,16,17,18,19,21,22,24,25],Cycling:[0,1,2,3,5,6,7,9,10,12,13,16,19,20,21,22,23,24,25]},S={Walking:[0,1,3,5,6,7,8,9,10,14,15],Wheeling:[0,1,3,5,6,7,8,9,10,14,15],Cycling:[0,1,2,4,7,8,11,12,13,15]};function D(e){let t=e.summary.checkType,r=t=="street",l=t=="path",n=s("Safety",t,e.safetyCheck,[0,15]),i=[n];r?(i.push(s("Accessibility",t,e.streetCheck,[0,6])),i.push(s("Comfort",t,e.streetCheck,[7,9])),i.push(s("Directness",t,e.streetCheck,[10,15])),i.push(s("Attractiveness",t,e.streetCheck,[16,21])),i.push(s("Cohesion",t,e.streetCheck,[22,25]))):l&&(i.push(s("Accessibility",t,e.pathCheck,[0,4])),i.push(s("Comfort",t,e.pathCheck,[5,15])),i.push(s("Directness",t,e.pathCheck,[16,19])),i.push(s("Attractiveness",t,e.pathCheck,[20,24])),i.push(s("Cohesion",t,e.pathCheck,[25,29])));let c={category:"overall",existing:f(i.map(p=>p.existing)),proposed:f(i.map(p=>p.proposed))},o=[];r?(o.push(s("Social activity",t,e.streetPlacemakingCheck,[0,2])),o.push(s("Personal security",t,e.streetPlacemakingCheck,[3,5])),o.push(s("Character and legibility",t,e.streetPlacemakingCheck,[6,15])),o.push(s("Environment",t,e.streetPlacemakingCheck,[16,25]))):l&&o.push(s("Social activity",t,e.pathPlacemakingCheck,[0,2]),s("Personal security",t,e.pathPlacemakingCheck,[3,5]),s("Character and legibility",t,e.pathPlacemakingCheck,[6,9]),s("Environment",t,e.pathPlacemakingCheck,[10,18]));let u={category:"overall",existing:f(o.map(p=>p.existing)),proposed:f(o.map(p=>p.proposed))},a=[];r?a=C(e.safetyCheck,e.streetCheck,x,e.summary.checkType):l&&(a=C(e.safetyCheck,e.pathCheck,P,e.summary.checkType));let h=v(e);return{safetyCheck:n,levelOfService:i,overall:c,placemakingCategories:o,placemakingOverall:u,byMode:a,jat:h}}function s(e,t,r,l){return{category:e,existing:g(r.existingScores.slice(l[0],l[1]+1),e,t),proposed:g(r.proposedScores.slice(l[0],l[1]+1),e,t)}}function g(e,t,r){let l=e.filter(u=>u!="N/A").length,n=1;t=="Safety"?n=3:r=="path"&&t=="Personal security"&&(n=2);let i=l*2*n,c=n*d(e.map(y)),o=c/i*100;return{numberMetrics:l,totalPossibleScore:i,score:c,scorePercent:o}}function f(e){let t=d(e.map(i=>i.numberMetrics)),r=d(e.map(i=>i.totalPossibleScore)),l=d(e.map(i=>i.score)),n=l/r*100;return{numberMetrics:t,totalPossibleScore:r,score:l,scorePercent:n}}function b(e,t){return{category:"",existing:f([e.existing,t.existing]),proposed:f([e.proposed,t.proposed])}}function R(e){return`${Math.round(e.proposed.scorePercent-e.existing.scorePercent)}%`}function C(e,t,r,l){let n=[];for(let[i,c]of Object.entries(r)){let o=S[i]||[],u={category:"Safety",existing:g(k(e.existingScores,o),"Safety",l),proposed:g(k(e.proposedScores,o),"Safety",l)},a={category:"",existing:g(k(t.existingScores,c),"",l),proposed:g(k(t.proposedScores,c),"",l)},h=b(u,a);h.category=i,n.push(h)}return n}function k(e,t){return t.map(r=>e[r])}function v(e){let t={0:0,1:1,2:2,X:0},r=[];for(let l of e.jat){let n={name:l.name,walkingWheeling:{existing:null,proposed:null,netDifference:null},cycling:{existing:null,proposed:null,netDifference:null},total:{existing:null,proposed:null,netDifference:null}};for(let i of["existing","proposed"]){let c=0,o=0,u=0,a=0,h=0,p=0;for(let m of l[i].movements)m.kind=="walking & wheeling"?(c+=t[m.score],o+=2):(u+=t[m.score],a+=2),h+=t[m.score],p+=2;n.walkingWheeling[i]=o>0?Math.round(c/o*100):null,n.cycling[i]=a>0?Math.round(u/a*100):null,n.total[i]=p>0?Math.round(h/p*100):null}for(let i of["walkingWheeling","cycling","total"]){let c=n[i].existing,o=n[i].proposed;c!=null&&o!=null&&(n[i].netDifference=o-c)}r.push(n)}return r}export{D as g,R as n};
