import{s as we,w as x,e as K,t as Q,a as T,c as Z,b as Y,d as X,f as d,g as q,p as W,q as H,i as L,h as R,x as ee,k as ye,z as nt,Q as it,W as he,T as pe,E as ge,m as ve,G as me,j as _e,n as ot,K as be,L as ke}from"../chunks/scheduler.BwufR8Ly.js";import{S as Ie,i as Le,e as te,c as G,a as M,m as V,t as b,g as se,b as S,f as re,d as F}from"../chunks/index.BYv68wXE.js";import{s as $e,d as de,M as st,e as rt,b as at,C as ft,G as ut,f as ct}from"../chunks/index.C9Qetb6E.js";import{e as oe}from"../chunks/each.CK1lPdNc.js";import{c as pt,p as _t}from"../chunks/colors.DaC397qr.js";import{p as Ue,b as gt}from"../chunks/index.C17Maz57.js";import{R as Se}from"../chunks/Radio.xwGHvsDf.js";import{S as We}from"../chunks/Select.DQYWgocE.js";/* empty css                                                    */import{T as ze}from"../chunks/TextArea.2C2Xc7bA.js";import{T as He}from"../chunks/TextInput.DQAdVYnU.js";import{s as U}from"../chunks/data.CAey1UeL.js";import{c as mt,p as $t,b as Ee,d as De,e as dt,g as ht}from"../chunks/lists.Dqlqv0er.js";import{Y as Je}from"../chunks/YesNo.CETUL7WE.js";import{B as vt,G as bt,S as kt,C as Ct,a as wt,M as Ke}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.juuTAKMb.js";import{C as yt}from"../chunks/CollapsibleCard.CXcgKIt2.js";import{D as It}from"../chunks/DefaultButton.DUjKpF0Y.js";import{S as Ze}from"../chunks/SecondaryButton.Bcl2fE5V.js";import{W as Lt}from"../chunks/WarningButton.BZEdAdvT.js";import{G as St}from"../chunks/GeoreferenceLayer.Chbuiu08.js";import{C as Ye}from"../chunks/ClickableCard.5rW6i04y.js";function je(t){let e,n,l;function i(s){t[5](s)}let r={label:"Resolved by Design",inlineSmall:!0};return t[1].criticalIssues[t[0]].resolved!==void 0&&(r.value=t[1].criticalIssues[t[0]].resolved),e=new Je({props:r}),x.push(()=>te(e,"value",i)),{c(){G(e.$$.fragment)},l(s){M(e.$$.fragment,s)},m(s,c){V(e,s,c),l=!0},p(s,c){const f={};!n&&c&3&&(n=!0,f.value=s[1].criticalIssues[s[0]].resolved,ee(()=>n=!1)),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){F(e,s)}}}function Nt(t){let e,n,l,i,r,s,c,f,_,u,B,v,w,$,h,D,o,p,I,E,j,y;function J(a){t[2](a)}let A={label:"Critical Issue",emptyOption:!0,choices:mt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(A.value=t[1].criticalIssues[t[0]].criticalIssue),u=new We({props:A}),x.push(()=>te(u,"value",J));function ae(a){t[3](a)}let g={legend:"Stage",choices:Ue(["Existing","Design"]),inlineSmall:!0};t[1].criticalIssues[t[0]].stage!==void 0&&(g.value=t[1].criticalIssues[t[0]].stage),w=new Se({props:g}),x.push(()=>te(w,"value",ae));function k(a){t[4](a)}let z={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(z.value=t[1].criticalIssues[t[0]].locationName),D=new He({props:z}),x.push(()=>te(D,"value",k));let N=t[1].criticalIssues[t[0]].stage!="Design"&&je(t);function P(a){t[6](a)}let le={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(le.value=t[1].criticalIssues[t[0]].notes),E=new ze({props:le}),x.push(()=>te(E,"value",P)),{c(){e=K("div"),n=K("a"),l=Q("Google StreetView"),r=T(),s=K("a"),c=Q("Bing Streetside"),_=T(),G(u.$$.fragment),v=T(),G(w.$$.fragment),h=T(),G(D.$$.fragment),p=T(),N&&N.c(),I=T(),G(E.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{style:!0});var C=Y(e);n=Z(C,"A",{href:!0,target:!0});var ne=Y(n);l=X(ne,"Google StreetView"),ne.forEach(d),r=q(C),s=Z(C,"A",{href:!0,target:!0});var ie=Y(s);c=X(ie,"Bing Streetside"),ie.forEach(d),C.forEach(d),_=q(a),M(u.$$.fragment,a),v=q(a),M(w.$$.fragment,a),h=q(a),M(D.$$.fragment,a),p=q(a),N&&N.l(a),I=q(a),M(E.$$.fragment,a),this.h()},h(){W(n,"href",i=$e(t[1].criticalIssues[t[0]].point)),W(n,"target","_blank"),W(s,"href",f=de(t[1].criticalIssues[t[0]].point)),W(s,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(a,C){L(a,e,C),R(e,n),R(n,l),R(e,r),R(e,s),R(s,c),L(a,_,C),V(u,a,C),L(a,v,C),V(w,a,C),L(a,h,C),V(D,a,C),L(a,p,C),N&&N.m(a,C),L(a,I,C),V(E,a,C),y=!0},p(a,[C]){(!y||C&3&&i!==(i=$e(a[1].criticalIssues[a[0]].point)))&&W(n,"href",i),(!y||C&3&&f!==(f=de(a[1].criticalIssues[a[0]].point)))&&W(s,"href",f);const ne={};!B&&C&3&&(B=!0,ne.value=a[1].criticalIssues[a[0]].criticalIssue,ee(()=>B=!1)),u.$set(ne);const ie={};!$&&C&3&&($=!0,ie.value=a[1].criticalIssues[a[0]].stage,ee(()=>$=!1)),w.$set(ie);const fe={};!o&&C&3&&(o=!0,fe.value=a[1].criticalIssues[a[0]].locationName,ee(()=>o=!1)),D.$set(fe),a[1].criticalIssues[a[0]].stage!="Design"?N?(N.p(a,C),C&3&&b(N,1)):(N=je(a),N.c(),b(N,1),N.m(I.parentNode,I)):N&&(se(),S(N,1,1,()=>{N=null}),re());const ue={};!j&&C&3&&(j=!0,ue.value=a[1].criticalIssues[a[0]].notes,ee(()=>j=!1)),E.$set(ue)},i(a){y||(b(u.$$.fragment,a),b(w.$$.fragment,a),b(D.$$.fragment,a),b(N),b(E.$$.fragment,a),y=!0)},o(a){S(u.$$.fragment,a),S(w.$$.fragment,a),S(D.$$.fragment,a),S(N),S(E.$$.fragment,a),y=!1},d(a){a&&(d(e),d(_),d(v),d(h),d(p),d(I)),F(u,a),F(w,a),F(D,a),N&&N.d(a),F(E,a)}}}function Et(t,e,n){let l;ye(t,U,u=>n(1,l=u));let{idx:i}=e;function r(u){t.$$.not_equal(l.criticalIssues[i].criticalIssue,u)&&(l.criticalIssues[i].criticalIssue=u,U.set(l))}function s(u){t.$$.not_equal(l.criticalIssues[i].stage,u)&&(l.criticalIssues[i].stage=u,U.set(l))}function c(u){t.$$.not_equal(l.criticalIssues[i].locationName,u)&&(l.criticalIssues[i].locationName=u,U.set(l))}function f(u){t.$$.not_equal(l.criticalIssues[i].resolved,u)&&(l.criticalIssues[i].resolved=u,U.set(l))}function _(u){t.$$.not_equal(l.criticalIssues[i].notes,u)&&(l.criticalIssues[i].notes=u,U.set(l))}return t.$$set=u=>{"idx"in u&&n(0,i=u.idx)},[i,l,r,s,c,f,_]}class Dt extends Ie{constructor(e){super(),Le(this,e,Et,Nt,we,{idx:0})}}function Be(t){let e,n,l;function i(s){t[5](s)}let r={label:"Resolved by Design",inlineSmall:!0};return t[1].policyConflictLog[t[0]].resolved!==void 0&&(r.value=t[1].policyConflictLog[t[0]].resolved),e=new Je({props:r}),x.push(()=>te(e,"value",i)),{c(){G(e.$$.fragment)},l(s){M(e.$$.fragment,s)},m(s,c){V(e,s,c),l=!0},p(s,c){const f={};!n&&c&3&&(n=!0,f.value=s[1].policyConflictLog[s[0]].resolved,ee(()=>n=!1)),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){F(e,s)}}}function jt(t){let e,n,l,i,r,s,c,f,_,u,B,v,w,$,h,D,o,p,I,E,j,y;function J(a){t[2](a)}let A={label:"Policy Conflict",emptyOption:!0,choices:$t};t[1].policyConflictLog[t[0]].conflict!==void 0&&(A.value=t[1].policyConflictLog[t[0]].conflict),u=new We({props:A}),x.push(()=>te(u,"value",J));function ae(a){t[3](a)}let g={legend:"Stage",choices:Ue(["Existing","Design"]),inlineSmall:!0};t[1].policyConflictLog[t[0]].stage!==void 0&&(g.value=t[1].policyConflictLog[t[0]].stage),w=new Se({props:g}),x.push(()=>te(w,"value",ae));function k(a){t[4](a)}let z={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(z.value=t[1].policyConflictLog[t[0]].locationName),D=new He({props:z}),x.push(()=>te(D,"value",k));let N=t[1].policyConflictLog[t[0]].stage!="Design"&&Be(t);function P(a){t[6](a)}let le={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(le.value=t[1].policyConflictLog[t[0]].notes),E=new ze({props:le}),x.push(()=>te(E,"value",P)),{c(){e=K("div"),n=K("a"),l=Q("Google StreetView"),r=T(),s=K("a"),c=Q("Bing Streetside"),_=T(),G(u.$$.fragment),v=T(),G(w.$$.fragment),h=T(),G(D.$$.fragment),p=T(),N&&N.c(),I=T(),G(E.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{style:!0});var C=Y(e);n=Z(C,"A",{href:!0,target:!0});var ne=Y(n);l=X(ne,"Google StreetView"),ne.forEach(d),r=q(C),s=Z(C,"A",{href:!0,target:!0});var ie=Y(s);c=X(ie,"Bing Streetside"),ie.forEach(d),C.forEach(d),_=q(a),M(u.$$.fragment,a),v=q(a),M(w.$$.fragment,a),h=q(a),M(D.$$.fragment,a),p=q(a),N&&N.l(a),I=q(a),M(E.$$.fragment,a),this.h()},h(){W(n,"href",i=$e(t[1].policyConflictLog[t[0]].point)),W(n,"target","_blank"),W(s,"href",f=de(t[1].policyConflictLog[t[0]].point)),W(s,"target","_blank"),H(e,"display","flex"),H(e,"justify-content","space-evenly")},m(a,C){L(a,e,C),R(e,n),R(n,l),R(e,r),R(e,s),R(s,c),L(a,_,C),V(u,a,C),L(a,v,C),V(w,a,C),L(a,h,C),V(D,a,C),L(a,p,C),N&&N.m(a,C),L(a,I,C),V(E,a,C),y=!0},p(a,[C]){(!y||C&3&&i!==(i=$e(a[1].policyConflictLog[a[0]].point)))&&W(n,"href",i),(!y||C&3&&f!==(f=de(a[1].policyConflictLog[a[0]].point)))&&W(s,"href",f);const ne={};!B&&C&3&&(B=!0,ne.value=a[1].policyConflictLog[a[0]].conflict,ee(()=>B=!1)),u.$set(ne);const ie={};!$&&C&3&&($=!0,ie.value=a[1].policyConflictLog[a[0]].stage,ee(()=>$=!1)),w.$set(ie);const fe={};!o&&C&3&&(o=!0,fe.value=a[1].policyConflictLog[a[0]].locationName,ee(()=>o=!1)),D.$set(fe),a[1].policyConflictLog[a[0]].stage!="Design"?N?(N.p(a,C),C&3&&b(N,1)):(N=Be(a),N.c(),b(N,1),N.m(I.parentNode,I)):N&&(se(),S(N,1,1,()=>{N=null}),re());const ue={};!j&&C&3&&(j=!0,ue.value=a[1].policyConflictLog[a[0]].notes,ee(()=>j=!1)),E.$set(ue)},i(a){y||(b(u.$$.fragment,a),b(w.$$.fragment,a),b(D.$$.fragment,a),b(N),b(E.$$.fragment,a),y=!0)},o(a){S(u.$$.fragment,a),S(w.$$.fragment,a),S(D.$$.fragment,a),S(N),S(E.$$.fragment,a),y=!1},d(a){a&&(d(e),d(_),d(v),d(h),d(p),d(I)),F(u,a),F(w,a),F(D,a),N&&N.d(a),F(E,a)}}}function Bt(t,e,n){let l;ye(t,U,u=>n(1,l=u));let{idx:i}=e;function r(u){t.$$.not_equal(l.policyConflictLog[i].conflict,u)&&(l.policyConflictLog[i].conflict=u,U.set(l))}function s(u){t.$$.not_equal(l.policyConflictLog[i].stage,u)&&(l.policyConflictLog[i].stage=u,U.set(l))}function c(u){t.$$.not_equal(l.policyConflictLog[i].locationName,u)&&(l.policyConflictLog[i].locationName=u,U.set(l))}function f(u){t.$$.not_equal(l.policyConflictLog[i].resolved,u)&&(l.policyConflictLog[i].resolved=u,U.set(l))}function _(u){t.$$.not_equal(l.policyConflictLog[i].notes,u)&&(l.policyConflictLog[i].notes=u,U.set(l))}return t.$$set=u=>{"idx"in u&&n(0,i=u.idx)},[i,l,r,s,c,f,_]}class Pt extends Ie{constructor(e){super(),Le(this,e,Bt,jt,we,{idx:0})}}const{window:Tt}=rt;function Pe(t,e,n){const l=t.slice();return l[39]=e[n],l[40]=e,l[41]=n,l}function Te(t,e,n){const l=t.slice();return l[42]=e[n],l[43]=e,l[41]=n,l}function qe(t,e,n){const l=t.slice();return l[39]=e[n],l[41]=n,l}function Ae(t,e,n){const l=t.slice();return l[42]=e[n],l[41]=n,l}function qt(t){let e,n,l,i,r,s,c,f,_,u;e=new It({props:{$$slots:{default:[Gt]},$$scope:{ctx:t}}}),e.$on("click",t[12]),l=new Lt({props:{$$slots:{default:[Mt]},$$scope:{ctx:t}}}),l.$on("click",t[14]),r=new Ze({props:{$$slots:{default:[Vt]},$$scope:{ctx:t}}}),r.$on("click",t[29]);const B=[Rt,Ft],v=[];function w($,h){return $[0].kind=="critical"?0:1}return c=w(t),f=v[c]=B[c](t),{c(){G(e.$$.fragment),n=T(),G(l.$$.fragment),i=T(),G(r.$$.fragment),s=T(),f.c(),_=ge()},l($){M(e.$$.fragment,$),n=q($),M(l.$$.fragment,$),i=q($),M(r.$$.fragment,$),s=q($),f.l($),_=ge()},m($,h){V(e,$,h),L($,n,h),V(l,$,h),L($,i,h),V(r,$,h),L($,s,h),v[c].m($,h),L($,_,h),u=!0},p($,h){const D={};h[1]&32768&&(D.$$scope={dirty:h,ctx:$}),e.$set(D);const o={};h[1]&32768&&(o.$$scope={dirty:h,ctx:$}),l.$set(o);const p={};h[1]&32768&&(p.$$scope={dirty:h,ctx:$}),r.$set(p);let I=c;c=w($),c===I?v[c].p($,h):(se(),S(v[I],1,1,()=>{v[I]=null}),re(),f=v[c],f?f.p($,h):(f=v[c]=B[c]($),f.c()),b(f,1),f.m(_.parentNode,_))},i($){u||(b(e.$$.fragment,$),b(l.$$.fragment,$),b(r.$$.fragment,$),b(f),u=!0)},o($){S(e.$$.fragment,$),S(l.$$.fragment,$),S(r.$$.fragment,$),S(f),u=!1},d($){$&&(d(n),d(i),d(s),d(_)),F(e,$),F(l,$),F(r,$),v[c].d($)}}}function At(t){let e,n,l,i,r,s,c="Click the map to add a problem, or select a problem to fill out data",f,_,u="Critical Issues",B,v,w,$="Policy Conflicts",h,D,o;e=new yt({props:{label:"Tools",open:!0,$$slots:{default:[Wt]},$$scope:{ctx:t}}});function p(g){t[22](g)}let I={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[5]!==void 0&&(I.value=t[5]),l=new Se({props:I}),x.push(()=>te(l,"value",p));let E=oe(t[2].criticalIssues),j=[];for(let g=0;g<E.length;g+=1)j[g]=Me(Ae(t,E,g));const y=g=>S(j[g],1,1,()=>{j[g]=null});let J=oe(t[2].policyConflictLog),A=[];for(let g=0;g<J.length;g+=1)A[g]=Fe(qe(t,J,g));const ae=g=>S(A[g],1,1,()=>{A[g]=null});return{c(){G(e.$$.fragment),n=T(),G(l.$$.fragment),r=T(),s=K("p"),s.textContent=c,f=T(),_=K("h3"),_.textContent=u,B=T();for(let g=0;g<j.length;g+=1)j[g].c();v=T(),w=K("h3"),w.textContent=$,h=T();for(let g=0;g<A.length;g+=1)A[g].c();D=ge()},l(g){M(e.$$.fragment,g),n=q(g),M(l.$$.fragment,g),r=q(g),s=Z(g,"P",{"data-svelte-h":!0}),ve(s)!=="svelte-12ba5j2"&&(s.textContent=c),f=q(g),_=Z(g,"H3",{"data-svelte-h":!0}),ve(_)!=="svelte-1qhh5xr"&&(_.textContent=u),B=q(g);for(let k=0;k<j.length;k+=1)j[k].l(g);v=q(g),w=Z(g,"H3",{"data-svelte-h":!0}),ve(w)!=="svelte-eyxzjx"&&(w.textContent=$),h=q(g);for(let k=0;k<A.length;k+=1)A[k].l(g);D=ge()},m(g,k){V(e,g,k),L(g,n,k),V(l,g,k),L(g,r,k),L(g,s,k),L(g,f,k),L(g,_,k),L(g,B,k);for(let z=0;z<j.length;z+=1)j[z]&&j[z].m(g,k);L(g,v,k),L(g,w,k),L(g,h,k);for(let z=0;z<A.length;z+=1)A[z]&&A[z].m(g,k);L(g,D,k),o=!0},p(g,k){const z={};k[0]&200|k[1]&32768&&(z.$$scope={dirty:k,ctx:g}),e.$set(z);const N={};if(!i&&k[0]&32&&(i=!0,N.value=g[5],ee(()=>i=!1)),l.$set(N),k[0]&66566){E=oe(g[2].criticalIssues);let P;for(P=0;P<E.length;P+=1){const le=Ae(g,E,P);j[P]?(j[P].p(le,k),b(j[P],1)):(j[P]=Me(le),j[P].c(),b(j[P],1),j[P].m(v.parentNode,v))}for(se(),P=E.length;P<j.length;P+=1)y(P);re()}if(k[0]&132102){J=oe(g[2].policyConflictLog);let P;for(P=0;P<J.length;P+=1){const le=qe(g,J,P);A[P]?(A[P].p(le,k),b(A[P],1)):(A[P]=Fe(le),A[P].c(),b(A[P],1),A[P].m(D.parentNode,D))}for(se(),P=J.length;P<A.length;P+=1)ae(P);re()}},i(g){if(!o){b(e.$$.fragment,g),b(l.$$.fragment,g);for(let k=0;k<E.length;k+=1)b(j[k]);for(let k=0;k<J.length;k+=1)b(A[k]);o=!0}},o(g){S(e.$$.fragment,g),S(l.$$.fragment,g),j=j.filter(Boolean);for(let k=0;k<j.length;k+=1)S(j[k]);A=A.filter(Boolean);for(let k=0;k<A.length;k+=1)S(A[k]);o=!1},d(g){g&&(d(n),d(r),d(s),d(f),d(_),d(B),d(v),d(w),d(h),d(D)),F(e,g),F(l,g),me(j,g),me(A,g)}}}function Gt(t){let e;return{c(){e=Q("Save")},l(n){e=X(n,"Save")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Mt(t){let e;return{c(){e=Q("Delete")},l(n){e=X(n,"Delete")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Vt(t){let e;return{c(){e=Q("Copy")},l(n){e=X(n,"Copy")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Ft(t){let e,n;return e=new Pt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p(l,i){const r={};i[0]&1&&(r.idx=l[0].idx),e.$set(r)},i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Rt(t){let e,n;return e=new Dt({props:{idx:t[0].idx}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p(l,i){const r={};i[0]&1&&(r.idx=l[0].idx),e.$set(r)},i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Ot(t){let e;return{c(){e=Q("Zoom to fit")},l(n){e=X(n,"Zoom to fit")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Ut(t){let e;return{c(){e=Q("Show scheme context")},l(n){e=X(n,"Show scheme context")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Wt(t){let e,n,l,i,r,s,c,f,_,u,B,v;e=new Ze({props:{$$slots:{default:[Ot]},$$scope:{ctx:t}}}),e.$on("click",t[19]),l=new vt({}),r=new bt({});function w(o){t[20](o)}let $={map:t[3]};t[6]!==void 0&&($.enabled=t[6]),c=new kt({props:$}),x.push(()=>te(c,"enabled",w));function h(o){t[21](o)}let D={$$slots:{default:[Ut]},$$scope:{ctx:t}};return t[7]!==void 0&&(D.checked=t[7]),u=new Ct({props:D}),x.push(()=>te(u,"checked",h)),{c(){G(e.$$.fragment),n=T(),G(l.$$.fragment),i=T(),G(r.$$.fragment),s=T(),G(c.$$.fragment),_=T(),G(u.$$.fragment)},l(o){M(e.$$.fragment,o),n=q(o),M(l.$$.fragment,o),i=q(o),M(r.$$.fragment,o),s=q(o),M(c.$$.fragment,o),_=q(o),M(u.$$.fragment,o)},m(o,p){V(e,o,p),L(o,n,p),V(l,o,p),L(o,i,p),V(r,o,p),L(o,s,p),V(c,o,p),L(o,_,p),V(u,o,p),v=!0},p(o,p){const I={};p[1]&32768&&(I.$$scope={dirty:p,ctx:o}),e.$set(I);const E={};p[0]&8&&(E.map=o[3]),!f&&p[0]&64&&(f=!0,E.enabled=o[6],ee(()=>f=!1)),c.$set(E);const j={};p[1]&32768&&(j.$$scope={dirty:p,ctx:o}),!B&&p[0]&128&&(B=!0,j.checked=o[7],ee(()=>B=!1)),u.$set(j)},i(o){v||(b(e.$$.fragment,o),b(l.$$.fragment,o),b(r.$$.fragment,o),b(c.$$.fragment,o),b(u.$$.fragment,o),v=!0)},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),S(r.$$.fragment,o),S(c.$$.fragment,o),S(u.$$.fragment,o),v=!1},d(o){o&&(d(n),d(i),d(s),d(_)),F(e,o),F(l,o),F(r,o),F(c,o),F(u,o)}}}function Ge(t){let e,n,l=t[42].resolved+"",i;return{c(){e=K("span"),n=Q("Resolved: "),i=Q(l)},l(r){e=Z(r,"SPAN",{});var s=Y(e);n=X(s,"Resolved: "),i=X(s,l),s.forEach(d)},m(r,s){L(r,e,s),R(e,n),R(e,i)},p(r,s){s[0]&4&&l!==(l=r[42].resolved+"")&&_e(i,l)},d(r){r&&d(e)}}}function zt(t){let e,n,l,i=t[42].stage+"",r,s,c=t[42].stage!="Design"&&Ge(t);return{c(){e=K("div"),n=K("span"),l=Q("Stage: "),r=Q(i),s=T(),c&&c.c(),this.h()},l(f){e=Z(f,"DIV",{style:!0});var _=Y(e);n=Z(_,"SPAN",{});var u=Y(n);l=X(u,"Stage: "),r=X(u,i),u.forEach(d),s=q(_),c&&c.l(_),_.forEach(d),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(f,_){L(f,e,_),R(e,n),R(n,l),R(n,r),R(e,s),c&&c.m(e,null)},p(f,_){_[0]&4&&i!==(i=f[42].stage+"")&&_e(r,i),f[42].stage!="Design"?c?c.p(f,_):(c=Ge(f),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&d(e),c&&c.d()}}}function Me(t){let e,n;function l(){return t[23](t[41])}function i(){return t[24](t[41])}return e=new Ye({props:{name:t[16](t[42]),$$slots:{default:[zt]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",i),e.$on("mouseleave",t[25]),{c(){G(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,s){V(e,r,s),n=!0},p(r,s){t=r;const c={};s[0]&4&&(c.name=t[16](t[42])),s[0]&4|s[1]&32768&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){S(e.$$.fragment,r),n=!1},d(r){F(e,r)}}}function Ve(t){let e,n,l=t[39].resolved+"",i;return{c(){e=K("span"),n=Q("Resolved: "),i=Q(l)},l(r){e=Z(r,"SPAN",{});var s=Y(e);n=X(s,"Resolved: "),i=X(s,l),s.forEach(d)},m(r,s){L(r,e,s),R(e,n),R(e,i)},p(r,s){s[0]&4&&l!==(l=r[39].resolved+"")&&_e(i,l)},d(r){r&&d(e)}}}function Ht(t){let e,n,l,i=t[39].stage+"",r,s,c,f=t[39].stage!="Design"&&Ve(t);return{c(){e=K("div"),n=K("span"),l=Q("Stage: "),r=Q(i),s=T(),f&&f.c(),c=T(),this.h()},l(_){e=Z(_,"DIV",{style:!0});var u=Y(e);n=Z(u,"SPAN",{});var B=Y(n);l=X(B,"Stage: "),r=X(B,i),B.forEach(d),s=q(u),f&&f.l(u),u.forEach(d),c=q(_),this.h()},h(){H(e,"width","100%"),H(e,"display","flex"),H(e,"justify-content","space-between")},m(_,u){L(_,e,u),R(e,n),R(n,l),R(n,r),R(e,s),f&&f.m(e,null),L(_,c,u)},p(_,u){u[0]&4&&i!==(i=_[39].stage+"")&&_e(r,i),_[39].stage!="Design"?f?f.p(_,u):(f=Ve(_),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(_){_&&(d(e),d(c)),f&&f.d()}}}function Fe(t){let e,n;function l(){return t[26](t[41])}function i(){return t[27](t[41])}return e=new Ye({props:{name:t[17](t[39]),$$slots:{default:[Ht]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",i),e.$on("mouseleave",t[28]),{c(){G(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,s){V(e,r,s),n=!0},p(r,s){t=r;const c={};s[0]&4&&(c.name=t[17](t[39])),s[0]&4|s[1]&32768&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){S(e.$$.fragment,r),n=!1},d(r){F(e,r)}}}function Jt(t){let e,n,l,i=t[42].criticalIssue+"",r;return{c(){e=be("svg"),n=be("polygon"),l=be("text"),r=Q(i),this.h()},l(s){e=ke(s,"svg",{width:!0,height:!0,xmlns:!0});var c=Y(e);n=ke(c,"polygon",{points:!0,fill:!0,class:!0}),Y(n).forEach(d),l=ke(c,"text",{x:!0,y:!0});var f=Y(l);r=X(f,i),f.forEach(d),c.forEach(d),this.h()},h(){W(n,"points","20,0 0,40 40,40"),W(n,"fill",pt.critical.background),W(n,"class","svelte-ktyu3j"),W(l,"x","13"),W(l,"y","30"),H(l,"fill","white"),W(e,"width","40"),W(e,"height","40"),W(e,"xmlns","http://www.w3.org/2000/svg")},m(s,c){L(s,e,c),R(e,n),R(e,l),R(l,r)},p(s,c){c[0]&4&&i!==(i=s[42].criticalIssue+"")&&_e(r,i)},d(s){s&&d(e)}}}function Re(t){let e,n,l;function i(f){t[31](f,t[42])}function r(){return t[32](t[41])}function s(){return t[33](t[41])}let c={draggable:!0,$$slots:{default:[Jt]},$$scope:{ctx:t}};return t[42].point!==void 0&&(c.lngLat=t[42].point),e=new Ke({props:c}),x.push(()=>te(e,"lngLat",i)),e.$on("click",r),e.$on("dragend",s),{c(){G(e.$$.fragment)},l(f){M(e.$$.fragment,f)},m(f,_){V(e,f,_),l=!0},p(f,_){t=f;const u={};_[0]&4|_[1]&32768&&(u.$$scope={dirty:_,ctx:t}),!n&&_[0]&4&&(n=!0,u.lngLat=t[42].point,ee(()=>n=!1)),e.$set(u)},i(f){l||(b(e.$$.fragment,f),l=!0)},o(f){S(e.$$.fragment,f),l=!1},d(f){F(e,f)}}}function Kt(t){let e,n=t[39].conflict+"",l;return{c(){e=K("span"),l=Q(n),this.h()},l(i){e=Z(i,"SPAN",{class:!0});var r=Y(e);l=X(r,n),r.forEach(d),this.h()},h(){W(e,"class","dot svelte-ktyu3j"),H(e,"background",_t)},m(i,r){L(i,e,r),R(e,l)},p(i,r){r[0]&4&&n!==(n=i[39].conflict+"")&&_e(l,n)},d(i){i&&d(e)}}}function Oe(t){let e,n,l;function i(f){t[34](f,t[39])}function r(){return t[35](t[41])}function s(){return t[36](t[41])}let c={draggable:!0,$$slots:{default:[Kt]},$$scope:{ctx:t}};return t[39].point!==void 0&&(c.lngLat=t[39].point),e=new Ke({props:c}),x.push(()=>te(e,"lngLat",i)),e.$on("click",r),e.$on("dragend",s),{c(){G(e.$$.fragment)},l(f){M(e.$$.fragment,f)},m(f,_){V(e,f,_),l=!0},p(f,_){t=f;const u={};_[0]&4|_[1]&32768&&(u.$$scope={dirty:_,ctx:t}),!n&&_[0]&4&&(n=!0,u.lngLat=t[39].point,ee(()=>n=!1)),e.$set(u)},i(f){l||(b(e.$$.fragment,f),l=!0)},o(f){S(e.$$.fragment,f),l=!1},d(f){F(e,f)}}}function Zt(t){let e,n;return e=new ct({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p:ot,i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Yt(t){let e,n,l,i,r,s,c,f,_,u;e=new wt({}),e.$on("click",t[13]),l=new ft({props:{gj:t[2].summary.networkMap,show:t[7]}});let B=oe(t[2].criticalIssues),v=[];for(let o=0;o<B.length;o+=1)v[o]=Re(Te(t,B,o));const w=o=>S(v[o],1,1,()=>{v[o]=null});let $=oe(t[2].policyConflictLog),h=[];for(let o=0;o<$.length;o+=1)h[o]=Oe(Pe(t,$,o));const D=o=>S(h[o],1,1,()=>{h[o]=null});return c=new ut({props:{data:t[8],$$slots:{default:[Zt]},$$scope:{ctx:t}}}),_=new St({props:{map:t[3]}}),{c(){G(e.$$.fragment),n=T(),G(l.$$.fragment),i=T();for(let o=0;o<v.length;o+=1)v[o].c();r=T();for(let o=0;o<h.length;o+=1)h[o].c();s=T(),G(c.$$.fragment),f=T(),G(_.$$.fragment)},l(o){M(e.$$.fragment,o),n=q(o),M(l.$$.fragment,o),i=q(o);for(let p=0;p<v.length;p+=1)v[p].l(o);r=q(o);for(let p=0;p<h.length;p+=1)h[p].l(o);s=q(o),M(c.$$.fragment,o),f=q(o),M(_.$$.fragment,o)},m(o,p){V(e,o,p),L(o,n,p),V(l,o,p),L(o,i,p);for(let I=0;I<v.length;I+=1)v[I]&&v[I].m(o,p);L(o,r,p);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(o,p);L(o,s,p),V(c,o,p),L(o,f,p),V(_,o,p),u=!0},p(o,p){const I={};if(p[0]&4&&(I.gj=o[2].summary.networkMap),p[0]&128&&(I.show=o[7]),l.$set(I),p[0]&516){B=oe(o[2].criticalIssues);let y;for(y=0;y<B.length;y+=1){const J=Te(o,B,y);v[y]?(v[y].p(J,p),b(v[y],1)):(v[y]=Re(J),v[y].c(),b(v[y],1),v[y].m(r.parentNode,r))}for(se(),y=B.length;y<v.length;y+=1)w(y);re()}if(p[0]&516){$=oe(o[2].policyConflictLog);let y;for(y=0;y<$.length;y+=1){const J=Pe(o,$,y);h[y]?(h[y].p(J,p),b(h[y],1)):(h[y]=Oe(J),h[y].c(),b(h[y],1),h[y].m(s.parentNode,s))}for(se(),y=$.length;y<h.length;y+=1)D(y);re()}const E={};p[0]&256&&(E.data=o[8]),p[1]&32768&&(E.$$scope={dirty:p,ctx:o}),c.$set(E);const j={};p[0]&8&&(j.map=o[3]),_.$set(j)},i(o){if(!u){b(e.$$.fragment,o),b(l.$$.fragment,o);for(let p=0;p<B.length;p+=1)b(v[p]);for(let p=0;p<$.length;p+=1)b(h[p]);b(c.$$.fragment,o),b(_.$$.fragment,o),u=!0}},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),v=v.filter(Boolean);for(let p=0;p<v.length;p+=1)S(v[p]);h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)S(h[p]);S(c.$$.fragment,o),S(_.$$.fragment,o),u=!1},d(o){o&&(d(n),d(i),d(r),d(s),d(f)),F(e,o),F(l,o),me(v,o),me(h,o),F(c,o),F(_,o)}}}function Qt(t){let e,n,l,i,r,s,c,f,_,u,B;const v=[At,qt],w=[];function $(o,p){return o[0]==null?0:1}l=$(t),i=w[l]=v[l](t);function h(o){t[37](o)}let D={$$slots:{default:[Yt]},$$scope:{ctx:t}};return t[3]!==void 0&&(D.map=t[3]),c=new st({props:D}),x.push(()=>te(c,"map",h)),{c(){e=K("div"),n=K("div"),i.c(),r=T(),s=K("div"),G(c.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{style:!0});var p=Y(e);n=Z(p,"DIV",{style:!0});var I=Y(n);i.l(I),I.forEach(d),r=q(p),s=Z(p,"DIV",{style:!0});var E=Y(s);M(c.$$.fragment,E),E.forEach(d),p.forEach(d),this.h()},h(){H(n,"width","30%"),H(n,"overflow-y","scroll"),H(n,"padding","10px"),H(n,"border","1px solid black"),H(s,"position","relative"),H(s,"width","70%"),H(e,"display","flex"),H(e,"height","80vh")},m(o,p){L(o,e,p),R(e,n),w[l].m(n,null),t[30](n),R(e,r),R(e,s),V(c,s,null),_=!0,u||(B=nt(Tt,"keydown",t[18]),u=!0)},p(o,p){let I=l;l=$(o),l===I?w[l].p(o,p):(se(),S(w[I],1,1,()=>{w[I]=null}),re(),i=w[l],i?i.p(o,p):(i=w[l]=v[l](o),i.c()),b(i,1),i.m(n,null));const E={};p[0]&396|p[1]&32768&&(E.$$scope={dirty:p,ctx:o}),!f&&p[0]&8&&(f=!0,E.map=o[3],ee(()=>f=!1)),c.$set(E)},i(o){_||(b(i),b(c.$$.fragment,o),_=!0)},o(o){S(i),S(c.$$.fragment,o),_=!1},d(o){o&&d(e),w[l].d(),t[30](null),F(c),u=!1,B()}}}function Xt(t,e,n){let l={type:"FeatureCollection",features:[]},i=e??n;if(i!=null){let r=i.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(Ce(r[i.idx].point))}return l}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function xt(t,e,n){let l,i;ye(t,U,m=>n(2,i=m));let r,s,c="critical",f=null,_=null,u=null,B=!1,v=!0;async function w(m){_=s.scrollTop,n(0,f=m),n(1,u=null),await he(),n(4,s.scrollTop=0,s)}async function $(m){_=s.scrollTop,n(0,f=m),n(1,u=null),await he(),n(4,s.scrollTop=0,s);let O=m.kind=="critical"?i.criticalIssues:i.policyConflictLog;r.flyTo({center:O[m.idx].point,duration:500})}async function h(m){let O=m.kind=="critical"?i.criticalIssues:i.policyConflictLog,ce=JSON.parse(JSON.stringify(O[m.idx])),tt=r.getBounds().getWest(),lt=r.getBounds().getEast();ce.point[0]+=(lt-tt)*.05;let Ne=O.toSpliced(m.idx+1,0,ce);m.kind=="critical"?pe(U,i.criticalIssues=Ne,i):pe(U,i.policyConflictLog=Ne,i),w({kind:m.kind,idx:m.idx+1})}async function D(){n(0,f=null),pe(U,i.policyConflictLog=i.policyConflictLog.toSorted((m,O)=>Ee(m.conflict)-Ee(O.conflict)),i),pe(U,i.criticalIssues=i.criticalIssues.toSorted((m,O)=>De(m.criticalIssue)-De(O.criticalIssue)),i),_!=null&&(await he(),n(4,s.scrollTop=_,s),_=null)}function o(m){if(!B){if(f!=null){D();return}c=="critical"?(pe(U,i.criticalIssues=[...i.criticalIssues,{criticalIssue:"",stage:"",point:m.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),w({kind:"critical",idx:i.criticalIssues.length-1})):(pe(U,i.policyConflictLog=[...i.policyConflictLog,{conflict:"",stage:"",point:m.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),w({kind:"conflict",idx:i.policyConflictLog.length-1}))}}it(()=>{I(!1)});function p(){window.confirm("Delete this entry?")&&(f.kind=="critical"?(i.criticalIssues.splice(f.idx,1),U.set(i)):(i.policyConflictLog.splice(f.idx,1),U.set(i)),D())}function I(m){let O={type:"FeatureCollection",features:[...i.criticalIssues.map(ce=>Ce(ce.point)),...i.policyConflictLog.map(ce=>Ce(ce.point)),...i.summary.networkMap.features]};O.features.length>0&&r.fitBounds(at(O),{padding:20,animate:m})}function E(m){let O=m.criticalIssue?dt(m.criticalIssue):"Unknown critical";return m.locationName?`${O} (${m.locationName})`:O}function j(m){let O=m.conflict?ht(m.conflict):"Unknown conflict";return m.locationName?`${O} (${m.locationName})`:O}function y(m){if(f!=null&&m.key=="Escape")m.stopPropagation(),D();else if(f!=null&&m.key=="Delete"){let O=m.target.tagName;if(O=="INPUT"||O=="TEXTAREA")return;m.stopPropagation(),p()}}const J=()=>I(!0);function A(m){B=m,n(6,B)}function ae(m){v=m,n(7,v)}function g(m){c=m,n(5,c)}const k=m=>$({kind:"critical",idx:m}),z=m=>n(1,u={kind:"critical",idx:m}),N=()=>n(1,u=null),P=m=>$({kind:"conflict",idx:m}),le=m=>n(1,u={kind:"conflict",idx:m}),a=()=>n(1,u=null),C=()=>{let m=gt(f);h({kind:m.kind,idx:m.idx})};function ne(m){x[m?"unshift":"push"](()=>{s=m,n(4,s)})}function ie(m,O){t.$$.not_equal(O.point,m)&&(O.point=m,U.set(i))}const fe=m=>w({kind:"critical",idx:m}),ue=m=>w({kind:"critical",idx:m});function Qe(m,O){t.$$.not_equal(O.point,m)&&(O.point=m,U.set(i))}const Xe=m=>w({kind:"conflict",idx:m}),xe=m=>w({kind:"conflict",idx:m});function et(m){r=m,n(3,r)}return t.$$.update=()=>{t.$$.dirty[0]&7&&n(8,l=Xt(i,f,u))},[f,u,i,r,s,c,B,v,l,w,$,h,D,o,p,I,E,j,y,J,A,ae,g,k,z,N,P,le,a,C,ne,ie,fe,ue,Qe,Xe,xe,et]}class kl extends Ie{constructor(e){super(),Le(this,e,xt,Qt,we,{},null,[-1,-1])}}export{kl as component};
