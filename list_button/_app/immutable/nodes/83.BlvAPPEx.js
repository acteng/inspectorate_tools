import{s as Ce,v as J,e as W,t as te,a as q,c as Y,b as Z,d as ne,f as d,g as j,r as U,x,i as I,h as z,w as Q,k as we,z as ze,U as He,T as Se,D as Ne,p as he,q as _e,j as de,n as Ke,M as ve,N as be}from"../chunks/scheduler.BBS-fkhU.js";import{S as ye,i as Ie,e as X,c as B,a as M,m as G,t as w,b as L,d as V,f as re,g as ae}from"../chunks/index.B8H3ypVf.js";import{s as $e,a as me,M as We,g as Ye,b as Ze,C as Je,G as Qe,c as Xe}from"../chunks/index.f3ZFIiIJ.js";import{e as se}from"../chunks/each.D79A5KlB.js";import{c as xe,p as et}from"../chunks/colors.CYEpEtTL.js";import{p as Oe}from"../chunks/index.9xEff5b4.js";import{S as ge}from"../chunks/Select.DqyoFzIJ.js";import{T as Pe}from"../chunks/TextArea.Ck6ITb4v.js";import{T as Te}from"../chunks/TextInput.C_aBwF72.js";import{s as R}from"../chunks/data.TOdN5cIF.js";import{c as tt,p as nt}from"../chunks/lists.BnA5ucEg.js";import{Y as Ue}from"../chunks/YesNo.BaRWWC-z.js";import{R as lt,B as it,G as ot,S as st,C as rt,M as at,a as ft,b as Re}from"../chunks/GeoreferenceLayer.BzVtkTd7.js";import{D as ut,C as ct}from"../chunks/DefaultButton.Pbp5mObw.js";import{W as pt,S as Le}from"../chunks/WarningButton.CaqyhU7y.js";function _t(t){let e,l,n,s,_,p,r,f,g,a,S,c,h,D,y,N,i,u,C,F,O,$,K,P;function A(o){t[2](o)}let oe={label:"Critical Issue",emptyOption:!0,choices:tt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(oe.value=t[1].criticalIssues[t[0]].criticalIssue),a=new ge({props:oe}),J.push(()=>X(a,"value",A));function m(o){t[3](o)}let b={label:"Stage",emptyOption:!0,choices:Oe(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(b.value=t[1].criticalIssues[t[0]].stage),h=new ge({props:b}),J.push(()=>X(h,"value",m));function T(o){t[4](o)}let H={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(H.value=t[1].criticalIssues[t[0]].locationName),N=new Te({props:H}),J.push(()=>X(N,"value",T));function E(o){t[5](o)}let ee={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(ee.value=t[1].criticalIssues[t[0]].resolved),C=new Ue({props:ee}),J.push(()=>X(C,"value",E));function fe(o){t[6](o)}let k={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(k.value=t[1].criticalIssues[t[0]].notes),$=new Pe({props:k}),J.push(()=>X($,"value",fe)),{c(){e=W("div"),l=W("a"),n=te("Google StreetView"),_=q(),p=W("a"),r=te("Bing Streetside"),g=q(),B(a.$$.fragment),c=q(),B(h.$$.fragment),y=q(),B(N.$$.fragment),u=q(),B(C.$$.fragment),O=q(),B($.$$.fragment),this.h()},l(o){e=Y(o,"DIV",{style:!0});var v=Z(e);l=Y(v,"A",{href:!0,target:!0});var le=Z(l);n=ne(le,"Google StreetView"),le.forEach(d),_=j(v),p=Y(v,"A",{href:!0,target:!0});var ie=Z(p);r=ne(ie,"Bing Streetside"),ie.forEach(d),v.forEach(d),g=j(o),M(a.$$.fragment,o),c=j(o),M(h.$$.fragment,o),y=j(o),M(N.$$.fragment,o),u=j(o),M(C.$$.fragment,o),O=j(o),M($.$$.fragment,o),this.h()},h(){U(l,"href",s=$e(t[1].criticalIssues[t[0]].point)),U(l,"target","_blank"),U(p,"href",f=me(t[1].criticalIssues[t[0]].point)),U(p,"target","_blank"),x(e,"display","flex"),x(e,"justify-content","space-evenly")},m(o,v){I(o,e,v),z(e,l),z(l,n),z(e,_),z(e,p),z(p,r),I(o,g,v),G(a,o,v),I(o,c,v),G(h,o,v),I(o,y,v),G(N,o,v),I(o,u,v),G(C,o,v),I(o,O,v),G($,o,v),P=!0},p(o,[v]){(!P||v&3&&s!==(s=$e(o[1].criticalIssues[o[0]].point)))&&U(l,"href",s),(!P||v&3&&f!==(f=me(o[1].criticalIssues[o[0]].point)))&&U(p,"href",f);const le={};!S&&v&3&&(S=!0,le.value=o[1].criticalIssues[o[0]].criticalIssue,Q(()=>S=!1)),a.$set(le);const ie={};!D&&v&3&&(D=!0,ie.value=o[1].criticalIssues[o[0]].stage,Q(()=>D=!1)),h.$set(ie);const ue={};!i&&v&3&&(i=!0,ue.value=o[1].criticalIssues[o[0]].locationName,Q(()=>i=!1)),N.$set(ue);const ce={};!F&&v&3&&(F=!0,ce.value=o[1].criticalIssues[o[0]].resolved,Q(()=>F=!1)),C.$set(ce);const pe={};!K&&v&3&&(K=!0,pe.value=o[1].criticalIssues[o[0]].notes,Q(()=>K=!1)),$.$set(pe)},i(o){P||(w(a.$$.fragment,o),w(h.$$.fragment,o),w(N.$$.fragment,o),w(C.$$.fragment,o),w($.$$.fragment,o),P=!0)},o(o){L(a.$$.fragment,o),L(h.$$.fragment,o),L(N.$$.fragment,o),L(C.$$.fragment,o),L($.$$.fragment,o),P=!1},d(o){o&&(d(e),d(g),d(c),d(y),d(u),d(O)),V(a,o),V(h,o),V(N,o),V(C,o),V($,o)}}}function $t(t,e,l){let n;we(t,R,a=>l(1,n=a));let{idx:s}=e;function _(a){t.$$.not_equal(n.criticalIssues[s].criticalIssue,a)&&(n.criticalIssues[s].criticalIssue=a,R.set(n))}function p(a){t.$$.not_equal(n.criticalIssues[s].stage,a)&&(n.criticalIssues[s].stage=a,R.set(n))}function r(a){t.$$.not_equal(n.criticalIssues[s].locationName,a)&&(n.criticalIssues[s].locationName=a,R.set(n))}function f(a){t.$$.not_equal(n.criticalIssues[s].resolved,a)&&(n.criticalIssues[s].resolved=a,R.set(n))}function g(a){t.$$.not_equal(n.criticalIssues[s].notes,a)&&(n.criticalIssues[s].notes=a,R.set(n))}return t.$$set=a=>{"idx"in a&&l(0,s=a.idx)},[s,n,_,p,r,f,g]}class mt extends ye{constructor(e){super(),Ie(this,e,$t,_t,Ce,{idx:0})}}function gt(t){let e,l,n,s,_,p,r,f,g,a,S,c,h,D,y,N,i,u,C,F,O,$,K,P;function A(o){t[2](o)}let oe={label:"Policy Conflict",emptyOption:!0,choices:nt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(oe.value=t[1].policyConflictLog[t[0]].conflict),a=new ge({props:oe}),J.push(()=>X(a,"value",A));function m(o){t[3](o)}let b={label:"Stage",emptyOption:!0,choices:Oe(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(b.value=t[1].policyConflictLog[t[0]].stage),h=new ge({props:b}),J.push(()=>X(h,"value",m));function T(o){t[4](o)}let H={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(H.value=t[1].policyConflictLog[t[0]].locationName),N=new Te({props:H}),J.push(()=>X(N,"value",T));function E(o){t[5](o)}let ee={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(ee.value=t[1].policyConflictLog[t[0]].resolved),C=new Ue({props:ee}),J.push(()=>X(C,"value",E));function fe(o){t[6](o)}let k={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(k.value=t[1].policyConflictLog[t[0]].notes),$=new Pe({props:k}),J.push(()=>X($,"value",fe)),{c(){e=W("div"),l=W("a"),n=te("Google StreetView"),_=q(),p=W("a"),r=te("Bing Streetside"),g=q(),B(a.$$.fragment),c=q(),B(h.$$.fragment),y=q(),B(N.$$.fragment),u=q(),B(C.$$.fragment),O=q(),B($.$$.fragment),this.h()},l(o){e=Y(o,"DIV",{style:!0});var v=Z(e);l=Y(v,"A",{href:!0,target:!0});var le=Z(l);n=ne(le,"Google StreetView"),le.forEach(d),_=j(v),p=Y(v,"A",{href:!0,target:!0});var ie=Z(p);r=ne(ie,"Bing Streetside"),ie.forEach(d),v.forEach(d),g=j(o),M(a.$$.fragment,o),c=j(o),M(h.$$.fragment,o),y=j(o),M(N.$$.fragment,o),u=j(o),M(C.$$.fragment,o),O=j(o),M($.$$.fragment,o),this.h()},h(){U(l,"href",s=$e(t[1].policyConflictLog[t[0]].point)),U(l,"target","_blank"),U(p,"href",f=me(t[1].policyConflictLog[t[0]].point)),U(p,"target","_blank"),x(e,"display","flex"),x(e,"justify-content","space-evenly")},m(o,v){I(o,e,v),z(e,l),z(l,n),z(e,_),z(e,p),z(p,r),I(o,g,v),G(a,o,v),I(o,c,v),G(h,o,v),I(o,y,v),G(N,o,v),I(o,u,v),G(C,o,v),I(o,O,v),G($,o,v),P=!0},p(o,[v]){(!P||v&3&&s!==(s=$e(o[1].policyConflictLog[o[0]].point)))&&U(l,"href",s),(!P||v&3&&f!==(f=me(o[1].policyConflictLog[o[0]].point)))&&U(p,"href",f);const le={};!S&&v&3&&(S=!0,le.value=o[1].policyConflictLog[o[0]].conflict,Q(()=>S=!1)),a.$set(le);const ie={};!D&&v&3&&(D=!0,ie.value=o[1].policyConflictLog[o[0]].stage,Q(()=>D=!1)),h.$set(ie);const ue={};!i&&v&3&&(i=!0,ue.value=o[1].policyConflictLog[o[0]].locationName,Q(()=>i=!1)),N.$set(ue);const ce={};!F&&v&3&&(F=!0,ce.value=o[1].policyConflictLog[o[0]].resolved,Q(()=>F=!1)),C.$set(ce);const pe={};!K&&v&3&&(K=!0,pe.value=o[1].policyConflictLog[o[0]].notes,Q(()=>K=!1)),$.$set(pe)},i(o){P||(w(a.$$.fragment,o),w(h.$$.fragment,o),w(N.$$.fragment,o),w(C.$$.fragment,o),w($.$$.fragment,o),P=!0)},o(o){L(a.$$.fragment,o),L(h.$$.fragment,o),L(N.$$.fragment,o),L(C.$$.fragment,o),L($.$$.fragment,o),P=!1},d(o){o&&(d(e),d(g),d(c),d(y),d(u),d(O)),V(a,o),V(h,o),V(N,o),V(C,o),V($,o)}}}function dt(t,e,l){let n;we(t,R,a=>l(1,n=a));let{idx:s}=e;function _(a){t.$$.not_equal(n.policyConflictLog[s].conflict,a)&&(n.policyConflictLog[s].conflict=a,R.set(n))}function p(a){t.$$.not_equal(n.policyConflictLog[s].stage,a)&&(n.policyConflictLog[s].stage=a,R.set(n))}function r(a){t.$$.not_equal(n.policyConflictLog[s].locationName,a)&&(n.policyConflictLog[s].locationName=a,R.set(n))}function f(a){t.$$.not_equal(n.policyConflictLog[s].resolved,a)&&(n.policyConflictLog[s].resolved=a,R.set(n))}function g(a){t.$$.not_equal(n.policyConflictLog[s].notes,a)&&(n.policyConflictLog[s].notes=a,R.set(n))}return t.$$set=a=>{"idx"in a&&l(0,s=a.idx)},[s,n,_,p,r,f,g]}class ht extends ye{constructor(e){super(),Ie(this,e,dt,gt,Ce,{idx:0})}}const{window:vt}=Ye;function Ee(t,e,l){const n=t.slice();return n[31]=e[l],n[32]=e,n[33]=l,n}function De(t,e,l){const n=t.slice();return n[34]=e[l],n[35]=e,n[33]=l,n}function qe(t,e,l){const n=t.slice();return n[31]=e[l],n[33]=l,n}function je(t,e,l){const n=t.slice();return n[34]=e[l],n[33]=l,n}function bt(t){let e,l,n,s,_,p,r,f;e=new ut({props:{$$slots:{default:[Ct]},$$scope:{ctx:t}}}),e.$on("click",t[23]),n=new pt({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),n.$on("click",t[10]);const g=[It,yt],a=[];function S(c,h){return c[0].kind=="critical"?0:1}return _=S(t),p=a[_]=g[_](t),{c(){B(e.$$.fragment),l=q(),B(n.$$.fragment),s=q(),p.c(),r=Ne()},l(c){M(e.$$.fragment,c),l=j(c),M(n.$$.fragment,c),s=j(c),p.l(c),r=Ne()},m(c,h){G(e,c,h),I(c,l,h),G(n,c,h),I(c,s,h),a[_].m(c,h),I(c,r,h),f=!0},p(c,h){const D={};h[1]&128&&(D.$$scope={dirty:h,ctx:c}),e.$set(D);const y={};h[1]&128&&(y.$$scope={dirty:h,ctx:c}),n.$set(y);let N=_;_=S(c),_===N?a[_].p(c,h):(ae(),L(a[N],1,1,()=>{a[N]=null}),re(),p=a[_],p?p.p(c,h):(p=a[_]=g[_](c),p.c()),w(p,1),p.m(r.parentNode,r))},i(c){f||(w(e.$$.fragment,c),w(n.$$.fragment,c),w(p),f=!0)},o(c){L(e.$$.fragment,c),L(n.$$.fragment,c),L(p),f=!1},d(c){c&&(d(l),d(s),d(r)),V(e,c),V(n,c),a[_].d(c)}}}function kt(t){let e,l,n,s,_,p,r="Click the map to add a problem, or select a problem to fill out data",f,g,a="Critical Issues",S,c,h,D,y="Policy Conflicts",N,i,u;e=new ct({props:{label:"Tools",$$slots:{default:[Nt]},$$scope:{ctx:t}}});function C(m){t[16](m)}let F={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[4]!==void 0&&(F.value=t[4]),n=new lt({props:F}),J.push(()=>X(n,"value",C));let O=se(t[2].criticalIssues),$=[];for(let m=0;m<O.length;m+=1)$[m]=Be(je(t,O,m));const K=m=>L($[m],1,1,()=>{$[m]=null});let P=se(t[2].policyConflictLog),A=[];for(let m=0;m<P.length;m+=1)A[m]=Me(qe(t,P,m));const oe=m=>L(A[m],1,1,()=>{A[m]=null});return{c(){B(e.$$.fragment),l=q(),B(n.$$.fragment),_=q(),p=W("p"),p.textContent=r,f=q(),g=W("h3"),g.textContent=a,S=q(),c=W("ol");for(let m=0;m<$.length;m+=1)$[m].c();h=q(),D=W("h3"),D.textContent=y,N=q(),i=W("ol");for(let m=0;m<A.length;m+=1)A[m].c()},l(m){M(e.$$.fragment,m),l=j(m),M(n.$$.fragment,m),_=j(m),p=Y(m,"P",{"data-svelte-h":!0}),he(p)!=="svelte-12ba5j2"&&(p.textContent=r),f=j(m),g=Y(m,"H3",{"data-svelte-h":!0}),he(g)!=="svelte-1qhh5xr"&&(g.textContent=a),S=j(m),c=Y(m,"OL",{});var b=Z(c);for(let H=0;H<$.length;H+=1)$[H].l(b);b.forEach(d),h=j(m),D=Y(m,"H3",{"data-svelte-h":!0}),he(D)!=="svelte-eyxzjx"&&(D.textContent=y),N=j(m),i=Y(m,"OL",{});var T=Z(i);for(let H=0;H<A.length;H+=1)A[H].l(T);T.forEach(d)},m(m,b){G(e,m,b),I(m,l,b),G(n,m,b),I(m,_,b),I(m,p,b),I(m,f,b),I(m,g,b),I(m,S,b),I(m,c,b);for(let T=0;T<$.length;T+=1)$[T]&&$[T].m(c,null);I(m,h,b),I(m,D,b),I(m,N,b),I(m,i,b);for(let T=0;T<A.length;T+=1)A[T]&&A[T].m(i,null);u=!0},p(m,b){const T={};b[0]&104|b[1]&128&&(T.$$scope={dirty:b,ctx:m}),e.$set(T);const H={};if(!s&&b[0]&16&&(s=!0,H.value=m[4],Q(()=>s=!1)),n.$set(H),b[0]&262){O=se(m[2].criticalIssues);let E;for(E=0;E<O.length;E+=1){const ee=je(m,O,E);$[E]?($[E].p(ee,b),w($[E],1)):($[E]=Be(ee),$[E].c(),w($[E],1),$[E].m(c,null))}for(ae(),E=O.length;E<$.length;E+=1)K(E);re()}if(b[0]&262){P=se(m[2].policyConflictLog);let E;for(E=0;E<P.length;E+=1){const ee=qe(m,P,E);A[E]?(A[E].p(ee,b),w(A[E],1)):(A[E]=Me(ee),A[E].c(),w(A[E],1),A[E].m(i,null))}for(ae(),E=P.length;E<A.length;E+=1)oe(E);re()}},i(m){if(!u){w(e.$$.fragment,m),w(n.$$.fragment,m);for(let b=0;b<O.length;b+=1)w($[b]);for(let b=0;b<P.length;b+=1)w(A[b]);u=!0}},o(m){L(e.$$.fragment,m),L(n.$$.fragment,m),$=$.filter(Boolean);for(let b=0;b<$.length;b+=1)L($[b]);A=A.filter(Boolean);for(let b=0;b<A.length;b+=1)L(A[b]);u=!1},d(m){m&&(d(l),d(_),d(p),d(f),d(g),d(S),d(c),d(h),d(D),d(N),d(i)),V(e,m),V(n,m),_e($,m),_e(A,m)}}}function Ct(t){let e;return{c(){e=te("Save")},l(l){e=ne(l,"Save")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function wt(t){let e;return{c(){e=te("Delete")},l(l){e=ne(l,"Delete")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function yt(t){let e,l;return e=new ht({props:{idx:t[0].idx}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){G(e,n,s),l=!0},p(n,s){const _={};s[0]&1&&(_.idx=n[0].idx),e.$set(_)},i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function It(t){let e,l;return e=new mt({props:{idx:t[0].idx}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){G(e,n,s),l=!0},p(n,s){const _={};s[0]&1&&(_.idx=n[0].idx),e.$set(_)},i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function Lt(t){let e;return{c(){e=te("Zoom to fit")},l(l){e=ne(l,"Zoom to fit")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function St(t){let e;return{c(){e=te("Show scheme context")},l(l){e=ne(l,"Show scheme context")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function Nt(t){let e,l,n,s,_,p,r,f,g,a,S,c;e=new Le({props:{$$slots:{default:[Lt]},$$scope:{ctx:t}}}),e.$on("click",t[13]),n=new it({}),_=new ot({});function h(i){t[14](i)}let D={map:t[3]};t[5]!==void 0&&(D.enabled=t[5]),r=new st({props:D}),J.push(()=>X(r,"enabled",h));function y(i){t[15](i)}let N={$$slots:{default:[St]},$$scope:{ctx:t}};return t[6]!==void 0&&(N.checked=t[6]),a=new rt({props:N}),J.push(()=>X(a,"checked",y)),{c(){B(e.$$.fragment),l=q(),B(n.$$.fragment),s=q(),B(_.$$.fragment),p=q(),B(r.$$.fragment),g=q(),B(a.$$.fragment)},l(i){M(e.$$.fragment,i),l=j(i),M(n.$$.fragment,i),s=j(i),M(_.$$.fragment,i),p=j(i),M(r.$$.fragment,i),g=j(i),M(a.$$.fragment,i)},m(i,u){G(e,i,u),I(i,l,u),G(n,i,u),I(i,s,u),G(_,i,u),I(i,p,u),G(r,i,u),I(i,g,u),G(a,i,u),c=!0},p(i,u){const C={};u[1]&128&&(C.$$scope={dirty:u,ctx:i}),e.$set(C);const F={};u[0]&8&&(F.map=i[3]),!f&&u[0]&32&&(f=!0,F.enabled=i[5],Q(()=>f=!1)),r.$set(F);const O={};u[1]&128&&(O.$$scope={dirty:u,ctx:i}),!S&&u[0]&64&&(S=!0,O.checked=i[6],Q(()=>S=!1)),a.$set(O)},i(i){c||(w(e.$$.fragment,i),w(n.$$.fragment,i),w(_.$$.fragment,i),w(r.$$.fragment,i),w(a.$$.fragment,i),c=!0)},o(i){L(e.$$.fragment,i),L(n.$$.fragment,i),L(_.$$.fragment,i),L(r.$$.fragment,i),L(a.$$.fragment,i),c=!1},d(i){i&&(d(l),d(s),d(p),d(g)),V(e,i),V(n,i),V(_,i),V(r,i),V(a,i)}}}function Et(t){let e=Ae(t[34])+"",l;return{c(){l=te(e)},l(n){l=ne(n,e)},m(n,s){I(n,l,s)},p(n,s){s[0]&4&&e!==(e=Ae(n[34])+"")&&de(l,e)},d(n){n&&d(l)}}}function Be(t){let e,l,n,s;function _(){return t[17](t[33])}function p(){return t[18](t[33])}return l=new Le({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),l.$on("click",_),l.$on("mouseenter",p),l.$on("mouseleave",t[19]),{c(){e=W("li"),B(l.$$.fragment),n=q()},l(r){e=Y(r,"LI",{});var f=Z(e);M(l.$$.fragment,f),n=j(f),f.forEach(d)},m(r,f){I(r,e,f),G(l,e,null),z(e,n),s=!0},p(r,f){t=r;const g={};f[0]&4|f[1]&128&&(g.$$scope={dirty:f,ctx:t}),l.$set(g)},i(r){s||(w(l.$$.fragment,r),s=!0)},o(r){L(l.$$.fragment,r),s=!1},d(r){r&&d(e),V(l)}}}function Dt(t){let e=Fe(t[31])+"",l;return{c(){l=te(e)},l(n){l=ne(n,e)},m(n,s){I(n,l,s)},p(n,s){s[0]&4&&e!==(e=Fe(n[31])+"")&&de(l,e)},d(n){n&&d(l)}}}function Me(t){let e,l,n,s;function _(){return t[20](t[33])}function p(){return t[21](t[33])}return l=new Le({props:{$$slots:{default:[Dt]},$$scope:{ctx:t}}}),l.$on("click",_),l.$on("mouseenter",p),l.$on("mouseleave",t[22]),{c(){e=W("li"),B(l.$$.fragment),n=q()},l(r){e=Y(r,"LI",{});var f=Z(e);M(l.$$.fragment,f),n=j(f),f.forEach(d)},m(r,f){I(r,e,f),G(l,e,null),z(e,n),s=!0},p(r,f){t=r;const g={};f[0]&4|f[1]&128&&(g.$$scope={dirty:f,ctx:t}),l.$set(g)},i(r){s||(w(l.$$.fragment,r),s=!0)},o(r){L(l.$$.fragment,r),s=!1},d(r){r&&d(e),V(l)}}}function qt(t){let e,l,n,s=t[34].criticalIssue+"",_;return{c(){e=ve("svg"),l=ve("polygon"),n=ve("text"),_=te(s),this.h()},l(p){e=be(p,"svg",{width:!0,height:!0,xmlns:!0});var r=Z(e);l=be(r,"polygon",{points:!0,fill:!0,class:!0}),Z(l).forEach(d),n=be(r,"text",{x:!0,y:!0});var f=Z(n);_=ne(f,s),f.forEach(d),r.forEach(d),this.h()},h(){U(l,"points","20,0 0,40 40,40"),U(l,"fill",xe.critical.background),U(l,"class","svelte-ktyu3j"),U(n,"x","13"),U(n,"y","30"),x(n,"fill","white"),U(e,"width","40"),U(e,"height","40"),U(e,"xmlns","http://www.w3.org/2000/svg")},m(p,r){I(p,e,r),z(e,l),z(e,n),z(n,_)},p(p,r){r[0]&4&&s!==(s=p[34].criticalIssue+"")&&de(_,s)},d(p){p&&d(e)}}}function Ge(t){let e,l,n;function s(f){t[24](f,t[34])}function _(){return t[25](t[33])}function p(){return t[26](t[33])}let r={draggable:!0,$$slots:{default:[qt]},$$scope:{ctx:t}};return t[34].point!==void 0&&(r.lngLat=t[34].point),e=new Re({props:r}),J.push(()=>X(e,"lngLat",s)),e.$on("click",_),e.$on("dragend",p),{c(){B(e.$$.fragment)},l(f){M(e.$$.fragment,f)},m(f,g){G(e,f,g),n=!0},p(f,g){t=f;const a={};g[0]&4|g[1]&128&&(a.$$scope={dirty:g,ctx:t}),!l&&g[0]&4&&(l=!0,a.lngLat=t[34].point,Q(()=>l=!1)),e.$set(a)},i(f){n||(w(e.$$.fragment,f),n=!0)},o(f){L(e.$$.fragment,f),n=!1},d(f){V(e,f)}}}function jt(t){let e,l=t[31].conflict+"",n;return{c(){e=W("span"),n=te(l),this.h()},l(s){e=Y(s,"SPAN",{class:!0});var _=Z(e);n=ne(_,l),_.forEach(d),this.h()},h(){U(e,"class","dot svelte-ktyu3j"),x(e,"background",et)},m(s,_){I(s,e,_),z(e,n)},p(s,_){_[0]&4&&l!==(l=s[31].conflict+"")&&de(n,l)},d(s){s&&d(e)}}}function Ve(t){let e,l,n;function s(f){t[27](f,t[31])}function _(){return t[28](t[33])}function p(){return t[29](t[33])}let r={draggable:!0,$$slots:{default:[jt]},$$scope:{ctx:t}};return t[31].point!==void 0&&(r.lngLat=t[31].point),e=new Re({props:r}),J.push(()=>X(e,"lngLat",s)),e.$on("click",_),e.$on("dragend",p),{c(){B(e.$$.fragment)},l(f){M(e.$$.fragment,f)},m(f,g){G(e,f,g),n=!0},p(f,g){t=f;const a={};g[0]&4|g[1]&128&&(a.$$scope={dirty:g,ctx:t}),!l&&g[0]&4&&(l=!0,a.lngLat=t[31].point,Q(()=>l=!1)),e.$set(a)},i(f){n||(w(e.$$.fragment,f),n=!0)},o(f){L(e.$$.fragment,f),n=!1},d(f){V(e,f)}}}function Bt(t){let e,l;return e=new Xe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){G(e,n,s),l=!0},p:Ke,i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){V(e,n)}}}function Mt(t){let e,l,n,s,_,p,r,f,g,a;e=new at({}),e.$on("click",t[9]),n=new Je({props:{gj:t[2].summary.networkMap,show:t[6]}});let S=se(t[2].criticalIssues),c=[];for(let i=0;i<S.length;i+=1)c[i]=Ge(De(t,S,i));const h=i=>L(c[i],1,1,()=>{c[i]=null});let D=se(t[2].policyConflictLog),y=[];for(let i=0;i<D.length;i+=1)y[i]=Ve(Ee(t,D,i));const N=i=>L(y[i],1,1,()=>{y[i]=null});return r=new Qe({props:{data:t[7],$$slots:{default:[Bt]},$$scope:{ctx:t}}}),g=new ft({props:{map:t[3]}}),{c(){B(e.$$.fragment),l=q(),B(n.$$.fragment),s=q();for(let i=0;i<c.length;i+=1)c[i].c();_=q();for(let i=0;i<y.length;i+=1)y[i].c();p=q(),B(r.$$.fragment),f=q(),B(g.$$.fragment)},l(i){M(e.$$.fragment,i),l=j(i),M(n.$$.fragment,i),s=j(i);for(let u=0;u<c.length;u+=1)c[u].l(i);_=j(i);for(let u=0;u<y.length;u+=1)y[u].l(i);p=j(i),M(r.$$.fragment,i),f=j(i),M(g.$$.fragment,i)},m(i,u){G(e,i,u),I(i,l,u),G(n,i,u),I(i,s,u);for(let C=0;C<c.length;C+=1)c[C]&&c[C].m(i,u);I(i,_,u);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(i,u);I(i,p,u),G(r,i,u),I(i,f,u),G(g,i,u),a=!0},p(i,u){const C={};if(u[0]&4&&(C.gj=i[2].summary.networkMap),u[0]&64&&(C.show=i[6]),n.$set(C),u[0]&260){S=se(i[2].criticalIssues);let $;for($=0;$<S.length;$+=1){const K=De(i,S,$);c[$]?(c[$].p(K,u),w(c[$],1)):(c[$]=Ge(K),c[$].c(),w(c[$],1),c[$].m(_.parentNode,_))}for(ae(),$=S.length;$<c.length;$+=1)h($);re()}if(u[0]&260){D=se(i[2].policyConflictLog);let $;for($=0;$<D.length;$+=1){const K=Ee(i,D,$);y[$]?(y[$].p(K,u),w(y[$],1)):(y[$]=Ve(K),y[$].c(),w(y[$],1),y[$].m(p.parentNode,p))}for(ae(),$=D.length;$<y.length;$+=1)N($);re()}const F={};u[0]&128&&(F.data=i[7]),u[1]&128&&(F.$$scope={dirty:u,ctx:i}),r.$set(F);const O={};u[0]&8&&(O.map=i[3]),g.$set(O)},i(i){if(!a){w(e.$$.fragment,i),w(n.$$.fragment,i);for(let u=0;u<S.length;u+=1)w(c[u]);for(let u=0;u<D.length;u+=1)w(y[u]);w(r.$$.fragment,i),w(g.$$.fragment,i),a=!0}},o(i){L(e.$$.fragment,i),L(n.$$.fragment,i),c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)L(c[u]);y=y.filter(Boolean);for(let u=0;u<y.length;u+=1)L(y[u]);L(r.$$.fragment,i),L(g.$$.fragment,i),a=!1},d(i){i&&(d(l),d(s),d(_),d(p),d(f)),V(e,i),V(n,i),_e(c,i),_e(y,i),V(r,i),V(g,i)}}}function Gt(t){let e,l,n,s,_,p,r,f,g,a,S;const c=[kt,bt],h=[];function D(i,u){return i[0]==null?0:1}n=D(t),s=h[n]=c[n](t);function y(i){t[30](i)}let N={$$slots:{default:[Mt]},$$scope:{ctx:t}};return t[3]!==void 0&&(N.map=t[3]),r=new We({props:N}),J.push(()=>X(r,"map",y)),{c(){e=W("div"),l=W("div"),s.c(),_=q(),p=W("div"),B(r.$$.fragment),this.h()},l(i){e=Y(i,"DIV",{style:!0});var u=Z(e);l=Y(u,"DIV",{style:!0});var C=Z(l);s.l(C),C.forEach(d),_=j(u),p=Y(u,"DIV",{style:!0});var F=Z(p);M(r.$$.fragment,F),F.forEach(d),u.forEach(d),this.h()},h(){x(l,"width","30%"),x(l,"overflow-y","scroll"),x(l,"padding","10px"),x(l,"border","1px solid black"),x(p,"position","relative"),x(p,"width","70%"),x(e,"display","flex"),x(e,"height","80vh")},m(i,u){I(i,e,u),z(e,l),h[n].m(l,null),z(e,_),z(e,p),G(r,p,null),g=!0,a||(S=ze(vt,"keydown",t[12]),a=!0)},p(i,u){let C=n;n=D(i),n===C?h[n].p(i,u):(ae(),L(h[C],1,1,()=>{h[C]=null}),re(),s=h[n],s?s.p(i,u):(s=h[n]=c[n](i),s.c()),w(s,1),s.m(l,null));const F={};u[0]&204|u[1]&128&&(F.$$scope={dirty:u,ctx:i}),!f&&u[0]&8&&(f=!0,F.map=i[3],Q(()=>f=!1)),r.$set(F)},i(i){g||(w(s),w(r.$$.fragment,i),g=!0)},o(i){L(s),L(r.$$.fragment,i),g=!1},d(i){i&&d(e),h[n].d(),V(r),a=!1,S()}}}function Vt(t,e,l){let n={type:"FeatureCollection",features:[]},s=e??l;if(s!=null){let _=s.kind=="critical"?t.criticalIssues:t.policyConflictLog;n.features.push(ke(_[s.idx].point))}return n}function ke(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Ae(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Fe(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function At(t,e,l){let n,s;we(t,R,k=>l(2,s=k));let _,p="critical",r=null,f=null,g=!1,a=!0;function S(k){l(0,r=k),l(1,f=null)}function c(k){if(!g){if(r!=null){l(0,r=null);return}p=="critical"?(Se(R,s.criticalIssues=[...s.criticalIssues,{criticalIssue:"",stage:"",point:k.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),l(0,r={kind:"critical",idx:s.criticalIssues.length-1})):(Se(R,s.policyConflictLog=[...s.policyConflictLog,{conflict:"",stage:"",point:k.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),l(0,r={kind:"conflict",idx:s.policyConflictLog.length-1})),l(1,f=null)}}He(()=>{D(!1)});function h(){window.confirm("Delete this entry?")&&(r.kind=="critical"?(s.criticalIssues.splice(r.idx,1),R.set(s)):(s.policyConflictLog.splice(r.idx,1),R.set(s)),l(0,r=null))}function D(k){let o={type:"FeatureCollection",features:[...s.criticalIssues.map(v=>ke(v.point)),...s.policyConflictLog.map(v=>ke(v.point)),...s.summary.networkMap.features]};o.features.length>0&&_.fitBounds(Ze(o),{padding:20,animate:k})}function y(k){r!=null&&k.key=="Escape"?(k.stopPropagation(),l(0,r=null)):r!=null&&k.key=="Delete"&&h()}const N=()=>D(!0);function i(k){g=k,l(5,g)}function u(k){a=k,l(6,a)}function C(k){p=k,l(4,p)}const F=k=>S({kind:"critical",idx:k}),O=k=>l(1,f={kind:"critical",idx:k}),$=()=>l(1,f=null),K=k=>S({kind:"conflict",idx:k}),P=k=>l(1,f={kind:"conflict",idx:k}),A=()=>l(1,f=null),oe=()=>l(0,r=null);function m(k,o){t.$$.not_equal(o.point,k)&&(o.point=k,R.set(s))}const b=k=>S({kind:"critical",idx:k}),T=k=>S({kind:"critical",idx:k});function H(k,o){t.$$.not_equal(o.point,k)&&(o.point=k,R.set(s))}const E=k=>S({kind:"conflict",idx:k}),ee=k=>S({kind:"conflict",idx:k});function fe(k){_=k,l(3,_)}return t.$$.update=()=>{t.$$.dirty[0]&7&&l(7,n=Vt(s,r,f))},[r,f,s,_,p,g,a,n,S,c,h,D,y,N,i,u,C,F,O,$,K,P,A,oe,m,b,T,H,E,ee,fe]}class xt extends ye{constructor(e){super(),Ie(this,e,At,Gt,Ce,{},null,[-1,-1])}}export{xt as component};
