import{s as we,a as L,g as S,i as D,f as g,T as Ce,e as k,c as y,q as N,y as be,r as Le,p as K,n as le,l as Se,b as R,v as ke,h,u as Ee,m as Te,o as Ae,t as ne,d as re,j as ie,E as me,U as ee,H as De,V as He}from"./scheduler.BFB7ZLp4.js";import{S as ye,i as xe,c as X,a as O,m as U,t as A,b as M,d as z,g as ae,f as fe}from"./index.D7s828ig.js";import{e as de}from"./each.Ep5bqd0c.js";import{b as oe}from"./paths.D3ceBo7o.js";import{d as Me}from"./index.As24oziD.js";import{S as Be,A as je}from"./ServiceHeader.BH9RFhas.js";import{F as Re}from"./FileInput.HY9ekttb.js";import"./index.CmTRRPYN.js";import{S as Ie}from"./SecondaryButton.CcNwBo7g.js";import{W as Ve}from"./WarningButton.DOBOxR2N.js";import{a as Fe}from"./index.DqAhxkMA.js";import{F as Ye}from"./FormElement.CCU6qONY.js";import{W as Ne}from"./WarningText.DP3B6kE0.js";import{L as Ge}from"./Loading.BNd92ME-.js";import{g as _e}from"./entry.CYjhM5nE.js";function Pe(o){let e,l=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,t,s,n=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=k("p"),e.innerHTML=l,t=L(),s=k("ul"),s.innerHTML=n},l(r){e=y(r,"P",{"data-svelte-h":!0}),K(e)!=="svelte-1ykh4hv"&&(e.innerHTML=l),t=S(r),s=y(r,"UL",{"data-svelte-h":!0}),K(s)!=="svelte-1tt4pqo"&&(s.innerHTML=n)},m(r,f){D(r,e,f),D(r,t,f),D(r,s,f)},p:le,d(r){r&&(g(e),g(t),g(s))}}}function We(o){let e,l,t,s,n,r;return t=new Ne({props:{$$slots:{default:[Pe]},$$scope:{ctx:o}}}),{c(){e=k("input"),l=L(),X(t.$$.fragment),this.h()},l(f){e=y(f,"INPUT",{class:!0,id:!0,type:!0}),l=S(f),O(t.$$.fragment,f),this.h()},h(){N(e,"class","govuk-file-upload"),N(e,"id","import-xlsx"),N(e,"type","file")},m(f,d){D(f,e,d),o[4](e),D(f,l,d),U(t,f,d),s=!0,n||(r=be(e,"change",o[2]),n=!0)},p(f,d){const _={};d&64&&(_.$$scope={dirty:d,ctx:f}),t.$set(_)},i(f){s||(A(t.$$.fragment,f),s=!0)},o(f){M(t.$$.fragment,f),s=!1},d(f){f&&(g(e),g(l)),o[4](null),z(t,f),n=!1,r()}}}function qe(o){let e,l,t,s;return e=new Ye({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[We]},$$scope:{ctx:o}}}),t=new Ge({props:{loading:o[0]}}),{c(){X(e.$$.fragment),l=L(),X(t.$$.fragment)},l(n){O(e.$$.fragment,n),l=S(n),O(t.$$.fragment,n)},m(n,r){U(e,n,r),D(n,l,r),U(t,n,r),s=!0},p(n,[r]){const f={};r&66&&(f.$$scope={dirty:r,ctx:n}),e.$set(f);const d={};r&1&&(d.loading=n[0]),t.$set(d)},i(n){s||(A(e.$$.fragment,n),A(t.$$.fragment,n),s=!0)},o(n){M(e.$$.fragment,n),M(t.$$.fragment,n),s=!1},d(n){n&&g(l),z(e,n),z(t,n)}}}function Je(o,e,l){let t=Ce(),{xlsxImporter:s}=e,n="",r;async function f(_){let p=r.files[0].name;try{l(0,n=`Loading ${p}`);let i=await r.files[0].arrayBuffer(),w=await s(i);l(0,n=""),t("imported",{filename:Fe(p,".xlsx"),data:w})}catch(i){window.alert(`Couldn't import ${p}: ${i}`),l(0,n="")}}function d(_){Le[_?"unshift":"push"](()=>{r=_,l(1,r)})}return o.$$set=_=>{"xlsxImporter"in _&&l(3,s=_.xlsxImporter)},[n,r,f,s,d]}class Xe extends ye{constructor(e){super(),xe(this,e,Je,qe,we,{xlsxImporter:3})}}function pe(o,e,l){const t=o.slice();return t[19]=e[l],t}const Oe=o=>({}),he=o=>({});function ge(o){let e,l,t="You are editing:",s,n,r,f;return{c(){e=k("p"),l=k("b"),l.textContent=t,s=L(),n=k("a"),r=ne(o[6]),this.h()},l(d){e=y(d,"P",{});var _=R(e);l=y(_,"B",{"data-svelte-h":!0}),K(l)!=="svelte-1kt2tqj"&&(l.textContent=t),s=S(_),n=y(_,"A",{href:!0});var p=R(n);r=re(p,o[6]),p.forEach(g),_.forEach(g),this.h()},h(){N(n,"href",f=`${oe}/${o[0].prefix}overview`)},m(d,_){D(d,e,_),h(e,l),h(e,s),h(e,n),h(n,r)},p(d,_){_&64&&ie(r,d[6]),_&1&&f!==(f=`${oe}/${d[0].prefix}overview`)&&N(n,"href",f)},d(d){d&&g(e)}}}function Ue(o){let e,l="No saved files";return{c(){e=k("p"),e.textContent=l},l(t){e=y(t,"P",{"data-svelte-h":!0}),K(e)!=="svelte-yojds1"&&(e.textContent=l)},m(t,s){D(t,e,s)},p:le,i:le,o:le,d(t){t&&g(e)}}}function ze(o){let e,l="Manage existing files",t,s,n,r="<tr><th>File name</th> <th>Scheme name</th> <th>Action</th></tr>",f,d,_,p=de(o[5]),i=[];for(let u=0;u<p.length;u+=1)i[u]=$e(pe(o,p,u));const w=u=>M(i[u],1,1,()=>{i[u]=null});return{c(){e=k("h2"),e.textContent=l,t=L(),s=k("table"),n=k("thead"),n.innerHTML=r,f=L(),d=k("tbody");for(let u=0;u<i.length;u+=1)i[u].c()},l(u){e=y(u,"H2",{"data-svelte-h":!0}),K(e)!=="svelte-1d50rjn"&&(e.textContent=l),t=S(u),s=y(u,"TABLE",{});var $=R(s);n=y($,"THEAD",{"data-svelte-h":!0}),K(n)!=="svelte-gvkk9f"&&(n.innerHTML=r),f=S($),d=y($,"TBODY",{});var m=R(d);for(let v=0;v<i.length;v+=1)i[v].l(m);m.forEach(g),$.forEach(g)},m(u,$){D(u,e,$),D(u,t,$),D(u,s,$),h(s,n),h(s,f),h(s,d);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(d,null);_=!0},p(u,$){if($&4513){p=de(u[5]);let m;for(m=0;m<p.length;m+=1){const v=pe(u,p,m);i[m]?(i[m].p(v,$),A(i[m],1)):(i[m]=$e(v),i[m].c(),A(i[m],1),i[m].m(d,null))}for(ae(),m=p.length;m<i.length;m+=1)w(m);fe()}},i(u){if(!_){for(let $=0;$<p.length;$+=1)A(i[$]);_=!0}},o(u){i=i.filter(Boolean);for(let $=0;$<i.length;$+=1)M(i[$]);_=!1},d(u){u&&(g(e),g(t),g(s)),De(i,u)}}}function Ke(o){let e;return{c(){e=ne("Rename")},l(l){e=re(l,"Rename")},m(l,t){D(l,e,t)},d(l){l&&g(e)}}}function Qe(o){let e;return{c(){e=ne("Delete")},l(l){e=re(l,"Delete")},m(l,t){D(l,e,t)},d(l){l&&g(e)}}}function $e(o){let e,l,t,s=o[19]+"",n,r,f,d=o[0].describeFile(o[19])+"",_,p,i,w,u,$,m,v,I,q,E;function P(){return o[14](o[19])}function te(){return o[15](o[19])}u=new Ie({props:{$$slots:{default:[Ke]},$$scope:{ctx:o}}}),u.$on("click",te);function J(){return o[16](o[19])}return m=new Ve({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),m.$on("click",J),{c(){e=k("tr"),l=k("td"),t=k("a"),n=ne(s),r=L(),f=k("td"),_=ne(d),p=L(),i=k("td"),w=k("div"),X(u.$$.fragment),$=L(),X(m.$$.fragment),v=L(),this.h()},l(x){e=y(x,"TR",{});var F=R(e);l=y(F,"TD",{});var W=R(l);t=y(W,"A",{href:!0});var a=R(t);n=re(a,s),a.forEach(g),W.forEach(g),r=S(F),f=y(F,"TD",{});var b=R(f);_=re(b,d),b.forEach(g),p=S(F),i=y(F,"TD",{});var j=R(i);w=y(j,"DIV",{class:!0,style:!0});var H=R(w);O(u.$$.fragment,H),$=S(H),O(m.$$.fragment,H),H.forEach(g),j.forEach(g),v=S(F),F.forEach(g),this.h()},h(){N(t,"href","#"),N(w,"class","govuk-button-group"),ke(w,"flex-wrap","nowrap")},m(x,F){D(x,e,F),h(e,l),h(l,t),h(t,n),h(e,r),h(e,f),h(f,_),h(e,p),h(e,i),h(i,w),U(u,w,null),h(w,$),U(m,w,null),h(e,v),I=!0,q||(E=be(t,"click",He(P)),q=!0)},p(x,F){o=x,(!I||F&32)&&s!==(s=o[19]+"")&&ie(n,s),(!I||F&33)&&d!==(d=o[0].describeFile(o[19])+"")&&ie(_,d);const W={};F&131072&&(W.$$scope={dirty:F,ctx:o}),u.$set(W);const a={};F&131072&&(a.$$scope={dirty:F,ctx:o}),m.$set(a)},i(x){I||(A(u.$$.fragment,x),A(m.$$.fragment,x),I=!0)},o(x){M(u.$$.fragment,x),M(m.$$.fragment,x),I=!1},d(x){x&&g(e),z(u),z(m),q=!1,E()}}}function Ze(o){let e;return{c(){e=ne("New blank scheme file")},l(l){e=re(l,"New blank scheme file")},m(l,t){D(l,e,t)},d(l){l&&g(e)}}}function ve(o){let e,l,t,s;return t=new Xe({props:{xlsxImporter:o[4]}}),t.$on("imported",o[11]),{c(){e=k("hr"),l=L(),X(t.$$.fragment)},l(n){e=y(n,"HR",{}),l=S(n),O(t.$$.fragment,n)},m(n,r){D(n,e,r),D(n,l,r),U(t,n,r),s=!0},p(n,r){const f={};r&16&&(f.xlsxImporter=n[4]),t.$set(f)},i(n){s||(A(t.$$.fragment,n),s=!0)},o(n){M(t.$$.fragment,n),s=!1},d(n){n&&(g(e),g(l)),z(t,n)}}}function et(o){let e,l,t,s,n,r,f="Manage my schemes",d,_,p,i,w,u=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,$,m,v,I,q,E,P,te="Create or import a file",J,x,F,W,a,b,j,H;e=new Be({props:{service:o[3]}}),s=new je({});const se=o[13].description,V=Se(se,o,o[17],he);let B=o[6]&&ge(o);const ue=[ze,Ue],Q=[];function ce(c,C){return c[5].length>0?0:1}v=ce(o),I=Q[v]=ue[v](o),x=new Ie({props:{$$slots:{default:[Ze]},$$scope:{ctx:o}}}),x.$on("click",o[9]),b=new Re({props:{label:"Import from a .json file",onLoad:o[10]}});let T=o[4]!=null&&ve(o);return{c(){X(e.$$.fragment),l=L(),t=k("div"),X(s.$$.fragment),n=L(),r=k("div"),r.textContent=f,d=L(),_=k("div"),p=k("div"),V&&V.c(),i=L(),w=k("p"),w.textContent=u,$=L(),B&&B.c(),m=L(),I.c(),q=L(),E=k("div"),P=k("h2"),P.textContent=te,J=L(),X(x.$$.fragment),F=L(),W=k("hr"),a=L(),X(b.$$.fragment),j=L(),T&&T.c(),this.h()},l(c){O(e.$$.fragment,c),l=S(c),t=y(c,"DIV",{class:!0});var C=R(t);O(s.$$.fragment,C),n=S(C),r=y(C,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),K(r)!=="svelte-dvm3f7"&&(r.textContent=f),d=S(C),_=y(C,"DIV",{class:!0});var Z=R(_);p=y(Z,"DIV",{class:!0});var G=R(p);V&&V.l(G),i=S(G),w=y(G,"P",{"data-svelte-h":!0}),K(w)!=="svelte-wkz669"&&(w.textContent=u),$=S(G),B&&B.l(G),m=S(G),I.l(G),G.forEach(g),q=S(Z),E=y(Z,"DIV",{class:!0});var Y=R(E);P=y(Y,"H2",{class:!0,"data-svelte-h":!0}),K(P)!=="svelte-hifbpd"&&(P.textContent=te),J=S(Y),O(x.$$.fragment,Y),F=S(Y),W=y(Y,"HR",{}),a=S(Y),O(b.$$.fragment,Y),j=S(Y),T&&T.l(Y),Y.forEach(g),Z.forEach(g),C.forEach(g),this.h()},h(){N(r,"class","govuk-heading-l"),ke(r,"margin-top","30px"),N(p,"class","govuk-grid-column-two-thirds"),N(P,"class","green-bar svelte-1z050ke"),N(E,"class","govuk-grid-column-one-third"),N(_,"class","govuk-grid-row"),N(t,"class","govuk-width-container")},m(c,C){U(e,c,C),D(c,l,C),D(c,t,C),U(s,t,null),h(t,n),h(t,r),h(t,d),h(t,_),h(_,p),V&&V.m(p,null),h(p,i),h(p,w),h(p,$),B&&B.m(p,null),h(p,m),Q[v].m(p,null),h(_,q),h(_,E),h(E,P),h(E,J),U(x,E,null),h(E,F),h(E,W),h(E,a),U(b,E,null),h(E,j),T&&T.m(E,null),H=!0},p(c,[C]){const Z={};C&8&&(Z.service=c[3]),e.$set(Z),V&&V.p&&(!H||C&131072)&&Ee(V,se,c,c[17],H?Ae(se,c[17],C,Oe):Te(c[17]),he),c[6]?B?B.p(c,C):(B=ge(c),B.c(),B.m(p,m)):B&&(B.d(1),B=null);let G=v;v=ce(c),v===G?Q[v].p(c,C):(ae(),M(Q[G],1,1,()=>{Q[G]=null}),fe(),I=Q[v],I?I.p(c,C):(I=Q[v]=ue[v](c),I.c()),A(I,1),I.m(p,null));const Y={};C&131072&&(Y.$$scope={dirty:C,ctx:c}),x.$set(Y),c[4]!=null?T?(T.p(c,C),C&16&&A(T,1)):(T=ve(c),T.c(),A(T,1),T.m(E,null)):T&&(ae(),M(T,1,1,()=>{T=null}),fe())},i(c){H||(A(e.$$.fragment,c),A(s.$$.fragment,c),A(V,c),A(I),A(x.$$.fragment,c),A(b.$$.fragment,c),A(T),H=!0)},o(c){M(e.$$.fragment,c),M(s.$$.fragment,c),M(V,c),M(I),M(x.$$.fragment,c),M(b.$$.fragment,c),M(T),H=!1},d(c){c&&(g(l),g(t)),z(e,c),z(s),V&&V.d(c),B&&B.d(),Q[v].d(),z(x),z(b),T&&T.d()}}}function tt(o,e,l){let t,s=le,n=()=>(s(),s=me(u,a=>l(18,t=a)),u),r,f=le,d=()=>(f(),f=me(w,a=>l(6,r=a)),w);o.$$.on_destroy.push(()=>s()),o.$$.on_destroy.push(()=>f());let{$$slots:_={},$$scope:p}=e,{files:i}=e,{currentFile:w}=e;d();let{state:u}=e;n();let{service:$}=e,{xlsxImporter:m=null}=e,v=i.getFileList();function I(a){let b=window.prompt(`Rename file ${a} to what?`,a);if(b){let j=i.key(a),H=window.localStorage.getItem(j);window.localStorage.setItem(i.key(b),H),window.localStorage.removeItem(j),l(5,v=i.getFileList()),r==a&&ee(w,r=b,r)}}function q(a){if(!window.confirm(`Really delete file ${a}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let b=i.key(a);Me(`${a}.json`,window.localStorage.getItem(b)),window.localStorage.removeItem(b),r==a&&(ee(w,r="",r),ee(u,t=i.emptyState(),t),window.localStorage.setItem(i.key("last-opened-file"),"")),l(5,v=i.getFileList())}function E(){let a=window.prompt("What do you want to name your new file?");a&&(ee(w,r=a,r),ee(u,t=i.emptyState(),t),l(5,v=i.saveAndGetFileList(r,t)),_e(`${oe}/${i.prefix}overview`))}function P(a,b){let j=Fe(a,".json");try{let H=JSON.parse(b);i.validate(H),l(5,v=i.saveAndGetFileList(j,H)),J(j)}catch(H){window.alert(`Couldn't load ${j}: ${H}`)}}function te(a){let{filename:b,data:j}=a.detail;l(5,v=i.saveAndGetFileList(b,j)),J(b)}function J(a){try{let b=i.loadFile(a);ee(w,r=a,r),ee(u,t=b,t),_e(`${oe}/${i.prefix}overview`)}catch(b){window.alert(`Couldn't load ${a}: ${b}`)}return!1}const x=a=>J(a),F=a=>I(a),W=a=>q(a);return o.$$set=a=>{"files"in a&&l(0,i=a.files),"currentFile"in a&&d(l(1,w=a.currentFile)),"state"in a&&n(l(2,u=a.state)),"service"in a&&l(3,$=a.service),"xlsxImporter"in a&&l(4,m=a.xlsxImporter),"$$scope"in a&&l(17,p=a.$$scope)},[i,w,u,$,m,v,r,I,q,E,P,te,J,_,x,F,W,p]}class gt extends ye{constructor(e){super(),xe(this,e,tt,et,we,{files:0,currentFile:1,state:2,service:3,xlsxImporter:4})}}export{gt as F};
