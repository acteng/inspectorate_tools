import{s as ve,a as F,g as L,i as A,f as $,T as Ie,e as b,c as k,q as N,y as we,r as Fe,p as X,n as ee,l as Le,b as V,v as Se,h,u as Te,m as Ee,o as Ae,t as ne,d as re,j as be,E as ce,U as Z,H as De,V as He}from"./scheduler.BFB7ZLp4.js";import{S as ke,i as xe,c as P,a as W,m as q,t as E,b as D,d as J,g as ie,f as ae}from"./index.D7s828ig.js";import{e as me}from"./each.Ep5bqd0c.js";import{b as oe}from"./paths.BDjmSL3I.js";import{d as Be}from"./index.PIjCHyCB.js";import{S as Me,A as je}from"./ServiceHeader.De8dfCMv.js";import{B as Re}from"./ButtonGroup.dxNFISyL.js";import{F as Ye}from"./FileInput.D7S-l8il.js";import"./index.DH7agslg.js";import{S as ye}from"./SecondaryButton.CcNwBo7g.js";import{W as Ge}from"./WarningButton.DOBOxR2N.js";import{a as Ce}from"./index.CH3_60-w.js";import{F as Ne}from"./FormElement.CCU6qONY.js";import{W as Ve}from"./WarningText.DP3B6kE0.js";import{L as Oe}from"./Loading.DwJoEtY2.js";import{g as de}from"./entry.DFJj4aTE.js";function Pe(s){let e,l=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
      . After importing, there will still be some problems:`,t,i,n=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=b("p"),e.innerHTML=l,t=F(),i=b("ul"),i.innerHTML=n},l(o){e=k(o,"P",{"data-svelte-h":!0}),X(e)!=="svelte-1ykh4hv"&&(e.innerHTML=l),t=L(o),i=k(o,"UL",{"data-svelte-h":!0}),X(i)!=="svelte-1tt4pqo"&&(i.innerHTML=n)},m(o,r){A(o,e,r),A(o,t,r),A(o,i,r)},p:ee,d(o){o&&($(e),$(t),$(i))}}}function We(s){let e,l,t,i,n,o;return t=new Ve({props:{$$slots:{default:[Pe]},$$scope:{ctx:s}}}),{c(){e=b("input"),l=F(),P(t.$$.fragment),this.h()},l(r){e=k(r,"INPUT",{class:!0,id:!0,type:!0}),l=L(r),W(t.$$.fragment,r),this.h()},h(){N(e,"class","govuk-file-upload"),N(e,"id","import-xlsx"),N(e,"type","file")},m(r,u){A(r,e,u),s[4](e),A(r,l,u),q(t,r,u),i=!0,n||(o=we(e,"change",s[2]),n=!0)},p(r,u){const m={};u&64&&(m.$$scope={dirty:u,ctx:r}),t.$set(m)},i(r){i||(E(t.$$.fragment,r),i=!0)},o(r){D(t.$$.fragment,r),i=!1},d(r){r&&($(e),$(l)),s[4](null),J(t,r),n=!1,o()}}}function qe(s){let e,l,t,i;return e=new Ne({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[We]},$$scope:{ctx:s}}}),t=new Oe({props:{loading:s[0]}}),{c(){P(e.$$.fragment),l=F(),P(t.$$.fragment)},l(n){W(e.$$.fragment,n),l=L(n),W(t.$$.fragment,n)},m(n,o){q(e,n,o),A(n,l,o),q(t,n,o),i=!0},p(n,[o]){const r={};o&66&&(r.$$scope={dirty:o,ctx:n}),e.$set(r);const u={};o&1&&(u.loading=n[0]),t.$set(u)},i(n){i||(E(e.$$.fragment,n),E(t.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),D(t.$$.fragment,n),i=!1},d(n){n&&$(l),J(e,n),J(t,n)}}}function Je(s,e,l){let t=Ie(),{xlsxImporter:i}=e,n="",o;async function r(m){let p=o.files[0].name;try{l(0,n=`Loading ${p}`);let a=await o.files[0].arrayBuffer(),x=await i(a);l(0,n=""),t("imported",{filename:Ce(p,".xlsx"),data:x})}catch(a){window.alert(`Couldn't import ${p}: ${a}`),l(0,n="")}}function u(m){Fe[m?"unshift":"push"](()=>{o=m,l(1,o)})}return s.$$set=m=>{"xlsxImporter"in m&&l(3,i=m.xlsxImporter)},[n,o,r,i,u]}class Xe extends ke{constructor(e){super(),xe(this,e,Je,qe,ve,{xlsxImporter:3})}}function pe(s,e,l){const t=s.slice();return t[19]=e[l],t}const Ue=s=>({}),_e=s=>({});function he(s){let e,l,t="You are editing:",i,n,o,r;return{c(){e=b("p"),l=b("b"),l.textContent=t,i=F(),n=b("a"),o=ne(s[6]),this.h()},l(u){e=k(u,"P",{});var m=V(e);l=k(m,"B",{"data-svelte-h":!0}),X(l)!=="svelte-1kt2tqj"&&(l.textContent=t),i=L(m),n=k(m,"A",{href:!0});var p=V(n);o=re(p,s[6]),p.forEach($),m.forEach($),this.h()},h(){N(n,"href",r=`${oe}/${s[0].prefix}overview`)},m(u,m){A(u,e,m),h(e,l),h(e,i),h(e,n),h(n,o)},p(u,m){m&64&&be(o,u[6]),m&1&&r!==(r=`${oe}/${u[0].prefix}overview`)&&N(n,"href",r)},d(u){u&&$(e)}}}function ze(s){let e,l="No saved files";return{c(){e=b("p"),e.textContent=l},l(t){e=k(t,"P",{"data-svelte-h":!0}),X(e)!=="svelte-yojds1"&&(e.textContent=l)},m(t,i){A(t,e,i)},p:ee,i:ee,o:ee,d(t){t&&$(e)}}}function Ke(s){let e,l="Manage existing files",t,i,n,o='<tr><th>File name</th> <th>Scheme name</th> <th class="govuk-!-width-one-half">Action</th></tr>',r,u,m,p=me(s[5]),a=[];for(let c=0;c<p.length;c+=1)a[c]=$e(pe(s,p,c));const x=c=>D(a[c],1,1,()=>{a[c]=null});return{c(){e=b("h2"),e.textContent=l,t=F(),i=b("table"),n=b("thead"),n.innerHTML=o,r=F(),u=b("tbody");for(let c=0;c<a.length;c+=1)a[c].c()},l(c){e=k(c,"H2",{"data-svelte-h":!0}),X(e)!=="svelte-1d50rjn"&&(e.textContent=l),t=L(c),i=k(c,"TABLE",{});var g=V(i);n=k(g,"THEAD",{"data-svelte-h":!0}),X(n)!=="svelte-1wkcyrm"&&(n.innerHTML=o),r=L(g),u=k(g,"TBODY",{});var _=V(u);for(let v=0;v<a.length;v+=1)a[v].l(_);_.forEach($),g.forEach($)},m(c,g){A(c,e,g),A(c,t,g),A(c,i,g),h(i,n),h(i,r),h(i,u);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(u,null);m=!0},p(c,g){if(g&4512){p=me(c[5]);let _;for(_=0;_<p.length;_+=1){const v=pe(c,p,_);a[_]?(a[_].p(v,g),E(a[_],1)):(a[_]=$e(v),a[_].c(),E(a[_],1),a[_].m(u,null))}for(ie(),_=p.length;_<a.length;_+=1)x(_);ae()}},i(c){if(!m){for(let g=0;g<p.length;g+=1)E(a[g]);m=!0}},o(c){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)D(a[g]);m=!1},d(c){c&&($(e),$(t),$(i)),De(a,c)}}}function Qe(s){let e;return{c(){e=ne("Rename")},l(l){e=re(l,"Rename")},m(l,t){A(l,e,t)},d(l){l&&$(e)}}}function Ze(s){let e;return{c(){e=ne("Delete")},l(l){e=re(l,"Delete")},m(l,t){A(l,e,t)},d(l){l&&$(e)}}}function et(s){let e,l,t,i;function n(){return s[15](s[19])}e=new ye({props:{$$slots:{default:[Qe]},$$scope:{ctx:s}}}),e.$on("click",n);function o(){return s[16](s[19])}return t=new Ge({props:{$$slots:{default:[Ze]},$$scope:{ctx:s}}}),t.$on("click",o),{c(){P(e.$$.fragment),l=F(),P(t.$$.fragment)},l(r){W(e.$$.fragment,r),l=L(r),W(t.$$.fragment,r)},m(r,u){q(e,r,u),A(r,l,u),q(t,r,u),i=!0},p(r,u){s=r;const m={};u&131072&&(m.$$scope={dirty:u,ctx:s}),e.$set(m);const p={};u&131072&&(p.$$scope={dirty:u,ctx:s}),t.$set(p)},i(r){i||(E(e.$$.fragment,r),E(t.$$.fragment,r),i=!0)},o(r){D(e.$$.fragment,r),D(t.$$.fragment,r),i=!1},d(r){r&&$(l),J(e,r),J(t,r)}}}function $e(s){let e,l,t,i=s[19]+"",n,o,r,u="TODO",m,p,a,x,c,g,_;function v(){return s[14](s[19])}return a=new Re({props:{$$slots:{default:[et]},$$scope:{ctx:s}}}),{c(){e=b("tr"),l=b("td"),t=b("a"),n=ne(i),o=F(),r=b("td"),r.textContent=u,m=F(),p=b("td"),P(a.$$.fragment),x=F(),this.h()},l(w){e=k(w,"TR",{});var S=V(e);l=k(S,"TD",{});var y=V(l);t=k(y,"A",{href:!0});var R=V(t);n=re(R,i),R.forEach($),y.forEach($),o=L(S),r=k(S,"TD",{"data-svelte-h":!0}),X(r)!=="svelte-1mugsmu"&&(r.textContent=u),m=L(S),p=k(S,"TD",{});var K=V(p);W(a.$$.fragment,K),K.forEach($),x=L(S),S.forEach($),this.h()},h(){N(t,"href","#")},m(w,S){A(w,e,S),h(e,l),h(l,t),h(t,n),h(e,o),h(e,r),h(e,m),h(e,p),q(a,p,null),h(e,x),c=!0,g||(_=we(t,"click",He(v)),g=!0)},p(w,S){s=w,(!c||S&32)&&i!==(i=s[19]+"")&&be(n,i);const y={};S&131104&&(y.$$scope={dirty:S,ctx:s}),a.$set(y)},i(w){c||(E(a.$$.fragment,w),c=!0)},o(w){D(a.$$.fragment,w),c=!1},d(w){w&&$(e),J(a),g=!1,_()}}}function tt(s){let e;return{c(){e=ne("New blank file")},l(l){e=re(l,"New blank file")},m(l,t){A(l,e,t)},d(l){l&&$(e)}}}function ge(s){let e,l,t,i;return t=new Xe({props:{xlsxImporter:s[4]}}),t.$on("imported",s[11]),{c(){e=b("hr"),l=F(),P(t.$$.fragment)},l(n){e=k(n,"HR",{}),l=L(n),W(t.$$.fragment,n)},m(n,o){A(n,e,o),A(n,l,o),q(t,n,o),i=!0},p(n,o){const r={};o&16&&(r.xlsxImporter=n[4]),t.$set(r)},i(n){i||(E(t.$$.fragment,n),i=!0)},o(n){D(t.$$.fragment,n),i=!1},d(n){n&&($(e),$(l)),J(t,n)}}}function lt(s){let e,l,t,i,n,o,r="Manage my schemes",u,m,p,a,x,c=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,g,_,v,w,S,y,R,K="Create or import a file",U,O,te,le,f,C,Y,B;e=new Me({props:{service:s[3]}}),i=new je({});const se=s[13].description,M=Le(se,s,s[17],_e);let H=s[6]&&he(s);const fe=[Ke,ze],z=[];function ue(d,I){return d[5].length>0?0:1}v=ue(s),w=z[v]=fe[v](s),O=new ye({props:{$$slots:{default:[tt]},$$scope:{ctx:s}}}),O.$on("click",s[9]),C=new Ye({props:{label:"Import from a .json file",onLoad:s[10]}});let T=s[4]!=null&&ge(s);return{c(){P(e.$$.fragment),l=F(),t=b("div"),P(i.$$.fragment),n=F(),o=b("div"),o.textContent=r,u=F(),m=b("div"),p=b("div"),M&&M.c(),a=F(),x=b("p"),x.textContent=c,g=F(),H&&H.c(),_=F(),w.c(),S=F(),y=b("div"),R=b("h2"),R.textContent=K,U=F(),P(O.$$.fragment),te=F(),le=b("hr"),f=F(),P(C.$$.fragment),Y=F(),T&&T.c(),this.h()},l(d){W(e.$$.fragment,d),l=L(d),t=k(d,"DIV",{class:!0});var I=V(t);W(i.$$.fragment,I),n=L(I),o=k(I,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),X(o)!=="svelte-dvm3f7"&&(o.textContent=r),u=L(I),m=k(I,"DIV",{class:!0});var Q=V(m);p=k(Q,"DIV",{class:!0});var G=V(p);M&&M.l(G),a=L(G),x=k(G,"P",{"data-svelte-h":!0}),X(x)!=="svelte-wkz669"&&(x.textContent=c),g=L(G),H&&H.l(G),_=L(G),w.l(G),G.forEach($),S=L(Q),y=k(Q,"DIV",{class:!0});var j=V(y);R=k(j,"H2",{class:!0,"data-svelte-h":!0}),X(R)!=="svelte-hifbpd"&&(R.textContent=K),U=L(j),W(O.$$.fragment,j),te=L(j),le=k(j,"HR",{}),f=L(j),W(C.$$.fragment,j),Y=L(j),T&&T.l(j),j.forEach($),Q.forEach($),I.forEach($),this.h()},h(){N(o,"class","govuk-heading-l"),Se(o,"margin-top","30px"),N(p,"class","govuk-grid-column-two-thirds"),N(R,"class","green-bar svelte-1z050ke"),N(y,"class","govuk-grid-column-one-third"),N(m,"class","govuk-grid-row"),N(t,"class","govuk-width-container")},m(d,I){q(e,d,I),A(d,l,I),A(d,t,I),q(i,t,null),h(t,n),h(t,o),h(t,u),h(t,m),h(m,p),M&&M.m(p,null),h(p,a),h(p,x),h(p,g),H&&H.m(p,null),h(p,_),z[v].m(p,null),h(m,S),h(m,y),h(y,R),h(y,U),q(O,y,null),h(y,te),h(y,le),h(y,f),q(C,y,null),h(y,Y),T&&T.m(y,null),B=!0},p(d,[I]){const Q={};I&8&&(Q.service=d[3]),e.$set(Q),M&&M.p&&(!B||I&131072)&&Te(M,se,d,d[17],B?Ae(se,d[17],I,Ue):Ee(d[17]),_e),d[6]?H?H.p(d,I):(H=he(d),H.c(),H.m(p,_)):H&&(H.d(1),H=null);let G=v;v=ue(d),v===G?z[v].p(d,I):(ie(),D(z[G],1,1,()=>{z[G]=null}),ae(),w=z[v],w?w.p(d,I):(w=z[v]=fe[v](d),w.c()),E(w,1),w.m(p,null));const j={};I&131072&&(j.$$scope={dirty:I,ctx:d}),O.$set(j),d[4]!=null?T?(T.p(d,I),I&16&&E(T,1)):(T=ge(d),T.c(),E(T,1),T.m(y,null)):T&&(ie(),D(T,1,1,()=>{T=null}),ae())},i(d){B||(E(e.$$.fragment,d),E(i.$$.fragment,d),E(M,d),E(w),E(O.$$.fragment,d),E(C.$$.fragment,d),E(T),B=!0)},o(d){D(e.$$.fragment,d),D(i.$$.fragment,d),D(M,d),D(w),D(O.$$.fragment,d),D(C.$$.fragment,d),D(T),B=!1},d(d){d&&($(l),$(t)),J(e,d),J(i),M&&M.d(d),H&&H.d(),z[v].d(),J(O),J(C),T&&T.d()}}}function nt(s,e,l){let t,i=ee,n=()=>(i(),i=ce(c,f=>l(18,t=f)),c),o,r=ee,u=()=>(r(),r=ce(x,f=>l(6,o=f)),x);s.$$.on_destroy.push(()=>i()),s.$$.on_destroy.push(()=>r());let{$$slots:m={},$$scope:p}=e,{files:a}=e,{currentFile:x}=e;u();let{state:c}=e;n();let{service:g}=e,{xlsxImporter:_=null}=e,v=a.getFileList();function w(f){let C=window.prompt(`Rename file ${f} to what?`,f);if(C){let Y=a.key(f),B=window.localStorage.getItem(Y);window.localStorage.setItem(a.key(C),B),window.localStorage.removeItem(Y),l(5,v=a.getFileList()),o==f&&Z(x,o=C,o)}}function S(f){if(!window.confirm(`Really delete file ${f}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let C=a.key(f);Be(`${f}.json`,window.localStorage.getItem(C)),window.localStorage.removeItem(C),o==f&&(Z(x,o="",o),Z(c,t=a.emptyState(),t),window.localStorage.setItem(a.key("last-opened-file"),"")),l(5,v=a.getFileList())}function y(){let f=window.prompt("What do you want to name your new file?");f&&(Z(x,o=f,o),Z(c,t=a.emptyState(),t),l(5,v=a.saveAndGetFileList(o,t)),de(`${oe}/${a.prefix}overview`))}function R(f,C){let Y=Ce(f,".json");try{let B=JSON.parse(C);a.validate(B),l(5,v=a.saveAndGetFileList(Y,B)),U(Y)}catch(B){window.alert(`Couldn't load ${Y}: ${B}`)}}function K(f){let{filename:C,data:Y}=f.detail;l(5,v=a.saveAndGetFileList(C,Y)),U(C)}function U(f){try{let C=a.loadFile(f);Z(x,o=f,o),Z(c,t=C,t),de(`${oe}/${a.prefix}overview`)}catch(C){window.alert(`Couldn't load ${f}: ${C}`)}return!1}const O=f=>U(f),te=f=>w(f),le=f=>S(f);return s.$$set=f=>{"files"in f&&l(0,a=f.files),"currentFile"in f&&u(l(1,x=f.currentFile)),"state"in f&&n(l(2,c=f.state)),"service"in f&&l(3,g=f.service),"xlsxImporter"in f&&l(4,_=f.xlsxImporter),"$$scope"in f&&l(17,p=f.$$scope)},[a,x,c,g,_,v,o,w,S,y,R,K,U,m,O,te,le,p]}class wt extends ke{constructor(e){super(),xe(this,e,nt,lt,ve,{files:0,currentFile:1,state:2,service:3,xlsxImporter:4})}}export{wt as F};
