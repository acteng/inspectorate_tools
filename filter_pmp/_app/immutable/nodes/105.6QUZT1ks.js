import{s as Ne,r as Y,e as O,t as H,a as A,c as U,b as F,d as J,f as m,g as R,q,v as z,i as w,h as P,w as X,k as he,y as dt,G as Ce,V as me,D as x,p as de,K as be,j as se,I as ht,O as pe,P as _e,n as bt}from"../chunks/scheduler.DGwhun8C.js";import{S as Se,i as Ee,e as Q,c as M,a as G,m as T,t as v,g as ne,b as I,f as ie,d as j}from"../chunks/index.B2vZYn3d.js";import{g as vt}from"../chunks/globals.D0QH3NT1.js";import{e as re}from"../chunks/each.osbS1YKp.js";import{p as De,c as Ye}from"../chunks/colors.DaC397qr.js";import{p as Xe}from"../chunks/index.tiwvFSw1.js";import{R as Qe}from"../chunks/Radio.BMj4v9XF.js";import"../chunks/index.BAvWG2ZG.js";import{S as xe}from"../chunks/Select.4aCLpv4f.js";import{T as et}from"../chunks/TextArea.CRZtJRKm.js";import{T as tt}from"../chunks/TextInput.BGFsOkhz.js";import{s as Z}from"../chunks/data.BUA7sNDH.js";import{l as ve,n as ke,M as kt,o as wt,G as Ct,b as yt,C as It}from"../chunks/index.DiXcAjFh.js";import{c as Lt,p as Nt,b as Pe,e as qe,f as St,g as Et}from"../chunks/lists.Bn2sGx3F.js";import{Y as lt}from"../chunks/YesNo.CgGwSC80.js";import{C as Dt}from"../chunks/CheckboxGroup.CWZjIqRp.js";import{B as Bt,C as Ie,M as nt}from"../chunks/Marker.X5vjwLGu.js";import{C as Pt}from"../chunks/CollapsibleCard.NCxe97a7.js";import{D as qt}from"../chunks/DefaultButton.Dnb4gInE.js";import{I as ye,p as At,G as Rt}from"../chunks/pan.wXfHOCjk.js";import{S as it}from"../chunks/SecondaryButton.zQkvdoBX.js";import{W as Vt}from"../chunks/WarningButton.B3j9Frnm.js";import{G as Mt,S as Gt,C as ot}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.Bb8wY5Xv.js";import"../chunks/index.1CLLF-kZ.js";import"../chunks/paths.DgMOkkjV.js";import{p as Tt}from"../chunks/stores.CfMg11LP.js";import"../chunks/entry.ujr3EEJj.js";import{R as jt}from"../chunks/RouteMapLayer.BasKMPvn.js";function Ae(i){let e,t,l;function n(s){i[5](s)}let o={label:"Resolved by Design",inlineSmall:!0};return i[1].criticalIssues[i[0]].resolved!==void 0&&(o.value=i[1].criticalIssues[i[0]].resolved),e=new lt({props:o}),Y.push(()=>Q(e,"value",n)),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,a){T(e,s,a),l=!0},p(s,a){const r={};!t&&a&3&&(t=!0,r.value=s[1].criticalIssues[s[0]].resolved,X(()=>t=!1)),e.$set(r)},i(s){l||(v(e.$$.fragment,s),l=!0)},o(s){I(e.$$.fragment,s),l=!1},d(s){j(e,s)}}}function Ft(i){let e,t,l,n,o,s,a,r,u,c,g,C,S,$,D,k,_,L,f,h,d,y;function N(p){i[2](p)}let W={label:"Critical Issue",emptyOption:!0,choices:Lt};i[1].criticalIssues[i[0]].criticalIssue!==void 0&&(W.value=i[1].criticalIssues[i[0]].criticalIssue),c=new xe({props:W}),Y.push(()=>Q(c,"value",N));function V(p){i[3](p)}let ee={label:"Stage",choices:Xe(["Existing","Design"]),inlineSmall:!0};i[1].criticalIssues[i[0]].stage!==void 0&&(ee.value=i[1].criticalIssues[i[0]].stage),S=new Qe({props:ee}),Y.push(()=>Q(S,"value",V));function ge(p){i[4](p)}let ae={label:"Location Name"};i[1].criticalIssues[i[0]].locationName!==void 0&&(ae.value=i[1].criticalIssues[i[0]].locationName),k=new tt({props:ae}),Y.push(()=>Q(k,"value",ge));let B=i[1].criticalIssues[i[0]].stage!="Design"&&Ae(i);function $e(p){i[6](p)}let fe={label:"Commentary & Feedback"};return i[1].criticalIssues[i[0]].notes!==void 0&&(fe.value=i[1].criticalIssues[i[0]].notes),h=new et({props:fe}),Y.push(()=>Q(h,"value",$e)),{c(){e=O("div"),t=O("a"),l=H("Google StreetView"),o=A(),s=O("a"),a=H("Bing Streetside"),u=A(),M(c.$$.fragment),C=A(),M(S.$$.fragment),D=A(),M(k.$$.fragment),L=A(),B&&B.c(),f=A(),M(h.$$.fragment),this.h()},l(p){e=U(p,"DIV",{style:!0});var E=F(e);t=U(E,"A",{href:!0,target:!0});var te=F(t);l=J(te,"Google StreetView"),te.forEach(m),o=R(E),s=U(E,"A",{href:!0,target:!0});var le=F(s);a=J(le,"Bing Streetside"),le.forEach(m),E.forEach(m),u=R(p),G(c.$$.fragment,p),C=R(p),G(S.$$.fragment,p),D=R(p),G(k.$$.fragment,p),L=R(p),B&&B.l(p),f=R(p),G(h.$$.fragment,p),this.h()},h(){q(t,"href",n=ve(i[1].criticalIssues[i[0]].point)),q(t,"target","_blank"),q(s,"href",r=ke(i[1].criticalIssues[i[0]].point)),q(s,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(p,E){w(p,e,E),P(e,t),P(t,l),P(e,o),P(e,s),P(s,a),w(p,u,E),T(c,p,E),w(p,C,E),T(S,p,E),w(p,D,E),T(k,p,E),w(p,L,E),B&&B.m(p,E),w(p,f,E),T(h,p,E),y=!0},p(p,[E]){(!y||E&3&&n!==(n=ve(p[1].criticalIssues[p[0]].point)))&&q(t,"href",n),(!y||E&3&&r!==(r=ke(p[1].criticalIssues[p[0]].point)))&&q(s,"href",r);const te={};!g&&E&3&&(g=!0,te.value=p[1].criticalIssues[p[0]].criticalIssue,X(()=>g=!1)),c.$set(te);const le={};!$&&E&3&&($=!0,le.value=p[1].criticalIssues[p[0]].stage,X(()=>$=!1)),S.$set(le);const ce={};!_&&E&3&&(_=!0,ce.value=p[1].criticalIssues[p[0]].locationName,X(()=>_=!1)),k.$set(ce),p[1].criticalIssues[p[0]].stage!="Design"?B?(B.p(p,E),E&3&&v(B,1)):(B=Ae(p),B.c(),v(B,1),B.m(f.parentNode,f)):B&&(ne(),I(B,1,1,()=>{B=null}),ie());const ue={};!d&&E&3&&(d=!0,ue.value=p[1].criticalIssues[p[0]].notes,X(()=>d=!1)),h.$set(ue)},i(p){y||(v(c.$$.fragment,p),v(S.$$.fragment,p),v(k.$$.fragment,p),v(B),v(h.$$.fragment,p),y=!0)},o(p){I(c.$$.fragment,p),I(S.$$.fragment,p),I(k.$$.fragment,p),I(B),I(h.$$.fragment,p),y=!1},d(p){p&&(m(e),m(u),m(C),m(D),m(L),m(f)),j(c,p),j(S,p),j(k,p),B&&B.d(p),j(h,p)}}}function Ot(i,e,t){let l;he(i,Z,c=>t(1,l=c));let{idx:n}=e;function o(c){i.$$.not_equal(l.criticalIssues[n].criticalIssue,c)&&(l.criticalIssues[n].criticalIssue=c,Z.set(l))}function s(c){i.$$.not_equal(l.criticalIssues[n].stage,c)&&(l.criticalIssues[n].stage=c,Z.set(l))}function a(c){i.$$.not_equal(l.criticalIssues[n].locationName,c)&&(l.criticalIssues[n].locationName=c,Z.set(l))}function r(c){i.$$.not_equal(l.criticalIssues[n].resolved,c)&&(l.criticalIssues[n].resolved=c,Z.set(l))}function u(c){i.$$.not_equal(l.criticalIssues[n].notes,c)&&(l.criticalIssues[n].notes=c,Z.set(l))}return i.$$set=c=>{"idx"in c&&t(0,n=c.idx)},[n,l,o,s,a,r,u]}class Ut extends Se{constructor(e){super(),Ee(this,e,Ot,Ft,Ne,{idx:0})}}function Re(i){let e,t,l;function n(s){i[5](s)}let o={label:"Resolved by Design",inlineSmall:!0};return i[1].policyConflictLog[i[0]].resolved!==void 0&&(o.value=i[1].policyConflictLog[i[0]].resolved),e=new lt({props:o}),Y.push(()=>Q(e,"value",n)),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,a){T(e,s,a),l=!0},p(s,a){const r={};!t&&a&3&&(t=!0,r.value=s[1].policyConflictLog[s[0]].resolved,X(()=>t=!1)),e.$set(r)},i(s){l||(v(e.$$.fragment,s),l=!0)},o(s){I(e.$$.fragment,s),l=!1},d(s){j(e,s)}}}function zt(i){let e,t,l,n,o,s,a,r,u,c,g,C,S,$,D,k,_,L,f,h,d,y;function N(p){i[2](p)}let W={label:"Policy Conflict",emptyOption:!0,choices:Nt};i[1].policyConflictLog[i[0]].conflict!==void 0&&(W.value=i[1].policyConflictLog[i[0]].conflict),c=new xe({props:W}),Y.push(()=>Q(c,"value",N));function V(p){i[3](p)}let ee={label:"Stage",choices:Xe(["Existing","Design"]),inlineSmall:!0};i[1].policyConflictLog[i[0]].stage!==void 0&&(ee.value=i[1].policyConflictLog[i[0]].stage),S=new Qe({props:ee}),Y.push(()=>Q(S,"value",V));function ge(p){i[4](p)}let ae={label:"Location Name"};i[1].policyConflictLog[i[0]].locationName!==void 0&&(ae.value=i[1].policyConflictLog[i[0]].locationName),k=new tt({props:ae}),Y.push(()=>Q(k,"value",ge));let B=i[1].policyConflictLog[i[0]].stage!="Design"&&Re(i);function $e(p){i[6](p)}let fe={label:"Commentary & Feedback"};return i[1].policyConflictLog[i[0]].notes!==void 0&&(fe.value=i[1].policyConflictLog[i[0]].notes),h=new et({props:fe}),Y.push(()=>Q(h,"value",$e)),{c(){e=O("div"),t=O("a"),l=H("Google StreetView"),o=A(),s=O("a"),a=H("Bing Streetside"),u=A(),M(c.$$.fragment),C=A(),M(S.$$.fragment),D=A(),M(k.$$.fragment),L=A(),B&&B.c(),f=A(),M(h.$$.fragment),this.h()},l(p){e=U(p,"DIV",{style:!0});var E=F(e);t=U(E,"A",{href:!0,target:!0});var te=F(t);l=J(te,"Google StreetView"),te.forEach(m),o=R(E),s=U(E,"A",{href:!0,target:!0});var le=F(s);a=J(le,"Bing Streetside"),le.forEach(m),E.forEach(m),u=R(p),G(c.$$.fragment,p),C=R(p),G(S.$$.fragment,p),D=R(p),G(k.$$.fragment,p),L=R(p),B&&B.l(p),f=R(p),G(h.$$.fragment,p),this.h()},h(){q(t,"href",n=ve(i[1].policyConflictLog[i[0]].point)),q(t,"target","_blank"),q(s,"href",r=ke(i[1].policyConflictLog[i[0]].point)),q(s,"target","_blank"),z(e,"display","flex"),z(e,"justify-content","space-evenly")},m(p,E){w(p,e,E),P(e,t),P(t,l),P(e,o),P(e,s),P(s,a),w(p,u,E),T(c,p,E),w(p,C,E),T(S,p,E),w(p,D,E),T(k,p,E),w(p,L,E),B&&B.m(p,E),w(p,f,E),T(h,p,E),y=!0},p(p,[E]){(!y||E&3&&n!==(n=ve(p[1].policyConflictLog[p[0]].point)))&&q(t,"href",n),(!y||E&3&&r!==(r=ke(p[1].policyConflictLog[p[0]].point)))&&q(s,"href",r);const te={};!g&&E&3&&(g=!0,te.value=p[1].policyConflictLog[p[0]].conflict,X(()=>g=!1)),c.$set(te);const le={};!$&&E&3&&($=!0,le.value=p[1].policyConflictLog[p[0]].stage,X(()=>$=!1)),S.$set(le);const ce={};!_&&E&3&&(_=!0,ce.value=p[1].policyConflictLog[p[0]].locationName,X(()=>_=!1)),k.$set(ce),p[1].policyConflictLog[p[0]].stage!="Design"?B?(B.p(p,E),E&3&&v(B,1)):(B=Re(p),B.c(),v(B,1),B.m(f.parentNode,f)):B&&(ne(),I(B,1,1,()=>{B=null}),ie());const ue={};!d&&E&3&&(d=!0,ue.value=p[1].policyConflictLog[p[0]].notes,X(()=>d=!1)),h.$set(ue)},i(p){y||(v(c.$$.fragment,p),v(S.$$.fragment,p),v(k.$$.fragment,p),v(B),v(h.$$.fragment,p),y=!0)},o(p){I(c.$$.fragment,p),I(S.$$.fragment,p),I(k.$$.fragment,p),I(B),I(h.$$.fragment,p),y=!1},d(p){p&&(m(e),m(u),m(C),m(D),m(L),m(f)),j(c,p),j(S,p),j(k,p),B&&B.d(p),j(h,p)}}}function Ht(i,e,t){let l;he(i,Z,c=>t(1,l=c));let{idx:n}=e;function o(c){i.$$.not_equal(l.policyConflictLog[n].conflict,c)&&(l.policyConflictLog[n].conflict=c,Z.set(l))}function s(c){i.$$.not_equal(l.policyConflictLog[n].stage,c)&&(l.policyConflictLog[n].stage=c,Z.set(l))}function a(c){i.$$.not_equal(l.policyConflictLog[n].locationName,c)&&(l.policyConflictLog[n].locationName=c,Z.set(l))}function r(c){i.$$.not_equal(l.policyConflictLog[n].resolved,c)&&(l.policyConflictLog[n].resolved=c,Z.set(l))}function u(c){i.$$.not_equal(l.policyConflictLog[n].notes,c)&&(l.policyConflictLog[n].notes=c,Z.set(l))}return i.$$set=c=>{"idx"in c&&t(0,n=c.idx)},[n,l,o,s,a,r,u]}class Jt extends Se{constructor(e){super(),Ee(this,e,Ht,zt,Ne,{idx:0})}}const{window:Kt}=vt;function Ve(i,e,t){const l=i.slice();return l[44]=e[t],l[45]=e,l[46]=t,l}function Me(i,e,t){const l=i.slice();return l[47]=e[t],l[48]=e,l[46]=t,l}function Ge(i,e,t){const l=i.slice();return l[44]=e[t],l[46]=t,l}function Te(i,e,t){const l=i.slice();return l[47]=e[t],l[46]=t,l}function Wt(i){let e,t,l,n,o,s,a,r,u,c;e=new qt({props:{$$slots:{default:[Yt]},$$scope:{ctx:i}}}),e.$on("click",i[13]),l=new Vt({props:{$$slots:{default:[Xt]},$$scope:{ctx:i}}}),l.$on("click",i[15]),o=new it({props:{$$slots:{default:[Qt]},$$scope:{ctx:i}}}),o.$on("click",i[12]);const g=[el,xt],C=[];function S($,D){return $[1].id.kind=="critical"?0:1}return a=S(i),r=C[a]=g[a](i),{c(){M(e.$$.fragment),t=A(),M(l.$$.fragment),n=A(),M(o.$$.fragment),s=A(),r.c(),u=x()},l($){G(e.$$.fragment,$),t=R($),G(l.$$.fragment,$),n=R($),G(o.$$.fragment,$),s=R($),r.l($),u=x()},m($,D){T(e,$,D),w($,t,D),T(l,$,D),w($,n,D),T(o,$,D),w($,s,D),C[a].m($,D),w($,u,D),c=!0},p($,D){const k={};D[1]&1048576&&(k.$$scope={dirty:D,ctx:$}),e.$set(k);const _={};D[1]&1048576&&(_.$$scope={dirty:D,ctx:$}),l.$set(_);const L={};D[1]&1048576&&(L.$$scope={dirty:D,ctx:$}),o.$set(L);let f=a;a=S($),a===f?C[a].p($,D):(ne(),I(C[f],1,1,()=>{C[f]=null}),ie(),r=C[a],r?r.p($,D):(r=C[a]=g[a]($),r.c()),v(r,1),r.m(u.parentNode,u))},i($){c||(v(e.$$.fragment,$),v(l.$$.fragment,$),v(o.$$.fragment,$),v(r),c=!0)},o($){I(e.$$.fragment,$),I(l.$$.fragment,$),I(o.$$.fragment,$),I(r),c=!1},d($){$&&(m(t),m(n),m(s),m(u)),j(e,$),j(l,$),j(o,$),C[a].d($)}}}function Zt(i){let e,t,l,n,o,s,a="Critical Issue Log",r,u,c,g,C="Policy Conflict Log",S,$;e=new Pt({props:{label:"Map tools",$$slots:{default:[nl]},$$scope:{ctx:i}}}),l=new Dt({props:{small:!0,$$slots:{default:[rl]},$$scope:{ctx:i}}});let D=re(i[3].criticalIssues),k=[];for(let d=0;d<D.length;d+=1)k[d]=Fe(Te(i,D,d));const _=d=>I(k[d],1,1,()=>{k[d]=null});let L=re(i[3].policyConflictLog),f=[];for(let d=0;d<L.length;d+=1)f[d]=Ue(Ge(i,L,d));const h=d=>I(f[d],1,1,()=>{f[d]=null});return{c(){M(e.$$.fragment),t=A(),M(l.$$.fragment),n=A(),o=O("div"),s=O("h3"),s.textContent=a,r=A();for(let d=0;d<k.length;d+=1)k[d].c();u=A(),c=O("div"),g=O("h3"),g.textContent=C,S=A();for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){G(e.$$.fragment,d),t=R(d),G(l.$$.fragment,d),n=R(d),o=U(d,"DIV",{style:!0});var y=F(o);s=U(y,"H3",{"data-svelte-h":!0}),de(s)!=="svelte-e9mkko"&&(s.textContent=a),r=R(y);for(let W=0;W<k.length;W+=1)k[W].l(y);y.forEach(m),u=R(d),c=U(d,"DIV",{style:!0});var N=F(c);g=U(N,"H3",{"data-svelte-h":!0}),de(g)!=="svelte-y008oc"&&(g.textContent=C),S=R(N);for(let W=0;W<f.length;W+=1)f[W].l(N);N.forEach(m),this.h()},h(){z(o,"background-color","grey"),z(o,"padding","4px"),z(c,"background-color",De),z(c,"padding","4px")},m(d,y){T(e,d,y),w(d,t,y),T(l,d,y),w(d,n,y),w(d,o,y),P(o,s),P(o,r);for(let N=0;N<k.length;N+=1)k[N]&&k[N].m(o,null);w(d,u,y),w(d,c,y),P(c,g),P(c,S);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(c,null);$=!0},p(d,y){const N={};y[0]&97|y[1]&1048576&&(N.$$scope={dirty:y,ctx:d}),e.$set(N);const W={};if(y[0]&384|y[1]&1048576&&(W.$$scope={dirty:y,ctx:d}),l.$set(W),y[0]&133132){D=re(d[3].criticalIssues);let V;for(V=0;V<D.length;V+=1){const ee=Te(d,D,V);k[V]?(k[V].p(ee,y),v(k[V],1)):(k[V]=Fe(ee),k[V].c(),v(k[V],1),k[V].m(o,null))}for(ne(),V=D.length;V<k.length;V+=1)_(V);ie()}if(y[0]&264204){L=re(d[3].policyConflictLog);let V;for(V=0;V<L.length;V+=1){const ee=Ge(d,L,V);f[V]?(f[V].p(ee,y),v(f[V],1)):(f[V]=Ue(ee),f[V].c(),v(f[V],1),f[V].m(c,null))}for(ne(),V=L.length;V<f.length;V+=1)h(V);ie()}},i(d){if(!$){v(e.$$.fragment,d),v(l.$$.fragment,d);for(let y=0;y<D.length;y+=1)v(k[y]);for(let y=0;y<L.length;y+=1)v(f[y]);$=!0}},o(d){I(e.$$.fragment,d),I(l.$$.fragment,d),k=k.filter(Boolean);for(let y=0;y<k.length;y+=1)I(k[y]);f=f.filter(Boolean);for(let y=0;y<f.length;y+=1)I(f[y]);$=!1},d(d){d&&(m(t),m(n),m(o),m(u),m(c)),j(e,d),j(l,d),be(k,d),be(f,d)}}}function Yt(i){let e;return{c(){e=H("Save")},l(t){e=J(t,"Save")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function Xt(i){let e;return{c(){e=H("Delete")},l(t){e=J(t,"Delete")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function Qt(i){let e;return{c(){e=H("Copy")},l(t){e=J(t,"Copy")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function xt(i){let e,t;return e=new Jt({props:{idx:i[1].id.idx}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){T(e,l,n),t=!0},p(l,n){const o={};n[0]&2&&(o.idx=l[1].id.idx),e.$set(o)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){j(e,l)}}}function el(i){let e,t;return e=new Ut({props:{idx:i[1].id.idx}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){T(e,l,n),t=!0},p(l,n){const o={};n[0]&2&&(o.idx=l[1].id.idx),e.$set(o)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){j(e,l)}}}function tl(i){let e;return{c(){e=H("Zoom to fit")},l(t){e=J(t,"Zoom to fit")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function ll(i){let e;return{c(){e=H("Show route")},l(t){e=J(t,"Show route")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function nl(i){let e,t,l,n,o,s,a,r,u,c,g,C;e=new it({props:{$$slots:{default:[tl]},$$scope:{ctx:i}}}),e.$on("click",i[20]),l=new Bt({}),o=new Mt({});function S(_){i[21](_)}let $={map:i[0]};i[5]!==void 0&&($.enabled=i[5]),a=new Gt({props:$}),Y.push(()=>Q(a,"enabled",S));function D(_){i[22](_)}let k={$$slots:{default:[ll]},$$scope:{ctx:i}};return i[6]!==void 0&&(k.checked=i[6]),c=new Ie({props:k}),Y.push(()=>Q(c,"checked",D)),{c(){M(e.$$.fragment),t=A(),M(l.$$.fragment),n=A(),M(o.$$.fragment),s=A(),M(a.$$.fragment),u=A(),M(c.$$.fragment)},l(_){G(e.$$.fragment,_),t=R(_),G(l.$$.fragment,_),n=R(_),G(o.$$.fragment,_),s=R(_),G(a.$$.fragment,_),u=R(_),G(c.$$.fragment,_)},m(_,L){T(e,_,L),w(_,t,L),T(l,_,L),w(_,n,L),T(o,_,L),w(_,s,L),T(a,_,L),w(_,u,L),T(c,_,L),C=!0},p(_,L){const f={};L[1]&1048576&&(f.$$scope={dirty:L,ctx:_}),e.$set(f);const h={};L[0]&1&&(h.map=_[0]),!r&&L[0]&32&&(r=!0,h.enabled=_[5],X(()=>r=!1)),a.$set(h);const d={};L[1]&1048576&&(d.$$scope={dirty:L,ctx:_}),!g&&L[0]&64&&(g=!0,d.checked=_[6],X(()=>g=!1)),c.$set(d)},i(_){C||(v(e.$$.fragment,_),v(l.$$.fragment,_),v(o.$$.fragment,_),v(a.$$.fragment,_),v(c.$$.fragment,_),C=!0)},o(_){I(e.$$.fragment,_),I(l.$$.fragment,_),I(o.$$.fragment,_),I(a.$$.fragment,_),I(c.$$.fragment,_),C=!1},d(_){_&&(m(t),m(n),m(s),m(u)),j(e,_),j(l,_),j(o,_),j(a,_),j(c,_)}}}function il(i){let e;return{c(){e=H("Show existing problems")},l(t){e=J(t,"Show existing problems")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function ol(i){let e;return{c(){e=H("Show design problems")},l(t){e=J(t,"Show design problems")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function rl(i){let e,t,l,n,o,s;function a(g){i[23](g)}let r={$$slots:{default:[il]},$$scope:{ctx:i}};i[7]!==void 0&&(r.checked=i[7]),e=new Ie({props:r}),Y.push(()=>Q(e,"checked",a));function u(g){i[24](g)}let c={$$slots:{default:[ol]},$$scope:{ctx:i}};return i[8]!==void 0&&(c.checked=i[8]),n=new Ie({props:c}),Y.push(()=>Q(n,"checked",u)),{c(){M(e.$$.fragment),l=A(),M(n.$$.fragment)},l(g){G(e.$$.fragment,g),l=R(g),G(n.$$.fragment,g)},m(g,C){T(e,g,C),w(g,l,C),T(n,g,C),s=!0},p(g,C){const S={};C[1]&1048576&&(S.$$scope={dirty:C,ctx:g}),!t&&C[0]&128&&(t=!0,S.checked=g[7],X(()=>t=!1)),e.$set(S);const $={};C[1]&1048576&&($.$$scope={dirty:C,ctx:g}),!o&&C[0]&256&&(o=!0,$.checked=g[8],X(()=>o=!1)),n.$set($)},i(g){s||(v(e.$$.fragment,g),v(n.$$.fragment,g),s=!0)},o(g){I(e.$$.fragment,g),I(n.$$.fragment,g),s=!1},d(g){g&&m(l),j(e,g),j(n,g)}}}function je(i){let e;function t(o,s){return o[47].resolved=="No"?al:sl}let l=t(i),n=l(i);return{c(){n.c(),e=x()},l(o){n.l(o),e=x()},m(o,s){n.m(o,s),w(o,e,s)},p(o,s){l===(l=t(o))&&n?n.p(o,s):(n.d(1),n=l(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&m(e),n.d(o)}}}function sl(i){let e,t,l=i[47].resolved+"",n;return{c(){e=O("span"),t=H("Resolved: "),n=H(l)},l(o){e=U(o,"SPAN",{});var s=F(e);t=J(s,"Resolved: "),n=J(s,l),s.forEach(m)},m(o,s){w(o,e,s),P(e,t),P(e,n)},p(o,s){s[0]&8&&l!==(l=o[47].resolved+"")&&se(n,l)},d(o){o&&m(e)}}}function al(i){let e,t,l,n=i[47].resolved+"",o;return{c(){e=O("span"),t=O("b"),l=H("Resolved: "),o=H(n)},l(s){e=U(s,"SPAN",{});var a=F(e);t=U(a,"B",{});var r=F(t);l=J(r,"Resolved: "),o=J(r,n),r.forEach(m),a.forEach(m)},m(s,a){w(s,e,a),P(e,t),P(t,l),P(t,o)},p(s,a){a[0]&8&&n!==(n=s[47].resolved+"")&&se(o,n)},d(s){s&&m(e)}}}function fl(i){let e,t,l,n=i[47].stage+"",o,s,a,r=i[47].stage!="Design"&&je(i);return{c(){e=O("div"),t=O("span"),l=H("Stage: "),o=H(n),s=A(),r&&r.c(),a=A(),this.h()},l(u){e=U(u,"DIV",{style:!0});var c=F(e);t=U(c,"SPAN",{});var g=F(t);l=J(g,"Stage: "),o=J(g,n),g.forEach(m),s=R(c),r&&r.l(c),c.forEach(m),a=R(u),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(u,c){w(u,e,c),P(e,t),P(t,l),P(t,o),P(e,s),r&&r.m(e,null),w(u,a,c)},p(u,c){c[0]&8&&n!==(n=u[47].stage+"")&&se(o,n),u[47].stage!="Design"?r?r.p(u,c):(r=je(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(m(e),m(a)),r&&r.d()}}}function Fe(i){let e,t;function l(){return i[25](i[46])}function n(){return i[26](i[46])}return e=new ot({props:{name:i[17](i[47]),$$slots:{default:[fl]},$$scope:{ctx:i}}}),e.$on("click",l),e.$on("mouseenter",n),e.$on("mouseleave",i[27]),{c(){M(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,s){T(e,o,s),t=!0},p(o,s){i=o;const a={};s[0]&8&&(a.name=i[17](i[47])),s[0]&8|s[1]&1048576&&(a.$$scope={dirty:s,ctx:i}),e.$set(a)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function Oe(i){let e;function t(o,s){return o[44].resolved=="No"?ul:cl}let l=t(i),n=l(i);return{c(){n.c(),e=x()},l(o){n.l(o),e=x()},m(o,s){n.m(o,s),w(o,e,s)},p(o,s){l===(l=t(o))&&n?n.p(o,s):(n.d(1),n=l(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&m(e),n.d(o)}}}function cl(i){let e,t,l=i[44].resolved+"",n;return{c(){e=O("span"),t=H("Resolved: "),n=H(l)},l(o){e=U(o,"SPAN",{});var s=F(e);t=J(s,"Resolved: "),n=J(s,l),s.forEach(m)},m(o,s){w(o,e,s),P(e,t),P(e,n)},p(o,s){s[0]&8&&l!==(l=o[44].resolved+"")&&se(n,l)},d(o){o&&m(e)}}}function ul(i){let e,t,l,n=i[44].resolved+"",o;return{c(){e=O("span"),t=O("b"),l=H("Resolved: "),o=H(n)},l(s){e=U(s,"SPAN",{});var a=F(e);t=U(a,"B",{});var r=F(t);l=J(r,"Resolved: "),o=J(r,n),r.forEach(m),a.forEach(m)},m(s,a){w(s,e,a),P(e,t),P(t,l),P(t,o)},p(s,a){a[0]&8&&n!==(n=s[44].resolved+"")&&se(o,n)},d(s){s&&m(e)}}}function pl(i){let e,t,l,n=i[44].stage+"",o,s,a,r=i[44].stage!="Design"&&Oe(i);return{c(){e=O("div"),t=O("span"),l=H("Stage: "),o=H(n),s=A(),r&&r.c(),a=A(),this.h()},l(u){e=U(u,"DIV",{style:!0});var c=F(e);t=U(c,"SPAN",{});var g=F(t);l=J(g,"Stage: "),o=J(g,n),g.forEach(m),s=R(c),r&&r.l(c),c.forEach(m),a=R(u),this.h()},h(){z(e,"width","100%"),z(e,"display","flex"),z(e,"justify-content","space-between")},m(u,c){w(u,e,c),P(e,t),P(t,l),P(t,o),P(e,s),r&&r.m(e,null),w(u,a,c)},p(u,c){c[0]&8&&n!==(n=u[44].stage+"")&&se(o,n),u[44].stage!="Design"?r?r.p(u,c):(r=Oe(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(m(e),m(a)),r&&r.d()}}}function Ue(i){let e,t;function l(){return i[28](i[46])}function n(){return i[29](i[46])}return e=new ot({props:{name:i[18](i[44]),$$slots:{default:[pl]},$$scope:{ctx:i}}}),e.$on("click",l),e.$on("mouseenter",n),e.$on("mouseleave",i[30]),{c(){M(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,s){T(e,o,s),t=!0},p(o,s){i=o;const a={};s[0]&8&&(a.name=i[18](i[44])),s[0]&8|s[1]&1048576&&(a.$$scope={dirty:s,ctx:i}),e.$set(a)},i(o){t||(v(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function ze(i){let e,t,l,n,o,s,a;return t=new ye({props:{$$slots:{default:[gl]},$$scope:{ctx:i}}}),t.$on("click",i[13]),n=new ye({props:{$$slots:{default:[hl]},$$scope:{ctx:i}}}),n.$on("click",i[32]),s=new ye({props:{$$slots:{default:[kl]},$$scope:{ctx:i}}}),s.$on("click",i[33]),{c(){e=O("div"),M(t.$$.fragment),l=A(),M(n.$$.fragment),o=A(),M(s.$$.fragment),this.h()},l(r){e=U(r,"DIV",{class:!0});var u=F(e);G(t.$$.fragment,u),l=R(u),G(n.$$.fragment,u),o=R(u),G(s.$$.fragment,u),u.forEach(m),this.h()},h(){q(e,"class","control-panel svelte-70vzbr")},m(r,u){w(r,e,u),T(t,e,null),P(e,l),T(n,e,null),P(e,o),T(s,e,null),a=!0},p(r,u){const c={};u[0]&2|u[1]&1048576&&(c.$$scope={dirty:u,ctx:r}),t.$set(c);const g={};u[0]&2|u[1]&1048576&&(g.$$scope={dirty:u,ctx:r}),n.$set(g);const C={};u[0]&2|u[1]&1048576&&(C.$$scope={dirty:u,ctx:r}),s.$set(C)},i(r){a||(v(t.$$.fragment,r),v(n.$$.fragment,r),v(s.$$.fragment,r),a=!0)},o(r){I(t.$$.fragment,r),I(n.$$.fragment,r),I(s.$$.fragment,r),a=!1},d(r){r&&m(e),j(t),j(n),j(s)}}}function _l(i){let e;return{c(){e=H("Move map")},l(t){e=J(t,"Move map")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function ml(i){let e,t="Move map";return{c(){e=O("b"),e.textContent=t},l(l){e=U(l,"B",{"data-svelte-h":!0}),de(e)!=="svelte-ydcbkl"&&(e.textContent=t)},m(l,n){w(l,e,n)},d(l){l&&m(e)}}}function gl(i){let e,t,l,n;function o(r,u){return r[1].mode=="select"?ml:_l}let s=o(i),a=s(i);return{c(){e=O("img"),l=A(),a.c(),n=x(),this.h()},l(r){e=U(r,"IMG",{src:!0,alt:!0,style:!0}),l=R(r),a.l(r),n=x(),this.h()},h(){ht(e.src,t=At)||q(e,"src",t),q(e,"alt","Move map"),z(e,"vertical-align","middle")},m(r,u){w(r,e,u),w(r,l,u),a.m(r,u),w(r,n,u)},p(r,u){s!==(s=o(r))&&(a.d(1),a=s(r),a&&(a.c(),a.m(n.parentNode,n)))},d(r){r&&(m(e),m(l),m(n)),a.d(r)}}}function $l(i){let e;return{c(){e=H("New critical issue")},l(t){e=J(t,"New critical issue")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function dl(i){let e,t="New critical issue";return{c(){e=O("b"),e.textContent=t},l(l){e=U(l,"B",{"data-svelte-h":!0}),de(e)!=="svelte-1q9dhgs"&&(e.textContent=t)},m(l,n){w(l,e,n)},d(l){l&&m(e)}}}function hl(i){let e,t,l,n;function o(r,u){return r[1].mode=="new-critical"?dl:$l}let s=o(i),a=s(i);return{c(){e=pe("svg"),t=pe("rect"),l=A(),a.c(),n=x(),this.h()},l(r){e=_e(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=F(e);t=_e(u,"rect",{width:!0,height:!0,fill:!0,class:!0}),F(t).forEach(m),u.forEach(m),l=R(r),a.l(r),n=x(),this.h()},h(){q(t,"width","24"),q(t,"height","24"),q(t,"fill",Ye.critical.background),q(t,"class","svelte-70vzbr"),q(e,"width","24"),q(e,"height","24"),q(e,"xmlns","http://www.w3.org/2000/svg"),z(e,"vertical-align","middle")},m(r,u){w(r,e,u),P(e,t),w(r,l,u),a.m(r,u),w(r,n,u)},p(r,u){s!==(s=o(r))&&(a.d(1),a=s(r),a&&(a.c(),a.m(n.parentNode,n)))},d(r){r&&(m(e),m(l),m(n)),a.d(r)}}}function bl(i){let e;return{c(){e=H("New policy conflict")},l(t){e=J(t,"New policy conflict")},m(t,l){w(t,e,l)},d(t){t&&m(e)}}}function vl(i){let e,t="New policy conflict";return{c(){e=O("b"),e.textContent=t},l(l){e=U(l,"B",{"data-svelte-h":!0}),de(e)!=="svelte-pf83jq"&&(e.textContent=t)},m(l,n){w(l,e,n)},d(l){l&&m(e)}}}function kl(i){let e,t,l,n;function o(r,u){return r[1].mode=="new-conflict"?vl:bl}let s=o(i),a=s(i);return{c(){e=pe("svg"),t=pe("circle"),l=A(),a.c(),n=x(),this.h()},l(r){e=_e(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=F(e);t=_e(u,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),F(t).forEach(m),u.forEach(m),l=R(r),a.l(r),n=x(),this.h()},h(){q(t,"cx","12"),q(t,"cy","12"),q(t,"r","12"),q(t,"fill",De),q(e,"width","24"),q(e,"height","24"),q(e,"xmlns","http://www.w3.org/2000/svg"),z(e,"vertical-align","middle")},m(r,u){w(r,e,u),P(e,t),w(r,l,u),a.m(r,u),w(r,n,u)},p(r,u){s!==(s=o(r))&&(a.d(1),a=s(r),a&&(a.c(),a.m(n.parentNode,n)))},d(r){r&&(m(e),m(l),m(n)),a.d(r)}}}function He(i){let e,t;return e=new Rt({props:{map:i[0],beforeId:"route-map"}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){T(e,l,n),t=!0},p(l,n){const o={};n[0]&1&&(o.map=l[0]),e.$set(o)},i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){j(e,l)}}}function Je(i){let e,t,l;function n(r){i[34](r,i[47])}function o(){return i[35](i[46])}function s(){return i[36](i[46])}let a={draggable:!0,$$slots:{default:[wl]},$$scope:{ctx:i}};return i[47].point!==void 0&&(a.lngLat=i[47].point),e=new nt({props:a}),Y.push(()=>Q(e,"lngLat",n)),e.$on("click",o),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,u){T(e,r,u),l=!0},p(r,u){i=r;const c={};u[0]&8|u[1]&1048576&&(c.$$scope={dirty:u,ctx:i}),!t&&u[0]&8&&(t=!0,c.lngLat=i[47].point,X(()=>t=!1)),e.$set(c)},i(r){l||(v(e.$$.fragment,r),l=!0)},o(r){I(e.$$.fragment,r),l=!1},d(r){j(e,r)}}}function wl(i){let e,t,l,n=i[47].criticalIssue+"",o;return{c(){e=pe("svg"),t=pe("rect"),l=pe("text"),o=H(n),this.h()},l(s){e=_e(s,"svg",{width:!0,height:!0,xmlns:!0});var a=F(e);t=_e(a,"rect",{width:!0,height:!0,fill:!0,class:!0}),F(t).forEach(m),l=_e(a,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var r=F(l);o=J(r,n),r.forEach(m),a.forEach(m),this.h()},h(){q(t,"width","40"),q(t,"height","40"),q(t,"fill",Ye.critical.background),q(t,"class","svelte-70vzbr"),q(l,"x","50%"),q(l,"y","50%"),q(l,"dominant-baseline","middle"),q(l,"text-anchor","middle"),z(l,"fill","white"),z(l,"font","bold 15px sans-serif"),q(e,"width","40"),q(e,"height","40"),q(e,"xmlns","http://www.w3.org/2000/svg")},m(s,a){w(s,e,a),P(e,t),P(e,l),P(l,o)},p(s,a){a[0]&8&&n!==(n=s[47].criticalIssue+"")&&se(o,n)},d(s){s&&m(e)}}}function Ke(i){let e=we(i[7],i[8],i[47].stage),t,l,n=e&&Je(i);return{c(){n&&n.c(),t=x()},l(o){n&&n.l(o),t=x()},m(o,s){n&&n.m(o,s),w(o,t,s),l=!0},p(o,s){s[0]&392&&(e=we(o[7],o[8],o[47].stage)),e?n?(n.p(o,s),s[0]&392&&v(n,1)):(n=Je(o),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(ne(),I(n,1,1,()=>{n=null}),ie())},i(o){l||(v(n),l=!0)},o(o){I(n),l=!1},d(o){o&&m(t),n&&n.d(o)}}}function We(i){let e,t,l;function n(r){i[37](r,i[44])}function o(){return i[38](i[46])}function s(){return i[39](i[46])}let a={draggable:!0,$$slots:{default:[Cl]},$$scope:{ctx:i}};return i[44].point!==void 0&&(a.lngLat=i[44].point),e=new nt({props:a}),Y.push(()=>Q(e,"lngLat",n)),e.$on("click",o),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,u){T(e,r,u),l=!0},p(r,u){i=r;const c={};u[0]&8|u[1]&1048576&&(c.$$scope={dirty:u,ctx:i}),!t&&u[0]&8&&(t=!0,c.lngLat=i[44].point,X(()=>t=!1)),e.$set(c)},i(r){l||(v(e.$$.fragment,r),l=!0)},o(r){I(e.$$.fragment,r),l=!1},d(r){j(e,r)}}}function Cl(i){let e,t=i[44].conflict+"",l;return{c(){e=O("span"),l=H(t),this.h()},l(n){e=U(n,"SPAN",{class:!0});var o=F(e);l=J(o,t),o.forEach(m),this.h()},h(){q(e,"class","dot svelte-70vzbr"),z(e,"background",De)},m(n,o){w(n,e,o),P(e,l)},p(n,o){o[0]&8&&t!==(t=n[44].conflict+"")&&se(l,t)},d(n){n&&m(e)}}}function Ze(i){let e=we(i[7],i[8],i[44].stage),t,l,n=e&&We(i);return{c(){n&&n.c(),t=x()},l(o){n&&n.l(o),t=x()},m(o,s){n&&n.m(o,s),w(o,t,s),l=!0},p(o,s){s[0]&392&&(e=we(o[7],o[8],o[44].stage)),e?n?(n.p(o,s),s[0]&392&&v(n,1)):(n=We(o),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(ne(),I(n,1,1,()=>{n=null}),ie())},i(o){l||(v(n),l=!0)},o(o){I(n),l=!1},d(o){o&&m(t),n&&n.d(o)}}}function yl(i){let e,t;return e=new It({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,n){T(e,l,n),t=!0},p:bt,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){j(e,l)}}}function Il(i){let e,t,l,n,o,s,a,r,u,c;e=new wt({}),e.$on("click",i[14]);let g=i[1].mode!="editing"&&ze(i);n=new jt({props:{show:i[6],id:"route-map"}});let C=i[0]&&He(i),S=re(i[3].criticalIssues),$=[];for(let f=0;f<S.length;f+=1)$[f]=Ke(Me(i,S,f));const D=f=>I($[f],1,1,()=>{$[f]=null});let k=re(i[3].policyConflictLog),_=[];for(let f=0;f<k.length;f+=1)_[f]=Ze(Ve(i,k,f));const L=f=>I(_[f],1,1,()=>{_[f]=null});return u=new Ct({props:{data:i[9],$$slots:{default:[yl]},$$scope:{ctx:i}}}),{c(){M(e.$$.fragment),t=A(),g&&g.c(),l=A(),M(n.$$.fragment),o=A(),C&&C.c(),s=A();for(let f=0;f<$.length;f+=1)$[f].c();a=A();for(let f=0;f<_.length;f+=1)_[f].c();r=A(),M(u.$$.fragment)},l(f){G(e.$$.fragment,f),t=R(f),g&&g.l(f),l=R(f),G(n.$$.fragment,f),o=R(f),C&&C.l(f),s=R(f);for(let h=0;h<$.length;h+=1)$[h].l(f);a=R(f);for(let h=0;h<_.length;h+=1)_[h].l(f);r=R(f),G(u.$$.fragment,f)},m(f,h){T(e,f,h),w(f,t,h),g&&g.m(f,h),w(f,l,h),T(n,f,h),w(f,o,h),C&&C.m(f,h),w(f,s,h);for(let d=0;d<$.length;d+=1)$[d]&&$[d].m(f,h);w(f,a,h);for(let d=0;d<_.length;d+=1)_[d]&&_[d].m(f,h);w(f,r,h),T(u,f,h),c=!0},p(f,h){f[1].mode!="editing"?g?(g.p(f,h),h[0]&2&&v(g,1)):(g=ze(f),g.c(),v(g,1),g.m(l.parentNode,l)):g&&(ne(),I(g,1,1,()=>{g=null}),ie());const d={};if(h[0]&64&&(d.show=f[6]),n.$set(d),f[0]?C?(C.p(f,h),h[0]&1&&v(C,1)):(C=He(f),C.c(),v(C,1),C.m(s.parentNode,s)):C&&(ne(),I(C,1,1,()=>{C=null}),ie()),h[0]&1416){S=re(f[3].criticalIssues);let N;for(N=0;N<S.length;N+=1){const W=Me(f,S,N);$[N]?($[N].p(W,h),v($[N],1)):($[N]=Ke(W),$[N].c(),v($[N],1),$[N].m(a.parentNode,a))}for(ne(),N=S.length;N<$.length;N+=1)D(N);ie()}if(h[0]&1416){k=re(f[3].policyConflictLog);let N;for(N=0;N<k.length;N+=1){const W=Ve(f,k,N);_[N]?(_[N].p(W,h),v(_[N],1)):(_[N]=Ze(W),_[N].c(),v(_[N],1),_[N].m(r.parentNode,r))}for(ne(),N=k.length;N<_.length;N+=1)L(N);ie()}const y={};h[0]&512&&(y.data=f[9]),h[1]&1048576&&(y.$$scope={dirty:h,ctx:f}),u.$set(y)},i(f){if(!c){v(e.$$.fragment,f),v(g),v(n.$$.fragment,f),v(C);for(let h=0;h<S.length;h+=1)v($[h]);for(let h=0;h<k.length;h+=1)v(_[h]);v(u.$$.fragment,f),c=!0}},o(f){I(e.$$.fragment,f),I(g),I(n.$$.fragment,f),I(C),$=$.filter(Boolean);for(let h=0;h<$.length;h+=1)I($[h]);_=_.filter(Boolean);for(let h=0;h<_.length;h+=1)I(_[h]);I(u.$$.fragment,f),c=!1},d(f){f&&(m(t),m(l),m(o),m(s),m(a),m(r)),j(e,f),g&&g.d(f),j(n,f),C&&C.d(f),be($,f),be(_,f),j(u,f)}}}function Ll(i){let e,t,l,n,o,s,a,r,u,c,g;const C=[Zt,Wt],S=[];function $(_,L){return _[1].mode!="editing"?0:1}l=$(i),n=S[l]=C[l](i);function D(_){i[40](_)}let k={$$slots:{default:[Il]},$$scope:{ctx:i}};return i[0]!==void 0&&(k.map=i[0]),a=new kt({props:k}),Y.push(()=>Q(a,"map",D)),{c(){e=O("div"),t=O("div"),n.c(),o=A(),s=O("div"),M(a.$$.fragment),this.h()},l(_){e=U(_,"DIV",{style:!0});var L=F(e);t=U(L,"DIV",{style:!0});var f=F(t);n.l(f),f.forEach(m),o=R(L),s=U(L,"DIV",{style:!0});var h=F(s);G(a.$$.fragment,h),h.forEach(m),L.forEach(m),this.h()},h(){z(t,"width","30%"),z(t,"overflow-y","scroll"),z(t,"padding","10px"),z(t,"border","1px solid black"),z(s,"position","relative"),z(s,"width","70%"),z(e,"display","flex"),z(e,"height","80vh")},m(_,L){w(_,e,L),P(e,t),S[l].m(t,null),i[31](t),P(e,o),P(e,s),T(a,s,null),u=!0,c||(g=dt(Kt,"keydown",i[19]),c=!0)},p(_,L){let f=l;l=$(_),l===f?S[l].p(_,L):(ne(),I(S[f],1,1,()=>{S[f]=null}),ie(),n=S[l],n?n.p(_,L):(n=S[l]=C[l](_),n.c()),v(n,1),n.m(t,null));const h={};L[0]&971|L[1]&1048576&&(h.$$scope={dirty:L,ctx:_}),!r&&L[0]&1&&(r=!0,h.map=_[0],X(()=>r=!1)),a.$set(h)},i(_){u||(v(n),v(a.$$.fragment,_),u=!0)},o(_){I(n),I(a.$$.fragment,_),u=!1},d(_){_&&m(e),S[l].d(),i[31](null),j(a),c=!1,g()}}}function Nl(i,e,t){let l={type:"FeatureCollection",features:[]},n=e.mode=="editing"?e.id:t;if(n!=null){let o=n.kind=="critical"?i.criticalIssues:i.policyConflictLog;l.features.push(Le(o[n.idx].point))}return l}function Le(i){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:i}}}function we(i,e,t){return!(!i&&t=="Existing"||!e&&t=="Design")}function Sl(i,e,t){let l,n,o;he(i,Z,b=>t(3,n=b)),he(i,Tt,b=>t(42,o=b));let s,a,r={mode:"select"},u=o.url.searchParams.get("kind")||"";u=="critical"?r={mode:"new-critical"}:u=="conflict"&&(r={mode:"new-conflict"});let c=null,g=null,C=!1,S=!0,$=!0,D=!0;async function k(b){c=a.scrollTop,t(1,r={mode:"editing",id:b}),t(2,g=null),await Ce(),t(4,a.scrollTop=0,a)}async function _(b){c=a.scrollTop,t(1,r={mode:"editing",id:b}),t(2,g=null),await Ce(),t(4,a.scrollTop=0,a);let K=b.kind=="critical"?n.criticalIssues:n.policyConflictLog;s==null||s.flyTo({center:K[b.idx].point,duration:500})}async function L(){if(r.mode!="editing"||!s)return;let b=r.id,K=b.kind=="critical"?n.criticalIssues:n.policyConflictLog,oe=JSON.parse(JSON.stringify(K[b.idx])),gt=s.getBounds().getWest(),$t=s.getBounds().getEast();oe.point[0]+=($t-gt)*.05;let Be=K.toSpliced(b.idx+1,0,oe);b.kind=="critical"?me(Z,n.criticalIssues=Be,n):me(Z,n.policyConflictLog=Be,n),await k({kind:b.kind,idx:b.idx+1})}async function f(){t(1,r={mode:"select"}),me(Z,n.policyConflictLog=n.policyConflictLog.toSorted((b,K)=>Pe(b.conflict)-Pe(K.conflict)),n),me(Z,n.criticalIssues=n.criticalIssues.toSorted((b,K)=>qe(b.criticalIssue)-qe(K.criticalIssue)),n),c!=null&&(await Ce(),t(4,a.scrollTop=c,a),c=null)}function h(b){if(!C&&r.mode!="select"){if(r.mode=="editing"){f();return}r.mode=="new-critical"?(me(Z,n.criticalIssues=[...n.criticalIssues,{criticalIssue:o.url.searchParams.get("code")||"",stage:"",point:b.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],n),k({kind:"critical",idx:n.criticalIssues.length-1})):r.mode=="new-conflict"&&(me(Z,n.policyConflictLog=[...n.policyConflictLog,{conflict:o.url.searchParams.get("code")||"",stage:"",point:b.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],n),k({kind:"conflict",idx:n.policyConflictLog.length-1}))}}function d(){r.mode=="editing"&&window.confirm("Delete this entry?")&&(r.id.kind=="critical"?(n.criticalIssues.splice(r.id.idx,1),Z.set(n)):(n.policyConflictLog.splice(r.id.idx,1),Z.set(n)),f())}function y(b){if(!s)return;let K={type:"FeatureCollection",features:[...n.criticalIssues.map(oe=>Le(oe.point)),...n.policyConflictLog.map(oe=>Le(oe.point)),...n.summary.networkMap.features]};K.features.length>0&&s.fitBounds(yt(K),{padding:20,animate:b})}function N(b){let K=b.criticalIssue?St(b.criticalIssue):"Unknown critical";return b.locationName?`${K} (${b.locationName})`:K}function W(b){let K=b.conflict?"PO0"+Et(b.conflict):"Unknown conflict";return b.locationName?`${K} (${b.locationName})`:K}function V(b){if(r.mode=="editing"){let K=b.target.tagName,oe=K=="INPUT"||K=="TEXTAREA";b.key=="Escape"||b.key=="Enter"&&!oe?(b.stopPropagation(),f()):b.key=="Delete"&&!oe&&(b.stopPropagation(),d())}else(r.mode=="new-critical"||r.mode=="new-conflict")&&b.key=="Escape"&&(b.stopPropagation(),t(1,r={mode:"select"}))}const ee=()=>y(!0);function ge(b){C=b,t(5,C)}function ae(b){S=b,t(6,S)}function B(b){$=b,t(7,$)}function $e(b){D=b,t(8,D)}const fe=b=>_({kind:"critical",idx:b}),p=b=>t(2,g={kind:"critical",idx:b}),E=()=>t(2,g=null),te=b=>_({kind:"conflict",idx:b}),le=b=>t(2,g={kind:"conflict",idx:b}),ce=()=>t(2,g=null);function ue(b){Y[b?"unshift":"push"](()=>{a=b,t(4,a)})}const rt=()=>t(1,r={mode:"new-critical"}),st=()=>t(1,r={mode:"new-conflict"});function at(b,K){i.$$.not_equal(K.point,b)&&(K.point=b,Z.set(n))}const ft=b=>k({kind:"critical",idx:b}),ct=b=>k({kind:"critical",idx:b});function ut(b,K){i.$$.not_equal(K.point,b)&&(K.point=b,Z.set(n))}const pt=b=>k({kind:"conflict",idx:b}),_t=b=>k({kind:"conflict",idx:b});function mt(b){s=b,t(0,s)}return i.$$.update=()=>{i.$$.dirty[0]&1&&s&&y(!1),i.$$.dirty[0]&3&&s&&(s.getCanvas().style.cursor=r.mode=="new-critical"||r.mode=="new-conflict"?"crosshair":"auto"),i.$$.dirty[0]&14&&t(9,l=Nl(n,r,g))},[s,r,g,n,a,C,S,$,D,l,k,_,L,f,h,d,y,N,W,V,ee,ge,ae,B,$e,fe,p,E,te,le,ce,ue,rt,st,at,ft,ct,ut,pt,_t,mt]}class nn extends Se{constructor(e){super(),Ee(this,e,Sl,Ll,Ne,{},null,[-1,-1])}}export{nn as component};
