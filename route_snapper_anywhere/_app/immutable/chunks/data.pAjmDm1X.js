import{w as n}from"./index.BhcMbfFC.js";import{r as a}from"./index.CfCT5IeL.js";import{J as c}from"./scheduler.Cns_Y-fU.js";let i="route-check/",s=n(p()),l=n("");f();function f(){console.log("Initial load; trying to open last opened file");let e=window.localStorage.getItem(`${i}last-opened-file`);if(e)try{let o=g(e);l.set(e),s.set(o);return}catch(o){window.alert(`The last opened file ${e} has a problem: ${o}`)}console.log("Starting with a new file");let t=m();l.set(t)}s.subscribe(e=>{let t=c(l);t&&window.localStorage.setItem(t,JSON.stringify(e))});l.subscribe(e=>{e&&window.localStorage.setItem(`${i}last-opened-file`,e)});function g(e){console.log(`Loading ${e}`);let t=window.localStorage.getItem(e);if(!t)throw new Error(`Key not in local storage: ${e}`);let o=JSON.parse(t);if(!o.criticalIssues)throw new Error("File format appears outdated");return o}function m(){let e=d();for(let t=1;t<=e.length+1;t++){let o=`${i}untitled${t}`;if(!e.includes(o))return o}throw new Error("Couldn't make a new filename; this shouldn't be possible")}function d(){let e=[];for(let t=0;t<window.localStorage.length;t++){let o=window.localStorage.key(t);o.startsWith(i)&&o!=`${i}last-opened-file`&&e.push(o)}return e.sort(),e}function p(){return{summary:{dateDesignReview:"",schemeReference:"",schemeName:"",schemeSummary:"",schemeInfoReviewed:"",authority:"",transportOrCombinedAuthority:"",region:"",fundingProgramme:"",designStage:"",fundingConditions:"",inspectorEmail:"",assessedRouteLengthKm:"",totalRouteLengthKm:"",notes:"",checkType:""},policyCheck:a(6,{existing:"",proposed:"",commentary:""}),policyConflictLog:[],safetyCheck:r(16),criticalIssues:[],streetCheck:r(26),streetPlacemakingCheck:r(26),pathCheck:r(30),pathPlacemakingCheck:r(19)}}function r(e){return{existingScores:Array(e).fill(""),proposedScores:Array(e).fill(""),existingScoreNotes:Array(e).fill(""),proposedScoreNotes:Array(e).fill("")}}export{l as c,p as e,d as g,g as l,m as n,s};
