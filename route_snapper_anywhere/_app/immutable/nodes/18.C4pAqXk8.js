var pn=Object.defineProperty;var vn=(r,e,t)=>e in r?pn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var J=(r,e,t)=>(vn(r,typeof e!="symbol"?e+"":e,t),t);import{s as Le,m as gt,B as ft,e as we,b as Me,f as et,d as L,C as sr,i as F,A as gn,u as dt,p as yt,q as bt,D as lr,E as re,r as U,v as H,k as Ze,a as G,c as x,n as qe,K as Xe,a5 as dn,l as ur,g as ct,w as Ve,j as Ye,t as se,h as le,y as yr}from"../chunks/scheduler.Cns_Y-fU.js";import{S as ke,i as Ce,t as B,b as R,e as K,c as q,a as X,m as Y,d as D,g as br,f as _r}from"../chunks/index.B1sdSzhI.js";import{p as Ae}from"../chunks/index.DQaSn8jb.js";import{S as Be}from"../chunks/Select.D65_JAfX.js";import{T as Ke}from"../chunks/TextArea.DODp0uDl.js";import{T as Re}from"../chunks/TextInput.8vA7YF52.js";import{s as I}from"../chunks/data.CUS-6sO-.js";import{e as yn,c as bn,d as wr,g as Mr,a as Pr,L as _n,M as wn,G as Mn}from"../chunks/index.Bhy-i68N.js";import{g as Pn}from"../chunks/spread.CN4WR7uZ.js";import{S as st}from"../chunks/SecondaryButton.aZZSPwDr.js";import{W as $n}from"../chunks/WarningButton.CSppIYFd.js";import{c as Sn,g as _t,a as En}from"../chunks/Geocoder.svelte_svelte_type_style_lang.MMiTdOl1.js";import{w as $r}from"../chunks/index.BhcMbfFC.js";import"../chunks/paths.mJLKDePH.js";import{a as Ln,t as kn,r as Cn,f as Fn,d as An}from"../chunks/lists.Ci0sBo6t.js";import{B as Bn}from"../chunks/Breadcrumbs.Bb601T2Z.js";function Rn(r){let e,t,n,i;const o=r[2].default,a=gt(o,r,r[1],null);let s=[{type:"button"},{class:"govuk-button"},{"data-module":"govuk-button"},r[0]],l={};for(let f=0;f<s.length;f+=1)l=ft(l,s[f]);return{c(){e=we("button"),a&&a.c(),this.h()},l(f){e=Me(f,"BUTTON",{type:!0,class:!0,"data-module":!0});var g=et(e);a&&a.l(g),g.forEach(L),this.h()},h(){sr(e,l)},m(f,g){F(f,e,g),a&&a.m(e,null),e.autofocus&&e.focus(),t=!0,n||(i=gn(e,"click",r[3]),n=!0)},p(f,[g]){a&&a.p&&(!t||g&2)&&dt(a,o,f,f[1],t?bt(o,f[1],g,null):yt(f[1]),null),sr(e,l=Pn(s,[{type:"button"},{class:"govuk-button"},{"data-module":"govuk-button"},g&1&&f[0]]))},i(f){t||(B(a,f),t=!0)},o(f){R(a,f),t=!1},d(f){f&&L(e),a&&a.d(f),n=!1,i()}}}function Tn(r,e,t){let{$$slots:n={},$$scope:i}=e;function o(a){re.call(this,r,a)}return r.$$set=a=>{t(0,e=ft(ft({},e),lr(a))),"$$scope"in a&&t(1,i=a.$$scope)},e=lr(e),[e,i,n,o]}class On extends ke{constructor(e){super(),Ce(this,e,Tn,Rn,Le,{})}}var qn=Object.defineProperty,N=(r,e)=>qn(r,"name",{value:e,configurable:!0}),Xn=class{constructor(e){this.direction=!1,this.compareProperties=!0;var t,n,i;this.precision=10**-((t=e==null?void 0:e.precision)!=null?t:17),this.direction=(n=e==null?void 0:e.direction)!=null?n:!1,this.compareProperties=(i=e==null?void 0:e.compareProperties)!=null?i:!0}compare(e,t){if(e.type!==t.type||!Oe(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates);case"Polygon":return this.comparePolygon(e,t);case"GeometryCollection":return this.compareGeometryCollection(e,t);case"Feature":return this.compareFeature(e,t);case"FeatureCollection":return this.compareFeatureCollection(e,t);default:if(e.type.startsWith("Multi")){const n=mt(e),i=mt(t);return n.every(o=>i.some(a=>this.compare(o,a)))}}return!1}compareCoord(e,t){return e.length===t.length&&e.every((n,i)=>Math.abs(n-t[i])<this.precision)}compareLine(e,t,n=0,i=!1){if(!Oe(e,t))return!1;const o=e;let a=t;if(i&&!this.compareCoord(o[0],a[0])){const l=this.fixStartIndex(a,o);if(l)a=l;else return!1}const s=this.compareCoord(o[n],a[n]);return this.direction||s?this.comparePath(o,a):this.compareCoord(o[n],a[a.length-(1+n)])?this.comparePath(o.slice().reverse(),a):!1}fixStartIndex(e,t){let n,i=-1;for(let o=0;o<e.length;o++)if(this.compareCoord(e[o],t[0])){i=o;break}return i>=0&&(n=[].concat(e.slice(i,e.length),e.slice(1,i+1))),n}comparePath(e,t){return e.every((n,i)=>this.compareCoord(n,t[i]))}comparePolygon(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){const n=e.coordinates.slice(1,e.coordinates.length),i=t.coordinates.slice(1,t.coordinates.length);return n.every(o=>i.some(a=>this.compareLine(o,a,1,!0)))}return!1}compareGeometryCollection(e,t){return Oe(e.geometries,t.geometries)&&this.compareBBox(e,t)&&e.geometries.every((n,i)=>this.compare(n,t.geometries[i]))}compareFeature(e,t){return e.id===t.id&&(this.compareProperties?yn(e.properties,t.properties):!0)&&this.compareBBox(e,t)&&this.compare(e.geometry,t.geometry)}compareFeatureCollection(e,t){return Oe(e.features,t.features)&&this.compareBBox(e,t)&&e.features.every((n,i)=>this.compare(n,t.features[i]))}compareBBox(e,t){return!e.bbox&&!t.bbox||(e.bbox&&t.bbox?this.compareCoord(e.bbox,t.bbox):!1)}};N(Xn,"GeojsonEquality");function Oe(r,e){return r.coordinates?r.coordinates.length===e.coordinates.length:r.length===e.length}N(Oe,"sameLength");function mt(r){return r.coordinates.map(e=>({type:r.type.replace("Multi",""),coordinates:e}))}N(mt,"explode");var j=63710088e-1,Sr={centimeters:j*100,centimetres:j*100,degrees:360/(2*Math.PI),feet:j*3.28084,inches:j*39.37,kilometers:j/1e3,kilometres:j/1e3,meters:j,metres:j,miles:j/1609.344,millimeters:j*1e3,millimetres:j*1e3,nauticalmiles:j/1852,radians:1,yards:j*1.0936},fr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function ce(r,e,t={}){const n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}N(ce,"feature");function Yn(r,e,t={}){switch(r){case"Point":return ge(e).geometry;case"LineString":return de(e).geometry;case"Polygon":return wt(e).geometry;case"MultiPoint":return Lr(e).geometry;case"MultiLineString":return Er(e).geometry;case"MultiPolygon":return kr(e).geometry;default:throw new Error(r+" is invalid")}}N(Yn,"geometry");function ge(r,e,t={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!We(r[0])||!We(r[1]))throw new Error("coordinates must contain numbers");return ce({type:"Point",coordinates:r},e,t)}N(ge,"point");function Dn(r,e,t={}){return tt(r.map(n=>ge(n,e)),t)}N(Dn,"points");function wt(r,e,t={}){for(const i of r){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return ce({type:"Polygon",coordinates:r},e,t)}N(wt,"polygon");function Nn(r,e,t={}){return tt(r.map(n=>wt(n,e)),t)}N(Nn,"polygons");function de(r,e,t={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return ce({type:"LineString",coordinates:r},e,t)}N(de,"lineString");function zn(r,e,t={}){return tt(r.map(n=>de(n,e)),t)}N(zn,"lineStrings");function tt(r,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}N(tt,"featureCollection");function Er(r,e,t={}){return ce({type:"MultiLineString",coordinates:r},e,t)}N(Er,"multiLineString");function Lr(r,e,t={}){return ce({type:"MultiPoint",coordinates:r},e,t)}N(Lr,"multiPoint");function kr(r,e,t={}){return ce({type:"MultiPolygon",coordinates:r},e,t)}N(kr,"multiPolygon");function Gn(r,e,t={}){return ce({type:"GeometryCollection",geometries:r},e,t)}N(Gn,"geometryCollection");function xn(r,e=0){if(e&&!(e>=0))throw new Error("precision must be a positive number");const t=Math.pow(10,e||0);return Math.round(r*t)/t}N(xn,"round");function Cr(r,e="kilometers"){const t=Sr[e];if(!t)throw new Error(e+" units is invalid");return r*t}N(Cr,"radiansToLength");function Mt(r,e="kilometers"){const t=Sr[e];if(!t)throw new Error(e+" units is invalid");return r/t}N(Mt,"lengthToRadians");function Jn(r,e){return Fr(Mt(r,e))}N(Jn,"lengthToDegrees");function In(r){let e=r%360;return e<0&&(e+=360),e}N(In,"bearingToAzimuth");function Fr(r){return r%(2*Math.PI)*180/Math.PI}N(Fr,"radiansToDegrees");function Un(r){return r%360*Math.PI/180}N(Un,"degreesToRadians");function Hn(r,e="kilometers",t="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return Cr(Mt(r,e),t)}N(Hn,"convertLength");function Kn(r,e="meters",t="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const n=fr[e];if(!n)throw new Error("invalid original units");const i=fr[t];if(!i)throw new Error("invalid final units");return r/n*i}N(Kn,"convertArea");function We(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}N(We,"isNumber");function Pt(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}N(Pt,"isObject");function Zn(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(e=>{if(!We(e))throw new Error("bbox must only contain numbers")})}N(Zn,"validateBBox");function Vn(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}N(Vn,"validateId");var Wn=Object.defineProperty,Z=(r,e)=>Wn(r,"name",{value:e,configurable:!0});function ze(r,e,t){if(r!==null)for(var n,i,o,a,s,l,f,g=0,b=0,$,d=r.type,S=d==="FeatureCollection",P=d==="Feature",C=S?r.features.length:1,T=0;T<C;T++){f=S?r.features[T].geometry:P?r.geometry:r,$=f?f.type==="GeometryCollection":!1,s=$?f.geometries.length:1;for(var u=0;u<s;u++){var m=0,h=0;if(a=$?f.geometries[u]:f,a!==null){l=a.coordinates;var v=a.type;switch(g=t&&(v==="Polygon"||v==="MultiPolygon")?1:0,v){case null:break;case"Point":if(e(l,b,T,m,h)===!1)return!1;b++,m++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],b,T,m,h)===!1)return!1;b++,v==="MultiPoint"&&m++}v==="LineString"&&m++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-g;i++){if(e(l[n][i],b,T,m,h)===!1)return!1;b++}v==="MultiLineString"&&m++,v==="Polygon"&&h++}v==="Polygon"&&m++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(h=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-g;o++){if(e(l[n][i][o],b,T,m,h)===!1)return!1;b++}h++}m++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(ze(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}Z(ze,"coordEach");function Qn(r,e,t,n){var i=t;return ze(r,function(o,a,s,l,f){a===0&&t===void 0?i=o:i=e(i,o,a,s,l,f)},n),i}Z(Qn,"coordReduce");function Ar(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}Z(Ar,"propEach");function jn(r,e,t){var n=t;return Ar(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}Z(jn,"propReduce");function Br(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}Z(Br,"featureEach");function ei(r,e,t){var n=t;return Br(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}Z(ei,"featureReduce");function ti(r){var e=[];return ze(r,function(t){e.push(t)}),e}Z(ti,"coordAll");function $t(r,e){var t,n,i,o,a,s,l,f,g,b,$=0,d=r.type==="FeatureCollection",S=r.type==="Feature",P=d?r.features.length:1;for(t=0;t<P;t++){for(s=d?r.features[t].geometry:S?r.geometry:r,f=d?r.features[t].properties:S?r.properties:{},g=d?r.features[t].bbox:S?r.bbox:void 0,b=d?r.features[t].id:S?r.id:void 0,l=s?s.type==="GeometryCollection":!1,a=l?s.geometries.length:1,i=0;i<a;i++){if(o=l?s.geometries[i]:s,o===null){if(e(null,$,f,g,b)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,$,f,g,b)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],$,f,g,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}$++}}Z($t,"geomEach");function Rr(r,e,t){var n=t;return $t(r,function(i,o,a,s,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,s,l)}),n}Z(Rr,"geomReduce");function rt(r,e){$t(r,function(t,n,i,o,a){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(ce(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var g=t.coordinates[f],b={type:l,coordinates:g};if(e(ce(b,i),n,f)===!1)return!1}})}Z(rt,"flattenEach");function ri(r,e,t){var n=t;return rt(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}Z(ri,"flattenReduce");function Tr(r,e){rt(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var s,l=0,f=0,g=0;if(ze(t,function(b,$,d,S,P){if(s===void 0||n>l||S>f||P>g){s=b,l=n,f=S,g=P,o=0;return}var C=de([s,b],t.properties);if(e(C,n,i,P,o)===!1)return!1;o++,s=b})===!1)return!1}}})}Z(Tr,"segmentEach");function ni(r,e,t){var n=t,i=!1;return Tr(r,function(o,a,s,l,f){i===!1&&t===void 0?n=o:n=e(n,o,a,s,l,f),i=!0}),n}Z(ni,"segmentReduce");function Or(r,e){if(!r)throw new Error("geojson is required");rt(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(e(de(a[s],t.properties),n,i,s)===!1)return!1;break}}})}Z(Or,"lineEach");function ii(r,e,t){var n=t;return Or(r,function(i,o,a,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,s)}),n}Z(ii,"lineReduce");function oi(r,e){if(e=e||{},!Pt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=l.length+o-1),de([l[o],l[o+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o-1),de([l[i][o],l[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o-1),de([l[n][o],l[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o-1),de([l[n][i][o],l[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}Z(oi,"findSegment");function ai(r,e){if(e=e||{},!Pt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":return ge(l,a,e);case"MultiPoint":return n<0&&(n=l.length+n),ge(l[n],a,e);case"LineString":return o<0&&(o=l.length+o),ge(l[o],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),ge(l[i][o],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o),ge(l[n][o],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o),ge(l[n][i][o],a,e)}throw new Error("geojson is invalid")}Z(ai,"findPoint");var si=Object.defineProperty,nt=(r,e)=>si(r,"name",{value:e,configurable:!0});function qr(r){return Rr(r,(e,t)=>e+Xr(t),0)}nt(qr,"area");function Xr(r){let e=0,t;switch(r.type){case"Polygon":return ht(r.coordinates);case"MultiPolygon":for(t=0;t<r.coordinates.length;t++)e+=ht(r.coordinates[t]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}nt(Xr,"calculateArea");function ht(r){let e=0;if(r&&r.length>0){e+=Math.abs(pt(r[0]));for(let t=1;t<r.length;t++)e-=Math.abs(pt(r[t]))}return e}nt(ht,"polygonArea");var li=j*j/2,lt=Math.PI/180;function pt(r){const e=r.length;if(e<=2)return 0;let t=0,n=0;for(;n<e;){const i=r[n],o=r[n+1===e?0:n+1],a=r[n+2>=e?(n+2)%e:n+2],s=i[0]*lt,l=o[1]*lt,f=a[0]*lt;t+=(f-s)*Math.sin(l),n++}return t*li}nt(pt,"ringArea");var cr=qr,Q=63710088e-1,St={centimeters:Q*100,centimetres:Q*100,degrees:Q/111325,feet:Q*3.28084,inches:Q*39.37,kilometers:Q/1e3,kilometres:Q/1e3,meters:Q,metres:Q,miles:Q/1609.344,millimeters:Q*1e3,millimetres:Q*1e3,nauticalmiles:Q/1852,radians:1,yards:Q*1.0936},ui={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Q,yards:1.0936133},vt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function ae(r,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=r,n}function fi(r,e,t){switch(r){case"Point":return te(e).geometry;case"LineString":return ie(e).geometry;case"Polygon":return Et(e).geometry;case"MultiPoint":return Dr(e).geometry;case"MultiLineString":return Yr(e).geometry;case"MultiPolygon":return Nr(e).geometry;default:throw new Error(r+" is invalid")}}function te(r,e,t){if(t===void 0&&(t={}),!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Qe(r[0])||!Qe(r[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:r};return ae(n,e,t)}function ci(r,e,t){return t===void 0&&(t={}),Pe(r.map(function(n){return te(n,e)}),t)}function Et(r,e,t){t===void 0&&(t={});for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:r};return ae(s,e,t)}function mi(r,e,t){return t===void 0&&(t={}),Pe(r.map(function(n){return Et(n,e)}),t)}function ie(r,e,t){if(t===void 0&&(t={}),r.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:r};return ae(n,e,t)}function hi(r,e,t){return t===void 0&&(t={}),Pe(r.map(function(n){return ie(n,e)}),t)}function Pe(r,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=r,t}function Yr(r,e,t){t===void 0&&(t={});var n={type:"MultiLineString",coordinates:r};return ae(n,e,t)}function Dr(r,e,t){t===void 0&&(t={});var n={type:"MultiPoint",coordinates:r};return ae(n,e,t)}function Nr(r,e,t){t===void 0&&(t={});var n={type:"MultiPolygon",coordinates:r};return ae(n,e,t)}function pi(r,e,t){t===void 0&&(t={});var n={type:"GeometryCollection",geometries:r};return ae(n,e,t)}function vi(r,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(r*t)/t}function Lt(r,e){e===void 0&&(e="kilometers");var t=St[e];if(!t)throw new Error(e+" units is invalid");return r*t}function it(r,e){e===void 0&&(e="kilometers");var t=St[e];if(!t)throw new Error(e+" units is invalid");return r/t}function gi(r,e){return De(it(r,e))}function di(r){var e=r%360;return e<0&&(e+=360),e}function De(r){var e=r%(2*Math.PI);return e*180/Math.PI}function oe(r){var e=r%360;return e*Math.PI/180}function yi(r,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("length must be a positive number");return Lt(it(r,e),t)}function bi(r,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(r>=0))throw new Error("area must be a positive number");var n=vt[e];if(!n)throw new Error("invalid original units");var i=vt[t];if(!i)throw new Error("invalid final units");return r/n*i}function Qe(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function kt(r){return!!r&&r.constructor===Object}function _i(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!Qe(e))throw new Error("bbox must only contain numbers")})}function wi(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const Mi=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:vt,bearingToAzimuth:di,convertArea:bi,convertLength:yi,degreesToRadians:oe,earthRadius:Q,factors:St,feature:ae,featureCollection:Pe,geometry:fi,geometryCollection:pi,isNumber:Qe,isObject:kt,lengthToDegrees:gi,lengthToRadians:it,lineString:ie,lineStrings:hi,multiLineString:Yr,multiPoint:Dr,multiPolygon:Nr,point:te,points:ci,polygon:Et,polygons:mi,radiansToDegrees:De,radiansToLength:Lt,round:vi,unitsFactors:ui,validateBBox:_i,validateId:wi},Symbol.toStringTag,{value:"Module"}));function Ne(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ee(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function zr(r,e,t){if(t===void 0&&(t={}),t.final===!0)return Pi(r,e);var n=Ne(r),i=Ne(e),o=oe(n[0]),a=oe(i[0]),s=oe(n[1]),l=oe(i[1]),f=Math.sin(a-o)*Math.cos(l),g=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return De(Math.atan2(f,g))}function Pi(r,e){var t=zr(e,r);return t=(t+180)%360,t}function Te(r,e,t){t===void 0&&(t={});var n=Ne(r),i=Ne(e),o=oe(i[1]-n[1]),a=oe(i[0]-n[0]),s=oe(n[1]),l=oe(i[1]),f=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(l);return Lt(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),t.units)}function mr(r,e,t,n){n===void 0&&(n={});var i=Ne(r),o=oe(i[0]),a=oe(i[1]),s=oe(t),l=it(e,n.units),f=Math.asin(Math.sin(a)*Math.cos(l)+Math.cos(a)*Math.sin(l)*Math.cos(s)),g=o+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(a),Math.cos(l)-Math.sin(a)*Math.sin(f)),b=De(g),$=De(f);return te([b,$],n.properties)}function Ge(r,e,t){if(r!==null)for(var n,i,o,a,s,l,f,g=0,b=0,$,d=r.type,S=d==="FeatureCollection",P=d==="Feature",C=S?r.features.length:1,T=0;T<C;T++){f=S?r.features[T].geometry:P?r.geometry:r,$=f?f.type==="GeometryCollection":!1,s=$?f.geometries.length:1;for(var u=0;u<s;u++){var m=0,h=0;if(a=$?f.geometries[u]:f,a!==null){l=a.coordinates;var v=a.type;switch(g=t&&(v==="Polygon"||v==="MultiPolygon")?1:0,v){case null:break;case"Point":if(e(l,b,T,m,h)===!1)return!1;b++,m++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(e(l[n],b,T,m,h)===!1)return!1;b++,v==="MultiPoint"&&m++}v==="LineString"&&m++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-g;i++){if(e(l[n][i],b,T,m,h)===!1)return!1;b++}v==="MultiLineString"&&m++,v==="Polygon"&&h++}v==="Polygon"&&m++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(h=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-g;o++){if(e(l[n][i][o],b,T,m,h)===!1)return!1;b++}h++}m++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(Ge(a.geometries[n],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function $i(r,e,t,n){var i=t;return Ge(r,function(o,a,s,l,f){a===0&&t===void 0?i=o:i=e(i,o,a,s,l,f)},n),i}function Gr(r,e){var t;switch(r.type){case"FeatureCollection":for(t=0;t<r.features.length&&e(r.features[t].properties,t)!==!1;t++);break;case"Feature":e(r.properties,0);break}}function Si(r,e,t){var n=t;return Gr(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function je(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var t=0;t<r.features.length&&e(r.features[t],t)!==!1;t++);}function Ei(r,e,t){var n=t;return je(r,function(i,o){o===0&&t===void 0?n=i:n=e(n,i,o)}),n}function Li(r){var e=[];return Ge(r,function(t){e.push(t)}),e}function Ct(r,e){var t,n,i,o,a,s,l,f,g,b,$=0,d=r.type==="FeatureCollection",S=r.type==="Feature",P=d?r.features.length:1;for(t=0;t<P;t++){for(s=d?r.features[t].geometry:S?r.geometry:r,f=d?r.features[t].properties:S?r.properties:{},g=d?r.features[t].bbox:S?r.bbox:void 0,b=d?r.features[t].id:S?r.id:void 0,l=s?s.type==="GeometryCollection":!1,a=l?s.geometries.length:1,i=0;i<a;i++){if(o=l?s.geometries[i]:s,o===null){if(e(null,$,f,g,b)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,$,f,g,b)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(e(o.geometries[n],$,f,g,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}$++}}function ki(r,e,t){var n=t;return Ct(r,function(i,o,a,s,l){o===0&&t===void 0?n=i:n=e(n,i,o,a,s,l)}),n}function Fe(r,e){Ct(r,function(t,n,i,o,a){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(ae(t,i,{bbox:o,id:a}),n,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var g=t.coordinates[f],b={type:l,coordinates:g};if(e(ae(b,i),n,f)===!1)return!1}})}function Ci(r,e,t){var n=t;return Fe(r,function(i,o,a){o===0&&a===0&&t===void 0?n=i:n=e(n,i,o,a)}),n}function xr(r,e){Fe(r,function(t,n,i){var o=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var s,l=0,f=0,g=0;if(Ge(t,function(b,$,d,S,P){if(s===void 0||n>l||S>f||P>g){s=b,l=n,f=S,g=P,o=0;return}var C=ie([s,b],t.properties);if(e(C,n,i,P,o)===!1)return!1;o++,s=b})===!1)return!1}}})}function Fi(r,e,t){var n=t,i=!1;return xr(r,function(o,a,s,l,f){i===!1&&t===void 0?n=o:n=e(n,o,a,s,l,f),i=!0}),n}function Jr(r,e){if(!r)throw new Error("geojson is required");Fe(r,function(t,n,i){if(t.geometry!==null){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(e(t,n,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(e(ie(a[s],t.properties),n,i,s)===!1)return!1;break}}})}function Ai(r,e,t){var n=t;return Jr(r,function(i,o,a,s){o===0&&t===void 0?n=i:n=e(n,i,o,a,s)}),n}function Bi(r,e){if(e=e||{},!kt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=l.length+o-1),ie([l[o],l[o+1]],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o-1),ie([l[i][o],l[i][o+1]],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o-1),ie([l[n][o],l[n][o+1]],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o-1),ie([l[n][i][o],l[n][i][o+1]],a,e)}throw new Error("geojson is invalid")}function Ri(r,e){if(e=e||{},!kt(e))throw new Error("options is invalid");var t=e.featureIndex||0,n=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,s;switch(r.type){case"FeatureCollection":t<0&&(t=r.features.length+t),a=a||r.features[t].properties,s=r.features[t].geometry;break;case"Feature":a=a||r.properties,s=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=r;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var l=s.coordinates;switch(s.type){case"Point":return te(l,a,e);case"MultiPoint":return n<0&&(n=l.length+n),te(l[n],a,e);case"LineString":return o<0&&(o=l.length+o),te(l[o],a,e);case"Polygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),te(l[i][o],a,e);case"MultiLineString":return n<0&&(n=l.length+n),o<0&&(o=l[n].length+o),te(l[n][o],a,e);case"MultiPolygon":return n<0&&(n=l.length+n),i<0&&(i=l[n].length+i),o<0&&(o=l[n][i].length-o),te(l[n][i][o],a,e)}throw new Error("geojson is invalid")}const Ti=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Li,coordEach:Ge,coordReduce:$i,featureEach:je,featureReduce:Ei,findPoint:Ri,findSegment:Bi,flattenEach:Fe,flattenReduce:Ci,geomEach:Ct,geomReduce:ki,lineEach:Jr,lineReduce:Ai,propEach:Gr,propReduce:Si,segmentEach:xr,segmentReduce:Fi},Symbol.toStringTag,{value:"Module"}));function hr(r){if(!r)throw new Error("geojson is required");var e=[];return Fe(r,function(t){Oi(t,e)}),Pe(e)}function Oi(r,e){var t=[],n=r.geometry;if(n!==null){switch(n.type){case"Polygon":t=Ee(n);break;case"LineString":t=[Ee(n)]}t.forEach(function(i){var o=qi(i,r.properties);o.forEach(function(a){a.id=e.length,e.push(a)})})}}function qi(r,e){var t=[];return r.reduce(function(n,i){var o=ie([n,i],e);return o.bbox=Xi(n,i),t.push(o),i}),t}function Xi(r,e){var t=r[0],n=r[1],i=e[0],o=e[1],a=t<i?t:i,s=n<o?n:o,l=t>i?t:i,f=n>o?n:o;return[a,s,l,f]}var Ft={exports:{}},Ir={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Sn,function(){function t(u,m,h,v,w){(function _(M,k,A,p,y){for(;p>A;){if(p-A>600){var O=p-A+1,z=k-A+1,me=Math.log(O),ne=.5*Math.exp(2*me/3),V=.5*Math.sqrt(me*ne*(O-ne)/O)*(z-O/2<0?-1:1),ue=Math.max(A,Math.floor(k-z*ne/O+V)),$e=Math.min(p,Math.floor(k+(O-z)*ne/O+V));_(M,k,ue,$e,y)}var ee=M[k],he=A,W=p;for(n(M,A,k),y(M[p],ee)>0&&n(M,A,p);he<W;){for(n(M,he,W),he++,W--;y(M[he],ee)<0;)he++;for(;y(M[W],ee)>0;)W--}y(M[A],ee)===0?n(M,A,W):n(M,++W,p),W<=k&&(A=W+1),k<=W&&(p=W-1)}})(u,m,h||0,v||u.length-1,w||i)}function n(u,m,h){var v=u[m];u[m]=u[h],u[h]=v}function i(u,m){return u<m?-1:u>m?1:0}var o=function(u){u===void 0&&(u=9),this._maxEntries=Math.max(4,u),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(u,m,h){if(!h)return m.indexOf(u);for(var v=0;v<m.length;v++)if(h(u,m[v]))return v;return-1}function s(u,m){l(u,0,u.children.length,m,u)}function l(u,m,h,v,w){w||(w=C(null)),w.minX=1/0,w.minY=1/0,w.maxX=-1/0,w.maxY=-1/0;for(var _=m;_<h;_++){var M=u.children[_];f(w,u.leaf?v(M):M)}return w}function f(u,m){return u.minX=Math.min(u.minX,m.minX),u.minY=Math.min(u.minY,m.minY),u.maxX=Math.max(u.maxX,m.maxX),u.maxY=Math.max(u.maxY,m.maxY),u}function g(u,m){return u.minX-m.minX}function b(u,m){return u.minY-m.minY}function $(u){return(u.maxX-u.minX)*(u.maxY-u.minY)}function d(u){return u.maxX-u.minX+(u.maxY-u.minY)}function S(u,m){return u.minX<=m.minX&&u.minY<=m.minY&&m.maxX<=u.maxX&&m.maxY<=u.maxY}function P(u,m){return m.minX<=u.maxX&&m.minY<=u.maxY&&m.maxX>=u.minX&&m.maxY>=u.minY}function C(u){return{children:u,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(u,m,h,v,w){for(var _=[m,h];_.length;)if(!((h=_.pop())-(m=_.pop())<=v)){var M=m+Math.ceil((h-m)/v/2)*v;t(u,M,m,h,w),_.push(m,M,M,h)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(u){var m=this.data,h=[];if(!P(u,m))return h;for(var v=this.toBBox,w=[];m;){for(var _=0;_<m.children.length;_++){var M=m.children[_],k=m.leaf?v(M):M;P(u,k)&&(m.leaf?h.push(M):S(u,k)?this._all(M,h):w.push(M))}m=w.pop()}return h},o.prototype.collides=function(u){var m=this.data;if(!P(u,m))return!1;for(var h=[];m;){for(var v=0;v<m.children.length;v++){var w=m.children[v],_=m.leaf?this.toBBox(w):w;if(P(u,_)){if(m.leaf||S(u,_))return!0;h.push(w)}}m=h.pop()}return!1},o.prototype.load=function(u){if(!u||!u.length)return this;if(u.length<this._minEntries){for(var m=0;m<u.length;m++)this.insert(u[m]);return this}var h=this._build(u.slice(),0,u.length-1,0);if(this.data.children.length)if(this.data.height===h.height)this._splitRoot(this.data,h);else{if(this.data.height<h.height){var v=this.data;this.data=h,h=v}this._insert(h,this.data.height-h.height-1,!0)}else this.data=h;return this},o.prototype.insert=function(u){return u&&this._insert(u,this.data.height-1),this},o.prototype.clear=function(){return this.data=C([]),this},o.prototype.remove=function(u,m){if(!u)return this;for(var h,v,w,_=this.data,M=this.toBBox(u),k=[],A=[];_||k.length;){if(_||(_=k.pop(),v=k[k.length-1],h=A.pop(),w=!0),_.leaf){var p=a(u,_.children,m);if(p!==-1)return _.children.splice(p,1),k.push(_),this._condense(k),this}w||_.leaf||!S(_,M)?v?(h++,_=v.children[h],w=!1):_=null:(k.push(_),A.push(h),h=0,v=_,_=_.children[0])}return this},o.prototype.toBBox=function(u){return u},o.prototype.compareMinX=function(u,m){return u.minX-m.minX},o.prototype.compareMinY=function(u,m){return u.minY-m.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(u){return this.data=u,this},o.prototype._all=function(u,m){for(var h=[];u;)u.leaf?m.push.apply(m,u.children):h.push.apply(h,u.children),u=h.pop();return m},o.prototype._build=function(u,m,h,v){var w,_=h-m+1,M=this._maxEntries;if(_<=M)return s(w=C(u.slice(m,h+1)),this.toBBox),w;v||(v=Math.ceil(Math.log(_)/Math.log(M)),M=Math.ceil(_/Math.pow(M,v-1))),(w=C([])).leaf=!1,w.height=v;var k=Math.ceil(_/M),A=k*Math.ceil(Math.sqrt(M));T(u,m,h,A,this.compareMinX);for(var p=m;p<=h;p+=A){var y=Math.min(p+A-1,h);T(u,p,y,k,this.compareMinY);for(var O=p;O<=y;O+=k){var z=Math.min(O+k-1,y);w.children.push(this._build(u,O,z,v-1))}}return s(w,this.toBBox),w},o.prototype._chooseSubtree=function(u,m,h,v){for(;v.push(m),!m.leaf&&v.length-1!==h;){for(var w=1/0,_=1/0,M=void 0,k=0;k<m.children.length;k++){var A=m.children[k],p=$(A),y=(O=u,z=A,(Math.max(z.maxX,O.maxX)-Math.min(z.minX,O.minX))*(Math.max(z.maxY,O.maxY)-Math.min(z.minY,O.minY))-p);y<_?(_=y,w=p<w?p:w,M=A):y===_&&p<w&&(w=p,M=A)}m=M||m.children[0]}var O,z;return m},o.prototype._insert=function(u,m,h){var v=h?u:this.toBBox(u),w=[],_=this._chooseSubtree(v,this.data,m,w);for(_.children.push(u),f(_,v);m>=0&&w[m].children.length>this._maxEntries;)this._split(w,m),m--;this._adjustParentBBoxes(v,w,m)},o.prototype._split=function(u,m){var h=u[m],v=h.children.length,w=this._minEntries;this._chooseSplitAxis(h,w,v);var _=this._chooseSplitIndex(h,w,v),M=C(h.children.splice(_,h.children.length-_));M.height=h.height,M.leaf=h.leaf,s(h,this.toBBox),s(M,this.toBBox),m?u[m-1].children.push(M):this._splitRoot(h,M)},o.prototype._splitRoot=function(u,m){this.data=C([u,m]),this.data.height=u.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(u,m,h){for(var v,w,_,M,k,A,p,y=1/0,O=1/0,z=m;z<=h-m;z++){var me=l(u,0,z,this.toBBox),ne=l(u,z,h,this.toBBox),V=(w=me,_=ne,M=void 0,k=void 0,A=void 0,p=void 0,M=Math.max(w.minX,_.minX),k=Math.max(w.minY,_.minY),A=Math.min(w.maxX,_.maxX),p=Math.min(w.maxY,_.maxY),Math.max(0,A-M)*Math.max(0,p-k)),ue=$(me)+$(ne);V<y?(y=V,v=z,O=ue<O?ue:O):V===y&&ue<O&&(O=ue,v=z)}return v||h-m},o.prototype._chooseSplitAxis=function(u,m,h){var v=u.leaf?this.compareMinX:g,w=u.leaf?this.compareMinY:b;this._allDistMargin(u,m,h,v)<this._allDistMargin(u,m,h,w)&&u.children.sort(v)},o.prototype._allDistMargin=function(u,m,h,v){u.children.sort(v);for(var w=this.toBBox,_=l(u,0,m,w),M=l(u,h-m,h,w),k=d(_)+d(M),A=m;A<h-m;A++){var p=u.children[A];f(_,u.leaf?w(p):p),k+=d(_)}for(var y=h-m-1;y>=m;y--){var O=u.children[y];f(M,u.leaf?w(O):O),k+=d(M)}return k},o.prototype._adjustParentBBoxes=function(u,m,h){for(var v=h;v>=0;v--)f(m[v],u)},o.prototype._condense=function(u){for(var m=u.length-1,h=void 0;m>=0;m--)u[m].children.length===0?m>0?(h=u[m-1].children).splice(h.indexOf(u[m]),1):this.clear():s(u[m],this.toBBox)},o})})(Ir);var Yi=Ir.exports;const Di=_t(Mi),Ni=_t(Ti),zi=_t(bn);var fe=Yi,Ur=Di,Hr=Ni,Se=zi.default,Gi=Hr.featureEach;Hr.coordEach;Ur.polygon;var pr=Ur.featureCollection;function Kr(r){var e=new fe(r);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Se(t),fe.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Se(i),n.push(i)}):Gi(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Se(i),n.push(i)}),fe.prototype.load.call(this,n)},e.remove=function(t,n){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Se(t),fe.prototype.remove.call(this,t,n)},e.clear=function(){return fe.prototype.clear.call(this)},e.search=function(t){var n=fe.prototype.search.call(this,this.toBBox(t));return pr(n)},e.collides=function(t){return fe.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=fe.prototype.all.call(this);return pr(t)},e.toJSON=function(){return fe.prototype.toJSON.call(this)},e.fromJSON=function(t){return fe.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var n;if(t.bbox)n=t.bbox;else if(Array.isArray(t)&&t.length===4)n=t;else if(Array.isArray(t)&&t.length===6)n=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")n=Se(t);else if(t.type==="FeatureCollection")n=Se(t);else throw new Error("invalid geojson");return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]}},e}Ft.exports=Kr;Ft.exports.default=Kr;var xi=Ft.exports;const Ji=En(xi);function Ii(r,e){var t={},n=[];if(r.type==="LineString"&&(r=ae(r)),e.type==="LineString"&&(e=ae(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=vr(r,e);return i&&n.push(i),Pe(n)}var o=Ji();return o.load(hr(e)),je(hr(r),function(a){je(o.search(a),function(s){var l=vr(a,s);if(l){var f=Ee(l).join(",");t[f]||(t[f]=!0,n.push(l))}})}),Pe(n)}function vr(r,e){var t=Ee(r),n=Ee(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(n.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],a=t[1][0],s=t[1][1],l=n[0][0],f=n[0][1],g=n[1][0],b=n[1][1],$=(b-f)*(a-i)-(g-l)*(s-o),d=(g-l)*(o-f)-(b-f)*(i-l),S=(a-i)*(o-f)-(s-o)*(i-l);if($===0)return null;var P=d/$,C=S/$;if(P>=0&&P<=1&&C>=0&&C<=1){var T=i+P*(a-i),u=o+P*(s-o);return te([T,u])}return null}function Ui(r,e,t){t===void 0&&(t={});var n=te([1/0,1/0],{dist:1/0}),i=0;return Fe(r,function(o){for(var a=Ee(o),s=0;s<a.length-1;s++){var l=te(a[s]);l.properties.dist=Te(e,l,t);var f=te(a[s+1]);f.properties.dist=Te(e,f,t);var g=Te(l,f,t),b=Math.max(l.properties.dist,f.properties.dist),$=zr(l,f),d=mr(e,b,$+90,t),S=mr(e,b,$-90,t),P=Ii(ie([d.geometry.coordinates,S.geometry.coordinates]),ie([l.geometry.coordinates,f.geometry.coordinates])),C=null;P.features.length>0&&(C=P.features[0],C.properties.dist=Te(e,C,t),C.properties.location=i+Te(l,C,t)),l.properties.dist<n.properties.dist&&(n=l,n.properties.index=s,n.properties.location=i),f.properties.dist<n.properties.dist&&(n=f,n.properties.index=s+1,n.properties.location=i+g),C&&C.properties.dist<n.properties.dist&&(n=C,n.properties.index=s),i+=g}}),n}const Hi=["==",["geometry-type"],"Polygon"],Ki=["==",["geometry-type"],"LineString"],Zi=["==",["geometry-type"],"Point"];function ut(r){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:Zr(r)}}}function Zr(r){return[Math.round(r[0]*1e7)/1e7,Math.round(r[1]*1e7)/1e7]}const Vr=$r({type:"FeatureCollection",features:[]}),Wr=$r(0),Vi=100;class Wi{constructor(e){J(this,"map");J(this,"active");J(this,"eventListenersSuccess");J(this,"eventListenersUpdated");J(this,"eventListenersFailure");J(this,"points");J(this,"cursor");J(this,"hover");J(this,"dragFrom");J(this,"previousStates");J(this,"onMouseMove",e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,n=this.dragFrom[1]-e.lngLat.lat;for(let i of this.points)i[0]-=t,i[1]-=n}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}});J(this,"onClick",e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(gr(this.points).forEach((n,i)=>{t.push([i+1,Ui(n,this.cursor).properties.dist])}),t.sort((n,i)=>n[1]-i[1]),t.length>0){let n=t[0][0];this.points.splice(n,0,this.cursor.geometry.coordinates),this.hover=n}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))});J(this,"onDoubleClick",e=>{this.active&&(e.preventDefault(),this.cursor=ut(e.lngLat.toArray()),this.onClick(e),this.finish())});J(this,"onMouseDown",e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())});J(this,"onMouseUp",()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())});J(this,"onKeypress",e=>{this.active&&(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())});J(this,"onKeyDown",e=>{this.active&&e.key=="Escape"&&(e.stopPropagation(),this.cancel())});this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e={type:"FeatureCollection",features:[]};this.points.forEach((i,o)=>{let a=ut(i);a.properties.hover=this.hover==o,a.properties.idx=o,e.features.push(a)}),e.features=e.features.concat(gr(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),Vr.set(e);let n="crosshair";this.hover!=null&&(n=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=n,Wr.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=ut(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(Zr),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>Vi&&this.previousStates.shift()}}function gr(r){let e=[];for(let t=0;t<r.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[t],r[t+1]]},properties:{}});return r.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[r[r.length-1],r[0]]},properties:{}}),e}function Qi(r){let e;const t=r[16].default,n=gt(t,r,r[24],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&16777216)&&dt(n,t,i,i[24],e?bt(t,i[24],o,null):yt(i[24]),null)},i(i){e||(B(n,i),e=!0)},o(i){R(n,i),e=!1},d(i){n&&n.d(i)}}}function ji(r){let e,t,n;function i(a){r[17](a)}let o={id:r[1],type:"circle",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],applyToClusters:r[9],minzoom:r[10],maxzoom:r[11],hoverCursor:r[12],manageHoverState:r[13],eventsIfTopMost:r[14],interactive:r[15],$$slots:{default:[Qi]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new wr({props:o}),U.push(()=>K(e,"hovered",i)),e.$on("click",r[18]),e.$on("dblclick",r[19]),e.$on("contextmenu",r[20]),e.$on("mouseenter",r[21]),e.$on("mousemove",r[22]),e.$on("mouseleave",r[23]),{c(){q(e.$$.fragment)},l(a){X(e.$$.fragment,a)},m(a,s){Y(e,a,s),n=!0},p(a,[s]){const l={};s&2&&(l.id=a[1]),s&4&&(l.source=a[2]),s&8&&(l.sourceLayer=a[3]),s&16&&(l.beforeId=a[4]),s&32&&(l.beforeLayerType=a[5]),s&64&&(l.paint=a[6]),s&128&&(l.layout=a[7]),s&256&&(l.filter=a[8]),s&512&&(l.applyToClusters=a[9]),s&1024&&(l.minzoom=a[10]),s&2048&&(l.maxzoom=a[11]),s&4096&&(l.hoverCursor=a[12]),s&8192&&(l.manageHoverState=a[13]),s&16384&&(l.eventsIfTopMost=a[14]),s&32768&&(l.interactive=a[15]),s&16777216&&(l.$$scope={dirty:s,ctx:a}),!t&&s&1&&(t=!0,l.hovered=a[0],H(()=>t=!1)),e.$set(l)},i(a){n||(B(e.$$.fragment,a),n=!0)},o(a){R(e.$$.fragment,a),n=!1},d(a){D(e,a)}}}function eo(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=Mr("circle")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:l=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:g}=e,{layout:b=void 0}=e,{filter:$=void 0}=e,{applyToClusters:d=void 0}=e,{minzoom:S=void 0}=e,{maxzoom:P=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:T=!1}=e,{hovered:u=null}=e,{eventsIfTopMost:m=!1}=e,{interactive:h=!0}=e;function v(y){u=y,t(0,u)}function w(y){re.call(this,r,y)}function _(y){re.call(this,r,y)}function M(y){re.call(this,r,y)}function k(y){re.call(this,r,y)}function A(y){re.call(this,r,y)}function p(y){re.call(this,r,y)}return r.$$set=y=>{"id"in y&&t(1,o=y.id),"source"in y&&t(2,a=y.source),"sourceLayer"in y&&t(3,s=y.sourceLayer),"beforeId"in y&&t(4,l=y.beforeId),"beforeLayerType"in y&&t(5,f=y.beforeLayerType),"paint"in y&&t(6,g=y.paint),"layout"in y&&t(7,b=y.layout),"filter"in y&&t(8,$=y.filter),"applyToClusters"in y&&t(9,d=y.applyToClusters),"minzoom"in y&&t(10,S=y.minzoom),"maxzoom"in y&&t(11,P=y.maxzoom),"hoverCursor"in y&&t(12,C=y.hoverCursor),"manageHoverState"in y&&t(13,T=y.manageHoverState),"hovered"in y&&t(0,u=y.hovered),"eventsIfTopMost"in y&&t(14,m=y.eventsIfTopMost),"interactive"in y&&t(15,h=y.interactive),"$$scope"in y&&t(24,i=y.$$scope)},[u,o,a,s,l,f,g,b,$,d,S,P,C,T,m,h,n,v,w,_,M,k,A,p,i]}class to extends ke{constructor(e){super(),Ce(this,e,eo,ji,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function ro(r){let e;const t=r[15].default,n=gt(t,r,r[23],null);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,o){n&&n.m(i,o),e=!0},p(i,o){n&&n.p&&(!e||o&8388608)&&dt(n,t,i,i[23],e?bt(t,i[23],o,null):yt(i[23]),null)},i(i){e||(B(n,i),e=!0)},o(i){R(n,i),e=!1},d(i){n&&n.d(i)}}}function no(r){let e,t,n;function i(a){r[16](a)}let o={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],interactive:r[14],$$slots:{default:[ro]},$$scope:{ctx:r}};return r[0]!==void 0&&(o.hovered=r[0]),e=new wr({props:o}),U.push(()=>K(e,"hovered",i)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){q(e.$$.fragment)},l(a){X(e.$$.fragment,a)},m(a,s){Y(e,a,s),n=!0},p(a,[s]){const l={};s&2&&(l.id=a[1]),s&4&&(l.source=a[2]),s&8&&(l.sourceLayer=a[3]),s&16&&(l.beforeId=a[4]),s&32&&(l.beforeLayerType=a[5]),s&64&&(l.paint=a[6]),s&128&&(l.layout=a[7]),s&256&&(l.filter=a[8]),s&512&&(l.minzoom=a[9]),s&1024&&(l.maxzoom=a[10]),s&2048&&(l.hoverCursor=a[11]),s&4096&&(l.manageHoverState=a[12]),s&8192&&(l.eventsIfTopMost=a[13]),s&16384&&(l.interactive=a[14]),s&8388608&&(l.$$scope={dirty:s,ctx:a}),!t&&s&1&&(t=!0,l.hovered=a[0],H(()=>t=!1)),e.$set(l)},i(a){n||(B(e.$$.fragment,a),n=!0)},o(a){R(e.$$.fragment,a),n=!1},d(a){D(e,a)}}}function io(r,e,t){let{$$slots:n={},$$scope:i}=e,{id:o=Mr("fill")}=e,{source:a=void 0}=e,{sourceLayer:s=void 0}=e,{beforeId:l=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:g}=e,{layout:b=void 0}=e,{filter:$=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:S=void 0}=e,{hoverCursor:P=void 0}=e,{manageHoverState:C=!1}=e,{hovered:T=null}=e,{eventsIfTopMost:u=!1}=e,{interactive:m=!0}=e;function h(p){T=p,t(0,T)}function v(p){re.call(this,r,p)}function w(p){re.call(this,r,p)}function _(p){re.call(this,r,p)}function M(p){re.call(this,r,p)}function k(p){re.call(this,r,p)}function A(p){re.call(this,r,p)}return r.$$set=p=>{"id"in p&&t(1,o=p.id),"source"in p&&t(2,a=p.source),"sourceLayer"in p&&t(3,s=p.sourceLayer),"beforeId"in p&&t(4,l=p.beforeId),"beforeLayerType"in p&&t(5,f=p.beforeLayerType),"paint"in p&&t(6,g=p.paint),"layout"in p&&t(7,b=p.layout),"filter"in p&&t(8,$=p.filter),"minzoom"in p&&t(9,d=p.minzoom),"maxzoom"in p&&t(10,S=p.maxzoom),"hoverCursor"in p&&t(11,P=p.hoverCursor),"manageHoverState"in p&&t(12,C=p.manageHoverState),"hovered"in p&&t(0,T=p.hovered),"eventsIfTopMost"in p&&t(13,u=p.eventsIfTopMost),"interactive"in p&&t(14,m=p.interactive),"$$scope"in p&&t(23,i=p.$$scope)},[T,o,a,s,l,f,g,b,$,d,S,P,C,u,m,n,h,v,w,_,M,k,A,i]}class Qr extends ke{constructor(e){super(),Ce(this,e,io,no,Le,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function oo(r){let e,t,n,i,o,a;return e=new Qr({props:{id:"edit-polygon-fill",filter:Hi,paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}}}),n=new _n({props:{id:"edit-polygon-lines",filter:Ki,paint:{"line-color":"black","line-width":8,"line-opacity":.5}}}),o=new to({props:{id:"edit-polygon-vertices",filter:Zi,paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}}),{c(){q(e.$$.fragment),t=G(),q(n.$$.fragment),i=G(),q(o.$$.fragment)},l(s){X(e.$$.fragment,s),t=x(s),X(n.$$.fragment,s),i=x(s),X(o.$$.fragment,s)},m(s,l){Y(e,s,l),F(s,t,l),Y(n,s,l),F(s,i,l),Y(o,s,l),a=!0},p:qe,i(s){a||(B(e.$$.fragment,s),B(n.$$.fragment,s),B(o.$$.fragment,s),a=!0)},o(s){R(e.$$.fragment,s),R(n.$$.fragment,s),R(o.$$.fragment,s),a=!1},d(s){s&&(L(t),L(i)),D(e,s),D(n,s),D(o,s)}}}function ao(r){let e,t;return e=new Pr({props:{data:r[0],$$slots:{default:[oo]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,i){Y(e,n,i),t=!0},p(n,[i]){const o={};i&1&&(o.data=n[0]),i&2&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){R(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function so(r,e,t){let n;return Ze(r,Vr,i=>t(0,n=i)),[n]}class lo extends ke{constructor(e){super(),Ce(this,e,so,ao,Le,{})}}function uo(r){let e,t="Map loading...";return{c(){e=we("p"),e.textContent=t},l(n){e=Me(n,"P",{"data-svelte-h":!0}),ct(e)!=="svelte-1r8199k"&&(e.textContent=t)},m(n,i){F(n,e,i)},p:qe,i:qe,o:qe,d(n){n&&L(e)}}}function fo(r){let e,t,n,i;e=new On({props:{$$slots:{default:[mo]},$$scope:{ctx:r}}}),e.$on("click",r[5]);let o=r[0].summary.polygon&&dr(r);return{c(){q(e.$$.fragment),t=G(),o&&o.c(),n=Ve()},l(a){X(e.$$.fragment,a),t=x(a),o&&o.l(a),n=Ve()},m(a,s){Y(e,a,s),F(a,t,s),o&&o.m(a,s),F(a,n,s),i=!0},p(a,s){const l={};s&4096&&(l.$$scope={dirty:s,ctx:a}),e.$set(l),a[0].summary.polygon?o?(o.p(a,s),s&1&&B(o,1)):(o=dr(a),o.c(),B(o,1),o.m(n.parentNode,n)):o&&(br(),R(o,1,1,()=>{o=null}),_r())},i(a){i||(B(e.$$.fragment,a),B(o),i=!0)},o(a){R(e.$$.fragment,a),R(o),i=!1},d(a){a&&(L(t),L(n)),D(e,a),o&&o.d(a)}}}function co(r){let e,t,n,i,o,a,s;return t=new st({props:{$$slots:{default:[po]},$$scope:{ctx:r}}}),t.$on("click",r[7]),i=new st({props:{$$slots:{default:[vo]},$$scope:{ctx:r}}}),i.$on("click",r[8]),a=new st({props:{disabled:r[4]==0,$$slots:{default:[bo]},$$scope:{ctx:r}}}),a.$on("click",r[9]),{c(){e=we("div"),q(t.$$.fragment),n=G(),q(i.$$.fragment),o=G(),q(a.$$.fragment),this.h()},l(l){e=Me(l,"DIV",{style:!0});var f=et(e);X(t.$$.fragment,f),n=x(f),X(i.$$.fragment,f),o=x(f),X(a.$$.fragment,f),f.forEach(L),this.h()},h(){Xe(e,"display","flex"),Xe(e,"justify-content","space-between")},m(l,f){F(l,e,f),Y(t,e,null),Ye(e,n),Y(i,e,null),Ye(e,o),Y(a,e,null),s=!0},p(l,f){const g={};f&4096&&(g.$$scope={dirty:f,ctx:l}),t.$set(g);const b={};f&4096&&(b.$$scope={dirty:f,ctx:l}),i.$set(b);const $={};f&16&&($.disabled=l[4]==0),f&4112&&($.$$scope={dirty:f,ctx:l}),a.$set($)},i(l){s||(B(t.$$.fragment,l),B(i.$$.fragment,l),B(a.$$.fragment,l),s=!0)},o(l){R(t.$$.fragment,l),R(i.$$.fragment,l),R(a.$$.fragment,l),s=!1},d(l){l&&L(e),D(t),D(i),D(a)}}}function mo(r){let e;return{c(){e=se("Edit polygon")},l(t){e=le(t,"Edit polygon")},m(t,n){F(t,e,n)},d(t){t&&L(e)}}}function dr(r){let e,t,n,i,o=cr(r[0].summary.polygon).toFixed(1)+"",a,s,l;return e=new $n({props:{$$slots:{default:[ho]},$$scope:{ctx:r}}}),e.$on("click",r[6]),{c(){q(e.$$.fragment),t=G(),n=we("p"),i=se("Polygon area: "),a=se(o),s=se(" square meters")},l(f){X(e.$$.fragment,f),t=x(f),n=Me(f,"P",{});var g=et(n);i=le(g,"Polygon area: "),a=le(g,o),s=le(g," square meters"),g.forEach(L)},m(f,g){Y(e,f,g),F(f,t,g),F(f,n,g),Ye(n,i),Ye(n,a),Ye(n,s),l=!0},p(f,g){const b={};g&4096&&(b.$$scope={dirty:g,ctx:f}),e.$set(b),(!l||g&1)&&o!==(o=cr(f[0].summary.polygon).toFixed(1)+"")&&yr(a,o)},i(f){l||(B(e.$$.fragment,f),l=!0)},o(f){R(e.$$.fragment,f),l=!1},d(f){f&&(L(t),L(n)),D(e,f)}}}function ho(r){let e;return{c(){e=se("Delete and start over")},l(t){e=le(t,"Delete and start over")},m(t,n){F(t,e,n)},d(t){t&&L(e)}}}function po(r){let e;return{c(){e=se("Finish")},l(t){e=le(t,"Finish")},m(t,n){F(t,e,n)},d(t){t&&L(e)}}}function vo(r){let e;return{c(){e=se("Cancel")},l(t){e=le(t,"Cancel")},m(t,n){F(t,e,n)},d(t){t&&L(e)}}}function go(r){let e,t,n;return{c(){e=se("Undo ("),t=se(r[4]),n=se(")")},l(i){e=le(i,"Undo ("),t=le(i,r[4]),n=le(i,")")},m(i,o){F(i,e,o),F(i,t,o),F(i,n,o)},p(i,o){o&16&&yr(t,i[4])},d(i){i&&(L(e),L(t),L(n))}}}function yo(r){let e;return{c(){e=se("Undo")},l(t){e=le(t,"Undo")},m(t,n){F(t,e,n)},p:qe,d(t){t&&L(e)}}}function bo(r){let e;function t(o,a){return o[4]==0?yo:go}let n=t(r),i=n(r);return{c(){i.c(),e=Ve()},l(o){i.l(o),e=Ve()},m(o,a){i.m(o,a),F(o,e,a)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&L(e),i.d(o)}}}function _o(r){let e,t;return e=new Qr({props:{layout:{visibility:r[2]?"none":"visible"},paint:{"fill-color":"red","fill-opacity":.8}}}),{c(){q(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,i){Y(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.layout={visibility:n[2]?"none":"visible"}),e.$set(o)},i(n){t||(B(e.$$.fragment,n),t=!0)},o(n){R(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function wo(r){let e,t,n,i,o,a;return e=new Mn({props:{map:r[1]}}),n=new lo({}),o=new Pr({props:{data:r[3],$$slots:{default:[_o]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment),t=G(),q(n.$$.fragment),i=G(),q(o.$$.fragment)},l(s){X(e.$$.fragment,s),t=x(s),X(n.$$.fragment,s),i=x(s),X(o.$$.fragment,s)},m(s,l){Y(e,s,l),F(s,t,l),Y(n,s,l),F(s,i,l),Y(o,s,l),a=!0},p(s,l){const f={};l&2&&(f.map=s[1]),e.$set(f);const g={};l&8&&(g.data=s[3]),l&4100&&(g.$$scope={dirty:l,ctx:s}),o.$set(g)},i(s){a||(B(e.$$.fragment,s),B(n.$$.fragment,s),B(o.$$.fragment,s),a=!0)},o(s){R(e.$$.fragment,s),R(n.$$.fragment,s),R(o.$$.fragment,s),a=!1},d(s){s&&(L(t),L(i)),D(e,s),D(n,s),D(o,s)}}}function Mo(r){let e,t,n,i,o,a,s;const l=[co,fo,uo],f=[];function g(d,S){return d[2]?0:d[1]?1:2}e=g(r),t=f[e]=l[e](r);function b(d){r[10](d)}let $={style:"https://api.maptiler.com/maps/uk-openzoomstack-light/style.json?key=MZEJTanw3WpxRvt7qDfo",standardControls:!0,$$slots:{default:[wo,({map:d})=>({1:d}),({map:d})=>d?2:0]},$$scope:{ctx:r}};return r[1]!==void 0&&($.map=r[1]),o=new wn({props:$}),U.push(()=>K(o,"map",b)),o.$on("error",r[11]),{c(){t.c(),n=G(),i=we("div"),q(o.$$.fragment),this.h()},l(d){t.l(d),n=x(d),i=Me(d,"DIV",{style:!0});var S=et(i);X(o.$$.fragment,S),S.forEach(L),this.h()},h(){Xe(i,"position","relative"),Xe(i,"width","100%"),Xe(i,"height","300px")},m(d,S){f[e].m(d,S),F(d,n,S),F(d,i,S),Y(o,i,null),s=!0},p(d,[S]){let P=e;e=g(d),e===P?f[e].p(d,S):(br(),R(f[P],1,1,()=>{f[P]=null}),_r(),t=f[e],t?t.p(d,S):(t=f[e]=l[e](d),t.c()),B(t,1),t.m(n.parentNode,n));const C={};S&4110&&(C.$$scope={dirty:S,ctx:d}),!a&&S&2&&(a=!0,C.map=d[1],H(()=>a=!1)),o.$set(C)},i(d){s||(B(t),B(o.$$.fragment,d),s=!0)},o(d){R(t),R(o.$$.fragment,d),s=!1},d(d){d&&(L(n),L(i)),f[e].d(d),D(o)}}}function Po(r,e,t){let n,i,o;Ze(r,I,P=>t(0,i=P)),Ze(r,Wr,P=>t(4,o=P));let a=null,s=null;dn(()=>{s==null||s.tearDown()});function l(){a&&(t(2,s=new Wi(a)),i.summary.polygon?s.editExisting(i.summary.polygon):s.startNew(),s.addEventListenerSuccess(async P=>{t(2,s=null),ur(I,i.summary.polygon=P,i)}),s.addEventListenerFailure(()=>{t(2,s=null)}))}function f(){ur(I,i.summary.polygon=null,i),l()}const g=()=>s==null?void 0:s.finish(),b=()=>s==null?void 0:s.cancel(),$=()=>s==null?void 0:s.undo();function d(P){a=P,t(1,a)}const S=P=>{console.log(P.detail.error)};return r.$$.update=()=>{r.$$.dirty&1&&t(3,n=i.summary.polygon??{type:"FeatureCollection",features:[]}),r.$$.dirty&2&&a&&l()},[i,a,s,n,o,l,f,g,b,$,d,S]}class $o extends ke{constructor(e){super(),Ce(this,e,Po,Mo,Le,{})}}function So(r){let e,t,n,i,o,a,s,l,f,g,b,$,d,S,P,C,T,u,m,h,v,w,_,M,k,A,p,y,O,z,me,ne,V,ue,$e,ee,he,W,pe,ot,xe,ve,at,Je,ye,At="Network context",Ie,be,Bt=`Please add a drawing of the area being assessed below, including the location
  of measures proposed by the scheme.`,Ue,_e,He;e=new Bn({props:{links:[["Tools","/"],["Area check tool","/area_check"]],current:"Summary of Scheme"}});function jr(c){r[1](c)}let Rt={label:"Date of design review"};r[0].summary.dateDesignReview!==void 0&&(Rt.value=r[0].summary.dateDesignReview),n=new Re({props:Rt}),U.push(()=>K(n,"value",jr));function en(c){r[2](c)}let Tt={label:"Scheme reference"};r[0].summary.schemeReference!==void 0&&(Tt.value=r[0].summary.schemeReference),a=new Re({props:Tt}),U.push(()=>K(a,"value",en));function tn(c){r[3](c)}let Ot={label:"Scheme name"};r[0].summary.schemeName!==void 0&&(Ot.value=r[0].summary.schemeName),f=new Re({props:Ot}),U.push(()=>K(f,"value",tn));function rn(c){r[4](c)}let qt={label:"Scheme summary"};r[0].summary.schemeSummary!==void 0&&(qt.value=r[0].summary.schemeSummary),$=new Ke({props:qt}),U.push(()=>K($,"value",rn));function nn(c){r[5](c)}let Xt={label:"Scheme information reviewed"};r[0].summary.schemeInfoReviewed!==void 0&&(Xt.value=r[0].summary.schemeInfoReviewed),P=new Ke({props:Xt}),U.push(()=>K(P,"value",nn));function on(c){r[6](c)}let Yt={label:"Authority",emptyOption:!0,choices:Ae(Ln)};r[0].summary.authority!==void 0&&(Yt.value=r[0].summary.authority),u=new Be({props:Yt}),U.push(()=>K(u,"value",on));function an(c){r[7](c)}let Dt={label:"Transport / Combined Authority",emptyOption:!0,choices:Ae(kn)};r[0].summary.transportOrCombinedAuthority!==void 0&&(Dt.value=r[0].summary.transportOrCombinedAuthority),v=new Be({props:Dt}),U.push(()=>K(v,"value",an));function sn(c){r[8](c)}let Nt={label:"Region",emptyOption:!0,choices:Ae(Cn)};r[0].summary.region!==void 0&&(Nt.value=r[0].summary.region),M=new Be({props:Nt}),U.push(()=>K(M,"value",sn));function ln(c){r[9](c)}let zt={label:"Funding programme",emptyOption:!0,choices:Ae(Fn)};r[0].summary.fundingProgramme!==void 0&&(zt.value=r[0].summary.fundingProgramme),p=new Be({props:zt}),U.push(()=>K(p,"value",ln));function un(c){r[10](c)}let Gt={label:"Design stage",emptyOption:!0,choices:Ae(An)};r[0].summary.designStage!==void 0&&(Gt.value=r[0].summary.designStage),z=new Be({props:Gt}),U.push(()=>K(z,"value",un));function fn(c){r[11](c)}let xt={label:"Funding conditions"};r[0].summary.fundingConditions!==void 0&&(xt.value=r[0].summary.fundingConditions),V=new Ke({props:xt}),U.push(()=>K(V,"value",fn));function cn(c){r[12](c)}let Jt={label:"Inspector email address"};r[0].summary.inspectorEmail!==void 0&&(Jt.value=r[0].summary.inspectorEmail),ee=new Re({props:Jt}),U.push(()=>K(ee,"value",cn));function mn(c){r[13](c)}let It={label:"Scheme area size (km)"};r[0].summary.schemeAreaSizeKm2!==void 0&&(It.value=r[0].summary.schemeAreaSizeKm2),pe=new Re({props:It}),U.push(()=>K(pe,"value",mn));function hn(c){r[14](c)}let Ut={label:"Notes"};return r[0].summary.notes!==void 0&&(Ut.value=r[0].summary.notes),ve=new Ke({props:Ut}),U.push(()=>K(ve,"value",hn)),_e=new $o({}),{c(){q(e.$$.fragment),t=G(),q(n.$$.fragment),o=G(),q(a.$$.fragment),l=G(),q(f.$$.fragment),b=G(),q($.$$.fragment),S=G(),q(P.$$.fragment),T=G(),q(u.$$.fragment),h=G(),q(v.$$.fragment),_=G(),q(M.$$.fragment),A=G(),q(p.$$.fragment),O=G(),q(z.$$.fragment),ne=G(),q(V.$$.fragment),$e=G(),q(ee.$$.fragment),W=G(),q(pe.$$.fragment),xe=G(),q(ve.$$.fragment),Je=G(),ye=we("h2"),ye.textContent=At,Ie=G(),be=we("p"),be.textContent=Bt,Ue=G(),q(_e.$$.fragment)},l(c){X(e.$$.fragment,c),t=x(c),X(n.$$.fragment,c),o=x(c),X(a.$$.fragment,c),l=x(c),X(f.$$.fragment,c),b=x(c),X($.$$.fragment,c),S=x(c),X(P.$$.fragment,c),T=x(c),X(u.$$.fragment,c),h=x(c),X(v.$$.fragment,c),_=x(c),X(M.$$.fragment,c),A=x(c),X(p.$$.fragment,c),O=x(c),X(z.$$.fragment,c),ne=x(c),X(V.$$.fragment,c),$e=x(c),X(ee.$$.fragment,c),W=x(c),X(pe.$$.fragment,c),xe=x(c),X(ve.$$.fragment,c),Je=x(c),ye=Me(c,"H2",{"data-svelte-h":!0}),ct(ye)!=="svelte-1tcb68x"&&(ye.textContent=At),Ie=x(c),be=Me(c,"P",{"data-svelte-h":!0}),ct(be)!=="svelte-1unchfe"&&(be.textContent=Bt),Ue=x(c),X(_e.$$.fragment,c)},m(c,E){Y(e,c,E),F(c,t,E),Y(n,c,E),F(c,o,E),Y(a,c,E),F(c,l,E),Y(f,c,E),F(c,b,E),Y($,c,E),F(c,S,E),Y(P,c,E),F(c,T,E),Y(u,c,E),F(c,h,E),Y(v,c,E),F(c,_,E),Y(M,c,E),F(c,A,E),Y(p,c,E),F(c,O,E),Y(z,c,E),F(c,ne,E),Y(V,c,E),F(c,$e,E),Y(ee,c,E),F(c,W,E),Y(pe,c,E),F(c,xe,E),Y(ve,c,E),F(c,Je,E),F(c,ye,E),F(c,Ie,E),F(c,be,E),F(c,Ue,E),Y(_e,c,E),He=!0},p(c,[E]){const Ht={};!i&&E&1&&(i=!0,Ht.value=c[0].summary.dateDesignReview,H(()=>i=!1)),n.$set(Ht);const Kt={};!s&&E&1&&(s=!0,Kt.value=c[0].summary.schemeReference,H(()=>s=!1)),a.$set(Kt);const Zt={};!g&&E&1&&(g=!0,Zt.value=c[0].summary.schemeName,H(()=>g=!1)),f.$set(Zt);const Vt={};!d&&E&1&&(d=!0,Vt.value=c[0].summary.schemeSummary,H(()=>d=!1)),$.$set(Vt);const Wt={};!C&&E&1&&(C=!0,Wt.value=c[0].summary.schemeInfoReviewed,H(()=>C=!1)),P.$set(Wt);const Qt={};!m&&E&1&&(m=!0,Qt.value=c[0].summary.authority,H(()=>m=!1)),u.$set(Qt);const jt={};!w&&E&1&&(w=!0,jt.value=c[0].summary.transportOrCombinedAuthority,H(()=>w=!1)),v.$set(jt);const er={};!k&&E&1&&(k=!0,er.value=c[0].summary.region,H(()=>k=!1)),M.$set(er);const tr={};!y&&E&1&&(y=!0,tr.value=c[0].summary.fundingProgramme,H(()=>y=!1)),p.$set(tr);const rr={};!me&&E&1&&(me=!0,rr.value=c[0].summary.designStage,H(()=>me=!1)),z.$set(rr);const nr={};!ue&&E&1&&(ue=!0,nr.value=c[0].summary.fundingConditions,H(()=>ue=!1)),V.$set(nr);const ir={};!he&&E&1&&(he=!0,ir.value=c[0].summary.inspectorEmail,H(()=>he=!1)),ee.$set(ir);const or={};!ot&&E&1&&(ot=!0,or.value=c[0].summary.schemeAreaSizeKm2,H(()=>ot=!1)),pe.$set(or);const ar={};!at&&E&1&&(at=!0,ar.value=c[0].summary.notes,H(()=>at=!1)),ve.$set(ar)},i(c){He||(B(e.$$.fragment,c),B(n.$$.fragment,c),B(a.$$.fragment,c),B(f.$$.fragment,c),B($.$$.fragment,c),B(P.$$.fragment,c),B(u.$$.fragment,c),B(v.$$.fragment,c),B(M.$$.fragment,c),B(p.$$.fragment,c),B(z.$$.fragment,c),B(V.$$.fragment,c),B(ee.$$.fragment,c),B(pe.$$.fragment,c),B(ve.$$.fragment,c),B(_e.$$.fragment,c),He=!0)},o(c){R(e.$$.fragment,c),R(n.$$.fragment,c),R(a.$$.fragment,c),R(f.$$.fragment,c),R($.$$.fragment,c),R(P.$$.fragment,c),R(u.$$.fragment,c),R(v.$$.fragment,c),R(M.$$.fragment,c),R(p.$$.fragment,c),R(z.$$.fragment,c),R(V.$$.fragment,c),R(ee.$$.fragment,c),R(pe.$$.fragment,c),R(ve.$$.fragment,c),R(_e.$$.fragment,c),He=!1},d(c){c&&(L(t),L(o),L(l),L(b),L(S),L(T),L(h),L(_),L(A),L(O),L(ne),L($e),L(W),L(xe),L(Je),L(ye),L(Ie),L(be),L(Ue)),D(e,c),D(n,c),D(a,c),D(f,c),D($,c),D(P,c),D(u,c),D(v,c),D(M,c),D(p,c),D(z,c),D(V,c),D(ee,c),D(pe,c),D(ve,c),D(_e,c)}}}function Eo(r,e,t){let n;Ze(r,I,u=>t(0,n=u));function i(u){r.$$.not_equal(n.summary.dateDesignReview,u)&&(n.summary.dateDesignReview=u,I.set(n))}function o(u){r.$$.not_equal(n.summary.schemeReference,u)&&(n.summary.schemeReference=u,I.set(n))}function a(u){r.$$.not_equal(n.summary.schemeName,u)&&(n.summary.schemeName=u,I.set(n))}function s(u){r.$$.not_equal(n.summary.schemeSummary,u)&&(n.summary.schemeSummary=u,I.set(n))}function l(u){r.$$.not_equal(n.summary.schemeInfoReviewed,u)&&(n.summary.schemeInfoReviewed=u,I.set(n))}function f(u){r.$$.not_equal(n.summary.authority,u)&&(n.summary.authority=u,I.set(n))}function g(u){r.$$.not_equal(n.summary.transportOrCombinedAuthority,u)&&(n.summary.transportOrCombinedAuthority=u,I.set(n))}function b(u){r.$$.not_equal(n.summary.region,u)&&(n.summary.region=u,I.set(n))}function $(u){r.$$.not_equal(n.summary.fundingProgramme,u)&&(n.summary.fundingProgramme=u,I.set(n))}function d(u){r.$$.not_equal(n.summary.designStage,u)&&(n.summary.designStage=u,I.set(n))}function S(u){r.$$.not_equal(n.summary.fundingConditions,u)&&(n.summary.fundingConditions=u,I.set(n))}function P(u){r.$$.not_equal(n.summary.inspectorEmail,u)&&(n.summary.inspectorEmail=u,I.set(n))}function C(u){r.$$.not_equal(n.summary.schemeAreaSizeKm2,u)&&(n.summary.schemeAreaSizeKm2=u,I.set(n))}function T(u){r.$$.not_equal(n.summary.notes,u)&&(n.summary.notes=u,I.set(n))}return[n,i,o,a,s,l,f,g,b,$,d,S,P,C,T]}class Io extends ke{constructor(e){super(),Ce(this,e,Eo,So,Le,{})}}export{Io as component};
