# Code generation scripts

Manually copying dozens of scorecard questions from Excel isn't feasible, so these scripts automate that process. The CSV files are **not** intended to be edited later and the scripts re-run; the source of truth becomes the generated Svelte files. Those files are **manually edited** to adjust wording, add links, introduce formatting, etc. Everything is checked in here just for reference.

The CSV input files were made with LibreOffice, saving each sheet as a CSV with default options. Leading and trailing lines were manually deleted.

## Authority Name Handling
We also generate here a map from various aliases people use for local authorities. This was initially done because the list of authority names used in the spreadsheet version of this tool did not align with the officially sanctioned ATE names for authorities.

The inputs to this process are `/inputs/authority_aliases.csv` and `/inputs/original_list.csv`. The former can be acquired from the 'Authority alias to ONS region mapping' found on sharepoint. NB if you get a fresh version of this, do remove the authority ID column. The latter was taken from our code so if you want to update it you might want to append to it from `src/lib/authority_names/authorityNameList.json`.

This allows us to validate and update files (either xlsx or json) generated by older versions of the tool, and update them to use the latest authority name list.

To run:
1. Ensure that `authority_aliases.csv` is the latest version and has its id column removed. Make sure `/inputs/original_list.csv` is updated with any new authority names in since this was last updated if necessary. This can be done by comparing `/inputs/original_list.csv` against `src/lib/authority_names/authorityNameList.json`and ensuring anything in `src/lib/authority_names/authorityNameList.json` but not in `/inputs/original_list.csv` is added to `/inputs/original_list.csv`
2. Then run `python3 authority_names.py`
3. Pay attention to `name not found in keys: {name}`. These represent names in `original_list.csv` which don't exist in `authority_aliases.csv`. This is expected for London boroughs since ATE doesn't generally deal with them, and `Wales`, `Scotland`, `Northern Ireland` since these aren't authorities and only exist because ATE similarly generally doesn't deal with authorities from these places, but we still support them in this tool a little bit.
