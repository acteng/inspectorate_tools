import{s as j,l as W,e as w,a as K,c as B,b as M,g as q,f as p,q as y,v as Y,i as b,h as C,y as L,u as x,m as $,o as ee,x as pe,C as ze,X as Me,k as R,r as Ae,D as V,p as De,w as Oe,n as be,V as T,K as Ne,t as E,d as P,Z as ce,F as Q,_ as Te,U as Ke}from"./scheduler.4ZNDCSWA.js";import{S as te,i as le,t as v,b as S,c as ne,a as ae,m as se,d as oe,e as qe,g as ye,f as ke}from"./index.xRKM1n3P.js";import{v as Ge}from"./v4.D8aEg3BZ.js";import{e as ue}from"./each.DpHudclE.js";import{C as Re}from"./DefaultButton.CEkMkJr5.js";import"./index.V9h0-FkH.js";import{S as Ue}from"./SecondaryButton.yCPBUDia.js";import{S as Ve}from"./Select.BL8Q_CLJ.js";import{k as N,u as Fe,d as Ze}from"./index.CuK0LU9V.js";const Xe=l=>({}),fe=l=>({});function je(l){let e,n,s,t,_,o,r,u,c;const m=l[5].default,d=W(m,l,l[4],null),h=l[5].right,a=W(h,l,l[4],fe);return{c(){e=w("div"),n=w("input"),s=K(),t=w("label"),d&&d.c(),_=K(),o=w("span"),a&&a.c(),this.h()},l(i){e=B(i,"DIV",{class:!0,style:!0});var g=M(e);n=B(g,"INPUT",{type:!0,class:!0,id:!0}),s=q(g),t=B(g,"LABEL",{class:!0,for:!0,title:!0});var A=M(t);d&&d.l(A),A.forEach(p),_=q(g),o=B(g,"SPAN",{style:!0});var I=M(o);a&&a.l(I),I.forEach(p),g.forEach(p),this.h()},h(){y(n,"type","checkbox"),y(n,"class","govuk-checkboxes__input"),y(n,"id",l[3]),y(t,"class","govuk-label govuk-checkboxes__label"),y(t,"for",l[3]),y(t,"title",l[1]),Y(o,"float","right"),y(e,"class","govuk-checkboxes__item"),y(e,"style",l[2])},m(i,g){b(i,e,g),C(e,n),n.checked=l[0],C(e,s),C(e,t),d&&d.m(t,null),C(e,_),C(e,o),a&&a.m(o,null),r=!0,u||(c=[L(n,"change",l[7]),L(n,"change",l[6])],u=!0)},p(i,[g]){g&1&&(n.checked=i[0]),d&&d.p&&(!r||g&16)&&x(d,m,i,i[4],r?ee(m,i[4],g,null):$(i[4]),null),(!r||g&2)&&y(t,"title",i[1]),a&&a.p&&(!r||g&16)&&x(a,h,i,i[4],r?ee(h,i[4],g,Xe):$(i[4]),fe)},i(i){r||(v(d,i),v(a,i),r=!0)},o(i){S(d,i),S(a,i),r=!1},d(i){i&&p(e),d&&d.d(i),a&&a.d(i),u=!1,pe(c)}}}function He(l,e,n){let{$$slots:s={},$$scope:t}=e;const _=Me(s);let{checked:o}=e,{hint:r=null}=e,c=_.right!==void 0?"float: none":"",m=Ge();function d(a){ze.call(this,l,a)}function h(){o=this.checked,n(0,o)}return l.$$set=a=>{"checked"in a&&n(0,o=a.checked),"hint"in a&&n(1,r=a.hint),"$$scope"in a&&n(4,t=a.$$scope)},[o,r,c,m,t,s,d,h]}class dt extends te{constructor(e){super(),le(this,e,He,je,j,{checked:0,hint:1})}}function _e(l,e,n){const s=l.slice();return s[6]=e[n][0],s[7]=e[n][1],s}function Je(l){let e;return{c(){e=E("disabled")},l(n){e=P(n,"disabled")},m(n,s){b(n,e,s)},d(n){n&&p(e)}}}function Qe(l){let e;return{c(){e=E("enabled")},l(n){e=P(n,"enabled")},m(n,s){b(n,e,s)},d(n){n&&p(e)}}}function We(l){let e,n=l[7]+"",s,t;return{c(){e=E("Set "),s=E(n),t=E(` API key
      `)},l(_){e=P(_,"Set "),s=P(_,n),t=P(_,` API key
      `)},m(_,o){b(_,e,o),b(_,s,o),b(_,t,o)},p:be,d(_){_&&(p(e),p(s),p(t))}}}function de(l){let e,n,s=l[7]+"",t,_,o,r,u;function c(a,i){return U(a[6])?Qe:Je}let d=c(l)(l);function h(){return l[5](l[6])}return r=new Ue({props:{$$slots:{default:[We]},$$scope:{ctx:l}}}),r.$on("click",h),{c(){e=w("p"),n=w("u"),t=E(s),_=E(`
        : `),d.c(),o=K(),ne(r.$$.fragment)},l(a){e=B(a,"P",{});var i=M(e);n=B(i,"U",{});var g=M(n);t=P(g,s),g.forEach(p),_=P(i,`
        : `),d.l(i),i.forEach(p),o=q(a),ae(r.$$.fragment,a)},m(a,i){b(a,e,i),C(e,n),C(n,t),C(e,_),d.m(e,null),b(a,o,i),se(r,a,i),u=!0},p(a,i){l=a;const g={};i&1024&&(g.$$scope={dirty:i,ctx:l}),r.$set(g)},i(a){u||(v(r.$$.fragment,a),u=!0)},o(a){S(r.$$.fragment,a),u=!1},d(a){a&&(p(e),p(o)),d.d(),oe(r,a)}}}function me(l){let e,n,s=ue([[X,"Google satellite imagery"],[F,"Bluesky satellite imagery"],[Z,"Ordnance Survey"]]),t=[];for(let o=0;o<3;o+=1)t[o]=de(_e(l,s,o));const _=o=>S(t[o],1,1,()=>{t[o]=null});return{c(){for(let o=0;o<3;o+=1)t[o].c();e=V()},l(o){for(let r=0;r<3;r+=1)t[r].l(o);e=V()},m(o,r){for(let u=0;u<3;u+=1)t[u]&&t[u].m(o,r);b(o,e,r),n=!0},p(o,r){if(r&8){s=ue([[X,"Google satellite imagery"],[F,"Bluesky satellite imagery"],[Z,"Ordnance Survey"]]);let u;for(u=0;u<3;u+=1){const c=_e(o,s,u);t[u]?(t[u].p(c,r),v(t[u],1)):(t[u]=de(c),t[u].c(),v(t[u],1),t[u].m(e.parentNode,e))}for(ye(),u=3;u<3;u+=1)_(u);ke()}},i(o){if(!n){for(let r=0;r<3;r+=1)v(t[r]);n=!0}},o(o){t=t.filter(Boolean);for(let r=0;r<3;r+=1)S(t[r]);n=!1},d(o){o&&p(e),Ne(t,o)}}}function Ye(l){let e,n,s,t,_=`If you have internal access, you can opt into higher-quality satellite
    imagery.`,o,r=l[0],u,c;function m(a){l[4](a)}let d={label:"Basemap",choices:l[1]};l[2]!==void 0&&(d.value=l[2]),e=new Ve({props:d}),Ae.push(()=>qe(e,"value",m));let h=me(l);return{c(){ne(e.$$.fragment),s=K(),t=w("p"),t.textContent=_,o=K(),h.c(),u=V()},l(a){ae(e.$$.fragment,a),s=q(a),t=B(a,"P",{"data-svelte-h":!0}),De(t)!=="svelte-itr0ad"&&(t.textContent=_),o=q(a),h.l(a),u=V()},m(a,i){se(e,a,i),b(a,s,i),b(a,t,i),b(a,o,i),h.m(a,i),b(a,u,i),c=!0},p(a,i){const g={};i&2&&(g.choices=a[1]),!n&&i&4&&(n=!0,g.value=a[2],Oe(()=>n=!1)),e.$set(g),i&1&&j(r,r=a[0])?(ye(),S(h,1,1,be),ke(),h=me(a),h.c(),v(h,1),h.m(u.parentNode,u)):h.p(a,i)},i(a){c||(v(e.$$.fragment,a),v(h),c=!0)},o(a){S(e.$$.fragment,a),S(h),c=!1},d(a){a&&(p(s),p(t),p(o),p(u)),oe(e,a),h.d(a)}}}function xe(l){let e,n;return e=new Re({props:{label:"Basemap",$$slots:{default:[Ye]},$$scope:{ctx:l}}}),{c(){ne(e.$$.fragment)},l(s){ae(e.$$.fragment,s)},m(s,t){se(e,s,t),n=!0},p(s,[t]){const _={};t&1031&&(_.$$scope={dirty:t,ctx:s}),e.$set(_)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){oe(e,s)}}}let F="bluesky-api-key",Z="os-api-key",X="google-api-key";function U(l){let e=window.localStorage.getItem(l);return e!=null&&e.length>0}function ge(){let l=[];return U(X)&&l.push(["google","Google satellite"]),U(F)&&l.push(["bluesky","Bluesky Satellite (12.5cm)"]),U(Z)&&l.push(["os-road","Ordnance Survey MasterMap"]),l.push(["maptiler-hybrid","MapTiler Satellite"]),l.push(["maptiler-streets","MapTiler Streets"]),l.push(["maptiler-dataviz","MapTiler Dataviz"]),l.push(["maptiler-uk-openzoomstack-light","OS Open Zoomstack"]),l}function $e(l,e,n){let s;R(l,N,c=>n(2,s=c));let t=0;function _(c){let m=window.prompt("Enter the API key provided to you",window.localStorage.getItem(c)||"");window.localStorage.setItem(c,m||""),n(1,o=ge()),n(0,t+=1),m&&m.length>0&&(c==F?T(N,s="bluesky",s):c==Z?T(N,s="os-road",s):c==X&&T(N,s="google",s))}let o=ge();function r(c){s=c,N.set(s)}return[t,o,s,_,r,c=>_(c)]}class mt extends te{constructor(e){super(),le(this,e,$e,xe,j,{})}}const et=l=>({marker:l&8}),he=l=>({marker:l[3]});function tt(l){let e,n,s,t,_,o,r;const u=l[19].default,c=W(u,l,l[18],he);return{c(){e=w("div"),c&&c.c(),this.h()},l(m){e=B(m,"DIV",{tabindex:!0,role:!0});var d=M(e);c&&c.l(d),d.forEach(p),this.h()},h(){y(e,"tabindex",n=l[1]?0:void 0),y(e,"role",s=l[1]?"button":void 0),Y(e,"z-index",l[2])},m(m,d){b(m,e,d),c&&c.m(e,null),_=!0,o||(r=[ce(l[7].call(null,e)),ce(t=lt.call(null,e,l[0])),L(e,"click",Q(l[20])),L(e,"dblclick",Q(l[21])),L(e,"contextmenu",Q(l[22])),L(e,"mouseenter",l[23]),L(e,"mouseleave",l[24]),L(e,"mousemove",l[25]),L(e,"keydown",l[8])],o=!0)},p(m,[d]){c&&c.p&&(!_||d&262152)&&x(c,u,m,m[18],_?ee(u,m[18],d,et):$(m[18]),he),(!_||d&2&&n!==(n=m[1]?0:void 0))&&y(e,"tabindex",n),(!_||d&2&&s!==(s=m[1]?"button":void 0))&&y(e,"role",s),t&&Te(t.update)&&d&1&&t.update.call(null,m[0]),d&4&&Y(e,"z-index",m[2])},i(m){_||(v(c,m),_=!0)},o(m){S(c,m),_=!1},d(m){m&&p(e),c&&c.d(m),o=!1,pe(r)}}}function lt(l,e){const n=l.className;function s(t){t?l.className=`${n} ${t}`:l.className=n}return s(e),{update:s}}function nt(l,e,n){let s,t,_,{$$slots:o={},$$scope:r}=e,{marker:u=void 0}=e,{lngLat:c}=e,{class:m=void 0}=e,{interactive:d=!0}=e,{asButton:h=!1}=e,{draggable:a=!1}=e,{feature:i=null}=e,{offset:g=void 0}=e,{zIndex:A=void 0}=e,{rotation:I=0}=e,{opacity:G=1}=e;const ve=Ke(),{map:ie,layerEvent:H,self:J}=Fe();R(l,ie,f=>n(27,_=f)),R(l,H,f=>n(26,s=f)),R(l,J,f=>n(3,t=f));function Se(f){T(J,t=new Ze.Marker({element:f,rotation:I,draggable:a,offset:g,opacity:G.toString()}).setLngLat(c).addTo(_),t),n(11,u=t);const z=()=>k("dragstart"),D=()=>{re(),k("drag")},O=()=>{re(),k("dragend")};return a&&(t.on("dragstart",z),t.on("drag",D),t.on("dragend",O)),{destroy(){a&&(t==null||t.off("dragstart",z),t==null||t.off("drag",D),t==null||t.off("dragend",O)),n(11,u=void 0),t==null||t.remove()}}}function re(){let f=t==null?void 0:t.getLngLat();f&&(Array.isArray(c)?n(10,c=[f.lng,f.lat]):c&&"lon"in c?n(10,c={lon:f.lng,lat:f.lat}):n(10,c=f))}function Le(f){f.key===" "&&(f.preventDefault(),f.stopPropagation(),k("click"))}function k(f){if(!d)return;let z=t==null?void 0:t.getLngLat();if(!z)return;const D=[z.lng,z.lat];let O={map:_,marker:t,lngLat:D,features:[{type:"Feature",properties:(i==null?void 0:i.properties)??{},geometry:{type:"Point",coordinates:D}}]};T(H,s={...O,layerType:"marker",type:f},s),ve(f,O)}const Ce=()=>k("click"),we=()=>k("dblclick"),Be=()=>k("contextmenu"),Ie=f=>{k("mouseenter")},Ee=()=>{k("mouseleave")},Pe=()=>k("mousemove");return l.$$set=f=>{"marker"in f&&n(11,u=f.marker),"lngLat"in f&&n(10,c=f.lngLat),"class"in f&&n(0,m=f.class),"interactive"in f&&n(12,d=f.interactive),"asButton"in f&&n(1,h=f.asButton),"draggable"in f&&n(13,a=f.draggable),"feature"in f&&n(14,i=f.feature),"offset"in f&&n(15,g=f.offset),"zIndex"in f&&n(2,A=f.zIndex),"rotation"in f&&n(16,I=f.rotation),"opacity"in f&&n(17,G=f.opacity),"$$scope"in f&&n(18,r=f.$$scope)},l.$$.update=()=>{l.$$.dirty&1032&&(t==null||t.setLngLat(c)),l.$$.dirty&32776&&(t==null||t.setOffset(g??[0,0])),l.$$.dirty&65544&&(t==null||t.setRotation(I)),l.$$.dirty&131080&&(t==null||t.setOpacity(G.toString()))},[m,h,A,t,ie,H,J,Se,Le,k,c,u,d,a,i,g,I,G,r,o,Ce,we,Be,Ie,Ee,Pe]}class gt extends te{constructor(e){super(),le(this,e,nt,tt,j,{marker:11,lngLat:10,class:0,interactive:12,asButton:1,draggable:13,feature:14,offset:15,zIndex:2,rotation:16,opacity:17})}}export{mt as B,dt as C,gt as M};
