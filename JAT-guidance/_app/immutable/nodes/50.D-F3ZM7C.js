import{s as Se,r as fe,w as ce,l as It,u as Nt,m as Ot,o as Pt,C as Me,k as He,S as zt,U as De,a as U,g as B,i as y,f as g,J as Le,Z as Wt,e as W,c as V,b as X,q as te,h as L,D as $e,H as Jt,v as Y,N as Re,t as G,O as Ge,d as Z,n as Ie,p as Ue,j as ae,y as Dt,a0 as nt,V as Vt}from"../chunks/scheduler.BupgUPYD.js";import{S as Ne,i as Oe,e as me,c as q,a as F,m as H,t as k,b as C,d as R,g as ve,f as be}from"../chunks/index.DdWFotL4.js";import{e as de}from"../chunks/each.DPGgJC1I.js";import{B as Xt}from"../chunks/ButtonGroup.BCNwrOPZ.js";import{D as Qe,C as Kt}from"../chunks/DefaultButton.B9e1GVo9.js";import"../chunks/index.DET8Ciop.js";import{S as Pe}from"../chunks/SecondaryButton.DDaC9gF3.js";import{T as Ye}from"../chunks/TextInput.CBUP18MD.js";import{W as xe}from"../chunks/WarningButton.DFY34J1l.js";import{s as oe}from"../chunks/data.BOcBa_gi.js";import{g as Qt}from"../chunks/globals.D0QH3NT1.js";import{p as We,c as ot}from"../chunks/index.CMoKLtYY.js";import{a as Yt,c as xt,j as Ae,v as en,w as Ut,x as Ve,M as tn,b as nn,G as rt,L as Xe,h as lt,C as on,y as rn}from"../chunks/index.B2ILLjs0.js";import{g as Ke,t as ln}from"../chunks/index.CGEB8bsO.js";import{c as Te}from"../chunks/colors.DaC397qr.js";import{G as an,I as Ze,p as sn}from"../chunks/pan.DcZmJ0Jq.js";import{M as fn,G as un,S as cn,C as et}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.CXq9SwcS.js";import{M as qe,B as mn,C as dn}from"../chunks/Marker.CvkDKYCe.js";import"../chunks/index.Den-zRhw.js";import"../chunks/paths.lIfZ83Nk.js";import"../chunks/entry.3HZq9BDw.js";import{R as gn}from"../chunks/RouteMapLayer.ozdm2snD.js";import{P as Bt}from"../chunks/Popup.DLhc1Xax.js";import{T as qt}from"../chunks/TextArea.C2FdTrZh.js";import{R as Fe}from"../chunks/Radio.CCfWjcV-.js";import{M as _n}from"../chunks/Modal.D0NNpIxV.js";import{E as pn}from"../chunks/ExternalLink.DcOjEVUe.js";function hn(n){let e;const t=n[16].default,o=It(t,n,n[24],null);return{c(){o&&o.c()},l(r){o&&o.l(r)},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&16777216)&&Nt(o,t,r,r[24],e?Pt(t,r[24],i,null):Ot(r[24]),null)},i(r){e||(k(o,r),e=!0)},o(r){C(o,r),e=!1},d(r){o&&o.d(r)}}}function $n(n){let e,t,o;function r(l){n[17](l)}let i={id:n[1],type:"symbol",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],interactive:n[15],$$slots:{default:[hn]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new Yt({props:i}),fe.push(()=>me(e,"hovered",r)),e.$on("click",n[18]),e.$on("dblclick",n[19]),e.$on("contextmenu",n[20]),e.$on("mouseenter",n[21]),e.$on("mousemove",n[22]),e.$on("mouseleave",n[23]),{c(){q(e.$$.fragment)},l(l){F(e.$$.fragment,l)},m(l,a){H(e,l,a),o=!0},p(l,[a]){const s={};a&2&&(s.id=l[1]),a&4&&(s.source=l[2]),a&8&&(s.sourceLayer=l[3]),a&16&&(s.beforeId=l[4]),a&32&&(s.beforeLayerType=l[5]),a&64&&(s.paint=l[6]),a&128&&(s.layout=l[7]),a&256&&(s.filter=l[8]),a&512&&(s.applyToClusters=l[9]),a&1024&&(s.minzoom=l[10]),a&2048&&(s.maxzoom=l[11]),a&4096&&(s.hoverCursor=l[12]),a&8192&&(s.manageHoverState=l[13]),a&16384&&(s.eventsIfTopMost=l[14]),a&32768&&(s.interactive=l[15]),a&16777216&&(s.$$scope={dirty:a,ctx:l}),!t&&a&1&&(t=!0,s.hovered=l[0],ce(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){C(e.$$.fragment,l),o=!1},d(l){R(e,l)}}}function vn(n,e,t){let{$$slots:o={},$$scope:r}=e,{id:i=xt("symbol")}=e,{source:l=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:c=void 0}=e,{layout:d=void 0}=e,{filter:m=void 0}=e,{applyToClusters:w=void 0}=e,{minzoom:I=void 0}=e,{maxzoom:A=void 0}=e,{hoverCursor:v=void 0}=e,{manageHoverState:b=!1}=e,{hovered:p=null}=e,{eventsIfTopMost:$=!1}=e,{interactive:M=!0}=e;function u(N){p=N,t(0,p)}function h(N){Me.call(this,n,N)}function _(N){Me.call(this,n,N)}function T(N){Me.call(this,n,N)}function K(N){Me.call(this,n,N)}function S(N){Me.call(this,n,N)}function O(N){Me.call(this,n,N)}return n.$$set=N=>{"id"in N&&t(1,i=N.id),"source"in N&&t(2,l=N.source),"sourceLayer"in N&&t(3,a=N.sourceLayer),"beforeId"in N&&t(4,s=N.beforeId),"beforeLayerType"in N&&t(5,f=N.beforeLayerType),"paint"in N&&t(6,c=N.paint),"layout"in N&&t(7,d=N.layout),"filter"in N&&t(8,m=N.filter),"applyToClusters"in N&&t(9,w=N.applyToClusters),"minzoom"in N&&t(10,I=N.minzoom),"maxzoom"in N&&t(11,A=N.maxzoom),"hoverCursor"in N&&t(12,v=N.hoverCursor),"manageHoverState"in N&&t(13,b=N.manageHoverState),"hovered"in N&&t(0,p=N.hovered),"eventsIfTopMost"in N&&t(14,$=N.eventsIfTopMost),"interactive"in N&&t(15,M=N.interactive),"$$scope"in N&&t(24,r=N.$$scope)},[p,i,l,a,s,f,c,d,m,w,I,A,v,b,$,M,o,u,h,_,T,K,S,O,r]}class bn extends Ne{constructor(e){super(),Oe(this,e,vn,$n,Se,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}var kn=Object.defineProperty,wn=(n,e)=>kn(n,"name",{value:e,configurable:!0});function Ft(n,e,t,o={}){const r=Ke(n),i=Ae(r[0]),l=Ae(r[1]),a=Ae(t),s=en(e,o.units),f=Math.asin(Math.sin(l)*Math.cos(s)+Math.cos(l)*Math.sin(s)*Math.cos(a)),c=i+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(l),Math.cos(s)-Math.sin(l)*Math.sin(f)),d=Ve(c),m=Ve(f);return Ut([d,m],o.properties)}wn(Ft,"destination");var Be=Ft,yn=Object.defineProperty,Ht=(n,e)=>yn(n,"name",{value:e,configurable:!0});function tt(n,e,t={}){if(t.final===!0)return Rt(n,e);const o=Ke(n),r=Ke(e),i=Ae(o[0]),l=Ae(r[0]),a=Ae(o[1]),s=Ae(r[1]),f=Math.sin(l-i)*Math.cos(s),c=Math.cos(a)*Math.sin(s)-Math.sin(a)*Math.cos(s)*Math.cos(l-i);return Ve(Math.atan2(f,c))}Ht(tt,"bearing");function Rt(n,e){let t=tt(e,n);return t=(t+180)%360,t}Ht(Rt,"calculateFinalBearing");var Je=tt;const jn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23FFFFFF'%3e%3cpath%20d='m136-240-56-56%20296-298%20160%20160%20208-206H640v-80h240v240h-80v-104L536-320%20376-480%20136-240Z'%20fill='black'/%3e%3c/svg%3e";function it(n,e,t){const o=n.slice();return o[36]=e[t],o[37]=e,o[38]=t,o}function at(n,e,t){const o=n.slice();return o[39]=e[t],o[40]=e,o[38]=t,o}function st(n){let e,t,o,r,i,l,a;return t=new Ze({props:{$$slots:{default:[Ln]},$$scope:{ctx:n}}}),t.$on("click",function(){Wt(n[5])&&n[5].apply(this,arguments)}),r=new Ze({props:{$$slots:{default:[Mn]},$$scope:{ctx:n}}}),r.$on("click",n[17]),l=new Ze({props:{$$slots:{default:[Nn]},$$scope:{ctx:n}}}),l.$on("click",n[18]),{c(){e=W("div"),q(t.$$.fragment),o=U(),q(r.$$.fragment),i=U(),q(l.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var f=X(e);F(t.$$.fragment,f),o=B(f),F(r.$$.fragment,f),i=B(f),F(l.$$.fragment,f),f.forEach(g),this.h()},h(){te(e,"class","control-panel svelte-1w3m76d")},m(s,f){y(s,e,f),H(t,e,null),L(e,o),H(r,e,null),L(e,i),H(l,e,null),a=!0},p(s,f){n=s;const c={};f[0]&1|f[1]&1024&&(c.$$scope={dirty:f,ctx:n}),t.$set(c);const d={};f[0]&1|f[1]&1024&&(d.$$scope={dirty:f,ctx:n}),r.$set(d);const m={};f[0]&1|f[1]&1024&&(m.$$scope={dirty:f,ctx:n}),l.$set(m)},i(s){a||(k(t.$$.fragment,s),k(r.$$.fragment,s),k(l.$$.fragment,s),a=!0)},o(s){C(t.$$.fragment,s),C(r.$$.fragment,s),C(l.$$.fragment,s),a=!1},d(s){s&&g(e),R(t),R(r),R(l)}}}function Cn(n){let e;return{c(){e=G("Move map")},l(t){e=Z(t,"Move map")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Tn(n){let e,t="Move map";return{c(){e=W("u"),e.textContent=t},l(o){e=V(o,"U",{"data-svelte-h":!0}),Ue(e)!=="svelte-1719ytd"&&(e.textContent=t)},m(o,r){y(o,e,r)},d(o){o&&g(e)}}}function Ln(n){let e,t,o,r;function i(s,f){return s[0].mode=="select"?Tn:Cn}let l=i(n),a=l(n);return{c(){e=W("img"),o=U(),a.c(),r=$e(),this.h()},l(s){e=V(s,"IMG",{src:!0,alt:!0,style:!0}),o=B(s),a.l(s),r=$e(),this.h()},h(){Jt(e.src,t=sn)||te(e,"src",t),te(e,"alt","Move map"),Y(e,"vertical-align","middle")},m(s,f){y(s,e,f),y(s,o,f),a.m(s,f),y(s,r,f)},p(s,f){l!==(l=i(s))&&(a.d(1),a=l(s),a&&(a.c(),a.m(r.parentNode,r)))},d(s){s&&(g(e),g(o),g(r)),a.d(s)}}}function Sn(n){let e;return{c(){e=G("New arm")},l(t){e=Z(t,"New arm")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function En(n){let e,t="New arm";return{c(){e=W("u"),e.textContent=t},l(o){e=V(o,"U",{"data-svelte-h":!0}),Ue(e)!=="svelte-1typ7gq"&&(e.textContent=t)},m(o,r){y(o,e,r)},d(o){o&&g(e)}}}function Mn(n){let e,t,o,r,i,l;function a(c,d){return c[0].mode=="new-arm"?En:Sn}let s=a(n),f=s(n);return{c(){e=Re("svg"),t=Re("circle"),o=Re("text"),r=G("A"),i=U(),f.c(),l=$e(),this.h()},l(c){e=Ge(c,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var d=X(e);t=Ge(d,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),X(t).forEach(g),o=Ge(d,"text",{x:!0,y:!0,fill:!0});var m=X(o);r=Z(m,"A"),m.forEach(g),d.forEach(g),i=B(c),f.l(c),l=$e(),this.h()},h(){te(t,"cx","12"),te(t,"cy","12"),te(t,"r","12"),te(t,"fill","white"),te(o,"x","6"),te(o,"y","16"),te(o,"fill","#4472c4"),te(e,"width","24"),te(e,"height","24"),te(e,"xmlns","http://www.w3.org/2000/svg"),Y(e,"vertical-align","middle")},m(c,d){y(c,e,d),L(e,t),L(e,o),L(o,r),y(c,i,d),f.m(c,d),y(c,l,d)},p(c,d){s!==(s=a(c))&&(f.d(1),f=s(c),f&&(f.c(),f.m(l.parentNode,l)))},d(c){c&&(g(e),g(i),g(l)),f.d(c)}}}function An(n){let e;return{c(){e=G("New movement")},l(t){e=Z(t,"New movement")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function In(n){let e,t="New movement";return{c(){e=W("u"),e.textContent=t},l(o){e=V(o,"U",{"data-svelte-h":!0}),Ue(e)!=="svelte-o92ucp"&&(e.textContent=t)},m(o,r){y(o,e,r)},d(o){o&&g(e)}}}function Nn(n){let e,t,o,r;function i(s,f){return s[0].mode=="new-movement"?In:An}let l=i(n),a=l(n);return{c(){e=W("img"),o=U(),a.c(),r=$e(),this.h()},l(s){e=V(s,"IMG",{src:!0,alt:!0,style:!0}),o=B(s),a.l(s),r=$e(),this.h()},h(){Jt(e.src,t=jn)||te(e,"src",t),te(e,"alt","New movement"),Y(e,"vertical-align","middle")},m(s,f){y(s,e,f),y(s,o,f),a.m(s,f),y(s,r,f)},p(s,f){l!==(l=i(s))&&(a.d(1),a=l(s),a&&(a.c(),a.m(r.parentNode,r)))},d(s){s&&(g(e),g(o),g(r)),a.d(s)}}}function On(n){let e,t=zn(n[38])+"",o;return{c(){e=W("span"),o=G(t),this.h()},l(r){e=V(r,"SPAN",{class:!0});var i=X(e);o=Z(i,t),i.forEach(g),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),Y(e,"color","#4472c4"),Y(e,"background-color","white")},m(r,i){y(r,e,i),L(e,o)},p:Ie,d(r){r&&g(e)}}}function ft(n){let e,t,o;function r(s){n[19](s,n[39])}function i(){return n[20](n[38])}function l(){return n[21](n[38])}let a={draggable:!0,$$slots:{default:[On]},$$scope:{ctx:n}};return n[39].point!==void 0&&(a.lngLat=n[39].point),e=new qe({props:a}),fe.push(()=>me(e,"lngLat",r)),e.$on("dragend",i),e.$on("click",l),{c(){q(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,f){H(e,s,f),o=!0},p(s,f){n=s;const c={};f[1]&1024&&(c.$$scope={dirty:f,ctx:n}),!t&&f[0]&70&&(t=!0,c.lngLat=n[39].point,ce(()=>t=!1)),e.$set(c)},i(s){o||(k(e.$$.fragment,s),o=!0)},o(s){C(e.$$.fragment,s),o=!1},d(s){R(e,s)}}}function Pn(n){let e;return{c(){e=W("span"),this.h()},l(t){e=V(t,"SPAN",{class:!0}),X(e).forEach(g),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),Y(e,"background-color",n[9][n[36].score]),Y(e,"opacity",n[36].kind=="walking & wheeling"?"0%":"100%")},m(t,o){y(t,e,o)},p(t,o){o[0]&70&&Y(e,"background-color",t[9][t[36].score]),o[0]&70&&Y(e,"opacity",t[36].kind=="walking & wheeling"?"0%":"100%")},d(t){t&&g(e)}}}function Jn(n){let e;return{c(){e=W("span"),this.h()},l(t){e=V(t,"SPAN",{class:!0}),X(e).forEach(g),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),Y(e,"background-color",n[9][n[36].score])},m(t,o){y(t,e,o)},p(t,o){o[0]&70&&Y(e,"background-color",t[9][t[36].score])},d(t){t&&g(e)}}}function Dn(n){let e;return{c(){e=W("span"),this.h()},l(t){e=V(t,"SPAN",{class:!0}),X(e).forEach(g),this.h()},h(){te(e,"class","dot svelte-1w3m76d"),Y(e,"background-color",n[9][n[36].score]),Y(e,"opacity","0%")},m(t,o){y(t,e,o)},p(t,o){o[0]&70&&Y(e,"background-color",t[9][t[36].score])},d(t){t&&g(e)}}}function ut(n){let e,t,o,r,i,l,a,s,f;function c(h){n[22](h,n[36])}function d(){return n[23](n[38])}function m(){return n[24](n[38])}let w={draggable:!0,$$slots:{default:[Pn]},$$scope:{ctx:n}};n[36].point1!==void 0&&(w.lngLat=n[36].point1),e=new qe({props:w}),fe.push(()=>me(e,"lngLat",c)),e.$on("dragend",d),e.$on("click",m);function I(h){n[25](h,n[36])}function A(){return n[26](n[38])}function v(){return n[27](n[38])}let b={draggable:!0,$$slots:{default:[Jn]},$$scope:{ctx:n}};n[36].point2!==void 0&&(b.lngLat=n[36].point2),r=new qe({props:b}),fe.push(()=>me(r,"lngLat",I)),r.$on("dragend",A),r.$on("click",v);function p(h){n[28](h,n[36])}function $(){return n[29](n[38])}function M(){return n[30](n[38])}let u={draggable:!0,$$slots:{default:[Dn]},$$scope:{ctx:n}};return n[36].point3!==void 0&&(u.lngLat=n[36].point3),a=new qe({props:u}),fe.push(()=>me(a,"lngLat",p)),a.$on("dragend",$),a.$on("click",M),{c(){q(e.$$.fragment),o=U(),q(r.$$.fragment),l=U(),q(a.$$.fragment)},l(h){F(e.$$.fragment,h),o=B(h),F(r.$$.fragment,h),l=B(h),F(a.$$.fragment,h)},m(h,_){H(e,h,_),y(h,o,_),H(r,h,_),y(h,l,_),H(a,h,_),f=!0},p(h,_){n=h;const T={};_[0]&70|_[1]&1024&&(T.$$scope={dirty:_,ctx:n}),!t&&_[0]&70&&(t=!0,T.lngLat=n[36].point1,ce(()=>t=!1)),e.$set(T);const K={};_[0]&70|_[1]&1024&&(K.$$scope={dirty:_,ctx:n}),!i&&_[0]&70&&(i=!0,K.lngLat=n[36].point2,ce(()=>i=!1)),r.$set(K);const S={};_[0]&70|_[1]&1024&&(S.$$scope={dirty:_,ctx:n}),!s&&_[0]&70&&(s=!0,S.lngLat=n[36].point3,ce(()=>s=!1)),a.$set(S)},i(h){f||(k(e.$$.fragment,h),k(r.$$.fragment,h),k(a.$$.fragment,h),f=!0)},o(h){C(e.$$.fragment,h),C(r.$$.fragment,h),C(a.$$.fragment,h),f=!1},d(h){h&&(g(o),g(l)),R(e,h),R(r,h),R(a,h)}}}function Un(n){let e=(n[35].name||"Untitled movement")+"",t;return{c(){t=G(e)},l(o){t=Z(o,e)},m(o,r){y(o,t,r)},p(o,r){r[1]&16&&e!==(e=(o[35].name||"Untitled movement")+"")&&ae(t,e)},d(o){o&&g(t)}}}function Bn(n){let e,t;return e=new Bt({props:{$$slots:{default:[Un,({props:o})=>({35:o}),({props:o})=>[0,o?16:0]]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){H(e,o,r),t=!0},p(o,r){const i={};r[1]&1040&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){R(e,o)}}}function qn(n){let e=(n[35].name||"Untitled movement")+"",t;return{c(){t=G(e)},l(o){t=Z(o,e)},m(o,r){y(o,t,r)},p(o,r){r[1]&16&&e!==(e=(o[35].name||"Untitled movement")+"")&&ae(t,e)},d(o){o&&g(t)}}}function Fn(n){let e,t;return e=new Bt({props:{$$slots:{default:[qn,({props:o})=>({35:o}),({props:o})=>[0,o?16:0]]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){H(e,o,r),t=!0},p(o,r){const i={};r[1]&1040&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){R(e,o)}}}function Hn(n){let e,t,o,r,i,l;return e=new Xe({props:{id:"jat-cycling",manageHoverState:!0,paint:{"line-width":lt(6,10),"line-color":["get","color"]},filter:["==",["get","kind"],"cycling"],$$slots:{default:[Bn]},$$scope:{ctx:n}}}),e.$on("click",n[11]),o=new Xe({props:{id:"jat-walking-wheeling",manageHoverState:!0,paint:{"line-width":lt(6,8),"line-color":["get","color"],"line-dasharray":[3,2]},filter:["==",["get","kind"],"walking & wheeling"],$$slots:{default:[Fn]},$$scope:{ctx:n}}}),o.$on("click",n[11]),i=new bn({props:{id:"jat-arrow",filter:["has","angle"],paint:{"text-color":["get","color"],"text-halo-color":"white","text-halo-width":3},layout:{"text-field":"⬆","text-overlap":"always","text-rotate":["get","angle"],"text-size":70}}}),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment),r=U(),q(i.$$.fragment)},l(a){F(e.$$.fragment,a),t=B(a),F(o.$$.fragment,a),r=B(a),F(i.$$.fragment,a)},m(a,s){H(e,a,s),y(a,t,s),H(o,a,s),y(a,r,s),H(i,a,s),l=!0},p(a,s){const f={};s[1]&1024&&(f.$$scope={dirty:s,ctx:a}),e.$set(f);const c={};s[1]&1024&&(c.$$scope={dirty:s,ctx:a}),o.$set(c)},i(a){l||(k(e.$$.fragment,a),k(o.$$.fragment,a),k(i.$$.fragment,a),l=!0)},o(a){C(e.$$.fragment,a),C(o.$$.fragment,a),C(i.$$.fragment,a),l=!1},d(a){a&&(g(t),g(r)),R(e,a),R(o,a),R(i,a)}}}function Rn(n){let e,t,o,r;return e=new Xe({props:{paint:{"line-width":5,"line-color":"yellow","line-gap-width":45}}}),o=new on({props:{filter:["==",["get","kind"],"arm"],paint:{"circle-radius":20,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment)},l(i){F(e.$$.fragment,i),t=B(i),F(o.$$.fragment,i)},m(i,l){H(e,i,l),y(i,t,l),H(o,i,l),r=!0},p:Ie,i(i){r||(k(e.$$.fragment,i),k(o.$$.fragment,i),r=!0)},o(i){C(e.$$.fragment,i),C(o.$$.fragment,i),r=!1},d(i){i&&g(t),R(e,i),R(o,i)}}}function Gn(n){let e,t,o,r,i,l,a,s,f,c,d,m,w;e=new fn({}),e.$on("click",n[10]);let I=n[0].mode!="editing"&&st(n);r=new gn({props:{show:n[3],id:"route-map"}}),l=new an({props:{map:n[7],beforeId:"route-map"}});let A=de(n[6].jat[n[1]][n[2]].arms),v=[];for(let u=0;u<A.length;u+=1)v[u]=ft(at(n,A,u));const b=u=>C(v[u],1,1,()=>{v[u]=null});let p=de(n[6].jat[n[1]][n[2]].movements),$=[];for(let u=0;u<p.length;u+=1)$[u]=ut(it(n,p,u));const M=u=>C($[u],1,1,()=>{$[u]=null});return c=new rt({props:{data:n[12](n[6]),$$slots:{default:[Hn]},$$scope:{ctx:n}}}),m=new rt({props:{data:n[8],$$slots:{default:[Rn]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment),t=U(),I&&I.c(),o=U(),q(r.$$.fragment),i=U(),q(l.$$.fragment),a=U();for(let u=0;u<v.length;u+=1)v[u].c();s=U();for(let u=0;u<$.length;u+=1)$[u].c();f=U(),q(c.$$.fragment),d=U(),q(m.$$.fragment)},l(u){F(e.$$.fragment,u),t=B(u),I&&I.l(u),o=B(u),F(r.$$.fragment,u),i=B(u),F(l.$$.fragment,u),a=B(u);for(let h=0;h<v.length;h+=1)v[h].l(u);s=B(u);for(let h=0;h<$.length;h+=1)$[h].l(u);f=B(u),F(c.$$.fragment,u),d=B(u),F(m.$$.fragment,u)},m(u,h){H(e,u,h),y(u,t,h),I&&I.m(u,h),y(u,o,h),H(r,u,h),y(u,i,h),H(l,u,h),y(u,a,h);for(let _=0;_<v.length;_+=1)v[_]&&v[_].m(u,h);y(u,s,h);for(let _=0;_<$.length;_+=1)$[_]&&$[_].m(u,h);y(u,f,h),H(c,u,h),y(u,d,h),H(m,u,h),w=!0},p(u,h){u[0].mode!="editing"?I?(I.p(u,h),h[0]&1&&k(I,1)):(I=st(u),I.c(),k(I,1),I.m(o.parentNode,o)):I&&(ve(),C(I,1,1,()=>{I=null}),be());const _={};h[0]&8&&(_.show=u[3]),r.$set(_);const T={};if(h[0]&128&&(T.map=u[7]),l.$set(T),h[0]&86){A=de(u[6].jat[u[1]][u[2]].arms);let O;for(O=0;O<A.length;O+=1){const N=at(u,A,O);v[O]?(v[O].p(N,h),k(v[O],1)):(v[O]=ft(N),v[O].c(),k(v[O],1),v[O].m(s.parentNode,s))}for(ve(),O=A.length;O<v.length;O+=1)b(O);be()}if(h[0]&598){p=de(u[6].jat[u[1]][u[2]].movements);let O;for(O=0;O<p.length;O+=1){const N=it(u,p,O);$[O]?($[O].p(N,h),k($[O],1)):($[O]=ut(N),$[O].c(),k($[O],1),$[O].m(f.parentNode,f))}for(ve(),O=p.length;O<$.length;O+=1)M(O);be()}const K={};h[0]&64&&(K.data=u[12](u[6])),h[1]&1024&&(K.$$scope={dirty:h,ctx:u}),c.$set(K);const S={};h[0]&256&&(S.data=u[8]),h[1]&1024&&(S.$$scope={dirty:h,ctx:u}),m.$set(S)},i(u){if(!w){k(e.$$.fragment,u),k(I),k(r.$$.fragment,u),k(l.$$.fragment,u);for(let h=0;h<A.length;h+=1)k(v[h]);for(let h=0;h<p.length;h+=1)k($[h]);k(c.$$.fragment,u),k(m.$$.fragment,u),w=!0}},o(u){C(e.$$.fragment,u),C(I),C(r.$$.fragment,u),C(l.$$.fragment,u),v=v.filter(Boolean);for(let h=0;h<v.length;h+=1)C(v[h]);$=$.filter(Boolean);for(let h=0;h<$.length;h+=1)C($[h]);C(c.$$.fragment,u),C(m.$$.fragment,u),w=!1},d(u){u&&(g(t),g(o),g(i),g(a),g(s),g(f),g(d)),R(e,u),I&&I.d(u),R(r,u),R(l,u),Le(v,u),Le($,u),R(c,u),R(m,u)}}}function Zn(n){let e,t,o;function r(l){n[31](l)}let i={$$slots:{default:[Gn]},$$scope:{ctx:n}};return n[7]!==void 0&&(i.map=n[7]),e=new tn({props:i}),fe.push(()=>me(e,"map",r)),{c(){q(e.$$.fragment)},l(l){F(e.$$.fragment,l)},m(l,a){H(e,l,a),o=!0},p(l,a){const s={};a[0]&511|a[1]&1024&&(s.$$scope={dirty:a,ctx:l}),!t&&a[0]&128&&(t=!0,s.map=l[7],ce(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){C(e.$$.fragment,l),o=!1},d(l){R(e,l)}}}function ct(n,e){return{type:"Feature",id:e,properties:{kind:"arm"},geometry:{type:"Point",coordinates:n.point}}}function zn(n){return String.fromCharCode(n+65)}function Wn(n,e,t){let o,r;He(n,oe,j=>t(6,r=j));let{junctionIdx:i}=e,{stage:l}=e,{mode:a}=e,{hoveringSidebar:s}=e,{streetviewOn:f}=e,{showRoute:c}=e,{select:d}=e,{stopEditing:m}=e,w,I={0:Te.red.background,1:Te.amber.background,2:Te.green.background,X:Te.critical.background};function A(j,J,ge){let ne={type:"FeatureCollection",features:[]},he=J.mode=="editing"?J.id:ge;return he!=null&&(he.kind=="arm"?ne.features.push(ct(j.jat[i][l].arms[he.idx],he.idx)):ne.features.push($(j.jat[i][l].movements[he.idx],he.idx))),ne}async function v(j){if(!f){for(let J of w.queryRenderedFeatures(j.detail.point,{layers:["jat-cycling","jat-walking-wheeling"]}))return;if(a.mode!="select"){if(a.mode=="editing"){await m();return}a.mode=="new-arm"?(De(oe,r.jat[i][l].arms=[...r.jat[i][l].arms,{point:j.detail.lngLat.toArray(),name:""}],r),await d({kind:"arm",idx:r.jat[i][l].arms.length-1})):(De(oe,r.jat[i][l].movements=[...r.jat[i][l].movements,{point1:j.detail.lngLat.toArray(),point2:Be(j.detail.lngLat.toArray(),.005,0).geometry.coordinates,point3:Be(j.detail.lngLat.toArray(),.01,0).geometry.coordinates,kind:"cycling",score:"X",name:"",notes:""}],r),await d({kind:"movement",idx:r.jat[i][l].movements.length-1}))}}}async function b(j){await d({kind:"movement",idx:j.detail.features[0].id})}zt(()=>{u(!1)});function p(j){let J={type:"FeatureCollection",features:j.jat[i][l].movements.map((ge,ne)=>$(ge,ne))};for(let ge of j.jat[i][l].movements)if(J.features.push(M(ge,J.features.length)),ge.kind=="walking & wheeling"){let ne={...ge,point1:ge.point3,point3:ge.point1};J.features.push(M(ne,J.features.length))}return J}function $(j,J){return{type:"Feature",id:J,properties:{name:j.name,kind:j.kind,color:I[j.score]},geometry:{type:"LineString",coordinates:[j.point1,j.point2,j.point3]}}}function M(j,J){return{type:"Feature",id:J,properties:{kind:j.kind,color:I[j.score],angle:Je(j.point2,j.point3)},geometry:{type:"Point",coordinates:j.point3}}}function u(j){let J=p(r);for(let ge of r.jat[i][l].arms)J.features.push(ct(ge,J.features.length));for(let ge of r.summary.networkMap.features)J.features.push(ge);J.features.length>0&&w.fitBounds(nn(J),{padding:20,animate:j})}function h(){return w}const _=()=>t(0,a={mode:"new-arm"}),T=()=>t(0,a={mode:"new-movement"});function K(j,J){n.$$.not_equal(J.point,j)&&(J.point=j,oe.set(r))}const S=j=>d({kind:"arm",idx:j}),O=j=>d({kind:"arm",idx:j});function N(j,J){n.$$.not_equal(J.point1,j)&&(J.point1=j,oe.set(r))}const ie=j=>d({kind:"movement",idx:j}),pe=j=>d({kind:"movement",idx:j});function ke(j,J){n.$$.not_equal(J.point2,j)&&(J.point2=j,oe.set(r))}const z=j=>d({kind:"movement",idx:j}),x=j=>d({kind:"movement",idx:j});function ee(j,J){n.$$.not_equal(J.point3,j)&&(J.point3=j,oe.set(r))}const le=j=>d({kind:"movement",idx:j}),ue=j=>d({kind:"movement",idx:j});function P(j){w=j,t(7,w)}return n.$$set=j=>{"junctionIdx"in j&&t(1,i=j.junctionIdx),"stage"in j&&t(2,l=j.stage),"mode"in j&&t(0,a=j.mode),"hoveringSidebar"in j&&t(13,s=j.hoveringSidebar),"streetviewOn"in j&&t(14,f=j.streetviewOn),"showRoute"in j&&t(3,c=j.showRoute),"select"in j&&t(4,d=j.select),"stopEditing"in j&&t(5,m=j.stopEditing)},n.$$.update=()=>{n.$$.dirty[0]&8257&&t(8,o=A(r,a,s))},[a,i,l,c,d,m,r,w,o,I,v,b,p,s,f,u,h,_,T,K,S,O,N,ie,pe,ke,z,x,ee,le,ue,P]}class Vn extends Ne{constructor(e){super(),Oe(this,e,Wn,Zn,Se,{junctionIdx:1,stage:2,mode:0,hoveringSidebar:13,streetviewOn:14,showRoute:3,select:4,stopEditing:5,zoom:15,getMap:16},null,[-1,-1])}get zoom(){return this.$$.ctx[15]}get getMap(){return this.$$.ctx[16]}}const we={"Any type of junction":{otherJunctionTypeWhichApplies:"","All movements":{scoreZero:["Cycle movement in potential conflict with heavy motor traffic flow.","Cycle movement mixed with or crossing traffic with 85th percentile speed exceeding 60kph, or where vehicles accelerate rapidly.","Necessary to cross more than one traffic lane (without refuge or protection) to complete cycle movement unless traffic flows are low.","Cycle movement crosses wide junction entry or exit: e.g. with merge or diverge taper or slip lane.","Pinch points on junction entry or exit (lane width 3.2m-3.9m).","Cycle movement affected by very poor surface quality utility reinstatement, gully positioning, debris."],scoreOne:["Cycle movement in potential conflict with moderate traffic flow.","Cycle lanes through junction meeting appropriate desirable minimum width requirements for the movement under consideration.","Raised table at junction crossed by traffic in potential conflict with cycle movement.","Cycle movement made by transiting onto section of shared use footway."],scoreTwo:["Low traffic speed and volume in mixed traffic environment (e.g. access-only streets in a residential area).","Cycle movement separated physically and/or in time from motor traffic and also separated from pedestrians.","Cycle movement bypasses junction completely, including via good quality grade separation."]}},"Simple priority T-junction":{otherJunctionTypeWhichApplies:"","Right turn from minor arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with cycle movement, with no physical refuge in the centre of the major road (including ghost island junction)."],scoreOne:["Central refuge allowing two-stage cycle movement crossing one traffic lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm with dedicated cycle signals or cycle priority."]},"Left turn from major arm":{scoreZero:[],scoreOne:["Side road entry treatment (table across minor arm)."],scoreTwo:["Continuous footway and cycle track across minor arm."]},"Right turn from major arm":{scoreZero:["Heavy traffic movements and/or high bus and HGV flows in potential conflict with no physical refuge in the centre of major road (including ghost island junction)."],scoreOne:["Protected turning refuge allowing two stage cycle movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]},"Ahead on major arm, crossing minor arm":{scoreZero:["Congested conditions causing poor visibility for right-turning motor vehicles from major arm.","Junction corner radius ≥9m, including where off-carriageway cycle track crosses minor arm."],scoreOne:["Junction free from queueing traffic and cycle lane on major arm meeting desirable minimum width requirements.","Junction corner radius <9m, including where off-carriageway cycle track crosses minor arm without priority.","Side road entry treatment (table across minor arm)."],scoreTwo:["Off-carriageway cycle track or stepped cycle track alongside major arm, crossing minor arm with priority over turning traffic."]}},Crossroads:{otherJunctionTypeWhichApplies:"Simple priority T-junction","Ahead from minor arm":{scoreZero:["Heavy opposing traffic movements with no physical refuge (including ghost island junction)."],scoreOne:["Protected pocket refuge for ahead cycles allowing two stage movement, crossing one lane at a time."],scoreTwo:["Cycle movement made via crossing of major arm via dedicated cycle signals or cycle priority."]}},"Traffic Signals":{otherJunctionTypeWhichApplies:"","All movements":{scoreZero:["Single or multiple queuing lanes with no cycle lanes or tracks on approaches.","Junctions with unsignalised left turn merge/diverge and signalised ahead lanes."],scoreOne:["Advance Cycle Stop lines, at least 5m deep and where the signals on the approach are on green for <30% of the cycle time.","Signal timings adjusted to provide extended intergreen to suit cycle movement under consideration.","Cycle/pedestrian scramble (toucan crossings with all-red stage).","Early release for cycles, with enough time to clear junction for cycle movement being considered."],scoreTwo:["Cycle movement has no potential conflict with motor traffic, e.g. dedicated cycle stage, conflicting traffic movement held or banned."]},"Right turn":{scoreZero:[],scoreOne:["Two-stage right turn via ASL or marked area in front of stop line."],scoreTwo:["Two-stage right turn with physically protected waiting area."]}},Roundabout:{otherJunctionTypeWhichApplies:"","All movements":{scoreZero:["Any type of roundabout with high traffic throughput.","Normal roundabout with multi-lane flared approaches.","Any type of roundabout with annular cycle lane marked on the circulatory carriageway."],scoreOne:["Compact roundabout or raised mini roundabout with no more than moderate traffic throughput","Off-carriageway cycle track with crossings of entries and exits without cycle priority, crossing single traffic lanes with traffic flows < 4000 vehicles per day or 400 HGV/bus flow. "],scoreTwo:["Off-carriageway cycle track with crossings of entries and exits with signals or cycle priority."]}}};function mt(n,e,t){const o=n.slice();return o[13]=e[t],o}function dt(n,e,t){const o=n.slice();return o[13]=e[t],o}function gt(n,e,t){const o=n.slice();return o[13]=e[t],o}function Xn(n){let e;return{c(){e=G("LTN 1/20 scoring guidance")},l(t){e=Z(t,"LTN 1/20 scoring guidance")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Kn(n){let e;return{c(){e=G(`LTN 1/20 appendix B
    `)},l(t){e=Z(t,`LTN 1/20 appendix B
    `)},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function _t(n){let e,t,o;function r(l){n[8](l)}let i={label:"What type of movement do you need guidance for",choices:We(n[1])};return n[2]!==void 0&&(i.value=n[2]),e=new Fe({props:i}),fe.push(()=>me(e,"value",r)),{c(){q(e.$$.fragment)},l(l){F(e.$$.fragment,l)},m(l,a){H(e,l,a),o=!0},p(l,a){const s={};a&2&&(s.choices=We(l[1])),!t&&a&4&&(t=!0,s.value=l[2],ce(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){C(e.$$.fragment,l),o=!1},d(l){R(e,l)}}}function pt(n){let e,t=`${n[0]}: ${n[2]}`,o,r,i,l,a=`<th class="score-zero-header svelte-1i1c8i5"><u>Score = 0</u> <br/>
          Suitable only for confident existing cyclists, and may be avoided by some
          experienced cyclists Conditions are most likely to give rise to the most
          common collision types</th> <th class="score-one-header svelte-1i1c8i5"><u>Score = 1</u> <br/>
          Likely to be more acceptable to most cyclists, but may still pose problems
          for less confident or new cyclists The risk of collisions has been reduced
          by design layout or traffic management interventions</th> <th class="score-two-header svelte-1i1c8i5"><u>Score = 2</u> <br/>
          Suitable for all potential and existing cyclists The potential for collisions
          has been removed, or managed to a high standard of safety for cyclists</th>`,s,f,c,d,m,w,I,A,v,b,p=de(n[4].scoreZero),$=[];for(let T=0;T<p.length;T+=1)$[T]=ht(gt(n,p,T));let M=de(n[4].scoreOne),u=[];for(let T=0;T<M.length;T+=1)u[T]=$t(dt(n,M,T));let h=de(n[4].scoreTwo),_=[];for(let T=0;T<h.length;T+=1)_[T]=vt(mt(n,h,T));return{c(){e=W("h3"),o=G(t),r=U(),i=W("table"),l=W("tr"),l.innerHTML=a,s=U(),f=W("tr"),c=W("td"),d=W("ul");for(let T=0;T<$.length;T+=1)$[T].c();m=U(),w=W("td"),I=W("ul");for(let T=0;T<u.length;T+=1)u[T].c();A=U(),v=W("td"),b=W("ul");for(let T=0;T<_.length;T+=1)_[T].c();this.h()},l(T){e=V(T,"H3",{});var K=X(e);o=Z(K,t),K.forEach(g),r=B(T),i=V(T,"TABLE",{});var S=X(i);l=V(S,"TR",{"data-svelte-h":!0}),Ue(l)!=="svelte-hmnvmx"&&(l.innerHTML=a),s=B(S),f=V(S,"TR",{});var O=X(f);c=V(O,"TD",{class:!0});var N=X(c);d=V(N,"UL",{});var ie=X(d);for(let ee=0;ee<$.length;ee+=1)$[ee].l(ie);ie.forEach(g),N.forEach(g),m=B(O),w=V(O,"TD",{class:!0});var pe=X(w);I=V(pe,"UL",{});var ke=X(I);for(let ee=0;ee<u.length;ee+=1)u[ee].l(ke);ke.forEach(g),pe.forEach(g),A=B(O),v=V(O,"TD",{class:!0});var z=X(v);b=V(z,"UL",{});var x=X(b);for(let ee=0;ee<_.length;ee+=1)_[ee].l(x);x.forEach(g),z.forEach(g),O.forEach(g),S.forEach(g),this.h()},h(){te(c,"class","score-zero svelte-1i1c8i5"),te(w,"class","score-one svelte-1i1c8i5"),te(v,"class","score-two svelte-1i1c8i5")},m(T,K){y(T,e,K),L(e,o),y(T,r,K),y(T,i,K),L(i,l),L(i,s),L(i,f),L(f,c),L(c,d);for(let S=0;S<$.length;S+=1)$[S]&&$[S].m(d,null);L(f,m),L(f,w),L(w,I);for(let S=0;S<u.length;S+=1)u[S]&&u[S].m(I,null);L(f,A),L(f,v),L(v,b);for(let S=0;S<_.length;S+=1)_[S]&&_[S].m(b,null)},p(T,K){if(K&5&&t!==(t=`${T[0]}: ${T[2]}`)&&ae(o,t),K&16){p=de(T[4].scoreZero);let S;for(S=0;S<p.length;S+=1){const O=gt(T,p,S);$[S]?$[S].p(O,K):($[S]=ht(O),$[S].c(),$[S].m(d,null))}for(;S<$.length;S+=1)$[S].d(1);$.length=p.length}if(K&16){M=de(T[4].scoreOne);let S;for(S=0;S<M.length;S+=1){const O=dt(T,M,S);u[S]?u[S].p(O,K):(u[S]=$t(O),u[S].c(),u[S].m(I,null))}for(;S<u.length;S+=1)u[S].d(1);u.length=M.length}if(K&16){h=de(T[4].scoreTwo);let S;for(S=0;S<h.length;S+=1){const O=mt(T,h,S);_[S]?_[S].p(O,K):(_[S]=vt(O),_[S].c(),_[S].m(b,null))}for(;S<_.length;S+=1)_[S].d(1);_.length=h.length}},d(T){T&&(g(e),g(r),g(i)),Le($,T),Le(u,T),Le(_,T)}}}function ht(n){let e,t=n[13]+"",o;return{c(){e=W("li"),o=G(t)},l(r){e=V(r,"LI",{});var i=X(e);o=Z(i,t),i.forEach(g)},m(r,i){y(r,e,i),L(e,o)},p(r,i){i&16&&t!==(t=r[13]+"")&&ae(o,t)},d(r){r&&g(e)}}}function $t(n){let e,t=n[13]+"",o;return{c(){e=W("li"),o=G(t)},l(r){e=V(r,"LI",{});var i=X(e);o=Z(i,t),i.forEach(g)},m(r,i){y(r,e,i),L(e,o)},p(r,i){i&16&&t!==(t=r[13]+"")&&ae(o,t)},d(r){r&&g(e)}}}function vt(n){let e,t=n[13]+"",o;return{c(){e=W("li"),o=G(t)},l(r){e=V(r,"LI",{});var i=X(e);o=Z(i,t),i.forEach(g)},m(r,i){y(r,e,i),L(e,o)},p(r,i){i&16&&t!==(t=r[13]+"")&&ae(o,t)},d(r){r&&g(e)}}}function Qn(n){let e;return{c(){e=G("OK")},l(t){e=Z(t,"OK")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Yn(n){let e,t,o,r,i,l,a,s,f,c,d,m;o=new pn({props:{href:"https://assets.publishing.service.gov.uk/media/5ffa1f96d3bf7f65d9e35825/cycle-infrastructure-design-ltn-1-20.pdf",$$slots:{default:[Kn]},$$scope:{ctx:n}}});function w(b){n[7](b)}let I={label:"What type of junction do you need guidance for",choices:We(n[5])};n[0]!==void 0&&(I.value=n[0]),l=new Fe({props:I}),fe.push(()=>me(l,"value",w));let A=n[1].length>1&&_t(n),v=n[4]&&pt(n);return d=new Pe({props:{$$slots:{default:[Qn]},$$scope:{ctx:n}}}),d.$on("click",n[9]),{c(){e=W("p"),t=G("Guidance from "),q(o.$$.fragment),r=G("."),i=U(),q(l.$$.fragment),s=U(),A&&A.c(),f=U(),v&&v.c(),c=U(),q(d.$$.fragment)},l(b){e=V(b,"P",{});var p=X(e);t=Z(p,"Guidance from "),F(o.$$.fragment,p),r=Z(p,"."),p.forEach(g),i=B(b),F(l.$$.fragment,b),s=B(b),A&&A.l(b),f=B(b),v&&v.l(b),c=B(b),F(d.$$.fragment,b)},m(b,p){y(b,e,p),L(e,t),H(o,e,null),L(e,r),y(b,i,p),H(l,b,p),y(b,s,p),A&&A.m(b,p),y(b,f,p),v&&v.m(b,p),y(b,c,p),H(d,b,p),m=!0},p(b,p){const $={};p&1048576&&($.$$scope={dirty:p,ctx:b}),o.$set($);const M={};!a&&p&1&&(a=!0,M.value=b[0],ce(()=>a=!1)),l.$set(M),b[1].length>1?A?(A.p(b,p),p&2&&k(A,1)):(A=_t(b),A.c(),k(A,1),A.m(f.parentNode,f)):A&&(ve(),C(A,1,1,()=>{A=null}),be()),b[4]?v?v.p(b,p):(v=pt(b),v.c(),v.m(c.parentNode,c)):v&&(v.d(1),v=null);const u={};p&1048576&&(u.$$scope={dirty:p,ctx:b}),d.$set(u)},i(b){m||(k(o.$$.fragment,b),k(l.$$.fragment,b),k(A),k(d.$$.fragment,b),m=!0)},o(b){C(o.$$.fragment,b),C(l.$$.fragment,b),C(A),C(d.$$.fragment,b),m=!1},d(b){b&&(g(e),g(i),g(s),g(f),g(c)),R(o),R(l,b),A&&A.d(b),v&&v.d(b),R(d,b)}}}function xn(n){let e,t,o,r,i,l;t=new Pe({props:{$$slots:{default:[Xn]},$$scope:{ctx:n}}}),t.$on("click",n[6]);function a(f){n[10](f)}let s={title:"LTN 1/20 scoring guidance",viewWidth:80,$$slots:{default:[Yn]},$$scope:{ctx:n}};return n[3]!==void 0&&(s.open=n[3]),r=new _n({props:s}),fe.push(()=>me(r,"open",a)),{c(){e=W("div"),q(t.$$.fragment),o=U(),q(r.$$.fragment)},l(f){e=V(f,"DIV",{});var c=X(e);F(t.$$.fragment,c),c.forEach(g),o=B(f),F(r.$$.fragment,f)},m(f,c){y(f,e,c),H(t,e,null),y(f,o,c),H(r,f,c),l=!0},p(f,[c]){const d={};c&1048576&&(d.$$scope={dirty:c,ctx:f}),t.$set(d);const m={};c&1048607&&(m.$$scope={dirty:c,ctx:f}),!i&&c&8&&(i=!0,m.open=f[3],ce(()=>i=!1)),r.$set(m)},i(f){l||(k(t.$$.fragment,f),k(r.$$.fragment,f),l=!0)},o(f){C(t.$$.fragment,f),C(r.$$.fragment,f),l=!1},d(f){f&&(g(e),g(o)),R(t),R(r,f)}}}function eo(n,e,t){let o,r=!1,i=Object.keys(we),l=i[0],a=[],s="";function f(v){let b=Object.keys(we[v]).filter($=>$!=="summary"&&$!=="otherJunctionTypeWhichApplies"),p=we[v].otherJunctionTypeWhichApplies;return p&&(b=b.concat(Object.keys(we[p]).filter($=>$!=="summary"&&$!=="otherJunctionTypeWhichApplies"))),b}function c(v,b){a.includes(b)||(t(2,s=a[0]),b=a[0]);let p=we[v][b],$=we[v].otherJunctionTypeWhichApplies;!p&&we[$]&&(p=we[$][b]);let M=JSON.parse(JSON.stringify(we["Any type of junction"]["All movements"]));if(v==="Any type of junction"&&b==="All movements")return M;if(we[v]["All movements"]){let u=we[v]["All movements"];M.scoreZero=M.scoreZero.concat(u.scoreZero),M.scoreOne=M.scoreOne.concat(u.scoreOne),M.scoreTwo=M.scoreTwo.concat(u.scoreTwo)}return p&&(M.scoreZero=M.scoreZero.concat(p.scoreZero),M.scoreOne=M.scoreOne.concat(p.scoreOne),M.scoreTwo=M.scoreTwo.concat(p.scoreTwo)),M}const d=()=>t(3,r=!0);function m(v){l=v,t(0,l)}function w(v){s=v,t(2,s),t(0,l),t(1,a)}const I=()=>t(3,r=!1);function A(v){r=v,t(3,r)}return n.$$.update=()=>{n.$$.dirty&3&&(t(1,a=f(l)),a.length===1&&t(2,s=a[0])),n.$$.dirty&5&&t(4,o=c(l,s))},[l,a,s,r,o,i,d,m,w,I,A]}class to extends Ne{constructor(e){super(),Oe(this,e,eo,xn,Se,{})}}function no(n){let e,t,o,r,i,l,a,s,f,c,d,m,w,I;function A(_){n[5](_)}let v={label:"Name"};n[3].jat[n[0]][n[1]].movements[n[2]].name!==void 0&&(v.value=n[3].jat[n[0]][n[1]].movements[n[2]].name),e=new Ye({props:v}),fe.push(()=>me(e,"value",A));function b(_){n[6](_)}let p={label:"Movement",choices:[["cycling","Cycling"],["walking & wheeling","Walking & Wheeling"]]};n[3].jat[n[0]][n[1]].movements[n[2]].kind!==void 0&&(p.value=n[3].jat[n[0]][n[1]].movements[n[2]].kind),r=new Fe({props:p}),fe.push(()=>me(r,"value",b));function $(_){n[7](_)}let M={label:"Score",choices:n[4]};n[3].jat[n[0]][n[1]].movements[n[2]].score!==void 0&&(M.value=n[3].jat[n[0]][n[1]].movements[n[2]].score),a=new Fe({props:M}),fe.push(()=>me(a,"value",$)),c=new to({});function u(_){n[8](_)}let h={label:"Comments"};return n[3].jat[n[0]][n[1]].movements[n[2]].notes!==void 0&&(h.value=n[3].jat[n[0]][n[1]].movements[n[2]].notes),m=new qt({props:h}),fe.push(()=>me(m,"value",u)),{c(){q(e.$$.fragment),o=U(),q(r.$$.fragment),l=U(),q(a.$$.fragment),f=U(),q(c.$$.fragment),d=U(),q(m.$$.fragment)},l(_){F(e.$$.fragment,_),o=B(_),F(r.$$.fragment,_),l=B(_),F(a.$$.fragment,_),f=B(_),F(c.$$.fragment,_),d=B(_),F(m.$$.fragment,_)},m(_,T){H(e,_,T),y(_,o,T),H(r,_,T),y(_,l,T),H(a,_,T),y(_,f,T),H(c,_,T),y(_,d,T),H(m,_,T),I=!0},p(_,[T]){const K={};!t&&T&15&&(t=!0,K.value=_[3].jat[_[0]][_[1]].movements[_[2]].name,ce(()=>t=!1)),e.$set(K);const S={};!i&&T&15&&(i=!0,S.value=_[3].jat[_[0]][_[1]].movements[_[2]].kind,ce(()=>i=!1)),r.$set(S);const O={};!s&&T&15&&(s=!0,O.value=_[3].jat[_[0]][_[1]].movements[_[2]].score,ce(()=>s=!1)),a.$set(O);const N={};!w&&T&15&&(w=!0,N.value=_[3].jat[_[0]][_[1]].movements[_[2]].notes,ce(()=>w=!1)),m.$set(N)},i(_){I||(k(e.$$.fragment,_),k(r.$$.fragment,_),k(a.$$.fragment,_),k(c.$$.fragment,_),k(m.$$.fragment,_),I=!0)},o(_){C(e.$$.fragment,_),C(r.$$.fragment,_),C(a.$$.fragment,_),C(c.$$.fragment,_),C(m.$$.fragment,_),I=!1},d(_){_&&(g(o),g(l),g(f),g(d)),R(e,_),R(r,_),R(a,_),R(c,_),R(m,_)}}}function oo(n,e,t){let o;He(n,oe,m=>t(3,o=m));let{junctionIdx:r}=e,{stage:i}=e,{idx:l}=e,a=[["X","X - black"],["0","0 - red"],["1","1 - amber"],["2","2 - green"]];function s(m){n.$$.not_equal(o.jat[r][i].movements[l].name,m)&&(o.jat[r][i].movements[l].name=m,oe.set(o))}function f(m){n.$$.not_equal(o.jat[r][i].movements[l].kind,m)&&(o.jat[r][i].movements[l].kind=m,oe.set(o))}function c(m){n.$$.not_equal(o.jat[r][i].movements[l].score,m)&&(o.jat[r][i].movements[l].score=m,oe.set(o))}function d(m){n.$$.not_equal(o.jat[r][i].movements[l].notes,m)&&(o.jat[r][i].movements[l].notes=m,oe.set(o))}return n.$$set=m=>{"junctionIdx"in m&&t(0,r=m.junctionIdx),"stage"in m&&t(1,i=m.stage),"idx"in m&&t(2,l=m.idx)},[r,i,l,o,a,s,f,c,d]}class ro extends Ne{constructor(e){super(),Oe(this,e,oo,no,Se,{junctionIdx:0,stage:1,idx:2})}}function ye(n){if(n.movements.length==0)return"No movements added";let e=0,t=0;for(let r of n.movements)e+={0:0,1:1,2:2,X:0}[r.score],t+=2;let o=e/t*100;return`${Math.round(o)}%`}var lo=Object.defineProperty,io=(n,e)=>lo(n,"name",{value:e,configurable:!0});function Gt(n,e={}){const t=rn(n),o=(t[0]+t[2])/2,r=(t[1]+t[3])/2;return Ut([o,r],e.properties,e)}io(Gt,"center");var ao=Gt;function so(n){let e=ao({type:"FeatureCollection",features:n.map(o=>({type:"Feature",geometry:{type:"Point",coordinates:o.point},properties:{}}))}).geometry.coordinates;n.sort((o,r)=>bt(Je(e,r.point))-bt(Je(e,o.point)));let t=[];for(let o=0;o<n.length;o++){let r=n[o],i=Je(r.point,e),l=1;for(let a of uo(o,n.length)){let s=n[a],f=Je(e,s.point),c=fo(r.point,e,l++),d=ln(r.point,e),m=Be(c,.5*d,i).geometry.coordinates,w=Be(m,.2*d,f).geometry.coordinates;t.push({point1:c,point2:m,point3:w,kind:"cycling",score:"X",name:`${r.name} to ${s.name}`,notes:""})}}return t}function fo(n,e,t){let o=.003,i=Je(n,e)-90,l=o*t;return Be(n,l,i).geometry.coordinates}function bt(n){return(n+360)%360}function uo(n,e){let t=[];for(let o=n+1;o<e;o++)t.push(o);for(let o=0;o<n;o++)t.push(o);return t}const{window:co}=Qt;function kt(n,e,t){const o=n.slice();o[34]=e[t],o[37]=t;const r=o[16][o[34].score];return o[35]=r,o}function wt(n,e,t){const o=n.slice();return o[38]=e[t],o[37]=t,o}function mo(n){let e,t,o,r,i,l,a,s;e=new Qe({props:{$$slots:{default:[_o]},$$scope:{ctx:n}}}),e.$on("click",n[11]),o=new xe({props:{$$slots:{default:[po]},$$scope:{ctx:n}}}),o.$on("click",n[12]);const f=[$o,ho],c=[];function d(m,w){return m[2].id.kind=="movement"?0:1}return i=d(n),l=c[i]=f[i](n),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment),r=U(),l.c(),a=$e()},l(m){F(e.$$.fragment,m),t=B(m),F(o.$$.fragment,m),r=B(m),l.l(m),a=$e()},m(m,w){H(e,m,w),y(m,t,w),H(o,m,w),y(m,r,w),c[i].m(m,w),y(m,a,w),s=!0},p(m,w){const I={};w[1]&2&&(I.$$scope={dirty:w,ctx:m}),e.$set(I);const A={};w[1]&2&&(A.$$scope={dirty:w,ctx:m}),o.$set(A);let v=i;i=d(m),i===v?c[i].p(m,w):(ve(),C(c[v],1,1,()=>{c[v]=null}),be(),l=c[i],l?l.p(m,w):(l=c[i]=f[i](m),l.c()),k(l,1),l.m(a.parentNode,a))},i(m){s||(k(e.$$.fragment,m),k(o.$$.fragment,m),k(l),s=!0)},o(m){C(e.$$.fragment,m),C(o.$$.fragment,m),C(l),s=!1},d(m){m&&(g(t),g(r),g(a)),R(e,m),R(o,m),c[i].d(m)}}}function go(n){let e,t,o,r,i,l,a,s=n[8].jat[n[0]].name+"",f,c,d,m,w,I="Arms",A,v,b,p,$="Movements",M,u,h,_,T,K,S=(n[8].jat[n[0]].name||"Untitled junction")+"",O,N,ie=ye(n[8].jat[n[0]][n[1]])+"",pe,ke,z,x,ee,le;const ue=n[18].default,P=It(ue,n,n[32],null);d=new Kt({props:{label:"Map tools",$$slots:{default:[yo]},$$scope:{ctx:n}}});let j=de(n[8].jat[n[0]][n[1]].arms),J=[];for(let E=0;E<j.length;E+=1)J[E]=yt(wt(n,j,E));const ge=E=>C(J[E],1,1,()=>{J[E]=null});let ne=n[8].jat[n[0]][n[9]].arms.length>0&&jt(n);z=new Pe({props:{disabled:n[8].jat[n[0]][n[1]].arms.length<2,$$slots:{default:[Co]},$$scope:{ctx:n}}}),z.$on("click",n[17]);let he=de(n[8].jat[n[0]][n[1]].movements),re=[];for(let E=0;E<he.length;E+=1)re[E]=Ct(kt(n,he,E));const Zt=E=>C(re[E],1,1,()=>{re[E]=null});let se=n[8].jat[n[0]][n[9]].movements.length>0&&Tt(n);return{c(){P&&P.c(),e=U(),t=W("div"),o=W("p"),r=W("b"),i=G("Currently editing "),l=G(n[1]),a=G(` junction
            `),f=G(s),c=U(),q(d.$$.fragment),m=U(),w=W("h3"),w.textContent=I,A=U();for(let E=0;E<J.length;E+=1)J[E].c();v=U(),ne&&ne.c(),b=U(),p=W("h3"),p.textContent=$,M=U(),u=W("p"),h=G("Total JAT score for "),_=G(n[1]),T=U(),K=W("u"),O=G(S),N=G(`
          : `),pe=G(ie),ke=U(),q(z.$$.fragment),x=U();for(let E=0;E<re.length;E+=1)re[E].c();ee=U(),se&&se.c(),this.h()},l(E){P&&P.l(E),e=B(E),t=V(E,"DIV",{class:!0});var D=X(t);o=V(D,"P",{});var _e=X(o);r=V(_e,"B",{});var je=X(r);i=Z(je,"Currently editing "),l=Z(je,n[1]),a=Z(je,` junction
            `),f=Z(je,s),je.forEach(g),_e.forEach(g),c=B(D),F(d.$$.fragment,D),m=B(D),w=V(D,"H3",{"data-svelte-h":!0}),Ue(w)!=="svelte-ld74qb"&&(w.textContent=I),A=B(D);for(let Ee=0;Ee<J.length;Ee+=1)J[Ee].l(D);v=B(D),ne&&ne.l(D),b=B(D),p=V(D,"H3",{"data-svelte-h":!0}),Ue(p)!=="svelte-1dc52s8"&&(p.textContent=$),M=B(D),u=V(D,"P",{});var Q=X(u);h=Z(Q,"Total JAT score for "),_=Z(Q,n[1]),T=B(Q),K=V(Q,"U",{});var Ce=X(K);O=Z(Ce,S),Ce.forEach(g),N=Z(Q,`
          : `),pe=Z(Q,ie),Q.forEach(g),ke=B(D),F(z.$$.fragment,D),x=B(D);for(let Ee=0;Ee<re.length;Ee+=1)re[Ee].l(D);ee=B(D),se&&se.l(D),D.forEach(g),this.h()},h(){te(t,"class","govuk-tabs__panel")},m(E,D){P&&P.m(E,D),y(E,e,D),y(E,t,D),L(t,o),L(o,r),L(r,i),L(r,l),L(r,a),L(r,f),L(t,c),H(d,t,null),L(t,m),L(t,w),L(t,A);for(let _e=0;_e<J.length;_e+=1)J[_e]&&J[_e].m(t,null);L(t,v),ne&&ne.m(t,null),L(t,b),L(t,p),L(t,M),L(t,u),L(u,h),L(u,_),L(u,T),L(u,K),L(K,O),L(u,N),L(u,pe),L(t,ke),H(z,t,null),L(t,x);for(let _e=0;_e<re.length;_e+=1)re[_e]&&re[_e].m(t,null);L(t,ee),se&&se.m(t,null),le=!0},p(E,D){P&&P.p&&(!le||D[1]&2)&&Nt(P,ue,E,E[32],le?Pt(ue,E[32],D,null):Ot(E[32]),null),(!le||D[0]&2)&&ae(l,E[1]),(!le||D[0]&257)&&s!==(s=E[8].jat[E[0]].name+"")&&ae(f,s);const _e={};if(D[0]&112|D[1]&2&&(_e.$$scope={dirty:D,ctx:E}),d.$set(_e),D[0]&1291){j=de(E[8].jat[E[0]][E[1]].arms);let Q;for(Q=0;Q<j.length;Q+=1){const Ce=wt(E,j,Q);J[Q]?(J[Q].p(Ce,D),k(J[Q],1)):(J[Q]=yt(Ce),J[Q].c(),k(J[Q],1),J[Q].m(t,v))}for(ve(),Q=j.length;Q<J.length;Q+=1)ge(Q);be()}E[8].jat[E[0]][E[9]].arms.length>0?ne?(ne.p(E,D),D[0]&257&&k(ne,1)):(ne=jt(E),ne.c(),k(ne,1),ne.m(t,b)):ne&&(ve(),C(ne,1,1,()=>{ne=null}),be()),(!le||D[0]&2)&&ae(_,E[1]),(!le||D[0]&257)&&S!==(S=(E[8].jat[E[0]].name||"Untitled junction")+"")&&ae(O,S),(!le||D[0]&259)&&ie!==(ie=ye(E[8].jat[E[0]][E[1]])+"")&&ae(pe,ie);const je={};if(D[0]&259&&(je.disabled=E[8].jat[E[0]][E[1]].arms.length<2),D[1]&2&&(je.$$scope={dirty:D,ctx:E}),z.$set(je),D[0]&66827){he=de(E[8].jat[E[0]][E[1]].movements);let Q;for(Q=0;Q<he.length;Q+=1){const Ce=kt(E,he,Q);re[Q]?(re[Q].p(Ce,D),k(re[Q],1)):(re[Q]=Ct(Ce),re[Q].c(),k(re[Q],1),re[Q].m(t,ee))}for(ve(),Q=he.length;Q<re.length;Q+=1)Zt(Q);be()}E[8].jat[E[0]][E[9]].movements.length>0?se?(se.p(E,D),D[0]&257&&k(se,1)):(se=Tt(E),se.c(),k(se,1),se.m(t,null)):se&&(ve(),C(se,1,1,()=>{se=null}),be())},i(E){if(!le){k(P,E),k(d.$$.fragment,E);for(let D=0;D<j.length;D+=1)k(J[D]);k(ne),k(z.$$.fragment,E);for(let D=0;D<he.length;D+=1)k(re[D]);k(se),le=!0}},o(E){C(P,E),C(d.$$.fragment,E),J=J.filter(Boolean);for(let D=0;D<J.length;D+=1)C(J[D]);C(ne),C(z.$$.fragment,E),re=re.filter(Boolean);for(let D=0;D<re.length;D+=1)C(re[D]);C(se),le=!1},d(E){E&&(g(e),g(t)),P&&P.d(E),R(d),Le(J,E),ne&&ne.d(),R(z),Le(re,E),se&&se.d()}}}function _o(n){let e;return{c(){e=G("Save")},l(t){e=Z(t,"Save")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function po(n){let e;return{c(){e=G("Delete")},l(t){e=Z(t,"Delete")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function ho(n){let e,t,o;function r(l){n[29](l)}let i={label:"Arm Name"};return n[8].jat[n[0]][n[1]].arms[n[2].id.idx].name!==void 0&&(i.value=n[8].jat[n[0]][n[1]].arms[n[2].id.idx].name),e=new Ye({props:i}),fe.push(()=>me(e,"value",r)),{c(){q(e.$$.fragment)},l(l){F(e.$$.fragment,l)},m(l,a){H(e,l,a),o=!0},p(l,a){const s={};!t&&a[0]&263&&(t=!0,s.value=l[8].jat[l[0]][l[1]].arms[l[2].id.idx].name,ce(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){C(e.$$.fragment,l),o=!1},d(l){R(e,l)}}}function $o(n){let e,t,o,r,i,l;return e=new ro({props:{junctionIdx:n[0],stage:n[1],idx:n[2].id.idx}}),o=new Qe({props:{$$slots:{default:[vo]},$$scope:{ctx:n}}}),o.$on("click",n[11]),i=new xe({props:{$$slots:{default:[bo]},$$scope:{ctx:n}}}),i.$on("click",n[12]),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment),r=U(),q(i.$$.fragment)},l(a){F(e.$$.fragment,a),t=B(a),F(o.$$.fragment,a),r=B(a),F(i.$$.fragment,a)},m(a,s){H(e,a,s),y(a,t,s),H(o,a,s),y(a,r,s),H(i,a,s),l=!0},p(a,s){const f={};s[0]&1&&(f.junctionIdx=a[0]),s[0]&2&&(f.stage=a[1]),s[0]&4&&(f.idx=a[2].id.idx),e.$set(f);const c={};s[1]&2&&(c.$$scope={dirty:s,ctx:a}),o.$set(c);const d={};s[1]&2&&(d.$$scope={dirty:s,ctx:a}),i.$set(d)},i(a){l||(k(e.$$.fragment,a),k(o.$$.fragment,a),k(i.$$.fragment,a),l=!0)},o(a){C(e.$$.fragment,a),C(o.$$.fragment,a),C(i.$$.fragment,a),l=!1},d(a){a&&(g(t),g(r)),R(e,a),R(o,a),R(i,a)}}}function vo(n){let e;return{c(){e=G("Save")},l(t){e=Z(t,"Save")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function bo(n){let e;return{c(){e=G("Delete")},l(t){e=Z(t,"Delete")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function ko(n){let e;return{c(){e=G("Zoom to fit")},l(t){e=Z(t,"Zoom to fit")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function wo(n){let e;return{c(){e=G("Show route")},l(t){e=Z(t,"Show route")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function yo(n){var b;let e,t,o,r,i,l,a,s,f,c,d,m;e=new Pe({props:{$$slots:{default:[ko]},$$scope:{ctx:n}}}),e.$on("click",n[20]),o=new mn({}),i=new un({});function w(p){n[21](p)}let I={map:(b=n[6])==null?void 0:b.getMap()};n[4]!==void 0&&(I.enabled=n[4]),a=new cn({props:I}),fe.push(()=>me(a,"enabled",w));function A(p){n[22](p)}let v={$$slots:{default:[wo]},$$scope:{ctx:n}};return n[5]!==void 0&&(v.checked=n[5]),c=new dn({props:v}),fe.push(()=>me(c,"checked",A)),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment),r=U(),q(i.$$.fragment),l=U(),q(a.$$.fragment),f=U(),q(c.$$.fragment)},l(p){F(e.$$.fragment,p),t=B(p),F(o.$$.fragment,p),r=B(p),F(i.$$.fragment,p),l=B(p),F(a.$$.fragment,p),f=B(p),F(c.$$.fragment,p)},m(p,$){H(e,p,$),y(p,t,$),H(o,p,$),y(p,r,$),H(i,p,$),y(p,l,$),H(a,p,$),y(p,f,$),H(c,p,$),m=!0},p(p,$){var _;const M={};$[1]&2&&(M.$$scope={dirty:$,ctx:p}),e.$set(M);const u={};$[0]&64&&(u.map=(_=p[6])==null?void 0:_.getMap()),!s&&$[0]&16&&(s=!0,u.enabled=p[4],ce(()=>s=!1)),a.$set(u);const h={};$[1]&2&&(h.$$scope={dirty:$,ctx:p}),!d&&$[0]&32&&(d=!0,h.checked=p[5],ce(()=>d=!1)),c.$set(h)},i(p){m||(k(e.$$.fragment,p),k(o.$$.fragment,p),k(i.$$.fragment,p),k(a.$$.fragment,p),k(c.$$.fragment,p),m=!0)},o(p){C(e.$$.fragment,p),C(o.$$.fragment,p),C(i.$$.fragment,p),C(a.$$.fragment,p),C(c.$$.fragment,p),m=!1},d(p){p&&(g(t),g(r),g(l),g(f)),R(e,p),R(o,p),R(i,p),R(a,p),R(c,p)}}}function yt(n){let e,t;function o(){return n[23](n[37])}function r(){return n[24](n[37])}return e=new et({props:{name:`${Lt(n[37])} - ${n[38].name||"Unnamed arm"}`}}),e.$on("click",o),e.$on("mouseenter",r),e.$on("mouseleave",n[25]),{c(){q(e.$$.fragment)},l(i){F(e.$$.fragment,i)},m(i,l){H(e,i,l),t=!0},p(i,l){n=i;const a={};l[0]&259&&(a.name=`${Lt(n[37])} - ${n[38].name||"Unnamed arm"}`),e.$set(a)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){R(e,i)}}}function jt(n){let e,t;return e=new Pe({props:{$$slots:{default:[jo]},$$scope:{ctx:n}}}),e.$on("click",n[14]),{c(){q(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){H(e,o,r),t=!0},p(o,r){const i={};r[1]&2&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){R(e,o)}}}function jo(n){let e,t;return{c(){e=G("Copy arms from "),t=G(n[9])},l(o){e=Z(o,"Copy arms from "),t=Z(o,n[9])},m(o,r){y(o,e,r),y(o,t,r)},p:Ie,d(o){o&&(g(e),g(t))}}}function Co(n){let e;return{c(){e=G("Generate cycling movements between all arms")},l(t){e=Z(t,"Generate cycling movements between all arms")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function To(n){let e,t,o,r=n[34].score+"",i,l,a,s=ot(n[34].kind)+"",f;return{c(){e=W("div"),t=W("span"),o=G("Score: "),i=G(r),l=U(),a=W("span"),f=G(s),this.h()},l(c){e=V(c,"DIV",{style:!0});var d=X(e);t=V(d,"SPAN",{style:!0});var m=X(t);o=Z(m,"Score: "),i=Z(m,r),m.forEach(g),l=B(d),a=V(d,"SPAN",{});var w=X(a);f=Z(w,s),w.forEach(g),d.forEach(g),this.h()},h(){Y(t,"padding","4px"),Y(t,"color",n[35].font),Y(t,"background-color",n[35].background),Y(e,"width","100%"),Y(e,"display","flex"),Y(e,"justify-content","space-between")},m(c,d){y(c,e,d),L(e,t),L(t,o),L(t,i),L(e,l),L(e,a),L(a,f)},p(c,d){d[0]&259&&r!==(r=c[34].score+"")&&ae(i,r),d[0]&259&&Y(t,"color",c[35].font),d[0]&259&&Y(t,"background-color",c[35].background),d[0]&259&&s!==(s=ot(c[34].kind)+"")&&ae(f,s)},d(c){c&&g(e)}}}function Ct(n){let e,t;function o(){return n[26](n[37])}function r(){return n[27](n[37])}return e=new et({props:{name:n[34].name||"Unnamed movement",$$slots:{default:[To]},$$scope:{ctx:n}}}),e.$on("click",o),e.$on("mouseenter",r),e.$on("mouseleave",n[28]),{c(){q(e.$$.fragment)},l(i){F(e.$$.fragment,i)},m(i,l){H(e,i,l),t=!0},p(i,l){n=i;const a={};l[0]&259&&(a.name=n[34].name||"Unnamed movement"),l[0]&259|l[1]&2&&(a.$$scope={dirty:l,ctx:n}),e.$set(a)},i(i){t||(k(e.$$.fragment,i),t=!0)},o(i){C(e.$$.fragment,i),t=!1},d(i){R(e,i)}}}function Tt(n){let e,t;return e=new Pe({props:{$$slots:{default:[Lo]},$$scope:{ctx:n}}}),e.$on("click",n[15]),{c(){q(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){H(e,o,r),t=!0},p(o,r){const i={};r[1]&2&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){R(e,o)}}}function Lo(n){let e,t;return{c(){e=G("Copy movements from "),t=G(n[9])},l(o){e=Z(o,"Copy movements from "),t=Z(o,n[9])},m(o,r){y(o,e,r),y(o,t,r)},p:Ie,d(o){o&&(g(e),g(t))}}}function So(n){let e,t,o,r,i,l,a,s=ye(n[8].jat[n[0]].existing)+"",f,c,d,m=ye(n[8].jat[n[0]].proposed)+"",w,I,A,v,b,p,$,M,u,h,_,T,K;function S(z){n[19](z)}let O={label:"Commentary / Notes about "+n[1]+" junction"};n[8].jat[n[0]][n[1]].notes!==void 0&&(O.value=n[8].jat[n[0]][n[1]].notes),t=new qt({props:O}),fe.push(()=>me(t,"value",S));const N=[go,mo],ie=[];function pe(z,x){return z[2].mode!="editing"?0:1}p=pe(n),$=ie[p]=N[p](n);let ke={junctionIdx:n[0],stage:n[1],mode:n[2],hoveringSidebar:n[3],streetviewOn:n[4],showRoute:n[5],select:n[10],stopEditing:n[11]};return h=new Vn({props:ke}),n[31](h),{c(){e=W("div"),q(t.$$.fragment),r=U(),i=W("p"),l=G("Total JAT score: "),a=W("b"),f=G(s),c=G(`
    existing,
    `),d=W("b"),w=G(m),I=G(`
    proposed`),A=U(),v=W("div"),b=W("div"),$.c(),M=U(),u=W("div"),q(h.$$.fragment),this.h()},l(z){e=V(z,"DIV",{class:!0});var x=X(e);F(t.$$.fragment,x),r=B(x),i=V(x,"P",{});var ee=X(i);l=Z(ee,"Total JAT score: "),a=V(ee,"B",{});var le=X(a);f=Z(le,s),le.forEach(g),c=Z(ee,`
    existing,
    `),d=V(ee,"B",{});var ue=X(d);w=Z(ue,m),ue.forEach(g),I=Z(ee,`
    proposed`),ee.forEach(g),x.forEach(g),A=B(z),v=V(z,"DIV",{style:!0});var P=X(v);b=V(P,"DIV",{style:!0});var j=X(b);$.l(j),j.forEach(g),M=B(P),u=V(P,"DIV",{style:!0});var J=X(u);F(h.$$.fragment,J),J.forEach(g),P.forEach(g),this.h()},h(){te(e,"class","govuk-width-container"),Y(b,"width","30%"),Y(b,"overflow-y","scroll"),Y(b,"padding","10px"),Y(b,"border","1px solid black"),Y(u,"position","relative"),Y(u,"width","100%"),Y(v,"display","flex"),Y(v,"height","80vh")},m(z,x){y(z,e,x),H(t,e,null),L(e,r),L(e,i),L(i,l),L(i,a),L(a,f),L(i,c),L(i,d),L(d,w),L(i,I),y(z,A,x),y(z,v,x),L(v,b),ie[p].m(b,null),n[30](b),L(v,M),L(v,u),H(h,u,null),_=!0,T||(K=Dt(co,"keydown",n[13]),T=!0)},p(z,x){const ee={};x[0]&2&&(ee.label="Commentary / Notes about "+z[1]+" junction"),!o&&x[0]&259&&(o=!0,ee.value=z[8].jat[z[0]][z[1]].notes,ce(()=>o=!1)),t.$set(ee),(!_||x[0]&257)&&s!==(s=ye(z[8].jat[z[0]].existing)+"")&&ae(f,s),(!_||x[0]&257)&&m!==(m=ye(z[8].jat[z[0]].proposed)+"")&&ae(w,m);let le=p;p=pe(z),p===le?ie[p].p(z,x):(ve(),C(ie[le],1,1,()=>{ie[le]=null}),be(),$=ie[p],$?$.p(z,x):($=ie[p]=N[p](z),$.c()),k($,1),$.m(b,null));const ue={};x[0]&1&&(ue.junctionIdx=z[0]),x[0]&2&&(ue.stage=z[1]),x[0]&4&&(ue.mode=z[2]),x[0]&8&&(ue.hoveringSidebar=z[3]),x[0]&16&&(ue.streetviewOn=z[4]),x[0]&32&&(ue.showRoute=z[5]),h.$set(ue)},i(z){_||(k(t.$$.fragment,z),k($),k(h.$$.fragment,z),_=!0)},o(z){C(t.$$.fragment,z),C($),C(h.$$.fragment,z),_=!1},d(z){z&&(g(e),g(A),g(v)),R(t),ie[p].d(),n[30](null),n[31](null),R(h),T=!1,K()}}}function Lt(n){return String.fromCharCode(n+65)}function Eo(n,e,t){let o;He(n,oe,P=>t(8,o=P));let{$$slots:r={},$$scope:i}=e,{junctionIdx:l}=e,{stage:a}=e,s=a=="existing"?"proposed":"existing",f={mode:"select"},c=null,d=null,m=!1,w=!0,I=null,A;async function v(P){c=A.scrollTop,t(2,f={mode:"editing",id:P}),t(3,d=null),await nt(),t(7,A.scrollTop=0,A)}async function b(){t(2,f={mode:"select"}),c!=null&&(await nt(),t(7,A.scrollTop=c,A),c=null)}function p(){f.mode=="editing"&&window.confirm(`Delete this ${f.id.kind}?`)&&(f.id.kind=="movement"?(o.jat[l][a].movements.splice(f.id.idx,1),oe.set(o)):(o.jat[l][a].arms.splice(f.id.idx,1),oe.set(o)),b())}function $(P){if(f.mode!="editing")return;let j=P.target.tagName,J=j=="INPUT"||j=="TEXTAREA";P.key=="Escape"||P.key=="Enter"&&!J?(P.stopPropagation(),b()):P.key=="Delete"&&!J&&(P.stopPropagation(),p())}function M(){o.jat[l][a].arms.length>0&&!window.confirm("Overwrite arms?")||(De(oe,o.jat[l][a].arms=JSON.parse(JSON.stringify(o.jat[l][s].arms)),o),oe.set(o))}function u(){o.jat[l][a].movements.length>0&&!window.confirm("Overwrite movements?")||(De(oe,o.jat[l][a].movements=JSON.parse(JSON.stringify(o.jat[l][s].movements)),o),oe.set(o))}let h={0:Te.red,1:Te.amber,2:Te.green,X:Te.critical};function _(){o.jat[l][a].movements.length>0&&!window.confirm("Overwrite all movements?")||De(oe,o.jat[l][a].movements=so(o.jat[l][a].arms),o)}function T(P){n.$$.not_equal(o.jat[l][a].notes,P)&&(o.jat[l][a].notes=P,oe.set(o))}const K=()=>I==null?void 0:I.zoom(!0);function S(P){m=P,t(4,m)}function O(P){w=P,t(5,w)}const N=P=>v({kind:"arm",idx:P}),ie=P=>t(3,d={kind:"arm",idx:P}),pe=()=>t(3,d=null),ke=P=>v({kind:"movement",idx:P}),z=P=>t(3,d={kind:"movement",idx:P}),x=()=>t(3,d=null);function ee(P){n.$$.not_equal(o.jat[l][a].arms[f.id.idx].name,P)&&(o.jat[l][a].arms[f.id.idx].name=P,oe.set(o))}function le(P){fe[P?"unshift":"push"](()=>{A=P,t(7,A)})}function ue(P){fe[P?"unshift":"push"](()=>{I=P,t(6,I)})}return n.$$set=P=>{"junctionIdx"in P&&t(0,l=P.junctionIdx),"stage"in P&&t(1,a=P.stage),"$$scope"in P&&t(32,i=P.$$scope)},[l,a,f,d,m,w,I,A,o,s,v,b,p,$,M,u,h,_,r,T,K,S,O,N,ie,pe,ke,z,x,ee,le,ue,i]}class Mo extends Ne{constructor(e){super(),Oe(this,e,Eo,So,Se,{junctionIdx:0,stage:1},null,[-1,-1])}}function Ao(n){let e,t,o,r,i;return{c(){e=W("li"),t=W("a"),o=G(n[0]),this.h()},l(l){e=V(l,"LI",{class:!0});var a=X(e);t=V(a,"A",{class:!0,href:!0});var s=X(t);o=Z(s,n[0]),s.forEach(g),a.forEach(g),this.h()},h(){te(t,"class","govuk-tabs__tab"),te(t,"href","#"),te(e,"class","govuk-tabs__list-item")},m(l,a){y(l,e,a),L(e,t),L(t,o),r||(i=Dt(t,"click",Vt(n[2])),r=!0)},p(l,a){a&1&&ae(o,l[0])},d(l){l&&g(e),r=!1,i()}}}function Io(n){let e,t;return{c(){e=W("li"),t=G(n[0]),this.h()},l(o){e=V(o,"LI",{class:!0});var r=X(e);t=Z(r,n[0]),r.forEach(g),this.h()},h(){te(e,"class","govuk-tabs__list-item govuk-tabs__list-item--selected")},m(o,r){y(o,e,r),L(e,t)},p(o,r){r&1&&ae(t,o[0])},d(o){o&&g(e)}}}function No(n){let e;function t(i,l){return i[1]?Io:Ao}let o=t(n),r=o(n);return{c(){r.c(),e=$e()},l(i){r.l(i),e=$e()},m(i,l){r.m(i,l),y(i,e,l)},p(i,[l]){o===(o=t(i))&&r?r.p(i,l):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},i:Ie,o:Ie,d(i){i&&g(e),r.d(i)}}}function Oo(n,e,t){let{label:o}=e,{isCurrent:r}=e;function i(l){Me.call(this,n,l)}return n.$$set=l=>{"label"in l&&t(0,o=l.label),"isCurrent"in l&&t(1,r=l.isCurrent)},[o,r,i]}class St extends Ne{constructor(e){super(),Oe(this,e,Oo,No,Se,{label:0,isCurrent:1})}}function Et(n,e,t){const o=n.slice();return o[10]=e[t],o[12]=t,o}function Po(n){let e,t,o=(n[1].jat[n[0].idx].name||"Untitled junction")+"",r,i,l=n[0].stage+"",a,s,f,c,d,m,w,I=n[0].stage,A,v;f=new Xt({props:{$$slots:{default:[Bo]},$$scope:{ctx:n}}});function b(M){n[7](M)}let p={label:"Junction Name"};n[1].jat[n[0].idx].name!==void 0&&(p.value=n[1].jat[n[0].idx].name),d=new Ye({props:p}),fe.push(()=>me(d,"value",b));let $=Mt(n);return{c(){e=W("div"),t=W("h2"),r=G(o),i=G(" - "),a=G(l),s=U(),q(f.$$.fragment),c=U(),q(d.$$.fragment),w=U(),$.c(),A=$e(),this.h()},l(M){e=V(M,"DIV",{class:!0});var u=X(e);t=V(u,"H2",{});var h=X(t);r=Z(h,o),i=Z(h," - "),a=Z(h,l),h.forEach(g),s=B(u),F(f.$$.fragment,u),c=B(u),F(d.$$.fragment,u),u.forEach(g),w=B(M),$.l(M),A=$e(),this.h()},h(){te(e,"class","govuk-width-container")},m(M,u){y(M,e,u),L(e,t),L(t,r),L(t,i),L(t,a),L(e,s),H(f,e,null),L(e,c),H(d,e,null),y(M,w,u),$.m(M,u),y(M,A,u),v=!0},p(M,u){(!v||u&3)&&o!==(o=(M[1].jat[M[0].idx].name||"Untitled junction")+"")&&ae(r,o),(!v||u&1)&&l!==(l=M[0].stage+"")&&ae(a,l);const h={};u&8193&&(h.$$scope={dirty:u,ctx:M}),f.$set(h);const _={};!m&&u&3&&(m=!0,_.value=M[1].jat[M[0].idx].name,ce(()=>m=!1)),d.$set(_),u&1&&Se(I,I=M[0].stage)?(ve(),C($,1,1,Ie),be(),$=Mt(M),$.c(),k($,1),$.m(A.parentNode,A)):$.p(M,u)},i(M){v||(k(f.$$.fragment,M),k(d.$$.fragment,M),k($),v=!0)},o(M){C(f.$$.fragment,M),C(d.$$.fragment,M),C($),v=!1},d(M){M&&(g(e),g(w),g(A)),R(f),R(d),$.d(M)}}}function Jo(n){let e,t,o,r;t=new Qe({props:{$$slots:{default:[Fo]},$$scope:{ctx:n}}}),t.$on("click",n[2]);let i=de(n[1].jat),l=[];for(let s=0;s<i.length;s+=1)l[s]=At(Et(n,i,s));const a=s=>C(l[s],1,1,()=>{l[s]=null});return{c(){e=W("div"),q(t.$$.fragment),o=U();for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=V(s,"DIV",{class:!0});var f=X(e);F(t.$$.fragment,f),o=B(f);for(let c=0;c<l.length;c+=1)l[c].l(f);f.forEach(g),this.h()},h(){te(e,"class","govuk-width-container")},m(s,f){y(s,e,f),H(t,e,null),L(e,o);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(e,null);r=!0},p(s,f){const c={};if(f&8192&&(c.$$scope={dirty:f,ctx:s}),t.$set(c),f&3){i=de(s[1].jat);let d;for(d=0;d<i.length;d+=1){const m=Et(s,i,d);l[d]?(l[d].p(m,f),k(l[d],1)):(l[d]=At(m),l[d].c(),k(l[d],1),l[d].m(e,null))}for(ve(),d=i.length;d<l.length;d+=1)a(d);be()}},i(s){if(!r){k(t.$$.fragment,s);for(let f=0;f<i.length;f+=1)k(l[f]);r=!0}},o(s){C(t.$$.fragment,s),l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)C(l[f]);r=!1},d(s){s&&g(e),R(t),Le(l,s)}}}function Do(n){let e;return{c(){e=G("Back to all junctions")},l(t){e=Z(t,"Back to all junctions")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Uo(n){let e;return{c(){e=G("Delete junction")},l(t){e=Z(t,"Delete junction")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Bo(n){let e,t,o,r;return e=new Pe({props:{$$slots:{default:[Do]},$$scope:{ctx:n}}}),e.$on("click",n[5]),o=new xe({props:{$$slots:{default:[Uo]},$$scope:{ctx:n}}}),o.$on("click",n[6]),{c(){q(e.$$.fragment),t=U(),q(o.$$.fragment)},l(i){F(e.$$.fragment,i),t=B(i),F(o.$$.fragment,i)},m(i,l){H(e,i,l),y(i,t,l),H(o,i,l),r=!0},p(i,l){const a={};l&8192&&(a.$$scope={dirty:l,ctx:i}),e.$set(a);const s={};l&8192&&(s.$$scope={dirty:l,ctx:i}),o.$set(s)},i(i){r||(k(e.$$.fragment,i),k(o.$$.fragment,i),r=!0)},o(i){C(e.$$.fragment,i),C(o.$$.fragment,i),r=!1},d(i){i&&g(t),R(e,i),R(o,i)}}}function qo(n){let e,t,o,r,i;return t=new St({props:{label:"Existing",isCurrent:n[0].stage=="existing"}}),t.$on("click",n[8]),r=new St({props:{label:"Proposed",isCurrent:n[0].stage=="proposed"}}),r.$on("click",n[9]),{c(){e=W("ul"),q(t.$$.fragment),o=U(),q(r.$$.fragment),this.h()},l(l){e=V(l,"UL",{class:!0,style:!0});var a=X(e);F(t.$$.fragment,a),o=B(a),F(r.$$.fragment,a),a.forEach(g),this.h()},h(){te(e,"class","govuk-tabs__list"),Y(e,"list-style-type","none")},m(l,a){y(l,e,a),H(t,e,null),L(e,o),H(r,e,null),i=!0},p(l,a){const s={};a&1&&(s.isCurrent=l[0].stage=="existing"),t.$set(s);const f={};a&1&&(f.isCurrent=l[0].stage=="proposed"),r.$set(f)},i(l){i||(k(t.$$.fragment,l),k(r.$$.fragment,l),i=!0)},o(l){C(t.$$.fragment,l),C(r.$$.fragment,l),i=!1},d(l){l&&g(e),R(t),R(r)}}}function Mt(n){let e,t;return e=new Mo({props:{junctionIdx:n[0].idx,stage:n[0].stage,$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){H(e,o,r),t=!0},p(o,r){const i={};r&1&&(i.junctionIdx=o[0].idx),r&1&&(i.stage=o[0].stage),r&8193&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){R(e,o)}}}function Fo(n){let e;return{c(){e=G("Add new junction")},l(t){e=Z(t,"Add new junction")},m(t,o){y(t,e,o)},d(t){t&&g(e)}}}function Ho(n){let e,t,o,r=ye(n[10].existing)+"",i,l,a,s,f=ye(n[10].proposed)+"",c,d;return{c(){e=W("div"),t=W("span"),o=G("Existing: "),i=G(r),l=U(),a=W("span"),s=G("Proposed: "),c=G(f),d=U(),this.h()},l(m){e=V(m,"DIV",{style:!0});var w=X(e);t=V(w,"SPAN",{});var I=X(t);o=Z(I,"Existing: "),i=Z(I,r),I.forEach(g),l=B(w),a=V(w,"SPAN",{});var A=X(a);s=Z(A,"Proposed: "),c=Z(A,f),A.forEach(g),w.forEach(g),d=B(m),this.h()},h(){Y(e,"width","100%"),Y(e,"display","flex"),Y(e,"justify-content","space-between")},m(m,w){y(m,e,w),L(e,t),L(t,o),L(t,i),L(e,l),L(e,a),L(a,s),L(a,c),y(m,d,w)},p(m,w){w&2&&r!==(r=ye(m[10].existing)+"")&&ae(i,r),w&2&&f!==(f=ye(m[10].proposed)+"")&&ae(c,f)},d(m){m&&(g(e),g(d))}}}function At(n){let e,t;function o(){return n[4](n[12])}return e=new et({props:{name:n[10].name||"Untitled junction",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),e.$on("click",o),{c(){q(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,i){H(e,r,i),t=!0},p(r,i){n=r;const l={};i&2&&(l.name=n[10].name||"Untitled junction"),i&8194&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){R(e,r)}}}function Ro(n){let e,t,o,r;const i=[Jo,Po],l=[];function a(s,f){return s[0].kind=="list"?0:s[0].kind=="edit"?1:-1}return~(e=a(n))&&(t=l[e]=i[e](n)),{c(){t&&t.c(),o=$e()},l(s){t&&t.l(s),o=$e()},m(s,f){~e&&l[e].m(s,f),y(s,o,f),r=!0},p(s,[f]){let c=e;e=a(s),e===c?~e&&l[e].p(s,f):(t&&(ve(),C(l[c],1,1,()=>{l[c]=null}),be()),~e?(t=l[e],t?t.p(s,f):(t=l[e]=i[e](s),t.c()),k(t,1),t.m(o.parentNode,o)):t=null)},i(s){r||(k(t),r=!0)},o(s){C(t),r=!1},d(s){s&&g(o),~e&&l[e].d(s)}}}function ze(n){if(n.kind=="list")throw new Error("Unreachable case");return n.idx}function Go(n,e,t){let o;He(n,oe,w=>t(1,o=w));let r={kind:"list"};function i(){De(oe,o.jat=[...o.jat,{name:"",existing:{arms:[],movements:[],notes:""},proposed:{arms:[],movements:[],notes:""}}],o),t(0,r={kind:"edit",idx:o.jat.length-1,stage:"existing"})}function l(w){window.confirm("Delete this junction?")&&(o.jat.splice(w,1),oe.set(o),t(0,r={kind:"list"}))}const a=w=>t(0,r={kind:"edit",idx:w,stage:"existing"}),s=()=>t(0,r={kind:"list"}),f=()=>l(ze(r));function c(w){n.$$.not_equal(o.jat[r.idx].name,w)&&(o.jat[r.idx].name=w,oe.set(o))}return[r,o,i,l,a,s,f,c,()=>t(0,r={kind:"edit",idx:ze(r),stage:"existing"}),()=>t(0,r={kind:"edit",idx:ze(r),stage:"proposed"})]}class $r extends Ne{constructor(e){super(),Oe(this,e,Go,Ro,Se,{})}}export{$r as component};
