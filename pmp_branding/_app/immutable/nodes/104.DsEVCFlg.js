import{s as Ie,r as K,e as F,t as J,a as M,c as U,b as j,d as W,f as $,g as R,q as P,v as O,i as h,h as D,w as Y,k as he,y as at,S as ft,a0 as we,U as me,D as ee,p as de,J as ve,j as re,H as ct,N as pe,O as _e,n as ut}from"../chunks/scheduler.BupgUPYD.js";import{S as Le,i as Ne,e as z,c as q,a as T,m as V,t as k,g as ne,b as C,f as ie,d as G}from"../chunks/index.DdWFotL4.js";import{g as pt}from"../chunks/globals.D0QH3NT1.js";import{e as oe}from"../chunks/each.DPGgJC1I.js";import{p as Se,c as Je}from"../chunks/colors.DaC397qr.js";import{p as We}from"../chunks/index.BA1rAv90.js";import{R as Ze}from"../chunks/Radio.CxjiHn3j.js";import"../chunks/index.Bpbm2oXU.js";import{S as Ke}from"../chunks/Select.aWzNrNW2.js";import{T as Ye}from"../chunks/TextArea.Cia7bsIP.js";import{T as ze}from"../chunks/TextInput.dciOiC7A.js";import{s as Z}from"../chunks/data.BWi8i506.js";import{l as be,n as ke,M as _t,b as mt,G as gt,C as $t}from"../chunks/index.BWmBN8eg.js";import{c as dt,p as ht,b as De,e as Pe,f as vt,g as bt}from"../chunks/lists.Bn2sGx3F.js";import{Y as Xe}from"../chunks/YesNo.DOFP7eqX.js";import{B as kt,C as wt,M as Qe}from"../chunks/Marker.D7pECOig.js";import{D as yt,C as Ct}from"../chunks/DefaultButton.B9e1GVo9.js";import{S as xe}from"../chunks/SecondaryButton.DDaC9gF3.js";import{W as It}from"../chunks/WarningButton.DFY34J1l.js";import{G as Lt,S as Nt,C as et,M as St}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.QitH8UF1.js";import{G as Et,I as ye,p as Dt}from"../chunks/pan.CrLZReyv.js";import"../chunks/index.BdPXl7v6.js";import"../chunks/paths.DQM9U2ZU.js";import{p as Pt}from"../chunks/stores.CheWkyVS.js";import"../chunks/entry.D1ZcAZMA.js";import{R as Bt}from"../chunks/RouteMapLayer.kFoqHabr.js";function Be(n){let e,l,t;function i(r){n[5](r)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].criticalIssues[n[0]].resolved!==void 0&&(s.value=n[1].criticalIssues[n[0]].resolved),e=new Xe({props:s}),K.push(()=>z(e,"value",i)),{c(){q(e.$$.fragment)},l(r){T(e.$$.fragment,r)},m(r,f){V(e,r,f),t=!0},p(r,f){const o={};!l&&f&3&&(l=!0,o.value=r[1].criticalIssues[r[0]].resolved,Y(()=>l=!1)),e.$set(o)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){G(e,r)}}}function At(n){let e,l,t,i,s,r,f,o,p,_,L,v,w,g,B,N,c,I,a,m,S,b;function X(u){n[2](u)}let A={label:"Critical Issue",emptyOption:!0,choices:dt};n[1].criticalIssues[n[0]].criticalIssue!==void 0&&(A.value=n[1].criticalIssues[n[0]].criticalIssue),_=new Ke({props:A}),K.push(()=>z(_,"value",X));function te(u){n[3](u)}let se={label:"Stage",choices:We(["Existing","Design"]),inlineSmall:!0};n[1].criticalIssues[n[0]].stage!==void 0&&(se.value=n[1].criticalIssues[n[0]].stage),w=new Ze({props:se}),K.push(()=>z(w,"value",te));function ge(u){n[4](u)}let ae={label:"Location Name"};n[1].criticalIssues[n[0]].locationName!==void 0&&(ae.value=n[1].criticalIssues[n[0]].locationName),N=new ze({props:ae}),K.push(()=>z(N,"value",ge));let E=n[1].criticalIssues[n[0]].stage!="Design"&&Be(n);function $e(u){n[6](u)}let fe={label:"Commentary & Feedback"};return n[1].criticalIssues[n[0]].notes!==void 0&&(fe.value=n[1].criticalIssues[n[0]].notes),m=new Ye({props:fe}),K.push(()=>z(m,"value",$e)),{c(){e=F("div"),l=F("a"),t=J("Google StreetView"),s=M(),r=F("a"),f=J("Bing Streetside"),p=M(),q(_.$$.fragment),v=M(),q(w.$$.fragment),B=M(),q(N.$$.fragment),I=M(),E&&E.c(),a=M(),q(m.$$.fragment),this.h()},l(u){e=U(u,"DIV",{style:!0});var y=j(e);l=U(y,"A",{href:!0,target:!0});var Q=j(l);t=W(Q,"Google StreetView"),Q.forEach($),s=R(y),r=U(y,"A",{href:!0,target:!0});var x=j(r);f=W(x,"Bing Streetside"),x.forEach($),y.forEach($),p=R(u),T(_.$$.fragment,u),v=R(u),T(w.$$.fragment,u),B=R(u),T(N.$$.fragment,u),I=R(u),E&&E.l(u),a=R(u),T(m.$$.fragment,u),this.h()},h(){P(l,"href",i=be(n[1].criticalIssues[n[0]].point)),P(l,"target","_blank"),P(r,"href",o=ke(n[1].criticalIssues[n[0]].point)),P(r,"target","_blank"),O(e,"display","flex"),O(e,"justify-content","space-evenly")},m(u,y){h(u,e,y),D(e,l),D(l,t),D(e,s),D(e,r),D(r,f),h(u,p,y),V(_,u,y),h(u,v,y),V(w,u,y),h(u,B,y),V(N,u,y),h(u,I,y),E&&E.m(u,y),h(u,a,y),V(m,u,y),b=!0},p(u,[y]){(!b||y&3&&i!==(i=be(u[1].criticalIssues[u[0]].point)))&&P(l,"href",i),(!b||y&3&&o!==(o=ke(u[1].criticalIssues[u[0]].point)))&&P(r,"href",o);const Q={};!L&&y&3&&(L=!0,Q.value=u[1].criticalIssues[u[0]].criticalIssue,Y(()=>L=!1)),_.$set(Q);const x={};!g&&y&3&&(g=!0,x.value=u[1].criticalIssues[u[0]].stage,Y(()=>g=!1)),w.$set(x);const ce={};!c&&y&3&&(c=!0,ce.value=u[1].criticalIssues[u[0]].locationName,Y(()=>c=!1)),N.$set(ce),u[1].criticalIssues[u[0]].stage!="Design"?E?(E.p(u,y),y&3&&k(E,1)):(E=Be(u),E.c(),k(E,1),E.m(a.parentNode,a)):E&&(ne(),C(E,1,1,()=>{E=null}),ie());const ue={};!S&&y&3&&(S=!0,ue.value=u[1].criticalIssues[u[0]].notes,Y(()=>S=!1)),m.$set(ue)},i(u){b||(k(_.$$.fragment,u),k(w.$$.fragment,u),k(N.$$.fragment,u),k(E),k(m.$$.fragment,u),b=!0)},o(u){C(_.$$.fragment,u),C(w.$$.fragment,u),C(N.$$.fragment,u),C(E),C(m.$$.fragment,u),b=!1},d(u){u&&($(e),$(p),$(v),$(B),$(I),$(a)),G(_,u),G(w,u),G(N,u),E&&E.d(u),G(m,u)}}}function Mt(n,e,l){let t;he(n,Z,_=>l(1,t=_));let{idx:i}=e;function s(_){n.$$.not_equal(t.criticalIssues[i].criticalIssue,_)&&(t.criticalIssues[i].criticalIssue=_,Z.set(t))}function r(_){n.$$.not_equal(t.criticalIssues[i].stage,_)&&(t.criticalIssues[i].stage=_,Z.set(t))}function f(_){n.$$.not_equal(t.criticalIssues[i].locationName,_)&&(t.criticalIssues[i].locationName=_,Z.set(t))}function o(_){n.$$.not_equal(t.criticalIssues[i].resolved,_)&&(t.criticalIssues[i].resolved=_,Z.set(t))}function p(_){n.$$.not_equal(t.criticalIssues[i].notes,_)&&(t.criticalIssues[i].notes=_,Z.set(t))}return n.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,t,s,r,f,o,p]}class Rt extends Le{constructor(e){super(),Ne(this,e,Mt,At,Ie,{idx:0})}}function Ae(n){let e,l,t;function i(r){n[5](r)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].policyConflictLog[n[0]].resolved!==void 0&&(s.value=n[1].policyConflictLog[n[0]].resolved),e=new Xe({props:s}),K.push(()=>z(e,"value",i)),{c(){q(e.$$.fragment)},l(r){T(e.$$.fragment,r)},m(r,f){V(e,r,f),t=!0},p(r,f){const o={};!l&&f&3&&(l=!0,o.value=r[1].policyConflictLog[r[0]].resolved,Y(()=>l=!1)),e.$set(o)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){G(e,r)}}}function qt(n){let e,l,t,i,s,r,f,o,p,_,L,v,w,g,B,N,c,I,a,m,S,b;function X(u){n[2](u)}let A={label:"Policy Conflict",emptyOption:!0,choices:ht};n[1].policyConflictLog[n[0]].conflict!==void 0&&(A.value=n[1].policyConflictLog[n[0]].conflict),_=new Ke({props:A}),K.push(()=>z(_,"value",X));function te(u){n[3](u)}let se={label:"Stage",choices:We(["Existing","Design"]),inlineSmall:!0};n[1].policyConflictLog[n[0]].stage!==void 0&&(se.value=n[1].policyConflictLog[n[0]].stage),w=new Ze({props:se}),K.push(()=>z(w,"value",te));function ge(u){n[4](u)}let ae={label:"Location Name"};n[1].policyConflictLog[n[0]].locationName!==void 0&&(ae.value=n[1].policyConflictLog[n[0]].locationName),N=new ze({props:ae}),K.push(()=>z(N,"value",ge));let E=n[1].policyConflictLog[n[0]].stage!="Design"&&Ae(n);function $e(u){n[6](u)}let fe={label:"Commentary & Feedback"};return n[1].policyConflictLog[n[0]].notes!==void 0&&(fe.value=n[1].policyConflictLog[n[0]].notes),m=new Ye({props:fe}),K.push(()=>z(m,"value",$e)),{c(){e=F("div"),l=F("a"),t=J("Google StreetView"),s=M(),r=F("a"),f=J("Bing Streetside"),p=M(),q(_.$$.fragment),v=M(),q(w.$$.fragment),B=M(),q(N.$$.fragment),I=M(),E&&E.c(),a=M(),q(m.$$.fragment),this.h()},l(u){e=U(u,"DIV",{style:!0});var y=j(e);l=U(y,"A",{href:!0,target:!0});var Q=j(l);t=W(Q,"Google StreetView"),Q.forEach($),s=R(y),r=U(y,"A",{href:!0,target:!0});var x=j(r);f=W(x,"Bing Streetside"),x.forEach($),y.forEach($),p=R(u),T(_.$$.fragment,u),v=R(u),T(w.$$.fragment,u),B=R(u),T(N.$$.fragment,u),I=R(u),E&&E.l(u),a=R(u),T(m.$$.fragment,u),this.h()},h(){P(l,"href",i=be(n[1].policyConflictLog[n[0]].point)),P(l,"target","_blank"),P(r,"href",o=ke(n[1].policyConflictLog[n[0]].point)),P(r,"target","_blank"),O(e,"display","flex"),O(e,"justify-content","space-evenly")},m(u,y){h(u,e,y),D(e,l),D(l,t),D(e,s),D(e,r),D(r,f),h(u,p,y),V(_,u,y),h(u,v,y),V(w,u,y),h(u,B,y),V(N,u,y),h(u,I,y),E&&E.m(u,y),h(u,a,y),V(m,u,y),b=!0},p(u,[y]){(!b||y&3&&i!==(i=be(u[1].policyConflictLog[u[0]].point)))&&P(l,"href",i),(!b||y&3&&o!==(o=ke(u[1].policyConflictLog[u[0]].point)))&&P(r,"href",o);const Q={};!L&&y&3&&(L=!0,Q.value=u[1].policyConflictLog[u[0]].conflict,Y(()=>L=!1)),_.$set(Q);const x={};!g&&y&3&&(g=!0,x.value=u[1].policyConflictLog[u[0]].stage,Y(()=>g=!1)),w.$set(x);const ce={};!c&&y&3&&(c=!0,ce.value=u[1].policyConflictLog[u[0]].locationName,Y(()=>c=!1)),N.$set(ce),u[1].policyConflictLog[u[0]].stage!="Design"?E?(E.p(u,y),y&3&&k(E,1)):(E=Ae(u),E.c(),k(E,1),E.m(a.parentNode,a)):E&&(ne(),C(E,1,1,()=>{E=null}),ie());const ue={};!S&&y&3&&(S=!0,ue.value=u[1].policyConflictLog[u[0]].notes,Y(()=>S=!1)),m.$set(ue)},i(u){b||(k(_.$$.fragment,u),k(w.$$.fragment,u),k(N.$$.fragment,u),k(E),k(m.$$.fragment,u),b=!0)},o(u){C(_.$$.fragment,u),C(w.$$.fragment,u),C(N.$$.fragment,u),C(E),C(m.$$.fragment,u),b=!1},d(u){u&&($(e),$(p),$(v),$(B),$(I),$(a)),G(_,u),G(w,u),G(N,u),E&&E.d(u),G(m,u)}}}function Tt(n,e,l){let t;he(n,Z,_=>l(1,t=_));let{idx:i}=e;function s(_){n.$$.not_equal(t.policyConflictLog[i].conflict,_)&&(t.policyConflictLog[i].conflict=_,Z.set(t))}function r(_){n.$$.not_equal(t.policyConflictLog[i].stage,_)&&(t.policyConflictLog[i].stage=_,Z.set(t))}function f(_){n.$$.not_equal(t.policyConflictLog[i].locationName,_)&&(t.policyConflictLog[i].locationName=_,Z.set(t))}function o(_){n.$$.not_equal(t.policyConflictLog[i].resolved,_)&&(t.policyConflictLog[i].resolved=_,Z.set(t))}function p(_){n.$$.not_equal(t.policyConflictLog[i].notes,_)&&(t.policyConflictLog[i].notes=_,Z.set(t))}return n.$$set=_=>{"idx"in _&&l(0,i=_.idx)},[i,t,s,r,f,o,p]}class Vt extends Le{constructor(e){super(),Ne(this,e,Tt,qt,Ie,{idx:0})}}const{window:Gt}=pt;function Me(n,e,l){const t=n.slice();return t[40]=e[l],t[41]=e,t[42]=l,t}function Re(n,e,l){const t=n.slice();return t[43]=e[l],t[44]=e,t[42]=l,t}function qe(n,e,l){const t=n.slice();return t[40]=e[l],t[42]=l,t}function Te(n,e,l){const t=n.slice();return t[43]=e[l],t[42]=l,t}function jt(n){let e,l,t,i,s,r,f,o,p,_;e=new yt({props:{$$slots:{default:[Ut]},$$scope:{ctx:n}}}),e.$on("click",n[11]),t=new It({props:{$$slots:{default:[Ot]},$$scope:{ctx:n}}}),t.$on("click",n[13]),s=new xe({props:{$$slots:{default:[Ht]},$$scope:{ctx:n}}}),s.$on("click",n[10]);const L=[Wt,Jt],v=[];function w(g,B){return g[1].id.kind=="critical"?0:1}return f=w(n),o=v[f]=L[f](n),{c(){q(e.$$.fragment),l=M(),q(t.$$.fragment),i=M(),q(s.$$.fragment),r=M(),o.c(),p=ee()},l(g){T(e.$$.fragment,g),l=R(g),T(t.$$.fragment,g),i=R(g),T(s.$$.fragment,g),r=R(g),o.l(g),p=ee()},m(g,B){V(e,g,B),h(g,l,B),V(t,g,B),h(g,i,B),V(s,g,B),h(g,r,B),v[f].m(g,B),h(g,p,B),_=!0},p(g,B){const N={};B[1]&65536&&(N.$$scope={dirty:B,ctx:g}),e.$set(N);const c={};B[1]&65536&&(c.$$scope={dirty:B,ctx:g}),t.$set(c);const I={};B[1]&65536&&(I.$$scope={dirty:B,ctx:g}),s.$set(I);let a=f;f=w(g),f===a?v[f].p(g,B):(ne(),C(v[a],1,1,()=>{v[a]=null}),ie(),o=v[f],o?o.p(g,B):(o=v[f]=L[f](g),o.c()),k(o,1),o.m(p.parentNode,p))},i(g){_||(k(e.$$.fragment,g),k(t.$$.fragment,g),k(s.$$.fragment,g),k(o),_=!0)},o(g){C(e.$$.fragment,g),C(t.$$.fragment,g),C(s.$$.fragment,g),C(o),_=!1},d(g){g&&($(l),$(i),$(r),$(p)),G(e,g),G(t,g),G(s,g),v[f].d(g)}}}function Ft(n){let e,l,t,i,s="Critical Issue Log",r,f,o,p,_="Policy Conflict Log",L,v;e=new Ct({props:{label:"Tools",open:!0,$$slots:{default:[Yt]},$$scope:{ctx:n}}});let w=oe(n[3].criticalIssues),g=[];for(let a=0;a<w.length;a+=1)g[a]=Ge(Te(n,w,a));const B=a=>C(g[a],1,1,()=>{g[a]=null});let N=oe(n[3].policyConflictLog),c=[];for(let a=0;a<N.length;a+=1)c[a]=Fe(qe(n,N,a));const I=a=>C(c[a],1,1,()=>{c[a]=null});return{c(){q(e.$$.fragment),l=M(),t=F("div"),i=F("h3"),i.textContent=s,r=M();for(let a=0;a<g.length;a+=1)g[a].c();f=M(),o=F("div"),p=F("h3"),p.textContent=_,L=M();for(let a=0;a<c.length;a+=1)c[a].c();this.h()},l(a){T(e.$$.fragment,a),l=R(a),t=U(a,"DIV",{style:!0});var m=j(t);i=U(m,"H3",{"data-svelte-h":!0}),de(i)!=="svelte-e9mkko"&&(i.textContent=s),r=R(m);for(let b=0;b<g.length;b+=1)g[b].l(m);m.forEach($),f=R(a),o=U(a,"DIV",{style:!0});var S=j(o);p=U(S,"H3",{"data-svelte-h":!0}),de(p)!=="svelte-y008oc"&&(p.textContent=_),L=R(S);for(let b=0;b<c.length;b+=1)c[b].l(S);S.forEach($),this.h()},h(){O(t,"background-color","grey"),O(t,"padding","4px"),O(o,"background-color",Se),O(o,"padding","4px")},m(a,m){V(e,a,m),h(a,l,m),h(a,t,m),D(t,i),D(t,r);for(let S=0;S<g.length;S+=1)g[S]&&g[S].m(t,null);h(a,f,m),h(a,o,m),D(o,p),D(o,L);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(o,null);v=!0},p(a,m){const S={};if(m[0]&97|m[1]&65536&&(S.$$scope={dirty:m,ctx:a}),e.$set(S),m[0]&33292){w=oe(a[3].criticalIssues);let b;for(b=0;b<w.length;b+=1){const X=Te(a,w,b);g[b]?(g[b].p(X,m),k(g[b],1)):(g[b]=Ge(X),g[b].c(),k(g[b],1),g[b].m(t,null))}for(ne(),b=w.length;b<g.length;b+=1)B(b);ie()}if(m[0]&66060){N=oe(a[3].policyConflictLog);let b;for(b=0;b<N.length;b+=1){const X=qe(a,N,b);c[b]?(c[b].p(X,m),k(c[b],1)):(c[b]=Fe(X),c[b].c(),k(c[b],1),c[b].m(o,null))}for(ne(),b=N.length;b<c.length;b+=1)I(b);ie()}},i(a){if(!v){k(e.$$.fragment,a);for(let m=0;m<w.length;m+=1)k(g[m]);for(let m=0;m<N.length;m+=1)k(c[m]);v=!0}},o(a){C(e.$$.fragment,a),g=g.filter(Boolean);for(let m=0;m<g.length;m+=1)C(g[m]);c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)C(c[m]);v=!1},d(a){a&&($(l),$(t),$(f),$(o)),G(e,a),ve(g,a),ve(c,a)}}}function Ut(n){let e;return{c(){e=J("Save")},l(l){e=W(l,"Save")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Ot(n){let e;return{c(){e=J("Delete")},l(l){e=W(l,"Delete")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Ht(n){let e;return{c(){e=J("Copy")},l(l){e=W(l,"Copy")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Jt(n){let e,l;return e=new Vt({props:{idx:n[1].id.idx}}),{c(){q(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,i){V(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Wt(n){let e,l;return e=new Rt({props:{idx:n[1].id.idx}}),{c(){q(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,i){V(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Zt(n){let e;return{c(){e=J("Zoom to fit")},l(l){e=W(l,"Zoom to fit")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Kt(n){let e;return{c(){e=J("Show route")},l(l){e=W(l,"Show route")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function Yt(n){let e,l,t,i,s,r,f,o,p,_,L,v;e=new xe({props:{$$slots:{default:[Zt]},$$scope:{ctx:n}}}),e.$on("click",n[18]),t=new kt({}),s=new Lt({});function w(c){n[19](c)}let g={map:n[0]};n[5]!==void 0&&(g.enabled=n[5]),f=new Nt({props:g}),K.push(()=>z(f,"enabled",w));function B(c){n[20](c)}let N={$$slots:{default:[Kt]},$$scope:{ctx:n}};return n[6]!==void 0&&(N.checked=n[6]),_=new wt({props:N}),K.push(()=>z(_,"checked",B)),{c(){q(e.$$.fragment),l=M(),q(t.$$.fragment),i=M(),q(s.$$.fragment),r=M(),q(f.$$.fragment),p=M(),q(_.$$.fragment)},l(c){T(e.$$.fragment,c),l=R(c),T(t.$$.fragment,c),i=R(c),T(s.$$.fragment,c),r=R(c),T(f.$$.fragment,c),p=R(c),T(_.$$.fragment,c)},m(c,I){V(e,c,I),h(c,l,I),V(t,c,I),h(c,i,I),V(s,c,I),h(c,r,I),V(f,c,I),h(c,p,I),V(_,c,I),v=!0},p(c,I){const a={};I[1]&65536&&(a.$$scope={dirty:I,ctx:c}),e.$set(a);const m={};I[0]&1&&(m.map=c[0]),!o&&I[0]&32&&(o=!0,m.enabled=c[5],Y(()=>o=!1)),f.$set(m);const S={};I[1]&65536&&(S.$$scope={dirty:I,ctx:c}),!L&&I[0]&64&&(L=!0,S.checked=c[6],Y(()=>L=!1)),_.$set(S)},i(c){v||(k(e.$$.fragment,c),k(t.$$.fragment,c),k(s.$$.fragment,c),k(f.$$.fragment,c),k(_.$$.fragment,c),v=!0)},o(c){C(e.$$.fragment,c),C(t.$$.fragment,c),C(s.$$.fragment,c),C(f.$$.fragment,c),C(_.$$.fragment,c),v=!1},d(c){c&&($(l),$(i),$(r),$(p)),G(e,c),G(t,c),G(s,c),G(f,c),G(_,c)}}}function Ve(n){let e;function l(s,r){return s[43].resolved=="No"?Xt:zt}let t=l(n),i=t(n);return{c(){i.c(),e=ee()},l(s){i.l(s),e=ee()},m(s,r){i.m(s,r),h(s,e,r)},p(s,r){t===(t=l(s))&&i?i.p(s,r):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&$(e),i.d(s)}}}function zt(n){let e,l,t=n[43].resolved+"",i;return{c(){e=F("span"),l=J("Resolved: "),i=J(t)},l(s){e=U(s,"SPAN",{});var r=j(e);l=W(r,"Resolved: "),i=W(r,t),r.forEach($)},m(s,r){h(s,e,r),D(e,l),D(e,i)},p(s,r){r[0]&8&&t!==(t=s[43].resolved+"")&&re(i,t)},d(s){s&&$(e)}}}function Xt(n){let e,l,t,i=n[43].resolved+"",s;return{c(){e=F("span"),l=F("b"),t=J("Resolved: "),s=J(i)},l(r){e=U(r,"SPAN",{});var f=j(e);l=U(f,"B",{});var o=j(l);t=W(o,"Resolved: "),s=W(o,i),o.forEach($),f.forEach($)},m(r,f){h(r,e,f),D(e,l),D(l,t),D(l,s)},p(r,f){f[0]&8&&i!==(i=r[43].resolved+"")&&re(s,i)},d(r){r&&$(e)}}}function Qt(n){let e,l,t,i=n[43].stage+"",s,r,f,o=n[43].stage!="Design"&&Ve(n);return{c(){e=F("div"),l=F("span"),t=J("Stage: "),s=J(i),r=M(),o&&o.c(),f=M(),this.h()},l(p){e=U(p,"DIV",{style:!0});var _=j(e);l=U(_,"SPAN",{});var L=j(l);t=W(L,"Stage: "),s=W(L,i),L.forEach($),r=R(_),o&&o.l(_),_.forEach($),f=R(p),this.h()},h(){O(e,"width","100%"),O(e,"display","flex"),O(e,"justify-content","space-between")},m(p,_){h(p,e,_),D(e,l),D(l,t),D(l,s),D(e,r),o&&o.m(e,null),h(p,f,_)},p(p,_){_[0]&8&&i!==(i=p[43].stage+"")&&re(s,i),p[43].stage!="Design"?o?o.p(p,_):(o=Ve(p),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(p){p&&($(e),$(f)),o&&o.d()}}}function Ge(n){let e,l;function t(){return n[21](n[42])}function i(){return n[22](n[42])}return e=new et({props:{name:n[15](n[43]),$$slots:{default:[Qt]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[23]),{c(){q(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,r){V(e,s,r),l=!0},p(s,r){n=s;const f={};r[0]&8&&(f.name=n[15](n[43])),r[0]&8|r[1]&65536&&(f.$$scope={dirty:r,ctx:n}),e.$set(f)},i(s){l||(k(e.$$.fragment,s),l=!0)},o(s){C(e.$$.fragment,s),l=!1},d(s){G(e,s)}}}function je(n){let e;function l(s,r){return s[40].resolved=="No"?el:xt}let t=l(n),i=t(n);return{c(){i.c(),e=ee()},l(s){i.l(s),e=ee()},m(s,r){i.m(s,r),h(s,e,r)},p(s,r){t===(t=l(s))&&i?i.p(s,r):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&$(e),i.d(s)}}}function xt(n){let e,l,t=n[40].resolved+"",i;return{c(){e=F("span"),l=J("Resolved: "),i=J(t)},l(s){e=U(s,"SPAN",{});var r=j(e);l=W(r,"Resolved: "),i=W(r,t),r.forEach($)},m(s,r){h(s,e,r),D(e,l),D(e,i)},p(s,r){r[0]&8&&t!==(t=s[40].resolved+"")&&re(i,t)},d(s){s&&$(e)}}}function el(n){let e,l,t,i=n[40].resolved+"",s;return{c(){e=F("span"),l=F("b"),t=J("Resolved: "),s=J(i)},l(r){e=U(r,"SPAN",{});var f=j(e);l=U(f,"B",{});var o=j(l);t=W(o,"Resolved: "),s=W(o,i),o.forEach($),f.forEach($)},m(r,f){h(r,e,f),D(e,l),D(l,t),D(l,s)},p(r,f){f[0]&8&&i!==(i=r[40].resolved+"")&&re(s,i)},d(r){r&&$(e)}}}function tl(n){let e,l,t,i=n[40].stage+"",s,r,f,o=n[40].stage!="Design"&&je(n);return{c(){e=F("div"),l=F("span"),t=J("Stage: "),s=J(i),r=M(),o&&o.c(),f=M(),this.h()},l(p){e=U(p,"DIV",{style:!0});var _=j(e);l=U(_,"SPAN",{});var L=j(l);t=W(L,"Stage: "),s=W(L,i),L.forEach($),r=R(_),o&&o.l(_),_.forEach($),f=R(p),this.h()},h(){O(e,"width","100%"),O(e,"display","flex"),O(e,"justify-content","space-between")},m(p,_){h(p,e,_),D(e,l),D(l,t),D(l,s),D(e,r),o&&o.m(e,null),h(p,f,_)},p(p,_){_[0]&8&&i!==(i=p[40].stage+"")&&re(s,i),p[40].stage!="Design"?o?o.p(p,_):(o=je(p),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(p){p&&($(e),$(f)),o&&o.d()}}}function Fe(n){let e,l;function t(){return n[24](n[42])}function i(){return n[25](n[42])}return e=new et({props:{name:n[16](n[40]),$$slots:{default:[tl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[26]),{c(){q(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,r){V(e,s,r),l=!0},p(s,r){n=s;const f={};r[0]&8&&(f.name=n[16](n[40])),r[0]&8|r[1]&65536&&(f.$$scope={dirty:r,ctx:n}),e.$set(f)},i(s){l||(k(e.$$.fragment,s),l=!0)},o(s){C(e.$$.fragment,s),l=!1},d(s){G(e,s)}}}function Ue(n){let e,l,t,i,s,r,f;return l=new ye({props:{$$slots:{default:[il]},$$scope:{ctx:n}}}),l.$on("click",n[11]),i=new ye({props:{$$slots:{default:[sl]},$$scope:{ctx:n}}}),i.$on("click",n[28]),r=new ye({props:{$$slots:{default:[cl]},$$scope:{ctx:n}}}),r.$on("click",n[29]),{c(){e=F("div"),q(l.$$.fragment),t=M(),q(i.$$.fragment),s=M(),q(r.$$.fragment),this.h()},l(o){e=U(o,"DIV",{class:!0});var p=j(e);T(l.$$.fragment,p),t=R(p),T(i.$$.fragment,p),s=R(p),T(r.$$.fragment,p),p.forEach($),this.h()},h(){P(e,"class","control-panel svelte-bs7c5y")},m(o,p){h(o,e,p),V(l,e,null),D(e,t),V(i,e,null),D(e,s),V(r,e,null),f=!0},p(o,p){const _={};p[0]&2|p[1]&65536&&(_.$$scope={dirty:p,ctx:o}),l.$set(_);const L={};p[0]&2|p[1]&65536&&(L.$$scope={dirty:p,ctx:o}),i.$set(L);const v={};p[0]&2|p[1]&65536&&(v.$$scope={dirty:p,ctx:o}),r.$set(v)},i(o){f||(k(l.$$.fragment,o),k(i.$$.fragment,o),k(r.$$.fragment,o),f=!0)},o(o){C(l.$$.fragment,o),C(i.$$.fragment,o),C(r.$$.fragment,o),f=!1},d(o){o&&$(e),G(l),G(i),G(r)}}}function ll(n){let e;return{c(){e=J("Move map")},l(l){e=W(l,"Move map")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function nl(n){let e,l="Move map";return{c(){e=F("u"),e.textContent=l},l(t){e=U(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-1719ytd"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function il(n){let e,l,t,i;function s(o,p){return o[1].mode=="select"?nl:ll}let r=s(n),f=r(n);return{c(){e=F("img"),t=M(),f.c(),i=ee(),this.h()},l(o){e=U(o,"IMG",{src:!0,alt:!0,style:!0}),t=R(o),f.l(o),i=ee(),this.h()},h(){ct(e.src,l=Dt)||P(e,"src",l),P(e,"alt","Move map"),O(e,"vertical-align","middle")},m(o,p){h(o,e,p),h(o,t,p),f.m(o,p),h(o,i,p)},p(o,p){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function ol(n){let e;return{c(){e=J("New critical issue")},l(l){e=W(l,"New critical issue")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function rl(n){let e,l="New critical issue";return{c(){e=F("u"),e.textContent=l},l(t){e=U(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-1igjogw"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function sl(n){let e,l,t,i;function s(o,p){return o[1].mode=="new-critical"?rl:ol}let r=s(n),f=r(n);return{c(){e=pe("svg"),l=pe("rect"),t=M(),f.c(),i=ee(),this.h()},l(o){e=_e(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var p=j(e);l=_e(p,"rect",{width:!0,height:!0,fill:!0,class:!0}),j(l).forEach($),p.forEach($),t=R(o),f.l(o),i=ee(),this.h()},h(){P(l,"width","24"),P(l,"height","24"),P(l,"fill",Je.critical.background),P(l,"class","svelte-bs7c5y"),P(e,"width","24"),P(e,"height","24"),P(e,"xmlns","http://www.w3.org/2000/svg"),O(e,"vertical-align","middle")},m(o,p){h(o,e,p),D(e,l),h(o,t,p),f.m(o,p),h(o,i,p)},p(o,p){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function al(n){let e;return{c(){e=J("New policy conflict")},l(l){e=W(l,"New policy conflict")},m(l,t){h(l,e,t)},d(l){l&&$(e)}}}function fl(n){let e,l="New policy conflict";return{c(){e=F("u"),e.textContent=l},l(t){e=U(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-14o8e5o"&&(e.textContent=l)},m(t,i){h(t,e,i)},d(t){t&&$(e)}}}function cl(n){let e,l,t,i;function s(o,p){return o[1].mode=="new-conflict"?fl:al}let r=s(n),f=r(n);return{c(){e=pe("svg"),l=pe("circle"),t=M(),f.c(),i=ee(),this.h()},l(o){e=_e(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var p=j(e);l=_e(p,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),j(l).forEach($),p.forEach($),t=R(o),f.l(o),i=ee(),this.h()},h(){P(l,"cx","12"),P(l,"cy","12"),P(l,"r","12"),P(l,"fill",Se),P(e,"width","24"),P(e,"height","24"),P(e,"xmlns","http://www.w3.org/2000/svg"),O(e,"vertical-align","middle")},m(o,p){h(o,e,p),D(e,l),h(o,t,p),f.m(o,p),h(o,i,p)},p(o,p){r!==(r=s(o))&&(f.d(1),f=r(o),f&&(f.c(),f.m(i.parentNode,i)))},d(o){o&&($(e),$(t),$(i)),f.d(o)}}}function ul(n){let e,l,t,i=n[43].criticalIssue+"",s;return{c(){e=pe("svg"),l=pe("rect"),t=pe("text"),s=J(i),this.h()},l(r){e=_e(r,"svg",{width:!0,height:!0,xmlns:!0});var f=j(e);l=_e(f,"rect",{width:!0,height:!0,fill:!0,class:!0}),j(l).forEach($),t=_e(f,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var o=j(t);s=W(o,i),o.forEach($),f.forEach($),this.h()},h(){P(l,"width","40"),P(l,"height","40"),P(l,"fill",Je.critical.background),P(l,"class","svelte-bs7c5y"),P(t,"x","50%"),P(t,"y","50%"),P(t,"dominant-baseline","middle"),P(t,"text-anchor","middle"),O(t,"fill","white"),P(e,"width","40"),P(e,"height","40"),P(e,"xmlns","http://www.w3.org/2000/svg")},m(r,f){h(r,e,f),D(e,l),D(e,t),D(t,s)},p(r,f){f[0]&8&&i!==(i=r[43].criticalIssue+"")&&re(s,i)},d(r){r&&$(e)}}}function Oe(n){let e,l,t;function i(o){n[30](o,n[43])}function s(){return n[31](n[42])}function r(){return n[32](n[42])}let f={draggable:!0,$$slots:{default:[ul]},$$scope:{ctx:n}};return n[43].point!==void 0&&(f.lngLat=n[43].point),e=new Qe({props:f}),K.push(()=>z(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",r),{c(){q(e.$$.fragment)},l(o){T(e.$$.fragment,o)},m(o,p){V(e,o,p),t=!0},p(o,p){n=o;const _={};p[0]&8|p[1]&65536&&(_.$$scope={dirty:p,ctx:n}),!l&&p[0]&8&&(l=!0,_.lngLat=n[43].point,Y(()=>l=!1)),e.$set(_)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function pl(n){let e,l=n[40].conflict+"",t;return{c(){e=F("span"),t=J(l),this.h()},l(i){e=U(i,"SPAN",{class:!0});var s=j(e);t=W(s,l),s.forEach($),this.h()},h(){P(e,"class","dot svelte-bs7c5y"),O(e,"background",Se)},m(i,s){h(i,e,s),D(e,t)},p(i,s){s[0]&8&&l!==(l=i[40].conflict+"")&&re(t,l)},d(i){i&&$(e)}}}function He(n){let e,l,t;function i(o){n[33](o,n[40])}function s(){return n[34](n[42])}function r(){return n[35](n[42])}let f={draggable:!0,$$slots:{default:[pl]},$$scope:{ctx:n}};return n[40].point!==void 0&&(f.lngLat=n[40].point),e=new Qe({props:f}),K.push(()=>z(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",r),{c(){q(e.$$.fragment)},l(o){T(e.$$.fragment,o)},m(o,p){V(e,o,p),t=!0},p(o,p){n=o;const _={};p[0]&8|p[1]&65536&&(_.$$scope={dirty:p,ctx:n}),!l&&p[0]&8&&(l=!0,_.lngLat=n[40].point,Y(()=>l=!1)),e.$set(_)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){C(e.$$.fragment,o),t=!1},d(o){G(e,o)}}}function _l(n){let e,l;return e=new $t({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){q(e.$$.fragment)},l(t){T(e.$$.fragment,t)},m(t,i){V(e,t,i),l=!0},p:ut,i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function ml(n){let e,l,t,i,s,r,f,o,p,_,L;e=new St({}),e.$on("click",n[12]);let v=n[1].mode!="editing"&&Ue(n);i=new Bt({props:{show:n[6]}});let w=oe(n[3].criticalIssues),g=[];for(let a=0;a<w.length;a+=1)g[a]=Oe(Re(n,w,a));const B=a=>C(g[a],1,1,()=>{g[a]=null});let N=oe(n[3].policyConflictLog),c=[];for(let a=0;a<N.length;a+=1)c[a]=He(Me(n,N,a));const I=a=>C(c[a],1,1,()=>{c[a]=null});return o=new gt({props:{data:n[7],$$slots:{default:[_l]},$$scope:{ctx:n}}}),_=new Et({props:{map:n[0]}}),{c(){q(e.$$.fragment),l=M(),v&&v.c(),t=M(),q(i.$$.fragment),s=M();for(let a=0;a<g.length;a+=1)g[a].c();r=M();for(let a=0;a<c.length;a+=1)c[a].c();f=M(),q(o.$$.fragment),p=M(),q(_.$$.fragment)},l(a){T(e.$$.fragment,a),l=R(a),v&&v.l(a),t=R(a),T(i.$$.fragment,a),s=R(a);for(let m=0;m<g.length;m+=1)g[m].l(a);r=R(a);for(let m=0;m<c.length;m+=1)c[m].l(a);f=R(a),T(o.$$.fragment,a),p=R(a),T(_.$$.fragment,a)},m(a,m){V(e,a,m),h(a,l,m),v&&v.m(a,m),h(a,t,m),V(i,a,m),h(a,s,m);for(let S=0;S<g.length;S+=1)g[S]&&g[S].m(a,m);h(a,r,m);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(a,m);h(a,f,m),V(o,a,m),h(a,p,m),V(_,a,m),L=!0},p(a,m){a[1].mode!="editing"?v?(v.p(a,m),m[0]&2&&k(v,1)):(v=Ue(a),v.c(),k(v,1),v.m(t.parentNode,t)):v&&(ne(),C(v,1,1,()=>{v=null}),ie());const S={};if(m[0]&64&&(S.show=a[6]),i.$set(S),m[0]&264){w=oe(a[3].criticalIssues);let A;for(A=0;A<w.length;A+=1){const te=Re(a,w,A);g[A]?(g[A].p(te,m),k(g[A],1)):(g[A]=Oe(te),g[A].c(),k(g[A],1),g[A].m(r.parentNode,r))}for(ne(),A=w.length;A<g.length;A+=1)B(A);ie()}if(m[0]&264){N=oe(a[3].policyConflictLog);let A;for(A=0;A<N.length;A+=1){const te=Me(a,N,A);c[A]?(c[A].p(te,m),k(c[A],1)):(c[A]=He(te),c[A].c(),k(c[A],1),c[A].m(f.parentNode,f))}for(ne(),A=N.length;A<c.length;A+=1)I(A);ie()}const b={};m[0]&128&&(b.data=a[7]),m[1]&65536&&(b.$$scope={dirty:m,ctx:a}),o.$set(b);const X={};m[0]&1&&(X.map=a[0]),_.$set(X)},i(a){if(!L){k(e.$$.fragment,a),k(v),k(i.$$.fragment,a);for(let m=0;m<w.length;m+=1)k(g[m]);for(let m=0;m<N.length;m+=1)k(c[m]);k(o.$$.fragment,a),k(_.$$.fragment,a),L=!0}},o(a){C(e.$$.fragment,a),C(v),C(i.$$.fragment,a),g=g.filter(Boolean);for(let m=0;m<g.length;m+=1)C(g[m]);c=c.filter(Boolean);for(let m=0;m<c.length;m+=1)C(c[m]);C(o.$$.fragment,a),C(_.$$.fragment,a),L=!1},d(a){a&&($(l),$(t),$(s),$(r),$(f),$(p)),G(e,a),v&&v.d(a),G(i,a),ve(g,a),ve(c,a),G(o,a),G(_,a)}}}function gl(n){let e,l,t,i,s,r,f,o,p,_,L;const v=[Ft,jt],w=[];function g(c,I){return c[1].mode!="editing"?0:1}t=g(n),i=w[t]=v[t](n);function B(c){n[36](c)}let N={$$slots:{default:[ml]},$$scope:{ctx:n}};return n[0]!==void 0&&(N.map=n[0]),f=new _t({props:N}),K.push(()=>z(f,"map",B)),{c(){e=F("div"),l=F("div"),i.c(),s=M(),r=F("div"),q(f.$$.fragment),this.h()},l(c){e=U(c,"DIV",{style:!0});var I=j(e);l=U(I,"DIV",{style:!0});var a=j(l);i.l(a),a.forEach($),s=R(I),r=U(I,"DIV",{style:!0});var m=j(r);T(f.$$.fragment,m),m.forEach($),I.forEach($),this.h()},h(){O(l,"width","30%"),O(l,"overflow-y","scroll"),O(l,"padding","10px"),O(l,"border","1px solid black"),O(r,"position","relative"),O(r,"width","70%"),O(e,"display","flex"),O(e,"height","80vh")},m(c,I){h(c,e,I),D(e,l),w[t].m(l,null),n[27](l),D(e,s),D(e,r),V(f,r,null),p=!0,_||(L=at(Gt,"keydown",n[17]),_=!0)},p(c,I){let a=t;t=g(c),t===a?w[t].p(c,I):(ne(),C(w[a],1,1,()=>{w[a]=null}),ie(),i=w[t],i?i.p(c,I):(i=w[t]=v[t](c),i.c()),k(i,1),i.m(l,null));const m={};I[0]&203|I[1]&65536&&(m.$$scope={dirty:I,ctx:c}),!o&&I[0]&1&&(o=!0,m.map=c[0],Y(()=>o=!1)),f.$set(m)},i(c){p||(k(i),k(f.$$.fragment,c),p=!0)},o(c){C(i),C(f.$$.fragment,c),p=!1},d(c){c&&$(e),w[t].d(),n[27](null),G(f),_=!1,L()}}}function $l(n,e,l){let t={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:l;if(i!=null){let s=i.kind=="critical"?n.criticalIssues:n.policyConflictLog;t.features.push(Ce(s[i.idx].point))}return t}function Ce(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function dl(n,e,l){let t,i,s;he(n,Z,d=>l(3,i=d)),he(n,Pt,d=>l(38,s=d));let r,f,o={mode:"select"},p=s.url.searchParams.get("kind")||"";p=="critical"?o={mode:"new-critical"}:p=="conflict"&&(o={mode:"new-conflict"});let _=null,L=null,v=!1,w=!0;async function g(d){_=f.scrollTop,l(1,o={mode:"editing",id:d}),l(2,L=null),await we(),l(4,f.scrollTop=0,f)}async function B(d){_=f.scrollTop,l(1,o={mode:"editing",id:d}),l(2,L=null),await we(),l(4,f.scrollTop=0,f);let H=d.kind=="critical"?i.criticalIssues:i.policyConflictLog;r.flyTo({center:H[d.idx].point,duration:500})}async function N(){if(o.mode!="editing")return;let d=o.id,H=d.kind=="critical"?i.criticalIssues:i.policyConflictLog,le=JSON.parse(JSON.stringify(H[d.idx])),rt=r.getBounds().getWest(),st=r.getBounds().getEast();le.point[0]+=(st-rt)*.05;let Ee=H.toSpliced(d.idx+1,0,le);d.kind=="critical"?me(Z,i.criticalIssues=Ee,i):me(Z,i.policyConflictLog=Ee,i),await g({kind:d.kind,idx:d.idx+1})}async function c(){l(1,o={mode:"select"}),me(Z,i.policyConflictLog=i.policyConflictLog.toSorted((d,H)=>De(d.conflict)-De(H.conflict)),i),me(Z,i.criticalIssues=i.criticalIssues.toSorted((d,H)=>Pe(d.criticalIssue)-Pe(H.criticalIssue)),i),_!=null&&(await we(),l(4,f.scrollTop=_,f),_=null)}function I(d){if(!v&&o.mode!="select"){if(o.mode=="editing"){c();return}o.mode=="new-critical"?(me(Z,i.criticalIssues=[...i.criticalIssues,{criticalIssue:s.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),g({kind:"critical",idx:i.criticalIssues.length-1})):o.mode=="new-conflict"&&(me(Z,i.policyConflictLog=[...i.policyConflictLog,{conflict:s.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),g({kind:"conflict",idx:i.policyConflictLog.length-1}))}}ft(()=>{m(!1)});function a(){o.mode=="editing"&&window.confirm("Delete this entry?")&&(o.id.kind=="critical"?(i.criticalIssues.splice(o.id.idx,1),Z.set(i)):(i.policyConflictLog.splice(o.id.idx,1),Z.set(i)),c())}function m(d){let H={type:"FeatureCollection",features:[...i.criticalIssues.map(le=>Ce(le.point)),...i.policyConflictLog.map(le=>Ce(le.point)),...i.summary.networkMap.features]};H.features.length>0&&r.fitBounds(mt(H),{padding:20,animate:d})}function S(d){let H=d.criticalIssue?vt(d.criticalIssue):"Unknown critical";return d.locationName?`${H} (${d.locationName})`:H}function b(d){let H=d.conflict?"P00"+bt(d.conflict):"Unknown conflict";return d.locationName?`${H} (${d.locationName})`:H}function X(d){if(o.mode=="editing"){let H=d.target.tagName,le=H=="INPUT"||H=="TEXTAREA";d.key=="Escape"||d.key=="Enter"&&!le?(d.stopPropagation(),c()):d.key=="Delete"&&!le&&(d.stopPropagation(),a())}else(o.mode=="new-critical"||o.mode=="new-conflict")&&d.key=="Escape"&&(d.stopPropagation(),l(1,o={mode:"select"}))}const A=()=>m(!0);function te(d){v=d,l(5,v)}function se(d){w=d,l(6,w)}const ge=d=>B({kind:"critical",idx:d}),ae=d=>l(2,L={kind:"critical",idx:d}),E=()=>l(2,L=null),$e=d=>B({kind:"conflict",idx:d}),fe=d=>l(2,L={kind:"conflict",idx:d}),u=()=>l(2,L=null);function y(d){K[d?"unshift":"push"](()=>{f=d,l(4,f)})}const Q=()=>l(1,o={mode:"new-critical"}),x=()=>l(1,o={mode:"new-conflict"});function ce(d,H){n.$$.not_equal(H.point,d)&&(H.point=d,Z.set(i))}const ue=d=>g({kind:"critical",idx:d}),tt=d=>g({kind:"critical",idx:d});function lt(d,H){n.$$.not_equal(H.point,d)&&(H.point=d,Z.set(i))}const nt=d=>g({kind:"conflict",idx:d}),it=d=>g({kind:"conflict",idx:d});function ot(d){r=d,l(0,r)}return n.$$.update=()=>{n.$$.dirty[0]&3&&r&&(r.getCanvas().style.cursor=o.mode=="new-critical"||o.mode=="new-conflict"?"crosshair":"auto"),n.$$.dirty[0]&14&&l(7,t=$l(i,o,L))},[r,o,L,i,f,v,w,t,g,B,N,c,I,a,m,S,b,X,A,te,se,ge,ae,E,$e,fe,u,y,Q,x,ce,ue,tt,lt,nt,it,ot]}class Hl extends Le{constructor(e){super(),Ne(this,e,dl,gl,Ie,{},null,[-1,-1])}}export{Hl as component};
