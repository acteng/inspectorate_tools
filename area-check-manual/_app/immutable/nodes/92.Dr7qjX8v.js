import{s as Ce,v as J,e as W,t as te,a as j,c as Y,b as Z,d as ne,f as d,g as q,o as U,x,i as I,h as z,w as X,k as we,z as ze,U as He,S as Se,A as Ne,m as he,r as _e,j as de,n as Ke,O as ve,P as be}from"../chunks/scheduler.D-C6hALy.js";import{S as ye,i as Ie,e as Q,c as B,b as M,m as A,t as w,a as L,d as G,f as re,g as ae}from"../chunks/index.D5SgZvb2.js";import{s as $e,d as me,M as We,f as Ye,b as Ze,C as Je,G as Xe,h as Qe}from"../chunks/index.Bc607yKz.js";import{e as se}from"../chunks/each.zNSH8vzl.js";import{c as xe,p as et}from"../chunks/colors.CYEpEtTL.js";import{p as Oe}from"../chunks/index.DNc5DZtm.js";import{S as ge}from"../chunks/Select.CYmKMEHN.js";import{T as Fe}from"../chunks/TextArea.DbZHb9Cv.js";import{T as Te}from"../chunks/TextInput.BwY6-qfm.js";import{s as R}from"../chunks/data.BYd9uJlD.js";import{c as tt,p as nt}from"../chunks/lists.BnA5ucEg.js";import{Y as Ue}from"../chunks/YesNo.Bgaf0jAr.js";import{R as lt,B as it,G as ot,S as st,C as rt,a as at,M as Re}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.DrzB3TNo.js";import{D as ft,C as ut}from"../chunks/DefaultButton.c7oQMUIo.js";import{W as ct,S as Le}from"../chunks/WarningButton.Ci3TmyVa.js";import{G as pt}from"../chunks/GeoreferenceLayer.B_iwLAKk.js";function _t(t){let e,l,n,s,_,p,r,u,g,a,S,c,h,D,y,N,i,f,C,V,O,$,K,F;function P(o){t[2](o)}let oe={label:"Critical Issue",emptyOption:!0,choices:tt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(oe.value=t[1].criticalIssues[t[0]].criticalIssue),a=new ge({props:oe}),J.push(()=>Q(a,"value",P));function m(o){t[3](o)}let k={label:"Stage",emptyOption:!0,choices:Oe(["Existing","Design"])};t[1].criticalIssues[t[0]].stage!==void 0&&(k.value=t[1].criticalIssues[t[0]].stage),h=new ge({props:k}),J.push(()=>Q(h,"value",m));function T(o){t[4](o)}let H={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(H.value=t[1].criticalIssues[t[0]].locationName),N=new Te({props:H}),J.push(()=>Q(N,"value",T));function E(o){t[5](o)}let ee={label:"Resolved by Design"};t[1].criticalIssues[t[0]].resolved!==void 0&&(ee.value=t[1].criticalIssues[t[0]].resolved),C=new Ue({props:ee}),J.push(()=>Q(C,"value",E));function fe(o){t[6](o)}let b={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(b.value=t[1].criticalIssues[t[0]].notes),$=new Fe({props:b}),J.push(()=>Q($,"value",fe)),{c(){e=W("div"),l=W("a"),n=te("Google StreetView"),_=j(),p=W("a"),r=te("Bing Streetside"),g=j(),B(a.$$.fragment),c=j(),B(h.$$.fragment),y=j(),B(N.$$.fragment),f=j(),B(C.$$.fragment),O=j(),B($.$$.fragment),this.h()},l(o){e=Y(o,"DIV",{style:!0});var v=Z(e);l=Y(v,"A",{href:!0,target:!0});var le=Z(l);n=ne(le,"Google StreetView"),le.forEach(d),_=q(v),p=Y(v,"A",{href:!0,target:!0});var ie=Z(p);r=ne(ie,"Bing Streetside"),ie.forEach(d),v.forEach(d),g=q(o),M(a.$$.fragment,o),c=q(o),M(h.$$.fragment,o),y=q(o),M(N.$$.fragment,o),f=q(o),M(C.$$.fragment,o),O=q(o),M($.$$.fragment,o),this.h()},h(){U(l,"href",s=$e(t[1].criticalIssues[t[0]].point)),U(l,"target","_blank"),U(p,"href",u=me(t[1].criticalIssues[t[0]].point)),U(p,"target","_blank"),x(e,"display","flex"),x(e,"justify-content","space-evenly")},m(o,v){I(o,e,v),z(e,l),z(l,n),z(e,_),z(e,p),z(p,r),I(o,g,v),A(a,o,v),I(o,c,v),A(h,o,v),I(o,y,v),A(N,o,v),I(o,f,v),A(C,o,v),I(o,O,v),A($,o,v),F=!0},p(o,[v]){(!F||v&3&&s!==(s=$e(o[1].criticalIssues[o[0]].point)))&&U(l,"href",s),(!F||v&3&&u!==(u=me(o[1].criticalIssues[o[0]].point)))&&U(p,"href",u);const le={};!S&&v&3&&(S=!0,le.value=o[1].criticalIssues[o[0]].criticalIssue,X(()=>S=!1)),a.$set(le);const ie={};!D&&v&3&&(D=!0,ie.value=o[1].criticalIssues[o[0]].stage,X(()=>D=!1)),h.$set(ie);const ue={};!i&&v&3&&(i=!0,ue.value=o[1].criticalIssues[o[0]].locationName,X(()=>i=!1)),N.$set(ue);const ce={};!V&&v&3&&(V=!0,ce.value=o[1].criticalIssues[o[0]].resolved,X(()=>V=!1)),C.$set(ce);const pe={};!K&&v&3&&(K=!0,pe.value=o[1].criticalIssues[o[0]].notes,X(()=>K=!1)),$.$set(pe)},i(o){F||(w(a.$$.fragment,o),w(h.$$.fragment,o),w(N.$$.fragment,o),w(C.$$.fragment,o),w($.$$.fragment,o),F=!0)},o(o){L(a.$$.fragment,o),L(h.$$.fragment,o),L(N.$$.fragment,o),L(C.$$.fragment,o),L($.$$.fragment,o),F=!1},d(o){o&&(d(e),d(g),d(c),d(y),d(f),d(O)),G(a,o),G(h,o),G(N,o),G(C,o),G($,o)}}}function $t(t,e,l){let n;we(t,R,a=>l(1,n=a));let{idx:s}=e;function _(a){t.$$.not_equal(n.criticalIssues[s].criticalIssue,a)&&(n.criticalIssues[s].criticalIssue=a,R.set(n))}function p(a){t.$$.not_equal(n.criticalIssues[s].stage,a)&&(n.criticalIssues[s].stage=a,R.set(n))}function r(a){t.$$.not_equal(n.criticalIssues[s].locationName,a)&&(n.criticalIssues[s].locationName=a,R.set(n))}function u(a){t.$$.not_equal(n.criticalIssues[s].resolved,a)&&(n.criticalIssues[s].resolved=a,R.set(n))}function g(a){t.$$.not_equal(n.criticalIssues[s].notes,a)&&(n.criticalIssues[s].notes=a,R.set(n))}return t.$$set=a=>{"idx"in a&&l(0,s=a.idx)},[s,n,_,p,r,u,g]}class mt extends ye{constructor(e){super(),Ie(this,e,$t,_t,Ce,{idx:0})}}function gt(t){let e,l,n,s,_,p,r,u,g,a,S,c,h,D,y,N,i,f,C,V,O,$,K,F;function P(o){t[2](o)}let oe={label:"Policy Conflict",emptyOption:!0,choices:nt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(oe.value=t[1].policyConflictLog[t[0]].conflict),a=new ge({props:oe}),J.push(()=>Q(a,"value",P));function m(o){t[3](o)}let k={label:"Stage",emptyOption:!0,choices:Oe(["Existing","Design"])};t[1].policyConflictLog[t[0]].stage!==void 0&&(k.value=t[1].policyConflictLog[t[0]].stage),h=new ge({props:k}),J.push(()=>Q(h,"value",m));function T(o){t[4](o)}let H={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(H.value=t[1].policyConflictLog[t[0]].locationName),N=new Te({props:H}),J.push(()=>Q(N,"value",T));function E(o){t[5](o)}let ee={label:"Resolved by Design"};t[1].policyConflictLog[t[0]].resolved!==void 0&&(ee.value=t[1].policyConflictLog[t[0]].resolved),C=new Ue({props:ee}),J.push(()=>Q(C,"value",E));function fe(o){t[6](o)}let b={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(b.value=t[1].policyConflictLog[t[0]].notes),$=new Fe({props:b}),J.push(()=>Q($,"value",fe)),{c(){e=W("div"),l=W("a"),n=te("Google StreetView"),_=j(),p=W("a"),r=te("Bing Streetside"),g=j(),B(a.$$.fragment),c=j(),B(h.$$.fragment),y=j(),B(N.$$.fragment),f=j(),B(C.$$.fragment),O=j(),B($.$$.fragment),this.h()},l(o){e=Y(o,"DIV",{style:!0});var v=Z(e);l=Y(v,"A",{href:!0,target:!0});var le=Z(l);n=ne(le,"Google StreetView"),le.forEach(d),_=q(v),p=Y(v,"A",{href:!0,target:!0});var ie=Z(p);r=ne(ie,"Bing Streetside"),ie.forEach(d),v.forEach(d),g=q(o),M(a.$$.fragment,o),c=q(o),M(h.$$.fragment,o),y=q(o),M(N.$$.fragment,o),f=q(o),M(C.$$.fragment,o),O=q(o),M($.$$.fragment,o),this.h()},h(){U(l,"href",s=$e(t[1].policyConflictLog[t[0]].point)),U(l,"target","_blank"),U(p,"href",u=me(t[1].policyConflictLog[t[0]].point)),U(p,"target","_blank"),x(e,"display","flex"),x(e,"justify-content","space-evenly")},m(o,v){I(o,e,v),z(e,l),z(l,n),z(e,_),z(e,p),z(p,r),I(o,g,v),A(a,o,v),I(o,c,v),A(h,o,v),I(o,y,v),A(N,o,v),I(o,f,v),A(C,o,v),I(o,O,v),A($,o,v),F=!0},p(o,[v]){(!F||v&3&&s!==(s=$e(o[1].policyConflictLog[o[0]].point)))&&U(l,"href",s),(!F||v&3&&u!==(u=me(o[1].policyConflictLog[o[0]].point)))&&U(p,"href",u);const le={};!S&&v&3&&(S=!0,le.value=o[1].policyConflictLog[o[0]].conflict,X(()=>S=!1)),a.$set(le);const ie={};!D&&v&3&&(D=!0,ie.value=o[1].policyConflictLog[o[0]].stage,X(()=>D=!1)),h.$set(ie);const ue={};!i&&v&3&&(i=!0,ue.value=o[1].policyConflictLog[o[0]].locationName,X(()=>i=!1)),N.$set(ue);const ce={};!V&&v&3&&(V=!0,ce.value=o[1].policyConflictLog[o[0]].resolved,X(()=>V=!1)),C.$set(ce);const pe={};!K&&v&3&&(K=!0,pe.value=o[1].policyConflictLog[o[0]].notes,X(()=>K=!1)),$.$set(pe)},i(o){F||(w(a.$$.fragment,o),w(h.$$.fragment,o),w(N.$$.fragment,o),w(C.$$.fragment,o),w($.$$.fragment,o),F=!0)},o(o){L(a.$$.fragment,o),L(h.$$.fragment,o),L(N.$$.fragment,o),L(C.$$.fragment,o),L($.$$.fragment,o),F=!1},d(o){o&&(d(e),d(g),d(c),d(y),d(f),d(O)),G(a,o),G(h,o),G(N,o),G(C,o),G($,o)}}}function dt(t,e,l){let n;we(t,R,a=>l(1,n=a));let{idx:s}=e;function _(a){t.$$.not_equal(n.policyConflictLog[s].conflict,a)&&(n.policyConflictLog[s].conflict=a,R.set(n))}function p(a){t.$$.not_equal(n.policyConflictLog[s].stage,a)&&(n.policyConflictLog[s].stage=a,R.set(n))}function r(a){t.$$.not_equal(n.policyConflictLog[s].locationName,a)&&(n.policyConflictLog[s].locationName=a,R.set(n))}function u(a){t.$$.not_equal(n.policyConflictLog[s].resolved,a)&&(n.policyConflictLog[s].resolved=a,R.set(n))}function g(a){t.$$.not_equal(n.policyConflictLog[s].notes,a)&&(n.policyConflictLog[s].notes=a,R.set(n))}return t.$$set=a=>{"idx"in a&&l(0,s=a.idx)},[s,n,_,p,r,u,g]}class ht extends ye{constructor(e){super(),Ie(this,e,dt,gt,Ce,{idx:0})}}const{window:vt}=Ye;function Ee(t,e,l){const n=t.slice();return n[31]=e[l],n[32]=e,n[33]=l,n}function De(t,e,l){const n=t.slice();return n[34]=e[l],n[35]=e,n[33]=l,n}function je(t,e,l){const n=t.slice();return n[31]=e[l],n[33]=l,n}function qe(t,e,l){const n=t.slice();return n[34]=e[l],n[33]=l,n}function bt(t){let e,l,n,s,_,p,r,u;e=new ft({props:{$$slots:{default:[Ct]},$$scope:{ctx:t}}}),e.$on("click",t[23]),n=new ct({props:{$$slots:{default:[wt]},$$scope:{ctx:t}}}),n.$on("click",t[10]);const g=[It,yt],a=[];function S(c,h){return c[0].kind=="critical"?0:1}return _=S(t),p=a[_]=g[_](t),{c(){B(e.$$.fragment),l=j(),B(n.$$.fragment),s=j(),p.c(),r=Ne()},l(c){M(e.$$.fragment,c),l=q(c),M(n.$$.fragment,c),s=q(c),p.l(c),r=Ne()},m(c,h){A(e,c,h),I(c,l,h),A(n,c,h),I(c,s,h),a[_].m(c,h),I(c,r,h),u=!0},p(c,h){const D={};h[1]&128&&(D.$$scope={dirty:h,ctx:c}),e.$set(D);const y={};h[1]&128&&(y.$$scope={dirty:h,ctx:c}),n.$set(y);let N=_;_=S(c),_===N?a[_].p(c,h):(ae(),L(a[N],1,1,()=>{a[N]=null}),re(),p=a[_],p?p.p(c,h):(p=a[_]=g[_](c),p.c()),w(p,1),p.m(r.parentNode,r))},i(c){u||(w(e.$$.fragment,c),w(n.$$.fragment,c),w(p),u=!0)},o(c){L(e.$$.fragment,c),L(n.$$.fragment,c),L(p),u=!1},d(c){c&&(d(l),d(s),d(r)),G(e,c),G(n,c),a[_].d(c)}}}function kt(t){let e,l,n,s,_,p,r="Click the map to add a problem, or select a problem to fill out data",u,g,a="Critical Issues",S,c,h,D,y="Policy Conflicts",N,i,f;e=new ut({props:{label:"Tools",$$slots:{default:[Nt]},$$scope:{ctx:t}}});function C(m){t[16](m)}let V={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[4]!==void 0&&(V.value=t[4]),n=new lt({props:V}),J.push(()=>Q(n,"value",C));let O=se(t[2].criticalIssues),$=[];for(let m=0;m<O.length;m+=1)$[m]=Be(qe(t,O,m));const K=m=>L($[m],1,1,()=>{$[m]=null});let F=se(t[2].policyConflictLog),P=[];for(let m=0;m<F.length;m+=1)P[m]=Me(je(t,F,m));const oe=m=>L(P[m],1,1,()=>{P[m]=null});return{c(){B(e.$$.fragment),l=j(),B(n.$$.fragment),_=j(),p=W("p"),p.textContent=r,u=j(),g=W("h3"),g.textContent=a,S=j(),c=W("ol");for(let m=0;m<$.length;m+=1)$[m].c();h=j(),D=W("h3"),D.textContent=y,N=j(),i=W("ol");for(let m=0;m<P.length;m+=1)P[m].c()},l(m){M(e.$$.fragment,m),l=q(m),M(n.$$.fragment,m),_=q(m),p=Y(m,"P",{"data-svelte-h":!0}),he(p)!=="svelte-12ba5j2"&&(p.textContent=r),u=q(m),g=Y(m,"H3",{"data-svelte-h":!0}),he(g)!=="svelte-1qhh5xr"&&(g.textContent=a),S=q(m),c=Y(m,"OL",{});var k=Z(c);for(let H=0;H<$.length;H+=1)$[H].l(k);k.forEach(d),h=q(m),D=Y(m,"H3",{"data-svelte-h":!0}),he(D)!=="svelte-eyxzjx"&&(D.textContent=y),N=q(m),i=Y(m,"OL",{});var T=Z(i);for(let H=0;H<P.length;H+=1)P[H].l(T);T.forEach(d)},m(m,k){A(e,m,k),I(m,l,k),A(n,m,k),I(m,_,k),I(m,p,k),I(m,u,k),I(m,g,k),I(m,S,k),I(m,c,k);for(let T=0;T<$.length;T+=1)$[T]&&$[T].m(c,null);I(m,h,k),I(m,D,k),I(m,N,k),I(m,i,k);for(let T=0;T<P.length;T+=1)P[T]&&P[T].m(i,null);f=!0},p(m,k){const T={};k[0]&104|k[1]&128&&(T.$$scope={dirty:k,ctx:m}),e.$set(T);const H={};if(!s&&k[0]&16&&(s=!0,H.value=m[4],X(()=>s=!1)),n.$set(H),k[0]&262){O=se(m[2].criticalIssues);let E;for(E=0;E<O.length;E+=1){const ee=qe(m,O,E);$[E]?($[E].p(ee,k),w($[E],1)):($[E]=Be(ee),$[E].c(),w($[E],1),$[E].m(c,null))}for(ae(),E=O.length;E<$.length;E+=1)K(E);re()}if(k[0]&262){F=se(m[2].policyConflictLog);let E;for(E=0;E<F.length;E+=1){const ee=je(m,F,E);P[E]?(P[E].p(ee,k),w(P[E],1)):(P[E]=Me(ee),P[E].c(),w(P[E],1),P[E].m(i,null))}for(ae(),E=F.length;E<P.length;E+=1)oe(E);re()}},i(m){if(!f){w(e.$$.fragment,m),w(n.$$.fragment,m);for(let k=0;k<O.length;k+=1)w($[k]);for(let k=0;k<F.length;k+=1)w(P[k]);f=!0}},o(m){L(e.$$.fragment,m),L(n.$$.fragment,m),$=$.filter(Boolean);for(let k=0;k<$.length;k+=1)L($[k]);P=P.filter(Boolean);for(let k=0;k<P.length;k+=1)L(P[k]);f=!1},d(m){m&&(d(l),d(_),d(p),d(u),d(g),d(S),d(c),d(h),d(D),d(N),d(i)),G(e,m),G(n,m),_e($,m),_e(P,m)}}}function Ct(t){let e;return{c(){e=te("Save")},l(l){e=ne(l,"Save")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function wt(t){let e;return{c(){e=te("Delete")},l(l){e=ne(l,"Delete")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function yt(t){let e,l;return e=new ht({props:{idx:t[0].idx}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){A(e,n,s),l=!0},p(n,s){const _={};s[0]&1&&(_.idx=n[0].idx),e.$set(_)},i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){G(e,n)}}}function It(t){let e,l;return e=new mt({props:{idx:t[0].idx}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){A(e,n,s),l=!0},p(n,s){const _={};s[0]&1&&(_.idx=n[0].idx),e.$set(_)},i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){G(e,n)}}}function Lt(t){let e;return{c(){e=te("Zoom to fit")},l(l){e=ne(l,"Zoom to fit")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function St(t){let e;return{c(){e=te("Show scheme context")},l(l){e=ne(l,"Show scheme context")},m(l,n){I(l,e,n)},d(l){l&&d(e)}}}function Nt(t){let e,l,n,s,_,p,r,u,g,a,S,c;e=new Le({props:{$$slots:{default:[Lt]},$$scope:{ctx:t}}}),e.$on("click",t[13]),n=new it({}),_=new ot({});function h(i){t[14](i)}let D={map:t[3]};t[5]!==void 0&&(D.enabled=t[5]),r=new st({props:D}),J.push(()=>Q(r,"enabled",h));function y(i){t[15](i)}let N={$$slots:{default:[St]},$$scope:{ctx:t}};return t[6]!==void 0&&(N.checked=t[6]),a=new rt({props:N}),J.push(()=>Q(a,"checked",y)),{c(){B(e.$$.fragment),l=j(),B(n.$$.fragment),s=j(),B(_.$$.fragment),p=j(),B(r.$$.fragment),g=j(),B(a.$$.fragment)},l(i){M(e.$$.fragment,i),l=q(i),M(n.$$.fragment,i),s=q(i),M(_.$$.fragment,i),p=q(i),M(r.$$.fragment,i),g=q(i),M(a.$$.fragment,i)},m(i,f){A(e,i,f),I(i,l,f),A(n,i,f),I(i,s,f),A(_,i,f),I(i,p,f),A(r,i,f),I(i,g,f),A(a,i,f),c=!0},p(i,f){const C={};f[1]&128&&(C.$$scope={dirty:f,ctx:i}),e.$set(C);const V={};f[0]&8&&(V.map=i[3]),!u&&f[0]&32&&(u=!0,V.enabled=i[5],X(()=>u=!1)),r.$set(V);const O={};f[1]&128&&(O.$$scope={dirty:f,ctx:i}),!S&&f[0]&64&&(S=!0,O.checked=i[6],X(()=>S=!1)),a.$set(O)},i(i){c||(w(e.$$.fragment,i),w(n.$$.fragment,i),w(_.$$.fragment,i),w(r.$$.fragment,i),w(a.$$.fragment,i),c=!0)},o(i){L(e.$$.fragment,i),L(n.$$.fragment,i),L(_.$$.fragment,i),L(r.$$.fragment,i),L(a.$$.fragment,i),c=!1},d(i){i&&(d(l),d(s),d(p),d(g)),G(e,i),G(n,i),G(_,i),G(r,i),G(a,i)}}}function Et(t){let e=Pe(t[34])+"",l;return{c(){l=te(e)},l(n){l=ne(n,e)},m(n,s){I(n,l,s)},p(n,s){s[0]&4&&e!==(e=Pe(n[34])+"")&&de(l,e)},d(n){n&&d(l)}}}function Be(t){let e,l,n,s;function _(){return t[17](t[33])}function p(){return t[18](t[33])}return l=new Le({props:{$$slots:{default:[Et]},$$scope:{ctx:t}}}),l.$on("click",_),l.$on("mouseenter",p),l.$on("mouseleave",t[19]),{c(){e=W("li"),B(l.$$.fragment),n=j()},l(r){e=Y(r,"LI",{});var u=Z(e);M(l.$$.fragment,u),n=q(u),u.forEach(d)},m(r,u){I(r,e,u),A(l,e,null),z(e,n),s=!0},p(r,u){t=r;const g={};u[0]&4|u[1]&128&&(g.$$scope={dirty:u,ctx:t}),l.$set(g)},i(r){s||(w(l.$$.fragment,r),s=!0)},o(r){L(l.$$.fragment,r),s=!1},d(r){r&&d(e),G(l)}}}function Dt(t){let e=Ve(t[31])+"",l;return{c(){l=te(e)},l(n){l=ne(n,e)},m(n,s){I(n,l,s)},p(n,s){s[0]&4&&e!==(e=Ve(n[31])+"")&&de(l,e)},d(n){n&&d(l)}}}function Me(t){let e,l,n,s;function _(){return t[20](t[33])}function p(){return t[21](t[33])}return l=new Le({props:{$$slots:{default:[Dt]},$$scope:{ctx:t}}}),l.$on("click",_),l.$on("mouseenter",p),l.$on("mouseleave",t[22]),{c(){e=W("li"),B(l.$$.fragment),n=j()},l(r){e=Y(r,"LI",{});var u=Z(e);M(l.$$.fragment,u),n=q(u),u.forEach(d)},m(r,u){I(r,e,u),A(l,e,null),z(e,n),s=!0},p(r,u){t=r;const g={};u[0]&4|u[1]&128&&(g.$$scope={dirty:u,ctx:t}),l.$set(g)},i(r){s||(w(l.$$.fragment,r),s=!0)},o(r){L(l.$$.fragment,r),s=!1},d(r){r&&d(e),G(l)}}}function jt(t){let e,l,n,s=t[34].criticalIssue+"",_;return{c(){e=ve("svg"),l=ve("polygon"),n=ve("text"),_=te(s),this.h()},l(p){e=be(p,"svg",{width:!0,height:!0,xmlns:!0});var r=Z(e);l=be(r,"polygon",{points:!0,fill:!0,class:!0}),Z(l).forEach(d),n=be(r,"text",{x:!0,y:!0});var u=Z(n);_=ne(u,s),u.forEach(d),r.forEach(d),this.h()},h(){U(l,"points","20,0 0,40 40,40"),U(l,"fill",xe.critical.background),U(l,"class","svelte-ktyu3j"),U(n,"x","13"),U(n,"y","30"),x(n,"fill","white"),U(e,"width","40"),U(e,"height","40"),U(e,"xmlns","http://www.w3.org/2000/svg")},m(p,r){I(p,e,r),z(e,l),z(e,n),z(n,_)},p(p,r){r[0]&4&&s!==(s=p[34].criticalIssue+"")&&de(_,s)},d(p){p&&d(e)}}}function Ae(t){let e,l,n;function s(u){t[24](u,t[34])}function _(){return t[25](t[33])}function p(){return t[26](t[33])}let r={draggable:!0,$$slots:{default:[jt]},$$scope:{ctx:t}};return t[34].point!==void 0&&(r.lngLat=t[34].point),e=new Re({props:r}),J.push(()=>Q(e,"lngLat",s)),e.$on("click",_),e.$on("dragend",p),{c(){B(e.$$.fragment)},l(u){M(e.$$.fragment,u)},m(u,g){A(e,u,g),n=!0},p(u,g){t=u;const a={};g[0]&4|g[1]&128&&(a.$$scope={dirty:g,ctx:t}),!l&&g[0]&4&&(l=!0,a.lngLat=t[34].point,X(()=>l=!1)),e.$set(a)},i(u){n||(w(e.$$.fragment,u),n=!0)},o(u){L(e.$$.fragment,u),n=!1},d(u){G(e,u)}}}function qt(t){let e,l=t[31].conflict+"",n;return{c(){e=W("span"),n=te(l),this.h()},l(s){e=Y(s,"SPAN",{class:!0});var _=Z(e);n=ne(_,l),_.forEach(d),this.h()},h(){U(e,"class","dot svelte-ktyu3j"),x(e,"background",et)},m(s,_){I(s,e,_),z(e,n)},p(s,_){_[0]&4&&l!==(l=s[31].conflict+"")&&de(n,l)},d(s){s&&d(e)}}}function Ge(t){let e,l,n;function s(u){t[27](u,t[31])}function _(){return t[28](t[33])}function p(){return t[29](t[33])}let r={draggable:!0,$$slots:{default:[qt]},$$scope:{ctx:t}};return t[31].point!==void 0&&(r.lngLat=t[31].point),e=new Re({props:r}),J.push(()=>Q(e,"lngLat",s)),e.$on("click",_),e.$on("dragend",p),{c(){B(e.$$.fragment)},l(u){M(e.$$.fragment,u)},m(u,g){A(e,u,g),n=!0},p(u,g){t=u;const a={};g[0]&4|g[1]&128&&(a.$$scope={dirty:g,ctx:t}),!l&&g[0]&4&&(l=!0,a.lngLat=t[31].point,X(()=>l=!1)),e.$set(a)},i(u){n||(w(e.$$.fragment,u),n=!0)},o(u){L(e.$$.fragment,u),n=!1},d(u){G(e,u)}}}function Bt(t){let e,l;return e=new Qe({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){B(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){A(e,n,s),l=!0},p:Ke,i(n){l||(w(e.$$.fragment,n),l=!0)},o(n){L(e.$$.fragment,n),l=!1},d(n){G(e,n)}}}function Mt(t){let e,l,n,s,_,p,r,u,g,a;e=new at({}),e.$on("click",t[9]),n=new Je({props:{gj:t[2].summary.networkMap,show:t[6]}});let S=se(t[2].criticalIssues),c=[];for(let i=0;i<S.length;i+=1)c[i]=Ae(De(t,S,i));const h=i=>L(c[i],1,1,()=>{c[i]=null});let D=se(t[2].policyConflictLog),y=[];for(let i=0;i<D.length;i+=1)y[i]=Ge(Ee(t,D,i));const N=i=>L(y[i],1,1,()=>{y[i]=null});return r=new Xe({props:{data:t[7],$$slots:{default:[Bt]},$$scope:{ctx:t}}}),g=new pt({props:{map:t[3]}}),{c(){B(e.$$.fragment),l=j(),B(n.$$.fragment),s=j();for(let i=0;i<c.length;i+=1)c[i].c();_=j();for(let i=0;i<y.length;i+=1)y[i].c();p=j(),B(r.$$.fragment),u=j(),B(g.$$.fragment)},l(i){M(e.$$.fragment,i),l=q(i),M(n.$$.fragment,i),s=q(i);for(let f=0;f<c.length;f+=1)c[f].l(i);_=q(i);for(let f=0;f<y.length;f+=1)y[f].l(i);p=q(i),M(r.$$.fragment,i),u=q(i),M(g.$$.fragment,i)},m(i,f){A(e,i,f),I(i,l,f),A(n,i,f),I(i,s,f);for(let C=0;C<c.length;C+=1)c[C]&&c[C].m(i,f);I(i,_,f);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(i,f);I(i,p,f),A(r,i,f),I(i,u,f),A(g,i,f),a=!0},p(i,f){const C={};if(f[0]&4&&(C.gj=i[2].summary.networkMap),f[0]&64&&(C.show=i[6]),n.$set(C),f[0]&260){S=se(i[2].criticalIssues);let $;for($=0;$<S.length;$+=1){const K=De(i,S,$);c[$]?(c[$].p(K,f),w(c[$],1)):(c[$]=Ae(K),c[$].c(),w(c[$],1),c[$].m(_.parentNode,_))}for(ae(),$=S.length;$<c.length;$+=1)h($);re()}if(f[0]&260){D=se(i[2].policyConflictLog);let $;for($=0;$<D.length;$+=1){const K=Ee(i,D,$);y[$]?(y[$].p(K,f),w(y[$],1)):(y[$]=Ge(K),y[$].c(),w(y[$],1),y[$].m(p.parentNode,p))}for(ae(),$=D.length;$<y.length;$+=1)N($);re()}const V={};f[0]&128&&(V.data=i[7]),f[1]&128&&(V.$$scope={dirty:f,ctx:i}),r.$set(V);const O={};f[0]&8&&(O.map=i[3]),g.$set(O)},i(i){if(!a){w(e.$$.fragment,i),w(n.$$.fragment,i);for(let f=0;f<S.length;f+=1)w(c[f]);for(let f=0;f<D.length;f+=1)w(y[f]);w(r.$$.fragment,i),w(g.$$.fragment,i),a=!0}},o(i){L(e.$$.fragment,i),L(n.$$.fragment,i),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)L(c[f]);y=y.filter(Boolean);for(let f=0;f<y.length;f+=1)L(y[f]);L(r.$$.fragment,i),L(g.$$.fragment,i),a=!1},d(i){i&&(d(l),d(s),d(_),d(p),d(u)),G(e,i),G(n,i),_e(c,i),_e(y,i),G(r,i),G(g,i)}}}function At(t){let e,l,n,s,_,p,r,u,g,a,S;const c=[kt,bt],h=[];function D(i,f){return i[0]==null?0:1}n=D(t),s=h[n]=c[n](t);function y(i){t[30](i)}let N={$$slots:{default:[Mt]},$$scope:{ctx:t}};return t[3]!==void 0&&(N.map=t[3]),r=new We({props:N}),J.push(()=>Q(r,"map",y)),{c(){e=W("div"),l=W("div"),s.c(),_=j(),p=W("div"),B(r.$$.fragment),this.h()},l(i){e=Y(i,"DIV",{style:!0});var f=Z(e);l=Y(f,"DIV",{style:!0});var C=Z(l);s.l(C),C.forEach(d),_=q(f),p=Y(f,"DIV",{style:!0});var V=Z(p);M(r.$$.fragment,V),V.forEach(d),f.forEach(d),this.h()},h(){x(l,"width","30%"),x(l,"overflow-y","scroll"),x(l,"padding","10px"),x(l,"border","1px solid black"),x(p,"position","relative"),x(p,"width","70%"),x(e,"display","flex"),x(e,"height","80vh")},m(i,f){I(i,e,f),z(e,l),h[n].m(l,null),z(e,_),z(e,p),A(r,p,null),g=!0,a||(S=ze(vt,"keydown",t[12]),a=!0)},p(i,f){let C=n;n=D(i),n===C?h[n].p(i,f):(ae(),L(h[C],1,1,()=>{h[C]=null}),re(),s=h[n],s?s.p(i,f):(s=h[n]=c[n](i),s.c()),w(s,1),s.m(l,null));const V={};f[0]&204|f[1]&128&&(V.$$scope={dirty:f,ctx:i}),!u&&f[0]&8&&(u=!0,V.map=i[3],X(()=>u=!1)),r.$set(V)},i(i){g||(w(s),w(r.$$.fragment,i),g=!0)},o(i){L(s),L(r.$$.fragment,i),g=!1},d(i){i&&d(e),h[n].d(),G(r),a=!1,S()}}}function Gt(t,e,l){let n={type:"FeatureCollection",features:[]},s=e??l;if(s!=null){let _=s.kind=="critical"?t.criticalIssues:t.policyConflictLog;n.features.push(ke(_[s.idx].point))}return n}function ke(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function Pe(t){return`${t.criticalIssue||"Unknown critical"}: ${t.locationName||"???"}`}function Ve(t){return`${t.conflict||"Unknown conflict"}: ${t.locationName||"???"}`}function Pt(t,e,l){let n,s;we(t,R,b=>l(2,s=b));let _,p="critical",r=null,u=null,g=!1,a=!0;function S(b){l(0,r=b),l(1,u=null)}function c(b){if(!g){if(r!=null){l(0,r=null);return}p=="critical"?(Se(R,s.criticalIssues=[...s.criticalIssues,{criticalIssue:"",stage:"",point:b.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),S({kind:"critical",idx:s.criticalIssues.length-1})):(Se(R,s.policyConflictLog=[...s.policyConflictLog,{conflict:"",stage:"",point:b.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],s),S({kind:"conflict",idx:s.policyConflictLog.length-1}))}}He(()=>{D(!1)});function h(){window.confirm("Delete this entry?")&&(r.kind=="critical"?(s.criticalIssues.splice(r.idx,1),R.set(s)):(s.policyConflictLog.splice(r.idx,1),R.set(s)),l(0,r=null))}function D(b){let o={type:"FeatureCollection",features:[...s.criticalIssues.map(v=>ke(v.point)),...s.policyConflictLog.map(v=>ke(v.point)),...s.summary.networkMap.features]};o.features.length>0&&_.fitBounds(Ze(o),{padding:20,animate:b})}function y(b){if(r!=null&&b.key=="Escape")b.stopPropagation(),l(0,r=null);else if(r!=null&&b.key=="Delete"){let o=b.target.tagName;if(o=="INPUT"||o=="TEXTAREA")return;b.stopPropagation(),h()}}const N=()=>D(!0);function i(b){g=b,l(5,g)}function f(b){a=b,l(6,a)}function C(b){p=b,l(4,p)}const V=b=>S({kind:"critical",idx:b}),O=b=>l(1,u={kind:"critical",idx:b}),$=()=>l(1,u=null),K=b=>S({kind:"conflict",idx:b}),F=b=>l(1,u={kind:"conflict",idx:b}),P=()=>l(1,u=null),oe=()=>l(0,r=null);function m(b,o){t.$$.not_equal(o.point,b)&&(o.point=b,R.set(s))}const k=b=>S({kind:"critical",idx:b}),T=b=>S({kind:"critical",idx:b});function H(b,o){t.$$.not_equal(o.point,b)&&(o.point=b,R.set(s))}const E=b=>S({kind:"conflict",idx:b}),ee=b=>S({kind:"conflict",idx:b});function fe(b){_=b,l(3,_)}return t.$$.update=()=>{t.$$.dirty[0]&7&&l(7,n=Gt(s,r,u))},[r,u,s,_,p,g,a,n,S,c,h,D,y,N,i,f,C,V,O,$,K,F,P,oe,m,k,T,H,E,ee,fe]}class en extends ye{constructor(e){super(),Ie(this,e,Pt,At,Ce,{},null,[-1,-1])}}export{en as component};
