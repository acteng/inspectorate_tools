import{s as E,e as W,a as d,c as R,m as A,g as y,i as C,n as I,f as h,k as b}from"../chunks/scheduler.DH2GUgXz.js";import{S as x,i as O,c as S,b as $,m as P,t as v,a as D,d as L}from"../chunks/index.BHUn3u8Z.js";import{s as _}from"../chunks/data.DEyN8Lxp.js";import{g as j}from"../chunks/results.CtlUOy5l.js";import{p as M,c as w}from"../chunks/lists.BnA5ucEg.js";import{T as k}from"../chunks/TextArea.Bfj0cJeT.js";function N(t){let e=j(t),n=t.summary.checkType=="street",o=t.summary.checkType=="path",r={Safety:"Sa",Accessibility:"Ac",Comfort:"Cf",Directness:"Di",Attractiveness:"At",Cohesion:"Co",overall:"To"},i={"Social activity":"SA","Personal security":"PS","Character and legibility":"CL",Environment:"En",overall:"To"};return[...J(t),...F(t),...f("SA",0,t.safetyCheck),...f("ST",16,t.streetCheck),...f("SP",0,t.streetPlacemakingCheck),...f("PA",16,t.pathCheck),...f("PP",0,t.pathPlacemakingCheck),...V(t),...G(t),...m("ST-LOS",[...e.levelOfService,e.overall],n,r),...m("ST-LOS",e.byMode,n,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy"}),...m("SP-LOS",[...e.placemakingCategories,e.placemakingOverall],n,i),...m("PA-LOS",[...e.levelOfService,e.overall],o,r),...m("PA-LOS",e.byMode,o,{Walking:"Wa",Wheeling:"Wh",Cycling:"Cy","Horse Riding":"HR"}),...m("PP-LOS",[...e.placemakingCategories,e.placemakingOverall],o,i),...H(t,e),...Y(t),...B(t),...z()]}function J(t){let e=t.summary;return[["Scheme Ref",e.schemeReference],["Date of Design Review",e.dateDesignReview],["Scheme Name",e.schemeName],["Authority",e.authority],["Transport/ Combined Authority",e.transportOrCombinedAuthority],["Region",e.region],["Funding Programme",e.fundingProgramme],["Design Stage",e.designStage],["Funding Conditions",e.fundingConditions],["Inspector",e.inspectorEmail],["RouteLength",e.totalRouteLengthKm],["RouteFileLength",e.assessedRouteLengthKm],["Notes",e.notes],["Tool","Route Check online-alpha"],["Sub-tool",e.checkType=="street"?"Street Check":"Path Check"]]}function F(t){let e=[];for(let[n,o]of t.policyCheck.entries())e.push([`PC${p(n)}-E`,o.existing]),e.push([`PC${p(n)}-D`,o.proposed]);return e}function f(t,e,n){let o=[];for(let r=0;r<n.existingScores.length;r++)o.push([`${t}${p(r+e)}-E`,n.existingScores[r]]),o.push([`${t}${p(r+e)}-D`,n.proposedScores[r]]);return o}function p(t){return(t+1).toString().padStart(2,"0")}function V(t){let e={existing:t.policyConflictLog.filter(n=>n.stage=="Existing").length,designed:t.policyConflictLog.filter(n=>n.stage=="Design").length,removed:t.policyConflictLog.filter(n=>n.resolved=="Yes").length};return[["PC-E",e.existing],["PC-D",e.designed],["PC-Rem",e.removed],["PC-Int",e.designed],["PC-Tot",e.designed+e.existing-e.removed]]}function G(t){let e={existing:t.criticalIssues.filter(n=>n.stage=="Existing").length,designed:t.criticalIssues.filter(n=>n.stage=="Design").length,removed:t.criticalIssues.filter(n=>n.resolved=="Yes").length};return[["SA-E",e.existing],["SA-D",e.designed],["SA-Rem",e.removed],["SA-Int",e.designed],["SA-Tot",e.designed+e.existing-e.removed]]}function m(t,e,n,o){let r=[];for(let i of e){let s=o[i.category];r.push([`${t}-${s}-E`,n?i.existing.scorePercent/100:null]),r.push([`${t}-${s}-D`,n?i.proposed.scorePercent/100:null])}return r}function H(t,e){let n=[],o=12,r=e.jat.length-1;for(let i=1;i<=o;i++)for(let[s,a]of[["walkingWheeling","WW"],["cycling","Cy"],["total","To"]])n.push([`J${i}-LOS-${a}-E`,i<=r?e.jat[i-1][s].existing:"Not Completed"]),n.push([`J${i}-LOS-${a}-D`,i<=r?e.jat[i-1][s].proposed:"Not Completed"]);for(let i=1;i<=o;i++)i<=r?n.push([`J${i}-Arms`,t.jat[i-1].proposed.arms.length]):n.push([`J${i}-Arms`,null]);return n}function K(t,e){let n=t.policyConflictLog[e],o=0;for(let i=0;i<=e;i++)t.policyConflictLog[i].conflict==n.conflict&&o++;return[t.summary.schemeReference,`P${n.conflict.padStart(3,"0")}`,`${o.toString().padStart(2,"0")}P`].join("_")}function Y(t){let e=[],n=35;for(let o=0;o<n;o++){let r;if(o<t.policyConflictLog.length){let i=t.policyConflictLog[o];r={Ref:K(t,o),Typ:M.find(s=>s[0]==i.conflict)[1],Sta:i.stage,LaL:`${i.point[1]}, ${i.point[0]}`,Loc:i.locationName,Res:i.resolved,Com:i.notes}}else r={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[i,s]of Object.entries(r))e.push([`${p(o)}PC${i}`,s])}return e}function T(t){return/\D$/.test(t)?t.slice(0,-1):t}function q(t,e){let n=t.criticalIssues[e],o=T(n.criticalIssue),r=0;for(let s=0;s<=e;s++)T(t.criticalIssues[s].criticalIssue)==o&&r++;return[t.summary.schemeReference,`SA${o.padStart(2,"0")}`,`${r.toString().padStart(2,"0")}P`].join("_")}function B(t){let e=[],n=35;for(let o=0;o<n;o++){let r;if(o<t.criticalIssues.length){let i=t.criticalIssues[o];r={Ref:q(t,o),Typ:w.find(s=>s[0]==i.criticalIssue)[1],Sta:i.stage,LaL:`${i.point[1]}, ${i.point[0]}`,Loc:i.locationName,Res:i.resolved,Com:i.notes}}else r={Ref:"",Typ:"",Sta:"",LaL:"",Loc:"",Res:"",Com:""};for(let[i,s]of Object.entries(r))e.push([`${p(o)}SA${i}`,s])}return e}function z(){return["Area-E","Area-D","Po-WW-E","Po-WW-D","Po-Cy-E","Po-Cy-D","Cr-WW-E","Cr-WW-D","Cr-Cy-E","Cr-Cy-D","Pe-WW-D","Pe-WW-E","Pe-Cy-D","Pe-Cy-E","MD-WW-D","MD-WW-E","MD-Cy-D","MD-Cy-E","MT-E","MT-D","PT-E","PT-D","GI-E","GI-D","IT-E","IT-D","EP-E","EP-D","TM-Comments","AC-Comments"].map(e=>[e,""])}function Q(t){let e,n=`This page is for internal use only. The values below are TSV (tab-separated
  values), copyable into Excel.`,o,r,i,s,a,c,g;return r=new k({props:{label:"TSV output, just the one row of values",value:t[2]}}),s=new k({props:{label:"TSV output with header",value:`${t[1]}
${t[2]}
`}}),c=new k({props:{label:"JSON mapping",value:JSON.stringify(Object.fromEntries(t[0]),null,"  ")}}),{c(){e=W("p"),e.textContent=n,o=d(),S(r.$$.fragment),i=d(),S(s.$$.fragment),a=d(),S(c.$$.fragment)},l(l){e=R(l,"P",{"data-svelte-h":!0}),A(e)!=="svelte-5ssfe3"&&(e.textContent=n),o=y(l),$(r.$$.fragment,l),i=y(l),$(s.$$.fragment,l),a=y(l),$(c.$$.fragment,l)},m(l,u){C(l,e,u),C(l,o,u),P(r,l,u),C(l,i,u),P(s,l,u),C(l,a,u),P(c,l,u),g=!0},p:I,i(l){g||(v(r.$$.fragment,l),v(s.$$.fragment,l),v(c.$$.fragment,l),g=!0)},o(l){D(r.$$.fragment,l),D(s.$$.fragment,l),D(c.$$.fragment,l),g=!1},d(l){l&&(h(e),h(o),h(i),h(a)),L(r,l),L(s,l),L(c,l)}}}function U(t,e,n){let o;b(t,_,a=>n(3,o=a));let r=N(o),i=r.map(a=>a[0]).join("	"),s=r.map(a=>a[1]).join("	");return[r,i,s]}class oe extends x{constructor(e){super(),O(this,e,U,Q,E,{})}}export{oe as component};
