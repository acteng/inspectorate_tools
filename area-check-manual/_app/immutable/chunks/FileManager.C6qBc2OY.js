import{s as Z,B as Q,i as _,n as M,f as p,e as x,a as v,t as Y,c as E,b as V,g as y,d as X,o as z,h as R,j as ee,Q as de,z as _e,v as ge,m as re,r as he,R as oe,S as K}from"./scheduler.DH2GUgXz.js";import{S as te,i as ne,c as A,b as B,m as D,t as b,a as k,d as G,g as se,f as ie}from"./index.BHUn3u8Z.js";import{e as ae}from"./each.CZblyi7L.js";import{B as we}from"./ButtonGroup.D2q4FpCM.js";import{F as be}from"./FileInput.Cvc6kS8G.js";import{S as T,W as Fe}from"./WarningButton.DMIZkWvd.js";import{a as pe}from"./index.DbwfNJvD.js";import{F as ke}from"./FormElement.Bd-47OHL.js";import"./index.DQk7bYay.js";import{C as ve}from"./ClickableCard.CZseMAct.js";function fe(o){let e,t,n,r,s,i,a;return{c(){e=x("div"),t=x("div"),n=x("progress"),r=v(),s=x("div"),i=x("h3"),a=Y(o[0]),this.h()},l(m){e=E(m,"DIV",{class:!0});var u=V(e);t=E(u,"DIV",{class:!0});var $=V(t);n=E($,"PROGRESS",{}),V(n).forEach(p),r=y($),s=E($,"DIV",{class:!0});var h=V(s);i=E(h,"H3",{});var I=V(i);a=X(I,o[0]),I.forEach(p),h.forEach(p),$.forEach(p),u.forEach(p),this.h()},h(){z(s,"class","govuk-prose"),z(t,"class","inner svelte-ho9d42"),z(e,"class","outer svelte-ho9d42")},m(m,u){_(m,e,u),R(e,t),R(t,n),R(t,r),R(t,s),R(s,i),R(i,a)},p(m,u){u&1&&ee(a,m[0])},d(m){m&&p(e)}}}function ye(o){let e,t=o[0]&&fe(o);return{c(){t&&t.c(),e=Q()},l(n){t&&t.l(n),e=Q()},m(n,r){t&&t.m(n,r),_(n,e,r)},p(n,[r]){n[0]?t?t.p(n,r):(t=fe(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:M,o:M,d(n){n&&p(e),t&&t.d(n)}}}function Ie(o,e,t){let{loading:n}=e;return o.$$set=r=>{"loading"in r&&t(0,n=r.loading)},[n]}class Ce extends te{constructor(e){super(),ne(this,e,Ie,ye,Z,{loading:0})}}function Se(o){let e,t,n;return{c(){e=x("input"),this.h()},l(r){e=E(r,"INPUT",{class:!0,id:!0,type:!0}),this.h()},h(){z(e,"class","govuk-file-upload"),z(e,"id","import-xlsx"),z(e,"type","file")},m(r,s){_(r,e,s),o[4](e),t||(n=_e(e,"change",o[2]),t=!0)},p:M,d(r){r&&p(e),o[4](null),t=!1,n()}}}function xe(o){let e,t,n,r;return e=new ke({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[Se]},$$scope:{ctx:o}}}),n=new Ce({props:{loading:o[0]}}),{c(){A(e.$$.fragment),t=v(),A(n.$$.fragment)},l(s){B(e.$$.fragment,s),t=y(s),B(n.$$.fragment,s)},m(s,i){D(e,s,i),_(s,t,i),D(n,s,i),r=!0},p(s,[i]){const a={};i&66&&(a.$$scope={dirty:i,ctx:s}),e.$set(a);const m={};i&1&&(m.loading=s[0]),n.$set(m)},i(s){r||(b(e.$$.fragment,s),b(n.$$.fragment,s),r=!0)},o(s){k(e.$$.fragment,s),k(n.$$.fragment,s),r=!1},d(s){s&&p(t),G(e,s),G(n,s)}}}function Ee(o,e,t){let n=de(),{xlsxImporter:r}=e,s="",i;async function a(u){let $=i.files[0].name;try{t(0,s=`Loading ${$}`);let h=await i.files[0].arrayBuffer(),I=await r(h);t(0,s=""),n("imported",{filename:pe($,".xlsx"),data:I})}catch(h){window.alert(`Couldn't import ${$}: ${h}`),t(0,s="")}}function m(u){ge[u?"unshift":"push"](()=>{i=u,t(1,i)})}return o.$$set=u=>{"xlsxImporter"in u&&t(3,r=u.xlsxImporter)},[s,i,a,r,m]}class Le extends te{constructor(e){super(),ne(this,e,Ee,xe,Z,{xlsxImporter:3})}}function ue(o,e,t){const n=o.slice();return n[15]=e[t],n}function Ne(o){let e;return{c(){e=Y("Rename")},l(t){e=X(t,"Rename")},m(t,n){_(t,e,n)},d(t){t&&p(e)}}}function Re(o){let e;return{c(){e=Y("Export")},l(t){e=X(t,"Export")},m(t,n){_(t,e,n)},d(t){t&&p(e)}}}function Ae(o){let e;return{c(){e=Y("Delete")},l(t){e=X(t,"Delete")},m(t,n){_(t,e,n)},d(t){t&&p(e)}}}function Be(o){let e,t,n,r,s,i;return e=new T({props:{$$slots:{default:[Ne]},$$scope:{ctx:o}}}),e.$on("click",o[5]),n=new T({props:{$$slots:{default:[Re]},$$scope:{ctx:o}}}),n.$on("click",o[6]),s=new Fe({props:{$$slots:{default:[Ae]},$$scope:{ctx:o}}}),s.$on("click",o[7]),{c(){A(e.$$.fragment),t=v(),A(n.$$.fragment),r=v(),A(s.$$.fragment)},l(a){B(e.$$.fragment,a),t=y(a),B(n.$$.fragment,a),r=y(a),B(s.$$.fragment,a)},m(a,m){D(e,a,m),_(a,t,m),D(n,a,m),_(a,r,m),D(s,a,m),i=!0},p(a,m){const u={};m&262144&&(u.$$scope={dirty:m,ctx:a}),e.$set(u);const $={};m&262144&&($.$$scope={dirty:m,ctx:a}),n.$set($);const h={};m&262144&&(h.$$scope={dirty:m,ctx:a}),s.$set(h)},i(a){i||(b(e.$$.fragment,a),b(n.$$.fragment,a),b(s.$$.fragment,a),i=!0)},o(a){k(e.$$.fragment,a),k(n.$$.fragment,a),k(s.$$.fragment,a),i=!1},d(a){a&&(p(t),p(r)),G(e,a),G(n,a),G(s,a)}}}function De(o){let e;return{c(){e=Y("New file")},l(t){e=X(t,"New file")},m(t,n){_(t,e,n)},d(t){t&&p(e)}}}function ce(o){let e,t;return e=new Le({props:{xlsxImporter:o[2]}}),e.$on("imported",o[10]),{c(){A(e.$$.fragment)},l(n){B(e.$$.fragment,n)},m(n,r){D(e,n,r),t=!0},p(n,r){const s={};r&4&&(s.xlsxImporter=n[2]),e.$set(s)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){G(e,n)}}}function Ge(o){let e=o[15]===o[4]?"Already selected":"",t,n;return{c(){t=Y(e),n=v()},l(r){t=X(r,e),n=y(r)},m(r,s){_(r,t,s),_(r,n,s)},p(r,s){s&24&&e!==(e=r[15]===r[4]?"Already selected":"")&&ee(t,e)},d(r){r&&(p(t),p(n))}}}function me(o){let e,t;function n(){return o[13](o[15])}return e=new ve({props:{name:`File name: ${o[15]}`,disabled:o[15]===o[4],$$slots:{default:[Ge]},$$scope:{ctx:o}}}),e.$on("click",n),{c(){A(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,s){D(e,r,s),t=!0},p(r,s){o=r;const i={};s&8&&(i.name=`File name: ${o[15]}`),s&24&&(i.disabled=o[15]===o[4]),s&262168&&(i.$$scope={dirty:s,ctx:o}),e.$set(i)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){G(e,r)}}}function je(o){let e,t=`All files are auto-saved in your browser's local storage. You can close your
  browser and resume later. You can export the file to your computer to share
  with someone else, and import from a file below.`,n,r,s,i,a,m,u,$,h,I,L,S,H,j,O,J,P,U="Load a saved file:",W,c,w;$=new we({props:{$$slots:{default:[Be]},$$scope:{ctx:o}}}),S=new T({props:{$$slots:{default:[De]},$$scope:{ctx:o}}}),S.$on("click",o[8]),j=new be({props:{label:"Import from a .json file",onLoad:o[9]}});let d=o[2]!=null&&ce(o),C=ae(o[3]),g=[];for(let l=0;l<C.length;l+=1)g[l]=me(ue(o,C,l));const $e=l=>k(g[l],1,1,()=>{g[l]=null});return{c(){e=x("p"),e.textContent=t,n=v(),r=x("p"),s=Y("You're currently editing "),i=x("u"),a=Y(o[4]),m=Y(`
  .`),u=v(),A($.$$.fragment),h=v(),I=x("hr"),L=v(),A(S.$$.fragment),H=v(),A(j.$$.fragment),O=v(),d&&d.c(),J=v(),P=x("p"),P.textContent=U,W=v();for(let l=0;l<g.length;l+=1)g[l].c();c=Q()},l(l){e=E(l,"P",{"data-svelte-h":!0}),re(e)!=="svelte-eph3gl"&&(e.textContent=t),n=y(l),r=E(l,"P",{});var f=V(r);s=X(f,"You're currently editing "),i=E(f,"U",{});var N=V(i);a=X(N,o[4]),N.forEach(p),m=X(f,`
  .`),f.forEach(p),u=y(l),B($.$$.fragment,l),h=y(l),I=E(l,"HR",{}),L=y(l),B(S.$$.fragment,l),H=y(l),B(j.$$.fragment,l),O=y(l),d&&d.l(l),J=y(l),P=E(l,"P",{"data-svelte-h":!0}),re(P)!=="svelte-1xydj1w"&&(P.textContent=U),W=y(l);for(let q=0;q<g.length;q+=1)g[q].l(l);c=Q()},m(l,f){_(l,e,f),_(l,n,f),_(l,r,f),R(r,s),R(r,i),R(i,a),R(r,m),_(l,u,f),D($,l,f),_(l,h,f),_(l,I,f),_(l,L,f),D(S,l,f),_(l,H,f),D(j,l,f),_(l,O,f),d&&d.m(l,f),_(l,J,f),_(l,P,f),_(l,W,f);for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(l,f);_(l,c,f),w=!0},p(l,[f]){(!w||f&16)&&ee(a,l[4]);const N={};f&262144&&(N.$$scope={dirty:f,ctx:l}),$.$set(N);const q={};if(f&262144&&(q.$$scope={dirty:f,ctx:l}),S.$set(q),l[2]!=null?d?(d.p(l,f),f&4&&b(d,1)):(d=ce(l),d.c(),b(d,1),d.m(J.parentNode,J)):d&&(se(),k(d,1,1,()=>{d=null}),ie()),f&2072){C=ae(l[3]);let F;for(F=0;F<C.length;F+=1){const le=ue(l,C,F);g[F]?(g[F].p(le,f),b(g[F],1)):(g[F]=me(le),g[F].c(),b(g[F],1),g[F].m(c.parentNode,c))}for(se(),F=C.length;F<g.length;F+=1)$e(F);ie()}},i(l){if(!w){b($.$$.fragment,l),b(S.$$.fragment,l),b(j.$$.fragment,l),b(d);for(let f=0;f<C.length;f+=1)b(g[f]);w=!0}},o(l){k($.$$.fragment,l),k(S.$$.fragment,l),k(j.$$.fragment,l),k(d),g=g.filter(Boolean);for(let f=0;f<g.length;f+=1)k(g[f]);w=!1},d(l){l&&(p(e),p(n),p(r),p(u),p(h),p(I),p(L),p(H),p(O),p(J),p(P),p(W),p(c)),G($,l),G(S,l),G(j,l),d&&d.d(l),he(g,l)}}}function Pe(o,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",o),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ye(o,e,t){let n,r=M,s=()=>(r(),r=oe(h,c=>t(14,n=c)),h),i,a=M,m=()=>(a(),a=oe($,c=>t(4,i=c)),$);o.$$.on_destroy.push(()=>r()),o.$$.on_destroy.push(()=>a());let{files:u}=e,{currentFile:$}=e;m();let{state:h}=e;s();let{xlsxImporter:I=null}=e,L=u.getFileList();function S(){let c=window.prompt(`Rename file ${i} to what?`,i);if(c){let w=u.key(i),d=window.localStorage.getItem(w);window.localStorage.setItem(u.key(c),d),window.localStorage.removeItem(w),K($,i=c,i),t(3,L=u.getFileList())}}function H(){Pe(i+".json",JSON.stringify(n))}async function j(){window.confirm(`Really delete file ${i}? You can't undo this.`)&&(window.localStorage.removeItem(u.key(i)),await O())}async function O(){K($,i=u.newFilename(),i),K(h,n=u.emptyState(),n),t(3,L=u.saveAndGetFileList(i,n))}async function J(c,w){let d=pe(c,".json");try{let C=JSON.parse(w);u.validate(C),t(3,L=u.saveAndGetFileList(d,C)),await U(d)}catch(C){window.alert(`Couldn't load ${d}: ${C}`)}}async function P(c){let{filename:w,data:d}=c.detail;t(3,L=u.saveAndGetFileList(w,d)),await U(w)}async function U(c){try{let w=u.loadFile(c);K($,i=c,i),K(h,n=w,n)}catch(w){window.alert(`Couldn't load ${c}: ${w}`)}}const W=c=>U(c);return o.$$set=c=>{"files"in c&&t(12,u=c.files),"currentFile"in c&&m(t(0,$=c.currentFile)),"state"in c&&s(t(1,h=c.state)),"xlsxImporter"in c&&t(2,I=c.xlsxImporter)},[$,h,I,L,i,S,H,j,O,J,P,U,u,W]}class Me extends te{constructor(e){super(),ne(this,e,Ye,je,Z,{files:12,currentFile:0,state:1,xlsxImporter:2})}}export{Me as F};
