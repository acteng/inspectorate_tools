import{s as De,a as v,g as k,i as x,f as m,T as Ve,e as w,c as b,m as $e,p as _,w as Je,n as me,y as Be,l as Pe,t as V,b as O,d as J,h as c,u as Ue,r as qe,v as Oe,j as Te,z as ze,K as Fe,U as Ee,x as ce,o as Ge}from"./scheduler.CT9iOTEw.js";import{S as je,i as Xe,c as B,a as G,m as j,t as g,b as y,d as X,e as Ke,g as He,f as Me}from"./index.CnK_PB-e.js";import{L as We,d as Ne}from"./download.BHaGILUs.js";import{b as pe}from"./paths.BcptqEa-.js";import"./entry.DAXh3liJ.js";import{B as Le}from"./ButtonGroup.CPR9Q03l.js";import{D as Qe}from"./DefaultButton.qd2_wY_n.js";import{F as Ze}from"./FileInput.B-XXAmlJ.js";import{R as et}from"./Radio.X_Wkl5Zy.js";/* empty css                                            */import{S as _e}from"./SecondaryButton.Bjah1jNo.js";import{W as tt}from"./WarningButton.B5FdEria.js";import{a as Re,p as lt}from"./index.CkQJ5MyU.js";import{F as nt}from"./FormElement.22zQJVbE.js";import"./index.C6xU-18q.js";function st(r){let e,l,n,a=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
    . After importing, there will still be some problems:
    <ul><li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li></ul>`,t,o;return{c(){e=w("input"),l=v(),n=w("div"),n.innerHTML=a,this.h()},l(s){e=b(s,"INPUT",{class:!0,id:!0,type:!0}),l=k(s),n=b(s,"DIV",{class:!0,"data-svelte-h":!0}),$e(n)!=="svelte-1alapt1"&&(n.innerHTML=a),this.h()},h(){_(e,"class","govuk-file-upload"),_(e,"id","import-xlsx"),_(e,"type","file"),_(n,"class","govuk-hint")},m(s,u){x(s,e,u),r[4](e),x(s,l,u),x(s,n,u),t||(o=Je(e,"change",r[2]),t=!0)},p:me,d(s){s&&(m(e),m(l),m(n)),r[4](null),t=!1,o()}}}function ot(r){let e,l,n,a;return e=new nt({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[st]},$$scope:{ctx:r}}}),n=new We({props:{loading:r[0]}}),{c(){B(e.$$.fragment),l=v(),B(n.$$.fragment)},l(t){G(e.$$.fragment,t),l=k(t),G(n.$$.fragment,t)},m(t,o){j(e,t,o),x(t,l,o),j(n,t,o),a=!0},p(t,[o]){const s={};o&66&&(s.$$scope={dirty:o,ctx:t}),e.$set(s);const u={};o&1&&(u.loading=t[0]),n.$set(u)},i(t){a||(g(e.$$.fragment,t),g(n.$$.fragment,t),a=!0)},o(t){y(e.$$.fragment,t),y(n.$$.fragment,t),a=!1},d(t){t&&m(l),X(e,t),X(n,t)}}}function rt(r,e,l){let n=Ve(),{xlsxImporter:a}=e,t="",o;async function s(E){let S=o.files[0].name;try{l(0,t=`Loading ${S}`);let F=await o.files[0].arrayBuffer(),p=await a(F);l(0,t=""),n("imported",{filename:Re(S,".xlsx"),data:p})}catch(F){window.alert(`Couldn't import ${S}: ${F}`),l(0,t="")}}function u(E){Be[E?"unshift":"push"](()=>{o=E,l(1,o)})}return r.$$set=E=>{"xlsxImporter"in E&&l(3,a=E.xlsxImporter)},[t,o,s,a,u]}class at extends je{constructor(e){super(),Xe(this,e,rt,ot,De,{xlsxImporter:3})}}function it(r){let e,l,n;return{c(){e=w("img"),n=V(`
          Export .json`),this.h()},l(a){e=b(a,"IMG",{src:!0,alt:!0,class:!0}),n=J(a,`
          Export .json`),this.h()},h(){Ge(e.src,l=Ne)||_(e,"src",l),_(e,"alt","Export .json"),_(e,"class","svelte-1ysyede")},m(a,t){x(a,e,t),x(a,n,t)},p:me,d(a){a&&(m(e),m(n))}}}function Ce(r){let e,l;return e=new _e({props:{$$slots:{default:[ft]},$$scope:{ctx:r}}}),e.$on("click",r[17]),{c(){B(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,a){j(e,n,a),l=!0},p(n,a){const t={};a&4194304&&(t.$$scope={dirty:a,ctx:n}),e.$set(t)},i(n){l||(g(e.$$.fragment,n),l=!0)},o(n){y(e.$$.fragment,n),l=!1},d(n){X(e,n)}}}function ft(r){let e,l,n;return{c(){e=w("img"),n=V(`
            Export .xlsx`),this.h()},l(a){e=b(a,"IMG",{src:!0,alt:!0,class:!0}),n=J(a,`
            Export .xlsx`),this.h()},h(){Ge(e.src,l=Ne)||_(e,"src",l),_(e,"alt","Export .xlsx"),_(e,"class","svelte-1ysyede")},m(a,t){x(a,e,t),x(a,n,t)},p:me,d(a){a&&(m(e),m(n))}}}function ut(r){let e,l,n,a;e=new _e({props:{$$slots:{default:[it]},$$scope:{ctx:r}}}),e.$on("click",r[9]);let t=r[3]&&Ce(r);return{c(){B(e.$$.fragment),l=v(),t&&t.c(),n=Fe()},l(o){G(e.$$.fragment,o),l=k(o),t&&t.l(o),n=Fe()},m(o,s){j(e,o,s),x(o,l,s),t&&t.m(o,s),x(o,n,s),a=!0},p(o,s){const u={};s&4194304&&(u.$$scope={dirty:s,ctx:o}),e.$set(u),o[3]?t?(t.p(o,s),s&8&&g(t,1)):(t=Ce(o),t.c(),g(t,1),t.m(n.parentNode,n)):t&&(He(),y(t,1,1,()=>{t=null}),Me())},i(o){a||(g(e.$$.fragment,o),g(t),a=!0)},o(o){y(e.$$.fragment,o),y(t),a=!1},d(o){o&&(m(l),m(n)),X(e,o),t&&t.d(o)}}}function ct(r){let e;return{c(){e=V("New blank file")},l(l){e=J(l,"New blank file")},m(l,n){x(l,e,n)},d(l){l&&m(e)}}}function Se(r){let e,l,n,a;return n=new at({props:{xlsxImporter:r[4]}}),n.$on("imported",r[13]),{c(){e=w("hr"),l=v(),B(n.$$.fragment)},l(t){e=b(t,"HR",{}),l=k(t),G(n.$$.fragment,t)},m(t,o){x(t,e,o),x(t,l,o),j(n,t,o),a=!0},p(t,o){const s={};o&16&&(s.xlsxImporter=t[4]),n.$set(s)},i(t){a||(g(n.$$.fragment,t),a=!0)},o(t){y(n.$$.fragment,t),a=!1},d(t){t&&(m(e),m(l)),X(n,t)}}}function mt(r){let e;return{c(){e=V("Load saved file")},l(l){e=J(l,"Load saved file")},m(l,n){x(l,e,n)},d(l){l&&m(e)}}}function dt(r){let e;return{c(){e=V("Rename saved file")},l(l){e=J(l,"Rename saved file")},m(l,n){x(l,e,n)},d(l){l&&m(e)}}}function pt(r){let e;return{c(){e=V("Delete saved file")},l(l){e=J(l,"Delete saved file")},m(l,n){x(l,e,n)},d(l){l&&m(e)}}}function $t(r){let e,l,n,a,t,o;return e=new _e({props:{$$slots:{default:[mt]},$$scope:{ctx:r}}}),e.$on("click",r[19]),n=new _e({props:{$$slots:{default:[dt]},$$scope:{ctx:r}}}),n.$on("click",r[20]),t=new tt({props:{$$slots:{default:[pt]},$$scope:{ctx:r}}}),t.$on("click",r[21]),{c(){B(e.$$.fragment),l=v(),B(n.$$.fragment),a=v(),B(t.$$.fragment)},l(s){G(e.$$.fragment,s),l=k(s),G(n.$$.fragment,s),a=k(s),G(t.$$.fragment,s)},m(s,u){j(e,s,u),x(s,l,u),j(n,s,u),x(s,a,u),j(t,s,u),o=!0},p(s,u){const E={};u&4194304&&(E.$$scope={dirty:u,ctx:s}),e.$set(E);const S={};u&4194304&&(S.$$scope={dirty:u,ctx:s}),n.$set(S);const F={};u&4194304&&(F.$$scope={dirty:u,ctx:s}),t.$set(F)},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),g(t.$$.fragment,s),o=!0)},o(s){y(e.$$.fragment,s),y(n.$$.fragment,s),y(t.$$.fragment,s),o=!1},d(s){s&&(m(l),m(a)),X(e,s),X(n,s),X(t,s)}}}function _t(r){let e,l,n,a,t,o,s,u=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,E,S,F,p,L,R,T,te,H,C,le,z,re="Create or import a file",ne,Y,ae,K,ie,P,fe,ue,M,i,I="Manage Existing Files",N,A,U,ge,he,W,we,Q,be,de,q;const ve=r[16].default,D=Pe(ve,r,r[22],null);C=new Le({props:{$$slots:{default:[ut]},$$scope:{ctx:r}}}),Y=new Qe({props:{$$slots:{default:[ct]},$$scope:{ctx:r}}}),Y.$on("click",r[11]),P=new Ze({props:{label:"Import from a .json file",onLoad:r[12]}});let $=r[4]!=null&&Se(r);function Ye(f){r[18](f)}let ke={label:"Selected file:",choices:r[6]};return r[5]!==void 0&&(ke.value=r[5]),U=new et({props:ke}),Be.push(()=>Ke(U,"value",Ye)),W=new Le({props:{$$slots:{default:[$t]},$$scope:{ctx:r}}}),{c(){e=w("div"),D&&D.c(),l=v(),n=w("hr"),a=v(),t=w("div"),o=w("div"),s=w("p"),s.textContent=u,E=v(),S=w("p"),F=w("b"),p=V("You are editing: "),L=w("a"),R=V(r[7]),te=V(`
          .`),H=v(),B(C.$$.fragment),le=v(),z=w("h2"),z.textContent=re,ne=v(),B(Y.$$.fragment),ae=v(),K=w("hr"),ie=v(),B(P.$$.fragment),fe=v(),$&&$.c(),ue=v(),M=w("div"),i=w("h2"),i.textContent=I,N=v(),A=w("div"),B(U.$$.fragment),he=v(),B(W.$$.fragment),we=v(),Q=w("a"),be=V("Back to overview"),this.h()},l(f){e=b(f,"DIV",{class:!0});var d=O(e);D&&D.l(d),l=k(d),n=b(d,"HR",{}),a=k(d),t=b(d,"DIV",{class:!0});var Z=O(t);o=b(Z,"DIV",{class:!0});var h=O(o);s=b(h,"P",{"data-svelte-h":!0}),$e(s)!=="svelte-wkz669"&&(s.textContent=u),E=k(h),S=b(h,"P",{});var se=O(S);F=b(se,"B",{});var ee=O(F);p=J(ee,"You are editing: "),L=b(ee,"A",{href:!0});var xe=O(L);R=J(xe,r[7]),xe.forEach(m),te=J(ee,`
          .`),ee.forEach(m),se.forEach(m),H=k(h),G(C.$$.fragment,h),le=k(h),z=b(h,"H2",{"data-svelte-h":!0}),$e(z)!=="svelte-1yqhw3l"&&(z.textContent=re),ne=k(h),G(Y.$$.fragment,h),ae=k(h),K=b(h,"HR",{}),ie=k(h),G(P.$$.fragment,h),fe=k(h),$&&$.l(h),h.forEach(m),ue=k(Z),M=b(Z,"DIV",{class:!0});var oe=O(M);i=b(oe,"H2",{"data-svelte-h":!0}),$e(i)!=="svelte-t00wtv"&&(i.textContent=I),N=k(oe),A=b(oe,"DIV",{class:!0});var Ie=O(A);G(U.$$.fragment,Ie),Ie.forEach(m),he=k(oe),G(W.$$.fragment,oe),oe.forEach(m),Z.forEach(m),we=k(d),Q=b(d,"A",{href:!0,class:!0});var ye=O(Q);be=J(ye,"Back to overview"),ye.forEach(m),d.forEach(m),this.h()},h(){_(L,"href",T=pe+"/"+r[0].prefix),_(o,"class","govuk-grid-column-one-half"),_(A,"class","file-radio-container svelte-1ysyede"),_(M,"class","govuk-grid-column-one-half"),_(t,"class","govuk-grid-row"),_(Q,"href",de=pe+"/"+r[0].prefix),_(Q,"class","govuk-back-link"),_(e,"class","govuk-width-container")},m(f,d){x(f,e,d),D&&D.m(e,null),c(e,l),c(e,n),c(e,a),c(e,t),c(t,o),c(o,s),c(o,E),c(o,S),c(S,F),c(F,p),c(F,L),c(L,R),c(F,te),c(o,H),j(C,o,null),c(o,le),c(o,z),c(o,ne),j(Y,o,null),c(o,ae),c(o,K),c(o,ie),j(P,o,null),c(o,fe),$&&$.m(o,null),c(t,ue),c(t,M),c(M,i),c(M,N),c(M,A),j(U,A,null),c(M,he),j(W,M,null),c(e,we),c(e,Q),c(Q,be),q=!0},p(f,[d]){D&&D.p&&(!q||d&4194304)&&Ue(D,ve,f,f[22],q?Oe(ve,f[22],d,null):qe(f[22]),null),(!q||d&128)&&Te(R,f[7]),(!q||d&1&&T!==(T=pe+"/"+f[0].prefix))&&_(L,"href",T);const Z={};d&4194312&&(Z.$$scope={dirty:d,ctx:f}),C.$set(Z);const h={};d&4194304&&(h.$$scope={dirty:d,ctx:f}),Y.$set(h),f[4]!=null?$?($.p(f,d),d&16&&g($,1)):($=Se(f),$.c(),g($,1),$.m(o,null)):$&&(He(),y($,1,1,()=>{$=null}),Me());const se={};d&64&&(se.choices=f[6]),!ge&&d&32&&(ge=!0,se.value=f[5],ze(()=>ge=!1)),U.$set(se);const ee={};d&4194336&&(ee.$$scope={dirty:d,ctx:f}),W.$set(ee),(!q||d&1&&de!==(de=pe+"/"+f[0].prefix))&&_(Q,"href",de)},i(f){q||(g(D,f),g(C.$$.fragment,f),g(Y.$$.fragment,f),g(P.$$.fragment,f),g($),g(U.$$.fragment,f),g(W.$$.fragment,f),q=!0)},o(f){y(D,f),y(C.$$.fragment,f),y(Y.$$.fragment,f),y(P.$$.fragment,f),y($),y(U.$$.fragment,f),y(W.$$.fragment,f),q=!1},d(f){f&&m(e),D&&D.d(f),X(C),X(Y),X(P),$&&$.d(),X(U),X(W)}}}function Ae(r,e){let l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),l.setAttribute("download",r),document.body.appendChild(l),l.click(),document.body.removeChild(l)}function gt(r,e,l){let n,a,t=me,o=()=>(t(),t=Ee(R,i=>l(23,a=i)),R),s,u=me,E=()=>(u(),u=Ee(L,i=>l(7,s=i)),L);r.$$.on_destroy.push(()=>t()),r.$$.on_destroy.push(()=>u());let{$$slots:S={},$$scope:F}=e,{files:p}=e,{currentFile:L}=e;E();let{state:R}=e;o();let{downloadXlsx:T=void 0}=e,{xlsxImporter:te=null}=e,H=p.getFileList(),C=H[0];function le(i){let I=window.prompt(`Rename file ${i} to what?`,i);if(I){let N=p.key(i),A=window.localStorage.getItem(N);window.localStorage.setItem(p.key(I),A),window.localStorage.removeItem(N),l(15,H=p.getFileList()),s===i&&ce(L,s=I,s)}}function z(){Ae(s+".json",JSON.stringify(a))}async function re(i){if(window.confirm(`Really delete file ${i}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let I=p.key(i);Ae(`${i}.json`,window.localStorage.getItem(I)),window.localStorage.removeItem(I),i==s?await ne():l(15,H=p.saveAndGetFileList(s,a))}}async function ne(){ce(L,s=p.newFilename(),s),ce(R,a=p.emptyState(),a),l(15,H=p.saveAndGetFileList(s,a))}async function Y(i,I){let N=Re(i,".json");try{let A=JSON.parse(I);p.validate(A),l(15,H=p.saveAndGetFileList(N,A)),await K(N)}catch(A){window.alert(`Couldn't load ${N}: ${A}`)}}async function ae(i){let{filename:I,data:N}=i.detail;l(15,H=p.saveAndGetFileList(I,N)),await K(I)}async function K(i){try{let I=p.loadFile(i);ce(L,s=i,s),ce(R,a=I,a)}catch(I){window.alert(`Couldn't load ${i}: ${I}`)}}const ie=()=>{T()};function P(i){C=i,l(5,C)}const fe=()=>{K(C)},ue=()=>{le(C)},M=()=>{re(C)};return r.$$set=i=>{"files"in i&&l(0,p=i.files),"currentFile"in i&&E(l(1,L=i.currentFile)),"state"in i&&o(l(2,R=i.state)),"downloadXlsx"in i&&l(3,T=i.downloadXlsx),"xlsxImporter"in i&&l(4,te=i.xlsxImporter),"$$scope"in i&&l(22,F=i.$$scope)},r.$$.update=()=>{r.$$.dirty&32768&&l(6,n=lt(H))},[p,L,R,T,te,C,n,s,le,z,re,ne,Y,ae,K,H,S,ie,P,fe,ue,M,F]}class Bt extends je{constructor(e){super(),Xe(this,e,gt,_t,De,{files:0,currentFile:1,state:2,downloadXlsx:3,xlsxImporter:4})}}export{Bt as F};
