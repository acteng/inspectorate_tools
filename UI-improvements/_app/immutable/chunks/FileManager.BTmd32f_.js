import{s as Me,a as I,g as y,i as _,f as m,S as Pe,e as k,c as x,b as V,p as h,w as Ye,y as He,m as le,n as re,l as Ve,t as W,d as J,q as We,h as p,u as Je,r as Re,v as qe,j as Ue,z as ze,K as ye,T as Ce,x as pe,o as Te}from"./scheduler.DCgEw1Ao.js";import{S as Be,i as Ge,c as M,a as H,m as T,t as $,b as w,d as B,e as Oe,g as be,f as ve}from"./index.DjjnUgy-.js";import{L as Ke,d as je}from"./download.J4nGWRFv.js";import{b as de}from"./paths.BJB186bc.js";import"./entry.C8mPhr0u.js";import{B as Le}from"./ButtonGroup.1IBRRAHF.js";import{D as Qe,C as Ze}from"./DefaultButton.C4OcC3Ta.js";import{F as et}from"./FileInput.ZmOgnSEy.js";import{R as tt}from"./Radio.B9HyLRff.js";/* empty css                                            */import{S as $e}from"./SecondaryButton.rPRikhyH.js";import{W as lt}from"./WarningButton.B1vq_DuO.js";import{a as Ne,p as nt}from"./index.CFRNZ8cs.js";import{F as st}from"./FormElement.Dn-JtJ5b.js";import{W as rt}from"./WarningText.BHOrhyux.js";import"./index.jPdppw_M.js";function ot(o){let e,l=`<b>You can import from an existing route check .xlsx file, only if
          there&#39;s an up-to-date DALOG sheet added.</b>`,t,s,n="<b>After importing, there will still be some problems:</b>",a,r,i=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
          imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=k("p"),e.innerHTML=l,t=I(),s=k("p"),s.innerHTML=n,a=I(),r=k("ul"),r.innerHTML=i},l(u){e=x(u,"P",{"data-svelte-h":!0}),le(e)!=="svelte-zrrwwd"&&(e.innerHTML=l),t=y(u),s=x(u,"P",{"data-svelte-h":!0}),le(s)!=="svelte-1odff57"&&(s.innerHTML=n),a=y(u),r=x(u,"UL",{"data-svelte-h":!0}),le(r)!=="svelte-12e0bkg"&&(r.innerHTML=i)},m(u,b){_(u,e,b),_(u,t,b),_(u,s,b),_(u,a,b),_(u,r,b)},p:re,d(u){u&&(m(e),m(t),m(s),m(a),m(r))}}}function at(o){let e,l,t,s,n,a,r;return s=new rt({props:{$$slots:{default:[ot]},$$scope:{ctx:o}}}),{c(){e=k("input"),l=I(),t=k("div"),M(s.$$.fragment),this.h()},l(i){e=x(i,"INPUT",{class:!0,id:!0,type:!0}),l=y(i),t=x(i,"DIV",{class:!0});var u=V(t);H(s.$$.fragment,u),u.forEach(m),this.h()},h(){h(e,"class","govuk-file-upload"),h(e,"id","import-xlsx"),h(e,"type","file"),h(t,"class","warning svelte-1klo5av")},m(i,u){_(i,e,u),o[4](e),_(i,l,u),_(i,t,u),T(s,t,null),n=!0,a||(r=Ye(e,"change",o[2]),a=!0)},p(i,u){const b={};u&64&&(b.$$scope={dirty:u,ctx:i}),s.$set(b)},i(i){n||($(s.$$.fragment,i),n=!0)},o(i){w(s.$$.fragment,i),n=!1},d(i){i&&(m(e),m(l),m(t)),o[4](null),B(s),a=!1,r()}}}function it(o){let e,l,t,s;return e=new st({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[at]},$$scope:{ctx:o}}}),t=new Ke({props:{loading:o[0]}}),{c(){M(e.$$.fragment),l=I(),M(t.$$.fragment)},l(n){H(e.$$.fragment,n),l=y(n),H(t.$$.fragment,n)},m(n,a){T(e,n,a),_(n,l,a),T(t,n,a),s=!0},p(n,[a]){const r={};a&66&&(r.$$scope={dirty:a,ctx:n}),e.$set(r);const i={};a&1&&(i.loading=n[0]),t.$set(i)},i(n){s||($(e.$$.fragment,n),$(t.$$.fragment,n),s=!0)},o(n){w(e.$$.fragment,n),w(t.$$.fragment,n),s=!1},d(n){n&&m(l),B(e,n),B(t,n)}}}function ft(o,e,l){let t=Pe(),{xlsxImporter:s}=e,n="",a;async function r(u){let b=a.files[0].name;try{l(0,n=`Loading ${b}`);let E=await a.files[0].arrayBuffer(),g=await s(E);l(0,n=""),t("imported",{filename:Ne(b,".xlsx"),data:g})}catch(E){window.alert(`Couldn't import ${b}: ${E}`),l(0,n="")}}function i(u){He[u?"unshift":"push"](()=>{a=u,l(1,a)})}return o.$$set=u=>{"xlsxImporter"in u&&l(3,s=u.xlsxImporter)},[n,a,r,s,i]}class ut extends Be{constructor(e){super(),Ge(this,e,ft,it,Me,{xlsxImporter:3})}}function ct(o){let e,l,t;return{c(){e=k("img"),t=W(`
          Export .json`),this.h()},l(s){e=x(s,"IMG",{src:!0,alt:!0,class:!0}),t=J(s,`
          Export .json`),this.h()},h(){Te(e.src,l=je)||h(e,"src",l),h(e,"alt","Export .json"),h(e,"class","svelte-tgak8e")},m(s,n){_(s,e,n),_(s,t,n)},p:re,d(s){s&&(m(e),m(t))}}}function Ee(o){let e,l;return e=new $e({props:{$$slots:{default:[mt]},$$scope:{ctx:o}}}),e.$on("click",o[17]),{c(){M(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,s){T(e,t,s),l=!0},p(t,s){const n={};s&4194304&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){w(e.$$.fragment,t),l=!1},d(t){B(e,t)}}}function mt(o){let e,l,t;return{c(){e=k("img"),t=W(`
            Export .xlsx`),this.h()},l(s){e=x(s,"IMG",{src:!0,alt:!0,class:!0}),t=J(s,`
            Export .xlsx`),this.h()},h(){Te(e.src,l=je)||h(e,"src",l),h(e,"alt","Export .xlsx"),h(e,"class","svelte-tgak8e")},m(s,n){_(s,e,n),_(s,t,n)},p:re,d(s){s&&(m(e),m(t))}}}function pt(o){let e,l,t,s;e=new $e({props:{$$slots:{default:[ct]},$$scope:{ctx:o}}}),e.$on("click",o[9]);let n=o[3]&&Ee(o);return{c(){M(e.$$.fragment),l=I(),n&&n.c(),t=ye()},l(a){H(e.$$.fragment,a),l=y(a),n&&n.l(a),t=ye()},m(a,r){T(e,a,r),_(a,l,r),n&&n.m(a,r),_(a,t,r),s=!0},p(a,r){const i={};r&4194304&&(i.$$scope={dirty:r,ctx:a}),e.$set(i),a[3]?n?(n.p(a,r),r&8&&$(n,1)):(n=Ee(a),n.c(),$(n,1),n.m(t.parentNode,t)):n&&(be(),w(n,1,1,()=>{n=null}),ve())},i(a){s||($(e.$$.fragment,a),$(n),s=!0)},o(a){w(e.$$.fragment,a),w(n),s=!1},d(a){a&&(m(l),m(t)),B(e,a),n&&n.d(a)}}}function Se(o){let e,l;return e=new Ze({props:{label:"Help with excel exports",$$slots:{default:[dt]},$$scope:{ctx:o}}}),{c(){M(e.$$.fragment)},l(t){H(e.$$.fragment,t)},m(t,s){T(e,t,s),l=!0},i(t){l||($(e.$$.fragment,t),l=!0)},o(t){w(e.$$.fragment,t),l=!1},d(t){B(e,t)}}}function dt(o){let e,l=`When you open the file, you need to force Excel to recalculate all
            formulas with Ctrl + Alt + F9. The route coordinates in the Summary
            of Scheme may not capture everything mapped when the route is split
            into multiple pieces. The map weblink only shows the route start
            point.`;return{c(){e=k("p"),e.textContent=l,this.h()},l(t){e=x(t,"P",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-atadhg"&&(e.textContent=l),this.h()},h(){h(e,"class","svelte-tgak8e")},m(t,s){_(t,e,s)},p:re,d(t){t&&m(e)}}}function $t(o){let e;return{c(){e=W("New blank file")},l(l){e=J(l,"New blank file")},m(l,t){_(l,e,t)},d(l){l&&m(e)}}}function Ae(o){let e,l,t,s;return t=new ut({props:{xlsxImporter:o[4]}}),t.$on("imported",o[13]),{c(){e=k("hr"),l=I(),M(t.$$.fragment)},l(n){e=x(n,"HR",{}),l=y(n),H(t.$$.fragment,n)},m(n,a){_(n,e,a),_(n,l,a),T(t,n,a),s=!0},p(n,a){const r={};a&16&&(r.xlsxImporter=n[4]),t.$set(r)},i(n){s||($(t.$$.fragment,n),s=!0)},o(n){w(t.$$.fragment,n),s=!1},d(n){n&&(m(e),m(l)),B(t,n)}}}function _t(o){let e;return{c(){e=W("Load selected file")},l(l){e=J(l,"Load selected file")},m(l,t){_(l,e,t)},d(l){l&&m(e)}}}function gt(o){let e;return{c(){e=W("Rename selected file")},l(l){e=J(l,"Rename selected file")},m(l,t){_(l,e,t)},d(l){l&&m(e)}}}function ht(o){let e;return{c(){e=W("Delete selected file")},l(l){e=J(l,"Delete selected file")},m(l,t){_(l,e,t)},d(l){l&&m(e)}}}function wt(o){let e,l,t,s,n,a;return e=new $e({props:{$$slots:{default:[_t]},$$scope:{ctx:o}}}),e.$on("click",o[18]),t=new $e({props:{$$slots:{default:[gt]},$$scope:{ctx:o}}}),t.$on("click",o[19]),n=new lt({props:{$$slots:{default:[ht]},$$scope:{ctx:o}}}),n.$on("click",o[20]),{c(){M(e.$$.fragment),l=I(),M(t.$$.fragment),s=I(),M(n.$$.fragment)},l(r){H(e.$$.fragment,r),l=y(r),H(t.$$.fragment,r),s=y(r),H(n.$$.fragment,r)},m(r,i){T(e,r,i),_(r,l,i),T(t,r,i),_(r,s,i),T(n,r,i),a=!0},p(r,i){const u={};i&4194304&&(u.$$scope={dirty:i,ctx:r}),e.$set(u);const b={};i&4194304&&(b.$$scope={dirty:i,ctx:r}),t.$set(b);const E={};i&4194304&&(E.$$scope={dirty:i,ctx:r}),n.$set(E)},i(r){a||($(e.$$.fragment,r),$(t.$$.fragment,r),$(n.$$.fragment,r),a=!0)},o(r){w(e.$$.fragment,r),w(t.$$.fragment,r),w(n.$$.fragment,r),a=!1},d(r){r&&(m(l),m(s)),B(e,r),B(t,r),B(n,r)}}}function bt(o){let e,l,t,s,n,a=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,r,i,u,b,E,g,j,R,ee,Y,S,N,q,ue="Create or import a file",ne,X,oe,U,z,ae,P,O,ce="Manage Existing Files",ie,f,v,D,A,_e,ge,Q,he,me,K;const we=o[16].default,G=Ve(we,o,o[22],null);Y=new Le({props:{$$slots:{default:[pt]},$$scope:{ctx:o}}});let C=o[3]&&Se(o);X=new Qe({props:{$$slots:{default:[$t]},$$scope:{ctx:o}}}),X.$on("click",o[11]),U=new et({props:{label:"Import from a .json file",onLoad:o[12]}});let F=o[4]!=null&&Ae(o);f=new Le({props:{$$slots:{default:[wt]},$$scope:{ctx:o}}});function Xe(c){o[21](c)}let ke={label:"Selected file:",choices:o[6]};return o[5]!==void 0&&(ke.value=o[5]),A=new tt({props:ke}),He.push(()=>Oe(A,"value",Xe)),{c(){e=k("div"),G&&G.c(),l=I(),t=k("div"),s=k("div"),n=k("p"),n.textContent=a,r=I(),i=k("p"),u=k("b"),b=W("You are editing: "),E=k("a"),g=W(o[7]),R=W(`
          .`),ee=I(),M(Y.$$.fragment),S=I(),C&&C.c(),N=I(),q=k("h2"),q.textContent=ue,ne=I(),M(X.$$.fragment),oe=I(),M(U.$$.fragment),z=I(),F&&F.c(),ae=I(),P=k("div"),O=k("h2"),O.textContent=ce,ie=I(),M(f.$$.fragment),v=I(),D=k("div"),M(A.$$.fragment),ge=I(),Q=k("a"),he=W("Back to overview"),this.h()},l(c){e=x(c,"DIV",{class:!0});var d=V(e);G&&G.l(d),l=y(d),t=x(d,"DIV",{class:!0});var te=V(t);s=x(te,"DIV",{class:!0});var L=V(s);n=x(L,"P",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-wkz669"&&(n.textContent=a),r=y(L),i=x(L,"P",{class:!0});var fe=V(i);u=x(fe,"B",{});var Z=V(u);b=J(Z,"You are editing: "),E=x(Z,"A",{href:!0});var xe=V(E);g=J(xe,o[7]),xe.forEach(m),R=J(Z,`
          .`),Z.forEach(m),fe.forEach(m),ee=y(L),H(Y.$$.fragment,L),S=y(L),C&&C.l(L),N=y(L),q=x(L,"H2",{"data-svelte-h":!0}),le(q)!=="svelte-1yqhw3l"&&(q.textContent=ue),ne=y(L),H(X.$$.fragment,L),oe=y(L),H(U.$$.fragment,L),z=y(L),F&&F.l(L),L.forEach(m),ae=y(te),P=x(te,"DIV",{class:!0});var se=V(P);O=x(se,"H2",{style:!0,"data-svelte-h":!0}),le(O)!=="svelte-alfbwa"&&(O.textContent=ce),ie=y(se),H(f.$$.fragment,se),v=y(se),D=x(se,"DIV",{class:!0});var Fe=V(D);H(A.$$.fragment,Fe),Fe.forEach(m),se.forEach(m),te.forEach(m),ge=y(d),Q=x(d,"A",{href:!0,class:!0});var Ie=V(Q);he=J(Ie,"Back to overview"),Ie.forEach(m),d.forEach(m),this.h()},h(){h(n,"class","svelte-tgak8e"),h(E,"href",j=de+"/"+o[0].prefix),h(i,"class","svelte-tgak8e"),h(s,"class","govuk-grid-column-two-thirds left-bar svelte-tgak8e"),We(O,"margin-top","30px"),h(D,"class","file-radio-container svelte-tgak8e"),h(P,"class","govuk-grid-column-one-third manage-existing svelte-tgak8e"),h(t,"class","govuk-grid-row"),h(Q,"href",me=de+"/"+o[0].prefix),h(Q,"class","govuk-back-link"),h(e,"class","govuk-width-container")},m(c,d){_(c,e,d),G&&G.m(e,null),p(e,l),p(e,t),p(t,s),p(s,n),p(s,r),p(s,i),p(i,u),p(u,b),p(u,E),p(E,g),p(u,R),p(s,ee),T(Y,s,null),p(s,S),C&&C.m(s,null),p(s,N),p(s,q),p(s,ne),T(X,s,null),p(s,oe),T(U,s,null),p(s,z),F&&F.m(s,null),p(t,ae),p(t,P),p(P,O),p(P,ie),T(f,P,null),p(P,v),p(P,D),T(A,D,null),p(e,ge),p(e,Q),p(Q,he),K=!0},p(c,[d]){G&&G.p&&(!K||d&4194304)&&Je(G,we,c,c[22],K?qe(we,c[22],d,null):Re(c[22]),null),(!K||d&128)&&Ue(g,c[7]),(!K||d&1&&j!==(j=de+"/"+c[0].prefix))&&h(E,"href",j);const te={};d&4194312&&(te.$$scope={dirty:d,ctx:c}),Y.$set(te),c[3]?C?d&8&&$(C,1):(C=Se(c),C.c(),$(C,1),C.m(s,N)):C&&(be(),w(C,1,1,()=>{C=null}),ve());const L={};d&4194304&&(L.$$scope={dirty:d,ctx:c}),X.$set(L),c[4]!=null?F?(F.p(c,d),d&16&&$(F,1)):(F=Ae(c),F.c(),$(F,1),F.m(s,null)):F&&(be(),w(F,1,1,()=>{F=null}),ve());const fe={};d&4194336&&(fe.$$scope={dirty:d,ctx:c}),f.$set(fe);const Z={};d&64&&(Z.choices=c[6]),!_e&&d&32&&(_e=!0,Z.value=c[5],ze(()=>_e=!1)),A.$set(Z),(!K||d&1&&me!==(me=de+"/"+c[0].prefix))&&h(Q,"href",me)},i(c){K||($(G,c),$(Y.$$.fragment,c),$(C),$(X.$$.fragment,c),$(U.$$.fragment,c),$(F),$(f.$$.fragment,c),$(A.$$.fragment,c),K=!0)},o(c){w(G,c),w(Y.$$.fragment,c),w(C),w(X.$$.fragment,c),w(U.$$.fragment,c),w(F),w(f.$$.fragment,c),w(A.$$.fragment,c),K=!1},d(c){c&&m(e),G&&G.d(c),B(Y),C&&C.d(),B(X),B(U),F&&F.d(),B(f),B(A)}}}function De(o,e){let l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),l.setAttribute("download",o),document.body.appendChild(l),l.click(),document.body.removeChild(l)}function vt(o,e,l){let t,s,n=re,a=()=>(n(),n=Ce(R,f=>l(23,s=f)),R),r,i=re,u=()=>(i(),i=Ce(j,f=>l(7,r=f)),j);o.$$.on_destroy.push(()=>n()),o.$$.on_destroy.push(()=>i());let{$$slots:b={},$$scope:E}=e,{files:g}=e,{currentFile:j}=e;u();let{state:R}=e;a();let{downloadXlsx:ee=void 0}=e,{xlsxImporter:Y=null}=e,S=g.getFileList(),N=S[0];function q(f){let v=window.prompt(`Rename file ${f} to what?`,f);if(v){let D=g.key(f),A=window.localStorage.getItem(D);window.localStorage.setItem(g.key(v),A),window.localStorage.removeItem(D),l(15,S=g.getFileList()),r===f&&pe(j,r=v,r)}}function ue(){De(r+".json",JSON.stringify(s))}async function ne(f){if(window.confirm(`Really delete file ${f}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let v=g.key(f);De(`${f}.json`,window.localStorage.getItem(v)),window.localStorage.removeItem(v),f==r?(l(15,S=g.getFileList()),S.length>0?z(S[0]):await X()):l(15,S=g.saveAndGetFileList(r,s)),l(5,N=S[0]||"")}}async function X(){let f=window.prompt("What should the file be called?","")||g.newFilename(),v=g.emptyState();l(15,S=g.saveAndGetFileList(f,v)),pe(j,r=f,r)}async function oe(f,v){let D=Ne(f,".json");try{let A=JSON.parse(v);g.validate(A),l(15,S=g.saveAndGetFileList(D,A)),await z(D)}catch(A){window.alert(`Couldn't load ${D}: ${A}`)}}async function U(f){let{filename:v,data:D}=f.detail;l(15,S=g.saveAndGetFileList(v,D)),await z(v)}async function z(f){try{let v=g.loadFile(f);pe(j,r=f,r),pe(R,s=v,s)}catch(v){window.alert(`Couldn't load ${f}: ${v}`)}}const ae=()=>{ee()},P=()=>{z(N)},O=()=>{q(N)},ce=()=>{ne(N)};function ie(f){N=f,l(5,N)}return o.$$set=f=>{"files"in f&&l(0,g=f.files),"currentFile"in f&&u(l(1,j=f.currentFile)),"state"in f&&a(l(2,R=f.state)),"downloadXlsx"in f&&l(3,ee=f.downloadXlsx),"xlsxImporter"in f&&l(4,Y=f.xlsxImporter),"$$scope"in f&&l(22,E=f.$$scope)},o.$$.update=()=>{o.$$.dirty&32768&&l(6,t=nt(S))},[g,j,R,ee,Y,N,t,r,q,ue,ne,X,oe,U,z,S,b,ae,P,O,ce,ie,E]}class jt extends Be{constructor(e){super(),Ge(this,e,vt,bt,Me,{files:0,currentFile:1,state:2,downloadXlsx:3,xlsxImporter:4})}}export{jt as F};
