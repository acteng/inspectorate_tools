import{s as Ge,a as w,g as b,i as g,f as m,T as Je,e as v,c as k,p as L,w as Ue,y as je,m as te,n as ae,l as Ve,t as R,b as z,d as Y,h as p,u as qe,r as ze,v as Oe,j as Ke,z as Qe,K as Se,U as Ae,x as _e,o as Ne}from"./scheduler.HUm1LVM6.js";import{S as Xe,i as Pe,c as D,a as M,m as T,t as $,b as x,d as B,e as Ze,g as ye,f as Fe}from"./index.AkyMFkxw.js";import{L as et,d as Re}from"./download.y9HAxvtV.js";import{b as ge}from"./paths.ZTjlkUKa.js";import"./entry.Bnoqf51_.js";import{B as He}from"./ButtonGroup.CxZ5YH2I.js";import{D as tt,C as lt}from"./DefaultButton.BFN3b5Ii.js";import{F as nt}from"./FileInput.BFFUa2Pd.js";import{R as st}from"./Radio.B6lshlQe.js";/* empty css                                            */import{S as he}from"./SecondaryButton.CW8X4T1O.js";import{W as ot}from"./WarningButton.B1bIOiwL.js";import{a as Ye,p as rt}from"./index.JveNLpGy.js";import{F as at}from"./FormElement.Cp_BUCWm.js";import{W as it}from"./WarningText.C4ojKJNl.js";import"./index.DkjrTiu9.js";function ft(a){let e,t=`<b>You can import from an existing route check .xlsx file, only if there&#39;s
        an up-to-date DALOG sheet added.</b>`,l,r,n="<b>After importing, there will still be some problems:</b>",o,s,u=`<li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li>`;return{c(){e=v("p"),e.innerHTML=t,l=w(),r=v("p"),r.innerHTML=n,o=w(),s=v("ul"),s.innerHTML=u},l(c){e=k(c,"P",{"data-svelte-h":!0}),te(e)!=="svelte-zduaft"&&(e.innerHTML=t),l=b(c),r=k(c,"P",{"data-svelte-h":!0}),te(r)!=="svelte-1odff57"&&(r.innerHTML=n),o=b(c),s=k(c,"UL",{"data-svelte-h":!0}),te(s)!=="svelte-1tt4pqo"&&(s.innerHTML=u)},m(c,F){g(c,e,F),g(c,l,F),g(c,r,F),g(c,o,F),g(c,s,F)},p:ae,d(c){c&&(m(e),m(l),m(r),m(o),m(s))}}}function ut(a){let e,t,l,r,n,o;return l=new it({props:{$$slots:{default:[ft]},$$scope:{ctx:a}}}),{c(){e=v("input"),t=w(),D(l.$$.fragment),this.h()},l(s){e=k(s,"INPUT",{class:!0,id:!0,type:!0}),t=b(s),M(l.$$.fragment,s),this.h()},h(){L(e,"class","govuk-file-upload"),L(e,"id","import-xlsx"),L(e,"type","file")},m(s,u){g(s,e,u),a[4](e),g(s,t,u),T(l,s,u),r=!0,n||(o=Ue(e,"change",a[2]),n=!0)},p(s,u){const c={};u&64&&(c.$$scope={dirty:u,ctx:s}),l.$set(c)},i(s){r||($(l.$$.fragment,s),r=!0)},o(s){x(l.$$.fragment,s),r=!1},d(s){s&&(m(e),m(t)),a[4](null),B(l,s),n=!1,o()}}}function ct(a){let e,t,l,r;return e=new at({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[ut]},$$scope:{ctx:a}}}),l=new et({props:{loading:a[0]}}),{c(){D(e.$$.fragment),t=w(),D(l.$$.fragment)},l(n){M(e.$$.fragment,n),t=b(n),M(l.$$.fragment,n)},m(n,o){T(e,n,o),g(n,t,o),T(l,n,o),r=!0},p(n,[o]){const s={};o&66&&(s.$$scope={dirty:o,ctx:n}),e.$set(s);const u={};o&1&&(u.loading=n[0]),l.$set(u)},i(n){r||($(e.$$.fragment,n),$(l.$$.fragment,n),r=!0)},o(n){x(e.$$.fragment,n),x(l.$$.fragment,n),r=!1},d(n){n&&m(t),B(e,n),B(l,n)}}}function mt(a,e,t){let l=Je(),{xlsxImporter:r}=e,n="",o;async function s(c){let F=o.files[0].name;try{t(0,n=`Loading ${F}`);let E=await o.files[0].arrayBuffer(),h=await r(E);t(0,n=""),l("imported",{filename:Ye(F,".xlsx"),data:h})}catch(E){window.alert(`Couldn't import ${F}: ${E}`),t(0,n="")}}function u(c){je[c?"unshift":"push"](()=>{o=c,t(1,o)})}return a.$$set=c=>{"xlsxImporter"in c&&t(3,r=c.xlsxImporter)},[n,o,s,r,u]}class pt extends Xe{constructor(e){super(),Pe(this,e,mt,ct,Ge,{xlsxImporter:3})}}function dt(a){let e,t,l;return{c(){e=v("img"),l=R(`
          Export .json`),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),l=Y(r,`
          Export .json`),this.h()},h(){Ne(e.src,t=Re)||L(e,"src",t),L(e,"alt","Export .json"),L(e,"class","svelte-1ysyede")},m(r,n){g(r,e,n),g(r,l,n)},p:ae,d(r){r&&(m(e),m(l))}}}function De(a){let e,t;return e=new he({props:{$$slots:{default:[$t]},$$scope:{ctx:a}}}),e.$on("click",a[17]),{c(){D(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,r){T(e,l,r),t=!0},p(l,r){const n={};r&4194304&&(n.$$scope={dirty:r,ctx:l}),e.$set(n)},i(l){t||($(e.$$.fragment,l),t=!0)},o(l){x(e.$$.fragment,l),t=!1},d(l){B(e,l)}}}function $t(a){let e,t,l;return{c(){e=v("img"),l=R(`
            Export .xlsx`),this.h()},l(r){e=k(r,"IMG",{src:!0,alt:!0,class:!0}),l=Y(r,`
            Export .xlsx`),this.h()},h(){Ne(e.src,t=Re)||L(e,"src",t),L(e,"alt","Export .xlsx"),L(e,"class","svelte-1ysyede")},m(r,n){g(r,e,n),g(r,l,n)},p:ae,d(r){r&&(m(e),m(l))}}}function _t(a){let e,t,l,r;e=new he({props:{$$slots:{default:[dt]},$$scope:{ctx:a}}}),e.$on("click",a[9]);let n=a[3]&&De(a);return{c(){D(e.$$.fragment),t=w(),n&&n.c(),l=Se()},l(o){M(e.$$.fragment,o),t=b(o),n&&n.l(o),l=Se()},m(o,s){T(e,o,s),g(o,t,s),n&&n.m(o,s),g(o,l,s),r=!0},p(o,s){const u={};s&4194304&&(u.$$scope={dirty:s,ctx:o}),e.$set(u),o[3]?n?(n.p(o,s),s&8&&$(n,1)):(n=De(o),n.c(),$(n,1),n.m(l.parentNode,l)):n&&(ye(),x(n,1,1,()=>{n=null}),Fe())},i(o){r||($(e.$$.fragment,o),$(n),r=!0)},o(o){x(e.$$.fragment,o),x(n),r=!1},d(o){o&&(m(t),m(l)),B(e,o),n&&n.d(o)}}}function Me(a){let e,t;return e=new lt({props:{label:"Help with excel exports",$$slots:{default:[gt]},$$scope:{ctx:a}}}),{c(){D(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,r){T(e,l,r),t=!0},i(l){t||($(e.$$.fragment,l),t=!0)},o(l){x(e.$$.fragment,l),t=!1},d(l){B(e,l)}}}function gt(a){let e,t=`When you open the file, you need to force Excel to recalculate all
            formulas with Ctrl + Alt + F9. The route coordinates in the Summary
            of Scheme may not capture everything mapped when the route is split
            into multiple pieces. The map weblink only shows the route start
            point.`;return{c(){e=v("p"),e.textContent=t},l(l){e=k(l,"P",{"data-svelte-h":!0}),te(e)!=="svelte-atadhg"&&(e.textContent=t)},m(l,r){g(l,e,r)},p:ae,d(l){l&&m(e)}}}function ht(a){let e;return{c(){e=R("New blank file")},l(t){e=Y(t,"New blank file")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function Te(a){let e,t,l,r;return l=new pt({props:{xlsxImporter:a[4]}}),l.$on("imported",a[13]),{c(){e=v("hr"),t=w(),D(l.$$.fragment)},l(n){e=k(n,"HR",{}),t=b(n),M(l.$$.fragment,n)},m(n,o){g(n,e,o),g(n,t,o),T(l,n,o),r=!0},p(n,o){const s={};o&16&&(s.xlsxImporter=n[4]),l.$set(s)},i(n){r||($(l.$$.fragment,n),r=!0)},o(n){x(l.$$.fragment,n),r=!1},d(n){n&&(m(e),m(t)),B(l,n)}}}function wt(a){let e;return{c(){e=R("Load selected file")},l(t){e=Y(t,"Load selected file")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function bt(a){let e;return{c(){e=R("Rename selected file")},l(t){e=Y(t,"Rename selected file")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function vt(a){let e;return{c(){e=R("Delete selected file")},l(t){e=Y(t,"Delete selected file")},m(t,l){g(t,e,l)},d(t){t&&m(e)}}}function kt(a){let e,t,l,r,n,o;return e=new he({props:{$$slots:{default:[wt]},$$scope:{ctx:a}}}),e.$on("click",a[18]),l=new he({props:{$$slots:{default:[bt]},$$scope:{ctx:a}}}),l.$on("click",a[19]),n=new ot({props:{$$slots:{default:[vt]},$$scope:{ctx:a}}}),n.$on("click",a[20]),{c(){D(e.$$.fragment),t=w(),D(l.$$.fragment),r=w(),D(n.$$.fragment)},l(s){M(e.$$.fragment,s),t=b(s),M(l.$$.fragment,s),r=b(s),M(n.$$.fragment,s)},m(s,u){T(e,s,u),g(s,t,u),T(l,s,u),g(s,r,u),T(n,s,u),o=!0},p(s,u){const c={};u&4194304&&(c.$$scope={dirty:u,ctx:s}),e.$set(c);const F={};u&4194304&&(F.$$scope={dirty:u,ctx:s}),l.$set(F);const E={};u&4194304&&(E.$$scope={dirty:u,ctx:s}),n.$set(E)},i(s){o||($(e.$$.fragment,s),$(l.$$.fragment,s),$(n.$$.fragment,s),o=!0)},o(s){x(e.$$.fragment,s),x(l.$$.fragment,s),x(n.$$.fragment,s),o=!1},d(s){s&&(m(t),m(r)),B(e,s),B(l,s),B(n,s)}}}function xt(a){let e,t,l,r,n,o,s,u=`All files are auto-saved in your browser's local storage. You can close
        your browser and resume later. You can export the file to your computer
        to share with someone else, and import from a file below.`,c,F,E,h,H,X,O,le,S,A,ne,se,W,ie="Create or import a file",fe,j,J,ue,ce,U,me,pe,i,_,N="Manage Existing Files",P,K,we,oe,V,be,ve,Q,ke,$e,q;const xe=a[16].default,G=Ve(xe,a,a[22],null);A=new He({props:{$$slots:{default:[_t]},$$scope:{ctx:a}}});let C=a[3]&&Me(a);j=new tt({props:{$$slots:{default:[ht]},$$scope:{ctx:a}}}),j.$on("click",a[11]),U=new nt({props:{label:"Import from a .json file",onLoad:a[12]}});let I=a[4]!=null&&Te(a);K=new He({props:{$$slots:{default:[kt]},$$scope:{ctx:a}}});function We(f){a[21](f)}let Ie={label:"Selected file:",choices:a[6]};return a[5]!==void 0&&(Ie.value=a[5]),V=new st({props:Ie}),je.push(()=>Ze(V,"value",We)),{c(){e=v("div"),G&&G.c(),t=w(),l=v("hr"),r=w(),n=v("div"),o=v("div"),s=v("p"),s.textContent=u,c=w(),F=v("p"),E=v("b"),h=R("You are editing: "),H=v("a"),X=R(a[7]),le=R(`
          .`),S=w(),D(A.$$.fragment),ne=w(),C&&C.c(),se=w(),W=v("h2"),W.textContent=ie,fe=w(),D(j.$$.fragment),J=w(),ue=v("hr"),ce=w(),D(U.$$.fragment),me=w(),I&&I.c(),pe=w(),i=v("div"),_=v("h2"),_.textContent=N,P=w(),D(K.$$.fragment),we=w(),oe=v("div"),D(V.$$.fragment),ve=w(),Q=v("a"),ke=R("Back to overview"),this.h()},l(f){e=k(f,"DIV",{class:!0});var d=z(e);G&&G.l(d),t=b(d),l=k(d,"HR",{}),r=b(d),n=k(d,"DIV",{class:!0});var ee=z(n);o=k(ee,"DIV",{class:!0});var y=z(o);s=k(y,"P",{"data-svelte-h":!0}),te(s)!=="svelte-wkz669"&&(s.textContent=u),c=b(y),F=k(y,"P",{});var de=z(F);E=k(de,"B",{});var Z=z(E);h=Y(Z,"You are editing: "),H=k(Z,"A",{href:!0});var Ce=z(H);X=Y(Ce,a[7]),Ce.forEach(m),le=Y(Z,`
          .`),Z.forEach(m),de.forEach(m),S=b(y),M(A.$$.fragment,y),ne=b(y),C&&C.l(y),se=b(y),W=k(y,"H2",{"data-svelte-h":!0}),te(W)!=="svelte-1yqhw3l"&&(W.textContent=ie),fe=b(y),M(j.$$.fragment,y),J=b(y),ue=k(y,"HR",{}),ce=b(y),M(U.$$.fragment,y),me=b(y),I&&I.l(y),y.forEach(m),pe=b(ee),i=k(ee,"DIV",{class:!0});var re=z(i);_=k(re,"H2",{"data-svelte-h":!0}),te(_)!=="svelte-t00wtv"&&(_.textContent=N),P=b(re),M(K.$$.fragment,re),we=b(re),oe=k(re,"DIV",{class:!0});var Le=z(oe);M(V.$$.fragment,Le),Le.forEach(m),re.forEach(m),ee.forEach(m),ve=b(d),Q=k(d,"A",{href:!0,class:!0});var Ee=z(Q);ke=Y(Ee,"Back to overview"),Ee.forEach(m),d.forEach(m),this.h()},h(){L(H,"href",O=ge+"/"+a[0].prefix),L(o,"class","govuk-grid-column-two-thirds"),L(oe,"class","file-radio-container svelte-1ysyede"),L(i,"class","govuk-grid-column-one-third"),L(n,"class","govuk-grid-row"),L(Q,"href",$e=ge+"/"+a[0].prefix),L(Q,"class","govuk-back-link"),L(e,"class","govuk-width-container")},m(f,d){g(f,e,d),G&&G.m(e,null),p(e,t),p(e,l),p(e,r),p(e,n),p(n,o),p(o,s),p(o,c),p(o,F),p(F,E),p(E,h),p(E,H),p(H,X),p(E,le),p(o,S),T(A,o,null),p(o,ne),C&&C.m(o,null),p(o,se),p(o,W),p(o,fe),T(j,o,null),p(o,J),p(o,ue),p(o,ce),T(U,o,null),p(o,me),I&&I.m(o,null),p(n,pe),p(n,i),p(i,_),p(i,P),T(K,i,null),p(i,we),p(i,oe),T(V,oe,null),p(e,ve),p(e,Q),p(Q,ke),q=!0},p(f,[d]){G&&G.p&&(!q||d&4194304)&&qe(G,xe,f,f[22],q?Oe(xe,f[22],d,null):ze(f[22]),null),(!q||d&128)&&Ke(X,f[7]),(!q||d&1&&O!==(O=ge+"/"+f[0].prefix))&&L(H,"href",O);const ee={};d&4194312&&(ee.$$scope={dirty:d,ctx:f}),A.$set(ee),f[3]?C?d&8&&$(C,1):(C=Me(f),C.c(),$(C,1),C.m(o,se)):C&&(ye(),x(C,1,1,()=>{C=null}),Fe());const y={};d&4194304&&(y.$$scope={dirty:d,ctx:f}),j.$set(y),f[4]!=null?I?(I.p(f,d),d&16&&$(I,1)):(I=Te(f),I.c(),$(I,1),I.m(o,null)):I&&(ye(),x(I,1,1,()=>{I=null}),Fe());const de={};d&4194336&&(de.$$scope={dirty:d,ctx:f}),K.$set(de);const Z={};d&64&&(Z.choices=f[6]),!be&&d&32&&(be=!0,Z.value=f[5],Qe(()=>be=!1)),V.$set(Z),(!q||d&1&&$e!==($e=ge+"/"+f[0].prefix))&&L(Q,"href",$e)},i(f){q||($(G,f),$(A.$$.fragment,f),$(C),$(j.$$.fragment,f),$(U.$$.fragment,f),$(I),$(K.$$.fragment,f),$(V.$$.fragment,f),q=!0)},o(f){x(G,f),x(A.$$.fragment,f),x(C),x(j.$$.fragment,f),x(U.$$.fragment,f),x(I),x(K.$$.fragment,f),x(V.$$.fragment,f),q=!1},d(f){f&&m(e),G&&G.d(f),B(A),C&&C.d(),B(j),B(U),I&&I.d(),B(K),B(V)}}}function Be(a,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",a),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function yt(a,e,t){let l,r,n=ae,o=()=>(n(),n=Ae(X,i=>t(23,r=i)),X),s,u=ae,c=()=>(u(),u=Ae(H,i=>t(7,s=i)),H);a.$$.on_destroy.push(()=>n()),a.$$.on_destroy.push(()=>u());let{$$slots:F={},$$scope:E}=e,{files:h}=e,{currentFile:H}=e;c();let{state:X}=e;o();let{downloadXlsx:O=void 0}=e,{xlsxImporter:le=null}=e,S=h.getFileList(),A=S[0];function ne(i){let _=window.prompt(`Rename file ${i} to what?`,i);if(_){let N=h.key(i),P=window.localStorage.getItem(N);window.localStorage.setItem(h.key(_),P),window.localStorage.removeItem(N),t(15,S=h.getFileList()),s===i&&_e(H,s=_,s)}}function se(){Be(s+".json",JSON.stringify(r))}async function W(i){if(window.confirm(`Really delete file ${i}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let _=h.key(i);Be(`${i}.json`,window.localStorage.getItem(_)),window.localStorage.removeItem(_),i==s?(t(15,S=h.getFileList()),S.length>0?J(S[0]):await ie()):t(15,S=h.saveAndGetFileList(s,r)),t(5,A=S[0]||"")}}async function ie(){let i=window.prompt("What should the file be called?","")||h.newFilename(),_=h.emptyState();t(15,S=h.saveAndGetFileList(i,_)),_e(H,s=i,s)}async function fe(i,_){let N=Ye(i,".json");try{let P=JSON.parse(_);h.validate(P),t(15,S=h.saveAndGetFileList(N,P)),await J(N)}catch(P){window.alert(`Couldn't load ${N}: ${P}`)}}async function j(i){let{filename:_,data:N}=i.detail;t(15,S=h.saveAndGetFileList(_,N)),await J(_)}async function J(i){try{let _=h.loadFile(i);_e(H,s=i,s),_e(X,r=_,r)}catch(_){window.alert(`Couldn't load ${i}: ${_}`)}}const ue=()=>{O()},ce=()=>{J(A)},U=()=>{ne(A)},me=()=>{W(A)};function pe(i){A=i,t(5,A)}return a.$$set=i=>{"files"in i&&t(0,h=i.files),"currentFile"in i&&c(t(1,H=i.currentFile)),"state"in i&&o(t(2,X=i.state)),"downloadXlsx"in i&&t(3,O=i.downloadXlsx),"xlsxImporter"in i&&t(4,le=i.xlsxImporter),"$$scope"in i&&t(22,E=i.$$scope)},a.$$.update=()=>{a.$$.dirty&32768&&t(6,l=rt(S))},[h,H,X,O,le,A,l,s,ne,se,W,ie,fe,j,J,S,F,ue,ce,U,me,pe,E]}class Pt extends Xe{constructor(e){super(),Pe(this,e,yt,xt,Ge,{files:0,currentFile:1,state:2,downloadXlsx:3,xlsxImporter:4})}}export{Pt as F};
