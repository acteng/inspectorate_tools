import{s as Ae,a as C,g as x,i as y,f as $,U as qe,e as k,c as I,m as pe,p as w,w as Ve,n as le,y as Ye,l as Ne,t as T,b as Z,d as U,h as d,j as Be,u as Te,r as Ue,v as Je,H as ze,q as Fe,ab as Ce,x as ie,o as ke}from"./scheduler.V-ByFQ7u.js";import{S as He,i as je,c as G,a as M,m as R,t as b,b as S,d as q,g as we,f as be}from"./index.Zcf2TLuh.js";import{e as xe}from"./each.BkLWSQYL.js";import{L as Xe,d as Ze}from"./download.DhJTx1nr.js";import{b as fe}from"./paths.BKTMV8OU.js";import{g as Oe}from"./entry.JT0euzsg.js";import{B as Pe}from"./ButtonGroup.DzOmczhL.js";import{D as We}from"./DefaultButton.CzxH7UXd.js";import{F as Ke}from"./FileInput.qPcioyto.js";/* empty css                                            */import{S as ve}from"./SecondaryButton.BQqRVY7L.js";import{W as Ge}from"./WarningButton.BdQPQy4u.js";import{b as Me}from"./index.sZKgQQCk.js";import{F as Qe}from"./FormElement.CMFdi_7n.js";import"./index.CqX0OBrR.js";import{C as et}from"./ClickableCard.DTtXZajF.js";const tt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000000'%3e%3cpath%20d='M200-200h57l391-391-57-57-391%20391v57Zm-80%2080v-170l528-527q12-11%2026.5-17t30.5-6q16%200%2031%206t26%2018l55%2056q12%2011%2017.5%2026t5.5%2030q0%2016-5.5%2030.5T817-647L290-120H120Zm640-584-56-56%2056%2056Zm-141%2085-28-29%2057%2057-29-28Z'/%3e%3c/svg%3e",lt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='white'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M6%2019c0%201.1.9%202%202%202h8c1.1%200%202-.9%202-2V7H6v12zM19%204h-3.5l-1-1h-5l-1%201H5v2h14V4z'/%3e%3c/svg%3e";function nt(s){let e,t,l,r=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
    . After importing, there will still be some problems:
    <ul><li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li></ul>`,n,o;return{c(){e=k("input"),t=C(),l=k("div"),l.innerHTML=r,this.h()},l(a){e=I(a,"INPUT",{class:!0,id:!0,type:!0}),t=x(a),l=I(a,"DIV",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-1alapt1"&&(l.innerHTML=r),this.h()},h(){w(e,"class","govuk-file-upload"),w(e,"id","import-xlsx"),w(e,"type","file"),w(l,"class","govuk-hint")},m(a,c){y(a,e,c),s[4](e),y(a,t,c),y(a,l,c),n||(o=Ve(e,"change",s[2]),n=!0)},p:le,d(a){a&&($(e),$(t),$(l)),s[4](null),n=!1,o()}}}function rt(s){let e,t,l,r;return e=new Qe({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[nt]},$$scope:{ctx:s}}}),l=new Xe({props:{loading:s[0]}}),{c(){G(e.$$.fragment),t=C(),G(l.$$.fragment)},l(n){M(e.$$.fragment,n),t=x(n),M(l.$$.fragment,n)},m(n,o){R(e,n,o),y(n,t,o),R(l,n,o),r=!0},p(n,[o]){const a={};o&66&&(a.$$scope={dirty:o,ctx:n}),e.$set(a);const c={};o&1&&(c.loading=n[0]),l.$set(c)},i(n){r||(b(e.$$.fragment,n),b(l.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),S(l.$$.fragment,n),r=!1},d(n){n&&$(t),q(e,n),q(l,n)}}}function st(s,e,t){let l=qe(),{xlsxImporter:r}=e,n="",o;async function a(F){let g=o.files[0].name;try{t(0,n=`Loading ${g}`);let p=await o.files[0].arrayBuffer(),_=await r(p);t(0,n=""),l("imported",{filename:Me(g,".xlsx"),data:_})}catch(p){window.alert(`Couldn't import ${g}: ${p}`),t(0,n="")}}function c(F){Ye[F?"unshift":"push"](()=>{o=F,t(1,o)})}return s.$$set=F=>{"xlsxImporter"in F&&t(3,r=F.xlsxImporter)},[n,o,a,r,c]}class ot extends He{constructor(e){super(),je(this,e,st,rt,Ae,{xlsxImporter:3})}}function Se(s,e,t){const l=s.slice();return l[20]=e[t],l}function at(s){let e,t,l;return{c(){e=k("img"),l=T(`
      Rename this file`),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),l=U(r,`
      Rename this file`),this.h()},h(){ke(e.src,t=tt)||w(e,"src",t),w(e,"alt","Rename this file"),w(e,"class","svelte-v2g1wg")},m(r,n){y(r,e,n),y(r,l,n)},p:le,d(r){r&&($(e),$(l))}}}function it(s){let e,t,l;return{c(){e=k("img"),l=T(`
      Export .json`),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),l=U(r,`
      Export .json`),this.h()},h(){ke(e.src,t=Ze)||w(e,"src",t),w(e,"alt","Export .json"),w(e,"class","svelte-v2g1wg")},m(r,n){y(r,e,n),y(r,l,n)},p:le,d(r){r&&($(e),$(l))}}}function ft(s){let e,t,l;return{c(){e=k("img"),l=T(`
      Delete this file`),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),l=U(r,`
      Delete this file`),this.h()},h(){ke(e.src,t=lt)||w(e,"src",t),w(e,"alt","Delete this file"),w(e,"class","svelte-v2g1wg")},m(r,n){y(r,e,n),y(r,l,n)},p:le,d(r){r&&($(e),$(l))}}}function ut(s){let e,t,l,r,n,o;return e=new ve({props:{$$slots:{default:[at]},$$scope:{ctx:s}}}),e.$on("click",s[6]),l=new ve({props:{$$slots:{default:[it]},$$scope:{ctx:s}}}),l.$on("click",s[7]),n=new Ge({props:{$$slots:{default:[ft]},$$scope:{ctx:s}}}),n.$on("click",s[14]),{c(){G(e.$$.fragment),t=C(),G(l.$$.fragment),r=C(),G(n.$$.fragment)},l(a){M(e.$$.fragment,a),t=x(a),M(l.$$.fragment,a),r=x(a),M(n.$$.fragment,a)},m(a,c){R(e,a,c),y(a,t,c),R(l,a,c),y(a,r,c),R(n,a,c),o=!0},p(a,c){const F={};c&262144&&(F.$$scope={dirty:c,ctx:a}),e.$set(F);const g={};c&262144&&(g.$$scope={dirty:c,ctx:a}),l.$set(g);const p={};c&262144&&(p.$$scope={dirty:c,ctx:a}),n.$set(p)},i(a){o||(b(e.$$.fragment,a),b(l.$$.fragment,a),b(n.$$.fragment,a),o=!0)},o(a){S(e.$$.fragment,a),S(l.$$.fragment,a),S(n.$$.fragment,a),o=!1},d(a){a&&($(t),$(r)),q(e,a),q(l,a),q(n,a)}}}function ct(s){let e;return{c(){e=T("New blank file")},l(t){e=U(t,"New blank file")},m(t,l){y(t,e,l)},d(t){t&&$(e)}}}function Le(s){let e,t,l,r;return l=new ot({props:{xlsxImporter:s[3]}}),l.$on("imported",s[11]),{c(){e=k("hr"),t=C(),G(l.$$.fragment)},l(n){e=I(n,"HR",{}),t=x(n),M(l.$$.fragment,n)},m(n,o){y(n,e,o),y(n,t,o),R(l,n,o),r=!0},p(n,o){const a={};o&8&&(a.xlsxImporter=n[3]),l.$set(a)},i(n){r||(b(l.$$.fragment,n),r=!0)},o(n){S(l.$$.fragment,n),r=!1},d(n){n&&($(e),$(t)),q(l,n)}}}function mt(s){let e=(s[20]==s[5]?"Currently open":s[0].describeFile(s[20]))+"",t;return{c(){t=T(e)},l(l){t=U(l,e)},m(l,r){y(l,t,r)},p(l,r){r&49&&e!==(e=(l[20]==l[5]?"Currently open":l[0].describeFile(l[20]))+"")&&Be(t,e)},d(l){l&&$(t)}}}function pt(s){let e,t;function l(){return s[17](s[20])}return e=new Ge({props:{$$slots:{default:[$t]},$$scope:{ctx:s}}}),e.$on("click",l),{c(){G(e.$$.fragment)},l(r){M(e.$$.fragment,r)},m(r,n){R(e,r,n),t=!0},p(r,n){s=r;const o={};n&262144&&(o.$$scope={dirty:n,ctx:s}),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function dt(s){let e,t;return e=new We({props:{$$slots:{default:[_t]},$$scope:{ctx:s}}}),e.$on("click",s[16]),{c(){G(e.$$.fragment)},l(l){M(e.$$.fragment,l)},m(l,r){R(e,l,r),t=!0},p(l,r){const n={};r&262144&&(n.$$scope={dirty:r,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){S(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}function $t(s){let e;return{c(){e=T("Delete")},l(t){e=U(t,"Delete")},m(t,l){y(t,e,l)},d(t){t&&$(e)}}}function _t(s){let e;return{c(){e=T("Start")},l(t){e=U(t,"Start")},m(t,l){y(t,e,l)},d(t){t&&$(e)}}}function De(s){let e,t,l,r,n,o,a;function c(){return s[15](s[20])}t=new et({props:{name:`File name: ${s[20]}`,disabled:s[20]===s[5],$$slots:{default:[mt]},$$scope:{ctx:s}}}),t.$on("click",c);const F=[dt,pt],g=[];function p(_,m){return _[20]==_[5]?0:1}return r=p(s),n=g[r]=F[r](s),{c(){e=k("div"),G(t.$$.fragment),l=C(),n.c(),o=C(),this.h()},l(_){e=I(_,"DIV",{style:!0});var m=Z(e);M(t.$$.fragment,m),l=x(m),n.l(m),o=x(m),m.forEach($),this.h()},h(){Fe(e,"display","flex"),Fe(e,"justify-content","space-between")},m(_,m){y(_,e,m),R(t,e,null),d(e,l),g[r].m(e,null),d(e,o),a=!0},p(_,m){s=_;const V={};m&16&&(V.name=`File name: ${s[20]}`),m&48&&(V.disabled=s[20]===s[5]),m&262193&&(V.$$scope={dirty:m,ctx:s}),t.$set(V);let A=r;r=p(s),r===A?g[r].p(s,m):(we(),S(g[A],1,1,()=>{g[A]=null}),be(),n=g[r],n?n.p(s,m):(n=g[r]=F[r](s),n.c()),b(n,1),n.m(e,o))},i(_){a||(b(t.$$.fragment,_),b(n),a=!0)},o(_){S(t.$$.fragment,_),S(n),a=!1},d(_){_&&$(e),q(t),g[r].d()}}}function ht(s){let e,t,l=`All files are auto-saved in your browser's local storage. You can close your
    browser and resume later. You can export the file to your computer to share
    with someone else, and import from a file below.`,r,n,o,a,c,F,g,p,_,m,V,A,ne,re,j,L,O,ue="Create or import a file",P,Y,se,oe,ae,f,D,N,B,te,Ie="Load a saved file",de,$e,W,_e,ce,X;m=new Pe({props:{$$slots:{default:[ut]},$$scope:{ctx:s}}});const he=s[13].default,H=Ne(he,s,s[18],null);Y=new ve({props:{$$slots:{default:[ct]},$$scope:{ctx:s}}}),Y.$on("click",s[9]),f=new Ke({props:{label:"Import from a .json file",onLoad:s[10]}});let v=s[3]!=null&&Le(s),K=xe(s[4]),h=[];for(let i=0;i<K.length;i+=1)h[i]=De(Se(s,K,i));const Re=i=>S(h[i],1,1,()=>{h[i]=null});return{c(){e=k("div"),t=k("p"),t.textContent=l,r=C(),n=k("p"),o=k("b"),a=T("You are editing: "),c=k("a"),F=T(s[5]),p=T(`
    .`),_=C(),G(m.$$.fragment),V=C(),H&&H.c(),A=C(),ne=k("hr"),re=C(),j=k("div"),L=k("div"),O=k("h2"),O.textContent=ue,P=C(),G(Y.$$.fragment),se=C(),oe=k("hr"),ae=C(),G(f.$$.fragment),D=C(),v&&v.c(),N=C(),B=k("div"),te=k("h2"),te.textContent=Ie,de=C();for(let i=0;i<h.length;i+=1)h[i].c();$e=C(),W=k("a"),_e=T("Back to overview"),this.h()},l(i){e=I(i,"DIV",{class:!0});var u=Z(e);t=I(u,"P",{"data-svelte-h":!0}),pe(t)!=="svelte-1yvzirp"&&(t.textContent=l),r=x(u),n=I(u,"P",{});var J=Z(n);o=I(J,"B",{});var Q=Z(o);a=U(Q,"You are editing: "),c=I(Q,"A",{href:!0});var E=Z(c);F=U(E,s[5]),E.forEach($),p=U(Q,`
    .`),Q.forEach($),J.forEach($),_=x(u),M(m.$$.fragment,u),V=x(u),H&&H.l(u),A=x(u),ne=I(u,"HR",{}),re=x(u),j=I(u,"DIV",{class:!0});var ee=Z(j);L=I(ee,"DIV",{class:!0});var z=Z(L);O=I(z,"H2",{"data-svelte-h":!0}),pe(O)!=="svelte-1yqhw3l"&&(O.textContent=ue),P=x(z),M(Y.$$.fragment,z),se=x(z),oe=I(z,"HR",{}),ae=x(z),M(f.$$.fragment,z),D=x(z),v&&v.l(z),z.forEach($),N=x(ee),B=I(ee,"DIV",{class:!0});var me=Z(B);te=I(me,"H2",{"data-svelte-h":!0}),pe(te)!=="svelte-oj70x0"&&(te.textContent=Ie),de=x(me);for(let ge=0;ge<h.length;ge+=1)h[ge].l(me);me.forEach($),ee.forEach($),$e=x(u),W=I(u,"A",{href:!0,class:!0});var ye=Z(W);_e=U(ye,"Back to overview"),ye.forEach($),u.forEach($),this.h()},h(){w(c,"href",g=fe+"/"+s[0].prefix),w(L,"class","govuk-grid-column-one-half"),w(B,"class","govuk-grid-column-one-half"),w(j,"class","govuk-grid-row"),w(W,"href",ce=fe+"/"+s[0].prefix),w(W,"class","govuk-back-link"),w(e,"class","govuk-width-container")},m(i,u){y(i,e,u),d(e,t),d(e,r),d(e,n),d(n,o),d(o,a),d(o,c),d(c,F),d(o,p),d(e,_),R(m,e,null),d(e,V),H&&H.m(e,null),d(e,A),d(e,ne),d(e,re),d(e,j),d(j,L),d(L,O),d(L,P),R(Y,L,null),d(L,se),d(L,oe),d(L,ae),R(f,L,null),d(L,D),v&&v.m(L,null),d(j,N),d(j,B),d(B,te),d(B,de);for(let J=0;J<h.length;J+=1)h[J]&&h[J].m(B,null);d(e,$e),d(e,W),d(W,_e),X=!0},p(i,[u]){(!X||u&32)&&Be(F,i[5]),(!X||u&1&&g!==(g=fe+"/"+i[0].prefix))&&w(c,"href",g);const J={};u&262176&&(J.$$scope={dirty:u,ctx:i}),m.$set(J),H&&H.p&&(!X||u&262144)&&Te(H,he,i,i[18],X?Je(he,i[18],u,null):Ue(i[18]),null);const Q={};if(u&262144&&(Q.$$scope={dirty:u,ctx:i}),Y.$set(Q),i[3]!=null?v?(v.p(i,u),u&8&&b(v,1)):(v=Le(i),v.c(),b(v,1),v.m(L,null)):v&&(we(),S(v,1,1,()=>{v=null}),be()),u&4401){K=xe(i[4]);let E;for(E=0;E<K.length;E+=1){const ee=Se(i,K,E);h[E]?(h[E].p(ee,u),b(h[E],1)):(h[E]=De(ee),h[E].c(),b(h[E],1),h[E].m(B,null))}for(we(),E=K.length;E<h.length;E+=1)Re(E);be()}(!X||u&1&&ce!==(ce=fe+"/"+i[0].prefix))&&w(W,"href",ce)},i(i){if(!X){b(m.$$.fragment,i),b(H,i),b(Y.$$.fragment,i),b(f.$$.fragment,i),b(v);for(let u=0;u<K.length;u+=1)b(h[u]);X=!0}},o(i){S(m.$$.fragment,i),S(H,i),S(Y.$$.fragment,i),S(f.$$.fragment,i),S(v),h=h.filter(Boolean);for(let u=0;u<h.length;u+=1)S(h[u]);X=!1},d(i){i&&$(e),q(m),H&&H.d(i),q(Y),q(f),v&&v.d(),ze(h,i)}}}function Ee(s,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",s),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function gt(s,e,t){let l,r=le,n=()=>(r(),r=Ce(m,f=>t(19,l=f)),m),o,a=le,c=()=>(a(),a=Ce(_,f=>t(5,o=f)),_);s.$$.on_destroy.push(()=>r()),s.$$.on_destroy.push(()=>a());let{$$slots:F={},$$scope:g}=e,{files:p}=e,{currentFile:_}=e;c();let{state:m}=e;n();let{xlsxImporter:V=null}=e,A=p.getFileList();function ne(){let f=window.prompt(`Rename file ${o} to what?`,o);if(f){let D=p.key(o),N=window.localStorage.getItem(D);window.localStorage.setItem(p.key(f),N),window.localStorage.removeItem(D),ie(_,o=f,o),t(4,A=p.getFileList())}}function re(){Ee(o+".json",JSON.stringify(l))}async function j(f){if(window.confirm(`Really delete file ${f}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let D=p.key(f);Ee(`${f}.json`,window.localStorage.getItem(D)),window.localStorage.removeItem(D),f==o?await L():t(4,A=p.saveAndGetFileList(o,l))}}async function L(){ie(_,o=p.newFilename(),o),ie(m,l=p.emptyState(),l),t(4,A=p.saveAndGetFileList(o,l))}async function O(f,D){let N=Me(f,".json");try{let B=JSON.parse(D);p.validate(B),t(4,A=p.saveAndGetFileList(N,B)),await P(N)}catch(B){window.alert(`Couldn't load ${N}: ${B}`)}}async function ue(f){let{filename:D,data:N}=f.detail;t(4,A=p.saveAndGetFileList(D,N)),await P(D)}async function P(f){try{let D=p.loadFile(f);ie(_,o=f,o),ie(m,l=D,l)}catch(D){window.alert(`Couldn't load ${f}: ${D}`)}}const Y=()=>j(o),se=f=>P(f),oe=()=>Oe(`${fe}/${p.prefix}`),ae=f=>j(f);return s.$$set=f=>{"files"in f&&t(0,p=f.files),"currentFile"in f&&c(t(1,_=f.currentFile)),"state"in f&&n(t(2,m=f.state)),"xlsxImporter"in f&&t(3,V=f.xlsxImporter),"$$scope"in f&&t(18,g=f.$$scope)},[p,_,m,V,A,o,ne,re,j,L,O,ue,P,F,Y,se,oe,ae,g]}class jt extends He{constructor(e){super(),je(this,e,gt,ht,Ae,{files:0,currentFile:1,state:2,xlsxImporter:3})}}export{jt as F};
