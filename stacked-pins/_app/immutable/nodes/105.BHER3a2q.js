import{s as Se,r as x,e as H,t as K,a as V,c as J,b as z,d as Y,f as _,g as G,q as B,v as W,i as k,h as R,w as te,k as ke,V as _e,y as wt,G as Ie,D as ie,p as ve,K as be,j as me,I as Ct,O as ue,P as pe,n as et}from"../chunks/scheduler.DGwhun8C.js";import{S as Ee,i as De,e as le,c as j,a as F,m as O,t as b,g as se,b as y,f as ae,d as U}from"../chunks/index.B2vZYn3d.js";import{g as yt}from"../chunks/globals.D0QH3NT1.js";import{e as ce}from"../chunks/each.osbS1YKp.js";import{p as It}from"../chunks/stores.BDSE0Tjr.js";import{G as Lt,S as Nt,C as tt}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.DipQICfE.js";import{C as St}from"../chunks/CheckboxGroup.CWZjIqRp.js";import{B as Et,C as lt,M as Pe}from"../chunks/Marker.B8FcGEfS.js";import{C as Dt}from"../chunks/CollapsibleCard.NCxe97a7.js";import{D as Pt}from"../chunks/DefaultButton.Dnb4gInE.js";import{I as Le,p as Bt,G as At}from"../chunks/pan.xHMZJ1t3.js";import"../chunks/SelectWithCustom.svelte_svelte_type_style_lang.D6Qfb-Pa.js";import{S as nt}from"../chunks/SecondaryButton.zQkvdoBX.js";import{W as Rt}from"../chunks/WarningButton.B3j9Frnm.js";import{p as it}from"../chunks/index.ZE5Rl5vj.js";import"../chunks/paths.DO-jWNIK.js";import"../chunks/entry.CN0CL4ry.js";import{p as Be,c as Ae}from"../chunks/colors.C4w7oha2.js";import{l as we,n as Ce,M as qt,o as Tt,G as Vt,b as Gt,C as Mt}from"../chunks/index.DRllVRx3.js";import{s as Z}from"../chunks/data.4ee7RDS1.js";import{p as jt,c as Ft,b as Re,e as qe,f as Ot,g as Ut}from"../chunks/lists.CDD60ceY.js";import{R as zt}from"../chunks/RouteMapLayer.B2KjV_MJ.js";import{R as ot}from"../chunks/Radio.CDI-pUyw.js";import{S as rt}from"../chunks/Select.BqlTf_cD.js";import{T as st}from"../chunks/TextArea.BgLWvfgB.js";import{T as at}from"../chunks/TextInput.DRqucncH.js";import{Y as ft}from"../chunks/YesNo.s_uI_VJn.js";function Te(n){let e,l,t;function i(o){n[5](o)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].policyConflictLog[n[0]].resolved!==void 0&&(s.value=n[1].policyConflictLog[n[0]].resolved),e=new ft({props:s}),x.push(()=>le(e,"value",i)),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,a){O(e,o,a),t=!0},p(o,a){const r={};!l&&a&3&&(l=!0,r.value=o[1].policyConflictLog[o[0]].resolved,te(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){U(e,o)}}}function Wt(n){let e,l,t,i,s,o,a,r,u,f,A,L,I,v,w,C,g,h,N,q,m,S;function p(c){n[2](c)}let d={label:"Policy Conflict",emptyOption:!0,choices:jt};n[1].policyConflictLog[n[0]].conflict!==void 0&&(d.value=n[1].policyConflictLog[n[0]].conflict),f=new rt({props:d}),x.push(()=>le(f,"value",p));function E(c){n[3](c)}let ee={label:"Stage",choices:it(["Existing","Design"]),inlineSmall:!0};n[1].policyConflictLog[n[0]].stage!==void 0&&(ee.value=n[1].policyConflictLog[n[0]].stage),I=new ot({props:ee}),x.push(()=>le(I,"value",E));function D(c){n[4](c)}let ne={label:"Location Name"};n[1].policyConflictLog[n[0]].locationName!==void 0&&(ne.value=n[1].policyConflictLog[n[0]].locationName),C=new at({props:ne}),x.push(()=>le(C,"value",D));let T=n[1].policyConflictLog[n[0]].stage!="Design"&&Te(n);function he(c){n[6](c)}let ge={label:"Commentary & Feedback"};return n[1].policyConflictLog[n[0]].notes!==void 0&&(ge.value=n[1].policyConflictLog[n[0]].notes),q=new st({props:ge}),x.push(()=>le(q,"value",he)),{c(){e=H("div"),l=H("a"),t=K("Google StreetView"),s=V(),o=H("a"),a=K("Bing Streetside"),u=V(),j(f.$$.fragment),L=V(),j(I.$$.fragment),w=V(),j(C.$$.fragment),h=V(),T&&T.c(),N=V(),j(q.$$.fragment),this.h()},l(c){e=J(c,"DIV",{style:!0});var P=z(e);l=J(P,"A",{href:!0,target:!0});var oe=z(l);t=Y(oe,"Google StreetView"),oe.forEach(_),s=G(P),o=J(P,"A",{href:!0,target:!0});var re=z(o);a=Y(re,"Bing Streetside"),re.forEach(_),P.forEach(_),u=G(c),F(f.$$.fragment,c),L=G(c),F(I.$$.fragment,c),w=G(c),F(C.$$.fragment,c),h=G(c),T&&T.l(c),N=G(c),F(q.$$.fragment,c),this.h()},h(){B(l,"href",i=we(n[1].policyConflictLog[n[0]].point)),B(l,"target","_blank"),B(o,"href",r=Ce(n[1].policyConflictLog[n[0]].point)),B(o,"target","_blank"),W(e,"display","flex"),W(e,"justify-content","space-evenly")},m(c,P){k(c,e,P),R(e,l),R(l,t),R(e,s),R(e,o),R(o,a),k(c,u,P),O(f,c,P),k(c,L,P),O(I,c,P),k(c,w,P),O(C,c,P),k(c,h,P),T&&T.m(c,P),k(c,N,P),O(q,c,P),S=!0},p(c,[P]){(!S||P&3&&i!==(i=we(c[1].policyConflictLog[c[0]].point)))&&B(l,"href",i),(!S||P&3&&r!==(r=Ce(c[1].policyConflictLog[c[0]].point)))&&B(o,"href",r);const oe={};!A&&P&3&&(A=!0,oe.value=c[1].policyConflictLog[c[0]].conflict,te(()=>A=!1)),f.$set(oe);const re={};!v&&P&3&&(v=!0,re.value=c[1].policyConflictLog[c[0]].stage,te(()=>v=!1)),I.$set(re);const $e={};!g&&P&3&&(g=!0,$e.value=c[1].policyConflictLog[c[0]].locationName,te(()=>g=!1)),C.$set($e),c[1].policyConflictLog[c[0]].stage!="Design"?T?(T.p(c,P),P&3&&b(T,1)):(T=Te(c),T.c(),b(T,1),T.m(N.parentNode,N)):T&&(se(),y(T,1,1,()=>{T=null}),ae());const de={};!m&&P&3&&(m=!0,de.value=c[1].policyConflictLog[c[0]].notes,te(()=>m=!1)),q.$set(de)},i(c){S||(b(f.$$.fragment,c),b(I.$$.fragment,c),b(C.$$.fragment,c),b(T),b(q.$$.fragment,c),S=!0)},o(c){y(f.$$.fragment,c),y(I.$$.fragment,c),y(C.$$.fragment,c),y(T),y(q.$$.fragment,c),S=!1},d(c){c&&(_(e),_(u),_(L),_(w),_(h),_(N)),U(f,c),U(I,c),U(C,c),T&&T.d(c),U(q,c)}}}function Ht(n,e,l){let t;ke(n,Z,f=>l(1,t=f));let{idx:i}=e;function s(f){n.$$.not_equal(t.policyConflictLog[i].conflict,f)&&(t.policyConflictLog[i].conflict=f,Z.set(t))}function o(f){n.$$.not_equal(t.policyConflictLog[i].stage,f)&&(t.policyConflictLog[i].stage=f,Z.set(t))}function a(f){n.$$.not_equal(t.policyConflictLog[i].locationName,f)&&(t.policyConflictLog[i].locationName=f,Z.set(t))}function r(f){n.$$.not_equal(t.policyConflictLog[i].resolved,f)&&(t.policyConflictLog[i].resolved=f,Z.set(t))}function u(f){n.$$.not_equal(t.policyConflictLog[i].notes,f)&&(t.policyConflictLog[i].notes=f,Z.set(t))}return n.$$set=f=>{"idx"in f&&l(0,i=f.idx)},n.$$.update=()=>{n.$$.dirty&3&&t.policyConflictLog[i].stage=="Design"&&_e(Z,t.policyConflictLog[i].resolved="",t)},[i,t,s,o,a,r,u]}class Jt extends Ee{constructor(e){super(),De(this,e,Ht,Wt,Se,{idx:0})}}function Ve(n){let e,l,t;function i(o){n[5](o)}let s={label:"Resolved by Design",inlineSmall:!0};return n[1].criticalIssues[n[0]].resolved!==void 0&&(s.value=n[1].criticalIssues[n[0]].resolved),e=new ft({props:s}),x.push(()=>le(e,"value",i)),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,a){O(e,o,a),t=!0},p(o,a){const r={};!l&&a&3&&(l=!0,r.value=o[1].criticalIssues[o[0]].resolved,te(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){U(e,o)}}}function Kt(n){let e,l,t,i,s,o,a,r,u,f,A,L,I,v,w,C,g,h,N,q,m,S;function p(c){n[2](c)}let d={label:"Critical Issue",emptyOption:!0,choices:Ft};n[1].criticalIssues[n[0]].criticalIssue!==void 0&&(d.value=n[1].criticalIssues[n[0]].criticalIssue),f=new rt({props:d}),x.push(()=>le(f,"value",p));function E(c){n[3](c)}let ee={label:"Stage",choices:it(["Existing","Design"]),inlineSmall:!0};n[1].criticalIssues[n[0]].stage!==void 0&&(ee.value=n[1].criticalIssues[n[0]].stage),I=new ot({props:ee}),x.push(()=>le(I,"value",E));function D(c){n[4](c)}let ne={label:"Location Name"};n[1].criticalIssues[n[0]].locationName!==void 0&&(ne.value=n[1].criticalIssues[n[0]].locationName),C=new at({props:ne}),x.push(()=>le(C,"value",D));let T=n[1].criticalIssues[n[0]].stage!="Design"&&Ve(n);function he(c){n[6](c)}let ge={label:"Commentary & Feedback"};return n[1].criticalIssues[n[0]].notes!==void 0&&(ge.value=n[1].criticalIssues[n[0]].notes),q=new st({props:ge}),x.push(()=>le(q,"value",he)),{c(){e=H("div"),l=H("a"),t=K("Google StreetView"),s=V(),o=H("a"),a=K("Bing Streetside"),u=V(),j(f.$$.fragment),L=V(),j(I.$$.fragment),w=V(),j(C.$$.fragment),h=V(),T&&T.c(),N=V(),j(q.$$.fragment),this.h()},l(c){e=J(c,"DIV",{style:!0});var P=z(e);l=J(P,"A",{href:!0,target:!0});var oe=z(l);t=Y(oe,"Google StreetView"),oe.forEach(_),s=G(P),o=J(P,"A",{href:!0,target:!0});var re=z(o);a=Y(re,"Bing Streetside"),re.forEach(_),P.forEach(_),u=G(c),F(f.$$.fragment,c),L=G(c),F(I.$$.fragment,c),w=G(c),F(C.$$.fragment,c),h=G(c),T&&T.l(c),N=G(c),F(q.$$.fragment,c),this.h()},h(){B(l,"href",i=we(n[1].criticalIssues[n[0]].point)),B(l,"target","_blank"),B(o,"href",r=Ce(n[1].criticalIssues[n[0]].point)),B(o,"target","_blank"),W(e,"display","flex"),W(e,"justify-content","space-evenly")},m(c,P){k(c,e,P),R(e,l),R(l,t),R(e,s),R(e,o),R(o,a),k(c,u,P),O(f,c,P),k(c,L,P),O(I,c,P),k(c,w,P),O(C,c,P),k(c,h,P),T&&T.m(c,P),k(c,N,P),O(q,c,P),S=!0},p(c,[P]){(!S||P&3&&i!==(i=we(c[1].criticalIssues[c[0]].point)))&&B(l,"href",i),(!S||P&3&&r!==(r=Ce(c[1].criticalIssues[c[0]].point)))&&B(o,"href",r);const oe={};!A&&P&3&&(A=!0,oe.value=c[1].criticalIssues[c[0]].criticalIssue,te(()=>A=!1)),f.$set(oe);const re={};!v&&P&3&&(v=!0,re.value=c[1].criticalIssues[c[0]].stage,te(()=>v=!1)),I.$set(re);const $e={};!g&&P&3&&(g=!0,$e.value=c[1].criticalIssues[c[0]].locationName,te(()=>g=!1)),C.$set($e),c[1].criticalIssues[c[0]].stage!="Design"?T?(T.p(c,P),P&3&&b(T,1)):(T=Ve(c),T.c(),b(T,1),T.m(N.parentNode,N)):T&&(se(),y(T,1,1,()=>{T=null}),ae());const de={};!m&&P&3&&(m=!0,de.value=c[1].criticalIssues[c[0]].notes,te(()=>m=!1)),q.$set(de)},i(c){S||(b(f.$$.fragment,c),b(I.$$.fragment,c),b(C.$$.fragment,c),b(T),b(q.$$.fragment,c),S=!0)},o(c){y(f.$$.fragment,c),y(I.$$.fragment,c),y(C.$$.fragment,c),y(T),y(q.$$.fragment,c),S=!1},d(c){c&&(_(e),_(u),_(L),_(w),_(h),_(N)),U(f,c),U(I,c),U(C,c),T&&T.d(c),U(q,c)}}}function Yt(n,e,l){let t;ke(n,Z,f=>l(1,t=f));let{idx:i}=e;function s(f){n.$$.not_equal(t.criticalIssues[i].criticalIssue,f)&&(t.criticalIssues[i].criticalIssue=f,Z.set(t))}function o(f){n.$$.not_equal(t.criticalIssues[i].stage,f)&&(t.criticalIssues[i].stage=f,Z.set(t))}function a(f){n.$$.not_equal(t.criticalIssues[i].locationName,f)&&(t.criticalIssues[i].locationName=f,Z.set(t))}function r(f){n.$$.not_equal(t.criticalIssues[i].resolved,f)&&(t.criticalIssues[i].resolved=f,Z.set(t))}function u(f){n.$$.not_equal(t.criticalIssues[i].notes,f)&&(t.criticalIssues[i].notes=f,Z.set(t))}return n.$$set=f=>{"idx"in f&&l(0,i=f.idx)},n.$$.update=()=>{n.$$.dirty&3&&t.criticalIssues[i].stage=="Design"&&_e(Z,t.criticalIssues[i].resolved="",t)},[i,t,s,o,a,r,u]}class Zt extends Ee{constructor(e){super(),De(this,e,Yt,Kt,Se,{idx:0})}}const{window:Xt}=yt;function Ge(n,e,l){const t=n.slice();return t[47]=e[l],t[48]=e,t[49]=l,t}function Me(n,e,l){const t=n.slice();return t[50]=e[l],t[51]=e,t[52]=l,t}function je(n,e,l){const t=n.slice();return t[53]=e[l],t[54]=e,t[52]=l,t}function Fe(n,e,l){const t=n.slice();return t[50]=e[l],t[52]=l,t}function Oe(n,e,l){const t=n.slice();return t[53]=e[l],t[52]=l,t}function Qt(n){let e,l,t,i,s,o,a,r,u,f;e=new Pt({props:{$$slots:{default:[el]},$$scope:{ctx:n}}}),e.$on("click",n[13]),t=new Rt({props:{$$slots:{default:[tl]},$$scope:{ctx:n}}}),t.$on("click",n[15]),s=new nt({props:{$$slots:{default:[ll]},$$scope:{ctx:n}}}),s.$on("click",n[12]);const A=[il,nl],L=[];function I(v,w){return v[1].id.kind=="critical"?0:1}return a=I(n),r=L[a]=A[a](n),{c(){j(e.$$.fragment),l=V(),j(t.$$.fragment),i=V(),j(s.$$.fragment),o=V(),r.c(),u=ie()},l(v){F(e.$$.fragment,v),l=G(v),F(t.$$.fragment,v),i=G(v),F(s.$$.fragment,v),o=G(v),r.l(v),u=ie()},m(v,w){O(e,v,w),k(v,l,w),O(t,v,w),k(v,i,w),O(s,v,w),k(v,o,w),L[a].m(v,w),k(v,u,w),f=!0},p(v,w){const C={};w[1]&67108864&&(C.$$scope={dirty:w,ctx:v}),e.$set(C);const g={};w[1]&67108864&&(g.$$scope={dirty:w,ctx:v}),t.$set(g);const h={};w[1]&67108864&&(h.$$scope={dirty:w,ctx:v}),s.$set(h);let N=a;a=I(v),a===N?L[a].p(v,w):(se(),y(L[N],1,1,()=>{L[N]=null}),ae(),r=L[a],r?r.p(v,w):(r=L[a]=A[a](v),r.c()),b(r,1),r.m(u.parentNode,u))},i(v){f||(b(e.$$.fragment,v),b(t.$$.fragment,v),b(s.$$.fragment,v),b(r),f=!0)},o(v){y(e.$$.fragment,v),y(t.$$.fragment,v),y(s.$$.fragment,v),y(r),f=!1},d(v){v&&(_(l),_(i),_(o),_(u)),U(e,v),U(t,v),U(s,v),L[a].d(v)}}}function xt(n){let e,l,t,i,s,o,a="Critical Issue Log",r,u,f,A,L="Policy Conflict Log",I,v;e=new Dt({props:{label:"Map tools",$$slots:{default:[sl]},$$scope:{ctx:n}}}),t=new St({props:{small:!0,$$slots:{default:[fl]},$$scope:{ctx:n}}});let w=ce(n[3].criticalIssues),C=[];for(let m=0;m<w.length;m+=1)C[m]=ze(Oe(n,w,m));const g=m=>y(C[m],1,1,()=>{C[m]=null});let h=ce(n[3].policyConflictLog),N=[];for(let m=0;m<h.length;m+=1)N[m]=He(Fe(n,h,m));const q=m=>y(N[m],1,1,()=>{N[m]=null});return{c(){j(e.$$.fragment),l=V(),j(t.$$.fragment),i=V(),s=H("div"),o=H("h3"),o.textContent=a,r=V();for(let m=0;m<C.length;m+=1)C[m].c();u=V(),f=H("div"),A=H("h3"),A.textContent=L,I=V();for(let m=0;m<N.length;m+=1)N[m].c();this.h()},l(m){F(e.$$.fragment,m),l=G(m),F(t.$$.fragment,m),i=G(m),s=J(m,"DIV",{style:!0});var S=z(s);o=J(S,"H3",{"data-svelte-h":!0}),ve(o)!=="svelte-e9mkko"&&(o.textContent=a),r=G(S);for(let d=0;d<C.length;d+=1)C[d].l(S);S.forEach(_),u=G(m),f=J(m,"DIV",{style:!0});var p=z(f);A=J(p,"H3",{"data-svelte-h":!0}),ve(A)!=="svelte-y008oc"&&(A.textContent=L),I=G(p);for(let d=0;d<N.length;d+=1)N[d].l(p);p.forEach(_),this.h()},h(){W(s,"background-color","grey"),W(s,"padding","4px"),W(f,"background-color",Be),W(f,"padding","4px")},m(m,S){O(e,m,S),k(m,l,S),O(t,m,S),k(m,i,S),k(m,s,S),R(s,o),R(s,r);for(let p=0;p<C.length;p+=1)C[p]&&C[p].m(s,null);k(m,u,S),k(m,f,S),R(f,A),R(f,I);for(let p=0;p<N.length;p+=1)N[p]&&N[p].m(f,null);v=!0},p(m,S){const p={};S[0]&97|S[1]&67108864&&(p.$$scope={dirty:S,ctx:m}),e.$set(p);const d={};if(S[0]&128|S[1]&67108864&&(d.$$scope={dirty:S,ctx:m}),t.$set(d),S[0]&133132){w=ce(m[3].criticalIssues);let E;for(E=0;E<w.length;E+=1){const ee=Oe(m,w,E);C[E]?(C[E].p(ee,S),b(C[E],1)):(C[E]=ze(ee),C[E].c(),b(C[E],1),C[E].m(s,null))}for(se(),E=w.length;E<C.length;E+=1)g(E);ae()}if(S[0]&264204){h=ce(m[3].policyConflictLog);let E;for(E=0;E<h.length;E+=1){const ee=Fe(m,h,E);N[E]?(N[E].p(ee,S),b(N[E],1)):(N[E]=He(ee),N[E].c(),b(N[E],1),N[E].m(f,null))}for(se(),E=h.length;E<N.length;E+=1)q(E);ae()}},i(m){if(!v){b(e.$$.fragment,m),b(t.$$.fragment,m);for(let S=0;S<w.length;S+=1)b(C[S]);for(let S=0;S<h.length;S+=1)b(N[S]);v=!0}},o(m){y(e.$$.fragment,m),y(t.$$.fragment,m),C=C.filter(Boolean);for(let S=0;S<C.length;S+=1)y(C[S]);N=N.filter(Boolean);for(let S=0;S<N.length;S+=1)y(N[S]);v=!1},d(m){m&&(_(l),_(i),_(s),_(u),_(f)),U(e,m),U(t,m),be(C,m),be(N,m)}}}function el(n){let e;return{c(){e=K("Save")},l(l){e=Y(l,"Save")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function tl(n){let e;return{c(){e=K("Delete")},l(l){e=Y(l,"Delete")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function ll(n){let e;return{c(){e=K("Copy")},l(l){e=Y(l,"Copy")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function nl(n){let e,l;return e=new Jt({props:{idx:n[1].id.idx}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){O(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function il(n){let e,l;return e=new Zt({props:{idx:n[1].id.idx}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){O(e,t,i),l=!0},p(t,i){const s={};i[0]&2&&(s.idx=t[1].id.idx),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function ol(n){let e;return{c(){e=K("Zoom to fit")},l(l){e=Y(l,"Zoom to fit")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function rl(n){let e;return{c(){e=K("Show route")},l(l){e=Y(l,"Show route")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function sl(n){let e,l,t,i,s,o,a,r,u,f,A,L;e=new nt({props:{$$slots:{default:[ol]},$$scope:{ctx:n}}}),e.$on("click",n[20]),t=new Et({}),s=new Lt({});function I(g){n[21](g)}let v={map:n[0]};n[5]!==void 0&&(v.enabled=n[5]),a=new Nt({props:v}),x.push(()=>le(a,"enabled",I));function w(g){n[22](g)}let C={$$slots:{default:[rl]},$$scope:{ctx:n}};return n[6]!==void 0&&(C.checked=n[6]),f=new lt({props:C}),x.push(()=>le(f,"checked",w)),{c(){j(e.$$.fragment),l=V(),j(t.$$.fragment),i=V(),j(s.$$.fragment),o=V(),j(a.$$.fragment),u=V(),j(f.$$.fragment)},l(g){F(e.$$.fragment,g),l=G(g),F(t.$$.fragment,g),i=G(g),F(s.$$.fragment,g),o=G(g),F(a.$$.fragment,g),u=G(g),F(f.$$.fragment,g)},m(g,h){O(e,g,h),k(g,l,h),O(t,g,h),k(g,i,h),O(s,g,h),k(g,o,h),O(a,g,h),k(g,u,h),O(f,g,h),L=!0},p(g,h){const N={};h[1]&67108864&&(N.$$scope={dirty:h,ctx:g}),e.$set(N);const q={};h[0]&1&&(q.map=g[0]),!r&&h[0]&32&&(r=!0,q.enabled=g[5],te(()=>r=!1)),a.$set(q);const m={};h[1]&67108864&&(m.$$scope={dirty:h,ctx:g}),!A&&h[0]&64&&(A=!0,m.checked=g[6],te(()=>A=!1)),f.$set(m)},i(g){L||(b(e.$$.fragment,g),b(t.$$.fragment,g),b(s.$$.fragment,g),b(a.$$.fragment,g),b(f.$$.fragment,g),L=!0)},o(g){y(e.$$.fragment,g),y(t.$$.fragment,g),y(s.$$.fragment,g),y(a.$$.fragment,g),y(f.$$.fragment,g),L=!1},d(g){g&&(_(l),_(i),_(o),_(u)),U(e,g),U(t,g),U(s,g),U(a,g),U(f,g)}}}function al(n){let e;return{c(){e=K("Show resolved problems")},l(l){e=Y(l,"Show resolved problems")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function fl(n){let e,l,t;function i(o){n[23](o)}let s={$$slots:{default:[al]},$$scope:{ctx:n}};return n[7]!==void 0&&(s.checked=n[7]),e=new lt({props:s}),x.push(()=>le(e,"checked",i)),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,a){O(e,o,a),t=!0},p(o,a){const r={};a[1]&67108864&&(r.$$scope={dirty:a,ctx:o}),!l&&a[0]&128&&(l=!0,r.checked=o[7],te(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){U(e,o)}}}function Ue(n){let e;function l(s,o){return s[53].resolved=="No"?ul:cl}let t=l(n),i=t(n);return{c(){i.c(),e=ie()},l(s){i.l(s),e=ie()},m(s,o){i.m(s,o),k(s,e,o)},p(s,o){t===(t=l(s))&&i?i.p(s,o):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&_(e),i.d(s)}}}function cl(n){let e,l,t=n[53].resolved+"",i;return{c(){e=H("span"),l=K("Resolved: "),i=K(t)},l(s){e=J(s,"SPAN",{});var o=z(e);l=Y(o,"Resolved: "),i=Y(o,t),o.forEach(_)},m(s,o){k(s,e,o),R(e,l),R(e,i)},p(s,o){o[0]&8&&t!==(t=s[53].resolved+"")&&me(i,t)},d(s){s&&_(e)}}}function ul(n){let e,l,t,i=n[53].resolved+"",s;return{c(){e=H("span"),l=H("b"),t=K("Resolved: "),s=K(i)},l(o){e=J(o,"SPAN",{});var a=z(e);l=J(a,"B",{});var r=z(l);t=Y(r,"Resolved: "),s=Y(r,i),r.forEach(_),a.forEach(_)},m(o,a){k(o,e,a),R(e,l),R(l,t),R(l,s)},p(o,a){a[0]&8&&i!==(i=o[53].resolved+"")&&me(s,i)},d(o){o&&_(e)}}}function pl(n){let e,l,t,i=n[53].stage+"",s,o,a,r=n[53].stage!="Design"&&Ue(n);return{c(){e=H("div"),l=H("span"),t=K("Stage: "),s=K(i),o=V(),r&&r.c(),a=V(),this.h()},l(u){e=J(u,"DIV",{style:!0});var f=z(e);l=J(f,"SPAN",{});var A=z(l);t=Y(A,"Stage: "),s=Y(A,i),A.forEach(_),o=G(f),r&&r.l(f),f.forEach(_),a=G(u),this.h()},h(){W(e,"width","100%"),W(e,"display","flex"),W(e,"justify-content","space-between")},m(u,f){k(u,e,f),R(e,l),R(l,t),R(l,s),R(e,o),r&&r.m(e,null),k(u,a,f)},p(u,f){f[0]&8&&i!==(i=u[53].stage+"")&&me(s,i),u[53].stage!="Design"?r?r.p(u,f):(r=Ue(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(_(e),_(a)),r&&r.d()}}}function ze(n){let e,l;function t(){return n[24](n[52])}function i(){return n[25](n[52])}return e=new tt({props:{name:n[17](n[53]),$$slots:{default:[pl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[26]),{c(){j(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,o){O(e,s,o),l=!0},p(s,o){n=s;const a={};o[0]&8&&(a.name=n[17](n[53])),o[0]&8|o[1]&67108864&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){y(e.$$.fragment,s),l=!1},d(s){U(e,s)}}}function We(n){let e;function l(s,o){return s[50].resolved=="No"?ml:_l}let t=l(n),i=t(n);return{c(){i.c(),e=ie()},l(s){i.l(s),e=ie()},m(s,o){i.m(s,o),k(s,e,o)},p(s,o){t===(t=l(s))&&i?i.p(s,o):(i.d(1),i=t(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&_(e),i.d(s)}}}function _l(n){let e,l,t=n[50].resolved+"",i;return{c(){e=H("span"),l=K("Resolved: "),i=K(t)},l(s){e=J(s,"SPAN",{});var o=z(e);l=Y(o,"Resolved: "),i=Y(o,t),o.forEach(_)},m(s,o){k(s,e,o),R(e,l),R(e,i)},p(s,o){o[0]&8&&t!==(t=s[50].resolved+"")&&me(i,t)},d(s){s&&_(e)}}}function ml(n){let e,l,t,i=n[50].resolved+"",s;return{c(){e=H("span"),l=H("b"),t=K("Resolved: "),s=K(i)},l(o){e=J(o,"SPAN",{});var a=z(e);l=J(a,"B",{});var r=z(l);t=Y(r,"Resolved: "),s=Y(r,i),r.forEach(_),a.forEach(_)},m(o,a){k(o,e,a),R(e,l),R(l,t),R(l,s)},p(o,a){a[0]&8&&i!==(i=o[50].resolved+"")&&me(s,i)},d(o){o&&_(e)}}}function gl(n){let e,l,t,i=n[50].stage+"",s,o,a,r=n[50].stage!="Design"&&We(n);return{c(){e=H("div"),l=H("span"),t=K("Stage: "),s=K(i),o=V(),r&&r.c(),a=V(),this.h()},l(u){e=J(u,"DIV",{style:!0});var f=z(e);l=J(f,"SPAN",{});var A=z(l);t=Y(A,"Stage: "),s=Y(A,i),A.forEach(_),o=G(f),r&&r.l(f),f.forEach(_),a=G(u),this.h()},h(){W(e,"width","100%"),W(e,"display","flex"),W(e,"justify-content","space-between")},m(u,f){k(u,e,f),R(e,l),R(l,t),R(l,s),R(e,o),r&&r.m(e,null),k(u,a,f)},p(u,f){f[0]&8&&i!==(i=u[50].stage+"")&&me(s,i),u[50].stage!="Design"?r?r.p(u,f):(r=We(u),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(u){u&&(_(e),_(a)),r&&r.d()}}}function He(n){let e,l;function t(){return n[27](n[52])}function i(){return n[28](n[52])}return e=new tt({props:{name:n[18](n[50]),$$slots:{default:[gl]},$$scope:{ctx:n}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",n[29]),{c(){j(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,o){O(e,s,o),l=!0},p(s,o){n=s;const a={};o[0]&8&&(a.name=n[18](n[50])),o[0]&8|o[1]&67108864&&(a.$$scope={dirty:o,ctx:n}),e.$set(a)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){y(e.$$.fragment,s),l=!1},d(s){U(e,s)}}}function Je(n){let e,l,t,i,s,o,a;return l=new Le({props:{$$slots:{default:[hl]},$$scope:{ctx:n}}}),l.$on("click",n[13]),i=new Le({props:{$$slots:{default:[kl]},$$scope:{ctx:n}}}),i.$on("click",n[31]),o=new Le({props:{$$slots:{default:[yl]},$$scope:{ctx:n}}}),o.$on("click",n[32]),{c(){e=H("div"),j(l.$$.fragment),t=V(),j(i.$$.fragment),s=V(),j(o.$$.fragment),this.h()},l(r){e=J(r,"DIV",{class:!0});var u=z(e);F(l.$$.fragment,u),t=G(u),F(i.$$.fragment,u),s=G(u),F(o.$$.fragment,u),u.forEach(_),this.h()},h(){B(e,"class","control-panel svelte-70vzbr")},m(r,u){k(r,e,u),O(l,e,null),R(e,t),O(i,e,null),R(e,s),O(o,e,null),a=!0},p(r,u){const f={};u[0]&2|u[1]&67108864&&(f.$$scope={dirty:u,ctx:r}),l.$set(f);const A={};u[0]&2|u[1]&67108864&&(A.$$scope={dirty:u,ctx:r}),i.$set(A);const L={};u[0]&2|u[1]&67108864&&(L.$$scope={dirty:u,ctx:r}),o.$set(L)},i(r){a||(b(l.$$.fragment,r),b(i.$$.fragment,r),b(o.$$.fragment,r),a=!0)},o(r){y(l.$$.fragment,r),y(i.$$.fragment,r),y(o.$$.fragment,r),a=!1},d(r){r&&_(e),U(l),U(i),U(o)}}}function $l(n){let e;return{c(){e=K("Move map")},l(l){e=Y(l,"Move map")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function dl(n){let e,l="Move map";return{c(){e=H("b"),e.textContent=l},l(t){e=J(t,"B",{"data-svelte-h":!0}),ve(e)!=="svelte-ydcbkl"&&(e.textContent=l)},m(t,i){k(t,e,i)},d(t){t&&_(e)}}}function hl(n){let e,l,t,i;function s(r,u){return r[1].mode=="select"?dl:$l}let o=s(n),a=o(n);return{c(){e=H("img"),t=V(),a.c(),i=ie(),this.h()},l(r){e=J(r,"IMG",{src:!0,alt:!0,style:!0}),t=G(r),a.l(r),i=ie(),this.h()},h(){Ct(e.src,l=Bt)||B(e,"src",l),B(e,"alt","Move map"),W(e,"vertical-align","middle")},m(r,u){k(r,e,u),k(r,t,u),a.m(r,u),k(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(_(e),_(t),_(i)),a.d(r)}}}function bl(n){let e;return{c(){e=K("New critical issue")},l(l){e=Y(l,"New critical issue")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function vl(n){let e,l="New critical issue";return{c(){e=H("b"),e.textContent=l},l(t){e=J(t,"B",{"data-svelte-h":!0}),ve(e)!=="svelte-1q9dhgs"&&(e.textContent=l)},m(t,i){k(t,e,i)},d(t){t&&_(e)}}}function kl(n){let e,l,t,i;function s(r,u){return r[1].mode=="new-critical"?vl:bl}let o=s(n),a=o(n);return{c(){e=ue("svg"),l=ue("rect"),t=V(),a.c(),i=ie(),this.h()},l(r){e=pe(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=z(e);l=pe(u,"rect",{width:!0,height:!0,fill:!0,class:!0}),z(l).forEach(_),u.forEach(_),t=G(r),a.l(r),i=ie(),this.h()},h(){B(l,"width","24"),B(l,"height","24"),B(l,"fill",Ae.critical.background),B(l,"class","svelte-70vzbr"),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),W(e,"vertical-align","middle")},m(r,u){k(r,e,u),R(e,l),k(r,t,u),a.m(r,u),k(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(_(e),_(t),_(i)),a.d(r)}}}function wl(n){let e;return{c(){e=K("New policy conflict")},l(l){e=Y(l,"New policy conflict")},m(l,t){k(l,e,t)},d(l){l&&_(e)}}}function Cl(n){let e,l="New policy conflict";return{c(){e=H("b"),e.textContent=l},l(t){e=J(t,"B",{"data-svelte-h":!0}),ve(e)!=="svelte-pf83jq"&&(e.textContent=l)},m(t,i){k(t,e,i)},d(t){t&&_(e)}}}function yl(n){let e,l,t,i;function s(r,u){return r[1].mode=="new-conflict"?Cl:wl}let o=s(n),a=o(n);return{c(){e=ue("svg"),l=ue("circle"),t=V(),a.c(),i=ie(),this.h()},l(r){e=pe(r,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=z(e);l=pe(u,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),z(l).forEach(_),u.forEach(_),t=G(r),a.l(r),i=ie(),this.h()},h(){B(l,"cx","12"),B(l,"cy","12"),B(l,"r","12"),B(l,"fill",Be),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),W(e,"vertical-align","middle")},m(r,u){k(r,e,u),R(e,l),k(r,t,u),a.m(r,u),k(r,i,u)},p(r,u){o!==(o=s(r))&&(a.d(1),a=o(r),a&&(a.c(),a.m(i.parentNode,i)))},d(r){r&&(_(e),_(t),_(i)),a.d(r)}}}function Ke(n){let e,l;return e=new At({props:{map:n[0],beforeId:"route-map"}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){O(e,t,i),l=!0},p(t,i){const s={};i[0]&1&&(s.map=t[0]),e.$set(s)},i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function Ye(n){let e,l,t;function i(r){n[33](r,n[53])}function s(){return n[34](n[52])}function o(){return n[35](n[52])}let a={draggable:!0,$$slots:{default:[Il]},$$scope:{ctx:n}};return n[53].point!==void 0&&(a.lngLat=n[53].point),e=new Pe({props:a}),x.push(()=>le(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",o),{c(){j(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,u){O(e,r,u),t=!0},p(r,u){n=r;const f={};u[0]&8|u[1]&67108864&&(f.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,f.lngLat=n[53].point,te(()=>l=!1)),e.$set(f)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){U(e,r)}}}function Il(n){let e,l,t,i=n[53].criticalIssue+"",s;return{c(){e=ue("svg"),l=ue("rect"),t=ue("text"),s=K(i),this.h()},l(o){e=pe(o,"svg",{width:!0,height:!0,xmlns:!0});var a=z(e);l=pe(a,"rect",{width:!0,height:!0,fill:!0,class:!0}),z(l).forEach(_),t=pe(a,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var r=z(t);s=Y(r,i),r.forEach(_),a.forEach(_),this.h()},h(){B(l,"width","40"),B(l,"height","40"),B(l,"fill",Ae.critical.background),B(l,"class","svelte-70vzbr"),B(t,"x","50%"),B(t,"y","50%"),B(t,"dominant-baseline","middle"),B(t,"text-anchor","middle"),W(t,"fill","white"),W(t,"font","bold 15px sans-serif"),B(e,"width","40"),B(e,"height","40"),B(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){k(o,e,a),R(e,l),R(e,t),R(t,s)},p(o,a){a[0]&8&&i!==(i=o[53].criticalIssue+"")&&me(s,i)},d(o){o&&_(e)}}}function Ze(n){let e=ye(n[7],n[53].resolved),l,t,i=e&&Ye(n);return{c(){i&&i.c(),l=ie()},l(s){i&&i.l(s),l=ie()},m(s,o){i&&i.m(s,o),k(s,l,o),t=!0},p(s,o){o[0]&136&&(e=ye(s[7],s[53].resolved)),e?i?(i.p(s,o),o[0]&136&&b(i,1)):(i=Ye(s),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(se(),y(i,1,1,()=>{i=null}),ae())},i(s){t||(b(i),t=!0)},o(s){y(i),t=!1},d(s){s&&_(l),i&&i.d(s)}}}function Xe(n){let e,l,t;function i(r){n[36](r,n[50])}function s(){return n[37](n[52])}function o(){return n[38](n[52])}let a={draggable:!0,$$slots:{default:[Ll]},$$scope:{ctx:n}};return n[50].point!==void 0&&(a.lngLat=n[50].point),e=new Pe({props:a}),x.push(()=>le(e,"lngLat",i)),e.$on("click",s),e.$on("dragend",o),{c(){j(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,u){O(e,r,u),t=!0},p(r,u){n=r;const f={};u[0]&8|u[1]&67108864&&(f.$$scope={dirty:u,ctx:n}),!l&&u[0]&8&&(l=!0,f.lngLat=n[50].point,te(()=>l=!1)),e.$set(f)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){U(e,r)}}}function Ll(n){let e,l=n[50].conflict+"",t;return{c(){e=H("span"),t=K(l),this.h()},l(i){e=J(i,"SPAN",{class:!0});var s=z(e);t=Y(s,l),s.forEach(_),this.h()},h(){B(e,"class","dot svelte-70vzbr"),W(e,"background",Be)},m(i,s){k(i,e,s),R(e,t)},p(i,s){s[0]&8&&l!==(l=i[50].conflict+"")&&me(t,l)},d(i){i&&_(e)}}}function Qe(n){let e=ye(n[7],n[50].resolved),l,t,i=e&&Xe(n);return{c(){i&&i.c(),l=ie()},l(s){i&&i.l(s),l=ie()},m(s,o){i&&i.m(s,o),k(s,l,o),t=!0},p(s,o){o[0]&136&&(e=ye(s[7],s[50].resolved)),e?i?(i.p(s,o),o[0]&136&&b(i,1)):(i=Xe(s),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(se(),y(i,1,1,()=>{i=null}),ae())},i(s){t||(b(i),t=!0)},o(s){y(i),t=!1},d(s){s&&_(l),i&&i.d(s)}}}function Nl(n){let e,l,t,i=" Stack",s;return{c(){e=ue("svg"),l=ue("polygon"),t=ue("text"),s=K(i),this.h()},l(o){e=pe(o,"svg",{width:!0,height:!0,xmlns:!0});var a=z(e);l=pe(a,"polygon",{points:!0,fill:!0,stroke:!0}),z(l).forEach(_),t=pe(a,"text",{x:!0,y:!0,"dominant-baseline":!0,"text-anchor":!0});var r=z(t);s=Y(r,i),r.forEach(_),a.forEach(_),this.h()},h(){B(l,"points","0,22.5 27,0 55,0 55,55 27,55"),B(l,"fill",Ae.stackIndicator.background),B(l,"stroke","white"),B(t,"x","50%"),B(t,"y","50%"),B(t,"dominant-baseline","middle"),B(t,"text-anchor","middle"),W(t,"fill","white"),W(t,"font","bold 15px sans-serif"),B(e,"width","55"),B(e,"height","55"),B(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){k(o,e,a),R(e,l),R(e,t),R(t,s)},p:et,d(o){o&&_(e)}}}function xe(n){let e,l,t;function i(o){n[39](o,n[47],n[48],n[49])}let s={draggable:!0,$$slots:{default:[Nl]},$$scope:{ctx:n}};return n[47]!==void 0&&(s.lngLat=n[47]),e=new Pe({props:s}),x.push(()=>le(e,"lngLat",i)),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,a){O(e,o,a),t=!0},p(o,a){n=o;const r={};a[1]&67108864&&(r.$$scope={dirty:a,ctx:n}),!l&&a[0]&256&&(l=!0,r.lngLat=n[47],te(()=>l=!1)),e.$set(r)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){U(e,o)}}}function Sl(n){let e,l;return e=new Mt({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){O(e,t,i),l=!0},p:et,i(t){l||(b(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){U(e,t)}}}function El(n){let e,l,t,i,s,o,a,r,u,f,A;e=new Tt({}),e.$on("click",n[14]);let L=n[1].mode!="editing"&&Je(n);i=new zt({props:{show:n[6],id:"route-map"}});let I=n[0]&&Ke(n),v=ce(n[3].criticalIssues),w=[];for(let p=0;p<v.length;p+=1)w[p]=Ze(je(n,v,p));const C=p=>y(w[p],1,1,()=>{w[p]=null});let g=ce(n[3].policyConflictLog),h=[];for(let p=0;p<g.length;p+=1)h[p]=Qe(Me(n,g,p));const N=p=>y(h[p],1,1,()=>{h[p]=null});let q=ce(n[8]),m=[];for(let p=0;p<q.length;p+=1)m[p]=xe(Ge(n,q,p));const S=p=>y(m[p],1,1,()=>{m[p]=null});return f=new Vt({props:{data:n[9],$$slots:{default:[Sl]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment),l=V(),L&&L.c(),t=V(),j(i.$$.fragment),s=V(),I&&I.c(),o=V();for(let p=0;p<w.length;p+=1)w[p].c();a=V();for(let p=0;p<h.length;p+=1)h[p].c();r=V();for(let p=0;p<m.length;p+=1)m[p].c();u=V(),j(f.$$.fragment)},l(p){F(e.$$.fragment,p),l=G(p),L&&L.l(p),t=G(p),F(i.$$.fragment,p),s=G(p),I&&I.l(p),o=G(p);for(let d=0;d<w.length;d+=1)w[d].l(p);a=G(p);for(let d=0;d<h.length;d+=1)h[d].l(p);r=G(p);for(let d=0;d<m.length;d+=1)m[d].l(p);u=G(p),F(f.$$.fragment,p)},m(p,d){O(e,p,d),k(p,l,d),L&&L.m(p,d),k(p,t,d),O(i,p,d),k(p,s,d),I&&I.m(p,d),k(p,o,d);for(let E=0;E<w.length;E+=1)w[E]&&w[E].m(p,d);k(p,a,d);for(let E=0;E<h.length;E+=1)h[E]&&h[E].m(p,d);k(p,r,d);for(let E=0;E<m.length;E+=1)m[E]&&m[E].m(p,d);k(p,u,d),O(f,p,d),A=!0},p(p,d){p[1].mode!="editing"?L?(L.p(p,d),d[0]&2&&b(L,1)):(L=Je(p),L.c(),b(L,1),L.m(t.parentNode,t)):L&&(se(),y(L,1,1,()=>{L=null}),ae());const E={};if(d[0]&64&&(E.show=p[6]),i.$set(E),p[0]?I?(I.p(p,d),d[0]&1&&b(I,1)):(I=Ke(p),I.c(),b(I,1),I.m(o.parentNode,o)):I&&(se(),y(I,1,1,()=>{I=null}),ae()),d[0]&1160){v=ce(p[3].criticalIssues);let D;for(D=0;D<v.length;D+=1){const ne=je(p,v,D);w[D]?(w[D].p(ne,d),b(w[D],1)):(w[D]=Ze(ne),w[D].c(),b(w[D],1),w[D].m(a.parentNode,a))}for(se(),D=v.length;D<w.length;D+=1)C(D);ae()}if(d[0]&1160){g=ce(p[3].policyConflictLog);let D;for(D=0;D<g.length;D+=1){const ne=Me(p,g,D);h[D]?(h[D].p(ne,d),b(h[D],1)):(h[D]=Qe(ne),h[D].c(),b(h[D],1),h[D].m(r.parentNode,r))}for(se(),D=g.length;D<h.length;D+=1)N(D);ae()}if(d[0]&256){q=ce(p[8]);let D;for(D=0;D<q.length;D+=1){const ne=Ge(p,q,D);m[D]?(m[D].p(ne,d),b(m[D],1)):(m[D]=xe(ne),m[D].c(),b(m[D],1),m[D].m(u.parentNode,u))}for(se(),D=q.length;D<m.length;D+=1)S(D);ae()}const ee={};d[0]&512&&(ee.data=p[9]),d[1]&67108864&&(ee.$$scope={dirty:d,ctx:p}),f.$set(ee)},i(p){if(!A){b(e.$$.fragment,p),b(L),b(i.$$.fragment,p),b(I);for(let d=0;d<v.length;d+=1)b(w[d]);for(let d=0;d<g.length;d+=1)b(h[d]);for(let d=0;d<q.length;d+=1)b(m[d]);b(f.$$.fragment,p),A=!0}},o(p){y(e.$$.fragment,p),y(L),y(i.$$.fragment,p),y(I),w=w.filter(Boolean);for(let d=0;d<w.length;d+=1)y(w[d]);h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)y(h[d]);m=m.filter(Boolean);for(let d=0;d<m.length;d+=1)y(m[d]);y(f.$$.fragment,p),A=!1},d(p){p&&(_(l),_(t),_(s),_(o),_(a),_(r),_(u)),U(e,p),L&&L.d(p),U(i,p),I&&I.d(p),be(w,p),be(h,p),be(m,p),U(f,p)}}}function Dl(n){let e,l,t,i,s,o,a,r,u,f,A;const L=[xt,Qt],I=[];function v(g,h){return g[1].mode!="editing"?0:1}t=v(n),i=I[t]=L[t](n);function w(g){n[40](g)}let C={$$slots:{default:[El]},$$scope:{ctx:n}};return n[0]!==void 0&&(C.map=n[0]),a=new qt({props:C}),x.push(()=>le(a,"map",w)),{c(){e=H("div"),l=H("div"),i.c(),s=V(),o=H("div"),j(a.$$.fragment),this.h()},l(g){e=J(g,"DIV",{style:!0});var h=z(e);l=J(h,"DIV",{style:!0});var N=z(l);i.l(N),N.forEach(_),s=G(h),o=J(h,"DIV",{style:!0});var q=z(o);F(a.$$.fragment,q),q.forEach(_),h.forEach(_),this.h()},h(){W(l,"width","30%"),W(l,"overflow-y","scroll"),W(l,"padding","10px"),W(l,"border","1px solid black"),W(o,"position","relative"),W(o,"width","70%"),W(e,"display","flex"),W(e,"height","80vh")},m(g,h){k(g,e,h),R(e,l),I[t].m(l,null),n[30](l),R(e,s),R(e,o),O(a,o,null),u=!0,f||(A=wt(Xt,"keydown",n[19]),f=!0)},p(g,h){let N=t;t=v(g),t===N?I[t].p(g,h):(se(),y(I[N],1,1,()=>{I[N]=null}),ae(),i=I[t],i?i.p(g,h):(i=I[t]=L[t](g),i.c()),b(i,1),i.m(l,null));const q={};h[0]&971|h[1]&67108864&&(q.$$scope={dirty:h,ctx:g}),!r&&h[0]&1&&(r=!0,q.map=g[0],te(()=>r=!1)),a.$set(q)},i(g){u||(b(i),b(a.$$.fragment,g),u=!0)},o(g){y(i),y(a.$$.fragment,g),u=!1},d(g){g&&_(e),I[t].d(),n[30](null),U(a),f=!1,A()}}}function Pl(n,e,l){let t={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:l;if(i!=null){let s=i.kind=="critical"?n.criticalIssues:n.policyConflictLog;t.features.push(Ne(s[i.idx].point))}return t}function Ne(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function ye(n,e){return n||e!="Yes"}function Bl(n,e,l){let t,i,s;ke(n,Z,$=>l(3,i=$)),ke(n,It,$=>l(42,s=$));let o,a,r={mode:"select"},u=s.url.searchParams.get("kind")||"";u=="critical"?r={mode:"new-critical"}:u=="conflict"&&(r={mode:"new-conflict"});let f=null,A=null,L=!1,I=!0,v=!0,w=[];async function C($){f=a.scrollTop,l(1,r={mode:"editing",id:$}),l(2,A=null),await Ie(),l(4,a.scrollTop=0,a)}async function g($){f=a.scrollTop,l(1,r={mode:"editing",id:$}),l(2,A=null),await Ie(),l(4,a.scrollTop=0,a);let M=$.kind=="critical"?i.criticalIssues:i.policyConflictLog;o==null||o.flyTo({center:M[$.idx].point,duration:500})}async function h(){if(r.mode!="editing"||!o)return;let $=r.id,M=$.kind=="critical"?i.criticalIssues:i.policyConflictLog,X=JSON.parse(JSON.stringify(M[$.idx]));X.point=N(X.point);let Q=M.toSpliced($.idx+1,0,X);$.kind=="critical"?_e(Z,i.criticalIssues=Q,i):_e(Z,i.policyConflictLog=Q,i),await C({kind:$.kind,idx:$.idx+1})}function N($){if(!o)return $;let M=o.getBounds().getWest(),X=o.getBounds().getEast();return[$[0]+(X-M)*.1,$[1]]}async function q(){l(1,r={mode:"select"}),m(),f!=null&&(await Ie(),l(4,a.scrollTop=f,a),f=null)}function m(){_e(Z,i.policyConflictLog=i.policyConflictLog.toSorted(($,M)=>Re($.conflict)-Re(M.conflict)),i),_e(Z,i.criticalIssues=i.criticalIssues.toSorted(($,M)=>qe($.criticalIssue)-qe(M.criticalIssue)),i),l(8,w=ne(i.criticalIssues,i.policyConflictLog))}function S($){if(!L&&r.mode!="select"){if(r.mode=="editing"){q();return}r.mode=="new-critical"?(_e(Z,i.criticalIssues=[...i.criticalIssues,{criticalIssue:s.url.searchParams.get("code")||"",stage:"",point:$.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),C({kind:"critical",idx:i.criticalIssues.length-1})):r.mode=="new-conflict"&&(_e(Z,i.policyConflictLog=[...i.policyConflictLog,{conflict:s.url.searchParams.get("code")||"",stage:"",point:$.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),C({kind:"conflict",idx:i.policyConflictLog.length-1}))}}function p(){r.mode=="editing"&&window.confirm("Delete this entry?")&&(r.id.kind=="critical"?(i.criticalIssues.splice(r.id.idx,1),Z.set(i)):(i.policyConflictLog.splice(r.id.idx,1),Z.set(i)),q())}function d($){if(!o)return;let M={type:"FeatureCollection",features:[...i.criticalIssues.map(X=>Ne(X.point)),...i.policyConflictLog.map(X=>Ne(X.point)),...i.summary.networkMap.features]};M.features.length>0&&o.fitBounds(Gt(M),{padding:20,animate:$})}function E($){let M=$.criticalIssue?Ot($.criticalIssue):"Unknown critical";return $.locationName?`${M} (${$.locationName})`:M}function ee($){let M=$.conflict?"PO0"+Ut($.conflict):"Unknown conflict";return $.locationName?`${M} (${$.locationName})`:M}function D($){if(r.mode=="editing"){let M=$.target.tagName,X=M=="INPUT"||M=="TEXTAREA";$.key=="Escape"||$.key=="Enter"&&!X?($.stopPropagation(),q()):$.key=="Delete"&&!X&&($.stopPropagation(),p())}else(r.mode=="new-critical"||r.mode=="new-conflict")&&$.key=="Escape"&&($.stopPropagation(),l(1,r={mode:"select"}))}function ne($,M){let X=[];for(let Q=0;Q<$.length-1;Q++)for(let fe=Q+1;fe<$.length;fe++)$[Q].point[0]===$[fe].point[0]&&$[Q].point[1]===$[fe].point[1]&&X.push($[Q].point);for(let Q=0;Q<M.length-1;Q++)for(let fe=Q+1;fe<M.length;fe++)M[Q].point[0]===M[fe].point[0]&&M[Q].point[1]===M[fe].point[1]&&X.push(M[Q].point);return o&&X.forEach((Q,fe)=>{X[fe]=N(Q)}),X}const T=()=>d(!0);function he($){L=$,l(5,L)}function ge($){I=$,l(6,I)}function c($){v=$,l(7,v)}const P=$=>g({kind:"critical",idx:$}),oe=$=>l(2,A={kind:"critical",idx:$}),re=()=>l(2,A=null),$e=$=>g({kind:"conflict",idx:$}),de=$=>l(2,A={kind:"conflict",idx:$}),ct=()=>l(2,A=null);function ut($){x[$?"unshift":"push"](()=>{a=$,l(4,a)})}const pt=()=>l(1,r={mode:"new-critical"}),_t=()=>l(1,r={mode:"new-conflict"});function mt($,M){n.$$.not_equal(M.point,$)&&(M.point=$,Z.set(i))}const gt=$=>C({kind:"critical",idx:$}),$t=$=>C({kind:"critical",idx:$});function dt($,M){n.$$.not_equal(M.point,$)&&(M.point=$,Z.set(i))}const ht=$=>C({kind:"conflict",idx:$}),bt=$=>C({kind:"conflict",idx:$});function vt($,M,X,Q){X[Q]=$,l(8,w)}function kt($){o=$,l(0,o)}return n.$$.update=()=>{n.$$.dirty[0]&1&&o&&d(!1),n.$$.dirty[0]&3&&o&&(o.getCanvas().style.cursor=r.mode=="new-critical"||r.mode=="new-conflict"?"crosshair":"auto",m()),n.$$.dirty[0]&14&&l(9,t=Pl(i,r,A))},[o,r,A,i,a,L,I,v,w,t,C,g,h,q,S,p,d,E,ee,D,T,he,ge,c,P,oe,re,$e,de,ct,ut,pt,_t,mt,gt,$t,dt,ht,bt,vt,kt]}class sn extends Ee{constructor(e){super(),De(this,e,Bl,Dl,Se,{},null,[-1,-1])}}export{sn as component};
