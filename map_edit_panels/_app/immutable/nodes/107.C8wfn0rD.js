import{s as ye,w as Z,e as J,t as O,a as P,c as K,b as H,d as U,f as v,g as B,p as R,q as W,i as L,h as V,x as z,k as ge,B as rt,R as at,W as be,T as ce,F as $e,m as Ne,G as de,j as ue,n as ft,K as ke,L as we}from"../chunks/scheduler.D5JRtHaf.js";import{S as Ie,i as Le,e as Y,c as T,a as q,m as A,t as C,g as te,b as I,f as le,d as j}from"../chunks/index.Xm1AgzMF.js";import{j as he,k as ve,M as ct,l as ut,b as pt,C as mt,G as _t,m as gt}from"../chunks/index.C6oD4K9R.js";import{e as ie}from"../chunks/each.C9BadmQM.js";import{c as $t,p as dt}from"../chunks/colors.DaC397qr.js";import{p as We}from"../chunks/index.euwPAUIz.js";import{R as He}from"../chunks/Radio.BjpWuuOn.js";import{S as Je}from"../chunks/Select.DCCD1fdE.js";/* empty css                                                    */import{T as Ke}from"../chunks/TextArea.Ct1XwDet.js";import{T as Ze}from"../chunks/TextInput.Cluermb4.js";import{s as F}from"../chunks/data.MPRT3Tyd.js";import{c as ht,p as vt,b as Ee,e as De,f as bt,g as kt}from"../chunks/lists.BvURpO7c.js";import{Y as ze}from"../chunks/YesNo.DSeRMn8J.js";import{B as wt,G as Ct,S as yt,C as It,a as Lt,M as Ye}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.DR5CFhBb.js";import{C as St}from"../chunks/CollapsibleCard.D0GavHKp.js";import{D as Nt}from"../chunks/DefaultButton.BHwS446X.js";import{S as _e}from"../chunks/SecondaryButton.DxO4nu9r.js";import{W as Et}from"../chunks/WarningButton.jEqntaGg.js";import{G as Dt}from"../chunks/GeoreferenceLayer.BMRum4N4.js";import{C as Xe}from"../chunks/ClickableCard.BhW8XYpY.js";import"../chunks/paths.BMlUtJV4.js";import{p as Pt}from"../chunks/stores.jt6h3I2_.js";function Pe(t){let e,l,n;function i(r){t[5](r)}let f={label:"Resolved by Design",inlineSmall:!0};return t[1].criticalIssues[t[0]].resolved!==void 0&&(f.value=t[1].criticalIssues[t[0]].resolved),e=new ze({props:f}),Z.push(()=>Y(e,"value",i)),{c(){T(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,c){A(e,r,c),n=!0},p(r,c){const o={};!l&&c&3&&(l=!0,o.value=r[1].criticalIssues[r[0]].resolved,z(()=>l=!1)),e.$set(o)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){I(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function Bt(t){let e,l,n,i,f,r,c,o,_,u,N,b,h,$,S,k,p,m,s,g,w,M;function ne(a){t[2](a)}let D={label:"Critical Issue",emptyOption:!0,choices:ht};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(D.value=t[1].criticalIssues[t[0]].criticalIssue),u=new Je({props:D}),Z.push(()=>Y(u,"value",ne));function x(a){t[3](a)}let oe={legend:"Stage",choices:We(["Existing","Design"]),inlineSmall:!0};t[1].criticalIssues[t[0]].stage!==void 0&&(oe.value=t[1].criticalIssues[t[0]].stage),h=new He({props:oe}),Z.push(()=>Y(h,"value",x));function pe(a){t[4](a)}let se={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(se.value=t[1].criticalIssues[t[0]].locationName),k=new Ze({props:se}),Z.push(()=>Y(k,"value",pe));let E=t[1].criticalIssues[t[0]].stage!="Design"&&Pe(t);function me(a){t[6](a)}let re={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(re.value=t[1].criticalIssues[t[0]].notes),g=new Ke({props:re}),Z.push(()=>Y(g,"value",me)),{c(){e=J("div"),l=J("a"),n=O("Google StreetView"),f=P(),r=J("a"),c=O("Bing Streetside"),_=P(),T(u.$$.fragment),b=P(),T(h.$$.fragment),S=P(),T(k.$$.fragment),m=P(),E&&E.c(),s=P(),T(g.$$.fragment),this.h()},l(a){e=K(a,"DIV",{style:!0});var y=H(e);l=K(y,"A",{href:!0,target:!0});var X=H(l);n=U(X,"Google StreetView"),X.forEach(v),f=B(y),r=K(y,"A",{href:!0,target:!0});var Q=H(r);c=U(Q,"Bing Streetside"),Q.forEach(v),y.forEach(v),_=B(a),q(u.$$.fragment,a),b=B(a),q(h.$$.fragment,a),S=B(a),q(k.$$.fragment,a),m=B(a),E&&E.l(a),s=B(a),q(g.$$.fragment,a),this.h()},h(){R(l,"href",i=he(t[1].criticalIssues[t[0]].point)),R(l,"target","_blank"),R(r,"href",o=ve(t[1].criticalIssues[t[0]].point)),R(r,"target","_blank"),W(e,"display","flex"),W(e,"justify-content","space-evenly")},m(a,y){L(a,e,y),V(e,l),V(l,n),V(e,f),V(e,r),V(r,c),L(a,_,y),A(u,a,y),L(a,b,y),A(h,a,y),L(a,S,y),A(k,a,y),L(a,m,y),E&&E.m(a,y),L(a,s,y),A(g,a,y),M=!0},p(a,[y]){(!M||y&3&&i!==(i=he(a[1].criticalIssues[a[0]].point)))&&R(l,"href",i),(!M||y&3&&o!==(o=ve(a[1].criticalIssues[a[0]].point)))&&R(r,"href",o);const X={};!N&&y&3&&(N=!0,X.value=a[1].criticalIssues[a[0]].criticalIssue,z(()=>N=!1)),u.$set(X);const Q={};!$&&y&3&&($=!0,Q.value=a[1].criticalIssues[a[0]].stage,z(()=>$=!1)),h.$set(Q);const ae={};!p&&y&3&&(p=!0,ae.value=a[1].criticalIssues[a[0]].locationName,z(()=>p=!1)),k.$set(ae),a[1].criticalIssues[a[0]].stage!="Design"?E?(E.p(a,y),y&3&&C(E,1)):(E=Pe(a),E.c(),C(E,1),E.m(s.parentNode,s)):E&&(te(),I(E,1,1,()=>{E=null}),le());const fe={};!w&&y&3&&(w=!0,fe.value=a[1].criticalIssues[a[0]].notes,z(()=>w=!1)),g.$set(fe)},i(a){M||(C(u.$$.fragment,a),C(h.$$.fragment,a),C(k.$$.fragment,a),C(E),C(g.$$.fragment,a),M=!0)},o(a){I(u.$$.fragment,a),I(h.$$.fragment,a),I(k.$$.fragment,a),I(E),I(g.$$.fragment,a),M=!1},d(a){a&&(v(e),v(_),v(b),v(S),v(m),v(s)),j(u,a),j(h,a),j(k,a),E&&E.d(a),j(g,a)}}}function Tt(t,e,l){let n;ge(t,F,u=>l(1,n=u));let{idx:i}=e;function f(u){t.$$.not_equal(n.criticalIssues[i].criticalIssue,u)&&(n.criticalIssues[i].criticalIssue=u,F.set(n))}function r(u){t.$$.not_equal(n.criticalIssues[i].stage,u)&&(n.criticalIssues[i].stage=u,F.set(n))}function c(u){t.$$.not_equal(n.criticalIssues[i].locationName,u)&&(n.criticalIssues[i].locationName=u,F.set(n))}function o(u){t.$$.not_equal(n.criticalIssues[i].resolved,u)&&(n.criticalIssues[i].resolved=u,F.set(n))}function _(u){t.$$.not_equal(n.criticalIssues[i].notes,u)&&(n.criticalIssues[i].notes=u,F.set(n))}return t.$$set=u=>{"idx"in u&&l(0,i=u.idx)},[i,n,f,r,c,o,_]}class qt extends Ie{constructor(e){super(),Le(this,e,Tt,Bt,ye,{idx:0})}}function Be(t){let e,l,n;function i(r){t[5](r)}let f={label:"Resolved by Design",inlineSmall:!0};return t[1].policyConflictLog[t[0]].resolved!==void 0&&(f.value=t[1].policyConflictLog[t[0]].resolved),e=new ze({props:f}),Z.push(()=>Y(e,"value",i)),{c(){T(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,c){A(e,r,c),n=!0},p(r,c){const o={};!l&&c&3&&(l=!0,o.value=r[1].policyConflictLog[r[0]].resolved,z(()=>l=!1)),e.$set(o)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){I(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function At(t){let e,l,n,i,f,r,c,o,_,u,N,b,h,$,S,k,p,m,s,g,w,M;function ne(a){t[2](a)}let D={label:"Policy Conflict",emptyOption:!0,choices:vt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(D.value=t[1].policyConflictLog[t[0]].conflict),u=new Je({props:D}),Z.push(()=>Y(u,"value",ne));function x(a){t[3](a)}let oe={legend:"Stage",choices:We(["Existing","Design"]),inlineSmall:!0};t[1].policyConflictLog[t[0]].stage!==void 0&&(oe.value=t[1].policyConflictLog[t[0]].stage),h=new He({props:oe}),Z.push(()=>Y(h,"value",x));function pe(a){t[4](a)}let se={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(se.value=t[1].policyConflictLog[t[0]].locationName),k=new Ze({props:se}),Z.push(()=>Y(k,"value",pe));let E=t[1].policyConflictLog[t[0]].stage!="Design"&&Be(t);function me(a){t[6](a)}let re={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(re.value=t[1].policyConflictLog[t[0]].notes),g=new Ke({props:re}),Z.push(()=>Y(g,"value",me)),{c(){e=J("div"),l=J("a"),n=O("Google StreetView"),f=P(),r=J("a"),c=O("Bing Streetside"),_=P(),T(u.$$.fragment),b=P(),T(h.$$.fragment),S=P(),T(k.$$.fragment),m=P(),E&&E.c(),s=P(),T(g.$$.fragment),this.h()},l(a){e=K(a,"DIV",{style:!0});var y=H(e);l=K(y,"A",{href:!0,target:!0});var X=H(l);n=U(X,"Google StreetView"),X.forEach(v),f=B(y),r=K(y,"A",{href:!0,target:!0});var Q=H(r);c=U(Q,"Bing Streetside"),Q.forEach(v),y.forEach(v),_=B(a),q(u.$$.fragment,a),b=B(a),q(h.$$.fragment,a),S=B(a),q(k.$$.fragment,a),m=B(a),E&&E.l(a),s=B(a),q(g.$$.fragment,a),this.h()},h(){R(l,"href",i=he(t[1].policyConflictLog[t[0]].point)),R(l,"target","_blank"),R(r,"href",o=ve(t[1].policyConflictLog[t[0]].point)),R(r,"target","_blank"),W(e,"display","flex"),W(e,"justify-content","space-evenly")},m(a,y){L(a,e,y),V(e,l),V(l,n),V(e,f),V(e,r),V(r,c),L(a,_,y),A(u,a,y),L(a,b,y),A(h,a,y),L(a,S,y),A(k,a,y),L(a,m,y),E&&E.m(a,y),L(a,s,y),A(g,a,y),M=!0},p(a,[y]){(!M||y&3&&i!==(i=he(a[1].policyConflictLog[a[0]].point)))&&R(l,"href",i),(!M||y&3&&o!==(o=ve(a[1].policyConflictLog[a[0]].point)))&&R(r,"href",o);const X={};!N&&y&3&&(N=!0,X.value=a[1].policyConflictLog[a[0]].conflict,z(()=>N=!1)),u.$set(X);const Q={};!$&&y&3&&($=!0,Q.value=a[1].policyConflictLog[a[0]].stage,z(()=>$=!1)),h.$set(Q);const ae={};!p&&y&3&&(p=!0,ae.value=a[1].policyConflictLog[a[0]].locationName,z(()=>p=!1)),k.$set(ae),a[1].policyConflictLog[a[0]].stage!="Design"?E?(E.p(a,y),y&3&&C(E,1)):(E=Be(a),E.c(),C(E,1),E.m(s.parentNode,s)):E&&(te(),I(E,1,1,()=>{E=null}),le());const fe={};!w&&y&3&&(w=!0,fe.value=a[1].policyConflictLog[a[0]].notes,z(()=>w=!1)),g.$set(fe)},i(a){M||(C(u.$$.fragment,a),C(h.$$.fragment,a),C(k.$$.fragment,a),C(E),C(g.$$.fragment,a),M=!0)},o(a){I(u.$$.fragment,a),I(h.$$.fragment,a),I(k.$$.fragment,a),I(E),I(g.$$.fragment,a),M=!1},d(a){a&&(v(e),v(_),v(b),v(S),v(m),v(s)),j(u,a),j(h,a),j(k,a),E&&E.d(a),j(g,a)}}}function jt(t,e,l){let n;ge(t,F,u=>l(1,n=u));let{idx:i}=e;function f(u){t.$$.not_equal(n.policyConflictLog[i].conflict,u)&&(n.policyConflictLog[i].conflict=u,F.set(n))}function r(u){t.$$.not_equal(n.policyConflictLog[i].stage,u)&&(n.policyConflictLog[i].stage=u,F.set(n))}function c(u){t.$$.not_equal(n.policyConflictLog[i].locationName,u)&&(n.policyConflictLog[i].locationName=u,F.set(n))}function o(u){t.$$.not_equal(n.policyConflictLog[i].resolved,u)&&(n.policyConflictLog[i].resolved=u,F.set(n))}function _(u){t.$$.not_equal(n.policyConflictLog[i].notes,u)&&(n.policyConflictLog[i].notes=u,F.set(n))}return t.$$set=u=>{"idx"in u&&l(0,i=u.idx)},[i,n,f,r,c,o,_]}class Vt extends Ie{constructor(e){super(),Le(this,e,jt,At,ye,{idx:0})}}const{window:Gt}=ut;function Te(t,e,l){const n=t.slice();return n[42]=e[l],n[43]=e,n[44]=l,n}function qe(t,e,l){const n=t.slice();return n[45]=e[l],n[46]=e,n[44]=l,n}function Ae(t,e,l){const n=t.slice();return n[42]=e[l],n[44]=l,n}function je(t,e,l){const n=t.slice();return n[45]=e[l],n[44]=l,n}function Mt(t){let e,l,n,i,f,r,c,o,_,u;e=new Nt({props:{$$slots:{default:[Rt]},$$scope:{ctx:t}}}),e.$on("click",t[11]),n=new Et({props:{$$slots:{default:[Ot]},$$scope:{ctx:t}}}),n.$on("click",t[13]),f=new _e({props:{$$slots:{default:[Ut]},$$scope:{ctx:t}}}),f.$on("click",t[27]);const N=[Ht,Wt],b=[];function h($,S){return $[1].id.kind=="critical"?0:1}return c=h(t),o=b[c]=N[c](t),{c(){T(e.$$.fragment),l=P(),T(n.$$.fragment),i=P(),T(f.$$.fragment),r=P(),o.c(),_=$e()},l($){q(e.$$.fragment,$),l=B($),q(n.$$.fragment,$),i=B($),q(f.$$.fragment,$),r=B($),o.l($),_=$e()},m($,S){A(e,$,S),L($,l,S),A(n,$,S),L($,i,S),A(f,$,S),L($,r,S),b[c].m($,S),L($,_,S),u=!0},p($,S){const k={};S[1]&262144&&(k.$$scope={dirty:S,ctx:$}),e.$set(k);const p={};S[1]&262144&&(p.$$scope={dirty:S,ctx:$}),n.$set(p);const m={};S[1]&262144&&(m.$$scope={dirty:S,ctx:$}),f.$set(m);let s=c;c=h($),c===s?b[c].p($,S):(te(),I(b[s],1,1,()=>{b[s]=null}),le(),o=b[c],o?o.p($,S):(o=b[c]=N[c]($),o.c()),C(o,1),o.m(_.parentNode,_))},i($){u||(C(e.$$.fragment,$),C(n.$$.fragment,$),C(f.$$.fragment,$),C(o),u=!0)},o($){I(e.$$.fragment,$),I(n.$$.fragment,$),I(f.$$.fragment,$),I(o),u=!1},d($){$&&(v(l),v(i),v(r),v(_)),j(e,$),j(n,$),j(f,$),b[c].d($)}}}function Ft(t){let e,l,n,i="Critical Issues",f,r,c,o="Policy Conflicts",_,u,N;e=new St({props:{label:"Tools",open:!0,$$slots:{default:[Zt]},$$scope:{ctx:t}}});let b=ie(t[3].criticalIssues),h=[];for(let m=0;m<b.length;m+=1)h[m]=Ge(je(t,b,m));const $=m=>I(h[m],1,1,()=>{h[m]=null});let S=ie(t[3].policyConflictLog),k=[];for(let m=0;m<S.length;m+=1)k[m]=Fe(Ae(t,S,m));const p=m=>I(k[m],1,1,()=>{k[m]=null});return{c(){T(e.$$.fragment),l=P(),n=J("h3"),n.textContent=i,f=P();for(let m=0;m<h.length;m+=1)h[m].c();r=P(),c=J("h3"),c.textContent=o,_=P();for(let m=0;m<k.length;m+=1)k[m].c();u=$e()},l(m){q(e.$$.fragment,m),l=B(m),n=K(m,"H3",{"data-svelte-h":!0}),Ne(n)!=="svelte-1qhh5xr"&&(n.textContent=i),f=B(m);for(let s=0;s<h.length;s+=1)h[s].l(m);r=B(m),c=K(m,"H3",{"data-svelte-h":!0}),Ne(c)!=="svelte-eyxzjx"&&(c.textContent=o),_=B(m);for(let s=0;s<k.length;s+=1)k[s].l(m);u=$e()},m(m,s){A(e,m,s),L(m,l,s),L(m,n,s),L(m,f,s);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(m,s);L(m,r,s),L(m,c,s),L(m,_,s);for(let g=0;g<k.length;g+=1)k[g]&&k[g].m(m,s);L(m,u,s),N=!0},p(m,s){const g={};if(s[0]&97|s[1]&262144&&(g.$$scope={dirty:s,ctx:m}),e.$set(g),s[0]&33292){b=ie(m[3].criticalIssues);let w;for(w=0;w<b.length;w+=1){const M=je(m,b,w);h[w]?(h[w].p(M,s),C(h[w],1)):(h[w]=Ge(M),h[w].c(),C(h[w],1),h[w].m(r.parentNode,r))}for(te(),w=b.length;w<h.length;w+=1)$(w);le()}if(s[0]&66060){S=ie(m[3].policyConflictLog);let w;for(w=0;w<S.length;w+=1){const M=Ae(m,S,w);k[w]?(k[w].p(M,s),C(k[w],1)):(k[w]=Fe(M),k[w].c(),C(k[w],1),k[w].m(u.parentNode,u))}for(te(),w=S.length;w<k.length;w+=1)p(w);le()}},i(m){if(!N){C(e.$$.fragment,m);for(let s=0;s<b.length;s+=1)C(h[s]);for(let s=0;s<S.length;s+=1)C(k[s]);N=!0}},o(m){I(e.$$.fragment,m),h=h.filter(Boolean);for(let s=0;s<h.length;s+=1)I(h[s]);k=k.filter(Boolean);for(let s=0;s<k.length;s+=1)I(k[s]);N=!1},d(m){m&&(v(l),v(n),v(f),v(r),v(c),v(_),v(u)),j(e,m),de(h,m),de(k,m)}}}function Rt(t){let e;return{c(){e=O("Save")},l(l){e=U(l,"Save")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Ot(t){let e;return{c(){e=O("Delete")},l(l){e=U(l,"Delete")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Ut(t){let e;return{c(){e=O("Copy")},l(l){e=U(l,"Copy")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Wt(t){let e,l;return e=new Vt({props:{idx:t[1].id.idx}}),{c(){T(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,i){A(e,n,i),l=!0},p(n,i){const f={};i[0]&2&&(f.idx=n[1].id.idx),e.$set(f)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){I(e.$$.fragment,n),l=!1},d(n){j(e,n)}}}function Ht(t){let e,l;return e=new qt({props:{idx:t[1].id.idx}}),{c(){T(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,i){A(e,n,i),l=!0},p(n,i){const f={};i[0]&2&&(f.idx=n[1].id.idx),e.$set(f)},i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){I(e.$$.fragment,n),l=!1},d(n){j(e,n)}}}function Jt(t){let e;return{c(){e=O("Zoom to fit")},l(l){e=U(l,"Zoom to fit")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Kt(t){let e;return{c(){e=O("Show scheme context")},l(l){e=U(l,"Show scheme context")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Zt(t){let e,l,n,i,f,r,c,o,_,u,N,b;e=new _e({props:{$$slots:{default:[Jt]},$$scope:{ctx:t}}}),e.$on("click",t[18]),n=new wt({}),f=new Ct({});function h(p){t[19](p)}let $={map:t[0]};t[5]!==void 0&&($.enabled=t[5]),c=new yt({props:$}),Z.push(()=>Y(c,"enabled",h));function S(p){t[20](p)}let k={$$slots:{default:[Kt]},$$scope:{ctx:t}};return t[6]!==void 0&&(k.checked=t[6]),u=new It({props:k}),Z.push(()=>Y(u,"checked",S)),{c(){T(e.$$.fragment),l=P(),T(n.$$.fragment),i=P(),T(f.$$.fragment),r=P(),T(c.$$.fragment),_=P(),T(u.$$.fragment)},l(p){q(e.$$.fragment,p),l=B(p),q(n.$$.fragment,p),i=B(p),q(f.$$.fragment,p),r=B(p),q(c.$$.fragment,p),_=B(p),q(u.$$.fragment,p)},m(p,m){A(e,p,m),L(p,l,m),A(n,p,m),L(p,i,m),A(f,p,m),L(p,r,m),A(c,p,m),L(p,_,m),A(u,p,m),b=!0},p(p,m){const s={};m[1]&262144&&(s.$$scope={dirty:m,ctx:p}),e.$set(s);const g={};m[0]&1&&(g.map=p[0]),!o&&m[0]&32&&(o=!0,g.enabled=p[5],z(()=>o=!1)),c.$set(g);const w={};m[1]&262144&&(w.$$scope={dirty:m,ctx:p}),!N&&m[0]&64&&(N=!0,w.checked=p[6],z(()=>N=!1)),u.$set(w)},i(p){b||(C(e.$$.fragment,p),C(n.$$.fragment,p),C(f.$$.fragment,p),C(c.$$.fragment,p),C(u.$$.fragment,p),b=!0)},o(p){I(e.$$.fragment,p),I(n.$$.fragment,p),I(f.$$.fragment,p),I(c.$$.fragment,p),I(u.$$.fragment,p),b=!1},d(p){p&&(v(l),v(i),v(r),v(_)),j(e,p),j(n,p),j(f,p),j(c,p),j(u,p)}}}function Ve(t){let e,l,n=t[45].resolved+"",i;return{c(){e=J("span"),l=O("Resolved: "),i=O(n)},l(f){e=K(f,"SPAN",{});var r=H(e);l=U(r,"Resolved: "),i=U(r,n),r.forEach(v)},m(f,r){L(f,e,r),V(e,l),V(e,i)},p(f,r){r[0]&8&&n!==(n=f[45].resolved+"")&&ue(i,n)},d(f){f&&v(e)}}}function zt(t){let e,l,n,i=t[45].stage+"",f,r,c=t[45].stage!="Design"&&Ve(t);return{c(){e=J("div"),l=J("span"),n=O("Stage: "),f=O(i),r=P(),c&&c.c(),this.h()},l(o){e=K(o,"DIV",{style:!0});var _=H(e);l=K(_,"SPAN",{});var u=H(l);n=U(u,"Stage: "),f=U(u,i),u.forEach(v),r=B(_),c&&c.l(_),_.forEach(v),this.h()},h(){W(e,"width","100%"),W(e,"display","flex"),W(e,"justify-content","space-between")},m(o,_){L(o,e,_),V(e,l),V(l,n),V(l,f),V(e,r),c&&c.m(e,null)},p(o,_){_[0]&8&&i!==(i=o[45].stage+"")&&ue(f,i),o[45].stage!="Design"?c?c.p(o,_):(c=Ve(o),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(o){o&&v(e),c&&c.d()}}}function Ge(t){let e,l;function n(){return t[21](t[44])}function i(){return t[22](t[44])}return e=new Xe({props:{name:t[15](t[45]),$$slots:{default:[zt]},$$scope:{ctx:t}}}),e.$on("click",n),e.$on("mouseenter",i),e.$on("mouseleave",t[23]),{c(){T(e.$$.fragment)},l(f){q(e.$$.fragment,f)},m(f,r){A(e,f,r),l=!0},p(f,r){t=f;const c={};r[0]&8&&(c.name=t[15](t[45])),r[0]&8|r[1]&262144&&(c.$$scope={dirty:r,ctx:t}),e.$set(c)},i(f){l||(C(e.$$.fragment,f),l=!0)},o(f){I(e.$$.fragment,f),l=!1},d(f){j(e,f)}}}function Me(t){let e,l,n=t[42].resolved+"",i;return{c(){e=J("span"),l=O("Resolved: "),i=O(n)},l(f){e=K(f,"SPAN",{});var r=H(e);l=U(r,"Resolved: "),i=U(r,n),r.forEach(v)},m(f,r){L(f,e,r),V(e,l),V(e,i)},p(f,r){r[0]&8&&n!==(n=f[42].resolved+"")&&ue(i,n)},d(f){f&&v(e)}}}function Yt(t){let e,l,n,i=t[42].stage+"",f,r,c,o=t[42].stage!="Design"&&Me(t);return{c(){e=J("div"),l=J("span"),n=O("Stage: "),f=O(i),r=P(),o&&o.c(),c=P(),this.h()},l(_){e=K(_,"DIV",{style:!0});var u=H(e);l=K(u,"SPAN",{});var N=H(l);n=U(N,"Stage: "),f=U(N,i),N.forEach(v),r=B(u),o&&o.l(u),u.forEach(v),c=B(_),this.h()},h(){W(e,"width","100%"),W(e,"display","flex"),W(e,"justify-content","space-between")},m(_,u){L(_,e,u),V(e,l),V(l,n),V(l,f),V(e,r),o&&o.m(e,null),L(_,c,u)},p(_,u){u[0]&8&&i!==(i=_[42].stage+"")&&ue(f,i),_[42].stage!="Design"?o?o.p(_,u):(o=Me(_),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(_){_&&(v(e),v(c)),o&&o.d()}}}function Fe(t){let e,l;function n(){return t[24](t[44])}function i(){return t[25](t[44])}return e=new Xe({props:{name:t[16](t[42]),$$slots:{default:[Yt]},$$scope:{ctx:t}}}),e.$on("click",n),e.$on("mouseenter",i),e.$on("mouseleave",t[26]),{c(){T(e.$$.fragment)},l(f){q(e.$$.fragment,f)},m(f,r){A(e,f,r),l=!0},p(f,r){t=f;const c={};r[0]&8&&(c.name=t[16](t[42])),r[0]&8|r[1]&262144&&(c.$$scope={dirty:r,ctx:t}),e.$set(c)},i(f){l||(C(e.$$.fragment,f),l=!0)},o(f){I(e.$$.fragment,f),l=!1},d(f){j(e,f)}}}function Re(t){let e,l,n,i,f,r,c;return l=new _e({props:{disabled:t[1].mode=="select",style:"margin-bottom: 0px",$$slots:{default:[Xt]},$$scope:{ctx:t}}}),l.$on("click",t[29]),i=new _e({props:{disabled:t[1].mode=="new-critical",style:"margin-bottom: 0px",$$slots:{default:[Qt]},$$scope:{ctx:t}}}),i.$on("click",t[30]),r=new _e({props:{disabled:t[1].mode=="new-conflict",style:"margin-bottom: 0px",$$slots:{default:[xt]},$$scope:{ctx:t}}}),r.$on("click",t[31]),{c(){e=J("div"),T(l.$$.fragment),n=P(),T(i.$$.fragment),f=P(),T(r.$$.fragment),this.h()},l(o){e=K(o,"DIV",{class:!0});var _=H(e);q(l.$$.fragment,_),n=B(_),q(i.$$.fragment,_),f=B(_),q(r.$$.fragment,_),_.forEach(v),this.h()},h(){R(e,"class","control-panel svelte-345ma7")},m(o,_){L(o,e,_),A(l,e,null),V(e,n),A(i,e,null),V(e,f),A(r,e,null),c=!0},p(o,_){const u={};_[0]&2&&(u.disabled=o[1].mode=="select"),_[1]&262144&&(u.$$scope={dirty:_,ctx:o}),l.$set(u);const N={};_[0]&2&&(N.disabled=o[1].mode=="new-critical"),_[1]&262144&&(N.$$scope={dirty:_,ctx:o}),i.$set(N);const b={};_[0]&2&&(b.disabled=o[1].mode=="new-conflict"),_[1]&262144&&(b.$$scope={dirty:_,ctx:o}),r.$set(b)},i(o){c||(C(l.$$.fragment,o),C(i.$$.fragment,o),C(r.$$.fragment,o),c=!0)},o(o){I(l.$$.fragment,o),I(i.$$.fragment,o),I(r.$$.fragment,o),c=!1},d(o){o&&v(e),j(l),j(i),j(r)}}}function Xt(t){let e;return{c(){e=O("Select")},l(l){e=U(l,"Select")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function Qt(t){let e;return{c(){e=O("New critical issue")},l(l){e=U(l,"New critical issue")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function xt(t){let e;return{c(){e=O("New policy conflict")},l(l){e=U(l,"New policy conflict")},m(l,n){L(l,e,n)},d(l){l&&v(e)}}}function el(t){let e,l,n,i=t[45].criticalIssue+"",f;return{c(){e=ke("svg"),l=ke("polygon"),n=ke("text"),f=O(i),this.h()},l(r){e=we(r,"svg",{width:!0,height:!0,xmlns:!0});var c=H(e);l=we(c,"polygon",{points:!0,fill:!0,class:!0}),H(l).forEach(v),n=we(c,"text",{x:!0,y:!0});var o=H(n);f=U(o,i),o.forEach(v),c.forEach(v),this.h()},h(){R(l,"points","20,0 0,40 40,40"),R(l,"fill",$t.critical.background),R(l,"class","svelte-345ma7"),R(n,"x","13"),R(n,"y","30"),W(n,"fill","white"),R(e,"width","40"),R(e,"height","40"),R(e,"xmlns","http://www.w3.org/2000/svg")},m(r,c){L(r,e,c),V(e,l),V(e,n),V(n,f)},p(r,c){c[0]&8&&i!==(i=r[45].criticalIssue+"")&&ue(f,i)},d(r){r&&v(e)}}}function Oe(t){let e,l,n;function i(o){t[32](o,t[45])}function f(){return t[33](t[44])}function r(){return t[34](t[44])}let c={draggable:!0,$$slots:{default:[el]},$$scope:{ctx:t}};return t[45].point!==void 0&&(c.lngLat=t[45].point),e=new Ye({props:c}),Z.push(()=>Y(e,"lngLat",i)),e.$on("click",f),e.$on("dragend",r),{c(){T(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,_){A(e,o,_),n=!0},p(o,_){t=o;const u={};_[0]&8|_[1]&262144&&(u.$$scope={dirty:_,ctx:t}),!l&&_[0]&8&&(l=!0,u.lngLat=t[45].point,z(()=>l=!1)),e.$set(u)},i(o){n||(C(e.$$.fragment,o),n=!0)},o(o){I(e.$$.fragment,o),n=!1},d(o){j(e,o)}}}function tl(t){let e,l=t[42].conflict+"",n;return{c(){e=J("span"),n=O(l),this.h()},l(i){e=K(i,"SPAN",{class:!0});var f=H(e);n=U(f,l),f.forEach(v),this.h()},h(){R(e,"class","dot svelte-345ma7"),W(e,"background",dt)},m(i,f){L(i,e,f),V(e,n)},p(i,f){f[0]&8&&l!==(l=i[42].conflict+"")&&ue(n,l)},d(i){i&&v(e)}}}function Ue(t){let e,l,n;function i(o){t[35](o,t[42])}function f(){return t[36](t[44])}function r(){return t[37](t[44])}let c={draggable:!0,$$slots:{default:[tl]},$$scope:{ctx:t}};return t[42].point!==void 0&&(c.lngLat=t[42].point),e=new Ye({props:c}),Z.push(()=>Y(e,"lngLat",i)),e.$on("click",f),e.$on("dragend",r),{c(){T(e.$$.fragment)},l(o){q(e.$$.fragment,o)},m(o,_){A(e,o,_),n=!0},p(o,_){t=o;const u={};_[0]&8|_[1]&262144&&(u.$$scope={dirty:_,ctx:t}),!l&&_[0]&8&&(l=!0,u.lngLat=t[42].point,z(()=>l=!1)),e.$set(u)},i(o){n||(C(e.$$.fragment,o),n=!0)},o(o){I(e.$$.fragment,o),n=!1},d(o){j(e,o)}}}function ll(t){let e,l;return e=new gt({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){T(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,i){A(e,n,i),l=!0},p:ft,i(n){l||(C(e.$$.fragment,n),l=!0)},o(n){I(e.$$.fragment,n),l=!1},d(n){j(e,n)}}}function nl(t){let e,l,n,i,f,r,c,o,_,u,N;e=new Lt({}),e.$on("click",t[12]);let b=t[1].mode!="editing"&&Re(t);i=new mt({props:{gj:t[3].summary.networkMap,show:t[6]}});let h=ie(t[3].criticalIssues),$=[];for(let s=0;s<h.length;s+=1)$[s]=Oe(qe(t,h,s));const S=s=>I($[s],1,1,()=>{$[s]=null});let k=ie(t[3].policyConflictLog),p=[];for(let s=0;s<k.length;s+=1)p[s]=Ue(Te(t,k,s));const m=s=>I(p[s],1,1,()=>{p[s]=null});return o=new _t({props:{data:t[7],$$slots:{default:[ll]},$$scope:{ctx:t}}}),u=new Dt({props:{map:t[0]}}),{c(){T(e.$$.fragment),l=P(),b&&b.c(),n=P(),T(i.$$.fragment),f=P();for(let s=0;s<$.length;s+=1)$[s].c();r=P();for(let s=0;s<p.length;s+=1)p[s].c();c=P(),T(o.$$.fragment),_=P(),T(u.$$.fragment)},l(s){q(e.$$.fragment,s),l=B(s),b&&b.l(s),n=B(s),q(i.$$.fragment,s),f=B(s);for(let g=0;g<$.length;g+=1)$[g].l(s);r=B(s);for(let g=0;g<p.length;g+=1)p[g].l(s);c=B(s),q(o.$$.fragment,s),_=B(s),q(u.$$.fragment,s)},m(s,g){A(e,s,g),L(s,l,g),b&&b.m(s,g),L(s,n,g),A(i,s,g),L(s,f,g);for(let w=0;w<$.length;w+=1)$[w]&&$[w].m(s,g);L(s,r,g);for(let w=0;w<p.length;w+=1)p[w]&&p[w].m(s,g);L(s,c,g),A(o,s,g),L(s,_,g),A(u,s,g),N=!0},p(s,g){s[1].mode!="editing"?b?(b.p(s,g),g[0]&2&&C(b,1)):(b=Re(s),b.c(),C(b,1),b.m(n.parentNode,n)):b&&(te(),I(b,1,1,()=>{b=null}),le());const w={};if(g[0]&8&&(w.gj=s[3].summary.networkMap),g[0]&64&&(w.show=s[6]),i.$set(w),g[0]&264){h=ie(s[3].criticalIssues);let D;for(D=0;D<h.length;D+=1){const x=qe(s,h,D);$[D]?($[D].p(x,g),C($[D],1)):($[D]=Oe(x),$[D].c(),C($[D],1),$[D].m(r.parentNode,r))}for(te(),D=h.length;D<$.length;D+=1)S(D);le()}if(g[0]&264){k=ie(s[3].policyConflictLog);let D;for(D=0;D<k.length;D+=1){const x=Te(s,k,D);p[D]?(p[D].p(x,g),C(p[D],1)):(p[D]=Ue(x),p[D].c(),C(p[D],1),p[D].m(c.parentNode,c))}for(te(),D=k.length;D<p.length;D+=1)m(D);le()}const M={};g[0]&128&&(M.data=s[7]),g[1]&262144&&(M.$$scope={dirty:g,ctx:s}),o.$set(M);const ne={};g[0]&1&&(ne.map=s[0]),u.$set(ne)},i(s){if(!N){C(e.$$.fragment,s),C(b),C(i.$$.fragment,s);for(let g=0;g<h.length;g+=1)C($[g]);for(let g=0;g<k.length;g+=1)C(p[g]);C(o.$$.fragment,s),C(u.$$.fragment,s),N=!0}},o(s){I(e.$$.fragment,s),I(b),I(i.$$.fragment,s),$=$.filter(Boolean);for(let g=0;g<$.length;g+=1)I($[g]);p=p.filter(Boolean);for(let g=0;g<p.length;g+=1)I(p[g]);I(o.$$.fragment,s),I(u.$$.fragment,s),N=!1},d(s){s&&(v(l),v(n),v(f),v(r),v(c),v(_)),j(e,s),b&&b.d(s),j(i,s),de($,s),de(p,s),j(o,s),j(u,s)}}}function il(t){let e,l,n,i,f,r,c,o,_,u,N;const b=[Ft,Mt],h=[];function $(p,m){return p[1].mode!="editing"?0:1}n=$(t),i=h[n]=b[n](t);function S(p){t[38](p)}let k={$$slots:{default:[nl]},$$scope:{ctx:t}};return t[0]!==void 0&&(k.map=t[0]),c=new ct({props:k}),Z.push(()=>Y(c,"map",S)),{c(){e=J("div"),l=J("div"),i.c(),f=P(),r=J("div"),T(c.$$.fragment),this.h()},l(p){e=K(p,"DIV",{style:!0});var m=H(e);l=K(m,"DIV",{style:!0});var s=H(l);i.l(s),s.forEach(v),f=B(m),r=K(m,"DIV",{style:!0});var g=H(r);q(c.$$.fragment,g),g.forEach(v),m.forEach(v),this.h()},h(){W(l,"width","30%"),W(l,"overflow-y","scroll"),W(l,"padding","10px"),W(l,"border","1px solid black"),W(r,"position","relative"),W(r,"width","70%"),W(e,"display","flex"),W(e,"height","80vh")},m(p,m){L(p,e,m),V(e,l),h[n].m(l,null),t[28](l),V(e,f),V(e,r),A(c,r,null),_=!0,u||(N=rt(Gt,"keydown",t[17]),u=!0)},p(p,m){let s=n;n=$(p),n===s?h[n].p(p,m):(te(),I(h[s],1,1,()=>{h[s]=null}),le(),i=h[n],i?i.p(p,m):(i=h[n]=b[n](p),i.c()),C(i,1),i.m(l,null));const g={};m[0]&203|m[1]&262144&&(g.$$scope={dirty:m,ctx:p}),!o&&m[0]&1&&(o=!0,g.map=p[0],z(()=>o=!1)),c.$set(g)},i(p){_||(C(i),C(c.$$.fragment,p),_=!0)},o(p){I(i),I(c.$$.fragment,p),_=!1},d(p){p&&v(e),h[n].d(),t[28](null),j(c),u=!1,N()}}}function ol(t,e,l){let n={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:l;if(i!=null){let f=i.kind=="critical"?t.criticalIssues:t.policyConflictLog;n.features.push(Ce(f[i.idx].point))}return n}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function sl(t,e,l){let n,i,f;ge(t,F,d=>l(3,i=d)),ge(t,Pt,d=>l(40,f=d));let r,c,o={mode:"select"},_=f.url.searchParams.get("kind")||"";_=="critical"?o={mode:"new-critical"}:_=="conflict"&&(o={mode:"new-conflict"});let u=null,N=null,b=!1,h=!0;async function $(d){u=c.scrollTop,l(1,o={mode:"editing",id:d}),l(2,N=null),await be(),l(4,c.scrollTop=0,c)}async function S(d){u=c.scrollTop,l(1,o={mode:"editing",id:d}),l(2,N=null),await be(),l(4,c.scrollTop=0,c);let G=d.kind=="critical"?i.criticalIssues:i.policyConflictLog;r.flyTo({center:G[d.idx].point,duration:500})}async function k(d){let G=d.kind=="critical"?i.criticalIssues:i.policyConflictLog,ee=JSON.parse(JSON.stringify(G[d.idx])),ot=r.getBounds().getWest(),st=r.getBounds().getEast();ee.point[0]+=(st-ot)*.05;let Se=G.toSpliced(d.idx+1,0,ee);d.kind=="critical"?ce(F,i.criticalIssues=Se,i):ce(F,i.policyConflictLog=Se,i),$({kind:d.kind,idx:d.idx+1})}async function p(){l(1,o={mode:"select"}),ce(F,i.policyConflictLog=i.policyConflictLog.toSorted((d,G)=>Ee(d.conflict)-Ee(G.conflict)),i),ce(F,i.criticalIssues=i.criticalIssues.toSorted((d,G)=>De(d.criticalIssue)-De(G.criticalIssue)),i),u!=null&&(await be(),l(4,c.scrollTop=u,c),u=null)}function m(d){if(!b&&o.mode!="select"){if(o.mode=="editing"){p();return}o.mode=="new-critical"?(ce(F,i.criticalIssues=[...i.criticalIssues,{criticalIssue:f.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),$({kind:"critical",idx:i.criticalIssues.length-1})):o.mode=="new-conflict"&&(ce(F,i.policyConflictLog=[...i.policyConflictLog,{conflict:f.url.searchParams.get("code")||"",stage:"",point:d.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),$({kind:"conflict",idx:i.policyConflictLog.length-1}))}}at(()=>{g(!1)});function s(){o.mode=="editing"&&window.confirm("Delete this entry?")&&(o.id.kind=="critical"?(i.criticalIssues.splice(o.id.idx,1),F.set(i)):(i.policyConflictLog.splice(o.id.idx,1),F.set(i)),p())}function g(d){let G={type:"FeatureCollection",features:[...i.criticalIssues.map(ee=>Ce(ee.point)),...i.policyConflictLog.map(ee=>Ce(ee.point)),...i.summary.networkMap.features]};G.features.length>0&&r.fitBounds(pt(G),{padding:20,animate:d})}function w(d){let G=d.criticalIssue?bt(d.criticalIssue):"Unknown critical";return d.locationName?`${G} (${d.locationName})`:G}function M(d){let G=d.conflict?kt(d.conflict):"Unknown conflict";return d.locationName?`${G} (${d.locationName})`:G}function ne(d){if(o.mode=="editing"){let G=d.target.tagName,ee=G=="INPUT"||G=="TEXTAREA";d.key=="Escape"||d.key=="Enter"&&!ee?(d.stopPropagation(),p()):d.key=="Delete"&&!ee&&(d.stopPropagation(),s())}else(o.mode=="new-critical"||o.mode=="new-conflict")&&d.key=="Escape"&&(d.stopPropagation(),l(1,o={mode:"select"}))}const D=()=>g(!0);function x(d){b=d,l(5,b)}function oe(d){h=d,l(6,h)}const pe=d=>S({kind:"critical",idx:d}),se=d=>l(2,N={kind:"critical",idx:d}),E=()=>l(2,N=null),me=d=>S({kind:"conflict",idx:d}),re=d=>l(2,N={kind:"conflict",idx:d}),a=()=>l(2,N=null),y=()=>k({kind:o.id.kind,idx:o.id.idx});function X(d){Z[d?"unshift":"push"](()=>{c=d,l(4,c)})}const Q=()=>p(),ae=()=>l(1,o={mode:"new-critical"}),fe=()=>l(1,o={mode:"new-conflict"});function Qe(d,G){t.$$.not_equal(G.point,d)&&(G.point=d,F.set(i))}const xe=d=>$({kind:"critical",idx:d}),et=d=>$({kind:"critical",idx:d});function tt(d,G){t.$$.not_equal(G.point,d)&&(G.point=d,F.set(i))}const lt=d=>$({kind:"conflict",idx:d}),nt=d=>$({kind:"conflict",idx:d});function it(d){r=d,l(0,r)}return t.$$.update=()=>{t.$$.dirty[0]&3&&r&&(r.getCanvas().style.cursor=o.mode=="new-critical"||o.mode=="new-conflict"?"crosshair":"auto"),t.$$.dirty[0]&14&&l(7,n=ol(i,o,N))},[r,o,N,i,c,b,h,n,$,S,k,p,m,s,g,w,M,ne,D,x,oe,pe,se,E,me,re,a,y,X,Q,ae,fe,Qe,xe,et,tt,lt,nt,it]}class Dl extends Ie{constructor(e){super(),Le(this,e,sl,il,ye,{},null,[-1,-1])}}export{Dl as component};
