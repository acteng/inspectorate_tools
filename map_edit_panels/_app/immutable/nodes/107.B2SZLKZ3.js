import{s as we,l as ct,u as ut,r as pt,v as _t,D as mt,w as K,e as O,t as W,a as D,c as H,b as R,d as J,f as d,g as T,p as B,q as Z,i as w,h as A,x as z,k as he,B as gt,R as $t,W as Ie,T as _e,F as ee,m as de,G as ve,j as me,o as dt,K as ue,L as pe,n as ht}from"../chunks/scheduler.D5JRtHaf.js";import{S as ye,i as Ce,c as M,a as P,m as F,t as y,b as I,d as j,e as Y,g as le,f as ne}from"../chunks/index.Xm1AgzMF.js";import{j as be,k as ke,M as vt,l as bt,b as kt,C as wt,G as yt,m as Ct}from"../chunks/index.B6qac27k.js";import{e as oe}from"../chunks/each.C9BadmQM.js";import{c as He,p as We}from"../chunks/colors.DaC397qr.js";import{p as Je}from"../chunks/index.BPbKILuD.js";import{R as Ke}from"../chunks/Radio.BjpWuuOn.js";import{S as ze}from"../chunks/Select.DCCD1fdE.js";/* empty css                                                    */import{T as Ye}from"../chunks/TextArea.Ct1XwDet.js";import{T as Xe}from"../chunks/TextInput.Cluermb4.js";import{s as U}from"../chunks/data.Ct2egXVL.js";import{c as It,p as Lt,b as qe,e as De,f as Nt,g as St}from"../chunks/lists.BvURpO7c.js";import{Y as Qe}from"../chunks/YesNo.Bnd14usz.js";import{B as Et,G as qt,S as Dt,C as Tt,a as Bt,M as xe}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.Dy1fbaqj.js";import{C as Mt}from"../chunks/CollapsibleCard.D0GavHKp.js";import{D as Pt}from"../chunks/DefaultButton.BHwS446X.js";import{S as Se}from"../chunks/SecondaryButton.DxO4nu9r.js";import{W as Ft}from"../chunks/WarningButton.jEqntaGg.js";import{G as jt}from"../chunks/GeoreferenceLayer.DYvaijPb.js";import{C as et}from"../chunks/ClickableCard.BhW8XYpY.js";import"../chunks/paths.BovJhI5Q.js";import{p as At}from"../chunks/stores.BqP5-Azg.js";function Gt(l){let e;const n=l[1].default,t=ct(n,l,l[3],null);return{c(){t&&t.c()},l(i){t&&t.l(i)},m(i,f){t&&t.m(i,f),e=!0},p(i,f){t&&t.p&&(!e||f&8)&&ut(t,n,i,i[3],e?_t(n,i[3],f,null):pt(i[3]),null)},i(i){e||(y(t,i),e=!0)},o(i){I(t,i),e=!1},d(i){t&&t.d(i)}}}function Vt(l){let e,n;return e=new Se({props:{style:"margin-bottom: 0px",disabled:l[0],$$slots:{default:[Gt]},$$scope:{ctx:l}}}),e.$on("click",l[2]),{c(){M(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,i){F(e,t,i),n=!0},p(t,[i]){const f={};i&1&&(f.disabled=t[0]),i&8&&(f.$$scope={dirty:i,ctx:t}),e.$set(f)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function Rt(l,e,n){let{$$slots:t={},$$scope:i}=e,{disabled:f=!1}=e;function s(r){mt.call(this,l,r)}return l.$$set=r=>{"disabled"in r&&n(0,f=r.disabled),"$$scope"in r&&n(3,i=r.$$scope)},[f,t,s,i]}class Le extends ye{constructor(e){super(),Ce(this,e,Rt,Vt,we,{disabled:0})}}function Te(l){let e,n,t;function i(s){l[5](s)}let f={label:"Resolved by Design",inlineSmall:!0};return l[1].criticalIssues[l[0]].resolved!==void 0&&(f.value=l[1].criticalIssues[l[0]].resolved),e=new Qe({props:f}),K.push(()=>Y(e,"value",i)),{c(){M(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,r){F(e,s,r),t=!0},p(s,r){const o={};!n&&r&3&&(n=!0,o.value=s[1].criticalIssues[s[0]].resolved,z(()=>n=!1)),e.$set(o)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){I(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ut(l){let e,n,t,i,f,s,r,o,u,p,S,k,v,$,N,b,_,m,a,g,C,V;function ie(c){l[2](c)}let q={label:"Critical Issue",emptyOption:!0,choices:It};l[1].criticalIssues[l[0]].criticalIssue!==void 0&&(q.value=l[1].criticalIssues[l[0]].criticalIssue),p=new ze({props:q}),K.push(()=>Y(p,"value",ie));function x(c){l[3](c)}let se={legend:"Stage",choices:Je(["Existing","Design"]),inlineSmall:!0};l[1].criticalIssues[l[0]].stage!==void 0&&(se.value=l[1].criticalIssues[l[0]].stage),v=new Ke({props:se}),K.push(()=>Y(v,"value",x));function ge(c){l[4](c)}let re={label:"Location Name"};l[1].criticalIssues[l[0]].locationName!==void 0&&(re.value=l[1].criticalIssues[l[0]].locationName),b=new Xe({props:re}),K.push(()=>Y(b,"value",ge));let E=l[1].criticalIssues[l[0]].stage!="Design"&&Te(l);function $e(c){l[6](c)}let ae={label:"Commentary & Feedback"};return l[1].criticalIssues[l[0]].notes!==void 0&&(ae.value=l[1].criticalIssues[l[0]].notes),g=new Ye({props:ae}),K.push(()=>Y(g,"value",$e)),{c(){e=O("div"),n=O("a"),t=W("Google StreetView"),f=D(),s=O("a"),r=W("Bing Streetside"),u=D(),M(p.$$.fragment),k=D(),M(v.$$.fragment),N=D(),M(b.$$.fragment),m=D(),E&&E.c(),a=D(),M(g.$$.fragment),this.h()},l(c){e=H(c,"DIV",{style:!0});var L=R(e);n=H(L,"A",{href:!0,target:!0});var X=R(n);t=J(X,"Google StreetView"),X.forEach(d),f=T(L),s=H(L,"A",{href:!0,target:!0});var Q=R(s);r=J(Q,"Bing Streetside"),Q.forEach(d),L.forEach(d),u=T(c),P(p.$$.fragment,c),k=T(c),P(v.$$.fragment,c),N=T(c),P(b.$$.fragment,c),m=T(c),E&&E.l(c),a=T(c),P(g.$$.fragment,c),this.h()},h(){B(n,"href",i=be(l[1].criticalIssues[l[0]].point)),B(n,"target","_blank"),B(s,"href",o=ke(l[1].criticalIssues[l[0]].point)),B(s,"target","_blank"),Z(e,"display","flex"),Z(e,"justify-content","space-evenly")},m(c,L){w(c,e,L),A(e,n),A(n,t),A(e,f),A(e,s),A(s,r),w(c,u,L),F(p,c,L),w(c,k,L),F(v,c,L),w(c,N,L),F(b,c,L),w(c,m,L),E&&E.m(c,L),w(c,a,L),F(g,c,L),V=!0},p(c,[L]){(!V||L&3&&i!==(i=be(c[1].criticalIssues[c[0]].point)))&&B(n,"href",i),(!V||L&3&&o!==(o=ke(c[1].criticalIssues[c[0]].point)))&&B(s,"href",o);const X={};!S&&L&3&&(S=!0,X.value=c[1].criticalIssues[c[0]].criticalIssue,z(()=>S=!1)),p.$set(X);const Q={};!$&&L&3&&($=!0,Q.value=c[1].criticalIssues[c[0]].stage,z(()=>$=!1)),v.$set(Q);const fe={};!_&&L&3&&(_=!0,fe.value=c[1].criticalIssues[c[0]].locationName,z(()=>_=!1)),b.$set(fe),c[1].criticalIssues[c[0]].stage!="Design"?E?(E.p(c,L),L&3&&y(E,1)):(E=Te(c),E.c(),y(E,1),E.m(a.parentNode,a)):E&&(le(),I(E,1,1,()=>{E=null}),ne());const ce={};!C&&L&3&&(C=!0,ce.value=c[1].criticalIssues[c[0]].notes,z(()=>C=!1)),g.$set(ce)},i(c){V||(y(p.$$.fragment,c),y(v.$$.fragment,c),y(b.$$.fragment,c),y(E),y(g.$$.fragment,c),V=!0)},o(c){I(p.$$.fragment,c),I(v.$$.fragment,c),I(b.$$.fragment,c),I(E),I(g.$$.fragment,c),V=!1},d(c){c&&(d(e),d(u),d(k),d(N),d(m),d(a)),j(p,c),j(v,c),j(b,c),E&&E.d(c),j(g,c)}}}function Zt(l,e,n){let t;he(l,U,p=>n(1,t=p));let{idx:i}=e;function f(p){l.$$.not_equal(t.criticalIssues[i].criticalIssue,p)&&(t.criticalIssues[i].criticalIssue=p,U.set(t))}function s(p){l.$$.not_equal(t.criticalIssues[i].stage,p)&&(t.criticalIssues[i].stage=p,U.set(t))}function r(p){l.$$.not_equal(t.criticalIssues[i].locationName,p)&&(t.criticalIssues[i].locationName=p,U.set(t))}function o(p){l.$$.not_equal(t.criticalIssues[i].resolved,p)&&(t.criticalIssues[i].resolved=p,U.set(t))}function u(p){l.$$.not_equal(t.criticalIssues[i].notes,p)&&(t.criticalIssues[i].notes=p,U.set(t))}return l.$$set=p=>{"idx"in p&&n(0,i=p.idx)},[i,t,f,s,r,o,u]}class Ot extends ye{constructor(e){super(),Ce(this,e,Zt,Ut,we,{idx:0})}}function Be(l){let e,n,t;function i(s){l[5](s)}let f={label:"Resolved by Design",inlineSmall:!0};return l[1].policyConflictLog[l[0]].resolved!==void 0&&(f.value=l[1].policyConflictLog[l[0]].resolved),e=new Qe({props:f}),K.push(()=>Y(e,"value",i)),{c(){M(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,r){F(e,s,r),t=!0},p(s,r){const o={};!n&&r&3&&(n=!0,o.value=s[1].policyConflictLog[s[0]].resolved,z(()=>n=!1)),e.$set(o)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){I(e.$$.fragment,s),t=!1},d(s){j(e,s)}}}function Ht(l){let e,n,t,i,f,s,r,o,u,p,S,k,v,$,N,b,_,m,a,g,C,V;function ie(c){l[2](c)}let q={label:"Policy Conflict",emptyOption:!0,choices:Lt};l[1].policyConflictLog[l[0]].conflict!==void 0&&(q.value=l[1].policyConflictLog[l[0]].conflict),p=new ze({props:q}),K.push(()=>Y(p,"value",ie));function x(c){l[3](c)}let se={legend:"Stage",choices:Je(["Existing","Design"]),inlineSmall:!0};l[1].policyConflictLog[l[0]].stage!==void 0&&(se.value=l[1].policyConflictLog[l[0]].stage),v=new Ke({props:se}),K.push(()=>Y(v,"value",x));function ge(c){l[4](c)}let re={label:"Location Name"};l[1].policyConflictLog[l[0]].locationName!==void 0&&(re.value=l[1].policyConflictLog[l[0]].locationName),b=new Xe({props:re}),K.push(()=>Y(b,"value",ge));let E=l[1].policyConflictLog[l[0]].stage!="Design"&&Be(l);function $e(c){l[6](c)}let ae={label:"Commentary & Feedback"};return l[1].policyConflictLog[l[0]].notes!==void 0&&(ae.value=l[1].policyConflictLog[l[0]].notes),g=new Ye({props:ae}),K.push(()=>Y(g,"value",$e)),{c(){e=O("div"),n=O("a"),t=W("Google StreetView"),f=D(),s=O("a"),r=W("Bing Streetside"),u=D(),M(p.$$.fragment),k=D(),M(v.$$.fragment),N=D(),M(b.$$.fragment),m=D(),E&&E.c(),a=D(),M(g.$$.fragment),this.h()},l(c){e=H(c,"DIV",{style:!0});var L=R(e);n=H(L,"A",{href:!0,target:!0});var X=R(n);t=J(X,"Google StreetView"),X.forEach(d),f=T(L),s=H(L,"A",{href:!0,target:!0});var Q=R(s);r=J(Q,"Bing Streetside"),Q.forEach(d),L.forEach(d),u=T(c),P(p.$$.fragment,c),k=T(c),P(v.$$.fragment,c),N=T(c),P(b.$$.fragment,c),m=T(c),E&&E.l(c),a=T(c),P(g.$$.fragment,c),this.h()},h(){B(n,"href",i=be(l[1].policyConflictLog[l[0]].point)),B(n,"target","_blank"),B(s,"href",o=ke(l[1].policyConflictLog[l[0]].point)),B(s,"target","_blank"),Z(e,"display","flex"),Z(e,"justify-content","space-evenly")},m(c,L){w(c,e,L),A(e,n),A(n,t),A(e,f),A(e,s),A(s,r),w(c,u,L),F(p,c,L),w(c,k,L),F(v,c,L),w(c,N,L),F(b,c,L),w(c,m,L),E&&E.m(c,L),w(c,a,L),F(g,c,L),V=!0},p(c,[L]){(!V||L&3&&i!==(i=be(c[1].policyConflictLog[c[0]].point)))&&B(n,"href",i),(!V||L&3&&o!==(o=ke(c[1].policyConflictLog[c[0]].point)))&&B(s,"href",o);const X={};!S&&L&3&&(S=!0,X.value=c[1].policyConflictLog[c[0]].conflict,z(()=>S=!1)),p.$set(X);const Q={};!$&&L&3&&($=!0,Q.value=c[1].policyConflictLog[c[0]].stage,z(()=>$=!1)),v.$set(Q);const fe={};!_&&L&3&&(_=!0,fe.value=c[1].policyConflictLog[c[0]].locationName,z(()=>_=!1)),b.$set(fe),c[1].policyConflictLog[c[0]].stage!="Design"?E?(E.p(c,L),L&3&&y(E,1)):(E=Be(c),E.c(),y(E,1),E.m(a.parentNode,a)):E&&(le(),I(E,1,1,()=>{E=null}),ne());const ce={};!C&&L&3&&(C=!0,ce.value=c[1].policyConflictLog[c[0]].notes,z(()=>C=!1)),g.$set(ce)},i(c){V||(y(p.$$.fragment,c),y(v.$$.fragment,c),y(b.$$.fragment,c),y(E),y(g.$$.fragment,c),V=!0)},o(c){I(p.$$.fragment,c),I(v.$$.fragment,c),I(b.$$.fragment,c),I(E),I(g.$$.fragment,c),V=!1},d(c){c&&(d(e),d(u),d(k),d(N),d(m),d(a)),j(p,c),j(v,c),j(b,c),E&&E.d(c),j(g,c)}}}function Wt(l,e,n){let t;he(l,U,p=>n(1,t=p));let{idx:i}=e;function f(p){l.$$.not_equal(t.policyConflictLog[i].conflict,p)&&(t.policyConflictLog[i].conflict=p,U.set(t))}function s(p){l.$$.not_equal(t.policyConflictLog[i].stage,p)&&(t.policyConflictLog[i].stage=p,U.set(t))}function r(p){l.$$.not_equal(t.policyConflictLog[i].locationName,p)&&(t.policyConflictLog[i].locationName=p,U.set(t))}function o(p){l.$$.not_equal(t.policyConflictLog[i].resolved,p)&&(t.policyConflictLog[i].resolved=p,U.set(t))}function u(p){l.$$.not_equal(t.policyConflictLog[i].notes,p)&&(t.policyConflictLog[i].notes=p,U.set(t))}return l.$$set=p=>{"idx"in p&&n(0,i=p.idx)},[i,t,f,s,r,o,u]}class Jt extends ye{constructor(e){super(),Ce(this,e,Wt,Ht,we,{idx:0})}}const Kt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23FFFFFF'%3e%3cpath%20d='M402-40q-30%200-56-13.5T303-92L48-465l24-23q19-19%2045-22t47%2012l116%2081v-383q0-17%2011.5-28.5T320-840q17%200%2028.5%2011.5T360-800v537L212-367l157%20229q5%208%2014%2013t19%205h278q33%200%2056.5-23.5T760-200v-560q0-17%2011.5-28.5T800-800q17%200%2028.5%2011.5T840-760v560q0%2066-47%20113T680-40H402Zm38-440v-400q0-17%2011.5-28.5T480-920q17%200%2028.5%2011.5T520-880v400h-80Zm160%200v-360q0-17%2011.5-28.5T640-880q17%200%2028.5%2011.5T680-840v360h-80ZM486-300Z'%20fill='black'/%3e%3c/svg%3e",{window:zt}=bt;function Me(l,e,n){const t=l.slice();return t[42]=e[n],t[43]=e,t[44]=n,t}function Pe(l,e,n){const t=l.slice();return t[45]=e[n],t[46]=e,t[44]=n,t}function Fe(l,e,n){const t=l.slice();return t[42]=e[n],t[44]=n,t}function je(l,e,n){const t=l.slice();return t[45]=e[n],t[44]=n,t}function Yt(l){let e,n,t,i,f,s,r,o,u,p;e=new Pt({props:{$$slots:{default:[Qt]},$$scope:{ctx:l}}}),e.$on("click",l[11]),t=new Ft({props:{$$slots:{default:[xt]},$$scope:{ctx:l}}}),t.$on("click",l[13]),f=new Se({props:{$$slots:{default:[el]},$$scope:{ctx:l}}}),f.$on("click",l[27]);const S=[ll,tl],k=[];function v($,N){return $[1].id.kind=="critical"?0:1}return r=v(l),o=k[r]=S[r](l),{c(){M(e.$$.fragment),n=D(),M(t.$$.fragment),i=D(),M(f.$$.fragment),s=D(),o.c(),u=ee()},l($){P(e.$$.fragment,$),n=T($),P(t.$$.fragment,$),i=T($),P(f.$$.fragment,$),s=T($),o.l($),u=ee()},m($,N){F(e,$,N),w($,n,N),F(t,$,N),w($,i,N),F(f,$,N),w($,s,N),k[r].m($,N),w($,u,N),p=!0},p($,N){const b={};N[1]&262144&&(b.$$scope={dirty:N,ctx:$}),e.$set(b);const _={};N[1]&262144&&(_.$$scope={dirty:N,ctx:$}),t.$set(_);const m={};N[1]&262144&&(m.$$scope={dirty:N,ctx:$}),f.$set(m);let a=r;r=v($),r===a?k[r].p($,N):(le(),I(k[a],1,1,()=>{k[a]=null}),ne(),o=k[r],o?o.p($,N):(o=k[r]=S[r]($),o.c()),y(o,1),o.m(u.parentNode,u))},i($){p||(y(e.$$.fragment,$),y(t.$$.fragment,$),y(f.$$.fragment,$),y(o),p=!0)},o($){I(e.$$.fragment,$),I(t.$$.fragment,$),I(f.$$.fragment,$),I(o),p=!1},d($){$&&(d(n),d(i),d(s),d(u)),j(e,$),j(t,$),j(f,$),k[r].d($)}}}function Xt(l){let e,n,t,i="Critical Issues",f,s,r,o="Policy Conflicts",u,p,S;e=new Mt({props:{label:"Tools",open:!0,$$slots:{default:[ol]},$$scope:{ctx:l}}});let k=oe(l[3].criticalIssues),v=[];for(let m=0;m<k.length;m+=1)v[m]=Ge(je(l,k,m));const $=m=>I(v[m],1,1,()=>{v[m]=null});let N=oe(l[3].policyConflictLog),b=[];for(let m=0;m<N.length;m+=1)b[m]=Re(Fe(l,N,m));const _=m=>I(b[m],1,1,()=>{b[m]=null});return{c(){M(e.$$.fragment),n=D(),t=O("h3"),t.textContent=i,f=D();for(let m=0;m<v.length;m+=1)v[m].c();s=D(),r=O("h3"),r.textContent=o,u=D();for(let m=0;m<b.length;m+=1)b[m].c();p=ee()},l(m){P(e.$$.fragment,m),n=T(m),t=H(m,"H3",{"data-svelte-h":!0}),de(t)!=="svelte-1qhh5xr"&&(t.textContent=i),f=T(m);for(let a=0;a<v.length;a+=1)v[a].l(m);s=T(m),r=H(m,"H3",{"data-svelte-h":!0}),de(r)!=="svelte-eyxzjx"&&(r.textContent=o),u=T(m);for(let a=0;a<b.length;a+=1)b[a].l(m);p=ee()},m(m,a){F(e,m,a),w(m,n,a),w(m,t,a),w(m,f,a);for(let g=0;g<v.length;g+=1)v[g]&&v[g].m(m,a);w(m,s,a),w(m,r,a),w(m,u,a);for(let g=0;g<b.length;g+=1)b[g]&&b[g].m(m,a);w(m,p,a),S=!0},p(m,a){const g={};if(a[0]&97|a[1]&262144&&(g.$$scope={dirty:a,ctx:m}),e.$set(g),a[0]&33292){k=oe(m[3].criticalIssues);let C;for(C=0;C<k.length;C+=1){const V=je(m,k,C);v[C]?(v[C].p(V,a),y(v[C],1)):(v[C]=Ge(V),v[C].c(),y(v[C],1),v[C].m(s.parentNode,s))}for(le(),C=k.length;C<v.length;C+=1)$(C);ne()}if(a[0]&66060){N=oe(m[3].policyConflictLog);let C;for(C=0;C<N.length;C+=1){const V=Fe(m,N,C);b[C]?(b[C].p(V,a),y(b[C],1)):(b[C]=Re(V),b[C].c(),y(b[C],1),b[C].m(p.parentNode,p))}for(le(),C=N.length;C<b.length;C+=1)_(C);ne()}},i(m){if(!S){y(e.$$.fragment,m);for(let a=0;a<k.length;a+=1)y(v[a]);for(let a=0;a<N.length;a+=1)y(b[a]);S=!0}},o(m){I(e.$$.fragment,m),v=v.filter(Boolean);for(let a=0;a<v.length;a+=1)I(v[a]);b=b.filter(Boolean);for(let a=0;a<b.length;a+=1)I(b[a]);S=!1},d(m){m&&(d(n),d(t),d(f),d(s),d(r),d(u),d(p)),j(e,m),ve(v,m),ve(b,m)}}}function Qt(l){let e;return{c(){e=W("Save")},l(n){e=J(n,"Save")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function xt(l){let e;return{c(){e=W("Delete")},l(n){e=J(n,"Delete")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function el(l){let e;return{c(){e=W("Copy")},l(n){e=J(n,"Copy")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function tl(l){let e,n;return e=new Jt({props:{idx:l[1].id.idx}}),{c(){M(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,i){F(e,t,i),n=!0},p(t,i){const f={};i[0]&2&&(f.idx=t[1].id.idx),e.$set(f)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function ll(l){let e,n;return e=new Ot({props:{idx:l[1].id.idx}}),{c(){M(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,i){F(e,t,i),n=!0},p(t,i){const f={};i[0]&2&&(f.idx=t[1].id.idx),e.$set(f)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function nl(l){let e;return{c(){e=W("Zoom to fit")},l(n){e=J(n,"Zoom to fit")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function il(l){let e;return{c(){e=W("Show scheme context")},l(n){e=J(n,"Show scheme context")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function ol(l){let e,n,t,i,f,s,r,o,u,p,S,k;e=new Se({props:{$$slots:{default:[nl]},$$scope:{ctx:l}}}),e.$on("click",l[18]),t=new Et({}),f=new qt({});function v(_){l[19](_)}let $={map:l[0]};l[5]!==void 0&&($.enabled=l[5]),r=new Dt({props:$}),K.push(()=>Y(r,"enabled",v));function N(_){l[20](_)}let b={$$slots:{default:[il]},$$scope:{ctx:l}};return l[6]!==void 0&&(b.checked=l[6]),p=new Tt({props:b}),K.push(()=>Y(p,"checked",N)),{c(){M(e.$$.fragment),n=D(),M(t.$$.fragment),i=D(),M(f.$$.fragment),s=D(),M(r.$$.fragment),u=D(),M(p.$$.fragment)},l(_){P(e.$$.fragment,_),n=T(_),P(t.$$.fragment,_),i=T(_),P(f.$$.fragment,_),s=T(_),P(r.$$.fragment,_),u=T(_),P(p.$$.fragment,_)},m(_,m){F(e,_,m),w(_,n,m),F(t,_,m),w(_,i,m),F(f,_,m),w(_,s,m),F(r,_,m),w(_,u,m),F(p,_,m),k=!0},p(_,m){const a={};m[1]&262144&&(a.$$scope={dirty:m,ctx:_}),e.$set(a);const g={};m[0]&1&&(g.map=_[0]),!o&&m[0]&32&&(o=!0,g.enabled=_[5],z(()=>o=!1)),r.$set(g);const C={};m[1]&262144&&(C.$$scope={dirty:m,ctx:_}),!S&&m[0]&64&&(S=!0,C.checked=_[6],z(()=>S=!1)),p.$set(C)},i(_){k||(y(e.$$.fragment,_),y(t.$$.fragment,_),y(f.$$.fragment,_),y(r.$$.fragment,_),y(p.$$.fragment,_),k=!0)},o(_){I(e.$$.fragment,_),I(t.$$.fragment,_),I(f.$$.fragment,_),I(r.$$.fragment,_),I(p.$$.fragment,_),k=!1},d(_){_&&(d(n),d(i),d(s),d(u)),j(e,_),j(t,_),j(f,_),j(r,_),j(p,_)}}}function Ae(l){let e,n,t=l[45].resolved+"",i;return{c(){e=O("span"),n=W("Resolved: "),i=W(t)},l(f){e=H(f,"SPAN",{});var s=R(e);n=J(s,"Resolved: "),i=J(s,t),s.forEach(d)},m(f,s){w(f,e,s),A(e,n),A(e,i)},p(f,s){s[0]&8&&t!==(t=f[45].resolved+"")&&me(i,t)},d(f){f&&d(e)}}}function sl(l){let e,n,t,i=l[45].stage+"",f,s,r=l[45].stage!="Design"&&Ae(l);return{c(){e=O("div"),n=O("span"),t=W("Stage: "),f=W(i),s=D(),r&&r.c(),this.h()},l(o){e=H(o,"DIV",{style:!0});var u=R(e);n=H(u,"SPAN",{});var p=R(n);t=J(p,"Stage: "),f=J(p,i),p.forEach(d),s=T(u),r&&r.l(u),u.forEach(d),this.h()},h(){Z(e,"width","100%"),Z(e,"display","flex"),Z(e,"justify-content","space-between")},m(o,u){w(o,e,u),A(e,n),A(n,t),A(n,f),A(e,s),r&&r.m(e,null)},p(o,u){u[0]&8&&i!==(i=o[45].stage+"")&&me(f,i),o[45].stage!="Design"?r?r.p(o,u):(r=Ae(o),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(o){o&&d(e),r&&r.d()}}}function Ge(l){let e,n;function t(){return l[21](l[44])}function i(){return l[22](l[44])}return e=new et({props:{name:l[15](l[45]),$$slots:{default:[sl]},$$scope:{ctx:l}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",l[23]),{c(){M(e.$$.fragment)},l(f){P(e.$$.fragment,f)},m(f,s){F(e,f,s),n=!0},p(f,s){l=f;const r={};s[0]&8&&(r.name=l[15](l[45])),s[0]&8|s[1]&262144&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(f){n||(y(e.$$.fragment,f),n=!0)},o(f){I(e.$$.fragment,f),n=!1},d(f){j(e,f)}}}function Ve(l){let e,n,t=l[42].resolved+"",i;return{c(){e=O("span"),n=W("Resolved: "),i=W(t)},l(f){e=H(f,"SPAN",{});var s=R(e);n=J(s,"Resolved: "),i=J(s,t),s.forEach(d)},m(f,s){w(f,e,s),A(e,n),A(e,i)},p(f,s){s[0]&8&&t!==(t=f[42].resolved+"")&&me(i,t)},d(f){f&&d(e)}}}function rl(l){let e,n,t,i=l[42].stage+"",f,s,r,o=l[42].stage!="Design"&&Ve(l);return{c(){e=O("div"),n=O("span"),t=W("Stage: "),f=W(i),s=D(),o&&o.c(),r=D(),this.h()},l(u){e=H(u,"DIV",{style:!0});var p=R(e);n=H(p,"SPAN",{});var S=R(n);t=J(S,"Stage: "),f=J(S,i),S.forEach(d),s=T(p),o&&o.l(p),p.forEach(d),r=T(u),this.h()},h(){Z(e,"width","100%"),Z(e,"display","flex"),Z(e,"justify-content","space-between")},m(u,p){w(u,e,p),A(e,n),A(n,t),A(n,f),A(e,s),o&&o.m(e,null),w(u,r,p)},p(u,p){p[0]&8&&i!==(i=u[42].stage+"")&&me(f,i),u[42].stage!="Design"?o?o.p(u,p):(o=Ve(u),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(u){u&&(d(e),d(r)),o&&o.d()}}}function Re(l){let e,n;function t(){return l[24](l[44])}function i(){return l[25](l[44])}return e=new et({props:{name:l[16](l[42]),$$slots:{default:[rl]},$$scope:{ctx:l}}}),e.$on("click",t),e.$on("mouseenter",i),e.$on("mouseleave",l[26]),{c(){M(e.$$.fragment)},l(f){P(e.$$.fragment,f)},m(f,s){F(e,f,s),n=!0},p(f,s){l=f;const r={};s[0]&8&&(r.name=l[16](l[42])),s[0]&8|s[1]&262144&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(f){n||(y(e.$$.fragment,f),n=!0)},o(f){I(e.$$.fragment,f),n=!1},d(f){j(e,f)}}}function Ue(l){let e,n,t,i,f,s,r;return n=new Le({props:{$$slots:{default:[cl]},$$scope:{ctx:l}}}),n.$on("click",l[29]),i=new Le({props:{$$slots:{default:[_l]},$$scope:{ctx:l}}}),i.$on("click",l[30]),s=new Le({props:{$$slots:{default:[$l]},$$scope:{ctx:l}}}),s.$on("click",l[31]),{c(){e=O("div"),M(n.$$.fragment),t=D(),M(i.$$.fragment),f=D(),M(s.$$.fragment),this.h()},l(o){e=H(o,"DIV",{class:!0});var u=R(e);P(n.$$.fragment,u),t=T(u),P(i.$$.fragment,u),f=T(u),P(s.$$.fragment,u),u.forEach(d),this.h()},h(){B(e,"class","control-panel svelte-17y3eic")},m(o,u){w(o,e,u),F(n,e,null),A(e,t),F(i,e,null),A(e,f),F(s,e,null),r=!0},p(o,u){const p={};u[0]&2|u[1]&262144&&(p.$$scope={dirty:u,ctx:o}),n.$set(p);const S={};u[0]&2|u[1]&262144&&(S.$$scope={dirty:u,ctx:o}),i.$set(S);const k={};u[0]&2|u[1]&262144&&(k.$$scope={dirty:u,ctx:o}),s.$set(k)},i(o){r||(y(n.$$.fragment,o),y(i.$$.fragment,o),y(s.$$.fragment,o),r=!0)},o(o){I(n.$$.fragment,o),I(i.$$.fragment,o),I(s.$$.fragment,o),r=!1},d(o){o&&d(e),j(n),j(i),j(s)}}}function al(l){let e;return{c(){e=W("Move map")},l(n){e=J(n,"Move map")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function fl(l){let e,n="Move map";return{c(){e=O("u"),e.textContent=n},l(t){e=H(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-1719ytd"&&(e.textContent=n)},m(t,i){w(t,e,i)},d(t){t&&d(e)}}}function cl(l){let e,n,t,i;function f(o,u){return o[1].mode=="select"?fl:al}let s=f(l),r=s(l);return{c(){e=O("img"),t=D(),r.c(),i=ee(),this.h()},l(o){e=H(o,"IMG",{src:!0,alt:!0,style:!0}),t=T(o),r.l(o),i=ee(),this.h()},h(){dt(e.src,n=Kt)||B(e,"src",n),B(e,"alt","Move map"),Z(e,"vertical-align","middle")},m(o,u){w(o,e,u),w(o,t,u),r.m(o,u),w(o,i,u)},p(o,u){s!==(s=f(o))&&(r.d(1),r=s(o),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(d(e),d(t),d(i)),r.d(o)}}}function ul(l){let e;return{c(){e=W("New critical issue")},l(n){e=J(n,"New critical issue")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function pl(l){let e,n="New critical issue";return{c(){e=O("u"),e.textContent=n},l(t){e=H(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-1igjogw"&&(e.textContent=n)},m(t,i){w(t,e,i)},d(t){t&&d(e)}}}function _l(l){let e,n,t,i;function f(o,u){return o[1].mode=="new-critical"?pl:ul}let s=f(l),r=s(l);return{c(){e=ue("svg"),n=ue("polygon"),t=D(),r.c(),i=ee(),this.h()},l(o){e=pe(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=R(e);n=pe(u,"polygon",{points:!0,fill:!0,class:!0}),R(n).forEach(d),u.forEach(d),t=T(o),r.l(o),i=ee(),this.h()},h(){B(n,"points","12,0 0,24 24,24"),B(n,"fill",He.critical.background),B(n,"class","svelte-17y3eic"),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),Z(e,"vertical-align","middle")},m(o,u){w(o,e,u),A(e,n),w(o,t,u),r.m(o,u),w(o,i,u)},p(o,u){s!==(s=f(o))&&(r.d(1),r=s(o),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(d(e),d(t),d(i)),r.d(o)}}}function ml(l){let e;return{c(){e=W("New policy conflict")},l(n){e=J(n,"New policy conflict")},m(n,t){w(n,e,t)},d(n){n&&d(e)}}}function gl(l){let e,n="New policy conflict";return{c(){e=O("u"),e.textContent=n},l(t){e=H(t,"U",{"data-svelte-h":!0}),de(e)!=="svelte-14o8e5o"&&(e.textContent=n)},m(t,i){w(t,e,i)},d(t){t&&d(e)}}}function $l(l){let e,n,t,i;function f(o,u){return o[1].mode=="new-conflict"?gl:ml}let s=f(l),r=s(l);return{c(){e=ue("svg"),n=ue("circle"),t=D(),r.c(),i=ee(),this.h()},l(o){e=pe(o,"svg",{width:!0,height:!0,xmlns:!0,style:!0});var u=R(e);n=pe(u,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),R(n).forEach(d),u.forEach(d),t=T(o),r.l(o),i=ee(),this.h()},h(){B(n,"cx","12"),B(n,"cy","12"),B(n,"r","12"),B(n,"fill",We),B(e,"width","24"),B(e,"height","24"),B(e,"xmlns","http://www.w3.org/2000/svg"),Z(e,"vertical-align","middle")},m(o,u){w(o,e,u),A(e,n),w(o,t,u),r.m(o,u),w(o,i,u)},p(o,u){s!==(s=f(o))&&(r.d(1),r=s(o),r&&(r.c(),r.m(i.parentNode,i)))},d(o){o&&(d(e),d(t),d(i)),r.d(o)}}}function dl(l){let e,n,t,i=l[45].criticalIssue+"",f;return{c(){e=ue("svg"),n=ue("polygon"),t=ue("text"),f=W(i),this.h()},l(s){e=pe(s,"svg",{width:!0,height:!0,xmlns:!0});var r=R(e);n=pe(r,"polygon",{points:!0,fill:!0,class:!0}),R(n).forEach(d),t=pe(r,"text",{x:!0,y:!0});var o=R(t);f=J(o,i),o.forEach(d),r.forEach(d),this.h()},h(){B(n,"points","20,0 0,40 40,40"),B(n,"fill",He.critical.background),B(n,"class","svelte-17y3eic"),B(t,"x","13"),B(t,"y","30"),Z(t,"fill","white"),B(e,"width","40"),B(e,"height","40"),B(e,"xmlns","http://www.w3.org/2000/svg")},m(s,r){w(s,e,r),A(e,n),A(e,t),A(t,f)},p(s,r){r[0]&8&&i!==(i=s[45].criticalIssue+"")&&me(f,i)},d(s){s&&d(e)}}}function Ze(l){let e,n,t;function i(o){l[32](o,l[45])}function f(){return l[33](l[44])}function s(){return l[34](l[44])}let r={draggable:!0,$$slots:{default:[dl]},$$scope:{ctx:l}};return l[45].point!==void 0&&(r.lngLat=l[45].point),e=new xe({props:r}),K.push(()=>Y(e,"lngLat",i)),e.$on("click",f),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,u){F(e,o,u),t=!0},p(o,u){l=o;const p={};u[0]&8|u[1]&262144&&(p.$$scope={dirty:u,ctx:l}),!n&&u[0]&8&&(n=!0,p.lngLat=l[45].point,z(()=>n=!1)),e.$set(p)},i(o){t||(y(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function hl(l){let e,n=l[42].conflict+"",t;return{c(){e=O("span"),t=W(n),this.h()},l(i){e=H(i,"SPAN",{class:!0});var f=R(e);t=J(f,n),f.forEach(d),this.h()},h(){B(e,"class","dot svelte-17y3eic"),Z(e,"background",We)},m(i,f){w(i,e,f),A(e,t)},p(i,f){f[0]&8&&n!==(n=i[42].conflict+"")&&me(t,n)},d(i){i&&d(e)}}}function Oe(l){let e,n,t;function i(o){l[35](o,l[42])}function f(){return l[36](l[44])}function s(){return l[37](l[44])}let r={draggable:!0,$$slots:{default:[hl]},$$scope:{ctx:l}};return l[42].point!==void 0&&(r.lngLat=l[42].point),e=new xe({props:r}),K.push(()=>Y(e,"lngLat",i)),e.$on("click",f),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(o){P(e.$$.fragment,o)},m(o,u){F(e,o,u),t=!0},p(o,u){l=o;const p={};u[0]&8|u[1]&262144&&(p.$$scope={dirty:u,ctx:l}),!n&&u[0]&8&&(n=!0,p.lngLat=l[42].point,z(()=>n=!1)),e.$set(p)},i(o){t||(y(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){j(e,o)}}}function vl(l){let e,n;return e=new Ct({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){M(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,i){F(e,t,i),n=!0},p:ht,i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function bl(l){let e,n,t,i,f,s,r,o,u,p,S;e=new Bt({}),e.$on("click",l[12]);let k=l[1].mode!="editing"&&Ue(l);i=new wt({props:{gj:l[3].summary.networkMap,show:l[6]}});let v=oe(l[3].criticalIssues),$=[];for(let a=0;a<v.length;a+=1)$[a]=Ze(Pe(l,v,a));const N=a=>I($[a],1,1,()=>{$[a]=null});let b=oe(l[3].policyConflictLog),_=[];for(let a=0;a<b.length;a+=1)_[a]=Oe(Me(l,b,a));const m=a=>I(_[a],1,1,()=>{_[a]=null});return o=new yt({props:{data:l[7],$$slots:{default:[vl]},$$scope:{ctx:l}}}),p=new jt({props:{map:l[0]}}),{c(){M(e.$$.fragment),n=D(),k&&k.c(),t=D(),M(i.$$.fragment),f=D();for(let a=0;a<$.length;a+=1)$[a].c();s=D();for(let a=0;a<_.length;a+=1)_[a].c();r=D(),M(o.$$.fragment),u=D(),M(p.$$.fragment)},l(a){P(e.$$.fragment,a),n=T(a),k&&k.l(a),t=T(a),P(i.$$.fragment,a),f=T(a);for(let g=0;g<$.length;g+=1)$[g].l(a);s=T(a);for(let g=0;g<_.length;g+=1)_[g].l(a);r=T(a),P(o.$$.fragment,a),u=T(a),P(p.$$.fragment,a)},m(a,g){F(e,a,g),w(a,n,g),k&&k.m(a,g),w(a,t,g),F(i,a,g),w(a,f,g);for(let C=0;C<$.length;C+=1)$[C]&&$[C].m(a,g);w(a,s,g);for(let C=0;C<_.length;C+=1)_[C]&&_[C].m(a,g);w(a,r,g),F(o,a,g),w(a,u,g),F(p,a,g),S=!0},p(a,g){a[1].mode!="editing"?k?(k.p(a,g),g[0]&2&&y(k,1)):(k=Ue(a),k.c(),y(k,1),k.m(t.parentNode,t)):k&&(le(),I(k,1,1,()=>{k=null}),ne());const C={};if(g[0]&8&&(C.gj=a[3].summary.networkMap),g[0]&64&&(C.show=a[6]),i.$set(C),g[0]&264){v=oe(a[3].criticalIssues);let q;for(q=0;q<v.length;q+=1){const x=Pe(a,v,q);$[q]?($[q].p(x,g),y($[q],1)):($[q]=Ze(x),$[q].c(),y($[q],1),$[q].m(s.parentNode,s))}for(le(),q=v.length;q<$.length;q+=1)N(q);ne()}if(g[0]&264){b=oe(a[3].policyConflictLog);let q;for(q=0;q<b.length;q+=1){const x=Me(a,b,q);_[q]?(_[q].p(x,g),y(_[q],1)):(_[q]=Oe(x),_[q].c(),y(_[q],1),_[q].m(r.parentNode,r))}for(le(),q=b.length;q<_.length;q+=1)m(q);ne()}const V={};g[0]&128&&(V.data=a[7]),g[1]&262144&&(V.$$scope={dirty:g,ctx:a}),o.$set(V);const ie={};g[0]&1&&(ie.map=a[0]),p.$set(ie)},i(a){if(!S){y(e.$$.fragment,a),y(k),y(i.$$.fragment,a);for(let g=0;g<v.length;g+=1)y($[g]);for(let g=0;g<b.length;g+=1)y(_[g]);y(o.$$.fragment,a),y(p.$$.fragment,a),S=!0}},o(a){I(e.$$.fragment,a),I(k),I(i.$$.fragment,a),$=$.filter(Boolean);for(let g=0;g<$.length;g+=1)I($[g]);_=_.filter(Boolean);for(let g=0;g<_.length;g+=1)I(_[g]);I(o.$$.fragment,a),I(p.$$.fragment,a),S=!1},d(a){a&&(d(n),d(t),d(f),d(s),d(r),d(u)),j(e,a),k&&k.d(a),j(i,a),ve($,a),ve(_,a),j(o,a),j(p,a)}}}function kl(l){let e,n,t,i,f,s,r,o,u,p,S;const k=[Xt,Yt],v=[];function $(_,m){return _[1].mode!="editing"?0:1}t=$(l),i=v[t]=k[t](l);function N(_){l[38](_)}let b={$$slots:{default:[bl]},$$scope:{ctx:l}};return l[0]!==void 0&&(b.map=l[0]),r=new vt({props:b}),K.push(()=>Y(r,"map",N)),{c(){e=O("div"),n=O("div"),i.c(),f=D(),s=O("div"),M(r.$$.fragment),this.h()},l(_){e=H(_,"DIV",{style:!0});var m=R(e);n=H(m,"DIV",{style:!0});var a=R(n);i.l(a),a.forEach(d),f=T(m),s=H(m,"DIV",{style:!0});var g=R(s);P(r.$$.fragment,g),g.forEach(d),m.forEach(d),this.h()},h(){Z(n,"width","30%"),Z(n,"overflow-y","scroll"),Z(n,"padding","10px"),Z(n,"border","1px solid black"),Z(s,"position","relative"),Z(s,"width","70%"),Z(e,"display","flex"),Z(e,"height","80vh")},m(_,m){w(_,e,m),A(e,n),v[t].m(n,null),l[28](n),A(e,f),A(e,s),F(r,s,null),u=!0,p||(S=gt(zt,"keydown",l[17]),p=!0)},p(_,m){let a=t;t=$(_),t===a?v[t].p(_,m):(le(),I(v[a],1,1,()=>{v[a]=null}),ne(),i=v[t],i?i.p(_,m):(i=v[t]=k[t](_),i.c()),y(i,1),i.m(n,null));const g={};m[0]&203|m[1]&262144&&(g.$$scope={dirty:m,ctx:_}),!o&&m[0]&1&&(o=!0,g.map=_[0],z(()=>o=!1)),r.$set(g)},i(_){u||(y(i),y(r.$$.fragment,_),u=!0)},o(_){I(i),I(r.$$.fragment,_),u=!1},d(_){_&&d(e),v[t].d(),l[28](null),j(r),p=!1,S()}}}function wl(l,e,n){let t={type:"FeatureCollection",features:[]},i=e.mode=="editing"?e.id:n;if(i!=null){let f=i.kind=="critical"?l.criticalIssues:l.policyConflictLog;t.features.push(Ne(f[i.idx].point))}return t}function Ne(l){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:l}}}function yl(l,e,n){let t,i,f;he(l,U,h=>n(3,i=h)),he(l,At,h=>n(40,f=h));let s,r,o={mode:"select"},u=f.url.searchParams.get("kind")||"";u=="critical"?o={mode:"new-critical"}:u=="conflict"&&(o={mode:"new-conflict"});let p=null,S=null,k=!1,v=!0;async function $(h){p=r.scrollTop,n(1,o={mode:"editing",id:h}),n(2,S=null),await Ie(),n(4,r.scrollTop=0,r)}async function N(h){p=r.scrollTop,n(1,o={mode:"editing",id:h}),n(2,S=null),await Ie(),n(4,r.scrollTop=0,r);let G=h.kind=="critical"?i.criticalIssues:i.policyConflictLog;s.flyTo({center:G[h.idx].point,duration:500})}async function b(h){let G=h.kind=="critical"?i.criticalIssues:i.policyConflictLog,te=JSON.parse(JSON.stringify(G[h.idx])),at=s.getBounds().getWest(),ft=s.getBounds().getEast();te.point[0]+=(ft-at)*.05;let Ee=G.toSpliced(h.idx+1,0,te);h.kind=="critical"?_e(U,i.criticalIssues=Ee,i):_e(U,i.policyConflictLog=Ee,i),$({kind:h.kind,idx:h.idx+1})}async function _(){n(1,o={mode:"select"}),_e(U,i.policyConflictLog=i.policyConflictLog.toSorted((h,G)=>qe(h.conflict)-qe(G.conflict)),i),_e(U,i.criticalIssues=i.criticalIssues.toSorted((h,G)=>De(h.criticalIssue)-De(G.criticalIssue)),i),p!=null&&(await Ie(),n(4,r.scrollTop=p,r),p=null)}function m(h){if(!k&&o.mode!="select"){if(o.mode=="editing"){_();return}o.mode=="new-critical"?(_e(U,i.criticalIssues=[...i.criticalIssues,{criticalIssue:f.url.searchParams.get("code")||"",stage:"",point:h.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),$({kind:"critical",idx:i.criticalIssues.length-1})):o.mode=="new-conflict"&&(_e(U,i.policyConflictLog=[...i.policyConflictLog,{conflict:f.url.searchParams.get("code")||"",stage:"",point:h.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),$({kind:"conflict",idx:i.policyConflictLog.length-1}))}}$t(()=>{g(!1)});function a(){o.mode=="editing"&&window.confirm("Delete this entry?")&&(o.id.kind=="critical"?(i.criticalIssues.splice(o.id.idx,1),U.set(i)):(i.policyConflictLog.splice(o.id.idx,1),U.set(i)),_())}function g(h){let G={type:"FeatureCollection",features:[...i.criticalIssues.map(te=>Ne(te.point)),...i.policyConflictLog.map(te=>Ne(te.point)),...i.summary.networkMap.features]};G.features.length>0&&s.fitBounds(kt(G),{padding:20,animate:h})}function C(h){let G=h.criticalIssue?Nt(h.criticalIssue):"Unknown critical";return h.locationName?`${G} (${h.locationName})`:G}function V(h){let G=h.conflict?St(h.conflict):"Unknown conflict";return h.locationName?`${G} (${h.locationName})`:G}function ie(h){if(o.mode=="editing"){let G=h.target.tagName,te=G=="INPUT"||G=="TEXTAREA";h.key=="Escape"||h.key=="Enter"&&!te?(h.stopPropagation(),_()):h.key=="Delete"&&!te&&(h.stopPropagation(),a())}else(o.mode=="new-critical"||o.mode=="new-conflict")&&h.key=="Escape"&&(h.stopPropagation(),n(1,o={mode:"select"}))}const q=()=>g(!0);function x(h){k=h,n(5,k)}function se(h){v=h,n(6,v)}const ge=h=>N({kind:"critical",idx:h}),re=h=>n(2,S={kind:"critical",idx:h}),E=()=>n(2,S=null),$e=h=>N({kind:"conflict",idx:h}),ae=h=>n(2,S={kind:"conflict",idx:h}),c=()=>n(2,S=null),L=()=>b({kind:o.id.kind,idx:o.id.idx});function X(h){K[h?"unshift":"push"](()=>{r=h,n(4,r)})}const Q=()=>_(),fe=()=>n(1,o={mode:"new-critical"}),ce=()=>n(1,o={mode:"new-conflict"});function tt(h,G){l.$$.not_equal(G.point,h)&&(G.point=h,U.set(i))}const lt=h=>$({kind:"critical",idx:h}),nt=h=>$({kind:"critical",idx:h});function it(h,G){l.$$.not_equal(G.point,h)&&(G.point=h,U.set(i))}const ot=h=>$({kind:"conflict",idx:h}),st=h=>$({kind:"conflict",idx:h});function rt(h){s=h,n(0,s)}return l.$$.update=()=>{l.$$.dirty[0]&3&&s&&(s.getCanvas().style.cursor=o.mode=="new-critical"||o.mode=="new-conflict"?"crosshair":"auto"),l.$$.dirty[0]&14&&n(7,t=wl(i,o,S))},[s,o,S,i,r,k,v,t,$,N,b,_,m,a,g,C,V,ie,q,x,se,ge,re,E,$e,ae,c,L,X,Q,fe,ce,tt,lt,nt,it,ot,st,rt]}class Jl extends ye{constructor(e){super(),Ce(this,e,yl,kl,we,{},null,[-1,-1])}}export{Jl as component};
