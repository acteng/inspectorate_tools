import{s as de,a as C,g as S,i as k,f as _,U as be,e as x,c as L,m as ee,p as E,w as ve,n as P,y as ke,b as X,h as v,H as Ie,l as ye,t as q,d as V,j as $e,u as Fe,r as Ce,v as Se,q as oe,ab as ie,x as Q,o as se}from"./scheduler.V-ByFQ7u.js";import{S as _e,i as ge,c as j,a as G,m as M,t as b,b as F,d as B,g as te,f as le}from"./index.Zcf2TLuh.js";import{e as ae}from"./each.BkLWSQYL.js";import{L as xe,d as Le}from"./download.DhJTx1nr.js";import{b as De}from"./paths.3dPtMGkw.js";import{g as Ee}from"./entry.Dh4FV_pA.js";import{B as He}from"./ButtonGroup.DzOmczhL.js";import{D as Ae}from"./DefaultButton.CzxH7UXd.js";import{F as je}from"./FileInput.qPcioyto.js";/* empty css                                            */import{S as re}from"./SecondaryButton.BQqRVY7L.js";import{W as he}from"./WarningButton.BdQPQy4u.js";import{b as we}from"./index.BFmk86Ew.js";import{F as Ge}from"./FormElement.CMFdi_7n.js";import"./index.5rBgVICt.js";import{C as Me}from"./ClickableCard.DTtXZajF.js";const Be="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000000'%3e%3cpath%20d='M200-200h57l391-391-57-57-391%20391v57Zm-80%2080v-170l528-527q12-11%2026.5-17t30.5-6q16%200%2031%206t26%2018l55%2056q12%2011%2017.5%2026t5.5%2030q0%2016-5.5%2030.5T817-647L290-120H120Zm640-584-56-56%2056%2056Zm-141%2085-28-29%2057%2057-29-28Z'/%3e%3c/svg%3e",Re="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%200%2024%2024'%20width='24px'%20fill='white'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M6%2019c0%201.1.9%202%202%202h8c1.1%200%202-.9%202-2V7H6v12zM19%204h-3.5l-1-1h-5l-1%201H5v2h14V4z'/%3e%3c/svg%3e";function qe(s){let e,t,l,r=`You can import from an existing route check .xlsx file, <b>only if there&#39;s an up-to-date DALOG sheet added</b>
    . After importing, there will still be some problems:
    <ul><li>You must fill out the Junction Assessment Tool (JAT); it won&#39;t be
        imported</li> <li>Some text fields on the Summary of Scheme page will be missing</li></ul>`,n,i;return{c(){e=x("input"),t=C(),l=x("div"),l.innerHTML=r,this.h()},l(o){e=L(o,"INPUT",{class:!0,id:!0,type:!0}),t=S(o),l=L(o,"DIV",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-1alapt1"&&(l.innerHTML=r),this.h()},h(){E(e,"class","govuk-file-upload"),E(e,"id","import-xlsx"),E(e,"type","file"),E(l,"class","govuk-hint")},m(o,m){k(o,e,m),s[4](e),k(o,t,m),k(o,l,m),n||(i=ve(e,"change",s[2]),n=!0)},p:P,d(o){o&&(_(e),_(t),_(l)),s[4](null),n=!1,i()}}}function Ve(s){let e,t,l,r;return e=new Ge({props:{label:"Import from XLSX file",id:"import-xlsx",$$slots:{default:[qe]},$$scope:{ctx:s}}}),l=new xe({props:{loading:s[0]}}),{c(){j(e.$$.fragment),t=C(),j(l.$$.fragment)},l(n){G(e.$$.fragment,n),t=S(n),G(l.$$.fragment,n)},m(n,i){M(e,n,i),k(n,t,i),M(l,n,i),r=!0},p(n,[i]){const o={};i&66&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const m={};i&1&&(m.loading=n[0]),l.$set(m)},i(n){r||(b(e.$$.fragment,n),b(l.$$.fragment,n),r=!0)},o(n){F(e.$$.fragment,n),F(l.$$.fragment,n),r=!1},d(n){n&&_(t),B(e,n),B(l,n)}}}function Ue(s,e,t){let l=be(),{xlsxImporter:r}=e,n="",i;async function o($){let g=i.files[0].name;try{t(0,n=`Loading ${g}`);let c=await i.files[0].arrayBuffer(),a=await r(c);t(0,n=""),l("imported",{filename:we(g,".xlsx"),data:a})}catch(c){window.alert(`Couldn't import ${g}: ${c}`),t(0,n="")}}function m($){ke[$?"unshift":"push"](()=>{i=$,t(1,i)})}return s.$$set=$=>{"xlsxImporter"in $&&t(3,r=$.xlsxImporter)},[n,i,o,r,m]}class Ye extends _e{constructor(e){super(),ge(this,e,Ue,Ve,de,{xlsxImporter:3})}}function fe(s,e,t){const l=s.slice();return l[20]=e[t],l}function ue(s){let e,t,l,r,n,i,o,m,$;o=new He({props:{$$slots:{default:[ze]},$$scope:{ctx:s}}});const g=s[13].default,c=ye(g,s,s[18],null);return{c(){e=x("p"),t=q("You're currently editing "),l=x("u"),r=q(s[5]),n=q(`
      .`),i=C(),j(o.$$.fragment),m=C(),c&&c.c()},l(a){e=L(a,"P",{});var f=X(e);t=V(f,"You're currently editing "),l=L(f,"U",{});var D=X(l);r=V(D,s[5]),D.forEach(_),n=V(f,`
      .`),f.forEach(_),i=S(a),G(o.$$.fragment,a),m=S(a),c&&c.l(a)},m(a,f){k(a,e,f),v(e,t),v(e,l),v(l,r),v(e,n),k(a,i,f),M(o,a,f),k(a,m,f),c&&c.m(a,f),$=!0},p(a,f){(!$||f&32)&&$e(r,a[5]);const D={};f&262176&&(D.$$scope={dirty:f,ctx:a}),o.$set(D),c&&c.p&&(!$||f&262144)&&Fe(c,g,a,a[18],$?Se(g,a[18],f,null):Ce(a[18]),null)},i(a){$||(b(o.$$.fragment,a),b(c,a),$=!0)},o(a){F(o.$$.fragment,a),F(c,a),$=!1},d(a){a&&(_(e),_(i),_(m)),B(o,a),c&&c.d(a)}}}function Ne(s){let e,t,l;return{c(){e=x("img"),l=q(`
        Rename this file`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),l=V(r,`
        Rename this file`),this.h()},h(){se(e.src,t=Be)||E(e,"src",t),E(e,"alt","Rename this file"),E(e,"class","svelte-v2g1wg")},m(r,n){k(r,e,n),k(r,l,n)},p:P,d(r){r&&(_(e),_(l))}}}function Te(s){let e,t,l;return{c(){e=x("img"),l=q(`
        Export .json`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),l=V(r,`
        Export .json`),this.h()},h(){se(e.src,t=Le)||E(e,"src",t),E(e,"alt","Export .json"),E(e,"class","svelte-v2g1wg")},m(r,n){k(r,e,n),k(r,l,n)},p:P,d(r){r&&(_(e),_(l))}}}function Je(s){let e,t,l;return{c(){e=x("img"),l=q(`
        Delete this file`),this.h()},l(r){e=L(r,"IMG",{src:!0,alt:!0,class:!0}),l=V(r,`
        Delete this file`),this.h()},h(){se(e.src,t=Re)||E(e,"src",t),E(e,"alt","Delete this file"),E(e,"class","svelte-v2g1wg")},m(r,n){k(r,e,n),k(r,l,n)},p:P,d(r){r&&(_(e),_(l))}}}function ze(s){let e,t,l,r,n,i;return e=new re({props:{$$slots:{default:[Ne]},$$scope:{ctx:s}}}),e.$on("click",s[6]),l=new re({props:{$$slots:{default:[Te]},$$scope:{ctx:s}}}),l.$on("click",s[7]),n=new he({props:{$$slots:{default:[Je]},$$scope:{ctx:s}}}),n.$on("click",s[14]),{c(){j(e.$$.fragment),t=C(),j(l.$$.fragment),r=C(),j(n.$$.fragment)},l(o){G(e.$$.fragment,o),t=S(o),G(l.$$.fragment,o),r=S(o),G(n.$$.fragment,o)},m(o,m){M(e,o,m),k(o,t,m),M(l,o,m),k(o,r,m),M(n,o,m),i=!0},p(o,m){const $={};m&262144&&($.$$scope={dirty:m,ctx:o}),e.$set($);const g={};m&262144&&(g.$$scope={dirty:m,ctx:o}),l.$set(g);const c={};m&262144&&(c.$$scope={dirty:m,ctx:o}),n.$set(c)},i(o){i||(b(e.$$.fragment,o),b(l.$$.fragment,o),b(n.$$.fragment,o),i=!0)},o(o){F(e.$$.fragment,o),F(l.$$.fragment,o),F(n.$$.fragment,o),i=!1},d(o){o&&(_(t),_(r)),B(e,o),B(l,o),B(n,o)}}}function Xe(s){let e;return{c(){e=q("New blank file")},l(t){e=V(t,"New blank file")},m(t,l){k(t,e,l)},d(t){t&&_(e)}}}function ce(s){let e,t,l,r;return l=new Ye({props:{xlsxImporter:s[3]}}),l.$on("imported",s[11]),{c(){e=x("hr"),t=C(),j(l.$$.fragment)},l(n){e=L(n,"HR",{}),t=S(n),G(l.$$.fragment,n)},m(n,i){k(n,e,i),k(n,t,i),M(l,n,i),r=!0},p(n,i){const o={};i&8&&(o.xlsxImporter=n[3]),l.$set(o)},i(n){r||(b(l.$$.fragment,n),r=!0)},o(n){F(l.$$.fragment,n),r=!1},d(n){n&&(_(e),_(t)),B(l,n)}}}function Ze(s){let e=(s[20]==s[5]?"Currently open":s[0].describeFile(s[20]))+"",t;return{c(){t=q(e)},l(l){t=V(l,e)},m(l,r){k(l,t,r)},p(l,r){r&49&&e!==(e=(l[20]==l[5]?"Currently open":l[0].describeFile(l[20]))+"")&&$e(t,e)},d(l){l&&_(t)}}}function Oe(s){let e,t;function l(){return s[17](s[20])}return e=new he({props:{$$slots:{default:[We]},$$scope:{ctx:s}}}),e.$on("click",l),{c(){j(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,n){M(e,r,n),t=!0},p(r,n){s=r;const i={};n&262144&&(i.$$scope={dirty:n,ctx:s}),e.$set(i)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){F(e.$$.fragment,r),t=!1},d(r){B(e,r)}}}function Pe(s){let e,t;return e=new Ae({props:{$$slots:{default:[Ke]},$$scope:{ctx:s}}}),e.$on("click",s[16]),{c(){j(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,r){M(e,l,r),t=!0},p(l,r){const n={};r&262144&&(n.$$scope={dirty:r,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){B(e,l)}}}function We(s){let e;return{c(){e=q("Delete")},l(t){e=V(t,"Delete")},m(t,l){k(t,e,l)},d(t){t&&_(e)}}}function Ke(s){let e;return{c(){e=q("Start")},l(t){e=V(t,"Start")},m(t,l){k(t,e,l)},d(t){t&&_(e)}}}function me(s){let e,t,l,r,n,i,o;function m(){return s[15](s[20])}t=new Me({props:{name:`File name: ${s[20]}`,disabled:s[20]===s[5],$$slots:{default:[Ze]},$$scope:{ctx:s}}}),t.$on("click",m);const $=[Pe,Oe],g=[];function c(a,f){return a[20]==a[5]?0:1}return r=c(s),n=g[r]=$[r](s),{c(){e=x("div"),j(t.$$.fragment),l=C(),n.c(),i=C(),this.h()},l(a){e=L(a,"DIV",{style:!0});var f=X(e);G(t.$$.fragment,f),l=S(f),n.l(f),i=S(f),f.forEach(_),this.h()},h(){oe(e,"display","flex"),oe(e,"justify-content","space-between")},m(a,f){k(a,e,f),M(t,e,null),v(e,l),g[r].m(e,null),v(e,i),o=!0},p(a,f){s=a;const D={};f&16&&(D.name=`File name: ${s[20]}`),f&48&&(D.disabled=s[20]===s[5]),f&262193&&(D.$$scope={dirty:f,ctx:s}),t.$set(D);let H=r;r=c(s),r===H?g[r].p(s,f):(te(),F(g[H],1,1,()=>{g[H]=null}),le(),n=g[r],n?n.p(s,f):(n=g[r]=$[r](s),n.c()),b(n,1),n.m(e,i))},i(a){o||(b(t.$$.fragment,a),b(n),o=!0)},o(a){F(t.$$.fragment,a),F(n),o=!1},d(a){a&&_(e),B(t),g[r].d()}}}function Qe(s){let e,t,l=`All files are auto-saved in your browser's local storage. You can close your
    browser and resume later. You can export the file to your computer to share
    with someone else, and import from a file below.`,r,n,i,o,m,$,g,c="Create or import a file",a,f,D,H,W,U,T,Z,R,N,J="Load a saved file",K,O,I=s[5]&&ue(s);f=new re({props:{$$slots:{default:[Xe]},$$scope:{ctx:s}}}),f.$on("click",s[9]),U=new je({props:{label:"Import from a .json file",onLoad:s[10]}});let y=s[3]!=null&&ce(s),u=ae(s[4]),p=[];for(let d=0;d<u.length;d+=1)p[d]=me(fe(s,u,d));const Y=d=>F(p[d],1,1,()=>{p[d]=null});return{c(){e=x("div"),t=x("p"),t.textContent=l,r=C(),I&&I.c(),n=C(),i=x("hr"),o=C(),m=x("div"),$=x("div"),g=x("h2"),g.textContent=c,a=C(),j(f.$$.fragment),D=C(),H=x("hr"),W=C(),j(U.$$.fragment),T=C(),y&&y.c(),Z=C(),R=x("div"),N=x("h2"),N.textContent=J,K=C();for(let d=0;d<p.length;d+=1)p[d].c();this.h()},l(d){e=L(d,"DIV",{class:!0});var h=X(e);t=L(h,"P",{"data-svelte-h":!0}),ee(t)!=="svelte-1yvzirp"&&(t.textContent=l),r=S(h),I&&I.l(h),n=S(h),i=L(h,"HR",{}),o=S(h),m=L(h,"DIV",{class:!0});var A=X(m);$=L(A,"DIV",{class:!0});var w=X($);g=L(w,"H2",{"data-svelte-h":!0}),ee(g)!=="svelte-1yqhw3l"&&(g.textContent=c),a=S(w),G(f.$$.fragment,w),D=S(w),H=L(w,"HR",{}),W=S(w),G(U.$$.fragment,w),T=S(w),y&&y.l(w),w.forEach(_),Z=S(A),R=L(A,"DIV",{class:!0});var z=X(R);N=L(z,"H2",{"data-svelte-h":!0}),ee(N)!=="svelte-oj70x0"&&(N.textContent=J),K=S(z);for(let ne=0;ne<p.length;ne+=1)p[ne].l(z);z.forEach(_),A.forEach(_),h.forEach(_),this.h()},h(){E($,"class","govuk-grid-column-one-half"),E(R,"class","govuk-grid-column-one-half"),E(m,"class","govuk-grid-row"),E(e,"class","govuk-width-container")},m(d,h){k(d,e,h),v(e,t),v(e,r),I&&I.m(e,null),v(e,n),v(e,i),v(e,o),v(e,m),v(m,$),v($,g),v($,a),M(f,$,null),v($,D),v($,H),v($,W),M(U,$,null),v($,T),y&&y.m($,null),v(m,Z),v(m,R),v(R,N),v(R,K);for(let A=0;A<p.length;A+=1)p[A]&&p[A].m(R,null);O=!0},p(d,[h]){d[5]?I?(I.p(d,h),h&32&&b(I,1)):(I=ue(d),I.c(),b(I,1),I.m(e,n)):I&&(te(),F(I,1,1,()=>{I=null}),le());const A={};if(h&262144&&(A.$$scope={dirty:h,ctx:d}),f.$set(A),d[3]!=null?y?(y.p(d,h),h&8&&b(y,1)):(y=ce(d),y.c(),b(y,1),y.m($,null)):y&&(te(),F(y,1,1,()=>{y=null}),le()),h&4401){u=ae(d[4]);let w;for(w=0;w<u.length;w+=1){const z=fe(d,u,w);p[w]?(p[w].p(z,h),b(p[w],1)):(p[w]=me(z),p[w].c(),b(p[w],1),p[w].m(R,null))}for(te(),w=u.length;w<p.length;w+=1)Y(w);le()}},i(d){if(!O){b(I),b(f.$$.fragment,d),b(U.$$.fragment,d),b(y);for(let h=0;h<u.length;h+=1)b(p[h]);O=!0}},o(d){F(I),F(f.$$.fragment,d),F(U.$$.fragment,d),F(y),p=p.filter(Boolean);for(let h=0;h<p.length;h+=1)F(p[h]);O=!1},d(d){d&&_(e),I&&I.d(),B(f),B(U),y&&y.d(),Ie(p,d)}}}function pe(s,e){let t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",s),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function et(s,e,t){let l,r=P,n=()=>(r(),r=ie(f,u=>t(19,l=u)),f),i,o=P,m=()=>(o(),o=ie(a,u=>t(5,i=u)),a);s.$$.on_destroy.push(()=>r()),s.$$.on_destroy.push(()=>o());let{$$slots:$={},$$scope:g}=e,{files:c}=e,{currentFile:a}=e;m();let{state:f}=e;n();let{xlsxImporter:D=null}=e,H=c.getFileList();function W(){let u=window.prompt(`Rename file ${i} to what?`,i);if(u){let p=c.key(i),Y=window.localStorage.getItem(p);window.localStorage.setItem(c.key(u),Y),window.localStorage.removeItem(p),Q(a,i=u,i),t(4,H=c.getFileList())}}function U(){pe(i+".json",JSON.stringify(l))}function T(u){if(window.confirm(`Really delete file ${u}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`)){let p=c.key(u);pe(`${u}.json`,window.localStorage.getItem(p)),window.localStorage.removeItem(p),u==i?Z():t(4,H=c.saveAndGetFileList(i,l))}}function Z(){let u=window.prompt("What do you want to name your new file?");u&&(Q(a,i=u,i),Q(f,l=c.emptyState(),l),t(4,H=c.saveAndGetFileList(i,l)))}function R(u,p){let Y=we(u,".json");try{let d=JSON.parse(p);c.validate(d),t(4,H=c.saveAndGetFileList(Y,d)),J(Y)}catch(d){window.alert(`Couldn't load ${Y}: ${d}`)}}function N(u){let{filename:p,data:Y}=u.detail;t(4,H=c.saveAndGetFileList(p,Y)),J(p)}function J(u){try{let p=c.loadFile(u);Q(a,i=u,i),Q(f,l=p,l)}catch(p){window.alert(`Couldn't load ${u}: ${p}`)}}const K=()=>T(i),O=u=>J(u),I=()=>Ee(`${De}/${c.prefix}nav`),y=u=>T(u);return s.$$set=u=>{"files"in u&&t(0,c=u.files),"currentFile"in u&&m(t(1,a=u.currentFile)),"state"in u&&n(t(2,f=u.state)),"xlsxImporter"in u&&t(3,D=u.xlsxImporter),"$$scope"in u&&t(18,g=u.$$scope)},[c,a,f,D,H,i,W,U,T,Z,R,N,J,$,K,O,I,y,g]}class gt extends _e{constructor(e){super(),ge(this,e,et,Qe,de,{files:0,currentFile:1,state:2,xlsxImporter:3})}}export{gt as F};
