import{s as Ne,e as ne,a as O,t as Y,c as re,b as le,f as E,g as N,m as sr,d as Z,p as wt,i as P,h as j,z as hn,n as Se,y as ur,k as Te,j as Qe,E as Ve,P as lr,w as G,q as de,x as q}from"../chunks/scheduler.BRgMYiaX.js";import{S as De,i as Fe,c as R,a as M,m as L,t as $,g as Mt,b as S,f as Lt,d as A,e as z}from"../chunks/index.CW-K1Ej7.js";import{p as Me}from"../chunks/index.DmeT8wtF.js";import{D as pn}from"../chunks/DecimalInput.CXGLrYoW.js";import{R as pt}from"../chunks/Radio.DE-vcnKG.js";import{S as gn}from"../chunks/Select.3BicTkTR.js";import{S as ar,a as fr,t as cr,r as hr,f as pr,d as gr}from"../chunks/lists.CrgdB55u.js";import{T as qe}from"../chunks/TextArea.DjJlSu_a.js";import{T as gt}from"../chunks/TextInput.DuqxpaI2.js";import{s as K}from"../chunks/data.BushiD7U.js";import{t as _r}from"../chunks/index.BVZSZy1Y.js";import{z as mr,A as Nn,B as dr,D as yr,G as At,C as br,E as wr,H as _n,L as It,I as vr,F as $r,J as xr,M as Er,b as Sr}from"../chunks/index.CFfL3nSA.js";import{t as mn}from"../chunks/index.BL_bCvqT.js";import{w as Xe}from"../chunks/index.CM9SHt_m.js";import{S as _t}from"../chunks/SecondaryButton.B-Bksj3G.js";/* empty css                                                    */import{D as kr}from"../chunks/DateInput.DrDG69fm.js";const Rr=""+new URL("../assets/authorities.GD_9e3jr.geojson",import.meta.url).href;/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Mr(i,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,r,o,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(c){return function(p){return l([c,p])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,r&&(o=c[0]&2?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(i,t)}catch(p){c=[6,p],r=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var $e=function(){function i(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return i}();function Lr(i,e){return i>e?1:i<e?-1:0}function ye(i,e,t){for(var n=new $e(null,null),r=n,o=n;;){var u=t(i,e.key);if(u<0){if(e.left===null)break;if(t(i,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}o.left=e,o=e,e=e.left}else if(u>0){if(e.right===null)break;if(t(i,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}r.right=e,r=e,e=e.right}else break}return r.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function mt(i,e,t,n){var r=new $e(i,e);if(t===null)return r.left=r.right=null,r;t=ye(i,t,n);var o=n(i,t.key);return o<0?(r.left=t.left,r.right=t,t.left=null):o>=0&&(r.right=t.right,r.left=t,t.right=null),r}function dn(i,e,t){var n=null,r=null;if(e){e=ye(i,e,t);var o=t(e.key,i);o===0?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function Ar(i,e,t){return e===null?i:(i===null||(e=ye(i.key,e,t),e.left=i),e)}function vt(i,e,t,n,r){if(i){n(""+e+(t?"└── ":"├── ")+r(i)+`
`);var o=e+(t?"    ":"│   ");i.left&&vt(i.left,o,!1,n,r),i.right&&vt(i.right,o,!0,n,r)}}var Pt=function(){function i(e){e===void 0&&(e=Lr),this._root=null,this._size=0,this._comparator=e}return i.prototype.insert=function(e,t){return this._size++,this._root=mt(e,t,this._root,this._comparator)},i.prototype.add=function(e,t){var n=new $e(e,t);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,o=ye(e,this._root,r),u=r(e,o.key);return u===0?this._root=o:(u<0?(n.left=o.left,n.right=o,o.left=null):u>0&&(n.right=o.right,n.left=o,o.right=null),this._size++,this._root=n),this._root},i.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},i.prototype._remove=function(e,t,n){var r;if(t===null)return null;t=ye(e,t,n);var o=n(e,t.key);return o===0?(t.left===null?r=t.right:(r=ye(e,t.left,n),r.right=t.right),this._size--,r):t},i.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=ye(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},i.prototype.findStatic=function(e){for(var t=this._root,n=this._comparator;t;){var r=n(e,t.key);if(r===0)return t;r<0?t=t.left:t=t.right}return null},i.prototype.find=function(e){return this._root&&(this._root=ye(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},i.prototype.contains=function(e){for(var t=this._root,n=this._comparator;t;){var r=n(e,t.key);if(r===0)return!0;r<0?t=t.left:t=t.right}return!1},i.prototype.forEach=function(e,t){for(var n=this._root,r=[],o=!1;!o;)n!==null?(r.push(n),n=n.left):r.length!==0?(n=r.pop(),e.call(t,n),n=n.right):o=!0;return this},i.prototype.range=function(e,t,n,r){for(var o=[],u=this._comparator,s=this._root,l;o.length!==0||s;)if(s)o.push(s),s=s.left;else{if(s=o.pop(),l=u(s.key,t),l>0)break;if(u(s.key,e)>=0&&n.call(r,s))return this;s=s.right}return this},i.prototype.keys=function(){var e=[];return this.forEach(function(t){var n=t.key;return e.push(n)}),e},i.prototype.values=function(){var e=[];return this.forEach(function(t){var n=t.data;return e.push(n)}),e},i.prototype.min=function(){return this._root?this.minNode(this._root).key:null},i.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},i.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},i.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},i.prototype.at=function(e){for(var t=this._root,n=!1,r=0,o=[];!n;)if(t)o.push(t),t=t.left;else if(o.length>0){if(t=o.pop(),r===e)return t;r++,t=t.right}else n=!0;return null},i.prototype.next=function(e){var t=this._root,n=null;if(e.right){for(n=e.right;n.left;)n=n.left;return n}for(var r=this._comparator;t;){var o=r(e.key,t.key);if(o===0)break;o<0?(n=t,t=t.left):t=t.right}return n},i.prototype.prev=function(e){var t=this._root,n=null;if(e.left!==null){for(n=e.left;n.right;)n=n.right;return n}for(var r=this._comparator;t;){var o=r(e.key,t.key);if(o===0)break;o<0?t=t.left:(n=t,t=t.right)}return n},i.prototype.clear=function(){return this._root=null,this._size=0,this},i.prototype.toList=function(){return Pr(this._root)},i.prototype.load=function(e,t,n){t===void 0&&(t=[]),n===void 0&&(n=!1);var r=e.length,o=this._comparator;if(n&&Et(e,t,0,r-1,o),this._root===null)this._root=$t(e,t,0,r),this._size=r;else{var u=jr(this.toList(),Ir(e,t),o);r=this._size+r,this._root=xt({head:u},0,r)}return this},i.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(i.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),i.prototype.toString=function(e){e===void 0&&(e=function(n){return String(n.key)});var t=[];return vt(this._root,"",!0,function(n){return t.push(n)},e),t.join("")},i.prototype.update=function(e,t,n){var r=this._comparator,o=dn(e,this._root,r),u=o.left,s=o.right;r(e,t)<0?s=mt(t,n,s,r):u=mt(t,n,u,r),this._root=Ar(u,s,r)},i.prototype.split=function(e){return dn(e,this._root,this._comparator)},i.prototype[Symbol.iterator]=function(){var e,t,n;return Mr(this,function(r){switch(r.label){case 0:e=this._root,t=[],n=!1,r.label=1;case 1:return n?[3,6]:e===null?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return t.length===0?[3,4]:(e=t.pop(),[4,e]);case 3:return r.sent(),e=e.right,[3,5];case 4:n=!0,r.label=5;case 5:return[3,1];case 6:return[2]}})},i}();function $t(i,e,t,n){var r=n-t;if(r>0){var o=t+Math.floor(r/2),u=i[o],s=e[o],l=new $e(u,s);return l.left=$t(i,e,t,o),l.right=$t(i,e,o+1,n),l}return null}function Ir(i,e){for(var t=new $e(null,null),n=t,r=0;r<i.length;r++)n=n.next=new $e(i[r],e[r]);return n.next=null,t.next}function Pr(i){for(var e=i,t=[],n=!1,r=new $e(null,null),o=r;!n;)e?(t.push(e),e=e.left):t.length>0?(e=o=o.next=t.pop(),e=e.right):n=!0;return o.next=null,r.next}function xt(i,e,t){var n=t-e;if(n>0){var r=e+Math.floor(n/2),o=xt(i,e,r),u=i.head;return u.left=o,i.head=i.head.next,u.right=xt(i,r+1,t),u}return null}function jr(i,e,t){for(var n=new $e(null,null),r=n,o=i,u=e;o!==null&&u!==null;)t(o.key,u.key)<0?(r.next=o,o=o.next):(r.next=u,u=u.next),r=r.next;return o!==null?r.next=o:u!==null&&(r.next=u),n.next}function Et(i,e,t,n,r){if(!(t>=n)){for(var o=i[t+n>>1],u=t-1,s=n+1;;){do u++;while(r(i[u],o)<0);do s--;while(r(i[s],o)>0);if(u>=s)break;var l=i[u];i[u]=i[s],i[s]=l,l=e[u],e[u]=e[s],e[s]=l}Et(i,e,t,s,r),Et(i,e,s+1,n,r)}}const me=11102230246251565e-32,V=134217729,Cr=(3+8*me)*me;function dt(i,e,t,n,r){let o,u,s,l,c=e[0],p=n[0],a=0,f=0;p>c==p>-c?(o=c,c=e[++a]):(o=p,p=n[++f]);let h=0;if(a<i&&f<t)for(p>c==p>-c?(u=c+o,s=o-(u-c),c=e[++a]):(u=p+o,s=o-(u-p),p=n[++f]),o=u,s!==0&&(r[h++]=s);a<i&&f<t;)p>c==p>-c?(u=o+c,l=u-o,s=o-(u-l)+(c-l),c=e[++a]):(u=o+p,l=u-o,s=o-(u-l)+(p-l),p=n[++f]),o=u,s!==0&&(r[h++]=s);for(;a<i;)u=o+c,l=u-o,s=o-(u-l)+(c-l),c=e[++a],o=u,s!==0&&(r[h++]=s);for(;f<t;)u=o+p,l=u-o,s=o-(u-l)+(p-l),p=n[++f],o=u,s!==0&&(r[h++]=s);return(o!==0||h===0)&&(r[h++]=o),h}function Or(i,e){let t=e[0];for(let n=1;n<i;n++)t+=e[n];return t}function Be(i){return new Float64Array(i)}const Nr=(3+16*me)*me,Tr=(2+12*me)*me,Dr=(9+64*me)*me*me,Ee=Be(4),yn=Be(8),bn=Be(12),wn=Be(16),te=Be(4);function Fr(i,e,t,n,r,o,u){let s,l,c,p,a,f,h,_,m,b,v,I,F,k,B,d,T,D;const H=i-r,U=t-r,X=e-o,ee=n-o;k=H*ee,f=V*H,h=f-(f-H),_=H-h,f=V*ee,m=f-(f-ee),b=ee-m,B=_*b-(k-h*m-_*m-h*b),d=X*U,f=V*X,h=f-(f-X),_=X-h,f=V*U,m=f-(f-U),b=U-m,T=_*b-(d-h*m-_*m-h*b),v=B-T,a=B-v,Ee[0]=B-(v+a)+(a-T),I=k+v,a=I-k,F=k-(I-a)+(v-a),v=F-d,a=F-v,Ee[1]=F-(v+a)+(a-d),D=I+v,a=D-I,Ee[2]=I-(D-a)+(v-a),Ee[3]=D;let W=Or(4,Ee),ae=Tr*u;if(W>=ae||-W>=ae||(a=i-H,s=i-(H+a)+(a-r),a=t-U,c=t-(U+a)+(a-r),a=e-X,l=e-(X+a)+(a-o),a=n-ee,p=n-(ee+a)+(a-o),s===0&&l===0&&c===0&&p===0)||(ae=Dr*u+Cr*Math.abs(W),W+=H*p+ee*s-(X*c+U*l),W>=ae||-W>=ae))return W;k=s*ee,f=V*s,h=f-(f-s),_=s-h,f=V*ee,m=f-(f-ee),b=ee-m,B=_*b-(k-h*m-_*m-h*b),d=l*U,f=V*l,h=f-(f-l),_=l-h,f=V*U,m=f-(f-U),b=U-m,T=_*b-(d-h*m-_*m-h*b),v=B-T,a=B-v,te[0]=B-(v+a)+(a-T),I=k+v,a=I-k,F=k-(I-a)+(v-a),v=F-d,a=F-v,te[1]=F-(v+a)+(a-d),D=I+v,a=D-I,te[2]=I-(D-a)+(v-a),te[3]=D;const ke=dt(4,Ee,4,te,yn);k=H*p,f=V*H,h=f-(f-H),_=H-h,f=V*p,m=f-(f-p),b=p-m,B=_*b-(k-h*m-_*m-h*b),d=X*c,f=V*X,h=f-(f-X),_=X-h,f=V*c,m=f-(f-c),b=c-m,T=_*b-(d-h*m-_*m-h*b),v=B-T,a=B-v,te[0]=B-(v+a)+(a-T),I=k+v,a=I-k,F=k-(I-a)+(v-a),v=F-d,a=F-v,te[1]=F-(v+a)+(a-d),D=I+v,a=D-I,te[2]=I-(D-a)+(v-a),te[3]=D;const oe=dt(ke,yn,4,te,bn);k=s*p,f=V*s,h=f-(f-s),_=s-h,f=V*p,m=f-(f-p),b=p-m,B=_*b-(k-h*m-_*m-h*b),d=l*c,f=V*l,h=f-(f-l),_=l-h,f=V*c,m=f-(f-c),b=c-m,T=_*b-(d-h*m-_*m-h*b),v=B-T,a=B-v,te[0]=B-(v+a)+(a-T),I=k+v,a=I-k,F=k-(I-a)+(v-a),v=F-d,a=F-v,te[1]=F-(v+a)+(a-d),D=I+v,a=D-I,te[2]=I-(D-a)+(v-a),te[3]=D;const Re=dt(oe,bn,4,te,wn);return wn[Re-1]}function Br(i,e,t,n,r,o){const u=(e-o)*(t-r),s=(i-r)*(n-o),l=u-s,c=Math.abs(u+s);return Math.abs(l)>=Nr*c?l:-Fr(i,e,t,n,r,o,c)}var Tn={};const Le=(i,e)=>i.ll.x<=e.x&&e.x<=i.ur.x&&i.ll.y<=e.y&&e.y<=i.ur.y,St=(i,e)=>{if(e.ur.x<i.ll.x||i.ur.x<e.ll.x||e.ur.y<i.ll.y||i.ur.y<e.ll.y)return null;const t=i.ll.x<e.ll.x?e.ll.x:i.ll.x,n=i.ur.x<e.ur.x?i.ur.x:e.ur.x,r=i.ll.y<e.ll.y?e.ll.y:i.ll.y,o=i.ur.y<e.ur.y?i.ur.y:e.ur.y;return{ll:{x:t,y:r},ur:{x:n,y:o}}};let be=Number.EPSILON;be===void 0&&(be=Math.pow(2,-52));const Ur=be*be,vn=(i,e)=>{if(-be<i&&i<be&&-be<e&&e<be)return 0;const t=i-e;return t*t<Ur*i*e?0:i<e?-1:1};class Gr{constructor(){this.reset()}reset(){this.xRounder=new $n,this.yRounder=new $n}round(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}class $n{constructor(){this.tree=new Pt,this.round(0)}round(e){const t=this.tree.add(e),n=this.tree.prev(t);if(n!==null&&vn(t.key,n.key)===0)return this.tree.remove(e),n.key;const r=this.tree.next(t);return r!==null&&vn(t.key,r.key)===0?(this.tree.remove(e),r.key):e}}const Oe=new Gr,We=(i,e)=>i.x*e.y-i.y*e.x,Dn=(i,e)=>i.x*e.x+i.y*e.y,xn=(i,e,t)=>{const n=Br(i.x,i.y,e.x,e.y,t.x,t.y);return n>0?-1:n<0?1:0},Ye=i=>Math.sqrt(Dn(i,i)),qr=(i,e,t)=>{const n={x:e.x-i.x,y:e.y-i.y},r={x:t.x-i.x,y:t.y-i.y};return We(r,n)/Ye(r)/Ye(n)},zr=(i,e,t)=>{const n={x:e.x-i.x,y:e.y-i.y},r={x:t.x-i.x,y:t.y-i.y};return Dn(r,n)/Ye(r)/Ye(n)},En=(i,e,t)=>e.y===0?null:{x:i.x+e.x/e.y*(t-i.y),y:t},Sn=(i,e,t)=>e.x===0?null:{x:t,y:i.y+e.y/e.x*(t-i.x)},Wr=(i,e,t,n)=>{if(e.x===0)return Sn(t,n,i.x);if(n.x===0)return Sn(i,e,t.x);if(e.y===0)return En(t,n,i.y);if(n.y===0)return En(i,e,t.y);const r=We(e,n);if(r==0)return null;const o={x:t.x-i.x,y:t.y-i.y},u=We(o,e)/r,s=We(o,n)/r,l=i.x+s*e.x,c=t.x+u*n.x,p=i.y+s*e.y,a=t.y+u*n.y,f=(l+c)/2,h=(p+a)/2;return{x:f,y:h}};class ie{static compare(e,t){const n=ie.comparePoints(e.point,t.point);return n!==0?n:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:ve.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}constructor(e,t){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let n=0,r=t.length;n<r;n++){const o=t[n];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const n=this.point.events[t];if(n.segment.consumedBy===void 0)for(let r=t+1;r<e;r++){const o=this.point.events[r];o.consumedBy===void 0&&n.otherSE.point.events===o.otherSE.point.events&&n.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,n=this.point.events.length;t<n;t++){const r=this.point.events[t];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&e.push(r)}return e}getLeftmostComparator(e){const t=new Map,n=r=>{const o=r.otherSE;t.set(r,{sine:qr(this.point,e.point,o.point),cosine:zr(this.point,e.point,o.point)})};return(r,o)=>{t.has(r)||n(r),t.has(o)||n(o);const{sine:u,cosine:s}=t.get(r),{sine:l,cosine:c}=t.get(o);return u>=0&&l>=0?s<c?1:s>c?-1:0:u<0&&l<0?s<c?-1:s>c?1:0:l<u?-1:l>u?1:0}}}let Kr=0;class ve{static compare(e,t){const n=e.leftSE.point.x,r=t.leftSE.point.x,o=e.rightSE.point.x,u=t.rightSE.point.x;if(u<n)return 1;if(o<r)return-1;const s=e.leftSE.point.y,l=t.leftSE.point.y,c=e.rightSE.point.y,p=t.rightSE.point.y;if(n<r){if(l<s&&l<c)return 1;if(l>s&&l>c)return-1;const a=e.comparePoint(t.leftSE.point);if(a<0)return 1;if(a>0)return-1;const f=t.comparePoint(e.rightSE.point);return f!==0?f:-1}if(n>r){if(s<l&&s<p)return-1;if(s>l&&s>p)return 1;const a=t.comparePoint(e.leftSE.point);if(a!==0)return a;const f=e.comparePoint(t.rightSE.point);return f<0?1:f>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(o<u){const a=t.comparePoint(e.rightSE.point);if(a!==0)return a}if(o>u){const a=e.comparePoint(t.rightSE.point);if(a<0)return 1;if(a>0)return-1}if(o!==u){const a=c-s,f=o-n,h=p-l,_=u-r;if(a>f&&h<_)return 1;if(a<f&&h>_)return-1}return o>u?1:o<u||c<p?-1:c>p?1:e.id<t.id?-1:e.id>t.id?1:0}constructor(e,t,n,r){this.id=++Kr,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=n,this.windings=r}static fromRing(e,t,n){let r,o,u;const s=ie.comparePoints(e,t);if(s<0)r=e,o=t,u=1;else if(s>0)r=t,o=e,u=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const l=new ie(r,!0),c=new ie(o,!1);return new ve(l,c,[n],[u])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const t=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(t.x===n.x)return e.x===t.x?0:e.x<t.x?1:-1;const o=(e.y-t.y)/r.y,u=t.x+o*r.x;if(e.x===u)return 0;const s=(e.x-t.x)/r.x,l=t.y+s*r.y;return e.y===l?0:e.y<l?-1:1}getIntersection(e){const t=this.bbox(),n=e.bbox(),r=St(t,n);if(r===null)return null;const o=this.leftSE.point,u=this.rightSE.point,s=e.leftSE.point,l=e.rightSE.point,c=Le(t,s)&&this.comparePoint(s)===0,p=Le(n,o)&&e.comparePoint(o)===0,a=Le(t,l)&&this.comparePoint(l)===0,f=Le(n,u)&&e.comparePoint(u)===0;if(p&&c)return f&&!a?u:!f&&a?l:null;if(p)return a&&o.x===l.x&&o.y===l.y?null:o;if(c)return f&&u.x===s.x&&u.y===s.y?null:s;if(f&&a)return null;if(f)return u;if(a)return l;const h=Wr(o,this.vector(),s,e.vector());return h===null||!Le(r,h)?null:Oe.round(h.x,h.y)}split(e){const t=[],n=e.events!==void 0,r=new ie(e,!0),o=new ie(e,!1),u=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(r);const s=new ve(r,u,this.rings.slice(),this.windings.slice());return ie.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),ie.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,n=this.windings.length;t<n;t++)this.windings[t]*=-1}consume(e){let t=this,n=e;for(;t.consumedBy;)t=t.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const r=ve.compare(t,n);if(r!==0){if(r>0){const o=t;t=n,n=o}if(t.prev===n){const o=t;t=n,n=o}for(let o=0,u=n.rings.length;o<u;o++){const s=n.rings[o],l=n.windings[o],c=t.rings.indexOf(s);c===-1?(t.rings.push(s),t.windings.push(l)):t.windings[c]+=l}n.rings=null,n.windings=null,n.consumedBy=t,n.leftSE.consumedBy=t.leftSE,n.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys;for(let s=0,l=this.rings.length;s<l;s++){const c=this.rings[s],p=this.windings[s],a=t.indexOf(c);a===-1?(t.push(c),n.push(p)):n[a]+=p}const o=[],u=[];for(let s=0,l=t.length;s<l;s++){if(n[s]===0)continue;const c=t[s],p=c.poly;if(u.indexOf(p)===-1)if(c.isExterior)o.push(p);else{u.indexOf(p)===-1&&u.push(p);const a=o.indexOf(c.poly);a!==-1&&o.splice(a,1)}}for(let s=0,l=o.length;s<l;s++){const c=o[s].multiPoly;r.indexOf(c)===-1&&r.push(c)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(se.type){case"union":{const n=e.length===0,r=t.length===0;this._isInResult=n!==r;break}case"intersection":{let n,r;e.length<t.length?(n=e.length,r=t.length):(n=t.length,r=e.length),this._isInResult=r===se.numMultiPolys&&n<r;break}case"xor":{const n=Math.abs(e.length-t.length);this._isInResult=n%2===1;break}case"difference":{const n=r=>r.length===1&&r[0].isSubject;this._isInResult=n(e)!==n(t);break}default:throw new Error(`Unrecognized operation type found ${se.type}`)}return this._isInResult}}class kn{constructor(e,t,n){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=n,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=Oe.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let o=r;for(let u=1,s=e.length;u<s;u++){if(typeof e[u][0]!="number"||typeof e[u][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let l=Oe.round(e[u][0],e[u][1]);l.x===o.x&&l.y===o.y||(this.segments.push(ve.fromRing(o,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}(r.x!==o.x||r.y!==o.y)&&this.segments.push(ve.fromRing(o,r,this))}getSweepEvents(){const e=[];for(let t=0,n=this.segments.length;t<n;t++){const r=this.segments[t];e.push(r.leftSE),e.push(r.rightSE)}return e}}class Jr{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new kn(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,r=e.length;n<r;n++){const o=new kn(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=t}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let t=0,n=this.interiorRings.length;t<n;t++){const r=this.interiorRings[t].getSweepEvents();for(let o=0,u=r.length;o<u;o++)e.push(r[o])}return e}}class Rn{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,r=e.length;n<r;n++){const o=new Jr(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=t}getSweepEvents(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const r=this.polys[t].getSweepEvents();for(let o=0,u=r.length;o<u;o++)e.push(r[o])}return e}}class Ze{static factory(e){const t=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];if(!o.isInResult()||o.ringOut)continue;let u=null,s=o.leftSE,l=o.rightSE;const c=[s],p=s.point,a=[];for(;u=s,s=l,c.push(s),s.point!==p;)for(;;){const f=s.getAvailableLinkedEvents();if(f.length===0){const m=c[0].point,b=c[c.length-1].point;throw new Error(`Unable to complete output ring starting at [${m.x}, ${m.y}]. Last matching segment found ends at [${b.x}, ${b.y}].`)}if(f.length===1){l=f[0].otherSE;break}let h=null;for(let m=0,b=a.length;m<b;m++)if(a[m].point===s.point){h=m;break}if(h!==null){const m=a.splice(h)[0],b=c.splice(m.index);b.unshift(b[0].otherSE),t.push(new Ze(b.reverse()));continue}a.push({index:c.length,point:s.point});const _=s.getLeftmostComparator(u);l=f.sort(_)[0].otherSE;break}t.push(new Ze(c))}return t}constructor(e){this.events=e;for(let t=0,n=e.length;t<n;t++)e[t].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const t=[e];for(let c=1,p=this.events.length-1;c<p;c++){const a=this.events[c].point,f=this.events[c+1].point;xn(a,e,f)!==0&&(t.push(a),e=a)}if(t.length===1)return null;const n=t[0],r=t[1];xn(n,e,r)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:t.length-1,s=this.isExteriorRing()?t.length:-1,l=[];for(let c=u;c!=s;c+=o)l.push([t[c].x,t[c].y]);return l}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let r=1,o=this.events.length;r<o;r++){const u=this.events[r];ie.compare(e,u)>0&&(e=u)}let t=e.segment.prevInResult(),n=t?t.prevInResult():null;for(;;){if(!t)return null;if(!n)return t.ringOut;if(n.ringOut!==t.ringOut)return n.ringOut.enclosingRing()!==t.ringOut?t.ringOut:t.ringOut.enclosingRing();t=n.prevInResult(),n=t?t.prevInResult():null}}}class Mn{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let t=0,n=this.interiorRings.length;t<n;t++){const r=this.interiorRings[t].getGeom();r!==null&&e.push(r)}return e}}class Qr{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const r=this.polys[t].getGeom();r!==null&&e.push(r)}return e}_composePolys(e){const t=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];if(!o.poly)if(o.isExteriorRing())t.push(new Mn(o));else{const u=o.enclosingRing();u.poly||t.push(new Mn(u)),u.poly.addInterior(o)}}return t}}class Vr{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve.compare;this.queue=e,this.tree=new Pt(t),this.segments=[]}process(e){const t=e.segment,n=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),n;const r=e.isLeft?this.tree.add(t):this.tree.find(t);if(!r)throw new Error(`Unable to find segment #${t.id} [${t.leftSE.point.x}, ${t.leftSE.point.y}] -> [${t.rightSE.point.x}, ${t.rightSE.point.y}] in SweepLine tree.`);let o=r,u=r,s,l;for(;s===void 0;)o=this.tree.prev(o),o===null?s=null:o.key.consumedBy===void 0&&(s=o.key);for(;l===void 0;)u=this.tree.next(u),u===null?l=null:u.key.consumedBy===void 0&&(l=u.key);if(e.isLeft){let c=null;if(s){const a=s.getIntersection(t);if(a!==null&&(t.isAnEndpoint(a)||(c=a),!s.isAnEndpoint(a))){const f=this._splitSafely(s,a);for(let h=0,_=f.length;h<_;h++)n.push(f[h])}}let p=null;if(l){const a=l.getIntersection(t);if(a!==null&&(t.isAnEndpoint(a)||(p=a),!l.isAnEndpoint(a))){const f=this._splitSafely(l,a);for(let h=0,_=f.length;h<_;h++)n.push(f[h])}}if(c!==null||p!==null){let a=null;c===null?a=p:p===null?a=c:a=ie.comparePoints(c,p)<=0?c:p,this.queue.remove(t.rightSE),n.push(t.rightSE);const f=t.split(a);for(let h=0,_=f.length;h<_;h++)n.push(f[h])}n.length>0?(this.tree.remove(t),n.push(e)):(this.segments.push(t),t.prev=s)}else{if(s&&l){const c=s.getIntersection(l);if(c!==null){if(!s.isAnEndpoint(c)){const p=this._splitSafely(s,c);for(let a=0,f=p.length;a<f;a++)n.push(p[a])}if(!l.isAnEndpoint(c)){const p=this._splitSafely(l,c);for(let a=0,f=p.length;a<f;a++)n.push(p[a])}}}this.tree.remove(t)}return n}_splitSafely(e,t){this.tree.remove(e);const n=e.rightSE;this.queue.remove(n);const r=e.split(t);return r.push(n),e.consumedBy===void 0&&this.tree.add(e),r}}const Ln=typeof process<"u"&&Tn.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Yr=typeof process<"u"&&Tn.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Zr{run(e,t,n){se.type=e,Oe.reset();const r=[new Rn(t,!0)];for(let a=0,f=n.length;a<f;a++)r.push(new Rn(n[a],!1));if(se.numMultiPolys=r.length,se.type==="difference"){const a=r[0];let f=1;for(;f<r.length;)St(r[f].bbox,a.bbox)!==null?f++:r.splice(f,1)}if(se.type==="intersection")for(let a=0,f=r.length;a<f;a++){const h=r[a];for(let _=a+1,m=r.length;_<m;_++)if(St(h.bbox,r[_].bbox)===null)return[]}const o=new Pt(ie.compare);for(let a=0,f=r.length;a<f;a++){const h=r[a].getSweepEvents();for(let _=0,m=h.length;_<m;_++)if(o.insert(h[_]),o.size>Ln)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const u=new Vr(o);let s=o.size,l=o.pop();for(;l;){const a=l.key;if(o.size===s){const h=a.segment;throw new Error(`Unable to pop() ${a.isLeft?"left":"right"} SweepEvent [${a.point.x}, ${a.point.y}] from segment #${h.id} [${h.leftSE.point.x}, ${h.leftSE.point.y}] -> [${h.rightSE.point.x}, ${h.rightSE.point.y}] from queue.`)}if(o.size>Ln)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(u.segments.length>Yr)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const f=u.process(a);for(let h=0,_=f.length;h<_;h++){const m=f[h];m.consumedBy===void 0&&o.insert(m)}s=o.size,l=o.pop()}Oe.reset();const c=Ze.factory(u.segments);return new Qr(c).getGeom()}}const se=new Zr,Hr=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return se.run("union",i,t)},Xr=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return se.run("intersection",i,t)},ei=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return se.run("xor",i,t)},ti=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return se.run("difference",i,t)};var ni={union:Hr,intersection:Xr,xor:ei,difference:ti},ri=Object.defineProperty,ii=(i,e)=>ri(i,"name",{value:e,configurable:!0});function Fn(i,e={}){const t=[];if(mr(i,r=>{t.push(r.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const n=ni.intersection(t[0],...t.slice(1));return n.length===0?null:n.length===1?Nn(n[0],e.properties):dr(n,e.properties)}ii(Fn,"intersect");var oi=Fn;let kt={type:"FeatureCollection",features:[]};async function si(){let e=await(await fetch(Rr)).json();for(let t of e.features)t.geometry.type=="MultiPolygon"&&(t.geometry.type="Polygon",t.geometry.coordinates=t.geometry.coordinates[0]);kt=e}function ui(i){let e=i.getBounds(),t=Nn([[e.getNorthEast().toArray(),e.getNorthWest().toArray(),e.getSouthWest().toArray(),e.getSouthEast().toArray(),e.getNorthEast().toArray()]]),n=mn(t),r=0,o=kt.features[0];for(let u of kt.features){let s=oi(yr([t,u]));if(!s)continue;let l=mn(s)/n;l>r&&(r=l,o=u)}return o}const Bn=Xe({type:"FeatureCollection",features:[]}),li=Xe(!0),Un=Xe(0);let y;const Gn=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Gn.decode();let Ae=null;function je(){return(Ae===null||Ae.byteLength===0)&&(Ae=new Uint8Array(y.memory.buffer)),Ae}function ue(i,e){return i=i>>>0,Gn.decode(je().subarray(i,i+e))}const _e=new Array(128).fill(void 0);_e.push(void 0,null,!0,!1);let Ce=_e.length;function J(i){Ce===_e.length&&_e.push(_e.length+1);const e=Ce;return Ce=_e[e],_e[e]=i,e}function x(i){return _e[i]}function ai(i){i<132||(_e[i]=Ce,Ce=i)}function Ke(i){const e=x(i);return ai(i),e}function yt(i){return i==null}let Ie=null;function fi(){return(Ie===null||Ie.byteLength===0)&&(Ie=new Float64Array(y.memory.buffer)),Ie}let Pe=null;function C(){return(Pe===null||Pe.byteLength===0)&&(Pe=new Int32Array(y.memory.buffer)),Pe}let we=0;const Je=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ci=typeof Je.encodeInto=="function"?function(i,e){return Je.encodeInto(i,e)}:function(i,e){const t=Je.encode(i);return e.set(t),{read:i.length,written:t.length}};function ze(i,e,t){if(t===void 0){const s=Je.encode(i),l=e(s.length,1)>>>0;return je().subarray(l,l+s.length).set(s),we=s.length,l}let n=i.length,r=e(n,1)>>>0;const o=je();let u=0;for(;u<n;u++){const s=i.charCodeAt(u);if(s>127)break;o[r+u]=s}if(u!==n){u!==0&&(i=i.slice(u)),r=t(r,n,n=u+i.length*3,1)>>>0;const s=je().subarray(r+u,r+n),l=ci(i,s);u+=l.written}return we=u,r}function Rt(i){const e=typeof i;if(e=="number"||e=="boolean"||i==null)return`${i}`;if(e=="string")return`"${i}"`;if(e=="symbol"){const r=i.description;return r==null?"Symbol":`Symbol(${r})`}if(e=="function"){const r=i.name;return typeof r=="string"&&r.length>0?`Function(${r})`:"Function"}if(Array.isArray(i)){const r=i.length;let o="[";r>0&&(o+=Rt(i[0]));for(let u=1;u<r;u++)o+=", "+Rt(i[u]);return o+="]",o}const t=/\[object ([^\]]+)\]/.exec(toString.call(i));let n;if(t.length>1)n=t[1];else return toString.call(i);if(n=="Object")try{return"Object("+JSON.stringify(i)+")"}catch{return"Object"}return i instanceof Error?`${i.name}: ${i.message}
${i.stack}`:n}function hi(i,e){const t=e(i.length*1,1)>>>0;return je().set(i,t/1),we=i.length,t}function bt(i,e){try{return i.apply(this,e)}catch(t){y.__wbindgen_exn_store(J(t))}}class He{static __wrap(e){e=e>>>0;const t=Object.create(He.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();y.__wbg_jsroutesnapper_free(e)}constructor(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16),u=hi(e,y.__wbindgen_malloc),s=we;y.jsroutesnapper_new(o,u,s);var t=C()[o/4+0],n=C()[o/4+1],r=C()[o/4+2];if(r)throw Ke(n);return He.__wrap(t)}finally{y.__wbindgen_add_to_stack_pointer(16)}}setRouteConfig(e){y.jsroutesnapper_setRouteConfig(this.__wbg_ptr,J(e))}setAreaMode(){y.jsroutesnapper_setAreaMode(this.__wbg_ptr)}getConfig(){let e,t;try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_getConfig(o,this.__wbg_ptr);var n=C()[o/4+0],r=C()[o/4+1];return e=n,t=r,ue(n,r)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(e,t,1)}}toFinalFeature(){try{const n=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_toFinalFeature(n,this.__wbg_ptr);var e=C()[n/4+0],t=C()[n/4+1];let r;return e!==0&&(r=ue(e,t).slice(),y.__wbindgen_free(e,t*1)),r}finally{y.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){let e,t;try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_renderGeojson(o,this.__wbg_ptr);var n=C()[o/4+0],r=C()[o/4+1];return e=n,t=r,ue(n,r)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(e,t,1)}}toggleSnapMode(){y.jsroutesnapper_toggleSnapMode(this.__wbg_ptr)}onMouseMove(e,t,n){return y.jsroutesnapper_onMouseMove(this.__wbg_ptr,e,t,n)!==0}onClick(){y.jsroutesnapper_onClick(this.__wbg_ptr)}onDragStart(){return y.jsroutesnapper_onDragStart(this.__wbg_ptr)!==0}onMouseUp(){return y.jsroutesnapper_onMouseUp(this.__wbg_ptr)!==0}clearState(){y.jsroutesnapper_clearState(this.__wbg_ptr)}editExisting(e){try{const r=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_editExisting(r,this.__wbg_ptr,J(e));var t=C()[r/4+0],n=C()[r/4+1];if(n)throw Ke(t)}finally{y.__wbindgen_add_to_stack_pointer(16)}}debugRenderGraph(){let e,t;try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_debugRenderGraph(o,this.__wbg_ptr);var n=C()[o/4+0],r=C()[o/4+1];return e=n,t=r,ue(n,r)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(e,t,1)}}debugSnappableNodes(){let e,t;try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_debugSnappableNodes(o,this.__wbg_ptr);var n=C()[o/4+0],r=C()[o/4+1];return e=n,t=r,ue(n,r)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(e,t,1)}}routeNameForWaypoints(e){let t,n;try{const p=y.__wbindgen_add_to_stack_pointer(-16);y.jsroutesnapper_routeNameForWaypoints(p,this.__wbg_ptr,J(e));var r=C()[p/4+0],o=C()[p/4+1],u=C()[p/4+2],s=C()[p/4+3],l=r,c=o;if(s)throw l=0,c=0,Ke(u);return t=l,n=c,ue(l,c)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(t,n,1)}}addSnappedWaypoint(e,t){y.jsroutesnapper_addSnappedWaypoint(this.__wbg_ptr,e,t)}undo(){y.jsroutesnapper_undo(this.__wbg_ptr)}}async function pi(i,e){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,e)}catch(n){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const t=await i.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(i,e);return t instanceof WebAssembly.Instance?{instance:t,module:i}:t}}function gi(){const i={};return i.wbg={},i.wbg.__wbindgen_string_new=function(e,t){const n=ue(e,t);return J(n)},i.wbg.__wbindgen_object_drop_ref=function(e){Ke(e)},i.wbg.__wbindgen_error_new=function(e,t){const n=new Error(ue(e,t));return J(n)},i.wbg.__wbindgen_is_object=function(e){const t=x(e);return typeof t=="object"&&t!==null},i.wbg.__wbindgen_is_undefined=function(e){return x(e)===void 0},i.wbg.__wbindgen_in=function(e,t){return x(e)in x(t)},i.wbg.__wbindgen_number_get=function(e,t){const n=x(t),r=typeof n=="number"?n:void 0;fi()[e/8+1]=yt(r)?0:r,C()[e/4+0]=!yt(r)},i.wbg.__wbindgen_boolean_get=function(e){const t=x(e);return typeof t=="boolean"?t?1:0:2},i.wbg.__wbindgen_jsval_loose_eq=function(e,t){return x(e)==x(t)},i.wbg.__wbindgen_string_get=function(e,t){const n=x(t),r=typeof n=="string"?n:void 0;var o=yt(r)?0:ze(r,y.__wbindgen_malloc,y.__wbindgen_realloc),u=we;C()[e/4+1]=u,C()[e/4+0]=o},i.wbg.__wbg_getwithrefkey_d1f0d12f1f1b63ea=function(e,t){const n=x(e)[x(t)];return J(n)},i.wbg.__wbindgen_object_clone_ref=function(e){const t=x(e);return J(t)},i.wbg.__wbg_String_4370c5505c674d30=function(e,t){const n=String(x(t)),r=ze(n,y.__wbindgen_malloc,y.__wbindgen_realloc),o=we;C()[e/4+1]=o,C()[e/4+0]=r},i.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return J(e)},i.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=x(t).stack,r=ze(n,y.__wbindgen_malloc,y.__wbindgen_realloc),o=we;C()[e/4+1]=o,C()[e/4+0]=r},i.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,r;try{n=e,r=t,console.error(ue(e,t))}finally{y.__wbindgen_free(n,r,1)}},i.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(x(e))},i.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(x(e))},i.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(x(e))},i.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(x(e))},i.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(x(e))},i.wbg.__wbg_get_44be0491f933a435=function(e,t){const n=x(e)[t>>>0];return J(n)},i.wbg.__wbg_length_fff51ee6522a1a18=function(e){return x(e).length},i.wbg.__wbindgen_is_function=function(e){return typeof x(e)=="function"},i.wbg.__wbg_next_526fc47e980da008=function(e){const t=x(e).next;return J(t)},i.wbg.__wbg_next_ddb3312ca1c4e32a=function(){return bt(function(e){const t=x(e).next();return J(t)},arguments)},i.wbg.__wbg_done_5c1f01fb660d73b5=function(e){return x(e).done},i.wbg.__wbg_value_1695675138684bd5=function(e){const t=x(e).value;return J(t)},i.wbg.__wbg_iterator_97f0c81209c6c35a=function(){return J(Symbol.iterator)},i.wbg.__wbg_get_97b561fb56f034b5=function(){return bt(function(e,t){const n=Reflect.get(x(e),x(t));return J(n)},arguments)},i.wbg.__wbg_call_cb65541d95d71282=function(){return bt(function(e,t){const n=x(e).call(x(t));return J(n)},arguments)},i.wbg.__wbg_isArray_4c24b343cb13cfb1=function(e){return Array.isArray(x(e))},i.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb=function(e){let t;try{t=x(e)instanceof ArrayBuffer}catch{t=!1}return t},i.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=x(e).buffer;return J(t)},i.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(x(e));return J(t)},i.wbg.__wbg_set_5cf90238115182c3=function(e,t,n){x(e).set(x(t),n>>>0)},i.wbg.__wbg_length_72e2208bbc0efc61=function(e){return x(e).length},i.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4=function(e){let t;try{t=x(e)instanceof Uint8Array}catch{t=!1}return t},i.wbg.__wbindgen_debug_string=function(e,t){const n=Rt(x(t)),r=ze(n,y.__wbindgen_malloc,y.__wbindgen_realloc),o=we;C()[e/4+1]=o,C()[e/4+0]=r},i.wbg.__wbindgen_throw=function(e,t){throw new Error(ue(e,t))},i.wbg.__wbindgen_memory=function(){const e=y.memory;return J(e)},i}function _i(i,e){return y=i.exports,qn.__wbindgen_wasm_module=e,Ie=null,Pe=null,Ae=null,y}async function qn(i){if(y!==void 0)return y;typeof i>"u"&&(i="/inspectorate_tools/sketch_routes/assets/route_snapper_bg.wasm");const e=gi();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:t,module:n}=await pi(await i,e);return _i(t,n)}const mi=30;class di{constructor(e,t,n,r,o){this.onMouseMove=u=>{if(!this.active)return;const s=[u.point.x-mi,u.point.y],l=this.map.unproject(u.point).distanceTo(this.map.unproject(s));this.inner.onMouseMove(u.lngLat.lng,u.lngLat.lat,l)&&(this.redraw(),this.dataUpdated())},this.onClick=()=>{this.active&&(this.inner.onClick(),this.redraw(),this.dataUpdated())},this.onDoubleClick=u=>{this.active&&(u.preventDefault(),this.inner.onClick(),this.finish())},this.onDragStart=()=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()},this.onMouseUp=()=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()},this.onKeyDown=u=>{this.active&&u.key=="Escape"&&(u.stopPropagation(),this.cancel())},this.onKeyPress=u=>{this.active&&u.target.tagName!="INPUT"&&(u.key=="Enter"?(u.stopPropagation(),this.finish()):u.key=="s"||u.key=="S"?(u.stopPropagation(),this.inner.toggleSnapMode(),this.redraw()):u.key=="z"&&u.ctrlKey&&this.undo())},this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new He(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.routeToolGj=n,this.snapMode=r,this.undoLength=o,this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("dragstart",this.onDragStart),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keypress",this.onKeyPress)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("dragstart",this.onDragStart),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keypress",this.onKeyPress)}startRoute(){this.active||(this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}startArea(){this.active||(this.inner.setAreaMode(),this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}stop(){this.active=!1,this.inner.clearState(),this.redraw(),this.map.boxZoom.enable(),this.map.doubleClickZoom.enable()}editExistingRoute(e){this.active&&window.alert("Bug: editExistingRoute called when tool is already active"),e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.startRoute(),this.inner.editExisting(e.properties.waypoints),this.redraw()}editExistingArea(e){this.active&&window.alert("Bug: editExistingArea called when tool is already active"),e.properties.waypoints||window.alert("Bug: editExistingArea called for a polygon not produced by the route-snapper"),this.startArea(),this.inner.editExisting(e.properties.waypoints),this.redraw()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}isActive(){return this.active}finish(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersSuccess)t(JSON.parse(e));else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){this.inner.clearState(),this.finish()}setRouteConfig(e){this.inner.setRouteConfig(e),this.redraw()}addSnappedWaypoint(e){this.inner.addSnappedWaypoint(e[0],e[1]),this.redraw()}undo(){this.inner.undo(),this.redraw()}toggleSnapMode(){this.inner.toggleSnapMode(),this.redraw()}redraw(){let e=JSON.parse(this.inner.renderGeojson());this.routeToolGj.set(e),this.map.getCanvas().style.cursor=e.cursor,this.snapMode.set(e.snap_mode),this.undoLength.set(e.undo_length)}dataUpdated(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersUpdated)t(JSON.parse(e))}}function yi(i){let e,t,n;return{c(){e=Y("Undo ("),t=Y(i[2]),n=Y(")")},l(r){e=Z(r,"Undo ("),t=Z(r,i[2]),n=Z(r,")")},m(r,o){P(r,e,o),P(r,t,o),P(r,n,o)},p(r,o){o&4&&Qe(t,r[2])},d(r){r&&(E(e),E(t),E(n))}}}function bi(i){let e;return{c(){e=Y("Undo")},l(t){e=Z(t,"Undo")},m(t,n){P(t,e,n)},p:Se,d(t){t&&E(e)}}}function wi(i){let e,t,n,r,o=`<li><b>Click</b>
    the map to add points</li> <li><b>Click and drag</b>
    any point to move it</li> <li><b>Click</b>
    a waypoint to delete it</li> <li>Press <b>Control+Z</b>
    to undo your last change</li> <li>Press <b>Enter</b>
    or
    <b>double click</b>
    to finish</li> <li>Press <b>Escape</b>
    to cancel</li>`,u,s,l,c,p,a;function f(m,b){return m[2]==0?bi:yi}let h=f(i),_=h(i);return{c(){e=ne("button"),_.c(),n=O(),r=ne("ul"),r.innerHTML=o,u=O(),s=ne("label"),l=ne("input"),c=Y(`
  Add points to end`),this.h()},l(m){e=re(m,"BUTTON",{"data-tooltip":!0});var b=le(e);_.l(b),b.forEach(E),n=N(m),r=re(m,"UL",{"data-svelte-h":!0}),sr(r)!=="svelte-6mzb5r"&&(r.innerHTML=o),u=N(m),s=re(m,"LABEL",{});var v=le(s);l=re(v,"INPUT",{type:!0}),c=Z(v,`
  Add points to end`),v.forEach(E),this.h()},h(){e.disabled=t=i[2]==0,wt(e,"data-tooltip","Ctrl+Z"),wt(l,"type","checkbox")},m(m,b){P(m,e,b),_.m(e,null),P(m,n,b),P(m,r,b),P(m,u,b),P(m,s,b),j(s,l),l.checked=i[1],j(s,c),p||(a=[hn(e,"click",i[3]),hn(l,"change",i[4])],p=!0)},p(m,[b]){h===(h=f(m))&&_?_.p(m,b):(_.d(1),_=h(m),_&&(_.c(),_.m(e,null))),b&4&&t!==(t=m[2]==0)&&(e.disabled=t),b&2&&(l.checked=m[1])},i:Se,o:Se,d(m){m&&(E(e),E(n),E(r),E(u),E(s)),_.d(),p=!1,ur(a)}}}function vi(i,e,t){let n;Te(i,Un,l=>t(2,n=l));let{route_tool:r}=e,o=!0;const u=()=>r.undo();function s(){o=this.checked,t(1,o)}return i.$$set=l=>{"route_tool"in l&&t(0,r=l.route_tool)},i.$$.update=()=>{i.$$.dirty&3&&r.setRouteConfig({avoid_doubling_back:!1,extend_route:o})},[r,o,n,u,s]}class $i extends De{constructor(e){super(),Fe(this,e,vi,wi,Ne,{route_tool:0})}}function An(i){let e,t=i[1].properties.name+"",n,r,o=i[1].properties.level+"",u,s;return{c(){e=Y("(currently "),n=Y(t),r=Y(" ("),u=Y(o),s=Y("))")},l(l){e=Z(l,"(currently "),n=Z(l,t),r=Z(l," ("),u=Z(l,o),s=Z(l,"))")},m(l,c){P(l,e,c),P(l,n,c),P(l,r,c),P(l,u,c),P(l,s,c)},p(l,c){c&2&&t!==(t=l[1].properties.name+"")&&Qe(n,t),c&2&&o!==(o=l[1].properties.level+"")&&Qe(u,o)},d(l){l&&(E(e),E(n),E(r),E(u),E(s))}}}function xi(i){let e,t,n=i[1]&&An(i);return{c(){e=Y(`Get route snapper
    `),n&&n.c(),t=Ve()},l(r){e=Z(r,`Get route snapper
    `),n&&n.l(r),t=Ve()},m(r,o){P(r,e,o),n&&n.m(r,o),P(r,t,o)},p(r,o){r[1]?n?n.p(r,o):(n=An(r),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(r){r&&(E(e),E(t)),n&&n.d(r)}}}function Ei(i){let e;return{c(){e=Y("Draw a route")},l(t){e=Z(t,"Draw a route")},m(t,n){P(t,e,n)},d(t){t&&E(e)}}}function Si(i){let e;return{c(){e=Y("Edit this route")},l(t){e=Z(t,"Edit this route")},m(t,n){P(t,e,n)},d(t){t&&E(e)}}}function In(i){let e,t;return e=new $i({props:{route_tool:i[3]}}),{c(){R(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){L(e,n,r),t=!0},p(n,r){const o={};r&8&&(o.route_tool=n[3]),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ki(i){let e,t,n,r,o,u,s,l,c,p;t=new _t({props:{$$slots:{default:[xi]},$$scope:{ctx:i}}}),t.$on("click",i[5]),o=new _t({props:{disabled:i[2]||i[3]==null,$$slots:{default:[Ei]},$$scope:{ctx:i}}}),o.$on("click",i[8]),s=new _t({props:{disabled:i[2]||i[3]==null||i[0].features.length==0,$$slots:{default:[Si]},$$scope:{ctx:i}}}),s.$on("click",i[9]);let a=i[2]&&i[3]&&In(i);return{c(){e=ne("div"),R(t.$$.fragment),n=O(),r=ne("div"),R(o.$$.fragment),u=O(),R(s.$$.fragment),l=O(),a&&a.c(),c=Ve()},l(f){e=re(f,"DIV",{});var h=le(e);M(t.$$.fragment,h),h.forEach(E),n=N(f),r=re(f,"DIV",{});var _=le(r);M(o.$$.fragment,_),u=N(_),M(s.$$.fragment,_),_.forEach(E),l=N(f),a&&a.l(f),c=Ve()},m(f,h){P(f,e,h),L(t,e,null),P(f,n,h),P(f,r,h),L(o,r,null),j(r,u),L(s,r,null),P(f,l,h),a&&a.m(f,h),P(f,c,h),p=!0},p(f,[h]){const _={};h&1026&&(_.$$scope={dirty:h,ctx:f}),t.$set(_);const m={};h&12&&(m.disabled=f[2]||f[3]==null),h&1024&&(m.$$scope={dirty:h,ctx:f}),o.$set(m);const b={};h&13&&(b.disabled=f[2]||f[3]==null||f[0].features.length==0),h&1024&&(b.$$scope={dirty:h,ctx:f}),s.$set(b),f[2]&&f[3]?a?(a.p(f,h),h&12&&$(a,1)):(a=In(f),a.c(),$(a,1),a.m(c.parentNode,c)):a&&(Mt(),S(a,1,1,()=>{a=null}),Lt())},i(f){p||($(t.$$.fragment,f),$(o.$$.fragment,f),$(s.$$.fragment,f),$(a),p=!0)},o(f){S(t.$$.fragment,f),S(o.$$.fragment,f),S(s.$$.fragment,f),S(a),p=!1},d(f){f&&(E(e),E(n),E(r),E(l),E(c)),A(t),A(o),A(s),a&&a.d(f)}}}function Ri(i,e,t){let n;lr(async()=>{await qn(),await si()});let{map:r}=e,{routeGj:o}=e,{routeAuthority:u}=e,s=Xe(null);Te(i,s,h=>t(3,n=h));let{drawingRoute:l=!1}=e;async function c(){t(1,u=ui(r));let _=`https://atip.uk/route-snappers/v3/${`${u.properties.level}_${u.properties.name}`}.bin.gz`,b=await(await fetch(_)).arrayBuffer();s.set(new di(r,new Uint8Array(b),Bn,li,Un))}function p(h){let _=JSON.parse(JSON.stringify(o));t(0,o.features=[],o),t(2,l=!0),n.addEventListenerSuccess(m=>{t(0,o.features=[m],o),t(2,l=!1),n.clearEventListeners()}),n.addEventListenerFailure(()=>{t(2,l=!1),n.clearEventListeners()}),h?n.editExistingRoute(_.features[0]):n.startRoute()}const a=()=>p(!1),f=()=>p(!0);return i.$$set=h=>{"map"in h&&t(7,r=h.map),"routeGj"in h&&t(0,o=h.routeGj),"routeAuthority"in h&&t(1,u=h.routeAuthority),"drawingRoute"in h&&t(2,l=h.drawingRoute)},[o,u,l,n,s,c,p,r,a,f]}class Mi extends De{constructor(e){super(),Fe(this,e,Ri,ki,Ne,{map:7,routeGj:0,routeAuthority:1,drawingRoute:2})}}function Li(i){let e,t,n,r,o,u;return e=new br({props:{filter:wr,paint:{"circle-color":_n(["get","type"],{"snapped-waypoint":"red","free-waypoint":"blue"},"black"),"circle-opacity":["case",["has","hovered"],.5,1],"circle-radius":_n(["get","type"],{node:Pn/2},Pn)}}}),n=new It({props:{filter:vr,paint:{"line-color":["case",["get","snapped"],"red","blue"],"line-width":2.5}}}),o=new $r({props:{filter:xr,paint:{"fill-color":"black","fill-opacity":.5}}}),{c(){R(e.$$.fragment),t=O(),R(n.$$.fragment),r=O(),R(o.$$.fragment)},l(s){M(e.$$.fragment,s),t=N(s),M(n.$$.fragment,s),r=N(s),M(o.$$.fragment,s)},m(s,l){L(e,s,l),P(s,t,l),L(n,s,l),P(s,r,l),L(o,s,l),u=!0},p:Se,i(s){u||($(e.$$.fragment,s),$(n.$$.fragment,s),$(o.$$.fragment,s),u=!0)},o(s){S(e.$$.fragment,s),S(n.$$.fragment,s),S(o.$$.fragment,s),u=!1},d(s){s&&(E(t),E(r)),A(e,s),A(n,s),A(o,s)}}}function Ai(i){let e,t;return e=new At({props:{data:i[0],$$slots:{default:[Li]},$$scope:{ctx:i}}}),{c(){R(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){L(e,n,r),t=!0},p(n,[r]){const o={};r&1&&(o.data=n[0]),r&2&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}const Pn=10;function Ii(i,e,t){let n;return Te(i,Bn,r=>t(0,n=r)),[n]}class Pi extends De{constructor(e){super(),Fe(this,e,Ii,Ai,Ne,{})}}function jn(i){let e,t,n,r,o;function u(p){i[4](p)}function s(p){i[5](p)}function l(p){i[6](p)}let c={map:i[0]};return i[3].summary.networkMap!==void 0&&(c.routeGj=i[3].summary.networkMap),i[2]!==void 0&&(c.routeAuthority=i[2]),i[1]!==void 0&&(c.drawingRoute=i[1]),e=new Mi({props:c}),G.push(()=>z(e,"routeGj",u)),G.push(()=>z(e,"routeAuthority",s)),G.push(()=>z(e,"drawingRoute",l)),{c(){R(e.$$.fragment)},l(p){M(e.$$.fragment,p)},m(p,a){L(e,p,a),o=!0},p(p,a){const f={};a&1&&(f.map=p[0]),!t&&a&8&&(t=!0,f.routeGj=p[3].summary.networkMap,q(()=>t=!1)),!n&&a&4&&(n=!0,f.routeAuthority=p[2],q(()=>n=!1)),!r&&a&2&&(r=!0,f.drawingRoute=p[1],q(()=>r=!1)),e.$set(f)},i(p){o||($(e.$$.fragment,p),o=!0)},o(p){S(e.$$.fragment,p),o=!1},d(p){A(e,p)}}}function Cn(i){let e,t;return e=new At({props:{data:i[2],$$slots:{default:[ji]},$$scope:{ctx:i}}}),{c(){R(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){L(e,n,r),t=!0},p(n,r){const o={};r&4&&(o.data=n[2]),r&512&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ji(i){let e,t;return e=new It({props:{paint:{"line-color":"black","line-width":5}}}),{c(){R(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){L(e,n,r),t=!0},p:Se,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function Ci(i){let e,t;return e=new It({props:{paint:{"line-color":"cyan","line-width":5}}}),{c(){R(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){L(e,n,r),t=!0},p:Se,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function Oi(i){let e,t,n,r,o,u=i[2]&&Cn(i);return t=new Pi({}),r=new At({props:{data:i[3].summary.networkMap,$$slots:{default:[Ci]},$$scope:{ctx:i}}}),{c(){u&&u.c(),e=O(),R(t.$$.fragment),n=O(),R(r.$$.fragment)},l(s){u&&u.l(s),e=N(s),M(t.$$.fragment,s),n=N(s),M(r.$$.fragment,s)},m(s,l){u&&u.m(s,l),P(s,e,l),L(t,s,l),P(s,n,l),L(r,s,l),o=!0},p(s,l){s[2]?u?(u.p(s,l),l&4&&$(u,1)):(u=Cn(s),u.c(),$(u,1),u.m(e.parentNode,e)):u&&(Mt(),S(u,1,1,()=>{u=null}),Lt());const c={};l&8&&(c.data=s[3].summary.networkMap),l&512&&(c.$$scope={dirty:l,ctx:s}),r.$set(c)},i(s){o||($(u),$(t.$$.fragment,s),$(r.$$.fragment,s),o=!0)},o(s){S(u),S(t.$$.fragment,s),S(r.$$.fragment,s),o=!1},d(s){s&&(E(e),E(n)),u&&u.d(s),A(t,s),A(r,s)}}}function Ni(i){let e,t,n,r,o,u,s,l=i[0]&&jn(i);function c(a){i[7](a)}let p={$$slots:{default:[Oi]},$$scope:{ctx:i}};return i[0]!==void 0&&(p.map=i[0]),o=new Er({props:p}),G.push(()=>z(o,"map",c)),{c(){e=ne("div"),t=ne("div"),l&&l.c(),n=O(),r=ne("div"),R(o.$$.fragment),this.h()},l(a){e=re(a,"DIV",{style:!0});var f=le(e);t=re(f,"DIV",{style:!0});var h=le(t);l&&l.l(h),h.forEach(E),n=N(f),r=re(f,"DIV",{style:!0});var _=le(r);M(o.$$.fragment,_),_.forEach(E),f.forEach(E),this.h()},h(){de(t,"width","30%"),de(t,"overflow-y","scroll"),de(t,"padding","10px"),de(t,"border","1px solid black"),de(r,"position","relative"),de(r,"width","70%"),de(e,"display","flex"),de(e,"height","80vh")},m(a,f){P(a,e,f),j(e,t),l&&l.m(t,null),j(e,n),j(e,r),L(o,r,null),s=!0},p(a,[f]){a[0]?l?(l.p(a,f),f&1&&$(l,1)):(l=jn(a),l.c(),$(l,1),l.m(t,null)):l&&(Mt(),S(l,1,1,()=>{l=null}),Lt());const h={};f&524&&(h.$$scope={dirty:f,ctx:a}),!u&&f&1&&(u=!0,h.map=a[0],q(()=>u=!1)),o.$set(h)},i(a){s||($(l),$(o.$$.fragment,a),s=!0)},o(a){S(l),S(o.$$.fragment,a),s=!1},d(a){a&&E(e),l&&l.d(),A(o)}}}function Ti(i,e,t){let n;Te(i,K,f=>t(3,n=f));let r,o=!1,u=null;function s(f){!f||n.summary.networkMap.features.length==0||f.fitBounds(Sr(n.summary.networkMap),{padding:20,animate:!1})}function l(f){i.$$.not_equal(n.summary.networkMap,f)&&(n.summary.networkMap=f,K.set(n))}function c(f){u=f,t(2,u)}function p(f){o=f,t(1,o)}function a(f){r=f,t(0,r)}return i.$$.update=()=>{i.$$.dirty&1&&s(r)},[r,o,u,n,l,c,p,a]}class Di extends De{constructor(e){super(),Fe(this,e,Ti,Ni,Ne,{})}}function On(i){let e,t,n,r=i[1].toFixed(2)+"",o,u;return{c(){e=ne("p"),t=Y("LineStrings in the Network Map cover a total of "),n=ne("b"),o=Y(r),u=Y(`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`)},l(s){e=re(s,"P",{});var l=le(e);t=Z(l,"LineStrings in the Network Map cover a total of "),n=re(l,"B",{});var c=le(n);o=Z(c,r),c.forEach(E),u=Z(l,`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`),l.forEach(E)},m(s,l){P(s,e,l),j(e,t),j(e,n),j(n,o),j(e,u)},p(s,l){l&2&&r!==(r=s[1].toFixed(2)+"")&&Qe(o,r)},d(s){s&&E(e)}}}function Fi(i){let e,t,n,r,o,u,s,l,c,p,a,f,h,_,m,b,v,I,F,k,B,d,T,D,H,U,X,ee,W,ae,ke,oe,Re,et,fe,tt,nt,Ue,ce,rt,it,he,ot,st,pe,ut,lt,at,ft,ge,ct,ht,xe,Ge;function zn(g){i[2](g)}let jt={label:"Date of design review"};i[0].summary.dateDesignReview!==void 0&&(jt.value=i[0].summary.dateDesignReview),t=new kr({props:jt}),G.push(()=>z(t,"value",zn));function Wn(g){i[3](g)}let Ct={label:"Scheme reference"};i[0].summary.schemeReference!==void 0&&(Ct.value=i[0].summary.schemeReference),o=new gt({props:Ct}),G.push(()=>z(o,"value",Wn));function Kn(g){i[4](g)}let Ot={label:"Scheme name"};i[0].summary.schemeName!==void 0&&(Ot.value=i[0].summary.schemeName),l=new gt({props:Ot}),G.push(()=>z(l,"value",Kn));function Jn(g){i[5](g)}let Nt={label:"Scheme summary"};i[0].summary.schemeSummary!==void 0&&(Nt.value=i[0].summary.schemeSummary),a=new qe({props:Nt}),G.push(()=>z(a,"value",Jn));function Qn(g){i[6](g)}let Tt={label:"Scheme information reviewed"};i[0].summary.schemeInfoReviewed!==void 0&&(Tt.value=i[0].summary.schemeInfoReviewed),_=new qe({props:Tt}),G.push(()=>z(_,"value",Qn));function Vn(g){i[7](g)}let Dt={label:"Authority",emptyOption:!0,choices:Me(fr)};i[0].summary.authority!==void 0&&(Dt.value=i[0].summary.authority),v=new gn({props:Dt}),G.push(()=>z(v,"value",Vn));function Yn(g){i[8](g)}let Ft={label:"Transport / Combined Authority",emptyOption:!0,choices:Me(cr)};i[0].summary.transportOrCombinedAuthority!==void 0&&(Ft.value=i[0].summary.transportOrCombinedAuthority),k=new gn({props:Ft}),G.push(()=>z(k,"value",Yn));function Zn(g){i[9](g)}let Bt={label:"Region",emptyOption:!0,choices:Me(hr)};i[0].summary.region!==void 0&&(Bt.value=i[0].summary.region),T=new ar({props:Bt}),G.push(()=>z(T,"value",Zn));function Hn(g){i[10](g)}let Ut={legend:"Funding programme",choices:Me(pr)};i[0].summary.fundingProgramme!==void 0&&(Ut.value=i[0].summary.fundingProgramme),U=new pt({props:Ut}),G.push(()=>z(U,"value",Hn));function Xn(g){i[11](g)}let Gt={legend:"Design stage",choices:Me(gr)};i[0].summary.designStage!==void 0&&(Gt.value=i[0].summary.designStage),W=new pt({props:Gt}),G.push(()=>z(W,"value",Xn));function er(g){i[12](g)}let qt={label:"Funding conditions"};i[0].summary.fundingConditions!==void 0&&(qt.value=i[0].summary.fundingConditions),oe=new qe({props:qt}),G.push(()=>z(oe,"value",er));function tr(g){i[13](g)}let zt={label:"Inspector email address"};i[0].summary.inspectorEmail!==void 0&&(zt.value=i[0].summary.inspectorEmail),fe=new gt({props:zt}),G.push(()=>z(fe,"value",tr));let Q=i[1]&&On(i);function nr(g){i[14](g)}let Wt={label:"Route length assessed here (km)",width:6,min:0};i[0].summary.assessedRouteLengthKm!==void 0&&(Wt.value=i[0].summary.assessedRouteLengthKm),ce=new pn({props:Wt}),G.push(()=>z(ce,"value",nr));function rr(g){i[15](g)}let Kt={label:"Total route length (km)",width:6,min:0};i[0].summary.totalRouteLengthKm!==void 0&&(Kt.value=i[0].summary.totalRouteLengthKm),he=new pn({props:Kt}),G.push(()=>z(he,"value",rr));function ir(g){i[16](g)}let Jt={label:"Notes"};i[0].summary.notes!==void 0&&(Jt.value=i[0].summary.notes),pe=new qe({props:Jt}),G.push(()=>z(pe,"value",ir));function or(g){i[17](g)}let Qt={legend:"Route Check Type (Street or Path)",hint:"What type of route is being reviewed: Street Check (e.g. on- or by-carriageway) or Path Check (e.g. a traffic-free path featuring minimal interactions with motor traffic)",choices:[["street","Street Check"],["path","Path Check"]]};return i[0].summary.checkType!==void 0&&(Qt.value=i[0].summary.checkType),ge=new pt({props:Qt}),G.push(()=>z(ge,"value",or)),xe=new Di({}),{c(){e=ne("div"),R(t.$$.fragment),r=O(),R(o.$$.fragment),s=O(),R(l.$$.fragment),p=O(),R(a.$$.fragment),h=O(),R(_.$$.fragment),b=O(),R(v.$$.fragment),F=O(),R(k.$$.fragment),d=O(),R(T.$$.fragment),H=O(),R(U.$$.fragment),ee=O(),R(W.$$.fragment),ke=O(),R(oe.$$.fragment),et=O(),R(fe.$$.fragment),nt=O(),Q&&Q.c(),Ue=O(),R(ce.$$.fragment),it=O(),R(he.$$.fragment),st=O(),R(pe.$$.fragment),lt=O(),at=ne("hr"),ft=O(),R(ge.$$.fragment),ht=O(),R(xe.$$.fragment),this.h()},l(g){e=re(g,"DIV",{class:!0});var w=le(e);M(t.$$.fragment,w),r=N(w),M(o.$$.fragment,w),s=N(w),M(l.$$.fragment,w),p=N(w),M(a.$$.fragment,w),h=N(w),M(_.$$.fragment,w),b=N(w),M(v.$$.fragment,w),F=N(w),M(k.$$.fragment,w),d=N(w),M(T.$$.fragment,w),H=N(w),M(U.$$.fragment,w),ee=N(w),M(W.$$.fragment,w),ke=N(w),M(oe.$$.fragment,w),et=N(w),M(fe.$$.fragment,w),nt=N(w),Q&&Q.l(w),Ue=N(w),M(ce.$$.fragment,w),it=N(w),M(he.$$.fragment,w),st=N(w),M(pe.$$.fragment,w),lt=N(w),at=re(w,"HR",{}),ft=N(w),M(ge.$$.fragment,w),ht=N(w),M(xe.$$.fragment,w),w.forEach(E),this.h()},h(){wt(e,"class","govuk-width-container")},m(g,w){P(g,e,w),L(t,e,null),j(e,r),L(o,e,null),j(e,s),L(l,e,null),j(e,p),L(a,e,null),j(e,h),L(_,e,null),j(e,b),L(v,e,null),j(e,F),L(k,e,null),j(e,d),L(T,e,null),j(e,H),L(U,e,null),j(e,ee),L(W,e,null),j(e,ke),L(oe,e,null),j(e,et),L(fe,e,null),j(e,nt),Q&&Q.m(e,null),j(e,Ue),L(ce,e,null),j(e,it),L(he,e,null),j(e,st),L(pe,e,null),j(e,lt),j(e,at),j(e,ft),L(ge,e,null),j(e,ht),L(xe,e,null),Ge=!0},p(g,[w]){const Vt={};!n&&w&1&&(n=!0,Vt.value=g[0].summary.dateDesignReview,q(()=>n=!1)),t.$set(Vt);const Yt={};!u&&w&1&&(u=!0,Yt.value=g[0].summary.schemeReference,q(()=>u=!1)),o.$set(Yt);const Zt={};!c&&w&1&&(c=!0,Zt.value=g[0].summary.schemeName,q(()=>c=!1)),l.$set(Zt);const Ht={};!f&&w&1&&(f=!0,Ht.value=g[0].summary.schemeSummary,q(()=>f=!1)),a.$set(Ht);const Xt={};!m&&w&1&&(m=!0,Xt.value=g[0].summary.schemeInfoReviewed,q(()=>m=!1)),_.$set(Xt);const en={};!I&&w&1&&(I=!0,en.value=g[0].summary.authority,q(()=>I=!1)),v.$set(en);const tn={};!B&&w&1&&(B=!0,tn.value=g[0].summary.transportOrCombinedAuthority,q(()=>B=!1)),k.$set(tn);const nn={};!D&&w&1&&(D=!0,nn.value=g[0].summary.region,q(()=>D=!1)),T.$set(nn);const rn={};!X&&w&1&&(X=!0,rn.value=g[0].summary.fundingProgramme,q(()=>X=!1)),U.$set(rn);const on={};!ae&&w&1&&(ae=!0,on.value=g[0].summary.designStage,q(()=>ae=!1)),W.$set(on);const sn={};!Re&&w&1&&(Re=!0,sn.value=g[0].summary.fundingConditions,q(()=>Re=!1)),oe.$set(sn);const un={};!tt&&w&1&&(tt=!0,un.value=g[0].summary.inspectorEmail,q(()=>tt=!1)),fe.$set(un),g[1]?Q?Q.p(g,w):(Q=On(g),Q.c(),Q.m(e,Ue)):Q&&(Q.d(1),Q=null);const ln={};!rt&&w&1&&(rt=!0,ln.value=g[0].summary.assessedRouteLengthKm,q(()=>rt=!1)),ce.$set(ln);const an={};!ot&&w&1&&(ot=!0,an.value=g[0].summary.totalRouteLengthKm,q(()=>ot=!1)),he.$set(an);const fn={};!ut&&w&1&&(ut=!0,fn.value=g[0].summary.notes,q(()=>ut=!1)),pe.$set(fn);const cn={};!ct&&w&1&&(ct=!0,cn.value=g[0].summary.checkType,q(()=>ct=!1)),ge.$set(cn)},i(g){Ge||($(t.$$.fragment,g),$(o.$$.fragment,g),$(l.$$.fragment,g),$(a.$$.fragment,g),$(_.$$.fragment,g),$(v.$$.fragment,g),$(k.$$.fragment,g),$(T.$$.fragment,g),$(U.$$.fragment,g),$(W.$$.fragment,g),$(oe.$$.fragment,g),$(fe.$$.fragment,g),$(ce.$$.fragment,g),$(he.$$.fragment,g),$(pe.$$.fragment,g),$(ge.$$.fragment,g),$(xe.$$.fragment,g),Ge=!0)},o(g){S(t.$$.fragment,g),S(o.$$.fragment,g),S(l.$$.fragment,g),S(a.$$.fragment,g),S(_.$$.fragment,g),S(v.$$.fragment,g),S(k.$$.fragment,g),S(T.$$.fragment,g),S(U.$$.fragment,g),S(W.$$.fragment,g),S(oe.$$.fragment,g),S(fe.$$.fragment,g),S(ce.$$.fragment,g),S(he.$$.fragment,g),S(pe.$$.fragment,g),S(ge.$$.fragment,g),S(xe.$$.fragment,g),Ge=!1},d(g){g&&E(e),A(t),A(o),A(l),A(a),A(_),A(v),A(k),A(T),A(U),A(W),A(oe),A(fe),Q&&Q.d(),A(ce),A(he),A(pe),A(ge),A(xe)}}}function Bi(i,e,t){let n,r;Te(i,K,d=>t(0,r=d));function o(d){let T=0;for(let D of d.features)D.geometry.type=="LineString"&&(T+=_r(D,{units:"kilometers"}));return T>0?T:null}function u(d){i.$$.not_equal(r.summary.dateDesignReview,d)&&(r.summary.dateDesignReview=d,K.set(r))}function s(d){i.$$.not_equal(r.summary.schemeReference,d)&&(r.summary.schemeReference=d,K.set(r))}function l(d){i.$$.not_equal(r.summary.schemeName,d)&&(r.summary.schemeName=d,K.set(r))}function c(d){i.$$.not_equal(r.summary.schemeSummary,d)&&(r.summary.schemeSummary=d,K.set(r))}function p(d){i.$$.not_equal(r.summary.schemeInfoReviewed,d)&&(r.summary.schemeInfoReviewed=d,K.set(r))}function a(d){i.$$.not_equal(r.summary.authority,d)&&(r.summary.authority=d,K.set(r))}function f(d){i.$$.not_equal(r.summary.transportOrCombinedAuthority,d)&&(r.summary.transportOrCombinedAuthority=d,K.set(r))}function h(d){i.$$.not_equal(r.summary.region,d)&&(r.summary.region=d,K.set(r))}function _(d){i.$$.not_equal(r.summary.fundingProgramme,d)&&(r.summary.fundingProgramme=d,K.set(r))}function m(d){i.$$.not_equal(r.summary.designStage,d)&&(r.summary.designStage=d,K.set(r))}function b(d){i.$$.not_equal(r.summary.fundingConditions,d)&&(r.summary.fundingConditions=d,K.set(r))}function v(d){i.$$.not_equal(r.summary.inspectorEmail,d)&&(r.summary.inspectorEmail=d,K.set(r))}function I(d){i.$$.not_equal(r.summary.assessedRouteLengthKm,d)&&(r.summary.assessedRouteLengthKm=d,K.set(r))}function F(d){i.$$.not_equal(r.summary.totalRouteLengthKm,d)&&(r.summary.totalRouteLengthKm=d,K.set(r))}function k(d){i.$$.not_equal(r.summary.notes,d)&&(r.summary.notes=d,K.set(r))}function B(d){i.$$.not_equal(r.summary.checkType,d)&&(r.summary.checkType=d,K.set(r))}return i.$$.update=()=>{i.$$.dirty&1&&t(1,n=o(r.summary.networkMap))},[r,n,u,s,l,c,p,a,f,h,_,m,b,v,I,F,k,B]}class io extends De{constructor(e){super(),Fe(this,e,Bi,Fi,Ne,{})}}export{io as component};
