import{s as Ae,l as Or,e as U,c as q,b as oe,f as $,p as ye,i as M,h as T,u as Dr,r as Tr,v as zr,a as j,E as ue,g as N,k as ae,W as bi,Y as wi,R as vi,w as Z,x as K,G as $i,t as Y,d as J,z as ki,j as Je,X as Hn,m as ht,q as ie,n as Se,A as Ut,P as Br}from"../chunks/scheduler.B-9e-9-p.js";import{S as Ne,i as Oe,t as k,b as S,c as P,a as A,m as I,g as xe,f as Re,d as C,e as V}from"../chunks/index.DroATz0g.js";import{p as rt}from"../chunks/index.CdlRgePr.js";import{D as Yn}from"../chunks/DecimalInput.Ba7XOjF1.js";import{R as qt}from"../chunks/Radio.BdRLhhzG.js";import{S as Jn}from"../chunks/Select.CkHvvajI.js";import{S as Ei,a as Si,t as xi,r as Ri,f as Mi,d as Li}from"../chunks/lists.DWqxC6TW.js";import{T as mt}from"../chunks/TextArea.Duw9aX5O.js";import{T as wt}from"../chunks/TextInput.BMwkTE4v.js";import{s as X}from"../chunks/data.Ix4Q9YLX.js";import{t as Pi}from"../chunks/index.CQKea4o7.js";import{F as Fr,a as Ai,f as Ii,z as Ci,A as ji,t as Ni,B as Oi,D as Gr,E as Di,H as Ti,G as St,C as zi,L as hn,M as Bi,b as Fi}from"../chunks/index.ClFpVPGG.js";import{t as Qn}from"../chunks/index.ByXnjUqU.js";import{w as We}from"../chunks/index.sY0ZqQkh.js";import{M as Gi,C as Xn}from"../chunks/Marker.CIe9GyU8.js";import{S as Ye}from"../chunks/SecondaryButton.3eYdcbxs.js";/* empty css                                                    */import{e as xt,u as Ui,o as qi}from"../chunks/each.DAWvWy0T.js";import{E as Wi}from"../chunks/ErrorMessage.DtfWKoy6.js";import{g as Wt,a as Zt}from"../chunks/spread.CgU5AtxT.js";import{D as Zi}from"../chunks/DateInput.DR7OFbKa.js";function Ki(r){let e,t,n;const i=r[3].default,o=Or(i,r,r[2],null);return{c(){e=U("fieldset"),t=U("div"),o&&o.c(),this.h()},l(s){e=q(s,"FIELDSET",{class:!0});var l=oe(e);t=q(l,"DIV",{class:!0,"data-module":!0});var a=oe(t);o&&o.l(a),a.forEach($),l.forEach($),this.h()},h(){ye(t,"class",r[0]),ye(t,"data-module","govuk-checkboxes"),ye(e,"class","govuk-fieldset")},m(s,l){M(s,e,l),T(e,t),o&&o.m(t,null),n=!0},p(s,[l]){o&&o.p&&(!n||l&4)&&Dr(o,i,s,s[2],n?zr(i,s[2],l,null):Tr(s[2]),null)},i(s){n||(k(o,s),n=!0)},o(s){S(o,s),n=!1},d(s){s&&$(e),o&&o.d(s)}}}function Vi(r,e,t){let{$$slots:n={},$$scope:i}=e,{small:o=!1}=e,s=o?"govuk-checkboxes--small":"govuk-checkboxes";return r.$$set=l=>{"small"in l&&t(1,o=l.small),"$$scope"in l&&t(2,i=l.$$scope)},[s,o,i,n]}class Hi extends Ne{constructor(e){super(),Oe(this,e,Vi,Ki,Ae,{small:1})}}class Kt{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const o=t[i],s=e+o,l=Math.abs(e)<Math.abs(o)?e-(s-o):o-(s-e);l&&(t[n++]=l),e=s}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t=this._n,n,i,o,s=0;if(t>0){for(s=e[--t];t>0&&(n=s,i=e[--t],s=n+i,o=i-(s-n),!o););t>0&&(o<0&&e[t-1]<0||o>0&&e[t-1]>0)&&(i=o*2,n=s+i,i==n-s&&(s=n))}return s}}var Yi=1e-6,er=1e-12,pn=Math.PI,tr=pn/2,nr=180/pn,Me=pn/180,Ur=Math.atan2,Le=Math.cos,Qt=Math.hypot,Pe=Math.sin,Ji=Math.sqrt;function qr(r){return r>1?tr:r<-1?-tr:Math.asin(r)}function Qi(){}function Rt(r,e){r&&ir.hasOwnProperty(r.type)&&ir[r.type](r,e)}var rr={Feature:function(r,e){Rt(r.geometry,e)},FeatureCollection:function(r,e){for(var t=r.features,n=-1,i=t.length;++n<i;)Rt(t[n].geometry,e)}},ir={Sphere:function(r,e){e.sphere()},Point:function(r,e){r=r.coordinates,e.point(r[0],r[1],r[2])},MultiPoint:function(r,e){for(var t=r.coordinates,n=-1,i=t.length;++n<i;)r=t[n],e.point(r[0],r[1],r[2])},LineString:function(r,e){Xt(r.coordinates,e,0)},MultiLineString:function(r,e){for(var t=r.coordinates,n=-1,i=t.length;++n<i;)Xt(t[n],e,0)},Polygon:function(r,e){or(r.coordinates,e)},MultiPolygon:function(r,e){for(var t=r.coordinates,n=-1,i=t.length;++n<i;)or(t[n],e)},GeometryCollection:function(r,e){for(var t=r.geometries,n=-1,i=t.length;++n<i;)Rt(t[n],e)}};function Xt(r,e,t){var n=-1,i=r.length-t,o;for(e.lineStart();++n<i;)o=r[n],e.point(o[0],o[1],o[2]);e.lineEnd()}function or(r,e){var t=-1,n=r.length;for(e.polygonStart();++t<n;)Xt(r[t],e,1);e.polygonEnd()}function Xi(r,e){r&&rr.hasOwnProperty(r.type)?rr[r.type](r,e):Rt(r,e)}var ot,Mt,Lt,Pt,At,It,Ct,jt,en,tn,nn,Wr,Zr,ce,he,pe,$e={sphere:Qi,point:gn,lineStart:sr,lineEnd:lr,polygonStart:function(){$e.lineStart=no,$e.lineEnd=ro},polygonEnd:function(){$e.lineStart=sr,$e.lineEnd=lr}};function gn(r,e){r*=Me,e*=Me;var t=Le(e);pt(t*Le(r),t*Pe(r),Pe(e))}function pt(r,e,t){++ot,Lt+=(r-Lt)/ot,Pt+=(e-Pt)/ot,At+=(t-At)/ot}function sr(){$e.point=eo}function eo(r,e){r*=Me,e*=Me;var t=Le(e);ce=t*Le(r),he=t*Pe(r),pe=Pe(e),$e.point=to,pt(ce,he,pe)}function to(r,e){r*=Me,e*=Me;var t=Le(e),n=t*Le(r),i=t*Pe(r),o=Pe(e),s=Ur(Ji((s=he*o-pe*i)*s+(s=pe*n-ce*o)*s+(s=ce*i-he*n)*s),ce*n+he*i+pe*o);Mt+=s,It+=s*(ce+(ce=n)),Ct+=s*(he+(he=i)),jt+=s*(pe+(pe=o)),pt(ce,he,pe)}function lr(){$e.point=gn}function no(){$e.point=io}function ro(){Kr(Wr,Zr),$e.point=gn}function io(r,e){Wr=r,Zr=e,r*=Me,e*=Me,$e.point=Kr;var t=Le(e);ce=t*Le(r),he=t*Pe(r),pe=Pe(e),pt(ce,he,pe)}function Kr(r,e){r*=Me,e*=Me;var t=Le(e),n=t*Le(r),i=t*Pe(r),o=Pe(e),s=he*o-pe*i,l=pe*n-ce*o,a=ce*i-he*n,f=Qt(s,l,a),h=qr(f),u=f&&-h/f;en.add(u*s),tn.add(u*l),nn.add(u*a),Mt+=h,It+=h*(ce+(ce=n)),Ct+=h*(he+(he=i)),jt+=h*(pe+(pe=o)),pt(ce,he,pe)}function oo(r){ot=Mt=Lt=Pt=At=It=Ct=jt=0,en=new Kt,tn=new Kt,nn=new Kt,Xi(r,$e);var e=+en,t=+tn,n=+nn,i=Qt(e,t,n);return i<er&&(e=It,t=Ct,n=jt,Mt<Yi&&(e=Lt,t=Pt,n=At),i=Qt(e,t,n),i<er)?[NaN,NaN]:[Ur(t,e)*nr,qr(n/i)*nr]}const{Map:so}=Ni;function ar(r,e,t){const n=r.slice();n[40]=e[t];const i=n[1](n[40]);n[41]=i;const o=typeof n[7]=="function"?n[7](n[40]):n[7];return n[42]=o,n}const lo=r=>({feature:r[0]&1024,position:r[0]&1026}),ur=r=>({feature:r[40],position:r[41]});function fr(r){let e=[],t=new so,n,i,o=xt(r[10]);const s=l=>l[40].id;for(let l=0;l<o.length;l+=1){let a=ar(r,o,l),f=s(a);t.set(f,e[l]=cr(f,a))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();n=ue()},l(l){for(let a=0;a<e.length;a+=1)e[a].l(l);n=ue()},m(l,a){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(l,a);M(l,n,a),i=!0},p(l,a){a[0]&264095|a[1]&4&&(o=xt(l[10]),xe(),e=Ui(e,a,s,1,l,o,t,n.parentNode,qi,cr,n,ar),Re())},i(l){if(!i){for(let a=0;a<o.length;a+=1)k(e[a]);i=!0}},o(l){for(let a=0;a<e.length;a+=1)S(e[a]);i=!1},d(l){l&&$(n);for(let a=0;a<e.length;a+=1)e[a].d(l)}}}function ao(r){let e,t;const n=r[24].default,i=Or(n,r,r[33],ur);return{c(){i&&i.c(),e=j()},l(o){i&&i.l(o),e=N(o)},m(o,s){i&&i.m(o,s),M(o,e,s),t=!0},p(o,s){i&&i.p&&(!t||s[0]&1026|s[1]&4)&&Dr(i,n,o,o[33],t?zr(n,o[33],s,lo):Tr(o[33]),ur)},i(o){t||(k(i,o),t=!0)},o(o){S(i,o),t=!1},d(o){o&&$(e),i&&i.d(o)}}}function cr(r,e){let t,n,i;function o(){return e[25](e[40])}function s(){return e[26](e[40])}function l(...c){return e[27](e[40],...c)}function a(...c){return e[28](e[40],...c)}function f(...c){return e[29](e[40],...c)}function h(...c){return e[30](e[40],...c)}function u(...c){return e[31](e[40],...c)}function p(...c){return e[32](e[40],...c)}return n=new Gi({props:{asButton:e[3],interactive:e[2],draggable:e[4],class:e[8],zIndex:e[42],lngLat:e[41],$$slots:{default:[ao]},$$scope:{ctx:e}}}),n.$on("mouseenter",o),n.$on("mouseleave",s),n.$on("dragstart",l),n.$on("drag",a),n.$on("dragend",f),n.$on("click",h),n.$on("dblclick",u),n.$on("contextmenu",p),{key:r,first:null,c(){t=ue(),P(n.$$.fragment),this.h()},l(c){t=ue(),A(n.$$.fragment,c),this.h()},h(){this.first=t},m(c,d){M(c,t,d),I(n,c,d),i=!0},p(c,d){e=c;const b={};d[0]&8&&(b.asButton=e[3]),d[0]&4&&(b.interactive=e[2]),d[0]&16&&(b.draggable=e[4]),d[0]&256&&(b.class=e[8]),d[0]&1152&&(b.zIndex=e[42]),d[0]&1026&&(b.lngLat=e[41]),d[0]&1026|d[1]&4&&(b.$$scope={dirty:d,ctx:e}),n.$set(b)},i(c){i||(k(n.$$.fragment,c),i=!0)},o(c){S(n.$$.fragment,c),i=!1},d(c){c&&$(t),C(n,c)}}}function uo(r){let e,t,n,i;e=new Fr({props:{minzoom:r[5],maxzoom:r[6],paint:{"fill-opacity":0},beforeLayerType:"symbol"}});let o=r[11]>=r[13]&&r[11]<=r[12]&&fr(r);return{c(){P(e.$$.fragment),t=j(),o&&o.c(),n=ue()},l(s){A(e.$$.fragment,s),t=N(s),o&&o.l(s),n=ue()},m(s,l){I(e,s,l),M(s,t,l),o&&o.m(s,l),M(s,n,l),i=!0},p(s,l){const a={};l[0]&32&&(a.minzoom=s[5]),l[0]&64&&(a.maxzoom=s[6]),e.$set(a),s[11]>=s[13]&&s[11]<=s[12]?o?(o.p(s,l),l[0]&14336&&k(o,1)):(o=fr(s),o.c(),k(o,1),o.m(n.parentNode,n)):o&&(xe(),S(o,1,1,()=>{o=null}),Re())},i(s){i||(k(e.$$.fragment,s),k(o),i=!0)},o(s){S(e.$$.fragment,s),S(o),i=!1},d(s){s&&($(t),$(n)),C(e,s),o&&o.d(s)}}}function fo(r,e,t){let n,i,o,s,l,a,f,{$$slots:h={},$$scope:u}=e;const{map:p,source:c,minzoom:d,maxzoom:b}=Ai();ae(r,p,x=>t(21,s=x)),ae(r,c,x=>t(9,l=x)),ae(r,d,x=>t(23,f=x)),ae(r,b,x=>t(22,a=x));const _=bi();let{applyToClusters:g=void 0}=e,{filter:v=void 0}=e,{markerLngLat:y=oo}=e,{interactive:E=!0}=e,{asButton:D=!1}=e,{draggable:w=!1}=e,{minzoom:z=void 0}=e,{maxzoom:F=void 0}=e,{hovered:W=null}=e,{zIndex:G=void 0}=e,{class:te=void 0}=e,ne=!1;function H(){s&&(ne=!0,s.on("zoom",Ze),s.on("move",Q),s.on("moveend",Q),s.loaded()?s.once("load",Q):Q())}function de(x){x.sourceId===l&&x.isSourceLoaded&&(ne?Q():H())}wi(()=>{s&&(s.off("zoom",Ze),s.off("move",Q),s.off("moveend",Q),s.off("sourcedata",de))});let De=[];function Q(){var me;if(!s||!l)return;let x=s.querySourceFeatures(l,{filter:o}),re=new Map;for(let ge of x)ge.id||((me=ge.properties)!=null&&me.cluster_id?ge.id="autocluster_"+ge.properties.cluster_id:ge.id=Ii("autofeat")),re.set(ge.id,ge);t(10,De=[...re.values()].sort((ge,nt)=>ge.id.toString().localeCompare(nt.id.toString())))}let Te=(s==null?void 0:s.getZoom())??0;function Ze(x){t(11,Te=s.getZoom()),Q()}const be=x=>{t(0,W=x)},Qe=x=>{(W==null?void 0:W.id)===x.id&&t(0,W=null)},Xe=(x,re)=>_("dragstart",{...re.detail,source:l,feature:x}),Ke=(x,re)=>_("drag",{...re.detail,source:l,feature:x}),we=(x,re)=>_("dragend",{...re.detail,source:l,feature:x}),et=(x,re)=>_("click",{...re.detail,source:l,feature:x}),tt=(x,re)=>_("dblclick",{...re.detail,source:l,feature:x}),ve=(x,re)=>_("contextmenu",{...re.detail,source:l,feature:x});return r.$$set=x=>{"applyToClusters"in x&&t(19,g=x.applyToClusters),"filter"in x&&t(20,v=x.filter),"markerLngLat"in x&&t(1,y=x.markerLngLat),"interactive"in x&&t(2,E=x.interactive),"asButton"in x&&t(3,D=x.asButton),"draggable"in x&&t(4,w=x.draggable),"minzoom"in x&&t(5,z=x.minzoom),"maxzoom"in x&&t(6,F=x.maxzoom),"hovered"in x&&t(0,W=x.hovered),"zIndex"in x&&t(7,G=x.zIndex),"class"in x&&t(8,te=x.class),"$$scope"in x&&t(33,u=x.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&8388640&&t(13,n=z??f),r.$$.dirty[0]&4194368&&t(12,i=F??a),r.$$.dirty[0]&1572864&&(o=Ci("all",ji(g),v)),r.$$.dirty[0]&2097664&&s&&l){let x=s.getSource(l);x!=null&&x.loaded()?H():s.on("sourcedata",de)}},[W,y,E,D,w,z,F,G,te,l,De,Te,i,n,p,c,d,b,_,g,v,s,a,f,h,be,Qe,Xe,Ke,we,et,tt,ve,u]}class co extends Ne{constructor(e){super(),Oe(this,e,fo,uo,Ae,{applyToClusters:19,filter:20,markerLngLat:1,interactive:2,asButton:3,draggable:4,minzoom:5,maxzoom:6,hovered:0,zIndex:7,class:8},null,[-1,-1])}}const ho=""+new URL("../assets/authorities.GD_9e3jr.geojson",import.meta.url).href;/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function po(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(f){return function(h){return a([f,h])}}function a(f){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=f[0]&2?i.return:f[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,f[1])).done)return o;switch(i=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,i=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){t.label=f[1];break}if(f[0]===6&&t.label<o[1]){t.label=o[1],o=f;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(f);break}o[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(r,t)}catch(h){f=[6,h],i=0}finally{n=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Ue=function(){function r(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return r}();function go(r,e){return r>e?1:r<e?-1:0}function ze(r,e,t){for(var n=new Ue(null,null),i=n,o=n;;){var s=t(r,e.key);if(s<0){if(e.left===null)break;if(t(r,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,e=l,e.left===null)break}o.left=e,o=e,e=e.left}else if(s>0){if(e.right===null)break;if(t(r,e.right.key)>0){var l=e.right;if(e.right=l.left,l.left=e,e=l,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function Vt(r,e,t,n){var i=new Ue(r,e);if(t===null)return i.left=i.right=null,i;t=ze(r,t,n);var o=n(r,t.key);return o<0?(i.left=t.left,i.right=t,t.left=null):o>=0&&(i.right=t.right,i.left=t,t.right=null),i}function hr(r,e,t){var n=null,i=null;if(e){e=ze(r,e,t);var o=t(e.key,r);o===0?(n=e.left,i=e.right):o<0?(i=e.right,e.right=null,n=e):(n=e.left,e.left=null,i=e)}return{left:n,right:i}}function mo(r,e,t){return e===null?r:(r===null||(e=ze(r.key,e,t),e.left=r),e)}function rn(r,e,t,n,i){if(r){n(""+e+(t?"└── ":"├── ")+i(r)+`
`);var o=e+(t?"    ":"│   ");r.left&&rn(r.left,o,!1,n,i),r.right&&rn(r.right,o,!0,n,i)}}var dn=function(){function r(e){e===void 0&&(e=go),this._root=null,this._size=0,this._comparator=e}return r.prototype.insert=function(e,t){return this._size++,this._root=Vt(e,t,this._root,this._comparator)},r.prototype.add=function(e,t){var n=new Ue(e,t);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,o=ze(e,this._root,i),s=i(e,o.key);return s===0?this._root=o:(s<0?(n.left=o.left,n.right=o,o.left=null):s>0&&(n.right=o.right,n.left=o,o.right=null),this._size++,this._root=n),this._root},r.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},r.prototype._remove=function(e,t,n){var i;if(t===null)return null;t=ze(e,t,n);var o=n(e,t.key);return o===0?(t.left===null?i=t.right:(i=ze(e,t.left,n),i.right=t.right),this._size--,i):t},r.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=ze(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},r.prototype.findStatic=function(e){for(var t=this._root,n=this._comparator;t;){var i=n(e,t.key);if(i===0)return t;i<0?t=t.left:t=t.right}return null},r.prototype.find=function(e){return this._root&&(this._root=ze(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},r.prototype.contains=function(e){for(var t=this._root,n=this._comparator;t;){var i=n(e,t.key);if(i===0)return!0;i<0?t=t.left:t=t.right}return!1},r.prototype.forEach=function(e,t){for(var n=this._root,i=[],o=!1;!o;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),e.call(t,n),n=n.right):o=!0;return this},r.prototype.range=function(e,t,n,i){for(var o=[],s=this._comparator,l=this._root,a;o.length!==0||l;)if(l)o.push(l),l=l.left;else{if(l=o.pop(),a=s(l.key,t),a>0)break;if(s(l.key,e)>=0&&n.call(i,l))return this;l=l.right}return this},r.prototype.keys=function(){var e=[];return this.forEach(function(t){var n=t.key;return e.push(n)}),e},r.prototype.values=function(){var e=[];return this.forEach(function(t){var n=t.data;return e.push(n)}),e},r.prototype.min=function(){return this._root?this.minNode(this._root).key:null},r.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},r.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},r.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},r.prototype.at=function(e){for(var t=this._root,n=!1,i=0,o=[];!n;)if(t)o.push(t),t=t.left;else if(o.length>0){if(t=o.pop(),i===e)return t;i++,t=t.right}else n=!0;return null},r.prototype.next=function(e){var t=this._root,n=null;if(e.right){for(n=e.right;n.left;)n=n.left;return n}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?(n=t,t=t.left):t=t.right}return n},r.prototype.prev=function(e){var t=this._root,n=null;if(e.left!==null){for(n=e.left;n.right;)n=n.right;return n}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?t=t.left:(n=t,t=t.right)}return n},r.prototype.clear=function(){return this._root=null,this._size=0,this},r.prototype.toList=function(){return yo(this._root)},r.prototype.load=function(e,t,n){t===void 0&&(t=[]),n===void 0&&(n=!1);var i=e.length,o=this._comparator;if(n&&ln(e,t,0,i-1,o),this._root===null)this._root=on(e,t,0,i),this._size=i;else{var s=bo(this.toList(),_o(e,t),o);i=this._size+i,this._root=sn({head:s},0,i)}return this},r.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(r.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),r.prototype.toString=function(e){e===void 0&&(e=function(n){return String(n.key)});var t=[];return rn(this._root,"",!0,function(n){return t.push(n)},e),t.join("")},r.prototype.update=function(e,t,n){var i=this._comparator,o=hr(e,this._root,i),s=o.left,l=o.right;i(e,t)<0?l=Vt(t,n,l,i):s=Vt(t,n,s,i),this._root=mo(s,l,i)},r.prototype.split=function(e){return hr(e,this._root,this._comparator)},r.prototype[Symbol.iterator]=function(){var e,t,n;return po(this,function(i){switch(i.label){case 0:e=this._root,t=[],n=!1,i.label=1;case 1:return n?[3,6]:e===null?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return t.length===0?[3,4]:(e=t.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:n=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},r}();function on(r,e,t,n){var i=n-t;if(i>0){var o=t+Math.floor(i/2),s=r[o],l=e[o],a=new Ue(s,l);return a.left=on(r,e,t,o),a.right=on(r,e,o+1,n),a}return null}function _o(r,e){for(var t=new Ue(null,null),n=t,i=0;i<r.length;i++)n=n.next=new Ue(r[i],e[i]);return n.next=null,t.next}function yo(r){for(var e=r,t=[],n=!1,i=new Ue(null,null),o=i;!n;)e?(t.push(e),e=e.left):t.length>0?(e=o=o.next=t.pop(),e=e.right):n=!0;return o.next=null,i.next}function sn(r,e,t){var n=t-e;if(n>0){var i=e+Math.floor(n/2),o=sn(r,e,i),s=r.head;return s.left=o,r.head=r.head.next,s.right=sn(r,i+1,t),s}return null}function bo(r,e,t){for(var n=new Ue(null,null),i=n,o=r,s=e;o!==null&&s!==null;)t(o.key,s.key)<0?(i.next=o,o=o.next):(i.next=s,s=s.next),i=i.next;return o!==null?i.next=o:s!==null&&(i.next=s),n.next}function ln(r,e,t,n,i){if(!(t>=n)){for(var o=r[t+n>>1],s=t-1,l=n+1;;){do s++;while(i(r[s],o)<0);do l--;while(i(r[l],o)>0);if(s>=l)break;var a=r[s];r[s]=r[l],r[l]=a,a=e[s],e[s]=e[l],e[l]=a}ln(r,e,t,l,i),ln(r,e,l+1,n,i)}}const je=11102230246251565e-32,le=134217729,wo=(3+8*je)*je;function Ht(r,e,t,n,i){let o,s,l,a,f=e[0],h=n[0],u=0,p=0;h>f==h>-f?(o=f,f=e[++u]):(o=h,h=n[++p]);let c=0;if(u<r&&p<t)for(h>f==h>-f?(s=f+o,l=o-(s-f),f=e[++u]):(s=h+o,l=o-(s-h),h=n[++p]),o=s,l!==0&&(i[c++]=l);u<r&&p<t;)h>f==h>-f?(s=o+f,a=s-o,l=o-(s-a)+(f-a),f=e[++u]):(s=o+h,a=s-o,l=o-(s-a)+(h-a),h=n[++p]),o=s,l!==0&&(i[c++]=l);for(;u<r;)s=o+f,a=s-o,l=o-(s-a)+(f-a),f=e[++u],o=s,l!==0&&(i[c++]=l);for(;p<t;)s=o+h,a=s-o,l=o-(s-a)+(h-a),h=n[++p],o=s,l!==0&&(i[c++]=l);return(o!==0||c===0)&&(i[c++]=o),c}function vo(r,e){let t=e[0];for(let n=1;n<r;n++)t+=e[n];return t}function gt(r){return new Float64Array(r)}const $o=(3+16*je)*je,ko=(2+12*je)*je,Eo=(9+64*je)*je*je,Ve=gt(4),pr=gt(8),gr=gt(12),dr=gt(16),fe=gt(4);function So(r,e,t,n,i,o,s){let l,a,f,h,u,p,c,d,b,_,g,v,y,E,D,w,z,F;const W=r-i,G=t-i,te=e-o,ne=n-o;E=W*ne,p=le*W,c=p-(p-W),d=W-c,p=le*ne,b=p-(p-ne),_=ne-b,D=d*_-(E-c*b-d*b-c*_),w=te*G,p=le*te,c=p-(p-te),d=te-c,p=le*G,b=p-(p-G),_=G-b,z=d*_-(w-c*b-d*b-c*_),g=D-z,u=D-g,Ve[0]=D-(g+u)+(u-z),v=E+g,u=v-E,y=E-(v-u)+(g-u),g=y-w,u=y-g,Ve[1]=y-(g+u)+(u-w),F=v+g,u=F-v,Ve[2]=v-(F-u)+(g-u),Ve[3]=F;let H=vo(4,Ve),de=ko*s;if(H>=de||-H>=de||(u=r-W,l=r-(W+u)+(u-i),u=t-G,f=t-(G+u)+(u-i),u=e-te,a=e-(te+u)+(u-o),u=n-ne,h=n-(ne+u)+(u-o),l===0&&a===0&&f===0&&h===0)||(de=Eo*s+wo*Math.abs(H),H+=W*h+ne*l-(te*f+G*a),H>=de||-H>=de))return H;E=l*ne,p=le*l,c=p-(p-l),d=l-c,p=le*ne,b=p-(p-ne),_=ne-b,D=d*_-(E-c*b-d*b-c*_),w=a*G,p=le*a,c=p-(p-a),d=a-c,p=le*G,b=p-(p-G),_=G-b,z=d*_-(w-c*b-d*b-c*_),g=D-z,u=D-g,fe[0]=D-(g+u)+(u-z),v=E+g,u=v-E,y=E-(v-u)+(g-u),g=y-w,u=y-g,fe[1]=y-(g+u)+(u-w),F=v+g,u=F-v,fe[2]=v-(F-u)+(g-u),fe[3]=F;const De=Ht(4,Ve,4,fe,pr);E=W*h,p=le*W,c=p-(p-W),d=W-c,p=le*h,b=p-(p-h),_=h-b,D=d*_-(E-c*b-d*b-c*_),w=te*f,p=le*te,c=p-(p-te),d=te-c,p=le*f,b=p-(p-f),_=f-b,z=d*_-(w-c*b-d*b-c*_),g=D-z,u=D-g,fe[0]=D-(g+u)+(u-z),v=E+g,u=v-E,y=E-(v-u)+(g-u),g=y-w,u=y-g,fe[1]=y-(g+u)+(u-w),F=v+g,u=F-v,fe[2]=v-(F-u)+(g-u),fe[3]=F;const Q=Ht(De,pr,4,fe,gr);E=l*h,p=le*l,c=p-(p-l),d=l-c,p=le*h,b=p-(p-h),_=h-b,D=d*_-(E-c*b-d*b-c*_),w=a*f,p=le*a,c=p-(p-a),d=a-c,p=le*f,b=p-(p-f),_=f-b,z=d*_-(w-c*b-d*b-c*_),g=D-z,u=D-g,fe[0]=D-(g+u)+(u-z),v=E+g,u=v-E,y=E-(v-u)+(g-u),g=y-w,u=y-g,fe[1]=y-(g+u)+(u-w),F=v+g,u=F-v,fe[2]=v-(F-u)+(g-u),fe[3]=F;const Te=Ht(Q,gr,4,fe,dr);return dr[Te-1]}function xo(r,e,t,n,i,o){const s=(e-o)*(t-i),l=(r-i)*(n-o),a=s-l,f=Math.abs(s+l);return Math.abs(a)>=$o*f?a:-So(r,e,t,n,i,o,f)}var Vr={};const it=(r,e)=>r.ll.x<=e.x&&e.x<=r.ur.x&&r.ll.y<=e.y&&e.y<=r.ur.y,an=(r,e)=>{if(e.ur.x<r.ll.x||r.ur.x<e.ll.x||e.ur.y<r.ll.y||r.ur.y<e.ll.y)return null;const t=r.ll.x<e.ll.x?e.ll.x:r.ll.x,n=r.ur.x<e.ur.x?r.ur.x:e.ur.x,i=r.ll.y<e.ll.y?e.ll.y:r.ll.y,o=r.ur.y<e.ur.y?r.ur.y:e.ur.y;return{ll:{x:t,y:i},ur:{x:n,y:o}}};let Be=Number.EPSILON;Be===void 0&&(Be=Math.pow(2,-52));const Ro=Be*Be,mr=(r,e)=>{if(-Be<r&&r<Be&&-Be<e&&e<Be)return 0;const t=r-e;return t*t<Ro*r*e?0:r<e?-1:1};class Mo{constructor(){this.reset()}reset(){this.xRounder=new _r,this.yRounder=new _r}round(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}class _r{constructor(){this.tree=new dn,this.round(0)}round(e){const t=this.tree.add(e),n=this.tree.prev(t);if(n!==null&&mr(t.key,n.key)===0)return this.tree.remove(e),n.key;const i=this.tree.next(t);return i!==null&&mr(t.key,i.key)===0?(this.tree.remove(e),i.key):e}}const ct=new Mo,vt=(r,e)=>r.x*e.y-r.y*e.x,Hr=(r,e)=>r.x*e.x+r.y*e.y,yr=(r,e,t)=>{const n=xo(r.x,r.y,e.x,e.y,t.x,t.y);return n>0?-1:n<0?1:0},Nt=r=>Math.sqrt(Hr(r,r)),Lo=(r,e,t)=>{const n={x:e.x-r.x,y:e.y-r.y},i={x:t.x-r.x,y:t.y-r.y};return vt(i,n)/Nt(i)/Nt(n)},Po=(r,e,t)=>{const n={x:e.x-r.x,y:e.y-r.y},i={x:t.x-r.x,y:t.y-r.y};return Hr(i,n)/Nt(i)/Nt(n)},br=(r,e,t)=>e.y===0?null:{x:r.x+e.x/e.y*(t-r.y),y:t},wr=(r,e,t)=>e.x===0?null:{x:t,y:r.y+e.y/e.x*(t-r.x)},Ao=(r,e,t,n)=>{if(e.x===0)return wr(t,n,r.x);if(n.x===0)return wr(r,e,t.x);if(e.y===0)return br(t,n,r.y);if(n.y===0)return br(r,e,t.y);const i=vt(e,n);if(i==0)return null;const o={x:t.x-r.x,y:t.y-r.y},s=vt(o,e)/i,l=vt(o,n)/i,a=r.x+l*e.x,f=t.x+s*n.x,h=r.y+l*e.y,u=t.y+s*n.y,p=(a+f)/2,c=(h+u)/2;return{x:p,y:c}};class _e{static compare(e,t){const n=_e.comparePoints(e.point,t.point);return n!==0?n:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:Ge.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}constructor(e,t){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let n=0,i=t.length;n<i;n++){const o=t[n];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const n=this.point.events[t];if(n.segment.consumedBy===void 0)for(let i=t+1;i<e;i++){const o=this.point.events[i];o.consumedBy===void 0&&n.otherSE.point.events===o.otherSE.point.events&&n.segment.consume(o.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,n=this.point.events.length;t<n;t++){const i=this.point.events[t];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const t=new Map,n=i=>{const o=i.otherSE;t.set(i,{sine:Lo(this.point,e.point,o.point),cosine:Po(this.point,e.point,o.point)})};return(i,o)=>{t.has(i)||n(i),t.has(o)||n(o);const{sine:s,cosine:l}=t.get(i),{sine:a,cosine:f}=t.get(o);return s>=0&&a>=0?l<f?1:l>f?-1:0:s<0&&a<0?l<f?-1:l>f?1:0:a<s?-1:a>s?1:0}}}let Io=0;class Ge{static compare(e,t){const n=e.leftSE.point.x,i=t.leftSE.point.x,o=e.rightSE.point.x,s=t.rightSE.point.x;if(s<n)return 1;if(o<i)return-1;const l=e.leftSE.point.y,a=t.leftSE.point.y,f=e.rightSE.point.y,h=t.rightSE.point.y;if(n<i){if(a<l&&a<f)return 1;if(a>l&&a>f)return-1;const u=e.comparePoint(t.leftSE.point);if(u<0)return 1;if(u>0)return-1;const p=t.comparePoint(e.rightSE.point);return p!==0?p:-1}if(n>i){if(l<a&&l<h)return-1;if(l>a&&l>h)return 1;const u=t.comparePoint(e.leftSE.point);if(u!==0)return u;const p=e.comparePoint(t.rightSE.point);return p<0?1:p>0?-1:1}if(l<a)return-1;if(l>a)return 1;if(o<s){const u=t.comparePoint(e.rightSE.point);if(u!==0)return u}if(o>s){const u=e.comparePoint(t.rightSE.point);if(u<0)return 1;if(u>0)return-1}if(o!==s){const u=f-l,p=o-n,c=h-a,d=s-i;if(u>p&&c<d)return 1;if(u<p&&c>d)return-1}return o>s?1:o<s||f<h?-1:f>h?1:e.id<t.id?-1:e.id>t.id?1:0}constructor(e,t,n,i){this.id=++Io,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=n,this.windings=i}static fromRing(e,t,n){let i,o,s;const l=_e.comparePoints(e,t);if(l<0)i=e,o=t,s=1;else if(l>0)i=t,o=e,s=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const a=new _e(i,!0),f=new _e(o,!1);return new Ge(a,f,[n],[s])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const t=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(t.x===n.x)return e.x===t.x?0:e.x<t.x?1:-1;const o=(e.y-t.y)/i.y,s=t.x+o*i.x;if(e.x===s)return 0;const l=(e.x-t.x)/i.x,a=t.y+l*i.y;return e.y===a?0:e.y<a?-1:1}getIntersection(e){const t=this.bbox(),n=e.bbox(),i=an(t,n);if(i===null)return null;const o=this.leftSE.point,s=this.rightSE.point,l=e.leftSE.point,a=e.rightSE.point,f=it(t,l)&&this.comparePoint(l)===0,h=it(n,o)&&e.comparePoint(o)===0,u=it(t,a)&&this.comparePoint(a)===0,p=it(n,s)&&e.comparePoint(s)===0;if(h&&f)return p&&!u?s:!p&&u?a:null;if(h)return u&&o.x===a.x&&o.y===a.y?null:o;if(f)return p&&s.x===l.x&&s.y===l.y?null:l;if(p&&u)return null;if(p)return s;if(u)return a;const c=Ao(o,this.vector(),l,e.vector());return c===null||!it(i,c)?null:ct.round(c.x,c.y)}split(e){const t=[],n=e.events!==void 0,i=new _e(e,!0),o=new _e(e,!1),s=this.rightSE;this.replaceRightSE(o),t.push(o),t.push(i);const l=new Ge(i,s,this.rings.slice(),this.windings.slice());return _e.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),_e.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),o.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,n=this.windings.length;t<n;t++)this.windings[t]*=-1}consume(e){let t=this,n=e;for(;t.consumedBy;)t=t.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=Ge.compare(t,n);if(i!==0){if(i>0){const o=t;t=n,n=o}if(t.prev===n){const o=t;t=n,n=o}for(let o=0,s=n.rings.length;o<s;o++){const l=n.rings[o],a=n.windings[o],f=t.rings.indexOf(l);f===-1?(t.rings.push(l),t.windings.push(a)):t.windings[f]+=a}n.rings=null,n.windings=null,n.consumedBy=t,n.leftSE.consumedBy=t.leftSE,n.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let l=0,a=this.rings.length;l<a;l++){const f=this.rings[l],h=this.windings[l],u=t.indexOf(f);u===-1?(t.push(f),n.push(h)):n[u]+=h}const o=[],s=[];for(let l=0,a=t.length;l<a;l++){if(n[l]===0)continue;const f=t[l],h=f.poly;if(s.indexOf(h)===-1)if(f.isExterior)o.push(h);else{s.indexOf(h)===-1&&s.push(h);const u=o.indexOf(f.poly);u!==-1&&o.splice(u,1)}}for(let l=0,a=o.length;l<a;l++){const f=o[l].multiPoly;i.indexOf(f)===-1&&i.push(f)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(ke.type){case"union":{const n=e.length===0,i=t.length===0;this._isInResult=n!==i;break}case"intersection":{let n,i;e.length<t.length?(n=e.length,i=t.length):(n=t.length,i=e.length),this._isInResult=i===ke.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(e.length-t.length);this._isInResult=n%2===1;break}case"difference":{const n=i=>i.length===1&&i[0].isSubject;this._isInResult=n(e)!==n(t);break}default:throw new Error(`Unrecognized operation type found ${ke.type}`)}return this._isInResult}}class vr{constructor(e,t,n){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=n,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=ct.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let o=i;for(let s=1,l=e.length;s<l;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let a=ct.round(e[s][0],e[s][1]);a.x===o.x&&a.y===o.y||(this.segments.push(Ge.fromRing(o,a,this)),a.x<this.bbox.ll.x&&(this.bbox.ll.x=a.x),a.y<this.bbox.ll.y&&(this.bbox.ll.y=a.y),a.x>this.bbox.ur.x&&(this.bbox.ur.x=a.x),a.y>this.bbox.ur.y&&(this.bbox.ur.y=a.y),o=a)}(i.x!==o.x||i.y!==o.y)&&this.segments.push(Ge.fromRing(o,i,this))}getSweepEvents(){const e=[];for(let t=0,n=this.segments.length;t<n;t++){const i=this.segments[t];e.push(i.leftSE),e.push(i.rightSE)}return e}}class Co{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vr(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=e.length;n<i;n++){const o=new vr(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=t}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let t=0,n=this.interiorRings.length;t<n;t++){const i=this.interiorRings[t].getSweepEvents();for(let o=0,s=i.length;o<s;o++)e.push(i[o])}return e}}class $r{constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,i=e.length;n<i;n++){const o=new Co(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=t}getSweepEvents(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const i=this.polys[t].getSweepEvents();for(let o=0,s=i.length;o<s;o++)e.push(i[o])}return e}}class Ot{static factory(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];if(!o.isInResult()||o.ringOut)continue;let s=null,l=o.leftSE,a=o.rightSE;const f=[l],h=l.point,u=[];for(;s=l,l=a,f.push(l),l.point!==h;)for(;;){const p=l.getAvailableLinkedEvents();if(p.length===0){const b=f[0].point,_=f[f.length-1].point;throw new Error(`Unable to complete output ring starting at [${b.x}, ${b.y}]. Last matching segment found ends at [${_.x}, ${_.y}].`)}if(p.length===1){a=p[0].otherSE;break}let c=null;for(let b=0,_=u.length;b<_;b++)if(u[b].point===l.point){c=b;break}if(c!==null){const b=u.splice(c)[0],_=f.splice(b.index);_.unshift(_[0].otherSE),t.push(new Ot(_.reverse()));continue}u.push({index:f.length,point:l.point});const d=l.getLeftmostComparator(s);a=p.sort(d)[0].otherSE;break}t.push(new Ot(f))}return t}constructor(e){this.events=e;for(let t=0,n=e.length;t<n;t++)e[t].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const t=[e];for(let f=1,h=this.events.length-1;f<h;f++){const u=this.events[f].point,p=this.events[f+1].point;yr(u,e,p)!==0&&(t.push(u),e=u)}if(t.length===1)return null;const n=t[0],i=t[1];yr(n,e,i)===0&&t.shift(),t.push(t[0]);const o=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:t.length-1,l=this.isExteriorRing()?t.length:-1,a=[];for(let f=s;f!=l;f+=o)a.push([t[f].x,t[f].y]);return a}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,o=this.events.length;i<o;i++){const s=this.events[i];_e.compare(e,s)>0&&(e=s)}let t=e.segment.prevInResult(),n=t?t.prevInResult():null;for(;;){if(!t)return null;if(!n)return t.ringOut;if(n.ringOut!==t.ringOut)return n.ringOut.enclosingRing()!==t.ringOut?t.ringOut:t.ringOut.enclosingRing();t=n.prevInResult(),n=t?t.prevInResult():null}}}class kr{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let t=0,n=this.interiorRings.length;t<n;t++){const i=this.interiorRings[t].getGeom();i!==null&&e.push(i)}return e}}class jo{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let t=0,n=this.polys.length;t<n;t++){const i=this.polys[t].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];if(!o.poly)if(o.isExteriorRing())t.push(new kr(o));else{const s=o.enclosingRing();s.poly||t.push(new kr(s)),s.poly.addInterior(o)}}return t}}class No{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ge.compare;this.queue=e,this.tree=new dn(t),this.segments=[]}process(e){const t=e.segment,n=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),n;const i=e.isLeft?this.tree.add(t):this.tree.find(t);if(!i)throw new Error(`Unable to find segment #${t.id} [${t.leftSE.point.x}, ${t.leftSE.point.y}] -> [${t.rightSE.point.x}, ${t.rightSE.point.y}] in SweepLine tree.`);let o=i,s=i,l,a;for(;l===void 0;)o=this.tree.prev(o),o===null?l=null:o.key.consumedBy===void 0&&(l=o.key);for(;a===void 0;)s=this.tree.next(s),s===null?a=null:s.key.consumedBy===void 0&&(a=s.key);if(e.isLeft){let f=null;if(l){const u=l.getIntersection(t);if(u!==null&&(t.isAnEndpoint(u)||(f=u),!l.isAnEndpoint(u))){const p=this._splitSafely(l,u);for(let c=0,d=p.length;c<d;c++)n.push(p[c])}}let h=null;if(a){const u=a.getIntersection(t);if(u!==null&&(t.isAnEndpoint(u)||(h=u),!a.isAnEndpoint(u))){const p=this._splitSafely(a,u);for(let c=0,d=p.length;c<d;c++)n.push(p[c])}}if(f!==null||h!==null){let u=null;f===null?u=h:h===null?u=f:u=_e.comparePoints(f,h)<=0?f:h,this.queue.remove(t.rightSE),n.push(t.rightSE);const p=t.split(u);for(let c=0,d=p.length;c<d;c++)n.push(p[c])}n.length>0?(this.tree.remove(t),n.push(e)):(this.segments.push(t),t.prev=l)}else{if(l&&a){const f=l.getIntersection(a);if(f!==null){if(!l.isAnEndpoint(f)){const h=this._splitSafely(l,f);for(let u=0,p=h.length;u<p;u++)n.push(h[u])}if(!a.isAnEndpoint(f)){const h=this._splitSafely(a,f);for(let u=0,p=h.length;u<p;u++)n.push(h[u])}}}this.tree.remove(t)}return n}_splitSafely(e,t){this.tree.remove(e);const n=e.rightSE;this.queue.remove(n);const i=e.split(t);return i.push(n),e.consumedBy===void 0&&this.tree.add(e),i}}const Er=typeof process<"u"&&Vr.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Oo=typeof process<"u"&&Vr.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Do{run(e,t,n){ke.type=e,ct.reset();const i=[new $r(t,!0)];for(let u=0,p=n.length;u<p;u++)i.push(new $r(n[u],!1));if(ke.numMultiPolys=i.length,ke.type==="difference"){const u=i[0];let p=1;for(;p<i.length;)an(i[p].bbox,u.bbox)!==null?p++:i.splice(p,1)}if(ke.type==="intersection")for(let u=0,p=i.length;u<p;u++){const c=i[u];for(let d=u+1,b=i.length;d<b;d++)if(an(c.bbox,i[d].bbox)===null)return[]}const o=new dn(_e.compare);for(let u=0,p=i.length;u<p;u++){const c=i[u].getSweepEvents();for(let d=0,b=c.length;d<b;d++)if(o.insert(c[d]),o.size>Er)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const s=new No(o);let l=o.size,a=o.pop();for(;a;){const u=a.key;if(o.size===l){const c=u.segment;throw new Error(`Unable to pop() ${u.isLeft?"left":"right"} SweepEvent [${u.point.x}, ${u.point.y}] from segment #${c.id} [${c.leftSE.point.x}, ${c.leftSE.point.y}] -> [${c.rightSE.point.x}, ${c.rightSE.point.y}] from queue.`)}if(o.size>Er)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(s.segments.length>Oo)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const p=s.process(u);for(let c=0,d=p.length;c<d;c++){const b=p[c];b.consumedBy===void 0&&o.insert(b)}l=o.size,a=o.pop()}ct.reset();const f=Ot.factory(s.segments);return new jo(f).getGeom()}}const ke=new Do,To=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return ke.run("union",r,t)},zo=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return ke.run("intersection",r,t)},Bo=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return ke.run("xor",r,t)},Fo=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return ke.run("difference",r,t)};var Go={union:To,intersection:zo,xor:Bo,difference:Fo},Uo=Object.defineProperty,qo=(r,e)=>Uo(r,"name",{value:e,configurable:!0});function Yr(r,e={}){const t=[];if(Oi(r,i=>{t.push(i.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const n=Go.intersection(t[0],...t.slice(1));return n.length===0?null:n.length===1?Gr(n[0],e.properties):Di(n,e.properties)}qo(Yr,"intersect");var Wo=Yr;let un={type:"FeatureCollection",features:[]};async function Zo(){let e=await(await fetch(ho)).json();for(let t of e.features)t.geometry.type=="MultiPolygon"&&(t.geometry.type="Polygon",t.geometry.coordinates=t.geometry.coordinates[0]);un=e}function Ko(r){let e=r.getBounds(),t=Gr([[e.getNorthEast().toArray(),e.getNorthWest().toArray(),e.getSouthWest().toArray(),e.getSouthEast().toArray(),e.getNorthEast().toArray()]]),n=Qn(t),i=0,o=un.features[0];for(let s of un.features){let l=Wo(Ti([t,s]));if(!l)continue;let a=Qn(l)/n;a>i&&(i=a,o=s)}return o}let Jr=We(null),R;const Qr=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Qr.decode();let st=null;function ut(){return(st===null||st.byteLength===0)&&(st=new Uint8Array(R.memory.buffer)),st}function Ee(r,e){return r=r>>>0,Qr.decode(ut().subarray(r,r+e))}const Ce=new Array(128).fill(void 0);Ce.push(void 0,null,!0,!1);let ft=Ce.length;function ee(r){ft===Ce.length&&Ce.push(Ce.length+1);const e=ft;return ft=Ce[e],Ce[e]=r,e}function O(r){return Ce[r]}function Vo(r){r<132||(Ce[r]=ft,ft=r)}function $t(r){const e=O(r);return Vo(r),e}function Yt(r){return r==null}let lt=null;function Ho(){return(lt===null||lt.byteLength===0)&&(lt=new Float64Array(R.memory.buffer)),lt}let at=null;function B(){return(at===null||at.byteLength===0)&&(at=new Int32Array(R.memory.buffer)),at}let Fe=0;const kt=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Yo=typeof kt.encodeInto=="function"?function(r,e){return kt.encodeInto(r,e)}:function(r,e){const t=kt.encode(r);return e.set(t),{read:r.length,written:t.length}};function _t(r,e,t){if(t===void 0){const l=kt.encode(r),a=e(l.length,1)>>>0;return ut().subarray(a,a+l.length).set(l),Fe=l.length,a}let n=r.length,i=e(n,1)>>>0;const o=ut();let s=0;for(;s<n;s++){const l=r.charCodeAt(s);if(l>127)break;o[i+s]=l}if(s!==n){s!==0&&(r=r.slice(s)),i=t(i,n,n=s+r.length*3,1)>>>0;const l=ut().subarray(i+s,i+n),a=Yo(r,l);s+=a.written}return Fe=s,i}function fn(r){const e=typeof r;if(e=="number"||e=="boolean"||r==null)return`${r}`;if(e=="string")return`"${r}"`;if(e=="symbol"){const i=r.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=r.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(r)){const i=r.length;let o="[";i>0&&(o+=fn(r[0]));for(let s=1;s<i;s++)o+=", "+fn(r[s]);return o+="]",o}const t=/\[object ([^\]]+)\]/.exec(toString.call(r));let n;if(t.length>1)n=t[1];else return toString.call(r);if(n=="Object")try{return"Object("+JSON.stringify(r)+")"}catch{return"Object"}return r instanceof Error?`${r.name}: ${r.message}
${r.stack}`:n}function Jo(r,e){const t=e(r.length*1,1)>>>0;return ut().set(r,t/1),Fe=r.length,t}function Jt(r,e){try{return r.apply(this,e)}catch(t){R.__wbindgen_exn_store(ee(t))}}class Dt{static __wrap(e){e=e>>>0;const t=Object.create(Dt.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();R.__wbg_jsroutesnapper_free(e)}constructor(e){try{const o=R.__wbindgen_add_to_stack_pointer(-16),s=Jo(e,R.__wbindgen_malloc),l=Fe;R.jsroutesnapper_new(o,s,l);var t=B()[o/4+0],n=B()[o/4+1],i=B()[o/4+2];if(i)throw $t(n);return Dt.__wrap(t)}finally{R.__wbindgen_add_to_stack_pointer(16)}}setRouteConfig(e){R.jsroutesnapper_setRouteConfig(this.__wbg_ptr,ee(e))}setAreaMode(){R.jsroutesnapper_setAreaMode(this.__wbg_ptr)}getConfig(){let e,t;try{const o=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_getConfig(o,this.__wbg_ptr);var n=B()[o/4+0],i=B()[o/4+1];return e=n,t=i,Ee(n,i)}finally{R.__wbindgen_add_to_stack_pointer(16),R.__wbindgen_free(e,t,1)}}toFinalFeature(){try{const n=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_toFinalFeature(n,this.__wbg_ptr);var e=B()[n/4+0],t=B()[n/4+1];let i;return e!==0&&(i=Ee(e,t).slice(),R.__wbindgen_free(e,t*1)),i}finally{R.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){let e,t;try{const o=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_renderGeojson(o,this.__wbg_ptr);var n=B()[o/4+0],i=B()[o/4+1];return e=n,t=i,Ee(n,i)}finally{R.__wbindgen_add_to_stack_pointer(16),R.__wbindgen_free(e,t,1)}}toggleSnapMode(){R.jsroutesnapper_toggleSnapMode(this.__wbg_ptr)}onMouseMove(e,t,n){return R.jsroutesnapper_onMouseMove(this.__wbg_ptr,e,t,n)!==0}onClick(){R.jsroutesnapper_onClick(this.__wbg_ptr)}onDragStart(){return R.jsroutesnapper_onDragStart(this.__wbg_ptr)!==0}onMouseUp(){return R.jsroutesnapper_onMouseUp(this.__wbg_ptr)!==0}clearState(){R.jsroutesnapper_clearState(this.__wbg_ptr)}editExisting(e){try{const i=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_editExisting(i,this.__wbg_ptr,ee(e));var t=B()[i/4+0],n=B()[i/4+1];if(n)throw $t(t)}finally{R.__wbindgen_add_to_stack_pointer(16)}}debugRenderGraph(){let e,t;try{const o=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_debugRenderGraph(o,this.__wbg_ptr);var n=B()[o/4+0],i=B()[o/4+1];return e=n,t=i,Ee(n,i)}finally{R.__wbindgen_add_to_stack_pointer(16),R.__wbindgen_free(e,t,1)}}debugSnappableNodes(){let e,t;try{const o=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_debugSnappableNodes(o,this.__wbg_ptr);var n=B()[o/4+0],i=B()[o/4+1];return e=n,t=i,Ee(n,i)}finally{R.__wbindgen_add_to_stack_pointer(16),R.__wbindgen_free(e,t,1)}}routeNameForWaypoints(e){let t,n;try{const h=R.__wbindgen_add_to_stack_pointer(-16);R.jsroutesnapper_routeNameForWaypoints(h,this.__wbg_ptr,ee(e));var i=B()[h/4+0],o=B()[h/4+1],s=B()[h/4+2],l=B()[h/4+3],a=i,f=o;if(l)throw a=0,f=0,$t(s);return t=a,n=f,Ee(a,f)}finally{R.__wbindgen_add_to_stack_pointer(16),R.__wbindgen_free(t,n,1)}}addSnappedWaypoint(e,t){R.jsroutesnapper_addSnappedWaypoint(this.__wbg_ptr,e,t)}undo(){R.jsroutesnapper_undo(this.__wbg_ptr)}}async function Qo(r,e){if(typeof Response=="function"&&r instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(r,e)}catch(n){if(r.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const t=await r.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(r,e);return t instanceof WebAssembly.Instance?{instance:t,module:r}:t}}function Xo(){const r={};return r.wbg={},r.wbg.__wbindgen_string_new=function(e,t){const n=Ee(e,t);return ee(n)},r.wbg.__wbindgen_object_drop_ref=function(e){$t(e)},r.wbg.__wbindgen_error_new=function(e,t){const n=new Error(Ee(e,t));return ee(n)},r.wbg.__wbindgen_is_object=function(e){const t=O(e);return typeof t=="object"&&t!==null},r.wbg.__wbindgen_is_undefined=function(e){return O(e)===void 0},r.wbg.__wbindgen_in=function(e,t){return O(e)in O(t)},r.wbg.__wbindgen_number_get=function(e,t){const n=O(t),i=typeof n=="number"?n:void 0;Ho()[e/8+1]=Yt(i)?0:i,B()[e/4+0]=!Yt(i)},r.wbg.__wbindgen_boolean_get=function(e){const t=O(e);return typeof t=="boolean"?t?1:0:2},r.wbg.__wbindgen_jsval_loose_eq=function(e,t){return O(e)==O(t)},r.wbg.__wbindgen_string_get=function(e,t){const n=O(t),i=typeof n=="string"?n:void 0;var o=Yt(i)?0:_t(i,R.__wbindgen_malloc,R.__wbindgen_realloc),s=Fe;B()[e/4+1]=s,B()[e/4+0]=o},r.wbg.__wbg_getwithrefkey_d1f0d12f1f1b63ea=function(e,t){const n=O(e)[O(t)];return ee(n)},r.wbg.__wbindgen_object_clone_ref=function(e){const t=O(e);return ee(t)},r.wbg.__wbg_String_4370c5505c674d30=function(e,t){const n=String(O(t)),i=_t(n,R.__wbindgen_malloc,R.__wbindgen_realloc),o=Fe;B()[e/4+1]=o,B()[e/4+0]=i},r.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return ee(e)},r.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=O(t).stack,i=_t(n,R.__wbindgen_malloc,R.__wbindgen_realloc),o=Fe;B()[e/4+1]=o,B()[e/4+0]=i},r.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,i;try{n=e,i=t,console.error(Ee(e,t))}finally{R.__wbindgen_free(n,i,1)}},r.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(O(e))},r.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(O(e))},r.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(O(e))},r.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(O(e))},r.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(O(e))},r.wbg.__wbg_get_44be0491f933a435=function(e,t){const n=O(e)[t>>>0];return ee(n)},r.wbg.__wbg_length_fff51ee6522a1a18=function(e){return O(e).length},r.wbg.__wbindgen_is_function=function(e){return typeof O(e)=="function"},r.wbg.__wbg_next_526fc47e980da008=function(e){const t=O(e).next;return ee(t)},r.wbg.__wbg_next_ddb3312ca1c4e32a=function(){return Jt(function(e){const t=O(e).next();return ee(t)},arguments)},r.wbg.__wbg_done_5c1f01fb660d73b5=function(e){return O(e).done},r.wbg.__wbg_value_1695675138684bd5=function(e){const t=O(e).value;return ee(t)},r.wbg.__wbg_iterator_97f0c81209c6c35a=function(){return ee(Symbol.iterator)},r.wbg.__wbg_get_97b561fb56f034b5=function(){return Jt(function(e,t){const n=Reflect.get(O(e),O(t));return ee(n)},arguments)},r.wbg.__wbg_call_cb65541d95d71282=function(){return Jt(function(e,t){const n=O(e).call(O(t));return ee(n)},arguments)},r.wbg.__wbg_isArray_4c24b343cb13cfb1=function(e){return Array.isArray(O(e))},r.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb=function(e){let t;try{t=O(e)instanceof ArrayBuffer}catch{t=!1}return t},r.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=O(e).buffer;return ee(t)},r.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(O(e));return ee(t)},r.wbg.__wbg_set_5cf90238115182c3=function(e,t,n){O(e).set(O(t),n>>>0)},r.wbg.__wbg_length_72e2208bbc0efc61=function(e){return O(e).length},r.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4=function(e){let t;try{t=O(e)instanceof Uint8Array}catch{t=!1}return t},r.wbg.__wbindgen_debug_string=function(e,t){const n=fn(O(t)),i=_t(n,R.__wbindgen_malloc,R.__wbindgen_realloc),o=Fe;B()[e/4+1]=o,B()[e/4+0]=i},r.wbg.__wbindgen_throw=function(e,t){throw new Error(Ee(e,t))},r.wbg.__wbindgen_memory=function(){const e=R.memory;return ee(e)},r}function es(r,e){return R=r.exports,Xr.__wbindgen_wasm_module=e,lt=null,at=null,st=null,R}async function Xr(r){if(R!==void 0)return R;typeof r>"u"&&(r="/inspectorate_tools/sketch_routes/assets/route_snapper_bg.wasm");const e=Xo();(typeof r=="string"||typeof Request=="function"&&r instanceof Request||typeof URL=="function"&&r instanceof URL)&&(r=fetch(r));const{instance:t,module:n}=await Qo(await r,e);return es(t,n)}const ts=30;class ns{constructor(e,t,n,i,o){this.onMouseMove=s=>{if(!this.active)return;const l=[s.point.x-ts,s.point.y],a=this.map.unproject(s.point).distanceTo(this.map.unproject(l));this.inner.onMouseMove(s.lngLat.lng,s.lngLat.lat,a)&&(this.redraw(),this.dataUpdated())},this.onClick=()=>{this.active&&(this.inner.onClick(),this.redraw(),this.dataUpdated())},this.onDoubleClick=s=>{this.active&&(s.preventDefault(),this.inner.onClick(),this.finish())},this.onDragStart=()=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()},this.onMouseUp=()=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()},this.onKeyDown=s=>{this.active&&s.key=="Escape"&&(s.stopPropagation(),this.cancel())},this.onKeyPress=s=>{this.active&&s.target.tagName!="INPUT"&&(s.key=="Enter"?(s.stopPropagation(),this.finish()):s.key=="s"||s.key=="S"?(s.stopPropagation(),this.inner.toggleSnapMode(),this.redraw()):s.key=="z"&&s.ctrlKey&&this.undo())},this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new Dt(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.routeToolGj=n,this.snapMode=i,this.undoLength=o,this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("dragstart",this.onDragStart),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keypress",this.onKeyPress)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("dragstart",this.onDragStart),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keypress",this.onKeyPress)}startRoute(){this.active||(this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}startArea(){this.active||(this.inner.setAreaMode(),this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}stop(){this.active=!1,this.inner.clearState(),this.redraw(),this.map.boxZoom.enable(),this.map.doubleClickZoom.enable()}editExistingRoute(e){this.active&&window.alert("Bug: editExistingRoute called when tool is already active"),e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.startRoute(),this.inner.editExisting(e.properties.waypoints),this.redraw()}editExistingArea(e){this.active&&window.alert("Bug: editExistingArea called when tool is already active"),e.properties.waypoints||window.alert("Bug: editExistingArea called for a polygon not produced by the route-snapper"),this.startArea(),this.inner.editExisting(e.properties.waypoints),this.redraw()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}isActive(){return this.active}finish(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersSuccess)t(JSON.parse(e));else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){this.inner.clearState(),this.finish()}setRouteConfig(e){this.inner.setRouteConfig(e),this.redraw()}addSnappedWaypoint(e){this.inner.addSnappedWaypoint(e[0],e[1]),this.redraw()}undo(){this.inner.undo(),this.redraw()}toggleSnapMode(){this.inner.toggleSnapMode(),this.redraw()}redraw(){let e=JSON.parse(this.inner.renderGeojson());this.routeToolGj.set(e),this.map.getCanvas().style.cursor=e.cursor,this.snapMode.set(e.snap_mode),this.undoLength.set(e.undo_length)}dataUpdated(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersUpdated)t(JSON.parse(e))}}function rs(r){return r=="google"||r=="bing"}const Tt=We(null),cn=We(is());cn.subscribe(r=>window.localStorage.setItem("userSettings",JSON.stringify(r)));function is(){let r={streetViewImagery:"google",avoidDoublingBack:!1};try{let e=JSON.parse(window.localStorage.getItem("userSettings")||"{}");rs(e.streetViewImagery)&&(r.streetViewImagery=e.streetViewImagery),typeof e.avoidDoublingBack=="boolean"&&(r.avoidDoublingBack=e.avoidDoublingBack)}catch(e){console.log(`Couldn't parse userSettings from local storage: ${e}`)}return r}function He(r,e){return{id:e,beforeId:os(r,e)}}function os(r,e){let t=vi(Jr);if(!t){console.warn(`getBeforeId(${e}) called before map is ready. Z-ordering may be incorrect.`);return}let n,i=!1;for(let o=r.layerZorder.length-1;o>=0;o--){let s=r.layerZorder[o];if(s==e){i=!0;break}t.getLayer(s)&&(n=s)}if(!i)throw new Error(`Layer ID ${e} not defined in layerZorder`);return n}const ss=["==",["geometry-type"],"Polygon"],ls=["==",["geometry-type"],"LineString"],as=["==",["geometry-type"],"Point"];function mn(){return{type:"FeatureCollection",features:[]}}function yt(r,e,t){let n=["match",r];for(let[i,o]of Object.entries(e))n.push(i),n.push(o);return n.push(t),n}const ei=We(mn()),Et=We(mn()),ti=We(!0),ni=We(0);function Sr(r,e,t){const n=r.slice();return n[9]=e[t],n}function xr(r){let e,t,n=r[9].place_name+"",i,o,s;function l(...a){return r[5](r[9],...a)}return{c(){e=U("li"),t=U("a"),i=Y(n),this.h()},l(a){e=q(a,"LI",{});var f=oe(e);t=q(f,"A",{href:!0});var h=oe(t);i=J(h,n),h.forEach($),f.forEach($),this.h()},h(){ye(t,"href","#")},m(a,f){M(a,e,f),T(e,t),T(t,i),o||(s=ki(t,"click",l),o=!0)},p(a,f){r=a,f&2&&n!==(n=r[9].place_name+"")&&Je(i,n)},d(a){a&&$(e),o=!1,s()}}}function us(r){let e,t,n,i,o;function s(h){r[4](h)}let l={label:"Add waypoint by search"};r[0]!==void 0&&(l.value=r[0]),e=new wt({props:l}),Z.push(()=>V(e,"value",s));let a=xt(r[1].features),f=[];for(let h=0;h<a.length;h+=1)f[h]=xr(Sr(r,a,h));return{c(){P(e.$$.fragment),n=j(),i=U("ol");for(let h=0;h<f.length;h+=1)f[h].c();this.h()},l(h){A(e.$$.fragment,h),n=N(h),i=q(h,"OL",{class:!0});var u=oe(i);for(let p=0;p<f.length;p+=1)f[p].l(u);u.forEach($),this.h()},h(){ye(i,"class","govuk-list govuk-list--number")},m(h,u){I(e,h,u),M(h,n,u),M(h,i,u);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(i,null);o=!0},p(h,[u]){const p={};if(!t&&u&1&&(t=!0,p.value=h[0],K(()=>t=!1)),e.$set(p),u&6){a=xt(h[1].features);let c;for(c=0;c<a.length;c+=1){const d=Sr(h,a,c);f[c]?f[c].p(d,u):(f[c]=xr(d),f[c].c(),f[c].m(i,null))}for(;c<f.length;c+=1)f[c].d(1);f.length=a.length}},i(h){o||(k(e.$$.fragment,h),o=!0)},o(h){S(e.$$.fragment,h),o=!1},d(h){h&&($(n),$(i)),C(e,h),$i(f,h)}}}function fs(r,e,t){let n,i,o;ae(r,Tt,p=>t(6,n=p)),ae(r,Et,p=>t(1,i=p)),ae(r,Jr,p=>t(7,o=p));let{maptilerApiKey:s}=e,l="";async function a(p){if(!p){Hn(Et,i=mn(),i);return}let c=new URLSearchParams({country:"gb",proximity:o.getCenter().toArray().join(","),fuzzyMatch:"true",key:s}).toString(),d=`https://api.maptiler.com/geocoding/${p}.json?${c}`,_=await(await fetch(d)).json(),g=1;for(let v of _.features)v.properties.number=g++;Hn(Et,i=_,i)}function f(p,c){p.preventDefault(),n.addSnappedWaypoint(c),t(0,l="")}function h(p){l=p,t(0,l)}const u=(p,c)=>f(c,p.center);return r.$$set=p=>{"maptilerApiKey"in p&&t(3,s=p.maptilerApiKey)},r.$$.update=()=>{r.$$.dirty&1&&a(l)},[l,i,f,s,h,u]}class cs extends Ne{constructor(e){super(),Oe(this,e,fs,us,Ae,{maptilerApiKey:3})}}function hs(r){let e,t,n;return{c(){e=Y("Undo ("),t=Y(r[3]),n=Y(")")},l(i){e=J(i,"Undo ("),t=J(i,r[3]),n=J(i,")")},m(i,o){M(i,e,o),M(i,t,o),M(i,n,o)},p(i,o){o&8&&Je(t,i[3])},d(i){i&&($(e),$(t),$(n))}}}function ps(r){let e;return{c(){e=Y("Undo")},l(t){e=J(t,"Undo")},m(t,n){M(t,e,n)},p:Se,d(t){t&&$(e)}}}function gs(r){let e;function t(o,s){return o[3]==0?ps:hs}let n=t(r),i=n(r);return{c(){i.c(),e=ue()},l(o){i.l(o),e=ue()},m(o,s){i.m(o,s),M(o,e,s)},p(o,s){n===(n=t(o))&&i?i.p(o,s):(i.d(1),i=n(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&$(e),i.d(o)}}}function ds(r){let e,t=`Drawing points anywhere. Press <b>s</b>
    or click below to snap to roads`,n,i,o;return i=new Ye({props:{$$slots:{default:[_s]},$$scope:{ctx:r}}}),i.$on("click",r[6]),{c(){e=U("p"),e.innerHTML=t,n=j(),P(i.$$.fragment),this.h()},l(s){e=q(s,"P",{style:!0,"data-svelte-h":!0}),ht(e)!=="svelte-5jas5a"&&(e.innerHTML=t),n=N(s),A(i.$$.fragment,s),this.h()},h(){ie(e,"background","blue"),ie(e,"color","white"),ie(e,"padding","8px")},m(s,l){M(s,e,l),M(s,n,l),I(i,s,l),o=!0},p(s,l){const a={};l&1024&&(a.$$scope={dirty:l,ctx:s}),i.$set(a)},i(s){o||(k(i.$$.fragment,s),o=!0)},o(s){S(i.$$.fragment,s),o=!1},d(s){s&&($(e),$(n)),C(i,s)}}}function ms(r){let e,t=`Snapping to existing roads. Press <b>s</b>
    or click below to draw anywhere`,n,i,o;return i=new Ye({props:{$$slots:{default:[ys]},$$scope:{ctx:r}}}),i.$on("click",r[6]),{c(){e=U("p"),e.innerHTML=t,n=j(),P(i.$$.fragment),this.h()},l(s){e=q(s,"P",{style:!0,"data-svelte-h":!0}),ht(e)!=="svelte-wz2am1"&&(e.innerHTML=t),n=N(s),A(i.$$.fragment,s),this.h()},h(){ie(e,"background","red"),ie(e,"color","white"),ie(e,"padding","8px")},m(s,l){M(s,e,l),M(s,n,l),I(i,s,l),o=!0},p(s,l){const a={};l&1024&&(a.$$scope={dirty:l,ctx:s}),i.$set(a)},i(s){o||(k(i.$$.fragment,s),o=!0)},o(s){S(i.$$.fragment,s),o=!1},d(s){s&&($(e),$(n)),C(i,s)}}}function _s(r){let e;return{c(){e=Y("Snap to roads")},l(t){e=J(t,"Snap to roads")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function ys(r){let e;return{c(){e=Y("Draw anywhere")},l(t){e=J(t,"Draw anywhere")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function bs(r){let e;return{c(){e=Y("Add points to end")},l(t){e=J(t,"Add points to end")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function ws(r){let e;return{c(){e=Y("Avoid doubling back")},l(t){e=J(t,"Avoid doubling back")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function vs(r){let e,t,n,i,o,s;function l(u){r[8](u)}let a={hint:"Keep clicking to add more points to the end of the route",$$slots:{default:[bs]},$$scope:{ctx:r}};r[0]!==void 0&&(a.checked=r[0]),e=new Xn({props:a}),Z.push(()=>V(e,"checked",l));function f(u){r[9](u)}let h={hint:"Try to make the route avoid using the same streets with multiple waypoints",$$slots:{default:[ws]},$$scope:{ctx:r}};return r[2].avoidDoublingBack!==void 0&&(h.checked=r[2].avoidDoublingBack),i=new Xn({props:h}),Z.push(()=>V(i,"checked",f)),{c(){P(e.$$.fragment),n=j(),P(i.$$.fragment)},l(u){A(e.$$.fragment,u),n=N(u),A(i.$$.fragment,u)},m(u,p){I(e,u,p),M(u,n,p),I(i,u,p),s=!0},p(u,p){const c={};p&1024&&(c.$$scope={dirty:p,ctx:u}),!t&&p&1&&(t=!0,c.checked=u[0],K(()=>t=!1)),e.$set(c);const d={};p&1024&&(d.$$scope={dirty:p,ctx:u}),!o&&p&4&&(o=!0,d.checked=u[2].avoidDoublingBack,K(()=>o=!1)),i.$set(d)},i(u){s||(k(e.$$.fragment,u),k(i.$$.fragment,u),s=!0)},o(u){S(e.$$.fragment,u),S(i.$$.fragment,u),s=!1},d(u){u&&$(n),C(e,u),C(i,u)}}}function Rr(r){let e,t;return e=new cs({props:{maptilerApiKey:r[1]}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.maptilerApiKey=n[1]),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function $s(r){let e,t,n,i,o,s,l=`<li><b>Click</b>
    the map to add points</li> <li>Press <b>s</b>
    to switch between snapping points to existing roads and drawing anywhere</li> <li><b>Click and drag</b>
    any point to move it</li> <li><b>Click</b>
    a waypoint to delete it</li> <li>Press <b>Control+Z</b>
    to undo your last change</li> <li>Press <b>Enter</b>
    or
    <b>double click</b>
    to finish</li> <li>Press <b>Escape</b>
    to cancel</li>`,a,f,h,u,p;e=new Ye({props:{disabled:r[3]==0,$$slots:{default:[gs]},$$scope:{ctx:r}}}),e.$on("click",r[5]);const c=[ms,ds],d=[];function b(g,v){return g[4]?0:1}n=b(r),i=d[n]=c[n](r),f=new Hi({props:{small:!0,$$slots:{default:[vs]},$$scope:{ctx:r}}});let _=r[1]&&Rr(r);return{c(){P(e.$$.fragment),t=j(),i.c(),o=j(),s=U("ul"),s.innerHTML=l,a=j(),P(f.$$.fragment),h=j(),_&&_.c(),u=ue()},l(g){A(e.$$.fragment,g),t=N(g),i.l(g),o=N(g),s=q(g,"UL",{"data-svelte-h":!0}),ht(s)!=="svelte-9zh06q"&&(s.innerHTML=l),a=N(g),A(f.$$.fragment,g),h=N(g),_&&_.l(g),u=ue()},m(g,v){I(e,g,v),M(g,t,v),d[n].m(g,v),M(g,o,v),M(g,s,v),M(g,a,v),I(f,g,v),M(g,h,v),_&&_.m(g,v),M(g,u,v),p=!0},p(g,[v]){const y={};v&8&&(y.disabled=g[3]==0),v&1032&&(y.$$scope={dirty:v,ctx:g}),e.$set(y);let E=n;n=b(g),n===E?d[n].p(g,v):(xe(),S(d[E],1,1,()=>{d[E]=null}),Re(),i=d[n],i?i.p(g,v):(i=d[n]=c[n](g),i.c()),k(i,1),i.m(o.parentNode,o));const D={};v&1029&&(D.$$scope={dirty:v,ctx:g}),f.$set(D),g[1]?_?(_.p(g,v),v&2&&k(_,1)):(_=Rr(g),_.c(),k(_,1),_.m(u.parentNode,u)):_&&(xe(),S(_,1,1,()=>{_=null}),Re())},i(g){p||(k(e.$$.fragment,g),k(i),k(f.$$.fragment,g),k(_),p=!0)},o(g){S(e.$$.fragment,g),S(i),S(f.$$.fragment,g),S(_),p=!1},d(g){g&&($(t),$(o),$(s),$(a),$(h),$(u)),C(e,g),d[n].d(g),C(f,g),_&&_.d(g)}}}function ks(r,e,t){let n,i,o,s;ae(r,Tt,c=>t(7,n=c)),ae(r,cn,c=>t(2,i=c)),ae(r,ni,c=>t(3,o=c)),ae(r,ti,c=>t(4,s=c));let{maptilerApiKey:l}=e,{extendRoute:a}=e;function f(){n.undo()}function h(){n.toggleSnapMode()}function u(c){a=c,t(0,a)}function p(c){r.$$.not_equal(i.avoidDoublingBack,c)&&(i.avoidDoublingBack=c,cn.set(i))}return r.$$set=c=>{"maptilerApiKey"in c&&t(1,l=c.maptilerApiKey),"extendRoute"in c&&t(0,a=c.extendRoute)},r.$$.update=()=>{r.$$.dirty&133&&n.setRouteConfig({avoid_doubling_back:i.avoidDoublingBack,extend_route:a})},[a,l,i,o,s,f,h,n,u,p]}class Es extends Ne{constructor(e){super(),Oe(this,e,ks,$s,Ae,{maptilerApiKey:1,extendRoute:0})}}function Ss(r){let e,t,n,i,o,s;const l=[He(r[0],"route-points"),{filter:as},{paint:{"circle-color":yt(["get","type"],{"snapped-waypoint":"red","free-waypoint":"blue"},"black"),"circle-opacity":["case",["has","hovered"],.5,1],"circle-radius":yt(["get","type"],{node:bt/2},bt)}}];let a={};for(let c=0;c<l.length;c+=1)a=Ut(a,l[c]);e=new zi({props:a});const f=[He(r[0],"route-lines"),{filter:ls},{paint:{"line-color":["case",["get","snapped"],"red","blue"],"line-width":2.5}}];let h={};for(let c=0;c<f.length;c+=1)h=Ut(h,f[c]);n=new hn({props:h});const u=[He(r[0],"route-polygons"),{filter:ss},{paint:{"fill-color":"black","fill-opacity":.5}}];let p={};for(let c=0;c<u.length;c+=1)p=Ut(p,u[c]);return o=new Fr({props:p}),{c(){P(e.$$.fragment),t=j(),P(n.$$.fragment),i=j(),P(o.$$.fragment)},l(c){A(e.$$.fragment,c),t=N(c),A(n.$$.fragment,c),i=N(c),A(o.$$.fragment,c)},m(c,d){I(e,c,d),M(c,t,d),I(n,c,d),M(c,i,d),I(o,c,d),s=!0},p(c,d){const b=d&1?Wt(l,[d&1&&Zt(He(c[0],"route-points")),l[1],d&0&&{paint:{"circle-color":yt(["get","type"],{"snapped-waypoint":"red","free-waypoint":"blue"},"black"),"circle-opacity":["case",["has","hovered"],.5,1],"circle-radius":yt(["get","type"],{node:bt/2},bt)}}]):{};e.$set(b);const _=d&1?Wt(f,[Zt(He(c[0],"route-lines")),f[1],f[2]]):{};n.$set(_);const g=d&1?Wt(u,[Zt(He(c[0],"route-polygons")),u[1],u[2]]):{};o.$set(g)},i(c){s||(k(e.$$.fragment,c),k(n.$$.fragment,c),k(o.$$.fragment,c),s=!0)},o(c){S(e.$$.fragment,c),S(n.$$.fragment,c),S(o.$$.fragment,c),s=!1},d(c){c&&($(t),$(i)),C(e,c),C(n,c),C(o,c)}}}function xs(r){let e,t=Mr(r[3])+"",n;return{c(){e=U("div"),n=Y(t),this.h()},l(i){e=q(i,"DIV",{style:!0});var o=oe(e);n=J(o,t),o.forEach($),this.h()},h(){ie(e,"font-size","30px"),ie(e,"background","white"),ie(e,"padding","16px"),ie(e,"border-radius","50%")},m(i,o){M(i,e,o),T(e,n)},p(i,o){o&8&&t!==(t=Mr(i[3])+"")&&Je(n,t)},d(i){i&&$(e)}}}function Rs(r){let e,t;return e=new co({props:{$$slots:{default:[xs,({feature:n})=>({3:n}),({feature:n})=>n?8:0]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p(n,i){const o={};i&24&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Ms(r){let e,t,n,i;return e=new St({props:{data:r[1],$$slots:{default:[Ss]},$$scope:{ctx:r}}}),n=new St({props:{data:r[2],$$slots:{default:[Rs]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment),t=j(),P(n.$$.fragment)},l(o){A(e.$$.fragment,o),t=N(o),A(n.$$.fragment,o)},m(o,s){I(e,o,s),M(o,t,s),I(n,o,s),i=!0},p(o,[s]){const l={};s&2&&(l.data=o[1]),s&17&&(l.$$scope={dirty:s,ctx:o}),e.$set(l);const a={};s&4&&(a.data=o[2]),s&16&&(a.$$scope={dirty:s,ctx:o}),n.$set(a)},i(o){i||(k(e.$$.fragment,o),k(n.$$.fragment,o),i=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),i=!1},d(o){o&&$(t),C(e,o),C(n,o)}}}const bt=10;function Mr(r){var e;return(e=r.properties)==null?void 0:e.number}function Ls(r,e,t){let n,i;ae(r,ei,s=>t(1,n=s)),ae(r,Et,s=>t(2,i=s));let{cfg:o}=e;return r.$$set=s=>{"cfg"in s&&t(0,o=s.cfg)},[o,n,i]}class Ps extends Ne{constructor(e){super(),Oe(this,e,Ls,Ms,Ae,{cfg:0})}}async function As(r,e){let t=await fetch(r),n=t.body.getReader(),i=t.headers.get("Content-Length");if(!i)throw new Error(`No Content-Length header from ${r}`);let o=parseInt(i),s=0,l=[];for(;;){let{done:h,value:u}=await n.read();if(h)break;u&&(l.push(u),s+=u.length,e(100*s/o))}let a=new Uint8Array(s),f=0;for(let h of l)a.set(h,f),f+=h.length;return a}function Is(r){let e,t;return e=new Wi({props:{errorMessage:"Failed to load route snapper"}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p:Se,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Cs(r){let e,t="Route data unpacking",n,i;return{c(){e=U("label"),e.textContent=t,n=j(),i=U("progress"),this.h()},l(o){e=q(o,"LABEL",{for:!0,"data-svelte-h":!0}),ht(e)!=="svelte-y5hdhj"&&(e.textContent=t),n=N(o),i=q(o,"PROGRESS",{id:!0,class:!0}),oe(i).forEach($),this.h()},h(){ye(e,"for","route-unpacking"),ye(i,"id","route-unpacking"),ye(i,"class","svelte-q3473n")},m(o,s){M(o,e,s),M(o,n,s),M(o,i,s)},p:Se,i:Se,o:Se,d(o){o&&($(e),$(n),$(i))}}}function js(r){let e,t="Route tool loading",n,i;return{c(){e=U("label"),e.textContent=t,n=j(),i=U("progress"),this.h()},l(o){e=q(o,"LABEL",{for:!0,"data-svelte-h":!0}),ht(e)!=="svelte-1wgeuhh"&&(e.textContent=t),n=N(o),i=q(o,"PROGRESS",{id:!0,class:!0}),oe(i).forEach($),this.h()},h(){ye(e,"for","route-loading"),ye(i,"id","route-loading"),i.value=r[0],ye(i,"class","svelte-q3473n")},m(o,s){M(o,e,s),M(o,n,s),M(o,i,s)},p(o,s){s&1&&(i.value=o[0])},i:Se,o:Se,d(o){o&&($(e),$(n),$(i))}}}function Ns(r){let e,t,n,i;const o=[js,Cs,Is],s=[];function l(a,f){return!a[1]&&!a[2]&&!a[3]?0:a[3]&&!a[1]&&!a[2]?1:a[2]?2:-1}return~(e=l(r))&&(t=s[e]=o[e](r)),{c(){t&&t.c(),n=ue()},l(a){t&&t.l(a),n=ue()},m(a,f){~e&&s[e].m(a,f),M(a,n,f),i=!0},p(a,[f]){let h=e;e=l(a),e===h?~e&&s[e].p(a,f):(t&&(xe(),S(s[h],1,1,()=>{s[h]=null}),Re()),~e?(t=s[e],t?t.p(a,f):(t=s[e]=o[e](a),t.c()),k(t,1),t.m(n.parentNode,n)):t=null)},i(a){i||(k(t),i=!0)},o(a){S(t),i=!1},d(a){a&&$(n),~e&&s[e].d(a)}}}function Os(r,e,t){let n,{map:i}=e,{url:o}=e,s=0,l=!1,a=!1;return Br(async()=>{await Xr(),console.log(`Grabbing ${o}`);try{const f=await As(o,h=>{t(0,s=h)});Tt.set(new ns(i,f,ei,ti,ni)),t(0,s=100),t(1,l=!0)}catch(f){console.log(`Route tool broke: ${f}`),t(2,a=!0)}}),r.$$set=f=>{"map"in f&&t(4,i=f.map),"url"in f&&t(5,o=f.url)},r.$$.update=()=>{r.$$.dirty&1&&t(3,n=s>=100)},[s,l,a,n,i,o]}class Ds extends Ne{constructor(e){super(),Oe(this,e,Os,Ns,Ae,{map:4,url:5})}}function Lr(r){let e,t,n=r[1].properties.name+"",i,o,s=r[1].properties.level+"",l,a;return{c(){e=U("p"),t=Y("Currently drawing a route in "),i=Y(n),o=Y(" ("),l=Y(s),a=Y("))")},l(f){e=q(f,"P",{});var h=oe(e);t=J(h,"Currently drawing a route in "),i=J(h,n),o=J(h," ("),l=J(h,s),a=J(h,"))"),h.forEach($)},m(f,h){M(f,e,h),T(e,t),T(e,i),T(e,o),T(e,l),T(e,a)},p(f,h){h&2&&n!==(n=f[1].properties.name+"")&&Je(i,n),h&2&&s!==(s=f[1].properties.level+"")&&Je(l,s)},d(f){f&&$(e)}}}function Pr(r){let e,t;return e=new Ds({props:{map:r[3],url:r[4]}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p(n,i){const o={};i&8&&(o.map=n[3]),i&16&&(o.url=n[4]),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Ar(r){let e,t,n=r[4]&&Pr(r);return{c(){n&&n.c(),e=ue()},l(i){n&&n.l(i),e=ue()},m(i,o){n&&n.m(i,o),M(i,e,o),t=!0},p(i,o){i[4]?n?(n.p(i,o),o&16&&k(n,1)):(n=Pr(i),n.c(),k(n,1),n.m(e.parentNode,e)):n&&(xe(),S(n,1,1,()=>{n=null}),Re())},i(i){t||(k(n),t=!0)},o(i){S(n),t=!1},d(i){i&&$(e),n&&n.d(i)}}}function Ts(r){let e;return{c(){e=Y("Get route snapper")},l(t){e=J(t,"Get route snapper")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function zs(r){let e;return{c(){e=Y("Draw a route")},l(t){e=J(t,"Draw a route")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function Bs(r){let e;return{c(){e=Y("Edit this route")},l(t){e=J(t,"Edit this route")},m(t,n){M(t,e,n)},d(t){t&&$(e)}}}function Ir(r){let e,t;return e=new Es({props:{maptilerApiKey:"MZEJTanw3WpxRvt7qDfo",extendRoute:!0}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Fs(r){let e,t=r[4],n,i,o,s,l,a,f,h,u,p,c,d,b,_=r[1]&&Lr(r),g=Ar(r);o=new Ye({props:{$$slots:{default:[Ts]},$$scope:{ctx:r}}}),o.$on("click",r[6]),h=new Ye({props:{disabled:r[2]||r[5]==null,$$slots:{default:[zs]},$$scope:{ctx:r}}}),h.$on("click",r[8]),p=new Ye({props:{disabled:r[2]||r[5]==null||r[0].features.length==0,$$slots:{default:[Bs]},$$scope:{ctx:r}}}),p.$on("click",r[9]);let v=r[2]&&r[5]&&Ir();return{c(){_&&_.c(),e=j(),g.c(),n=j(),i=U("div"),P(o.$$.fragment),s=j(),l=U("hr"),a=j(),f=U("div"),P(h.$$.fragment),u=j(),P(p.$$.fragment),c=j(),v&&v.c(),d=ue()},l(y){_&&_.l(y),e=N(y),g.l(y),n=N(y),i=q(y,"DIV",{});var E=oe(i);A(o.$$.fragment,E),E.forEach($),s=N(y),l=q(y,"HR",{}),a=N(y),f=q(y,"DIV",{});var D=oe(f);A(h.$$.fragment,D),u=N(D),A(p.$$.fragment,D),D.forEach($),c=N(y),v&&v.l(y),d=ue()},m(y,E){_&&_.m(y,E),M(y,e,E),g.m(y,E),M(y,n,E),M(y,i,E),I(o,i,null),M(y,s,E),M(y,l,E),M(y,a,E),M(y,f,E),I(h,f,null),T(f,u),I(p,f,null),M(y,c,E),v&&v.m(y,E),M(y,d,E),b=!0},p(y,[E]){y[1]?_?_.p(y,E):(_=Lr(y),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),E&16&&Ae(t,t=y[4])?(xe(),S(g,1,1,Se),Re(),g=Ar(y),g.c(),k(g,1),g.m(n.parentNode,n)):g.p(y,E);const D={};E&1024&&(D.$$scope={dirty:E,ctx:y}),o.$set(D);const w={};E&36&&(w.disabled=y[2]||y[5]==null),E&1024&&(w.$$scope={dirty:E,ctx:y}),h.$set(w);const z={};E&37&&(z.disabled=y[2]||y[5]==null||y[0].features.length==0),E&1024&&(z.$$scope={dirty:E,ctx:y}),p.$set(z),y[2]&&y[5]?v?E&36&&k(v,1):(v=Ir(),v.c(),k(v,1),v.m(d.parentNode,d)):v&&(xe(),S(v,1,1,()=>{v=null}),Re())},i(y){b||(k(g),k(o.$$.fragment,y),k(h.$$.fragment,y),k(p.$$.fragment,y),k(v),b=!0)},o(y){S(g),S(o.$$.fragment,y),S(h.$$.fragment,y),S(p.$$.fragment,y),S(v),b=!1},d(y){y&&($(e),$(n),$(i),$(s),$(l),$(a),$(f),$(c),$(d)),_&&_.d(y),g.d(y),C(o),C(h),C(p),v&&v.d(y)}}}function Gs(r,e,t){let n;ae(r,Tt,c=>t(5,n=c)),Br(async()=>{await Zo()});let{map:i}=e,{routeGj:o}=e,{routeAuthority:s}=e,{drawingRoute:l=!1}=e,a="";function f(){t(1,s=Ko(i));let c=`${s.properties.level}_${s.properties.name}`;t(4,a=`https://atip.uk/route-snappers/v3/${c}.bin.gz`)}function h(c){let d=JSON.parse(JSON.stringify(o));t(0,o.features=[],o),t(2,l=!0),n.addEventListenerSuccess(b=>{t(0,o.features=[b],o),t(2,l=!1),n.clearEventListeners()}),n.addEventListenerFailure(()=>{t(2,l=!1),n.clearEventListeners()}),c?n.editExistingRoute(d.features[0]):n.startRoute()}const u=()=>h(!1),p=()=>h(!0);return r.$$set=c=>{"map"in c&&t(3,i=c.map),"routeGj"in c&&t(0,o=c.routeGj),"routeAuthority"in c&&t(1,s=c.routeAuthority),"drawingRoute"in c&&t(2,l=c.drawingRoute)},[o,s,l,i,a,n,f,h,u,p]}class Us extends Ne{constructor(e){super(),Oe(this,e,Gs,Fs,Ae,{map:3,routeGj:0,routeAuthority:1,drawingRoute:2})}}function Cr(r){let e,t,n,i,o;function s(h){r[5](h)}function l(h){r[6](h)}function a(h){r[7](h)}let f={map:r[0]};return r[3].summary.networkMap!==void 0&&(f.routeGj=r[3].summary.networkMap),r[2]!==void 0&&(f.routeAuthority=r[2]),r[1]!==void 0&&(f.drawingRoute=r[1]),e=new Us({props:f}),Z.push(()=>V(e,"routeGj",s)),Z.push(()=>V(e,"routeAuthority",l)),Z.push(()=>V(e,"drawingRoute",a)),{c(){P(e.$$.fragment)},l(h){A(e.$$.fragment,h)},m(h,u){I(e,h,u),o=!0},p(h,u){const p={};u&1&&(p.map=h[0]),!t&&u&8&&(t=!0,p.routeGj=h[3].summary.networkMap,K(()=>t=!1)),!n&&u&4&&(n=!0,p.routeAuthority=h[2],K(()=>n=!1)),!i&&u&2&&(i=!0,p.drawingRoute=h[1],K(()=>i=!1)),e.$set(p)},i(h){o||(k(e.$$.fragment,h),o=!0)},o(h){S(e.$$.fragment,h),o=!1},d(h){C(e,h)}}}function jr(r){let e,t;return e=new St({props:{data:r[2],$$slots:{default:[qs]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p(n,i){const o={};i&4&&(o.data=n[2]),i&1024&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function qs(r){let e,t;return e=new hn({props:{paint:{"line-color":"black","line-width":5}}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p:Se,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Ws(r){let e,t;return e=new hn({props:{paint:{"line-color":"cyan","line-width":5}}}),{c(){P(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,i){I(e,n,i),t=!0},p:Se,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Zs(r){let e,t,n,i,o,s=r[2]&&jr(r);return t=new St({props:{data:r[3].summary.networkMap,$$slots:{default:[Ws]},$$scope:{ctx:r}}}),i=new Ps({props:{cfg:r[4]}}),{c(){s&&s.c(),e=j(),P(t.$$.fragment),n=j(),P(i.$$.fragment)},l(l){s&&s.l(l),e=N(l),A(t.$$.fragment,l),n=N(l),A(i.$$.fragment,l)},m(l,a){s&&s.m(l,a),M(l,e,a),I(t,l,a),M(l,n,a),I(i,l,a),o=!0},p(l,a){l[2]?s?(s.p(l,a),a&4&&k(s,1)):(s=jr(l),s.c(),k(s,1),s.m(e.parentNode,e)):s&&(xe(),S(s,1,1,()=>{s=null}),Re());const f={};a&8&&(f.data=l[3].summary.networkMap),a&1024&&(f.$$scope={dirty:a,ctx:l}),t.$set(f)},i(l){o||(k(s),k(t.$$.fragment,l),k(i.$$.fragment,l),o=!0)},o(l){S(s),S(t.$$.fragment,l),S(i.$$.fragment,l),o=!1},d(l){l&&($(e),$(n)),s&&s.d(l),C(t,l),C(i,l)}}}function Ks(r){let e,t,n,i,o,s,l,a=r[0]&&Cr(r);function f(u){r[8](u)}let h={$$slots:{default:[Zs]},$$scope:{ctx:r}};return r[0]!==void 0&&(h.map=r[0]),o=new Bi({props:h}),Z.push(()=>V(o,"map",f)),{c(){e=U("div"),t=U("div"),a&&a.c(),n=j(),i=U("div"),P(o.$$.fragment),this.h()},l(u){e=q(u,"DIV",{style:!0});var p=oe(e);t=q(p,"DIV",{style:!0});var c=oe(t);a&&a.l(c),c.forEach($),n=N(p),i=q(p,"DIV",{style:!0});var d=oe(i);A(o.$$.fragment,d),d.forEach($),p.forEach($),this.h()},h(){ie(t,"width","30%"),ie(t,"overflow-y","scroll"),ie(t,"padding","10px"),ie(t,"border","1px solid black"),ie(i,"position","relative"),ie(i,"width","70%"),ie(e,"display","flex"),ie(e,"height","80vh")},m(u,p){M(u,e,p),T(e,t),a&&a.m(t,null),T(e,n),T(e,i),I(o,i,null),l=!0},p(u,[p]){u[0]?a?(a.p(u,p),p&1&&k(a,1)):(a=Cr(u),a.c(),k(a,1),a.m(t,null)):a&&(xe(),S(a,1,1,()=>{a=null}),Re());const c={};p&1036&&(c.$$scope={dirty:p,ctx:u}),!s&&p&1&&(s=!0,c.map=u[0],K(()=>s=!1)),o.$set(c)},i(u){l||(k(a),k(o.$$.fragment,u),l=!0)},o(u){S(a),S(o.$$.fragment,u),l=!1},d(u){u&&$(e),a&&a.d(),C(o)}}}function Vs(r,e,t){let n;ae(r,X,c=>t(3,n=c));let i={layerZorder:["raster-basemap","route-points","route-lines","route-polygons","road_label","Road labels"]},o,s=!1,l=null;function a(c){!c||n.summary.networkMap.features.length==0||c.fitBounds(Fi(n.summary.networkMap),{padding:20,animate:!1})}function f(c){r.$$.not_equal(n.summary.networkMap,c)&&(n.summary.networkMap=c,X.set(n))}function h(c){l=c,t(2,l)}function u(c){s=c,t(1,s)}function p(c){o=c,t(0,o)}return r.$$.update=()=>{r.$$.dirty&1&&a(o)},[o,s,l,n,i,f,h,u,p]}class Hs extends Ne{constructor(e){super(),Oe(this,e,Vs,Ks,Ae,{})}}function Nr(r){let e,t,n,i=r[1].toFixed(2)+"",o,s;return{c(){e=U("p"),t=Y("LineStrings in the Network Map cover a total of "),n=U("b"),o=Y(i),s=Y(`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`)},l(l){e=q(l,"P",{});var a=oe(e);t=J(a,"LineStrings in the Network Map cover a total of "),n=q(a,"B",{});var f=oe(n);o=J(f,i),f.forEach($),s=J(a,`
      kilometers. Depending what that map represents, you can use this value directly,
      or hover on a piece of route on the map to see its individual length.`),a.forEach($)},m(l,a){M(l,e,a),T(e,t),T(e,n),T(n,o),T(e,s)},p(l,a){a&2&&i!==(i=l[1].toFixed(2)+"")&&Je(o,i)},d(l){l&&$(e)}}}function Ys(r){let e,t,n,i,o,s,l,a,f,h,u,p,c,d,b,_,g,v,y,E,D,w,z,F,W,G,te,ne,H,de,De,Q,Te,Ze,be,Qe,Xe,Ke,we,et,tt,ve,x,re,me,ge,nt,zt,Bt,Ie,Ft,Gt,qe,dt;function ri(m){r[2](m)}let _n={label:"Date of design review"};r[0].summary.dateDesignReview!==void 0&&(_n.value=r[0].summary.dateDesignReview),t=new Zi({props:_n}),Z.push(()=>V(t,"value",ri));function ii(m){r[3](m)}let yn={label:"Scheme reference"};r[0].summary.schemeReference!==void 0&&(yn.value=r[0].summary.schemeReference),o=new wt({props:yn}),Z.push(()=>V(o,"value",ii));function oi(m){r[4](m)}let bn={label:"Scheme name"};r[0].summary.schemeName!==void 0&&(bn.value=r[0].summary.schemeName),a=new wt({props:bn}),Z.push(()=>V(a,"value",oi));function si(m){r[5](m)}let wn={label:"Scheme summary"};r[0].summary.schemeSummary!==void 0&&(wn.value=r[0].summary.schemeSummary),u=new mt({props:wn}),Z.push(()=>V(u,"value",si));function li(m){r[6](m)}let vn={label:"Scheme information reviewed"};r[0].summary.schemeInfoReviewed!==void 0&&(vn.value=r[0].summary.schemeInfoReviewed),d=new mt({props:vn}),Z.push(()=>V(d,"value",li));function ai(m){r[7](m)}let $n={label:"Authority",emptyOption:!0,choices:rt(Si)};r[0].summary.authority!==void 0&&($n.value=r[0].summary.authority),g=new Jn({props:$n}),Z.push(()=>V(g,"value",ai));function ui(m){r[8](m)}let kn={label:"Transport / Combined Authority",emptyOption:!0,choices:rt(xi)};r[0].summary.transportOrCombinedAuthority!==void 0&&(kn.value=r[0].summary.transportOrCombinedAuthority),E=new Jn({props:kn}),Z.push(()=>V(E,"value",ui));function fi(m){r[9](m)}let En={label:"Region",emptyOption:!0,choices:rt(Ri)};r[0].summary.region!==void 0&&(En.value=r[0].summary.region),z=new Ei({props:En}),Z.push(()=>V(z,"value",fi));function ci(m){r[10](m)}let Sn={legend:"Funding programme",choices:rt(Mi)};r[0].summary.fundingProgramme!==void 0&&(Sn.value=r[0].summary.fundingProgramme),G=new qt({props:Sn}),Z.push(()=>V(G,"value",ci));function hi(m){r[11](m)}let xn={legend:"Design stage",choices:rt(Li)};r[0].summary.designStage!==void 0&&(xn.value=r[0].summary.designStage),H=new qt({props:xn}),Z.push(()=>V(H,"value",hi));function pi(m){r[12](m)}let Rn={label:"Funding conditions"};r[0].summary.fundingConditions!==void 0&&(Rn.value=r[0].summary.fundingConditions),Q=new mt({props:Rn}),Z.push(()=>V(Q,"value",pi));function gi(m){r[13](m)}let Mn={label:"Inspector email address"};r[0].summary.inspectorEmail!==void 0&&(Mn.value=r[0].summary.inspectorEmail),be=new wt({props:Mn}),Z.push(()=>V(be,"value",gi));let se=r[1]&&Nr(r);function di(m){r[14](m)}let Ln={label:"Route length assessed here (km)",width:6,min:0};r[0].summary.assessedRouteLengthKm!==void 0&&(Ln.value=r[0].summary.assessedRouteLengthKm),we=new Yn({props:Ln}),Z.push(()=>V(we,"value",di));function mi(m){r[15](m)}let Pn={label:"Total route length (km)",width:6,min:0};r[0].summary.totalRouteLengthKm!==void 0&&(Pn.value=r[0].summary.totalRouteLengthKm),ve=new Yn({props:Pn}),Z.push(()=>V(ve,"value",mi));function _i(m){r[16](m)}let An={label:"Notes"};r[0].summary.notes!==void 0&&(An.value=r[0].summary.notes),me=new mt({props:An}),Z.push(()=>V(me,"value",_i));function yi(m){r[17](m)}let In={legend:"Route Check Type (Street or Path)",hint:"What type of route is being reviewed: Street Check (e.g. on- or by-carriageway) or Path Check (e.g. a traffic-free path featuring minimal interactions with motor traffic)",choices:[["street","Street Check"],["path","Path Check"]]};return r[0].summary.checkType!==void 0&&(In.value=r[0].summary.checkType),Ie=new qt({props:In}),Z.push(()=>V(Ie,"value",yi)),qe=new Hs({}),{c(){e=U("div"),P(t.$$.fragment),i=j(),P(o.$$.fragment),l=j(),P(a.$$.fragment),h=j(),P(u.$$.fragment),c=j(),P(d.$$.fragment),_=j(),P(g.$$.fragment),y=j(),P(E.$$.fragment),w=j(),P(z.$$.fragment),W=j(),P(G.$$.fragment),ne=j(),P(H.$$.fragment),De=j(),P(Q.$$.fragment),Ze=j(),P(be.$$.fragment),Xe=j(),se&&se.c(),Ke=j(),P(we.$$.fragment),tt=j(),P(ve.$$.fragment),re=j(),P(me.$$.fragment),nt=j(),zt=U("hr"),Bt=j(),P(Ie.$$.fragment),Gt=j(),P(qe.$$.fragment),this.h()},l(m){e=q(m,"DIV",{class:!0});var L=oe(e);A(t.$$.fragment,L),i=N(L),A(o.$$.fragment,L),l=N(L),A(a.$$.fragment,L),h=N(L),A(u.$$.fragment,L),c=N(L),A(d.$$.fragment,L),_=N(L),A(g.$$.fragment,L),y=N(L),A(E.$$.fragment,L),w=N(L),A(z.$$.fragment,L),W=N(L),A(G.$$.fragment,L),ne=N(L),A(H.$$.fragment,L),De=N(L),A(Q.$$.fragment,L),Ze=N(L),A(be.$$.fragment,L),Xe=N(L),se&&se.l(L),Ke=N(L),A(we.$$.fragment,L),tt=N(L),A(ve.$$.fragment,L),re=N(L),A(me.$$.fragment,L),nt=N(L),zt=q(L,"HR",{}),Bt=N(L),A(Ie.$$.fragment,L),Gt=N(L),A(qe.$$.fragment,L),L.forEach($),this.h()},h(){ye(e,"class","govuk-width-container")},m(m,L){M(m,e,L),I(t,e,null),T(e,i),I(o,e,null),T(e,l),I(a,e,null),T(e,h),I(u,e,null),T(e,c),I(d,e,null),T(e,_),I(g,e,null),T(e,y),I(E,e,null),T(e,w),I(z,e,null),T(e,W),I(G,e,null),T(e,ne),I(H,e,null),T(e,De),I(Q,e,null),T(e,Ze),I(be,e,null),T(e,Xe),se&&se.m(e,null),T(e,Ke),I(we,e,null),T(e,tt),I(ve,e,null),T(e,re),I(me,e,null),T(e,nt),T(e,zt),T(e,Bt),I(Ie,e,null),T(e,Gt),I(qe,e,null),dt=!0},p(m,[L]){const Cn={};!n&&L&1&&(n=!0,Cn.value=m[0].summary.dateDesignReview,K(()=>n=!1)),t.$set(Cn);const jn={};!s&&L&1&&(s=!0,jn.value=m[0].summary.schemeReference,K(()=>s=!1)),o.$set(jn);const Nn={};!f&&L&1&&(f=!0,Nn.value=m[0].summary.schemeName,K(()=>f=!1)),a.$set(Nn);const On={};!p&&L&1&&(p=!0,On.value=m[0].summary.schemeSummary,K(()=>p=!1)),u.$set(On);const Dn={};!b&&L&1&&(b=!0,Dn.value=m[0].summary.schemeInfoReviewed,K(()=>b=!1)),d.$set(Dn);const Tn={};!v&&L&1&&(v=!0,Tn.value=m[0].summary.authority,K(()=>v=!1)),g.$set(Tn);const zn={};!D&&L&1&&(D=!0,zn.value=m[0].summary.transportOrCombinedAuthority,K(()=>D=!1)),E.$set(zn);const Bn={};!F&&L&1&&(F=!0,Bn.value=m[0].summary.region,K(()=>F=!1)),z.$set(Bn);const Fn={};!te&&L&1&&(te=!0,Fn.value=m[0].summary.fundingProgramme,K(()=>te=!1)),G.$set(Fn);const Gn={};!de&&L&1&&(de=!0,Gn.value=m[0].summary.designStage,K(()=>de=!1)),H.$set(Gn);const Un={};!Te&&L&1&&(Te=!0,Un.value=m[0].summary.fundingConditions,K(()=>Te=!1)),Q.$set(Un);const qn={};!Qe&&L&1&&(Qe=!0,qn.value=m[0].summary.inspectorEmail,K(()=>Qe=!1)),be.$set(qn),m[1]?se?se.p(m,L):(se=Nr(m),se.c(),se.m(e,Ke)):se&&(se.d(1),se=null);const Wn={};!et&&L&1&&(et=!0,Wn.value=m[0].summary.assessedRouteLengthKm,K(()=>et=!1)),we.$set(Wn);const Zn={};!x&&L&1&&(x=!0,Zn.value=m[0].summary.totalRouteLengthKm,K(()=>x=!1)),ve.$set(Zn);const Kn={};!ge&&L&1&&(ge=!0,Kn.value=m[0].summary.notes,K(()=>ge=!1)),me.$set(Kn);const Vn={};!Ft&&L&1&&(Ft=!0,Vn.value=m[0].summary.checkType,K(()=>Ft=!1)),Ie.$set(Vn)},i(m){dt||(k(t.$$.fragment,m),k(o.$$.fragment,m),k(a.$$.fragment,m),k(u.$$.fragment,m),k(d.$$.fragment,m),k(g.$$.fragment,m),k(E.$$.fragment,m),k(z.$$.fragment,m),k(G.$$.fragment,m),k(H.$$.fragment,m),k(Q.$$.fragment,m),k(be.$$.fragment,m),k(we.$$.fragment,m),k(ve.$$.fragment,m),k(me.$$.fragment,m),k(Ie.$$.fragment,m),k(qe.$$.fragment,m),dt=!0)},o(m){S(t.$$.fragment,m),S(o.$$.fragment,m),S(a.$$.fragment,m),S(u.$$.fragment,m),S(d.$$.fragment,m),S(g.$$.fragment,m),S(E.$$.fragment,m),S(z.$$.fragment,m),S(G.$$.fragment,m),S(H.$$.fragment,m),S(Q.$$.fragment,m),S(be.$$.fragment,m),S(we.$$.fragment,m),S(ve.$$.fragment,m),S(me.$$.fragment,m),S(Ie.$$.fragment,m),S(qe.$$.fragment,m),dt=!1},d(m){m&&$(e),C(t),C(o),C(a),C(u),C(d),C(g),C(E),C(z),C(G),C(H),C(Q),C(be),se&&se.d(),C(we),C(ve),C(me),C(Ie),C(qe)}}}function Js(r,e,t){let n,i;ae(r,X,w=>t(0,i=w));function o(w){let z=0;for(let F of w.features)F.geometry.type=="LineString"&&(z+=Pi(F,{units:"kilometers"}));return z>0?z:null}function s(w){r.$$.not_equal(i.summary.dateDesignReview,w)&&(i.summary.dateDesignReview=w,X.set(i))}function l(w){r.$$.not_equal(i.summary.schemeReference,w)&&(i.summary.schemeReference=w,X.set(i))}function a(w){r.$$.not_equal(i.summary.schemeName,w)&&(i.summary.schemeName=w,X.set(i))}function f(w){r.$$.not_equal(i.summary.schemeSummary,w)&&(i.summary.schemeSummary=w,X.set(i))}function h(w){r.$$.not_equal(i.summary.schemeInfoReviewed,w)&&(i.summary.schemeInfoReviewed=w,X.set(i))}function u(w){r.$$.not_equal(i.summary.authority,w)&&(i.summary.authority=w,X.set(i))}function p(w){r.$$.not_equal(i.summary.transportOrCombinedAuthority,w)&&(i.summary.transportOrCombinedAuthority=w,X.set(i))}function c(w){r.$$.not_equal(i.summary.region,w)&&(i.summary.region=w,X.set(i))}function d(w){r.$$.not_equal(i.summary.fundingProgramme,w)&&(i.summary.fundingProgramme=w,X.set(i))}function b(w){r.$$.not_equal(i.summary.designStage,w)&&(i.summary.designStage=w,X.set(i))}function _(w){r.$$.not_equal(i.summary.fundingConditions,w)&&(i.summary.fundingConditions=w,X.set(i))}function g(w){r.$$.not_equal(i.summary.inspectorEmail,w)&&(i.summary.inspectorEmail=w,X.set(i))}function v(w){r.$$.not_equal(i.summary.assessedRouteLengthKm,w)&&(i.summary.assessedRouteLengthKm=w,X.set(i))}function y(w){r.$$.not_equal(i.summary.totalRouteLengthKm,w)&&(i.summary.totalRouteLengthKm=w,X.set(i))}function E(w){r.$$.not_equal(i.summary.notes,w)&&(i.summary.notes=w,X.set(i))}function D(w){r.$$.not_equal(i.summary.checkType,w)&&(i.summary.checkType=w,X.set(i))}return r.$$.update=()=>{r.$$.dirty&1&&t(1,n=o(i.summary.networkMap))},[i,n,s,l,a,f,h,u,p,c,d,b,_,g,v,y,E,D]}class bl extends Ne{constructor(e){super(),Oe(this,e,Js,Ys,Ae,{})}}export{bl as component};
