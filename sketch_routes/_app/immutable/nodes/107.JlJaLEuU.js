import{s as we,w as x,e as W,t as Y,a as B,c as Z,b as X,d as Q,f as d,g as A,p as z,q as J,i as L,h as R,x as ee,k as ye,z as nt,P as it,$ as he,X as pe,E as me,m as ve,G as ge,j as _e,n as ot,K as be,L as ke}from"../chunks/scheduler.B-9e-9-p.js";import{S as Ie,i as Le,e as te,c as M,a as G,m as V,t as b,g as se,b as S,f as re,d as F}from"../chunks/index.DroATz0g.js";import{p as $e,q as de,M as st,t as rt,b as at,G as ft,C as ut}from"../chunks/index.ClFpVPGG.js";import{e as oe}from"../chunks/each.DAWvWy0T.js";import{c as ct,p as pt}from"../chunks/colors.DaC397qr.js";import{p as Ue,b as _t}from"../chunks/index.Cjke8us6.js";import{R as Se}from"../chunks/Radio.BdRLhhzG.js";import{S as ze}from"../chunks/Select.CkHvvajI.js";/* empty css                                                    */import{T as He}from"../chunks/TextArea.Duw9aX5O.js";import{T as Je}from"../chunks/TextInput.BMwkTE4v.js";import{s as U}from"../chunks/data.lS3-MLhV.js";import{c as mt,p as gt,b as Ee,d as De,e as $t,g as dt}from"../chunks/lists.Dqlqv0er.js";import{Y as Ke}from"../chunks/YesNo.DDaRRImN.js";import{C as ht,M as We}from"../chunks/Marker.CIe9GyU8.js";import{C as vt}from"../chunks/CollapsibleCard.BozK6AqH.js";import{D as bt}from"../chunks/DefaultButton.CUKukJh0.js";import{S as Ze}from"../chunks/SecondaryButton.3eYdcbxs.js";import{W as kt}from"../chunks/WarningButton.ayNgkn5A.js";import{B as Ct,G as wt,S as yt,M as It}from"../chunks/GeoreferenceLayer.svelte_svelte_type_style_lang.D_RAJQMu.js";import{G as Lt}from"../chunks/GeoreferenceLayer.CfViRuql.js";import{C as Xe}from"../chunks/ClickableCard.ByJv8LVI.js";import{C as St}from"../chunks/Popup.EntNdPHS.js";function Pe(t){let e,n,l;function i(s){t[5](s)}let r={label:"Resolved by Design",inlineSmall:!0};return t[1].criticalIssues[t[0]].resolved!==void 0&&(r.value=t[1].criticalIssues[t[0]].resolved),e=new Ke({props:r}),x.push(()=>te(e,"value",i)),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,c){V(e,s,c),l=!0},p(s,c){const f={};!n&&c&3&&(n=!0,f.value=s[1].criticalIssues[s[0]].resolved,ee(()=>n=!1)),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){F(e,s)}}}function Nt(t){let e,n,l,i,r,s,c,f,_,u,j,v,w,$,h,D,o,p,I,E,P,y;function K(a){t[2](a)}let T={label:"Critical Issue",emptyOption:!0,choices:mt};t[1].criticalIssues[t[0]].criticalIssue!==void 0&&(T.value=t[1].criticalIssues[t[0]].criticalIssue),u=new ze({props:T}),x.push(()=>te(u,"value",K));function ae(a){t[3](a)}let m={legend:"Stage",choices:Ue(["Existing","Design"]),inlineSmall:!0};t[1].criticalIssues[t[0]].stage!==void 0&&(m.value=t[1].criticalIssues[t[0]].stage),w=new Se({props:m}),x.push(()=>te(w,"value",ae));function k(a){t[4](a)}let H={label:"Location Name"};t[1].criticalIssues[t[0]].locationName!==void 0&&(H.value=t[1].criticalIssues[t[0]].locationName),D=new Je({props:H}),x.push(()=>te(D,"value",k));let N=t[1].criticalIssues[t[0]].stage!="Design"&&Pe(t);function q(a){t[6](a)}let le={label:"Commentary & Feedback"};return t[1].criticalIssues[t[0]].notes!==void 0&&(le.value=t[1].criticalIssues[t[0]].notes),E=new He({props:le}),x.push(()=>te(E,"value",q)),{c(){e=W("div"),n=W("a"),l=Y("Google StreetView"),r=B(),s=W("a"),c=Y("Bing Streetside"),_=B(),M(u.$$.fragment),v=B(),M(w.$$.fragment),h=B(),M(D.$$.fragment),p=B(),N&&N.c(),I=B(),M(E.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{style:!0});var C=X(e);n=Z(C,"A",{href:!0,target:!0});var ne=X(n);l=Q(ne,"Google StreetView"),ne.forEach(d),r=A(C),s=Z(C,"A",{href:!0,target:!0});var ie=X(s);c=Q(ie,"Bing Streetside"),ie.forEach(d),C.forEach(d),_=A(a),G(u.$$.fragment,a),v=A(a),G(w.$$.fragment,a),h=A(a),G(D.$$.fragment,a),p=A(a),N&&N.l(a),I=A(a),G(E.$$.fragment,a),this.h()},h(){z(n,"href",i=$e(t[1].criticalIssues[t[0]].point)),z(n,"target","_blank"),z(s,"href",f=de(t[1].criticalIssues[t[0]].point)),z(s,"target","_blank"),J(e,"display","flex"),J(e,"justify-content","space-evenly")},m(a,C){L(a,e,C),R(e,n),R(n,l),R(e,r),R(e,s),R(s,c),L(a,_,C),V(u,a,C),L(a,v,C),V(w,a,C),L(a,h,C),V(D,a,C),L(a,p,C),N&&N.m(a,C),L(a,I,C),V(E,a,C),y=!0},p(a,[C]){(!y||C&3&&i!==(i=$e(a[1].criticalIssues[a[0]].point)))&&z(n,"href",i),(!y||C&3&&f!==(f=de(a[1].criticalIssues[a[0]].point)))&&z(s,"href",f);const ne={};!j&&C&3&&(j=!0,ne.value=a[1].criticalIssues[a[0]].criticalIssue,ee(()=>j=!1)),u.$set(ne);const ie={};!$&&C&3&&($=!0,ie.value=a[1].criticalIssues[a[0]].stage,ee(()=>$=!1)),w.$set(ie);const fe={};!o&&C&3&&(o=!0,fe.value=a[1].criticalIssues[a[0]].locationName,ee(()=>o=!1)),D.$set(fe),a[1].criticalIssues[a[0]].stage!="Design"?N?(N.p(a,C),C&3&&b(N,1)):(N=Pe(a),N.c(),b(N,1),N.m(I.parentNode,I)):N&&(se(),S(N,1,1,()=>{N=null}),re());const ue={};!P&&C&3&&(P=!0,ue.value=a[1].criticalIssues[a[0]].notes,ee(()=>P=!1)),E.$set(ue)},i(a){y||(b(u.$$.fragment,a),b(w.$$.fragment,a),b(D.$$.fragment,a),b(N),b(E.$$.fragment,a),y=!0)},o(a){S(u.$$.fragment,a),S(w.$$.fragment,a),S(D.$$.fragment,a),S(N),S(E.$$.fragment,a),y=!1},d(a){a&&(d(e),d(_),d(v),d(h),d(p),d(I)),F(u,a),F(w,a),F(D,a),N&&N.d(a),F(E,a)}}}function Et(t,e,n){let l;ye(t,U,u=>n(1,l=u));let{idx:i}=e;function r(u){t.$$.not_equal(l.criticalIssues[i].criticalIssue,u)&&(l.criticalIssues[i].criticalIssue=u,U.set(l))}function s(u){t.$$.not_equal(l.criticalIssues[i].stage,u)&&(l.criticalIssues[i].stage=u,U.set(l))}function c(u){t.$$.not_equal(l.criticalIssues[i].locationName,u)&&(l.criticalIssues[i].locationName=u,U.set(l))}function f(u){t.$$.not_equal(l.criticalIssues[i].resolved,u)&&(l.criticalIssues[i].resolved=u,U.set(l))}function _(u){t.$$.not_equal(l.criticalIssues[i].notes,u)&&(l.criticalIssues[i].notes=u,U.set(l))}return t.$$set=u=>{"idx"in u&&n(0,i=u.idx)},[i,l,r,s,c,f,_]}class Dt extends Ie{constructor(e){super(),Le(this,e,Et,Nt,we,{idx:0})}}function je(t){let e,n,l;function i(s){t[5](s)}let r={label:"Resolved by Design",inlineSmall:!0};return t[1].policyConflictLog[t[0]].resolved!==void 0&&(r.value=t[1].policyConflictLog[t[0]].resolved),e=new Ke({props:r}),x.push(()=>te(e,"value",i)),{c(){M(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,c){V(e,s,c),l=!0},p(s,c){const f={};!n&&c&3&&(n=!0,f.value=s[1].policyConflictLog[s[0]].resolved,ee(()=>n=!1)),e.$set(f)},i(s){l||(b(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){F(e,s)}}}function Pt(t){let e,n,l,i,r,s,c,f,_,u,j,v,w,$,h,D,o,p,I,E,P,y;function K(a){t[2](a)}let T={label:"Policy Conflict",emptyOption:!0,choices:gt};t[1].policyConflictLog[t[0]].conflict!==void 0&&(T.value=t[1].policyConflictLog[t[0]].conflict),u=new ze({props:T}),x.push(()=>te(u,"value",K));function ae(a){t[3](a)}let m={legend:"Stage",choices:Ue(["Existing","Design"]),inlineSmall:!0};t[1].policyConflictLog[t[0]].stage!==void 0&&(m.value=t[1].policyConflictLog[t[0]].stage),w=new Se({props:m}),x.push(()=>te(w,"value",ae));function k(a){t[4](a)}let H={label:"Location Name"};t[1].policyConflictLog[t[0]].locationName!==void 0&&(H.value=t[1].policyConflictLog[t[0]].locationName),D=new Je({props:H}),x.push(()=>te(D,"value",k));let N=t[1].policyConflictLog[t[0]].stage!="Design"&&je(t);function q(a){t[6](a)}let le={label:"Commentary & Feedback"};return t[1].policyConflictLog[t[0]].notes!==void 0&&(le.value=t[1].policyConflictLog[t[0]].notes),E=new He({props:le}),x.push(()=>te(E,"value",q)),{c(){e=W("div"),n=W("a"),l=Y("Google StreetView"),r=B(),s=W("a"),c=Y("Bing Streetside"),_=B(),M(u.$$.fragment),v=B(),M(w.$$.fragment),h=B(),M(D.$$.fragment),p=B(),N&&N.c(),I=B(),M(E.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{style:!0});var C=X(e);n=Z(C,"A",{href:!0,target:!0});var ne=X(n);l=Q(ne,"Google StreetView"),ne.forEach(d),r=A(C),s=Z(C,"A",{href:!0,target:!0});var ie=X(s);c=Q(ie,"Bing Streetside"),ie.forEach(d),C.forEach(d),_=A(a),G(u.$$.fragment,a),v=A(a),G(w.$$.fragment,a),h=A(a),G(D.$$.fragment,a),p=A(a),N&&N.l(a),I=A(a),G(E.$$.fragment,a),this.h()},h(){z(n,"href",i=$e(t[1].policyConflictLog[t[0]].point)),z(n,"target","_blank"),z(s,"href",f=de(t[1].policyConflictLog[t[0]].point)),z(s,"target","_blank"),J(e,"display","flex"),J(e,"justify-content","space-evenly")},m(a,C){L(a,e,C),R(e,n),R(n,l),R(e,r),R(e,s),R(s,c),L(a,_,C),V(u,a,C),L(a,v,C),V(w,a,C),L(a,h,C),V(D,a,C),L(a,p,C),N&&N.m(a,C),L(a,I,C),V(E,a,C),y=!0},p(a,[C]){(!y||C&3&&i!==(i=$e(a[1].policyConflictLog[a[0]].point)))&&z(n,"href",i),(!y||C&3&&f!==(f=de(a[1].policyConflictLog[a[0]].point)))&&z(s,"href",f);const ne={};!j&&C&3&&(j=!0,ne.value=a[1].policyConflictLog[a[0]].conflict,ee(()=>j=!1)),u.$set(ne);const ie={};!$&&C&3&&($=!0,ie.value=a[1].policyConflictLog[a[0]].stage,ee(()=>$=!1)),w.$set(ie);const fe={};!o&&C&3&&(o=!0,fe.value=a[1].policyConflictLog[a[0]].locationName,ee(()=>o=!1)),D.$set(fe),a[1].policyConflictLog[a[0]].stage!="Design"?N?(N.p(a,C),C&3&&b(N,1)):(N=je(a),N.c(),b(N,1),N.m(I.parentNode,I)):N&&(se(),S(N,1,1,()=>{N=null}),re());const ue={};!P&&C&3&&(P=!0,ue.value=a[1].policyConflictLog[a[0]].notes,ee(()=>P=!1)),E.$set(ue)},i(a){y||(b(u.$$.fragment,a),b(w.$$.fragment,a),b(D.$$.fragment,a),b(N),b(E.$$.fragment,a),y=!0)},o(a){S(u.$$.fragment,a),S(w.$$.fragment,a),S(D.$$.fragment,a),S(N),S(E.$$.fragment,a),y=!1},d(a){a&&(d(e),d(_),d(v),d(h),d(p),d(I)),F(u,a),F(w,a),F(D,a),N&&N.d(a),F(E,a)}}}function jt(t,e,n){let l;ye(t,U,u=>n(1,l=u));let{idx:i}=e;function r(u){t.$$.not_equal(l.policyConflictLog[i].conflict,u)&&(l.policyConflictLog[i].conflict=u,U.set(l))}function s(u){t.$$.not_equal(l.policyConflictLog[i].stage,u)&&(l.policyConflictLog[i].stage=u,U.set(l))}function c(u){t.$$.not_equal(l.policyConflictLog[i].locationName,u)&&(l.policyConflictLog[i].locationName=u,U.set(l))}function f(u){t.$$.not_equal(l.policyConflictLog[i].resolved,u)&&(l.policyConflictLog[i].resolved=u,U.set(l))}function _(u){t.$$.not_equal(l.policyConflictLog[i].notes,u)&&(l.policyConflictLog[i].notes=u,U.set(l))}return t.$$set=u=>{"idx"in u&&n(0,i=u.idx)},[i,l,r,s,c,f,_]}class qt extends Ie{constructor(e){super(),Le(this,e,jt,Pt,we,{idx:0})}}const{window:Bt}=rt;function qe(t,e,n){const l=t.slice();return l[39]=e[n],l[40]=e,l[41]=n,l}function Be(t,e,n){const l=t.slice();return l[42]=e[n],l[43]=e,l[41]=n,l}function Ae(t,e,n){const l=t.slice();return l[39]=e[n],l[41]=n,l}function Te(t,e,n){const l=t.slice();return l[42]=e[n],l[41]=n,l}function At(t){let e,n,l,i,r,s,c,f,_,u;e=new bt({props:{$$slots:{default:[Mt]},$$scope:{ctx:t}}}),e.$on("click",t[12]),l=new kt({props:{$$slots:{default:[Gt]},$$scope:{ctx:t}}}),l.$on("click",t[14]),r=new Ze({props:{$$slots:{default:[Vt]},$$scope:{ctx:t}}}),r.$on("click",t[29]);const j=[Rt,Ft],v=[];function w($,h){return $[0].kind=="critical"?0:1}return c=w(t),f=v[c]=j[c](t),{c(){M(e.$$.fragment),n=B(),M(l.$$.fragment),i=B(),M(r.$$.fragment),s=B(),f.c(),_=me()},l($){G(e.$$.fragment,$),n=A($),G(l.$$.fragment,$),i=A($),G(r.$$.fragment,$),s=A($),f.l($),_=me()},m($,h){V(e,$,h),L($,n,h),V(l,$,h),L($,i,h),V(r,$,h),L($,s,h),v[c].m($,h),L($,_,h),u=!0},p($,h){const D={};h[1]&32768&&(D.$$scope={dirty:h,ctx:$}),e.$set(D);const o={};h[1]&32768&&(o.$$scope={dirty:h,ctx:$}),l.$set(o);const p={};h[1]&32768&&(p.$$scope={dirty:h,ctx:$}),r.$set(p);let I=c;c=w($),c===I?v[c].p($,h):(se(),S(v[I],1,1,()=>{v[I]=null}),re(),f=v[c],f?f.p($,h):(f=v[c]=j[c]($),f.c()),b(f,1),f.m(_.parentNode,_))},i($){u||(b(e.$$.fragment,$),b(l.$$.fragment,$),b(r.$$.fragment,$),b(f),u=!0)},o($){S(e.$$.fragment,$),S(l.$$.fragment,$),S(r.$$.fragment,$),S(f),u=!1},d($){$&&(d(n),d(i),d(s),d(_)),F(e,$),F(l,$),F(r,$),v[c].d($)}}}function Tt(t){let e,n,l,i,r,s,c="Click the map to add a problem, or select a problem to fill out data",f,_,u="Critical Issues",j,v,w,$="Policy Conflicts",h,D,o;e=new vt({props:{label:"Tools",open:!0,$$slots:{default:[zt]},$$scope:{ctx:t}}});function p(m){t[22](m)}let I={legend:"Create new problems",choices:[["critical","Critical Issue"],["conflict","Policy Conflict"]],inlineSmall:!0};t[5]!==void 0&&(I.value=t[5]),l=new Se({props:I}),x.push(()=>te(l,"value",p));let E=oe(t[2].criticalIssues),P=[];for(let m=0;m<E.length;m+=1)P[m]=Ge(Te(t,E,m));const y=m=>S(P[m],1,1,()=>{P[m]=null});let K=oe(t[2].policyConflictLog),T=[];for(let m=0;m<K.length;m+=1)T[m]=Fe(Ae(t,K,m));const ae=m=>S(T[m],1,1,()=>{T[m]=null});return{c(){M(e.$$.fragment),n=B(),M(l.$$.fragment),r=B(),s=W("p"),s.textContent=c,f=B(),_=W("h3"),_.textContent=u,j=B();for(let m=0;m<P.length;m+=1)P[m].c();v=B(),w=W("h3"),w.textContent=$,h=B();for(let m=0;m<T.length;m+=1)T[m].c();D=me()},l(m){G(e.$$.fragment,m),n=A(m),G(l.$$.fragment,m),r=A(m),s=Z(m,"P",{"data-svelte-h":!0}),ve(s)!=="svelte-12ba5j2"&&(s.textContent=c),f=A(m),_=Z(m,"H3",{"data-svelte-h":!0}),ve(_)!=="svelte-1qhh5xr"&&(_.textContent=u),j=A(m);for(let k=0;k<P.length;k+=1)P[k].l(m);v=A(m),w=Z(m,"H3",{"data-svelte-h":!0}),ve(w)!=="svelte-eyxzjx"&&(w.textContent=$),h=A(m);for(let k=0;k<T.length;k+=1)T[k].l(m);D=me()},m(m,k){V(e,m,k),L(m,n,k),V(l,m,k),L(m,r,k),L(m,s,k),L(m,f,k),L(m,_,k),L(m,j,k);for(let H=0;H<P.length;H+=1)P[H]&&P[H].m(m,k);L(m,v,k),L(m,w,k),L(m,h,k);for(let H=0;H<T.length;H+=1)T[H]&&T[H].m(m,k);L(m,D,k),o=!0},p(m,k){const H={};k[0]&200|k[1]&32768&&(H.$$scope={dirty:k,ctx:m}),e.$set(H);const N={};if(!i&&k[0]&32&&(i=!0,N.value=m[5],ee(()=>i=!1)),l.$set(N),k[0]&66566){E=oe(m[2].criticalIssues);let q;for(q=0;q<E.length;q+=1){const le=Te(m,E,q);P[q]?(P[q].p(le,k),b(P[q],1)):(P[q]=Ge(le),P[q].c(),b(P[q],1),P[q].m(v.parentNode,v))}for(se(),q=E.length;q<P.length;q+=1)y(q);re()}if(k[0]&132102){K=oe(m[2].policyConflictLog);let q;for(q=0;q<K.length;q+=1){const le=Ae(m,K,q);T[q]?(T[q].p(le,k),b(T[q],1)):(T[q]=Fe(le),T[q].c(),b(T[q],1),T[q].m(D.parentNode,D))}for(se(),q=K.length;q<T.length;q+=1)ae(q);re()}},i(m){if(!o){b(e.$$.fragment,m),b(l.$$.fragment,m);for(let k=0;k<E.length;k+=1)b(P[k]);for(let k=0;k<K.length;k+=1)b(T[k]);o=!0}},o(m){S(e.$$.fragment,m),S(l.$$.fragment,m),P=P.filter(Boolean);for(let k=0;k<P.length;k+=1)S(P[k]);T=T.filter(Boolean);for(let k=0;k<T.length;k+=1)S(T[k]);o=!1},d(m){m&&(d(n),d(r),d(s),d(f),d(_),d(j),d(v),d(w),d(h),d(D)),F(e,m),F(l,m),ge(P,m),ge(T,m)}}}function Mt(t){let e;return{c(){e=Y("Save")},l(n){e=Q(n,"Save")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Gt(t){let e;return{c(){e=Y("Delete")},l(n){e=Q(n,"Delete")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Vt(t){let e;return{c(){e=Y("Copy")},l(n){e=Q(n,"Copy")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Ft(t){let e,n;return e=new qt({props:{idx:t[0].idx}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p(l,i){const r={};i[0]&1&&(r.idx=l[0].idx),e.$set(r)},i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Rt(t){let e,n;return e=new Dt({props:{idx:t[0].idx}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p(l,i){const r={};i[0]&1&&(r.idx=l[0].idx),e.$set(r)},i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Ot(t){let e;return{c(){e=Y("Zoom to fit")},l(n){e=Q(n,"Zoom to fit")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function Ut(t){let e;return{c(){e=Y("Show scheme context")},l(n){e=Q(n,"Show scheme context")},m(n,l){L(n,e,l)},d(n){n&&d(e)}}}function zt(t){let e,n,l,i,r,s,c,f,_,u,j,v;e=new Ze({props:{$$slots:{default:[Ot]},$$scope:{ctx:t}}}),e.$on("click",t[19]),l=new Ct({}),r=new wt({});function w(o){t[20](o)}let $={map:t[3]};t[6]!==void 0&&($.enabled=t[6]),c=new yt({props:$}),x.push(()=>te(c,"enabled",w));function h(o){t[21](o)}let D={$$slots:{default:[Ut]},$$scope:{ctx:t}};return t[7]!==void 0&&(D.checked=t[7]),u=new ht({props:D}),x.push(()=>te(u,"checked",h)),{c(){M(e.$$.fragment),n=B(),M(l.$$.fragment),i=B(),M(r.$$.fragment),s=B(),M(c.$$.fragment),_=B(),M(u.$$.fragment)},l(o){G(e.$$.fragment,o),n=A(o),G(l.$$.fragment,o),i=A(o),G(r.$$.fragment,o),s=A(o),G(c.$$.fragment,o),_=A(o),G(u.$$.fragment,o)},m(o,p){V(e,o,p),L(o,n,p),V(l,o,p),L(o,i,p),V(r,o,p),L(o,s,p),V(c,o,p),L(o,_,p),V(u,o,p),v=!0},p(o,p){const I={};p[1]&32768&&(I.$$scope={dirty:p,ctx:o}),e.$set(I);const E={};p[0]&8&&(E.map=o[3]),!f&&p[0]&64&&(f=!0,E.enabled=o[6],ee(()=>f=!1)),c.$set(E);const P={};p[1]&32768&&(P.$$scope={dirty:p,ctx:o}),!j&&p[0]&128&&(j=!0,P.checked=o[7],ee(()=>j=!1)),u.$set(P)},i(o){v||(b(e.$$.fragment,o),b(l.$$.fragment,o),b(r.$$.fragment,o),b(c.$$.fragment,o),b(u.$$.fragment,o),v=!0)},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),S(r.$$.fragment,o),S(c.$$.fragment,o),S(u.$$.fragment,o),v=!1},d(o){o&&(d(n),d(i),d(s),d(_)),F(e,o),F(l,o),F(r,o),F(c,o),F(u,o)}}}function Me(t){let e,n,l=t[42].resolved+"",i;return{c(){e=W("span"),n=Y("Resolved: "),i=Y(l)},l(r){e=Z(r,"SPAN",{});var s=X(e);n=Q(s,"Resolved: "),i=Q(s,l),s.forEach(d)},m(r,s){L(r,e,s),R(e,n),R(e,i)},p(r,s){s[0]&4&&l!==(l=r[42].resolved+"")&&_e(i,l)},d(r){r&&d(e)}}}function Ht(t){let e,n,l,i=t[42].stage+"",r,s,c=t[42].stage!="Design"&&Me(t);return{c(){e=W("div"),n=W("span"),l=Y("Stage: "),r=Y(i),s=B(),c&&c.c(),this.h()},l(f){e=Z(f,"DIV",{style:!0});var _=X(e);n=Z(_,"SPAN",{});var u=X(n);l=Q(u,"Stage: "),r=Q(u,i),u.forEach(d),s=A(_),c&&c.l(_),_.forEach(d),this.h()},h(){J(e,"width","100%"),J(e,"display","flex"),J(e,"justify-content","space-between")},m(f,_){L(f,e,_),R(e,n),R(n,l),R(n,r),R(e,s),c&&c.m(e,null)},p(f,_){_[0]&4&&i!==(i=f[42].stage+"")&&_e(r,i),f[42].stage!="Design"?c?c.p(f,_):(c=Me(f),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&d(e),c&&c.d()}}}function Ge(t){let e,n;function l(){return t[23](t[41])}function i(){return t[24](t[41])}return e=new Xe({props:{name:t[16](t[42]),$$slots:{default:[Ht]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",i),e.$on("mouseleave",t[25]),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,s){V(e,r,s),n=!0},p(r,s){t=r;const c={};s[0]&4&&(c.name=t[16](t[42])),s[0]&4|s[1]&32768&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){S(e.$$.fragment,r),n=!1},d(r){F(e,r)}}}function Ve(t){let e,n,l=t[39].resolved+"",i;return{c(){e=W("span"),n=Y("Resolved: "),i=Y(l)},l(r){e=Z(r,"SPAN",{});var s=X(e);n=Q(s,"Resolved: "),i=Q(s,l),s.forEach(d)},m(r,s){L(r,e,s),R(e,n),R(e,i)},p(r,s){s[0]&4&&l!==(l=r[39].resolved+"")&&_e(i,l)},d(r){r&&d(e)}}}function Jt(t){let e,n,l,i=t[39].stage+"",r,s,c,f=t[39].stage!="Design"&&Ve(t);return{c(){e=W("div"),n=W("span"),l=Y("Stage: "),r=Y(i),s=B(),f&&f.c(),c=B(),this.h()},l(_){e=Z(_,"DIV",{style:!0});var u=X(e);n=Z(u,"SPAN",{});var j=X(n);l=Q(j,"Stage: "),r=Q(j,i),j.forEach(d),s=A(u),f&&f.l(u),u.forEach(d),c=A(_),this.h()},h(){J(e,"width","100%"),J(e,"display","flex"),J(e,"justify-content","space-between")},m(_,u){L(_,e,u),R(e,n),R(n,l),R(n,r),R(e,s),f&&f.m(e,null),L(_,c,u)},p(_,u){u[0]&4&&i!==(i=_[39].stage+"")&&_e(r,i),_[39].stage!="Design"?f?f.p(_,u):(f=Ve(_),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(_){_&&(d(e),d(c)),f&&f.d()}}}function Fe(t){let e,n;function l(){return t[26](t[41])}function i(){return t[27](t[41])}return e=new Xe({props:{name:t[17](t[39]),$$slots:{default:[Jt]},$$scope:{ctx:t}}}),e.$on("click",l),e.$on("mouseenter",i),e.$on("mouseleave",t[28]),{c(){M(e.$$.fragment)},l(r){G(e.$$.fragment,r)},m(r,s){V(e,r,s),n=!0},p(r,s){t=r;const c={};s[0]&4&&(c.name=t[17](t[39])),s[0]&4|s[1]&32768&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(r){n||(b(e.$$.fragment,r),n=!0)},o(r){S(e.$$.fragment,r),n=!1},d(r){F(e,r)}}}function Kt(t){let e,n,l,i=t[42].criticalIssue+"",r;return{c(){e=be("svg"),n=be("polygon"),l=be("text"),r=Y(i),this.h()},l(s){e=ke(s,"svg",{width:!0,height:!0,xmlns:!0});var c=X(e);n=ke(c,"polygon",{points:!0,fill:!0,class:!0}),X(n).forEach(d),l=ke(c,"text",{x:!0,y:!0});var f=X(l);r=Q(f,i),f.forEach(d),c.forEach(d),this.h()},h(){z(n,"points","20,0 0,40 40,40"),z(n,"fill",ct.critical.background),z(n,"class","svelte-ktyu3j"),z(l,"x","13"),z(l,"y","30"),J(l,"fill","white"),z(e,"width","40"),z(e,"height","40"),z(e,"xmlns","http://www.w3.org/2000/svg")},m(s,c){L(s,e,c),R(e,n),R(e,l),R(l,r)},p(s,c){c[0]&4&&i!==(i=s[42].criticalIssue+"")&&_e(r,i)},d(s){s&&d(e)}}}function Re(t){let e,n,l;function i(f){t[31](f,t[42])}function r(){return t[32](t[41])}function s(){return t[33](t[41])}let c={draggable:!0,$$slots:{default:[Kt]},$$scope:{ctx:t}};return t[42].point!==void 0&&(c.lngLat=t[42].point),e=new We({props:c}),x.push(()=>te(e,"lngLat",i)),e.$on("click",r),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(f){G(e.$$.fragment,f)},m(f,_){V(e,f,_),l=!0},p(f,_){t=f;const u={};_[0]&4|_[1]&32768&&(u.$$scope={dirty:_,ctx:t}),!n&&_[0]&4&&(n=!0,u.lngLat=t[42].point,ee(()=>n=!1)),e.$set(u)},i(f){l||(b(e.$$.fragment,f),l=!0)},o(f){S(e.$$.fragment,f),l=!1},d(f){F(e,f)}}}function Wt(t){let e,n=t[39].conflict+"",l;return{c(){e=W("span"),l=Y(n),this.h()},l(i){e=Z(i,"SPAN",{class:!0});var r=X(e);l=Q(r,n),r.forEach(d),this.h()},h(){z(e,"class","dot svelte-ktyu3j"),J(e,"background",pt)},m(i,r){L(i,e,r),R(e,l)},p(i,r){r[0]&4&&n!==(n=i[39].conflict+"")&&_e(l,n)},d(i){i&&d(e)}}}function Oe(t){let e,n,l;function i(f){t[34](f,t[39])}function r(){return t[35](t[41])}function s(){return t[36](t[41])}let c={draggable:!0,$$slots:{default:[Wt]},$$scope:{ctx:t}};return t[39].point!==void 0&&(c.lngLat=t[39].point),e=new We({props:c}),x.push(()=>te(e,"lngLat",i)),e.$on("click",r),e.$on("dragend",s),{c(){M(e.$$.fragment)},l(f){G(e.$$.fragment,f)},m(f,_){V(e,f,_),l=!0},p(f,_){t=f;const u={};_[0]&4|_[1]&32768&&(u.$$scope={dirty:_,ctx:t}),!n&&_[0]&4&&(n=!0,u.lngLat=t[39].point,ee(()=>n=!1)),e.$set(u)},i(f){l||(b(e.$$.fragment,f),l=!0)},o(f){S(e.$$.fragment,f),l=!1},d(f){F(e,f)}}}function Zt(t){let e,n;return e=new ut({props:{paint:{"circle-radius":30,"circle-opacity":0,"circle-stroke-width":5,"circle-stroke-color":"yellow"}}}),{c(){M(e.$$.fragment)},l(l){G(e.$$.fragment,l)},m(l,i){V(e,l,i),n=!0},p:ot,i(l){n||(b(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){F(e,l)}}}function Xt(t){let e,n,l,i,r,s,c,f,_,u;e=new It({}),e.$on("click",t[13]),l=new St({props:{gj:t[2].summary.networkMap,show:t[7]}});let j=oe(t[2].criticalIssues),v=[];for(let o=0;o<j.length;o+=1)v[o]=Re(Be(t,j,o));const w=o=>S(v[o],1,1,()=>{v[o]=null});let $=oe(t[2].policyConflictLog),h=[];for(let o=0;o<$.length;o+=1)h[o]=Oe(qe(t,$,o));const D=o=>S(h[o],1,1,()=>{h[o]=null});return c=new ft({props:{data:t[8],$$slots:{default:[Zt]},$$scope:{ctx:t}}}),_=new Lt({props:{map:t[3]}}),{c(){M(e.$$.fragment),n=B(),M(l.$$.fragment),i=B();for(let o=0;o<v.length;o+=1)v[o].c();r=B();for(let o=0;o<h.length;o+=1)h[o].c();s=B(),M(c.$$.fragment),f=B(),M(_.$$.fragment)},l(o){G(e.$$.fragment,o),n=A(o),G(l.$$.fragment,o),i=A(o);for(let p=0;p<v.length;p+=1)v[p].l(o);r=A(o);for(let p=0;p<h.length;p+=1)h[p].l(o);s=A(o),G(c.$$.fragment,o),f=A(o),G(_.$$.fragment,o)},m(o,p){V(e,o,p),L(o,n,p),V(l,o,p),L(o,i,p);for(let I=0;I<v.length;I+=1)v[I]&&v[I].m(o,p);L(o,r,p);for(let I=0;I<h.length;I+=1)h[I]&&h[I].m(o,p);L(o,s,p),V(c,o,p),L(o,f,p),V(_,o,p),u=!0},p(o,p){const I={};if(p[0]&4&&(I.gj=o[2].summary.networkMap),p[0]&128&&(I.show=o[7]),l.$set(I),p[0]&516){j=oe(o[2].criticalIssues);let y;for(y=0;y<j.length;y+=1){const K=Be(o,j,y);v[y]?(v[y].p(K,p),b(v[y],1)):(v[y]=Re(K),v[y].c(),b(v[y],1),v[y].m(r.parentNode,r))}for(se(),y=j.length;y<v.length;y+=1)w(y);re()}if(p[0]&516){$=oe(o[2].policyConflictLog);let y;for(y=0;y<$.length;y+=1){const K=qe(o,$,y);h[y]?(h[y].p(K,p),b(h[y],1)):(h[y]=Oe(K),h[y].c(),b(h[y],1),h[y].m(s.parentNode,s))}for(se(),y=$.length;y<h.length;y+=1)D(y);re()}const E={};p[0]&256&&(E.data=o[8]),p[1]&32768&&(E.$$scope={dirty:p,ctx:o}),c.$set(E);const P={};p[0]&8&&(P.map=o[3]),_.$set(P)},i(o){if(!u){b(e.$$.fragment,o),b(l.$$.fragment,o);for(let p=0;p<j.length;p+=1)b(v[p]);for(let p=0;p<$.length;p+=1)b(h[p]);b(c.$$.fragment,o),b(_.$$.fragment,o),u=!0}},o(o){S(e.$$.fragment,o),S(l.$$.fragment,o),v=v.filter(Boolean);for(let p=0;p<v.length;p+=1)S(v[p]);h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)S(h[p]);S(c.$$.fragment,o),S(_.$$.fragment,o),u=!1},d(o){o&&(d(n),d(i),d(r),d(s),d(f)),F(e,o),F(l,o),ge(v,o),ge(h,o),F(c,o),F(_,o)}}}function Yt(t){let e,n,l,i,r,s,c,f,_,u,j;const v=[Tt,At],w=[];function $(o,p){return o[0]==null?0:1}l=$(t),i=w[l]=v[l](t);function h(o){t[37](o)}let D={$$slots:{default:[Xt]},$$scope:{ctx:t}};return t[3]!==void 0&&(D.map=t[3]),c=new st({props:D}),x.push(()=>te(c,"map",h)),{c(){e=W("div"),n=W("div"),i.c(),r=B(),s=W("div"),M(c.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{style:!0});var p=X(e);n=Z(p,"DIV",{style:!0});var I=X(n);i.l(I),I.forEach(d),r=A(p),s=Z(p,"DIV",{style:!0});var E=X(s);G(c.$$.fragment,E),E.forEach(d),p.forEach(d),this.h()},h(){J(n,"width","30%"),J(n,"overflow-y","scroll"),J(n,"padding","10px"),J(n,"border","1px solid black"),J(s,"position","relative"),J(s,"width","70%"),J(e,"display","flex"),J(e,"height","80vh")},m(o,p){L(o,e,p),R(e,n),w[l].m(n,null),t[30](n),R(e,r),R(e,s),V(c,s,null),_=!0,u||(j=nt(Bt,"keydown",t[18]),u=!0)},p(o,p){let I=l;l=$(o),l===I?w[l].p(o,p):(se(),S(w[I],1,1,()=>{w[I]=null}),re(),i=w[l],i?i.p(o,p):(i=w[l]=v[l](o),i.c()),b(i,1),i.m(n,null));const E={};p[0]&396|p[1]&32768&&(E.$$scope={dirty:p,ctx:o}),!f&&p[0]&8&&(f=!0,E.map=o[3],ee(()=>f=!1)),c.$set(E)},i(o){_||(b(i),b(c.$$.fragment,o),_=!0)},o(o){S(i),S(c.$$.fragment,o),_=!1},d(o){o&&d(e),w[l].d(),t[30](null),F(c),u=!1,j()}}}function Qt(t,e,n){let l={type:"FeatureCollection",features:[]},i=e??n;if(i!=null){let r=i.kind=="critical"?t.criticalIssues:t.policyConflictLog;l.features.push(Ce(r[i.idx].point))}return l}function Ce(t){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:t}}}function xt(t,e,n){let l,i;ye(t,U,g=>n(2,i=g));let r,s,c="critical",f=null,_=null,u=null,j=!1,v=!0;async function w(g){_=s.scrollTop,n(0,f=g),n(1,u=null),await he(),n(4,s.scrollTop=0,s)}async function $(g){_=s.scrollTop,n(0,f=g),n(1,u=null),await he(),n(4,s.scrollTop=0,s);let O=g.kind=="critical"?i.criticalIssues:i.policyConflictLog;r.flyTo({center:O[g.idx].point,duration:500})}async function h(g){let O=g.kind=="critical"?i.criticalIssues:i.policyConflictLog,ce=JSON.parse(JSON.stringify(O[g.idx])),tt=r.getBounds().getWest(),lt=r.getBounds().getEast();ce.point[0]+=(lt-tt)*.05;let Ne=O.toSpliced(g.idx+1,0,ce);g.kind=="critical"?pe(U,i.criticalIssues=Ne,i):pe(U,i.policyConflictLog=Ne,i),w({kind:g.kind,idx:g.idx+1})}async function D(){n(0,f=null),pe(U,i.policyConflictLog=i.policyConflictLog.toSorted((g,O)=>Ee(g.conflict)-Ee(O.conflict)),i),pe(U,i.criticalIssues=i.criticalIssues.toSorted((g,O)=>De(g.criticalIssue)-De(O.criticalIssue)),i),_!=null&&(await he(),n(4,s.scrollTop=_,s),_=null)}function o(g){if(!j){if(f!=null){D();return}c=="critical"?(pe(U,i.criticalIssues=[...i.criticalIssues,{criticalIssue:"",stage:"",point:g.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),w({kind:"critical",idx:i.criticalIssues.length-1})):(pe(U,i.policyConflictLog=[...i.policyConflictLog,{conflict:"",stage:"",point:g.detail.lngLat.toArray(),locationName:"",resolved:"",notes:""}],i),w({kind:"conflict",idx:i.policyConflictLog.length-1}))}}it(()=>{I(!1)});function p(){window.confirm("Delete this entry?")&&(f.kind=="critical"?(i.criticalIssues.splice(f.idx,1),U.set(i)):(i.policyConflictLog.splice(f.idx,1),U.set(i)),D())}function I(g){let O={type:"FeatureCollection",features:[...i.criticalIssues.map(ce=>Ce(ce.point)),...i.policyConflictLog.map(ce=>Ce(ce.point)),...i.summary.networkMap.features]};O.features.length>0&&r.fitBounds(at(O),{padding:20,animate:g})}function E(g){let O=g.criticalIssue?$t(g.criticalIssue):"Unknown critical";return g.locationName?`${O} (${g.locationName})`:O}function P(g){let O=g.conflict?dt(g.conflict):"Unknown conflict";return g.locationName?`${O} (${g.locationName})`:O}function y(g){if(f!=null&&g.key=="Escape")g.stopPropagation(),D();else if(f!=null&&g.key=="Delete"){let O=g.target.tagName;if(O=="INPUT"||O=="TEXTAREA")return;g.stopPropagation(),p()}}const K=()=>I(!0);function T(g){j=g,n(6,j)}function ae(g){v=g,n(7,v)}function m(g){c=g,n(5,c)}const k=g=>$({kind:"critical",idx:g}),H=g=>n(1,u={kind:"critical",idx:g}),N=()=>n(1,u=null),q=g=>$({kind:"conflict",idx:g}),le=g=>n(1,u={kind:"conflict",idx:g}),a=()=>n(1,u=null),C=()=>{let g=_t(f);h({kind:g.kind,idx:g.idx})};function ne(g){x[g?"unshift":"push"](()=>{s=g,n(4,s)})}function ie(g,O){t.$$.not_equal(O.point,g)&&(O.point=g,U.set(i))}const fe=g=>w({kind:"critical",idx:g}),ue=g=>w({kind:"critical",idx:g});function Ye(g,O){t.$$.not_equal(O.point,g)&&(O.point=g,U.set(i))}const Qe=g=>w({kind:"conflict",idx:g}),xe=g=>w({kind:"conflict",idx:g});function et(g){r=g,n(3,r)}return t.$$.update=()=>{t.$$.dirty[0]&7&&n(8,l=Qt(i,f,u))},[f,u,i,r,s,c,j,v,l,w,$,h,D,o,p,I,E,P,y,K,T,ae,m,k,H,N,q,le,a,C,ne,ie,fe,ue,Ye,Qe,xe,et]}class wl extends Ie{constructor(e){super(),Le(this,e,xt,Yt,we,{},null,[-1,-1])}}export{wl as component};
